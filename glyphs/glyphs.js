/*
 howler.js v2.1.1 | (c) 2013-2018, James Simpson of GoldFire Studios | MIT License | howlerjs.com  Spatial Plugin  @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(E,k,u){E!=Array.prototype&&E!=Object.prototype&&(E[k]=u.value)};
$jscomp.getGlobal=function(E){E=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,E];for(var k=0;k<E.length;++k){var u=E[k];if(u&&u.Math==Math)return u}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(E,k,u,y){if(k){u=$jscomp.global;E=E.split(".");for(y=0;y<E.length-1;y++){var w=E[y];w in u||(u[w]={});u=u[w]}E=E[E.length-1];y=u[E];k=k(y);k!=y&&null!=k&&$jscomp.defineProperty(u,E,{configurable:!0,writable:!0,value:k})}};
$jscomp.polyfill("String.fromCodePoint",function(E){return E?E:function(k){for(var u="",y=0;y<arguments.length;y++){var w=Number(arguments[y]);if(0>w||1114111<w||w!==Math.floor(w))throw new RangeError("invalid_code_point "+w);65535>=w?u+=String.fromCharCode(w):(w-=65536,u+=String.fromCharCode(w>>>10&1023|55296),u+=String.fromCharCode(w&1023|56320))}return u}},"es6","es3");$jscomp.arrayIteratorImpl=function(E){var k=0;return function(){return k<E.length?{done:!1,value:E[k++]}:{done:!0}}};
$jscomp.arrayIterator=function(E){return{next:$jscomp.arrayIteratorImpl(E)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(E,k){this.$jscomp$symbol$id_=E;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:k})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function E(u){if(this instanceof E)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(u||"")+"_"+k++,u)}var k=0;return E}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var E=$jscomp.global.Symbol.iterator;E||(E=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[E]&&$jscomp.defineProperty(Array.prototype,E,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var E=$jscomp.global.Symbol.asyncIterator;E||(E=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(E){$jscomp.initSymbolIterator();E={next:E};E[$jscomp.global.Symbol.iterator]=function(){return this};return E};
$jscomp.iteratorFromArray=function(E,k){$jscomp.initSymbolIterator();E instanceof String&&(E+="");var u=0,y={next:function(){if(u<E.length){var w=u++;return{value:k(w,E[w]),done:!1}}y.next=function(){return{done:!0,value:void 0}};return y.next()}};y[Symbol.iterator]=function(){return y};return y};$jscomp.polyfill("Array.prototype.values",function(E){return E?E:function(){return $jscomp.iteratorFromArray(this,function(k,u){return u})}},"es8","es3");
$jscomp.checkStringArgs=function(E,k,u){if(null==E)throw new TypeError("The 'this' value for String.prototype."+u+" must not be null or undefined");if(k instanceof RegExp)throw new TypeError("First argument to String.prototype."+u+" must not be a regular expression");return E+""};
$jscomp.polyfill("String.prototype.startsWith",function(E){return E?E:function(k,u){var y=$jscomp.checkStringArgs(this,k,"startsWith");k+="";var w=y.length,z=k.length;u=Math.max(0,Math.min(u|0,y.length));for(var F=0;F<z&&u<w;)if(y[u++]!=k[F++])return!1;return F>=z}},"es6","es3");$jscomp.polyfill("Array.prototype.keys",function(E){return E?E:function(){return $jscomp.iteratorFromArray(this,function(k){return k})}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(E){return E?E:function(k,u){var y=$jscomp.checkStringArgs(this,k,"endsWith");k+="";void 0===u&&(u=y.length);u=Math.max(0,Math.min(u|0,y.length));for(var w=k.length;0<w&&0<u;)if(y[--u]!=k[--w])return!1;return 0>=w}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(E){return E?E:function(k,u,y){var w=this.length||0;0>u&&(u=Math.max(0,w+u));if(null==y||y>w)y=w;y=Number(y);0>y&&(y=Math.max(0,w+y));for(u=Number(u||0);u<y;u++)this[u]=k;return this}},"es6","es3");
(function(E,k){E.lime=E.lime||{};E.lime.$scripts=E.lime.$scripts||{};E.lime.$scripts.glyphs=function(k,y){(function(k,u){function F(a,b){a=Object.create(a);for(var c in b)a[c]=b[c];b.toString!==Object.prototype.toString&&(a.toString=b.toString);return a}function y(a){return a instanceof Array?new Oc(a):a.iterator()}function q(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=u.$haxeUID++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=b.bind(a),a.hx__closures__[b.__id__]=
c);return c}k.echo=k.echo||{};k.lime=k.lime||{};var n={},d=function(){return ja.__string_rec(this,"")},p=p||{},g,U=function(){};n["lime.app.IModule"]=U;U.__name__=!0;U.__isInterface__=!0;var O=function(){this.onExit=new gc};n["lime.app.Module"]=O;O.__name__=!0;O.__interfaces__=[U];O.prototype={__class__:O};var R=function(a){this.gameDeviceCache=new Bb;this.parent=a;this.nextUpdate=this.lastUpdate=this.currentUpdate=0;this.framePeriod=-1;Fc.init();this.accelerometer=kc.registerSensor(Te.ACCELEROMETER,
0)};n["lime._internal.backend.html5.HTML5Application"]=R;R.__name__=!0;R.prototype={convertKeyCode:function(a){if(65<=a&&90>=a)return a+32;switch(a){case 12:return 1073741980;case 16:return 1073742049;case 17:return 1073742048;case 18:return 1073742050;case 19:return 1073741896;case 20:return 1073741881;case 33:return 1073741899;case 34:return 1073741902;case 35:return 1073741901;case 36:return 1073741898;case 37:return 1073741904;case 38:return 1073741906;case 39:return 1073741903;case 40:return 1073741905;
case 41:return 1073741943;case 43:return 1073741940;case 44:return 1073741894;case 45:return 1073741897;case 46:return 127;case 91:return 1073742051;case 92:return 1073742055;case 93:return 1073742055;case 95:return 1073742106;case 96:return 1073741922;case 97:return 1073741913;case 98:return 1073741914;case 99:return 1073741915;case 100:return 1073741916;case 101:return 1073741917;case 102:return 1073741918;case 103:return 1073741919;case 104:return 1073741920;case 105:return 1073741921;case 106:return 1073741909;
case 107:return 1073741911;case 108:return 1073741923;case 109:return 1073741910;case 110:return 1073741923;case 111:return 1073741908;case 112:return 1073741882;case 113:return 1073741883;case 114:return 1073741884;case 115:return 1073741885;case 116:return 1073741886;case 117:return 1073741887;case 118:return 1073741888;case 119:return 1073741889;case 120:return 1073741890;case 121:return 1073741891;case 122:return 1073741892;case 123:return 1073741893;case 124:return 1073741928;case 125:return 1073741929;
case 126:return 1073741930;case 127:return 1073741931;case 128:return 1073741932;case 129:return 1073741933;case 130:return 1073741934;case 131:return 1073741935;case 132:return 1073741936;case 133:return 1073741937;case 134:return 1073741938;case 135:return 1073741939;case 144:return 1073741907;case 145:return 1073741895;case 160:return 94;case 161:return 33;case 163:return 35;case 164:return 36;case 166:return 1073742094;case 167:return 1073742095;case 168:return 1073742097;case 169:return 41;case 170:return 42;
case 171:return 96;case 172:return 1073741898;case 173:return 45;case 174:return 1073741953;case 175:return 1073741952;case 176:return 1073742082;case 177:return 1073742083;case 178:return 1073742084;case 179:return 1073742085;case 180:return 1073742089;case 181:return 1073742086;case 182:return 1073741953;case 183:return 1073741952;case 186:return 59;case 187:return 61;case 188:return 44;case 189:return 45;case 190:return 46;case 191:return 47;case 192:return 96;case 193:return 63;case 194:return 1073741923;
case 219:return 91;case 220:return 92;case 221:return 93;case 222:return 39;case 223:return 96;case 224:return 1073742051;case 226:return 92}return a},exec:function(){window.addEventListener("keydown",q(this,this.handleKeyEvent),!1);window.addEventListener("keyup",q(this,this.handleKeyEvent),!1);window.addEventListener("focus",q(this,this.handleWindowEvent),!1);window.addEventListener("blur",q(this,this.handleWindowEvent),!1);window.addEventListener("resize",q(this,this.handleWindowEvent),!1);window.addEventListener("beforeunload",
q(this,this.handleWindowEvent),!1);window.addEventListener("devicemotion",q(this,this.handleSensorEvent),!1);CanvasRenderingContext2D.prototype.isPointInStroke||(CanvasRenderingContext2D.prototype.isPointInStroke=function(a,b,c){return!1});CanvasRenderingContext2D.prototype.isPointInPath||(CanvasRenderingContext2D.prototype.isPointInPath=function(a,b,c){return!1});0=="performance"in window&&(window.performance={});if(0=="now"in window.performance){var a=Date.now();performance.timing&&performance.timing.navigationStart&&
(a=performance.timing.navigationStart);window.performance.now=function(){return Date.now()-a}}for(var b=0,c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"]||window[c[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a,c){var e=(new Date).getTime(),f=Math.max(0,16-(e-b));c=window.setTimeout(function(){a(e+
f)},f);b=e+f;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});window.requestAnimFrame=window.requestAnimationFrame;this.lastUpdate=(new Date).getTime();this.handleApplicationEvent();return 0},exit:function(){},handleApplicationEvent:function(a){a=0;for(var b=this.parent.__windows;a<b.length;){var c=b[a];++a;c.__backend.updateSize()}this.updateGameDevices();this.currentUpdate=(new Date).getTime();if(this.currentUpdate>=this.nextUpdate){this.deltaTime=
this.currentUpdate-this.lastUpdate;a=0;for(b=this.parent.__windows;a<b.length;)c=b[a],++a,this.parent.onUpdate.dispatch(this.deltaTime|0),null!=c.context&&c.onRender.dispatch(c.context);this.nextUpdate=0>this.framePeriod?this.currentUpdate:this.currentUpdate-this.currentUpdate%this.framePeriod+this.framePeriod;this.lastUpdate=this.currentUpdate}window.requestAnimationFrame(q(this,this.handleApplicationEvent))},handleKeyEvent:function(a){if(null!=this.parent.__window){var b=this.convertKeyCode(null!=
a.keyCode?a.keyCode:a.which),c=(a.shiftKey?3:0)|(a.ctrlKey?192:0)|(a.altKey?768:0)|(a.metaKey?3072:0);"keydown"==a.type?(this.parent.__window.onKeyDown.dispatch(b,c),this.parent.__window.onKeyDown.canceled&&a.cancelable&&a.preventDefault()):(this.parent.__window.onKeyUp.dispatch(b,c),this.parent.__window.onKeyUp.canceled&&a.cancelable&&a.preventDefault())}},handleSensorEvent:function(a){this.accelerometer.onUpdate.dispatch(a.accelerationIncludingGravity.x,a.accelerationIncludingGravity.y,a.accelerationIncludingGravity.z)},
handleWindowEvent:function(a){if(null!=this.parent.__window)switch(a.type){case "blur":this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0);break;case "focus":this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1);break;case "resize":this.parent.__window.__backend.handleResizeEvent(a);break;case "visibilitychange":window.document.hidden?this.hidden||(this.parent.__window.onFocusOut.dispatch(),
this.parent.__window.onDeactivate.dispatch(),this.hidden=!0):this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1)}},updateGameDevices:function(){var a=fb.__getDeviceData();if(null!=a)for(var b,c,e,f,h,t=0,l=a.length;t<l;)if(b=t++,f=a[b],null!=f){if(!this.gameDeviceCache.h.hasOwnProperty(b)){h=new Qd;h.id=b;h.connected=f.connected;c=0;for(e=f.buttons.length;c<e;){var d=c++;h.buttons.push(f.buttons[d].value)}c=0;for(e=f.axes.length;c<e;)d=
c++,h.axes.push(f.axes[d]);"standard"==f.mapping&&(h.isGamepad=!0);this.gameDeviceCache.h[b]=h;f.connected&&(fb.__connect(b),h.isGamepad&&Pa.__connect(b))}h=this.gameDeviceCache.h[b];e=fb.devices.h[b];c=Pa.devices.h[b];if(f.connected){for(var g=0,J=f.buttons.length;g<J;){var r=g++;d=f.buttons[r].value;if(d!=h.buttons[r]){if(6==r)e.onAxisMove.dispatch(f.axes.length,d),null!=c&&c.onAxisMove.dispatch(4,d);else if(7==r)e.onAxisMove.dispatch(f.axes.length+1,d),null!=c&&c.onAxisMove.dispatch(5,d);else if(0<
d?e.onButtonDown.dispatch(r):e.onButtonUp.dispatch(r),null!=c){switch(r){case 0:b=0;break;case 1:b=1;break;case 2:b=2;break;case 3:b=3;break;case 4:b=9;break;case 5:b=10;break;case 8:b=4;break;case 9:b=6;break;case 10:b=7;break;case 11:b=8;break;case 12:b=11;break;case 13:b=12;break;case 14:b=13;break;case 15:b=14;break;case 16:b=5;break;default:continue}0<d?c.onButtonDown.dispatch(b):c.onButtonUp.dispatch(b)}h.buttons[r]=d}}b=0;for(d=f.axes.length;b<d;)g=b++,f.axes[g]!=h.axes[g]&&(e.onAxisMove.dispatch(g,
f.axes[g]),null!=c&&c.onAxisMove.dispatch(g,f.axes[g]),h.axes[g]=f.axes[g])}else h.connected&&(h.connected=!1,fb.__disconnect(b),Pa.__disconnect(b))}},__class__:R};var ba=function(){this.onCreateWindow=new Rd;this.onUpdate=new gc;this.onExit=new gc;null==ba.current&&(ba.current=this);this.meta=new W;this.modules=[];this.__windowByID=new Bb;this.__windows=[];this.__backend=new R(this);this.__registerLimeModule(this);this.__preloader=new Sd;this.__preloader.onProgress.add(q(this,this.onPreloadProgress));
this.__preloader.onComplete.add(q(this,this.onPreloadComplete))};n["lime.app.Application"]=ba;ba.__name__=!0;ba.__super__=O;ba.prototype=F(O.prototype,{createWindow:function(a){a=this.__createWindow(a);this.__addWindow(a);return a},exec:function(){ba.current=this;return this.__backend.exec()},onGamepadAxisMove:function(a,b,c){},onGamepadButtonDown:function(a,b){},onGamepadButtonUp:function(a,b){},onGamepadConnect:function(a){},onGamepadDisconnect:function(a){},onJoystickAxisMove:function(a,b,c){},
onJoystickButtonDown:function(a,b){},onJoystickButtonUp:function(a,b){},onJoystickConnect:function(a){},onJoystickDisconnect:function(a){},onJoystickHatMove:function(a,b,c){},onJoystickTrackballMove:function(a,b,c,e){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onModuleExit:function(a){},onMouseDown:function(a,b,c){},onMouseMove:function(a,b){},onMouseMoveRelative:function(a,b){},onMouseUp:function(a,b,c){},onMouseWheel:function(a,b,c){},onPreloadComplete:function(){},onPreloadProgress:function(a,
b){},onRenderContextLost:function(){},onRenderContextRestored:function(a){},onTextEdit:function(a,b,c){},onTextInput:function(a){},onTouchCancel:function(a){},onTouchEnd:function(a){},onTouchMove:function(a){},onTouchStart:function(a){},onWindowActivate:function(){},onWindowClose:function(){},onWindowCreate:function(){},onWindowDeactivate:function(){},onWindowDropFile:function(a){},onWindowEnter:function(){},onWindowExpose:function(){},onWindowFocusIn:function(){},onWindowFocusOut:function(){},onWindowFullscreen:function(){},
onWindowLeave:function(){},onWindowMove:function(a,b){},onWindowMinimize:function(){},onWindowResize:function(a,b){},onWindowRestore:function(){},render:function(a){},update:function(a){},__addWindow:function(a){if(null!=a){this.__windows.push(a);this.__windowByID.h[a.id]=a;var b=q(this,this.__onWindowClose);a.onClose.add(function(){b(a)},!1,-1E4);null==this.__window&&(this.__window=a,a.onActivate.add(q(this,this.onWindowActivate)),a.onRenderContextLost.add(q(this,this.onRenderContextLost)),a.onRenderContextRestored.add(q(this,
this.onRenderContextRestored)),a.onDeactivate.add(q(this,this.onWindowDeactivate)),a.onDropFile.add(q(this,this.onWindowDropFile)),a.onEnter.add(q(this,this.onWindowEnter)),a.onExpose.add(q(this,this.onWindowExpose)),a.onFocusIn.add(q(this,this.onWindowFocusIn)),a.onFocusOut.add(q(this,this.onWindowFocusOut)),a.onFullscreen.add(q(this,this.onWindowFullscreen)),a.onKeyDown.add(q(this,this.onKeyDown)),a.onKeyUp.add(q(this,this.onKeyUp)),a.onLeave.add(q(this,this.onWindowLeave)),a.onMinimize.add(q(this,
this.onWindowMinimize)),a.onMouseDown.add(q(this,this.onMouseDown)),a.onMouseMove.add(q(this,this.onMouseMove)),a.onMouseMoveRelative.add(q(this,this.onMouseMoveRelative)),a.onMouseUp.add(q(this,this.onMouseUp)),a.onMouseWheel.add(q(this,this.onMouseWheel)),a.onMove.add(q(this,this.onWindowMove)),a.onRender.add(q(this,this.render)),a.onResize.add(q(this,this.onWindowResize)),a.onRestore.add(q(this,this.onWindowRestore)),a.onTextEdit.add(q(this,this.onTextEdit)),a.onTextInput.add(q(this,this.onTextInput)),
this.onWindowCreate());this.onCreateWindow.dispatch(a)}},__createWindow:function(a){a=new Td(this,a);return-1==a.id?null:a},__registerLimeModule:function(a){a.onUpdate.add(q(this,this.update));a.onExit.add(q(this,this.onModuleExit),!1,0);a.onExit.add(q(this,this.__onModuleExit),!1,0);for(a=Pa.devices.iterator();a.hasNext();){var b=a.next();this.__onGamepadConnect(b)}Pa.onConnect.add(q(this,this.__onGamepadConnect));for(a=fb.devices.iterator();a.hasNext();)b=a.next(),this.__onJoystickConnect(b);fb.onConnect.add(q(this,
this.__onJoystickConnect));Eb.onCancel.add(q(this,this.onTouchCancel));Eb.onStart.add(q(this,this.onTouchStart));Eb.onMove.add(q(this,this.onTouchMove));Eb.onEnd.add(q(this,this.onTouchEnd))},__removeWindow:function(a){null!=a&&this.__windowByID.h.hasOwnProperty(a.id)&&(this.__window==a&&(this.__window=null),G.remove(this.__windows,a),this.__windowByID.remove(a.id),a.close(),0==this.__windows.length&&Vb.exit(0))},__onGamepadConnect:function(a){this.onGamepadConnect(a);var b=q(this,this.onGamepadAxisMove),
c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=q(this,this.onGamepadButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);var f=q(this,this.onGamepadButtonUp);c=function(b){f(a,b)};a.onButtonUp.add(c);var h=q(this,this.onGamepadDisconnect);a.onDisconnect.add(function(){h(a)})},__onJoystickConnect:function(a){this.onJoystickConnect(a);var b=q(this,this.onJoystickAxisMove),c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=q(this,this.onJoystickButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);
var f=q(this,this.onJoystickButtonUp);c=function(b){f(a,b)};a.onButtonUp.add(c);var h=q(this,this.onJoystickDisconnect);a.onDisconnect.add(function(){h(a)});var t=q(this,this.onJoystickHatMove);c=function(b,c){t(a,b,c)};a.onHatMove.add(c);var l=q(this,this.onJoystickTrackballMove);c=function(b,c,e){l(a,b,c,e)};a.onTrackballMove.add(c)},__onModuleExit:function(a){this.__backend.exit()},__onWindowClose:function(a){if(this.__window==a)this.onWindowClose();this.__removeWindow(a)},__class__:ba});var w=
function(){};n.ApplicationMain=w;w.__name__=!0;w.main=function(){Vb.__registerEntryPoint("glyphs",w.create)};w.create=function(a){x.init(a);var b=new pa;b.meta.h.build="1";b.meta.h.company="ob";b.meta.h.file="glyphs";b.meta.h.name="tyke";b.meta.h.packageName="tyke";b.meta.h.version="0.0.1";var c={allowHighDPI:!1,alwaysOnTop:!1,borderless:!1,element:null,frameRate:60,height:600,hidden:!1,maximized:!1,minimized:!1,parameters:{},resizable:!0,title:"tyke",width:800,x:null,y:null,context:{antialiasing:0,
background:16777215,colorDepth:32,depth:!0,hardware:!0,stencil:!1,type:null,vsync:!0}};if(null==b.__window&&null!=a)for(var e=0,f=H.fields(a);e<f.length;){var h=f[e];++e;Object.prototype.hasOwnProperty.call(c,h)?c[h]=H.field(a,h):Object.prototype.hasOwnProperty.call(c.context,h)&&(c.context[h]=H.field(a,h))}b.createWindow(c);e=0;for(f=x.preloadLibraries;e<f.length;)a=f[e],++e,b.__preloader.addLibrary(a);e=0;for(f=x.preloadLibraryNames;e<f.length;)a=f[e],++e,b.__preloader.addLibraryName(a);b.__preloader.load();
w.start(b)};w.start=function(a){a.exec()};var z=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};n.EReg=z;z.__name__=!0;z.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw A.thrown("EReg::matched");},matchedRight:function(){if(null==this.r.m)throw A.thrown("No string matched");var a=this.r.m.index+this.r.m[0].length;return G.substr(this.r.s,
a,this.r.s.length-a)},matchedPos:function(){if(null==this.r.m)throw A.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(a,b,c){null==c&&(c=-1);if(this.r.global){if(this.r.lastIndex=b,this.r.m=this.r.exec(0>c?a:G.substr(a,0,b+c)),c=null!=this.r.m)this.r.s=a}else if(c=this.match(0>c?G.substr(a,b,null):G.substr(a,b,c)))this.r.s=a,this.r.m.index+=b;return c},map:function(a,b){for(var c=0,e="";!(c>=a.length);){if(!this.matchSub(a,c)){e+=m.string(G.substr(a,
c,null));break}var f=this.matchedPos();e+=m.string(G.substr(a,c,f.pos-c));e+=m.string(b(this));0==f.len?(e+=m.string(G.substr(a,f.pos,1)),c=f.pos+1):c=f.pos+f.len;if(!this.r.global)break}!this.r.global&&0<c&&c<a.length&&(e+=m.string(G.substr(a,c,null)));return e},__class__:z};var E=function(){};n["ob.gum.ILoop"]=E;E.__name__=!0;E.__isInterface__=!0;E.prototype={__class__:E};var ua=function(){};n["ob.gum.backends.PeoteViewLoop"]=ua;ua.__name__=!0;ua.__interfaces__=[E];ua.prototype={onInit:function(a){this.gum=
a;this.peoteView=new Ud(a.window);this.w=null==a.config.displayWidth?a.window.__width:a.config.displayWidth;this.h=null==a.config.displayHeight?a.window.__height:a.config.displayHeight;this.ratio=this.w/this.h;this.display=new Vd(0,0,a.window.__width,a.window.__height,255);this.peoteView.addDisplay(this.display);this.peoteView.start();this.setZoom()},setZoom:function(){var a=this.display,b=this.gum.window.__width/this.w|0;a.xz=a.zoom*b;if(Q.isUBO){var c=a.uniformBuffer,e=a.gl;c.uniformBytes.b_UFloat32[2]=
a.xz;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,8,c.xZoomBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null);c=a.uniformBufferFB;e=a.gl;c.uniformBytes.b_UFloat32[2]=a.xz;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,8,c.xZoomBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}a.xZoom=b;a=this.display;b=this.gum.window.__height/this.h|0;a.yz=a.zoom*b;Q.isUBO&&(c=a.uniformBuffer,e=a.gl,c.uniformBytes.b_UFloat32[3]=a.yz,e.bindBuffer(e.UNIFORM_BUFFER,
c.uniformBuffer),e.bufferSubData(e.UNIFORM_BUFFER,12,c.yZoomBufferPointer),e.bindBuffer(e.UNIFORM_BUFFER,null),c=a.uniformBufferFB,e=a.gl,c.uniformBytes.b_UFloat32[3]=a.yz,e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer),e.bufferSubData(e.UNIFORM_BUFFER,12,c.yZoomBufferPointer),e.bindBuffer(e.UNIFORM_BUFFER,null));a.yZoom=b;this.display.width=this.gum.window.__width;this.display.height=this.gum.window.__height},onUpdate:function(a){},onTick:function(a){return!1},onDraw:function(a){},onKeyDown:function(a,
b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){this.peoteView.resize(a,b);this.setZoom()},__class__:ua};var S=function(a,b,c){this.alwaysDraw=!1;this.onInitComplete=function(){};this.data=a;this.assets=b;this.palette=null!=c?c:new Wd(zc.toRGBA(Ac.Versitle));this.layers=[];this.keyboard=new Xd([]);this.mouse=new Yd};n["tyke.GlyphLoop"]=S;S.__name__=!0;S.__super__=ua;S.prototype=
F(ua.prototype,{onInit:function(a){var b=this;ua.prototype.onInit.call(this,a);this.assets.Preload(function(){b.text=Ke.initText(b.display,b.assets.fontCache[0]);b.display.addProgram(b.text.fontProgram);b.onInitComplete()})},onTick:function(a){for(var b=!1,c=0,e=this.layers;c<e.length;){var f=e[c];++c;f.onTick(a);f.hasChanged&&(b=!0)}return this.alwaysDraw?!0:b},onDraw:function(a){a=0;for(var b=this.layers;a<b.length;){var c=b[a];++a;c.hasChanged&&(c.draw(),c.hasChanged=!1)}this.text.fontProgram._buffer.update()},
onKeyDown:function(a,b){this.keyboard.handle(a,this)},onMouseDown:function(a,b,c){this.mouse.onDown(a,b,c)},onMouseUp:function(a,b,c){this.mouse.onUp(a,b,c)},onMouseMove:function(a,b){this.mouse.onMove(a,b)},__class__:S});var ea=function(a,b,c){S.call(this,a,b,c);this.onInitComplete=q(this,this.begin)};n.Glyphs=ea;ea.__name__=!0;ea.__super__=S;ea.prototype=F(S.prototype,{getInitFor:function(a,b,c){var e=this;return function(f,h){var t=G.cca(a,0);f*=e.text.fontStyle.width;h*=e.text.fontStyle.height;
var l=e.text.fontProgram,d=e.text.fontStyle,g=l.font;g=t>=g.rangeMapping.min&&t<=g.rangeMapping.max?g.rangeMapping:null;if(null!=g){var J=new ca;d=null!=d?d:l.fontStyle;J.width=d.width;J.height=d.height;J.color=d.color;J.bgColor=d.bgColor;J.weight=d.weight;J.tilt=d.tilt;J.zIndex=d.zIndex;J.char=t;J.tile=t-g.min;J.x=f;J.y=h;l._buffer.addElement(J);t=J}else t=null;return new Xc(0,t,b,c,1)}},begin:function(){var a=new Gc(this.data.numCellsWide,this.data.numCellsHigh,Math.ceil(this.text.fontStyle.width),
Math.ceil(this.text.fontStyle.height),this.palette,this.getInitFor(" ",0,3)),b=new Gc(this.data.numCellsWide,this.data.numCellsHigh,Math.ceil(this.text.fontStyle.width),Math.ceil(this.text.fontStyle.height),this.palette,this.getInitFor(" ",0,-1)),c=new P(a,this.text.fontProgram);a=new qa(b,this.text.fontProgram);this.layers=[c,a];this.keyboard.bind(49,"1","toggle random chars",function(a){c.toggleRandomChars()});this.keyboard.bind(50,"2","toggle colors cycle/random",function(a){c.togglePaletteCycle()});
this.keyboard.bind(91,"[","decrease cycle depth",function(a){c.alterPaletteCycleLength(1)});this.keyboard.bind(93,"]","increase cycle depth",function(a){c.alterPaletteCycleLength(-1)});this.keyboard.bind(61,"=","change palette",function(a){c.cyclePalette()});b=0;for(var e=this.keyboard.listBindings();b<e.length;){var f=e[b];++b;a.addLine(f)}a.refreshDisplay();this.gum.toggleUpdate(!0)},__class__:ea});var Ca=function(a,b){this.numColumns=a;this.numRows=b};n["tyke.GridLogic"]=Ca;Ca.__name__=!0;Ca.prototype=
{column:function(a){return a%this.numColumns|0},row:function(a){return a/this.numColumns|0},index:function(a,b){return a+this.numColumns*b},__class__:Ca};var K=function(a,b,c){Ca.call(this,a,b);this.cellInit=c;this.init()};n["tyke.GridStructure"]=K;K.__name__=!0;K.__super__=Ca;K.prototype=F(Ca.prototype,{init:function(){this.cells=[];for(var a=0,b=this.numColumns*this.numRows;a<b;){var c=a++,e=this.column(c);c=this.row(c);this.cells.push(this.cellInit(e,c))}},forEach:function(a,b){null==b&&(b=!1);
if(b)for(b=this.cells.length;0<b--;)a(this.column(b),this.row(b),this.cells[b]);else for(var c=0,e=this.cells;c<e.length;){var f=e[c];b=c++;a(this.column(b),this.row(b),f)}},forSingleCoOrdinate:function(a,b,c){c(a,b,this.cells[this.index(a,b)])},__class__:K});var T=function(a,b){this.hasChanged=!1;K.call(this,a.numColumns,a.numRows,a.cellInit);this.palette=a.palette;this.fontProgram=b;b.fontStyle.bgColor=0;null==a.cellInit&&(a.cellInit=function(c,e){c*=a.cellWidth;e*=a.cellHeight;var f=b.fontStyle,
h=b.font;h=32>=h.rangeMapping.min&&32<=h.rangeMapping.max?h.rangeMapping:null;if(null!=h){var t=new ca;f=null!=f?f:b.fontStyle;t.width=f.width;t.height=f.height;t.color=f.color;t.bgColor=f.bgColor;t.weight=f.weight;t.tilt=f.tilt;t.zIndex=f.zIndex;t.char=32;t.tile=32-h.min;t.x=c;t.y=e;b._buffer.addElement(t);c=t}else c=null;return new Xc(0,c,10,-1,1)})};n["tyke.GlyphGrid"]=T;T.__name__=!0;T.__super__=K;T.prototype=F(K.prototype,{onTick:function(a){},draw:function(){for(var a=0,b=this.cells;a<b.length;){var c=
b[a];a++;var e=c;e.glyph.color=this.palette.colorOrDefault(e.paletteIndexFg);c=this.palette.colorOrDefault(e.paletteIndexBg);0<e.paletteIndexBg&&(e.glyph.bgColor=zc.changeAlpha(c,Math.ceil(255*e.bgIntensity)));var f=this.fontProgram;c=e.glyph;e=0==e.char?G.cca(" ",0):e.char;f=f.font;f=e>=f.rangeMapping.min&&e<=f.rangeMapping.max?f.rangeMapping:null;null!=f&&(c.char=e,c.tile=e-f.min)}},__class__:T});var qa=function(a,b){this.lines=[];T.call(this,a,b)};n.InfoLayer=qa;qa.__name__=!0;qa.__super__=T;qa.prototype=
F(T.prototype,{addLine:function(a){var b=this.lines,c=[],e=0;for(a=a.split("");e<a.length;){var f=a[e];++e;c.push(G.cca(f,0))}b.push(c)},refreshDisplay:function(){for(var a=0,b=this.lines;a<b.length;){for(var c=b[a],e=a++,f=[],h=0;h<c.length;){var t=c[h];++h;f.push(String.fromCodePoint(t))}ka.trace(f.join(""),{fileName:"Glyphs.hx",lineNumber:89,className:"InfoLayer",methodName:"refreshDisplay"});for(f=0;f<c.length;)h=c[f],t=f++,this.forSingleCoOrdinate(t,e,function(a){return function(b,c,e){e.char=
a[0];e.paletteIndexFg=14;e.paletteIndexBg=15}}([h]))}this.hasChanged=!0},__class__:qa});var P=function(a,b){this.reduceColoursBy=0;this.isPaletteCycle=!1;this.isCharsRandom=!0;this.paletteIndex=0;this.palettes=[Ac.VanillaMilkshake,Ac.Soldier,Ac.Versitle];T.call(this,a,b)};n.DemoLayer=P;P.__name__=!0;P.__super__=T;P.prototype=F(T.prototype,{onTick:function(a){var b=this;this.forEach(function(c,e,f){b.isPaletteCycle&&bc.cyclePalette(f,b.palette,b.reduceColoursBy,a);bc.randomise(c,e,f,b.palette,!b.isPaletteCycle,
b.isCharsRandom)});this.hasChanged=!0},toggleRandomChars:function(){this.isCharsRandom=!this.isCharsRandom},togglePaletteCycle:function(){this.isPaletteCycle=!this.isPaletteCycle},cyclePalette:function(){this.paletteIndex++;this.paletteIndex>=this.palettes.length&&(this.paletteIndex=0);this.palette.setColors(zc.toRGBA(this.palettes[this.paletteIndex]))},alterPaletteCycleLength:function(a){this.reduceColoursBy+=a;ka.trace("reduce colours by "+this.reduceColoursBy,{fileName:"Glyphs.hx",lineNumber:141,
className:"DemoLayer",methodName:"alterPaletteCycleLength"});0>this.reduceColoursBy&&(this.reduceColoursBy=0);this.reduceColoursBy>this.palette.colors.length-1&&(this.reduceColoursBy=this.palette.colors.length-1)},__class__:P});var G=function(){};n.HxOverrides=G;G.__name__=!0;G.strDate=function(a){switch(a.length){case 8:a=a.split(":");var b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:return a=a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);
case 19:return a=a.split(" "),b=a[0].split("-"),a=a[1].split(":"),new Date(b[0],b[1]-1,b[2],a[0],a[1],a[2]);default:throw A.thrown("Invalid date format : "+a);}};G.cca=function(a,b){a=a.charCodeAt(b);if(a==a)return a};G.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};G.remove=function(a,b){b=a.indexOf(b);if(-1==b)return!1;a.splice(b,1);return!0};G.now=function(){return Date.now()};var L=function(a,b,c){this.errors=a;this.putils=b;this.errorType=
c};n["json2object.reader.BaseParser"]=L;L.__name__=!0;L.prototype={fromJson:function(a,b){null==b&&(b="");this.putils=new Zd(a);this.errors=[];try{var c=(new $d(a,b)).doParse();this.loadJson(c)}catch(e){if(ma.lastError=e,a=A.caught(e).unwrap(),a instanceof Wb)this.errors.push(ra.ParserError(a.message,this.putils.convertPosition(a.pos)));else throw e;}return this.value},loadJson:function(a,b){null==b&&(b="");var c=this.putils.convertPosition(a.pos);a=a.value;switch(a._hx_index){case 0:this.loadJsonString(a.s,
c,b);break;case 1:this.loadJsonNumber(a.s,c,b);break;case 2:this.loadJsonObject(a.fields,c,b);break;case 3:this.loadJsonArray(a.values,c,b);break;case 4:this.loadJsonBool(a.b,c,b);break;case 5:this.loadJsonNull(c,b)}return this.value},loadJsonNull:function(a,b){this.onIncorrectType(a,b)},loadJsonString:function(a,b,c){this.onIncorrectType(b,c)},loadJsonNumber:function(a,b,c){this.onIncorrectType(b,c)},loadJsonUInt:function(a,b,c,e){var f=0;a=ha.trim(a);"-"==a.charAt(0)&&(a=G.substr(a,1,null));var h=
ha.startsWith(a,"0x");h&&(a=G.substr(a,2,null));for(var t=h?16:10,l=1,d=a.length-1;0<=d;){var g=h?m.parseInt("0x"+a.charAt(d)):m.parseInt(a.charAt(d));if(null==g)return this.onIncorrectType(b,c),e;f+=l*g;l*=t;--d}return f},loadJsonInt:function(a,b,c,e){if(null!=m.parseInt(a)&&m.parseInt(a)==parseFloat(a))return m.parseInt(a);this.onIncorrectType(b,c);return e},loadJsonFloat:function(a,b,c,e){if(null!=m.parseInt(a))return parseFloat(a);this.onIncorrectType(b,c);return e},loadJsonBool:function(a,b,
c){this.onIncorrectType(b,c)},loadJsonArray:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArrayValue:function(a,b,c){for(var e=[],f=0;f<a.length;){var h=a[f];++f;try{var t=b(h,c)}catch(l){if(ma.lastError=l,h=A.caught(l).unwrap(),ja.__instanceof(h,Ib)){if(h!=Ib.ParsingThrow)throw A.thrown(h);continue}else throw l;}e.push(t)}return e},loadJsonObject:function(a,b,c){this.onIncorrectType(b,c)},loadObjectField:function(a,b,c,e,f,h){try{var t=a(b.value,b.name);this.mapSet(e,c,!0);return t}catch(l){if(ma.lastError=
l,a=A.caught(l).unwrap(),ja.__instanceof(a,Ib)){if(a!=Ib.ParsingThrow)throw A.thrown(a);}else this.errors.push(ra.CustomFunctionException(a,h))}return f},objectSetupAssign:function(a,b,c){for(var e=0,f=b.length;e<f;){var h=e++;this.mapSet(a,b[h],c[h])}},objectErrors:function(a,b){b=this.putils.convertPosition(new xa(b.file,b.max-1,b.max-1));for(var c=Object.keys(a.h),e=c.length,f=0;f<e;){var h=c[f++];a.h[h]||this.errors.push(ra.UninitializedVariable(h,b))}},onIncorrectType:function(a,b){this.parsingThrow()},
parsingThrow:function(){if(0!=this.errorType)throw A.thrown(Ib.ParsingThrow);},mapSet:function(a,b,c){a.h[b]=c},__class__:L};var Qa=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_0=Qa;Qa.__name__=!0;Qa.__super__=L;Qa.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"peote.text.FontConfig",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new W;this.objectSetupAssign(c,
"packed distancefield kerning width height color bgColor line tiles rangeSplitSize ranges".split(" "),[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "bgColor":this.value.bgColor=this.loadObjectField((g=new C(this.errors,this.putils,1),q(g,g.loadJson)),f,"bgColor",c,this.value.bgColor,b);break;case "color":this.value.color=this.loadObjectField((g=new C(this.errors,this.putils,1),q(g,g.loadJson)),f,"color",c,this.value.color,
b);break;case "distancefield":this.value.distancefield=this.loadObjectField((g=new Z(this.errors,this.putils,1),q(g,g.loadJson)),f,"distancefield",c,this.value.distancefield,b);break;case "height":this.value.height=this.loadObjectField((g=new I(this.errors,this.putils,1),q(g,g.loadJson)),f,"height",c,this.value.height,b);break;case "kerning":this.value.kerning=this.loadObjectField((g=new fa(this.errors,this.putils,1),q(g,g.loadJson)),f,"kerning",c,this.value.kerning,b);break;case "line":this.value.line=
this.loadObjectField((g=new D(this.errors,this.putils,1),q(g,g.loadJson)),f,"line",c,this.value.line,b);break;case "packed":this.value.packed=this.loadObjectField((g=new Z(this.errors,this.putils,1),q(g,g.loadJson)),f,"packed",c,this.value.packed,b);break;case "rangeSplitSize":this.value.rangeSplitSize=this.loadObjectField((g=new da(this.errors,this.putils,1),q(g,g.loadJson)),f,"rangeSplitSize",c,this.value.rangeSplitSize,b);break;case "ranges":this.value.ranges=this.loadObjectField((g=new Ua(this.errors,
this.putils,1),q(g,g.loadJson)),f,"ranges",c,this.value.ranges,b);break;case "tiles":this.value.tiles=this.loadObjectField((g=new Za(this.errors,this.putils,1),q(g,g.loadJson)),f,"tiles",c,this.value.tiles,b);break;case "width":this.value.width=this.loadObjectField((g=new I(this.errors,this.putils,1),q(g,g.loadJson)),f,"width",c,this.value.width,b);break;default:this.errors.push(ra.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(ae.prototype);
a.packed=!1;a.distancefield=!1;a.kerning=null;a.width=16;a.height=16;a.color=-1;a.bgColor=0;a.line=null;a.tiles=null;a.rangeSplitSize=4096;a.ranges=(new Ua([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1)));return a},__class__:Qa});var Ua=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_1=Ua;Ua.__name__=!0;Ua.__super__=L;Ua.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"Array<{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }>",
a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonArray:function(a,b,c){this.value=this.loadJsonArrayValue(a,(g=new Xa(this.errors,this.putils,2),q(g,g.loadJson)),c)},__class__:Ua});var $a=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c);this.value=0};n.JsonParser_10=$a;$a.__name__=!0;$a.__super__=L;$a.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"UInt",a));L.prototype.onIncorrectType.call(this,a,b)},
loadJsonNumber:function(a,b,c){this.value=this.loadJsonUInt(a,b,c,this.value)},__class__:$a});var Xa=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_11=Xa;Xa.__name__=!0;Xa.__super__=L;Xa.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }",a));L.prototype.onIncorrectType.call(this,
a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new W;this.objectSetupAssign(c,"data image line range slot tiles".split(" "),[!0,!1,!0,!1,!1,!0]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "data":this.value.data=this.loadObjectField((g=new Da(this.errors,this.putils,1),q(g,g.loadJson)),f,"data",c,this.value.data,b);break;case "image":this.value.image=this.loadObjectField((g=new gb(this.errors,this.putils,1),q(g,g.loadJson)),
f,"image",c,this.value.image,b);break;case "line":this.value.line=this.loadObjectField((g=new v(this.errors,this.putils,1),q(g,g.loadJson)),f,"line",c,this.value.line,b);break;case "range":this.value.range=this.loadObjectField((g=new sa(this.errors,this.putils,1),q(g,g.loadJson)),f,"range",c,this.value.range,b);break;case "slot":this.value.slot=this.loadObjectField((g=new Ma(this.errors,this.putils,1),q(g,g.loadJson)),f,"slot",c,this.value.slot,b);break;case "tiles":this.value.tiles=this.loadObjectField((g=
new X(this.errors,this.putils,1),q(g,g.loadJson)),f,"tiles",c,this.value.tiles,b);break;default:this.errors.push(ra.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{data:(new Da([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1))),image:(new gb([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1))),line:(new v([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1))),range:(new sa([],this.putils,0)).loadJson(new Fa(ta.JNull,
new xa("",0,1))),slot:(new Ma([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1))),tiles:(new X([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1)))}},__class__:Xa});var Da=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_13=Da;Da.__name__=!0;Da.__super__=L;Da.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"String",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,
b,c){this.value=a},__class__:Da});var gb=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_14=gb;gb.__name__=!0;gb.__super__=L;gb.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"String",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,b,c){this.value=a},__class__:gb});var v=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_16=v;v.__name__=!0;v.__super__=L;v.prototype=
F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ height : Float, base : Float }",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new W;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "base":this.value.base=this.loadObjectField((g=new I(this.errors,this.putils,1),q(g,g.loadJson)),f,"base",c,this.value.base,
b);break;case "height":this.value.height=this.loadObjectField((g=new I(this.errors,this.putils,1),q(g,g.loadJson)),f,"height",c,this.value.height,b);break;default:this.errors.push(ra.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new I([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1))),height:(new I([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1)))}},__class__:v});var sa=function(a,b,c){null==c&&(c=0);L.call(this,
a,b,c)};n.JsonParser_17=sa;sa.__name__=!0;sa.__super__=L;sa.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"peote.text.Range",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new W;this.objectSetupAssign(c,["min","max"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "max":this.value.max=this.loadObjectField((g=new da(this.errors,this.putils,
1),q(g,g.loadJson)),f,"max",c,this.value.max,b);break;case "min":this.value.min=this.loadObjectField((g=new da(this.errors,this.putils,1),q(g,g.loadJson)),f,"min",c,this.value.min,b);break;default:this.errors.push(ra.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(be.prototype);a.min=(new da([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1)));a.max=(new da([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",
0,1)));return a},__class__:sa});var Ma=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_18=Ma;Ma.__name__=!0;Ma.__super__=L;Ma.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ width : Int, height : Int }",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new W;this.objectSetupAssign(c,["height","width"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=
a[e];++e;switch(f.name){case "height":this.value.height=this.loadObjectField((g=new da(this.errors,this.putils,1),q(g,g.loadJson)),f,"height",c,this.value.height,b);break;case "width":this.value.width=this.loadObjectField((g=new da(this.errors,this.putils,1),q(g,g.loadJson)),f,"width",c,this.value.width,b);break;default:this.errors.push(ra.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{height:(new da([],this.putils,0)).loadJson(new Fa(ta.JNull,
new xa("",0,1))),width:(new da([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1)))}},__class__:Ma});var Z=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c);this.value=!1};n.JsonParser_2=Z;Z.__name__=!0;Z.__super__=L;Z.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"Bool",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonBool:function(a,b,c){this.value=a},__class__:Z});var X=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_20=
X;X.__name__=!0;X.__super__=L;X.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ y : Int, x : Int }",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new W;this.objectSetupAssign(c,["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "x":this.value.x=this.loadObjectField((g=new da(this.errors,this.putils,1),q(g,g.loadJson)),f,
"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((g=new da(this.errors,this.putils,1),q(g,g.loadJson)),f,"y",c,this.value.y,b);break;default:this.errors.push(ra.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new da([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1))),y:(new da([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1)))}},__class__:X});var fa=function(a,b,c){null==c&&(c=0);L.call(this,
a,b,c)};n.JsonParser_4=fa;fa.__name__=!0;fa.__super__=L;fa.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"Bool",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonBool:function(a,b,c){this.value=a},__class__:fa});var I=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c);this.value=0};n.JsonParser_5=I;I.__name__=!0;I.__super__=L;I.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,
"Float",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonFloat(a,b,c,this.value)},__class__:I});var C=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_6=C;C.__name__=!0;C.__super__=L;C.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"peote.view.Color",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=(new $a(this.errors,this.putils,0)).loadJson(new Fa(ta.JNumber(a),
new xa(b.file,b.min-1,b.max-1)),c)},__class__:C});var D=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_7=D;D.__name__=!0;D.__super__=L;D.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ height : Float, base : Float }",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new W;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<
a.length;){var f=a[e];++e;switch(f.name){case "base":this.value.base=this.loadObjectField((g=new I(this.errors,this.putils,1),q(g,g.loadJson)),f,"base",c,this.value.base,b);break;case "height":this.value.height=this.loadObjectField((g=new I(this.errors,this.putils,1),q(g,g.loadJson)),f,"height",c,this.value.height,b);break;default:this.errors.push(ra.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new I([],this.putils,0)).loadJson(new Fa(ta.JNull,
new xa("",0,1))),height:(new I([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1)))}},__class__:D});var Za=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c)};n.JsonParser_8=Za;Za.__name__=!0;Za.__super__=L;Za.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"{ y : Int, x : Int }",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new W;this.objectSetupAssign(c,["x","y"],[!1,
!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "x":this.value.x=this.loadObjectField((g=new da(this.errors,this.putils,1),q(g,g.loadJson)),f,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((g=new da(this.errors,this.putils,1),q(g,g.loadJson)),f,"y",c,this.value.y,b);break;default:this.errors.push(ra.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new da([],this.putils,
0)).loadJson(new Fa(ta.JNull,new xa("",0,1))),y:(new da([],this.putils,0)).loadJson(new Fa(ta.JNull,new xa("",0,1)))}},__class__:Za});var da=function(a,b,c){null==c&&(c=0);L.call(this,a,b,c);this.value=0};n.JsonParser_9=da;da.__name__=!0;da.__super__=L;da.prototype=F(L.prototype,{onIncorrectType:function(a,b){this.errors.push(ra.IncorrectType(b,"Int",a));L.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonInt(a,b,c,this.value)},__class__:da});var Ba=
function(){this.isReadyForUpdate=!1;ba.call(this)};n["ob.gum.backends.App"]=Ba;Ba.__name__=!0;Ba.__super__=ba;Ba.prototype=F(ba.prototype,{init:function(a,b){this.gum=new ce(a,b);this.isReadyForUpdate=!0},onWindowCreate:function(){ka.trace("App onWindowCreate",{fileName:"ob/gum/backends/Lime.hx",lineNumber:22,className:"ob.gum.backends.App",methodName:"onWindowCreate"});switch(this.__window.context.type){case "opengl":case "opengles":case "webgl":try{this.init(this.__window)}catch(b){var a=A.caught(b);
ka.trace(Bc.toString(Bc.exceptionStack()),{fileName:"ob/gum/backends/Lime.hx",lineNumber:28,className:"ob.gum.backends.App",methodName:"onWindowCreate",customParams:[a]})}break;default:throw A.thrown("Sorry, only works with OpenGL.");}},update:function(a){if(this.isReadyForUpdate)this.gum.onUpdate(a)},onKeyDown:function(a,b){this.gum.onKeyDown(a,b)},onKeyUp:function(a,b){this.gum.onKeyUp(a,b)},onMouseMove:function(a,b){this.gum.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.gum.onMouseDown(a,
b,c)},onMouseUp:function(a,b,c){this.gum.onMouseUp(a,b,c)},onMouseWheel:function(a,b,c){this.gum.onMouseScroll(a,b,c)},onWindowResize:function(a,b){ba.prototype.onWindowResize.call(this,a,b);this.gum.onWindowResize(a,b)},__class__:Ba});var pa=function(){Ba.call(this)};n.Main=pa;pa.__name__=!0;pa.__super__=Ba;pa.prototype=F(Ba.prototype,{init:function(a,b){Ba.prototype.init.call(this,a,{framesPerSecond:30,drawOnlyWhenRequested:!0,displayWidth:800,displayHeight:600,displayIsScaled:!0});a=new de(50,
37);b=new ee({fonts:["assets/fonts/tiled/hack_ascii.json"],images:[]});this.gum.changeLoop(new ea(a,b))},__class__:pa});var x=function(){};n.ManifestResources=x;x.__name__=!0;x.init=function(a){x.preloadLibraries=[];x.preloadLibraryNames=[];x.rootPath=null;null!=a&&Object.prototype.hasOwnProperty.call(a,"rootPath")&&(x.rootPath=H.field(a,"rootPath"));null==x.rootPath&&(x.rootPath="./");a=nb.parse('{"name":null,"assets":"aoy4:pathy40:assets%2Ffonts%2Ftiled%2Fhack_ascii.jsony4:sizei1258y4:typey4:TEXTy2:idR1y7:preloadtgoR0y39:assets%2Ffonts%2Ftiled%2Fhack_ascii.pngR2i12425R3y5:IMAGER5R7R6tgh","rootPath":null,"version":2,"libraryArgs":[],"libraryType":null}',
x.rootPath);a=hc.fromManifest(a);aa.registerLibrary("default",a);a=aa.getLibrary("default");null!=a?x.preloadLibraries.push(a):x.preloadLibraryNames.push("default")};Math.__name__=!0;var H=function(){};n.Reflect=H;H.__name__=!0;H.field=function(a,b){try{return a[b]}catch(c){return ma.lastError=c,null}};H.getProperty=function(a,b){var c;if(null==a)return null;var e=a.__properties__?c=a.__properties__["get_"+b]:!1;return e?a[c]():a[b]};H.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,
e;for(e in a)"__id__"!=e&&"hx__closures__"!=e&&c.call(a,e)&&b.push(e)}return b};H.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};H.compareMethods=function(a,b){return a==b?!0:H.isFunction(a)&&H.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};H.copy=function(a){if(null==a)return null;for(var b={},c=0,e=H.fields(a);c<e.length;){var f=e[c];++c;b[f]=H.field(a,f)}return b};var m=function(){};n.Std=m;m.__name__=!0;m.string=function(a){return ja.__string_rec(a,
"")};m.parseInt=function(a){if(null!=a)for(var b=0,c=a.length;b<c;){var e=b++,f=a.charCodeAt(e);if(8>=f||14<=f&&32!=f&&45!=f)if(b=a.charCodeAt(e+1),a=parseInt(a,120==b||88==b?16:10),isNaN(a))break;else return a}return null};var B=function(){};n["_String.String_Impl_"]=B;B.__name__=!0;B.fromCharCode=function(a){return String.fromCodePoint(a)};var na=function(){this.b=""};n.StringBuf=na;na.__name__=!0;na.prototype={__class__:na};var ha=function(){};n.StringTools=ha;ha.__name__=!0;ha.startsWith=function(a,
b){return a.length>=b.length?0==a.lastIndexOf(b,0):!1};ha.endsWith=function(a,b){var c=b.length,e=a.length;return e>=c?a.indexOf(b,e-c)==e-c:!1};ha.isSpace=function(a,b){a=G.cca(a,b);return 8<a&&14>a?!0:32==a};ha.ltrim=function(a){for(var b=a.length,c=0;c<b&&ha.isSpace(a,c);)++c;return 0<c?G.substr(a,c,b-c):a};ha.rtrim=function(a){for(var b=a.length,c=0;c<b&&ha.isSpace(a,b-c-1);)++c;return 0<c?G.substr(a,0,b-c):a};ha.trim=function(a){return ha.ltrim(ha.rtrim(a))};ha.replace=function(a,b,c){return a.split(b).join(c)};
var ia=function(){};n.Type=ia;ia.__name__=!0;ia.createInstance=function(a,b){return new (Function.prototype.bind.apply(a,[null].concat(b)))};ia.createEnum=function(a,b,c){var e=H.field(a,b);if(null==e)throw A.thrown("No such constructor "+b);if(H.isFunction(e)){if(null==c)throw A.thrown("Constructor "+b+" need parameters");return e.apply(a,c)}if(null!=c&&0!=c.length)throw A.thrown("Constructor "+b+" does not need parameters");return e};var Va={toFloat:function(a){return 0>a?4294967296+a:a+0}},mb=
function(){};n["echo.util.Disposable"]=mb;mb.__name__=!0;mb.__isInterface__=!0;var Ha=function(a){this.transform=new sc;this.layer_mask=We._new();this.layers=We._new();var b=new M(0,0);this.drag=b;this.max_velocity=b=new M(0,0);this.torque=0;this.acceleration=b=new M(0,0);this.velocity=b=new M(0,0);this.material=tc.global;this.id=++Ha.ids;this.active=!0;this.shapes=[];this.data={};this.disposed=!1;this.transform.on_dirty=q(this,this.on_dirty);this.load_options(a)};n["echo.Body"]=Ha;Ha.__name__=!0;
Ha.__interfaces__=[mb];Ha.__properties__={get_defaults:"get_defaults"};Ha.get_defaults=function(){return{kinematic:!1,mass:Ha.default_mass,x:0,y:0,rotation:0,scale_x:1,scale_y:1,velocity_x:0,velocity_y:0,rotational_velocity:0,max_velocity_x:0,max_velocity_y:0,max_velocity_length:0,max_rotational_velocity:1E4,drag_x:0,drag_y:0,drag_length:0,rotational_drag:0}};Ha.prototype={load_options:function(a){a=cd.copy_fields(a,Ha.get_defaults());for(var b=0,c=this.shapes;b<c.length;){var e=c[b];++b;e.put()}this.shapes.length=
0;c=a.x;b=this.transform;b.dirty||b.set_dirty();b.local_x=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);c=a.y;b=this.transform;b.dirty||b.set_dirty();b.local_y=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);b=this.transform;c=Math.PI/180*a.rotation;b.dirty||b.set_dirty();b.local_radians=c;if(null!=this.on_rotate)this.on_rotate(180/Math.PI*this.transform.local_radians);c=a.scale_x;b=this.transform;b.dirty||b.set_dirty();b.local_scale_x=
c;c=a.scale_y;b=this.transform;b.dirty||b.set_dirty();b.local_scale_y=c;this.kinematic=a.kinematic;this.material=null!=a.material?a.material:null!=a.gravity_scale||null!=a.elasticity?new tc(a.elasticity,null,null,null,a.gravity_scale):tc.global;c=this.velocity;c.x=a.velocity_x;c.y=a.velocity_y;this.rotational_velocity=a.rotational_velocity;c=this.max_velocity;c.x=a.max_velocity_x;c.y=a.max_velocity_y;this.max_velocity_length=a.max_velocity_length;this.max_rotational_velocity=a.max_rotational_velocity;
c=this.drag;c.x=a.drag_x;c.y=a.drag_y;this.drag_length=a.drag_length;this.rotational_drag=a.rotational_drag;this.last_rotation=this.last_y=this.last_x=NaN;this.dirty=!0;if(null!=a.shape){e=Ra.get(a.shape);var f=-1;null==f&&(f=-1);-1==this.shapes.indexOf(e)&&(-1<f?this.shapes[f]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)))}if(null!=a.shapes)for(b=0,c=a.shapes;b<
c.length;)e=c[b],++b,e=Ra.get(e),f=-1,null==f&&(f=-1),-1==this.shapes.indexOf(e)&&(-1<f?this.shapes[f]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));null!=a.shape_instance&&(e=a.shape_instance,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))));
if(null!=a.shape_instances)for(b=0,c=a.shape_instances;b<c.length;)e=c[b],++b,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));b=a.mass;if(null==b)c=a.mass,c<Ha.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&
null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);else switch(b){case -1:b=a=0;for(c=this.shapes;b<c.length;)e=c[b],++b,a+=e.volume()*this.material.density;a<Ha.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=a,this.inverse_mass=
1/this.mass);break;case 0:c=0;c<Ha.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);break;default:c=a.mass,c<Ha.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):
(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass)}},bounds:function(a){if(0==this.shapes.length){var b=this.transform.local_x,c=this.transform.local_y,e=1,f=1;null==f&&(f=1);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);a=cb.pool.get();var h=b;null==f&&(f=1);null==e&&(e=1);null==c&&(c=0);null==h&&(h=0);e*=.5;f*=.5;a.min_x=h-e;a.min_y=c-f;a.max_x=h+e;a.max_y=c+f;a.pooled=!1;return a}h=this.shapes[0].bounds();if(1<this.shapes.length)for(f=
1,e=this.shapes.length;f<e;)c=f++,c=this.shapes[c].bounds(),h.min_x>c.min_x&&(h.min_x=c.min_x),h.min_y>c.min_y&&(h.min_y=c.min_y),h.max_x<c.max_x&&(h.max_x=c.max_x),h.max_y<c.max_y&&(h.max_y=c.max_y),c.put();null==a&&(a=cb.pool.get(),c=b=0,f=e=1,null==f&&(f=1),null==e&&(e=1),null==c&&(c=0),null==b&&(b=0),e*=.5,f*=.5,a.min_x=b-e,a.min_y=c-f,a.max_x=b+e,a.max_y=c+f,a.pooled=!1);a.min_x=h.min_x;a.max_x=h.max_x;a.min_y=h.min_y;a.max_y=h.max_y;h.put();return a},on_dirty:function(a){this.dirty=!0;0>=this.mass&&
null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))},__class__:Ha};var Ea=function(){};n["echo.Collisions"]=Ea;Ea.__name__=!0;Ea.update_quadtree=function(a){for(var b=0,c=a.members;b<c.length;){var e=c[b];++b;if(!e.disposed){e.collided=!1;for(var f=0,h=e.shapes;f<h.length;){var t=h[f];++f;t.collided=!1}e.active&&0<e.mass&&e.dirty&&0<e.shapes.length&&(null==e.quadtree_data.bounds?e.quadtree_data.bounds=e.bounds():e.bounds(e.quadtree_data.bounds),
a.quadtree.update(e.quadtree_data,!1),e.dirty=!1)}}a.quadtree.shake()};Ea.query=function(a,b){Ea.update_quadtree(a);b=null==b?a.listeners.members:b.members;for(var c=0;c<b.length;){var e=b[c];++c;e.quadtree_results.length=0;var f=e.a;switch(f._hx_index){case 0:f=f.v;var h=e.b;switch(h._hx_index){case 0:f=Ea.overlap_body_and_body_bounds(f,h.v);null!=f&&e.quadtree_results.push(f);break;case 1:Ea.overlap_body_and_bodies_bounds(f,h.v,a,e.quadtree_results)}break;case 1:switch(f=f.v,h=e.b,h._hx_index){case 0:Ea.overlap_body_and_bodies_bounds(h.v,
f,a,e.quadtree_results);break;case 1:h=h.v,Ea.overlap_bodies_and_bodies_bounds(f,h,a,e.quadtree_results),f!=h&&Ea.overlap_bodies_and_bodies_bounds(h,f,a,e.quadtree_results)}}f=0;for(h=e.last_collisions;f<h.length;){var t=h[f];++f;t.put()}e.last_collisions.length=e.collisions.length;f=0;for(h=e.collisions.length;f<h;)t=f++,e.last_collisions[t]=e.collisions[t];f=e.collisions.length=0;for(h=e.quadtree_results;f<h.length;)if(t=h[f],++f,t.a.disposed||t.b.disposed)t.put();else if(t.a.id==t.b.id)t.put();
else{for(var l=!1,d=0,g=e.collisions;d<g.length;){var J=g[d];++d;if(J.a.id==t.a.id&&J.b.id==t.b.id||J.b.id==t.a.id&&J.a.id==t.b.id){l=!0;break}}if(l)t.put();else{if(1==t.a.shapes.length&&1==t.b.shapes.length)l=t.a.shapes[0].collides(t.b.shapes[0]),null!=l&&t.data.push(l);else for(l=t.a.shapes,d=0,g=l.length;d<g;){J=d++;for(var r=t.b.shapes,m=l[J].bounds(),x=0,B=r.length;x<B;){var p=x++,n=r[p].bounds();m.min_x<n.max_x&&m.max_x>=n.min_x&&m.min_y<n.max_y&&m.max_y>=n.min_y&&(p=l[J].collides(r[p]),null!=
p&&t.data.push(p));n.put()}m.put()}if(0==t.data.length)t.put();else if(null==e.condition||e.condition(t.a,t.b,t.data)&&!t.a.disposed&&!t.b.disposed){l=0;for(d=t.data;l<d.length;)g=d[l],++l,g.sa.collided=g.sb.collided=!0;t.a.collided=t.b.collided=!0;e.collisions.push(t)}else t.put()}}}};Ea.notify=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(null!=c.enter||null!=c.stay)for(var e=0,f=c.collisions;e<f.length;){var h=f[e];++e;if(!h.a.disposed&&!h.b.disposed){if(null!=
c.enter){var t=!1;for(var l=0,d=c.last_collisions;l<d.length;){var g=d[l];++l;if(g.a==h.a&&g.b==h.b||g.a==h.b&&g.b==h.a){t=!0;break}}t=!t}else t=!1;t?c.enter(h.a,h.b,h.data):null!=c.stay&&c.stay(h.a,h.b,h.data)}}if(null!=c.exit)for(e=0,f=c.last_collisions;e<f.length;){h=f[e];++e;if(h.a.disposed||h.b.disposed)t=!1;else{t=!1;l=0;for(d=c.collisions;l<d.length;)if(g=d[l],++l,g.a==h.a&&g.b==h.b||g.a==h.b&&g.b==h.a){t=!0;break}t=!t}t&&c.exit(h.a,h.b)}}};Ea.overlap_bodies_and_bodies_bounds=function(a,b,
c,e){if(0!=a.length&&0!=b.length)for(var f=0;f<a.length;){var h=a[f];++f;Ea.overlap_body_and_bodies_bounds(h,b,c,e)}};Ea.overlap_body_and_bodies_bounds=function(a,b,c,e){if(!(a.disposed||0==a.shapes.length||!a.active||0>=a.mass)){var f=a.bounds();Ea.qr.length=0;Ea.sqr.length=0;c.quadtree.query(f,Ea.qr);c.static_quadtree.query(f,Ea.sqr);for(c=0;c<b.length;){var h=b[c];++c;if(!h.disposed&&0!=h.shapes.length&&h.active&&(0==a.layer_mask||0==h.layer_mask||0!=(a.layer_mask&h.layers)&&0!=(h.layer_mask&a.layers)))for(var t=
0,l=0<h.mass?Ea.qr:Ea.sqr;t<l.length;){var d=l[t];++t;d.id==h.id&&(d=uc.pool.get(),d.a=a,d.b=h,d.data.length=0,d.pooled=!1,e.push(d))}}f.put()}};Ea.overlap_body_and_body_bounds=function(a,b){if(a.disposed||b.disposed||0==a.shapes.length||0==b.shapes.length||!a.active||!b.active||a==b||0!=a.layer_mask&&0!=b.layer_mask&&(0==(a.layer_mask&b.layers)||0==(b.layer_mask&a.layers))||0>=a.mass&&0>=b.mass)return null;var c=a.bounds(),e=b.bounds(),f=c.min_x<e.max_x&&c.max_x>=e.min_x&&c.min_y<e.max_y&&c.max_y>=
e.min_y;c.put();e.put();return f?(c=uc.pool.get(),c.a=a,c.b=b,c.data.length=0,c.pooled=!1,c):null};var qb=function(a){this.members=null==a?[]:a};n["echo.Listeners"]=qb;qb.__name__=!0;qb.__interfaces__=[mb];qb.prototype={add:function(a,b,c){c=cd.copy_fields(c,Pb.get_defaults());a=new Pb(a,b,c.separate,[],[],null,null,null,null,[],c.percent_correction,c.correction_threshold);null!=c.enter&&(a.enter=c.enter);null!=c.stay&&(a.stay=c.stay);null!=c.exit&&(a.exit=c.exit);null!=c.condition&&(a.condition=
c.condition);this.members.push(a);return a},clear:function(){this.members.length=0},__class__:qb};var oa=k.echo.Echo=function(){};n["echo.Echo"]=oa;oa.__name__=!0;oa.start=function(a){return new dd(a)};oa.make=function(a,b){return a.add(new Ha(b))};oa.listen=function(a,b,c,e){return null==b?null==c?a.listeners.add(ed.Right(a.members),ed.Right(a.members),e):a.listeners.add(c,c,e):null==c?a.listeners.add(b,b,e):a.listeners.add(b,c,e)};oa.check=function(a,b,c,e){oa.cached_listeners.clear();null==b&&
null==c?oa.cached_listeners.add(ed.Right(a.members),ed.Right(a.members),e):null==b?oa.cached_listeners.add(c,c,e):null==c?oa.cached_listeners.add(b,b,e):oa.cached_listeners.add(b,c,e);Ea.query(a,oa.cached_listeners);Yc.separate(a,oa.cached_listeners);Ea.notify(a,oa.cached_listeners)};oa.step=function(a,b){if(null!=a.history){for(var c=a.history,e=[],f=0,h=a.members;f<h.length;){var t=h[f];++f;e.push(new fe(t.id,t.transform.local_x,t.transform.local_y,180/Math.PI*t.transform.local_radians,t.velocity.x,
t.velocity.y,t.acceleration.x,t.acceleration.y,t.rotational_velocity))}c.add(e)}b/=a.iterations;e=0;for(f=a.iterations;e<f;)e++,Yc.step(a,b),Ea.query(a),Yc.separate(a),Ea.notify(a)};oa.linecast_floats=function(a,b,c,e,f,h,t){null==t&&(t=!0);null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=Fb.pool.get();null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var d=l.start;d.x=a;d.y=b;d=l.end;d.x=c;d.y=e;l.pooled=!1;f=oa.linecast(l,f,h,t);l.pooled||(l.pooled=!0,Fb.pool.put_unsafe(l));
return f};oa.linecast_vector=function(a,b,c,e,f,h){null==h&&(h=!0);var t=Fb.pool.get();t.set_from_vector(a,b,c);t.pooled=!1;a=oa.linecast(t,e,f,h);t.pooled||(t.pooled=!0,Fb.pool.put_unsafe(t));return a};oa.linecast_vectors=function(a,b,c,e,f){f=a.x;var h=a.y;a=b.x;var t=b.y;null==t&&(t=1);null==a&&(a=1);null==h&&(h=0);null==f&&(f=0);b=Fb.pool.get();null==t&&(t=1);null==a&&(a=1);null==h&&(h=0);null==f&&(f=0);var l=b.start;l.x=f;l.y=h;l=b.end;l.x=a;l.y=t;b.pooled=!1;c=oa.linecast(b,c,e);b.pooled||(b.pooled=
!0,Fb.pool.put_unsafe(b));return c};oa.linecast=function(a,b,c,e){null==e&&(e=!0);var f=null,h=Math.min(a.start.x,a.end.x),t=Math.min(a.start.y,a.end.y),l=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,a.end.y),g=cb.pool.get();g.min_x=h;g.max_x=l;g.min_y=t;g.max_y=d;g.pooled=!1;var J=b;switch(J._hx_index){case 0:var r=J.v;if(!r.disposed&&r.active){var m=r.bounds();if(g.min_x<m.max_x&&g.max_x>=m.min_x&&g.min_y<m.max_y&&g.max_y>=m.min_y){var x=0;for(e=r.shapes.length;x<e;)t=x++,h=r.shapes[t].intersect(a),
null!=h&&(null==f&&(t=xb.pool.get(),t.line=a,t.body=r,t.data.length=0,t.pooled=!1,f=t),f.data.push(h))}m.put()}break;case 1:if(b=J.v,null==c)for(J=0;J<b.length;){if(r=b[J],++J,null!=r&&!r.disposed&&r.active){m=r.bounds();t=xb.pool.get();t.line=a;t.body=r;t.data.length=0;t.pooled=!1;c=t;if(g.min_x<m.max_x&&g.max_x>=m.min_x&&g.min_y<m.max_y&&g.max_y>=m.min_y)for(x=0,e=r.shapes.length;x<e;)t=x++,h=r.shapes[t].intersect(a),null!=h&&c.data.push(h);m.put();if(0<c.data.length)if(null!=f){if(0==f.data.length)h=
null;else if(1==f.data.length)h=f.data[0];else{m=f.data[0];r=1;for(h=f.data.length;r<h;)t=r++,null!=f.data[t]&&f.data[t].distance<m.distance&&(m=f.data[t]);h=m}m=h.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];e=1;for(h=c.data.length;e<h;)t=e++,null!=c.data[t]&&c.data[t].distance<r.distance&&(r=c.data[t]);e=r}h=m>e.distance}else h=!0;else h=!1;h?(null!=f&&f.put(),f=c):c.put()}}else{J=0;for(x=oa.cached_collisions;J<x.length;)m=x[J],++J,m.put();oa.cached_collisions.length=
0;m=oa.cached_body;h=g.min_x;t=g.min_y;l=g.max_x;d=g.max_y;r=Gb.pool.get();J=.5*(h+l);x=.5*(t+d);h=l-h;d-=t;null==d&&(d=0);null==h&&(h=1);null==x&&(x=0);null==J&&(J=0);l=r.transform;l.dirty||l.set_dirty();l.local_x=J;l=r.transform;l.dirty||l.set_dirty();l.local_y=x;J=.5*h;l=r.transform;null==l.parent?x=l.local_scale_x:(l.sync(),x=l._scale_x);r.local_ex=J/x;if(null!=r.transformed_rect){l=r.transformed_rect;l.count=4;J=0;for(x=l.count;J<x;)if(t=J++,null==l.local_vertices[t]){var B=l.local_vertices,
p=new M(0,0);B[t]=p}J=l.local_vertices[0];J.x=-(r.local_ex*r.transform.local_scale_x);J.y=-(r.local_ey*r.transform.local_scale_y);J=l.local_vertices[1];J.x=r.local_ex*r.transform.local_scale_x;J.y=-(r.local_ey*r.transform.local_scale_y);J=l.local_vertices[2];J.x=r.local_ex*r.transform.local_scale_x;J.y=r.local_ey*r.transform.local_scale_y;J=l.local_vertices[3];J.x=-(r.local_ex*r.transform.local_scale_x);J.y=r.local_ey*r.transform.local_scale_y;J=r.transform.local_x;B=l.transform;B.dirty||B.set_dirty();
B.local_x=J;J=r.transform.local_y;B=l.transform;B.dirty||B.set_dirty();B.local_y=J;B=l.transform;J=Math.PI/180*(180/Math.PI)*r.transform.local_radians;B.dirty||B.set_dirty();B.local_radians=J;J=r.transform.local_scale_x;B=l.transform;B.dirty||B.set_dirty();B.local_scale_x=J;J=r.transform.local_scale_y;B=l.transform;B.dirty||B.set_dirty();B.local_scale_y=J;l.dirty_vertices=!0;l.dirty_bounds=!0}J=.5*(0>=d?h:d);l=r.transform;null==l.parent?x=l.local_scale_y:(l.sync(),x=l._scale_y);r.local_ey=J/x;if(null!=
r.transformed_rect){l=r.transformed_rect;l.count=4;J=0;for(x=l.count;J<x;)t=J++,null==l.local_vertices[t]&&(B=l.local_vertices,p=new M(0,0),B[t]=p);J=l.local_vertices[0];J.x=-(r.local_ex*r.transform.local_scale_x);J.y=-(r.local_ey*r.transform.local_scale_y);J=l.local_vertices[1];J.x=r.local_ex*r.transform.local_scale_x;J.y=-(r.local_ey*r.transform.local_scale_y);J=l.local_vertices[2];J.x=r.local_ex*r.transform.local_scale_x;J.y=r.local_ey*r.transform.local_scale_y;J=l.local_vertices[3];J.x=-(r.local_ex*
r.transform.local_scale_x);J.y=r.local_ey*r.transform.local_scale_y;J=r.transform.local_x;B=l.transform;B.dirty||B.set_dirty();B.local_x=J;J=r.transform.local_y;B=l.transform;B.dirty||B.set_dirty();B.local_y=J;B=l.transform;J=Math.PI/180*(180/Math.PI)*r.transform.local_radians;B.dirty||B.set_dirty();B.local_radians=J;J=r.transform.local_scale_x;B=l.transform;B.dirty||B.set_dirty();B.local_scale_x=J;J=r.transform.local_scale_y;B=l.transform;B.dirty||B.set_dirty();B.local_scale_y=J;l.dirty_vertices=
!0;l.dirty_bounds=!0}l=r.transform;J=Math.PI/180*0;l.dirty||l.set_dirty();l.local_radians=J;l=r.transform;l.dirty||l.set_dirty();l.local_scale_x=1;l=r.transform;l.dirty||l.set_dirty();l.local_scale_y=1;null==r.transformed_rect?(l=r.transform,null==l.parent?h=180/Math.PI*l.local_radians:(l.sync(),h=180/Math.PI*l._radians),h=0!=h):h=!1;if(h){h=ab.pool.get();h.count=4;J=0;for(x=h.count;J<x;)t=J++,null==h.local_vertices[t]&&(d=h.local_vertices,p=new M(0,0),d[t]=p);J=h.local_vertices[0];J.x=-(r.local_ex*
r.transform.local_scale_x);J.y=-(r.local_ey*r.transform.local_scale_y);J=h.local_vertices[1];J.x=r.local_ex*r.transform.local_scale_x;J.y=-(r.local_ey*r.transform.local_scale_y);J=h.local_vertices[2];J.x=r.local_ex*r.transform.local_scale_x;J.y=r.local_ey*r.transform.local_scale_y;J=h.local_vertices[3];J.x=-(r.local_ex*r.transform.local_scale_x);J.y=r.local_ey*r.transform.local_scale_y;J=r.transform.local_x;l=h.transform;l.dirty||l.set_dirty();l.local_x=J;J=r.transform.local_y;l=h.transform;l.dirty||
l.set_dirty();l.local_y=J;l=h.transform;J=Math.PI/180*(180/Math.PI)*r.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=J;J=r.transform.local_scale_x;l=h.transform;l.dirty||l.set_dirty();l.local_scale_x=J;J=r.transform.local_scale_y;l=h.transform;l.dirty||l.set_dirty();l.local_scale_y=J;h.dirty_vertices=!0;h.dirty_bounds=!0;h.pooled=!1;r.transformed_rect=h;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(J=r.transform.local_x,l=r.transformed_rect.transform,l.dirty||
l.set_dirty(),l.local_x=J,J=r.transform.local_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_y=J,l=r.transformed_rect.transform,J=Math.PI/180*(180/Math.PI)*r.transform.local_radians,l.dirty||l.set_dirty(),l.local_radians=J,J=r.transform.local_scale_x,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_x=J,J=r.transform.local_scale_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_y=J);r.pooled=!1;null!=m.shapes[0]&&m.shapes[0].put();m.shapes[0]=
r;m.shapes[0].set_parent(m);m.dirty=!0;0>=m.mass&&null!=m.world&&(m.bounds(m.quadtree_data.bounds),m.world.static_quadtree.update(m.quadtree_data));e&&Ea.update_quadtree(c);Ea.overlap_body_and_bodies_bounds(oa.cached_body,b,c,oa.cached_collisions);J=0;for(x=oa.cached_collisions;J<x.length;){m=x[J];++J;r=m.b;t=xb.pool.get();t.line=a;t.body=r;t.data.length=0;t.pooled=!1;c=t;e=0;for(r=m.b.shapes.length;e<r;)t=e++,h=m.b.shapes[t].intersect(a),null!=h&&c.data.push(h);if(0<c.data.length)if(null!=f){if(0==
f.data.length)h=null;else if(1==f.data.length)h=f.data[0];else{m=f.data[0];h=1;for(e=f.data.length;h<e;)t=h++,null!=f.data[t]&&f.data[t].distance<m.distance&&(m=f.data[t]);h=m}m=h.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];h=1;for(b=c.data.length;h<b;)t=h++,null!=c.data[t]&&c.data[t].distance<r.distance&&(r=c.data[t]);e=r}h=m>e.distance}else h=!0;else h=!1;h?(null!=f&&f.put(),f=c):c.put()}oa.cached_body.shapes[0].put()}}g.put();return f};oa.linecast_all=
function(a,b,c,e){null==e&&(e=!0);var f=[],h=Math.min(a.start.x,a.end.x),t=Math.min(a.start.y,a.end.y),l=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,a.end.y),g=cb.pool.get();g.min_x=h;g.max_x=l;g.min_y=t;g.max_y=d;g.pooled=!1;var m=b;switch(m._hx_index){case 0:var r=m.v;t=xb.pool.get();t.line=a;t.body=r;t.data.length=0;t.pooled=!1;c=t;var x=r.bounds();if(g.min_x<x.max_x&&g.max_x>=x.min_x&&g.min_y<x.max_y&&g.max_y>=x.min_y){var B=0;for(e=r.shapes.length;B<e;)t=B++,t=r.shapes[t].intersect(a),null!=
t&&c.data.push(t)}x.put();0<c.data.length?f.push(c):c.put();break;case 1:if(b=m.v,null==c)for(m=0;m<b.length;){if(r=b[m],++m,null!=r){x=r.bounds();t=xb.pool.get();t.line=a;t.body=r;t.data.length=0;t.pooled=!1;c=t;if(g.min_x<x.max_x&&g.max_x>=x.min_x&&g.min_y<x.max_y&&g.max_y>=x.min_y)for(B=0,e=r.shapes.length;B<e;)t=B++,t=r.shapes[t].intersect(a),null!=t&&c.data.push(t);x.put();0<c.data.length?f.push(c):c.put()}}else{m=0;for(B=oa.cached_collisions;m<B.length;)x=B[m],++m,x.put();oa.cached_collisions.length=
0;x=oa.cached_body;h=g.min_x;t=g.min_y;l=g.max_x;d=g.max_y;r=Gb.pool.get();m=.5*(h+l);B=.5*(t+d);h=l-h;d-=t;null==d&&(d=0);null==h&&(h=1);null==B&&(B=0);null==m&&(m=0);l=r.transform;l.dirty||l.set_dirty();l.local_x=m;l=r.transform;l.dirty||l.set_dirty();l.local_y=B;m=.5*h;l=r.transform;null==l.parent?B=l.local_scale_x:(l.sync(),B=l._scale_x);r.local_ex=m/B;if(null!=r.transformed_rect){l=r.transformed_rect;l.count=4;m=0;for(B=l.count;m<B;)if(t=m++,null==l.local_vertices[t]){var p=l.local_vertices,
n=new M(0,0);p[t]=n}m=l.local_vertices[0];m.x=-(r.local_ex*r.transform.local_scale_x);m.y=-(r.local_ey*r.transform.local_scale_y);m=l.local_vertices[1];m.x=r.local_ex*r.transform.local_scale_x;m.y=-(r.local_ey*r.transform.local_scale_y);m=l.local_vertices[2];m.x=r.local_ex*r.transform.local_scale_x;m.y=r.local_ey*r.transform.local_scale_y;m=l.local_vertices[3];m.x=-(r.local_ex*r.transform.local_scale_x);m.y=r.local_ey*r.transform.local_scale_y;m=r.transform.local_x;p=l.transform;p.dirty||p.set_dirty();
p.local_x=m;m=r.transform.local_y;p=l.transform;p.dirty||p.set_dirty();p.local_y=m;p=l.transform;m=Math.PI/180*(180/Math.PI)*r.transform.local_radians;p.dirty||p.set_dirty();p.local_radians=m;m=r.transform.local_scale_x;p=l.transform;p.dirty||p.set_dirty();p.local_scale_x=m;m=r.transform.local_scale_y;p=l.transform;p.dirty||p.set_dirty();p.local_scale_y=m;l.dirty_vertices=!0;l.dirty_bounds=!0}m=.5*(0>=d?h:d);l=r.transform;null==l.parent?B=l.local_scale_y:(l.sync(),B=l._scale_y);r.local_ey=m/B;if(null!=
r.transformed_rect){l=r.transformed_rect;l.count=4;m=0;for(B=l.count;m<B;)t=m++,null==l.local_vertices[t]&&(p=l.local_vertices,n=new M(0,0),p[t]=n);m=l.local_vertices[0];m.x=-(r.local_ex*r.transform.local_scale_x);m.y=-(r.local_ey*r.transform.local_scale_y);m=l.local_vertices[1];m.x=r.local_ex*r.transform.local_scale_x;m.y=-(r.local_ey*r.transform.local_scale_y);m=l.local_vertices[2];m.x=r.local_ex*r.transform.local_scale_x;m.y=r.local_ey*r.transform.local_scale_y;m=l.local_vertices[3];m.x=-(r.local_ex*
r.transform.local_scale_x);m.y=r.local_ey*r.transform.local_scale_y;m=r.transform.local_x;p=l.transform;p.dirty||p.set_dirty();p.local_x=m;m=r.transform.local_y;p=l.transform;p.dirty||p.set_dirty();p.local_y=m;p=l.transform;m=Math.PI/180*(180/Math.PI)*r.transform.local_radians;p.dirty||p.set_dirty();p.local_radians=m;m=r.transform.local_scale_x;p=l.transform;p.dirty||p.set_dirty();p.local_scale_x=m;m=r.transform.local_scale_y;p=l.transform;p.dirty||p.set_dirty();p.local_scale_y=m;l.dirty_vertices=
!0;l.dirty_bounds=!0}l=r.transform;m=Math.PI/180*0;l.dirty||l.set_dirty();l.local_radians=m;l=r.transform;l.dirty||l.set_dirty();l.local_scale_x=1;l=r.transform;l.dirty||l.set_dirty();l.local_scale_y=1;null==r.transformed_rect?(l=r.transform,null==l.parent?m=180/Math.PI*l.local_radians:(l.sync(),m=180/Math.PI*l._radians),m=0!=m):m=!1;if(m){h=ab.pool.get();h.count=4;m=0;for(B=h.count;m<B;)t=m++,null==h.local_vertices[t]&&(d=h.local_vertices,n=new M(0,0),d[t]=n);m=h.local_vertices[0];m.x=-(r.local_ex*
r.transform.local_scale_x);m.y=-(r.local_ey*r.transform.local_scale_y);m=h.local_vertices[1];m.x=r.local_ex*r.transform.local_scale_x;m.y=-(r.local_ey*r.transform.local_scale_y);m=h.local_vertices[2];m.x=r.local_ex*r.transform.local_scale_x;m.y=r.local_ey*r.transform.local_scale_y;m=h.local_vertices[3];m.x=-(r.local_ex*r.transform.local_scale_x);m.y=r.local_ey*r.transform.local_scale_y;m=r.transform.local_x;l=h.transform;l.dirty||l.set_dirty();l.local_x=m;m=r.transform.local_y;l=h.transform;l.dirty||
l.set_dirty();l.local_y=m;l=h.transform;m=Math.PI/180*(180/Math.PI)*r.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=m;m=r.transform.local_scale_x;l=h.transform;l.dirty||l.set_dirty();l.local_scale_x=m;m=r.transform.local_scale_y;l=h.transform;l.dirty||l.set_dirty();l.local_scale_y=m;h.dirty_vertices=!0;h.dirty_bounds=!0;h.pooled=!1;r.transformed_rect=h;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(m=r.transform.local_x,l=r.transformed_rect.transform,l.dirty||
l.set_dirty(),l.local_x=m,m=r.transform.local_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_y=m,l=r.transformed_rect.transform,m=Math.PI/180*(180/Math.PI)*r.transform.local_radians,l.dirty||l.set_dirty(),l.local_radians=m,m=r.transform.local_scale_x,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_x=m,m=r.transform.local_scale_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_y=m);r.pooled=!1;null!=x.shapes[0]&&x.shapes[0].put();x.shapes[0]=
r;x.shapes[0].set_parent(x);x.dirty=!0;0>=x.mass&&null!=x.world&&(x.bounds(x.quadtree_data.bounds),x.world.static_quadtree.update(x.quadtree_data));e&&Ea.update_quadtree(c);Ea.overlap_body_and_bodies_bounds(oa.cached_body,b,c,oa.cached_collisions);m=0;for(B=oa.cached_collisions;m<B.length;){x=B[m];++m;r=x.b;t=xb.pool.get();t.line=a;t.body=r;t.data.length=0;t.pooled=!1;c=t;e=0;for(b=x.b.shapes.length;e<b;)t=e++,t=x.b.shapes[t].intersect(a),null!=t&&c.data.push(t);0<c.data.length?f.push(c):c.put()}oa.cached_body.shapes[0].put()}}g.put();
return f};oa.undo=function(a){if(null!=a.history){var b=a.history.undo();if(null!=b){for(var c=0;c<b.length;){var e=b[c];++c;for(var f=0,h=a.members;f<h.length;){var t=h[f];++f;if(e.id==t.id){var l=e.x,d=t.transform;d.dirty||d.set_dirty();d.local_x=l;if(null!=t.on_move)t.on_move(t.transform.local_x,t.transform.local_y);l=e.y;d=t.transform;d.dirty||d.set_dirty();d.local_y=l;if(null!=t.on_move)t.on_move(t.transform.local_x,t.transform.local_y);l=t.transform;d=Math.PI/180*e.rotation;l.dirty||l.set_dirty();
l.local_radians=d;if(null!=t.on_rotate)t.on_rotate(180/Math.PI*t.transform.local_radians);l=t.velocity;l.x=e.velocity_x;l.y=e.velocity_y;l=t.acceleration;l.x=e.acceleration_x;l.y=e.acceleration_y;t.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}}return a};oa.redo=function(a){if(null!=a.history){var b=a.history.redo();if(null!=b)for(var c=0;c<b.length;){var e=b[c];++c;for(var f=0,h=a.members;f<h.length;){var t=h[f];++f;if(e.id==t.id){var l=e.x,d=t.transform;d.dirty||d.set_dirty();
d.local_x=l;if(null!=t.on_move)t.on_move(t.transform.local_x,t.transform.local_y);l=e.y;d=t.transform;d.dirty||d.set_dirty();d.local_y=l;if(null!=t.on_move)t.on_move(t.transform.local_x,t.transform.local_y);l=t.transform;d=Math.PI/180*e.rotation;l.dirty||l.set_dirty();l.local_radians=d;if(null!=t.on_rotate)t.on_rotate(180/Math.PI*t.transform.local_radians);l=t.velocity;l.x=e.velocity_x;l.y=e.velocity_y;l=t.acceleration;l.x=e.acceleration_x;l.y=e.acceleration_y;t.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}return a};
var Xb=function(){};n["echo.util.Poolable"]=Xb;Xb.__name__=!0;Xb.__isInterface__=!0;var Jb=function(){};n["echo.util.Pool"]=Jb;Jb.__name__=!0;Jb.__isInterface__=!0;var vc=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_Line"]=vc;vc.__name__=!0;vc.__interfaces__=[Jb];vc.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:vc};var Fb=function(a,
b,c,e){null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this.pooled=!1;this.start=a=new M(a,b);this.end=a=new M(c,e)};n["echo.Line"]=Fb;Fb.__name__=!0;Fb.__interfaces__=[Xb];Fb.prototype={set_from_vector:function(a,b,c){var e=Math.PI/180*b;b=a.x;var f=a.y,h=a.x+c*Math.cos(e);a=a.y+c*Math.sin(e);null==a&&(a=1);null==h&&(h=1);null==f&&(f=0);null==b&&(b=0);c=this.start;c.x=b;c.y=f;c=this.end;c.x=h;c.y=a;return this},get_x:function(){return this.start.x},get_y:function(){return this.start.y},
get_dx:function(){return this.end.x},get_dy:function(){return this.end.y},__class__:Fb,__properties__:{get_dy:"get_dy",get_dx:"get_dx",get_y:"get_y",get_x:"get_x"}};var Pb=function(a,b,c,e,f,h,t,l,d,g,m,r){this.a=a;this.b=b;this.separate=c;this.collisions=e;this.last_collisions=f;this.enter=h;this.stay=t;this.exit=l;this.condition=d;this.quadtree_results=g;this.percent_correction=m;this.correction_threshold=r};n["echo.Listener"]=Pb;Pb.__name__=!0;Pb.__properties__={get_defaults:"get_defaults"};Pb.get_defaults=
function(){return{separate:!0,percent_correction:.9,correction_threshold:.013}};Pb.prototype={__class__:Pb};var tc=function(a,b,c,e,f){this.gravity_scale=1;this.friction=this.static_friction=0;this.density=1;this.elasticity=0;null!=a&&(this.elasticity=a);null!=b&&(this.density=b);null!=c&&(this.friction=c);null!=e&&(this.static_friction=e);null!=f&&(this.gravity_scale=f)};n["echo.Material"]=tc;tc.__name__=!0;tc.prototype={__class__:tc};var Yc=function(){};n["echo.Physics"]=Yc;Yc.__name__=!0;Yc.step=
function(a,b){for(var c=0,e=a.members;c<e.length;){var f=e[c];++c;if(0<f.mass&&!f.disposed&&f.active){f.last_x=f.transform.local_x;f.last_y=f.transform.local_y;f.last_rotation=180/Math.PI*f.transform.local_radians;var h=f.acceleration.x*f.inverse_mass,t=f.acceleration.y*f.inverse_mass;f.kinematic||(h+=a.gravity.x*f.material.gravity_scale,t+=a.gravity.y*f.material.gravity_scale);var l=f.velocity.x,d=f.drag.x,g=f.max_velocity.x;1E-5>=Math.abs(h)?1E-5>=Math.abs(d)||(d*=b,l=0<l-d?l-d:0>l+d?l+d:0):l+=
h*b;1E-5>=Math.abs(g)||(h=-g,l<h?l=h:l>g&&(l=g));f.velocity.x=l;l=f.velocity.y;h=f.drag.y;g=f.max_velocity.y;1E-5>=Math.abs(t)?1E-5>=Math.abs(h)||(h*=b,l=0<l-h?l-h:0>l+h?l+h:0):l+=t*b;1E-5>=Math.abs(g)||(t=-g,l<t?l=t:l>g&&(l=g));f.velocity.y=l;0<f.drag_length?(t=f.acceleration,t=0==t.x&&0==t.y):t=!1;t?(t=f.velocity,t=!(0==t.x&&0==t.y)):t=!1;t&&(t=g=f.velocity,t=Math.sqrt(t.x*t.x+t.y*t.y)-f.drag_length*b,h=l=g,h=h.x*h.x+h.y*h.y,h=0==h?1:Math.sqrt(h),d=g.y/h*t,l.x=g.x/h*t,l.y=d);0<f.max_velocity_length?
(t=f.velocity,t=Math.sqrt(t.x*t.x+t.y*t.y)>f.max_velocity_length):t=!1;t&&(g=f.velocity,t=f.max_velocity_length,h=l=g,h=h.x*h.x+h.y*h.y,h=0==h?1:Math.sqrt(h),d=g.y/h*t,l.x=g.x/h*t,l.y=d);t=f.transform.local_x+f.velocity.x*b;l=f.transform;l.dirty||l.set_dirty();l.local_x=t;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y);t=f.transform.local_y+f.velocity.y*b;l=f.transform;l.dirty||l.set_dirty();l.local_y=t;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y);t=
f.rotational_velocity;g=f.rotational_drag;h=f.torque*f.inverse_mass;l=f.max_rotational_velocity;1E-5>=Math.abs(g)?1E-5>=Math.abs(h)||(h*=b,t=0<t-h?t-h:0>t+h?t+h:0):t+=g*b;1E-5>=Math.abs(l)||(g=-l,t<g?t=g:t>l&&(t=l));f.rotational_velocity=t;t=f.transform;l=Math.PI/180*(180/Math.PI*f.transform.local_radians+f.rotational_velocity*b);t.dirty||t.set_dirty();t.local_radians=l;if(null!=f.on_rotate)f.on_rotate(180/Math.PI*f.transform.local_radians)}}};Yc.separate=function(a,b){a=null==b?a.listeners.members:
b.members;for(b=0;b<a.length;){var c=a[b];++b;if(c.separate)for(var e=0,f=c.collisions;e<f.length;){var h=f[e];++e;for(var t=0,l=h.data.length;t<l;){var d=t++,g=h.a,m=h.b;d=h.data[d];var r=c.correction_threshold,x=c.percent_correction;null==x&&(x=.9);null==r&&(r=.013);if(d.sa.solid&&d.sb.solid&&g.active&&m.active&&!g.disposed&&!m.disposed&&!(0>=g.mass&&0>=m.mass)){var B=(g.velocity.x-m.velocity.x)*d.normal.x+(g.velocity.y-m.velocity.y)*d.normal.y,p=g.inverse_mass+m.inverse_mass;if(0<B){var n=-(1+
.5*(g.material.elasticity+m.material.elasticity))*B/p;B=-n*d.normal.x;n=-n*d.normal.y;g.kinematic||(g.velocity.x-=B*g.inverse_mass,g.velocity.y-=n*g.inverse_mass);m.kinematic||(m.velocity.x+=B*m.inverse_mass,m.velocity.y+=n*m.inverse_mass)}x*=Math.max(d.overlap-r,0)/p;r=x*d.normal.x;d=x*d.normal.y;if(!g.kinematic){x=g.transform.local_x-g.inverse_mass*r;p=g.transform;p.dirty||p.set_dirty();p.local_x=x;if(null!=g.on_move)g.on_move(g.transform.local_x,g.transform.local_y);x=g.transform.local_y-g.inverse_mass*
d;p=g.transform;p.dirty||p.set_dirty();p.local_y=x;if(null!=g.on_move)g.on_move(g.transform.local_x,g.transform.local_y)}if(!m.kinematic){g=m.transform.local_x+m.inverse_mass*r;r=m.transform;r.dirty||r.set_dirty();r.local_x=g;if(null!=m.on_move)m.on_move(m.transform.local_x,m.transform.local_y);g=m.transform.local_y+m.inverse_mass*d;d=m.transform;d.dirty||d.set_dirty();d.local_y=g;if(null!=m.on_move)m.on_move(m.transform.local_x,m.transform.local_y)}}}}}};var Ra=function(a,b,c){null==c&&(c=0);null==
b&&(b=0);null==a&&(a=0);this.solid=!0;var e=this.transform=new sc;e.dirty||e.set_dirty();e.local_x=a;e=this.transform;e.dirty||e.set_dirty();e.local_y=b;e=this.transform;a=Math.PI/180*c;e.dirty||e.set_dirty();e.local_radians=a};n["echo.Shape"]=Ra;Ra.__name__=!0;Ra.__properties__={get_defaults:"get_defaults"};Ra.get=function(a){a=cd.copy_fields(a,Ra.get_defaults());switch(a.type){case 0:var b=a.offset_x,c=a.offset_y,e=a.width,f=a.height,h=a.rotation,t=a.scale_x,l=a.scale_y;null==l&&(l=1);null==t&&
(t=1);null==h&&(h=0);null==f&&(f=0);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);var d=Gb.pool.get();var g=b,m=c;b=f;null==l&&(l=1);null==t&&(t=1);null==h&&(h=0);null==b&&(b=0);null==e&&(e=1);null==m&&(m=0);null==g&&(g=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=g;c=d.transform;c.dirty||c.set_dirty();c.local_y=m;g=.5*e;c=d.transform;null==c.parent?m=c.local_scale_x:(c.sync(),m=c._scale_x);d.local_ex=g/m;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;g=0;for(m=c.count;g<m;)if(f=
g++,null==c.local_vertices[f]){var r=c.local_vertices,x=new M(0,0);r[f]=x}g=c.local_vertices[0];g.x=-(d.local_ex*d.transform.local_scale_x);g.y=-(d.local_ey*d.transform.local_scale_y);g=c.local_vertices[1];g.x=d.local_ex*d.transform.local_scale_x;g.y=-(d.local_ey*d.transform.local_scale_y);g=c.local_vertices[2];g.x=d.local_ex*d.transform.local_scale_x;g.y=d.local_ey*d.transform.local_scale_y;g=c.local_vertices[3];g.x=-(d.local_ex*d.transform.local_scale_x);g.y=d.local_ey*d.transform.local_scale_y;
g=d.transform.local_x;r=c.transform;r.dirty||r.set_dirty();r.local_x=g;g=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=g;r=c.transform;g=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=g;g=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=g;g=d.transform.local_scale_y;r=c.transform;r.dirty||r.set_dirty();r.local_scale_y=g;c.dirty_vertices=!0;c.dirty_bounds=!0}g=.5*(0>=b?e:b);c=d.transform;null==c.parent?m=
c.local_scale_y:(c.sync(),m=c._scale_y);d.local_ey=g/m;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;g=0;for(m=c.count;g<m;)f=g++,null==c.local_vertices[f]&&(r=c.local_vertices,x=new M(0,0),r[f]=x);g=c.local_vertices[0];g.x=-(d.local_ex*d.transform.local_scale_x);g.y=-(d.local_ey*d.transform.local_scale_y);g=c.local_vertices[1];g.x=d.local_ex*d.transform.local_scale_x;g.y=-(d.local_ey*d.transform.local_scale_y);g=c.local_vertices[2];g.x=d.local_ex*d.transform.local_scale_x;g.y=d.local_ey*
d.transform.local_scale_y;g=c.local_vertices[3];g.x=-(d.local_ex*d.transform.local_scale_x);g.y=d.local_ey*d.transform.local_scale_y;g=d.transform.local_x;r=c.transform;r.dirty||r.set_dirty();r.local_x=g;g=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=g;r=c.transform;g=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=g;g=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=g;g=d.transform.local_scale_y;r=c.transform;
r.dirty||r.set_dirty();r.local_scale_y=g;c.dirty_vertices=!0;c.dirty_bounds=!0}c=d.transform;g=Math.PI/180*h;c.dirty||c.set_dirty();c.local_radians=g;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=t;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=l;null==d.transformed_rect?(c=d.transform,null==c.parent?l=180/Math.PI*c.local_radians:(c.sync(),l=180/Math.PI*c._radians),l=0!=l):l=!1;if(l){e=ab.pool.get();e.count=4;g=0;for(m=e.count;g<m;)f=g++,null==e.local_vertices[f]&&(l=e.local_vertices,
x=new M(0,0),l[f]=x);g=e.local_vertices[0];g.x=-(d.local_ex*d.transform.local_scale_x);g.y=-(d.local_ey*d.transform.local_scale_y);g=e.local_vertices[1];g.x=d.local_ex*d.transform.local_scale_x;g.y=-(d.local_ey*d.transform.local_scale_y);g=e.local_vertices[2];g.x=d.local_ex*d.transform.local_scale_x;g.y=d.local_ey*d.transform.local_scale_y;g=e.local_vertices[3];g.x=-(d.local_ex*d.transform.local_scale_x);g.y=d.local_ey*d.transform.local_scale_y;g=d.transform.local_x;c=e.transform;c.dirty||c.set_dirty();
c.local_x=g;g=d.transform.local_y;c=e.transform;c.dirty||c.set_dirty();c.local_y=g;c=e.transform;g=Math.PI/180*(180/Math.PI)*d.transform.local_radians;c.dirty||c.set_dirty();c.local_radians=g;g=d.transform.local_scale_x;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=g;g=d.transform.local_scale_y;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=g;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;d.transformed_rect=e;d.transformed_rect.set_parent(d.parent)}else null!=d.transformed_rect&&(g=
d.transform.local_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_x=g,g=d.transform.local_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_y=g,c=d.transformed_rect.transform,g=Math.PI/180*(180/Math.PI)*d.transform.local_radians,c.dirty||c.set_dirty(),c.local_radians=g,g=d.transform.local_scale_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_scale_x=g,g=d.transform.local_scale_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_scale_y=g);
d.pooled=!1;break;case 1:b=a.offset_x;c=a.offset_y;r=a.radius;h=a.rotation;t=a.scale_x;l=a.scale_y;null==l&&(l=1);null==t&&(t=1);null==h&&(h=0);null==r&&(r=1);null==c&&(c=0);null==b&&(b=0);d=Cb.pool.get();g=b;m=c;e=r;null==l&&(l=1);null==t&&(t=1);null==h&&(h=0);null==e&&(e=1);null==m&&(m=0);null==g&&(g=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=g;c=d.transform;c.dirty||c.set_dirty();c.local_y=m;c=d.transform;g=Math.PI/180*h;c.dirty||c.set_dirty();c.local_radians=g;c=d.transform;c.dirty||c.set_dirty();
c.local_scale_x=t;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=l;c=d.transform;null==c.parent?l=c.local_scale_x:(c.sync(),l=c._scale_x);d.local_radius=e/l;d.pooled=!1;break;case 2:if(null!=a.vertices)b=a.offset_x,c=a.offset_y,h=a.rotation,d=a.vertices,t=a.scale_x,l=a.scale_y,null==l&&(l=1),null==t&&(t=1),null==h&&(h=0),null==c&&(c=0),null==b&&(b=0),e=ab.pool.get(),g=b,m=c,null==l&&(l=1),null==t&&(t=1),null==h&&(h=0),null==m&&(m=0),null==g&&(g=0),c=e.transform,c.dirty||c.set_dirty(),c.local_x=
g,c=e.transform,c.dirty||c.set_dirty(),c.local_y=m,c=e.transform,g=Math.PI/180*h,c.dirty||c.set_dirty(),c.local_radians=g,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_x=t,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_y=l,l=null,e.local_vertices=null==d?[]:d;else{b=a.offset_x;c=a.offset_y;m=a.sides;r=a.radius;h=a.rotation;t=a.scale_x;l=a.scale_y;null==l&&(l=1);null==t&&(t=1);null==h&&(h=0);null==r&&(r=1);null==m&&(m=3);null==c&&(c=0);null==b&&(b=0);if(3>m)throw A.thrown("Polygons require 3 sides as a minimum");
e=ab.pool.get();var B=2*Math.PI/m;d=[];for(g=0;g<m;)f=g++,f=f*B+.5*(Math.PI-B),x=new M(Math.cos(f)*r,Math.sin(f)*r),d.push(x);g=b;m=c;null==l&&(l=1);null==t&&(t=1);null==h&&(h=0);null==m&&(m=0);null==g&&(g=0);c=e.transform;c.dirty||c.set_dirty();c.local_x=g;c=e.transform;c.dirty||c.set_dirty();c.local_y=m;c=e.transform;g=Math.PI/180*h;c.dirty||c.set_dirty();c.local_radians=g;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=t;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=l;l=null;e.local_vertices=
null==d?[]:d}e.count=null!=l&&0<=l?l:e.local_vertices.length;if(l>e.local_vertices.length)for(g=e.local_vertices.length,m=l;g<m;)f=g++,l=e.local_vertices,x=new M(0,0),l[f]=x;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;d=e}d.solid=a.solid;return d};Ra.get_defaults=function(){return{type:0,radius:1,width:1,height:0,sides:3,rotation:0,scale_x:1,scale_y:1,offset_x:0,offset_y:0,solid:!0}};Ra.prototype={put:function(){this.transform.set_parent(null);this.parent=null;this.collided=!1},set_parent:function(a){this.parent!=
a&&(this.parent=a,this.transform.set_parent(null==a?null:a.transform))},bounds:function(a){if(null==a){var b=this.transform;if(null==b.parent)var c=b.local_x;else b.sync(),c=b._x;b=this.transform;if(null==b.parent)var e=b.local_y;else b.sync(),e=b._y;var f=0;b=0;null==b&&(b=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);a=cb.pool.get();null==b&&(b=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);f*=.5;b*=.5;a.min_x=c-f;a.min_y=e-b;a.max_x=c+f;a.max_y=e+b;a.pooled=!1;return a}b=this.transform;null==
b.parent?c=b.local_x:(b.sync(),c=b._x);b=this.transform;null==b.parent?e=b.local_y:(b.sync(),e=b._y);b=f=0;null==b&&(b=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);f*=.5;b*=.5;a.min_x=c-f;a.min_y=e-b;a.max_x=c+f;a.max_y=e+b;return a},volume:function(){return 0},intersect:function(a){return null},collides:function(a){return null},collide_rect:function(a){return null},collide_circle:function(a){return null},collide_polygon:function(a){return null},__class__:Ra};var dd=function(a){this.members=null==
a.members?[]:a.members;this.init=!1;var b;if(1>a.width)throw A.thrown("World must have a width of at least 1");this.width=b=a.width;this.init&&this.reset_quadtrees();if(1>a.height)throw A.thrown("World must have a width of at least 1");this.height=b=a.height;this.init&&this.reset_quadtrees();this.x=null==a.x?0:a.x;this.init&&this.reset_quadtrees();this.y=null==a.y?0:a.y;this.init&&this.reset_quadtrees();this.gravity=new M(null==a.gravity_x?0:a.gravity_x,null==a.gravity_y?0:a.gravity_y);this.reset_quadtrees();
this.listeners=new qb(a.listeners);this.iterations=null==a.iterations?5:a.iterations;null!=a.history&&(this.history=new ge(a.history))};n["echo.World"]=dd;dd.__name__=!0;dd.__interfaces__=[mb];dd.prototype={add:function(a){if(a.world==this)return a;null!=a.world&&(null!=a.world&&a.world.remove(a),null!=a.quadtree_data&&null!=a.quadtree_data.bounds&&a.quadtree_data.bounds.put());a.world=this;a.dirty=!0;this.members.push(a);a.quadtree_data=new he(a.id,a.bounds(),!1);0>=a.mass?this.static_quadtree.insert(a.quadtree_data):
this.quadtree.insert(a.quadtree_data);return a},remove:function(a){this.quadtree.remove(a.quadtree_data);this.static_quadtree.remove(a.quadtree_data);G.remove(this.members,a);a.world=null;return a},reset_quadtrees:function(){this.init=!0;if(null!=this.quadtree){var a=this.quadtree;if(!a.pooled){a.pooled=!0;for(var b=0,c=a.children.length;b<c;){var e=b++;if(null!=a.children[e]){a.children[e].clear_children();var f=a.children[e];f.pooled||(f.pooled=!0,f.clear_children(),f.contents.length=0,f.contents_count=
0,f.nodes_list.length=0,Na.pool.put_unsafe(f));a.children[e]=null}}a.contents.length=0;a.contents_count=0;a.nodes_list.length=0;Na.pool.put_unsafe(a)}}var h=Na.pool.get();c=b=0;var t=1,l=1;null==l&&(l=1);null==t&&(t=1);null==c&&(c=0);null==b&&(b=0);t*=.5;l*=.5;h.min_x=b-t;h.min_y=c-l;h.max_x=b+t;h.max_y=c+l;b=0;for(c=h.children.length;b<c;)e=b++,null!=h.children[e]&&(h.children[e].clear_children(),a=h.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=0,a.nodes_list.length=
0,Na.pool.put_unsafe(a)),h.children[e]=null);h.contents.length=0;h.contents_count=0;h.pooled=!1;this.quadtree=h;if(null!=this.static_quadtree&&(a=this.static_quadtree,!a.pooled)){a.pooled=!0;b=0;for(c=a.children.length;b<c;)e=b++,null!=a.children[e]&&(a.children[e].clear_children(),f=a.children[e],f.pooled||(f.pooled=!0,f.clear_children(),f.contents.length=0,f.contents_count=0,f.nodes_list.length=0,Na.pool.put_unsafe(f)),a.children[e]=null);a.contents.length=0;a.contents_count=0;a.nodes_list.length=
0;Na.pool.put_unsafe(a)}h=Na.pool.get();c=b=0;l=t=1;null==l&&(l=1);null==t&&(t=1);null==c&&(c=0);null==b&&(b=0);t*=.5;l*=.5;h.min_x=b-t;h.min_y=c-l;h.max_x=b+t;h.max_y=c+l;b=0;for(c=h.children.length;b<c;)e=b++,null!=h.children[e]&&(h.children[e].clear_children(),a=h.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=0,a.nodes_list.length=0,Na.pool.put_unsafe(a)),h.children[e]=null);h.contents.length=0;h.contents_count=0;h.pooled=!1;this.static_quadtree=h;h=
null;if(null!=h){b=this.x+.5*this.width;c=this.y+.5*this.height;t=this.width;l=this.height;null==l&&(l=0);null==t&&(t=1);null==c&&(c=0);null==b&&(b=0);a=h.transform;a.dirty||a.set_dirty();a.local_x=b;a=h.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*t;a=h.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);h.local_ex=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)if(e=b++,null==a.local_vertices[e]){f=a.local_vertices;var d=new M(0,0);f[e]=
d}b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;
b=h.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=h.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=h.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*(0>=l?t:l);a=h.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);h.local_ey=b/a;if(null!=h.transformed_rect){a=
h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,d=new M(0,0),f[e]=d);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);
b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=h.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=h.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=h.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=h.transform;
b=Math.PI/180*0;a.dirty||a.set_dirty();a.local_radians=b;a=h.transform;a.dirty||a.set_dirty();a.local_scale_x=1;a=h.transform;a.dirty||a.set_dirty();a.local_scale_y=1;null==h.transformed_rect?(a=h.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){l=ab.pool.get();l.count=4;b=0;for(c=l.count;b<c;)e=b++,null==l.local_vertices[e]&&(a=l.local_vertices,d=new M(0,0),a[e]=d);b=l.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*
h.transform.local_scale_y);b=l.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=l.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=l.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;a=l.transform;a.dirty||a.set_dirty();a.local_x=b;b=h.transform.local_y;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;
b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=h.transform.local_scale_x;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=h.transform.local_scale_y;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=b;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;h.transformed_rect=l;h.transformed_rect.set_parent(h.parent)}else null!=h.transformed_rect&&(b=h.transform.local_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=h.transform.local_y,
a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=h.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*h.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=h.transform.local_scale_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=h.transform.local_scale_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_y=b)}else{b=this.x+.5*this.width;c=this.y+.5*this.height;t=this.width;l=this.height;null==l&&(l=0);null==t&&(t=1);
null==c&&(c=0);null==b&&(b=0);h=Gb.pool.get();var g=0,m=1,r=1;null==r&&(r=1);null==m&&(m=1);null==g&&(g=0);null==l&&(l=0);null==t&&(t=1);null==c&&(c=0);null==b&&(b=0);a=h.transform;a.dirty||a.set_dirty();a.local_x=b;a=h.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*t;a=h.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);h.local_ex=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,d=new M(0,
0),f[e]=d);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=
b;b=h.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=h.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=h.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*(0>=l?t:l);a=h.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);h.local_ey=b/a;if(null!=h.transformed_rect){a=
h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,d=new M(0,0),f[e]=d);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);
b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=h.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=h.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=h.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=h.transform;
b=Math.PI/180*g;a.dirty||a.set_dirty();a.local_radians=b;a=h.transform;a.dirty||a.set_dirty();a.local_scale_x=m;a=h.transform;a.dirty||a.set_dirty();a.local_scale_y=r;null==h.transformed_rect?(a=h.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){l=ab.pool.get();l.count=4;b=0;for(c=l.count;b<c;)e=b++,null==l.local_vertices[e]&&(a=l.local_vertices,d=new M(0,0),a[e]=d);b=l.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*
h.transform.local_scale_y);b=l.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=l.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=l.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;a=l.transform;a.dirty||a.set_dirty();a.local_x=b;b=h.transform.local_y;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;
b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=h.transform.local_scale_x;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=h.transform.local_scale_y;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=b;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;h.transformed_rect=l;h.transformed_rect.set_parent(h.parent)}else null!=h.transformed_rect&&(b=h.transform.local_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=h.transform.local_y,
a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=h.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*h.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=h.transform.local_scale_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=h.transform.local_scale_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_y=b);h.pooled=!1}b=h.to_aabb(!0);a=this.quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;
a=this.static_quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;b=0;for(c=this.members;b<c.length;)h=c[b],++b,0<h.mass?h.dirty=!0:(h.bounds(h.quadtree_data.bounds),this.static_quadtree.update(h.quadtree_data))},__class__:dd};var fe=function(a,b,c,e,f,h,t,l,d){this.id=a;this.x=b;this.y=c;this.rotation=e;this.velocity_x=f;this.velocity_y=h;this.acceleration_x=t;this.acceleration_y=l;this.rotational_velocity=d};n["echo.data.BodyState"]=fe;fe.__name__=!0;fe.prototype={__class__:fe};
var Ad=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_data_Collision"]=Ad;Ad.__name__=!0;Ad.__interfaces__=[Jb];Ad.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Ad};var uc=function(){this.pooled=!1;this.data=[]};n["echo.data.Collision"]=uc;uc.__name__=!0;uc.__interfaces__=[Xb];uc.prototype={put:function(){if(!this.pooled){for(var a=
0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;uc.pool.put_unsafe(this)}},__class__:uc};var fd=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_data_CollisionData"]=fd;fd.__name__=!0;fd.__interfaces__=[Jb];fd.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:fd};var wc=function(){this.pooled=!1;var a=new M(0,0);this.normal=
a;a=new M(0,0);var b=new M(0,0);this.contacts=[a,b].slice(0);this.overlap=this.contact_count=0};n["echo.data.CollisionData"]=wc;wc.__name__=!0;wc.__interfaces__=[Xb];wc.prototype={put:function(){this.pooled||(this.pooled=!0,wc.pool.put_unsafe(this))},__class__:wc};var gd=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_data_Intersection"]=gd;gd.__name__=!0;gd.__interfaces__=[Jb];gd.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,[]):this.members[--this.count]},
put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:gd};var xb=function(){this.pooled=!1;this.data=[]};n["echo.data.Intersection"]=xb;xb.__name__=!0;xb.__interfaces__=[Xb];xb.prototype={put:function(){if(!this.pooled){for(var a=0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;xb.pool.put_unsafe(this)}},__class__:xb};var Bd=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_data_IntersectionData"]=Bd;Bd.__name__=!0;Bd.__interfaces__=
[Jb];Bd.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Bd};var Lb=function(){this.inverse_normal=this.pooled=!1;var a=new M(0,0);this.normal=a;this.distance=this.overlap=0;this.hit=a=new M(0,0);this.hit=a=new M(0,0);this.normal=a=new M(0,0)};n["echo.data.IntersectionData"]=Lb;Lb.__name__=!0;Lb.__interfaces__=[Xb];Lb.prototype={put:function(){this.pooled||(this.pooled=
!0,Lb.pool.put_unsafe(this))},__class__:Lb};var he=function(a,b,c){this.flag=!1;this.bounds=null;this.id=a;null!=b&&(this.bounds=b);null!=c&&(this.flag=c)};n["echo.data.QuadTreeData"]=he;he.__name__=!0;he.prototype={__class__:he};var ie=function(a,b,c,e,f,h,t,l,d){this.m00=a;this.m10=b;this.m20=c;this.m01=e;this.m11=f;this.m21=h;this.m02=t;this.m12=l;this.m22=d};n["echo.math.Matrix3Default"]=ie;ie.__name__=!0;ie.prototype={__class__:ie};var M=function(a,b){this.x=a;this.y=b};n["echo.math.Vector2Default"]=
M;M.__name__=!0;M.prototype={__class__:M};var Hc=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_shape_Circle"]=Hc;Hc.__name__=!0;Hc.__interfaces__=[Jb];Hc.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Hc};var Cb=function(){this.pooled=!1;Ra.call(this);this.type=1;var a=this.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=
a._scale_x);this.local_radius=0/a};n["echo.shape.Circle"]=Cb;Cb.__name__=!0;Cb.__interfaces__=[Xb];Cb.get=function(a,b,c,e,f,h){null==h&&(h=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var t=Cb.pool.get();null==h&&(h=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=t.transform;l.dirty||l.set_dirty();l.local_x=a;l=t.transform;l.dirty||l.set_dirty();l.local_y=b;l=t.transform;a=Math.PI/180*e;l.dirty||l.set_dirty();l.local_radians=a;
l=t.transform;l.dirty||l.set_dirty();l.local_scale_x=f;l=t.transform;l.dirty||l.set_dirty();l.local_scale_y=h;l=t.transform;null==l.parent?a=l.local_scale_x:(l.sync(),a=l._scale_x);t.local_radius=c/a;t.pooled=!1;return t};Cb.__super__=Ra;Cb.prototype=F(Ra.prototype,{put:function(){Ra.prototype.put.call(this);this.pooled||(this.pooled=!0,Cb.pool.put_unsafe(this))},bounds:function(a){var b=this.local_radius,c=this.transform;null==c.parent?c=c.local_scale_x:(c.sync(),c=c._scale_x);b=b*c*2;if(null==a){c=
this.transform;if(null==c.parent)var e=c.local_x;else c.sync(),e=c._x;c=this.transform;if(null==c.parent)var f=c.local_y;else c.sync(),f=c._y;c=b;null==b&&(b=1);null==c&&(c=1);null==f&&(f=0);null==e&&(e=0);a=cb.pool.get();null==b&&(b=1);null==c&&(c=1);null==f&&(f=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=f-b;a.max_x=e+c;a.max_y=f+b;a.pooled=!1;return a}c=this.transform;null==c.parent?e=c.local_x:(c.sync(),e=c._x);c=this.transform;null==c.parent?f=c.local_y:(c.sync(),f=c._y);c=b;null==b&&(b=
1);null==c&&(c=1);null==f&&(f=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=f-b;a.max_x=e+c;a.max_y=f+b;return a},volume:function(){var a=this.local_radius,b=this.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);a*=b;return Math.PI*a*a},intersect:function(a){return va.line_intersects_circle(a,this)},collides:function(a){return a.collide_circle(this)},collide_rect:function(a){return va.rect_and_circle(a,this,!0)},collide_circle:function(a){return va.circle_and_circle(a,this)},
collide_polygon:function(a){return va.circle_and_polygon(this,a,!0)},__class__:Cb});var hd=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_shape_Polygon"]=hd;hd.__name__=!0;hd.__interfaces__=[Jb];hd.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:hd};var ab=function(a){this.pooled=!1;Ra.call(this);this.type=2;this._vertices=[];this._normals=
[];var b=cb.pool.get(),c=0,e=0,f=1,h=1;null==h&&(h=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);f*=.5;h*=.5;b.min_x=c-f;b.min_y=e-h;b.max_x=c+f;b.max_y=e+h;b.pooled=!1;this._bounds=b;this.transform.on_dirty=q(this,this.on_dirty);this.local_vertices=null==a?[]:a;this.count=this.local_vertices.length;if(null>this.local_vertices.length)for(a=this.local_vertices.length;null>a;)b=a++,c=this.local_vertices,e=new M(0,0),c[b]=e;this.dirty_bounds=this.dirty_vertices=!0};n["echo.shape.Polygon"]=ab;ab.__name__=
!0;ab.__interfaces__=[Xb];ab.get=function(a,b,c,e,f,h,t){null==t&&(t=1);null==h&&(h=1);null==f&&(f=0);null==e&&(e=1);null==c&&(c=3);null==b&&(b=0);null==a&&(a=0);if(3>c)throw A.thrown("Polygons require 3 sides as a minimum");for(var l=ab.pool.get(),d=2*Math.PI/c,g,m=[],r=0;r<c;){g=r++;g=g*d+.5*(Math.PI-d);var x=new M(Math.cos(g)*e,Math.sin(g)*e);m.push(x)}r=a;null==t&&(t=1);null==h&&(h=1);null==f&&(f=0);null==b&&(b=0);null==r&&(r=0);a=l.transform;a.dirty||a.set_dirty();a.local_x=r;a=l.transform;a.dirty||
a.set_dirty();a.local_y=b;a=l.transform;f*=Math.PI/180;a.dirty||a.set_dirty();a.local_radians=f;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=h;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=t;l.local_vertices=null==m?[]:m;l.count=l.local_vertices.length;if(null>l.local_vertices.length)for(r=l.local_vertices.length,c=null;r<c;)g=r++,m=l.local_vertices,x=new M(0,0),m[g]=x;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;return l};ab.__super__=Ra;ab.prototype=F(Ra.prototype,{put:function(){Ra.prototype.put.call(this);
this.pooled||(this.pooled=!0,ab.pool.put_unsafe(this))},bounds:function(a){if(this.dirty_bounds){this.dirty_bounds=!1;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var f=this._vertices,h=new M(0,0);f[e]=h}var t=this.local_vertices[e].x,l=this.local_vertices[e].y;null==l&&(l=0);null==t&&(t=0);f=this.transform.get_local_to_world_matrix();h=
t;t=f.m01*h+f.m11*l+1*f.m21;var d=this._vertices[e];d.x=f.m00*h+f.m10*l+1*f.m20;d.y=t}}b=0;for(c=this.count;b<c;)e=b++,d=this._vertices[(e+1)%this.count],h=d.x,l=d.y,f=this._vertices[e],l-=f.y,h-=f.x,t=-l,l=h,h=t,null==this._normals[e]?(f=this._normals,h=new M(h,l),f[e]=h):(f=this._normals[e],f.x=h,f.y=l),l=e=h=this._normals[e],l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),f=h.y/l,e.x=h.x/l,e.y=f}d=this._vertices;h=d[0].x;l=d[0].y;f=d[0].x;t=d[0].y;b=1;for(c=this.count;b<c;)e=b++,d[e].x<h&&(h=d[e].x),d[e].y<
l&&(l=d[e].y),d[e].x>f&&(f=d[e].x),d[e].y>t&&(t=d[e].y);b=this._bounds;b.min_x=h;b.max_x=f;b.min_y=l;b.max_y=t}if(null==a)return b=this._bounds,a=b.min_x,c=b.min_y,e=b.max_x,h=b.max_y,b=cb.pool.get(),b.min_x=a,b.max_x=e,b.min_y=c,b.max_y=h,b.pooled=!1,b;b=this._bounds;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;return a},volume:function(){var a=0;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<
c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var f=this._vertices,h=new M(0,0);f[e]=h}var t=this.local_vertices[e].x,l=this.local_vertices[e].y;null==l&&(l=0);null==t&&(t=0);f=this.transform.get_local_to_world_matrix();h=t;var d=f.m01*h+f.m11*l+1*f.m21;t=this._vertices[e];t.x=f.m00*h+f.m10*l+1*f.m20;t.y=d}}b=0;for(c=this.count;b<c;)e=b++,t=this._vertices[(e+1)%this.count],h=t.x,l=t.y,f=this._vertices[e],l-=f.y,h-=f.x,t=-l,l=h,h=t,null==this._normals[e]?(f=this._normals,
h=new M(h,l),f[e]=h):(f=this._normals[e],f.x=h,f.y=l),l=e=h=this._normals[e],l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),f=h.y/l,e.x=h.x/l,e.y=f}h=this._vertices;t=h[h.length-1];b=0;for(c=this.count;b<c;)e=b++,e=h[e],a+=e.x*t.y-t.x*e.y,t=e;return.5*Math.abs(a)},intersect:function(a){return va.line_intersects_polygon(a,this)},collides:function(a){return a.collide_polygon(this)},collide_rect:function(a){return va.rect_and_polygon(a,this,!0)},collide_circle:function(a){return va.circle_and_polygon(a,this)},
collide_polygon:function(a){return va.polygon_and_polygon(a,this,!0)},on_dirty:function(a){this.dirty_bounds=this.dirty_vertices=!0},__class__:ab});var Pc=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_shape_Rect"]=Pc;Pc.__name__=!0;Pc.__interfaces__=[Jb];Pc.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Pc};var Gb=function(){this.pooled=
!1;Ra.call(this);this.local_ex=0;if(null!=this.transformed_rect){var a=this.transformed_rect;a.count=4;for(var b=0,c=a.count;b<c;){var e=b++;if(null==a.local_vertices[e]){var f=a.local_vertices,h=new M(0,0);f[e]=h}}b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;
b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=this.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=this.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=
b;b=this.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.local_ey=0;if(null!=this.transformed_rect){a=this.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,h=new M(0,0),f[e]=h);b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*
this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=this.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;f.dirty||f.set_dirty();
f.local_radians=b;b=this.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=this.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.type=0;this.transform.on_dirty=q(this,this.on_dirty)};n["echo.shape.Rect"]=Gb;Gb.__name__=!0;Gb.__interfaces__=[Xb];Gb.get=function(a,b,c,e,f,h,t){null==t&&(t=1);null==h&&(h=1);null==f&&(f=0);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=Gb.pool.get(),
d=b;null==t&&(t=1);null==h&&(h=1);null==f&&(f=0);null==e&&(e=0);null==c&&(c=1);null==d&&(d=0);null==a&&(a=0);b=l.transform;b.dirty||b.set_dirty();b.local_x=a;b=l.transform;b.dirty||b.set_dirty();b.local_y=d;a=.5*c;b=l.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);l.local_ex=a/b;if(null!=l.transformed_rect){b=l.transformed_rect;b.count=4;a=0;for(d=b.count;a<d;){var g=a++;if(null==b.local_vertices[g]){var m=b.local_vertices,r=new M(0,0);m[g]=r}}a=b.local_vertices[0];a.x=-(l.local_ex*
l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=b.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;m=b.transform;m.dirty||m.set_dirty();m.local_x=a;a=l.transform.local_y;m=b.transform;m.dirty||
m.set_dirty();m.local_y=a;m=b.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;m.dirty||m.set_dirty();m.local_radians=a;a=l.transform.local_scale_x;m=b.transform;m.dirty||m.set_dirty();m.local_scale_x=a;a=l.transform.local_scale_y;m=b.transform;m.dirty||m.set_dirty();m.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}a=.5*(0>=e?c:e);b=l.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);l.local_ey=a/b;if(null!=l.transformed_rect){b=l.transformed_rect;b.count=4;
a=0;for(d=b.count;a<d;)g=a++,null==b.local_vertices[g]&&(m=b.local_vertices,r=new M(0,0),m[g]=r);a=b.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=b.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;
a=l.transform.local_x;m=b.transform;m.dirty||m.set_dirty();m.local_x=a;a=l.transform.local_y;m=b.transform;m.dirty||m.set_dirty();m.local_y=a;m=b.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;m.dirty||m.set_dirty();m.local_radians=a;a=l.transform.local_scale_x;m=b.transform;m.dirty||m.set_dirty();m.local_scale_x=a;a=l.transform.local_scale_y;m=b.transform;m.dirty||m.set_dirty();m.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}b=l.transform;a=Math.PI/180*f;b.dirty||b.set_dirty();
b.local_radians=a;b=l.transform;b.dirty||b.set_dirty();b.local_scale_x=h;b=l.transform;b.dirty||b.set_dirty();b.local_scale_y=t;null==l.transformed_rect?(b=l.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*b._radians),c=0!=c):c=!1;if(c){c=ab.pool.get();c.count=4;a=0;for(d=c.count;a<d;)g=a++,null==c.local_vertices[g]&&(e=c.local_vertices,r=new M(0,0),e[g]=r);a=c.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);
a=c.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=c.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=c.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=a;a=l.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=a;b=c.transform;a=Math.PI/180*(180/Math.PI)*
l.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=a;a=l.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=a;a=l.transform.local_scale_y;b=c.transform;b.dirty||b.set_dirty();b.local_scale_y=a;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;l.transformed_rect=c;l.transformed_rect.set_parent(l.parent)}else null!=l.transformed_rect&&(a=l.transform.local_x,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=a,a=l.transform.local_y,b=l.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_y=a,b=l.transformed_rect.transform,a=Math.PI/180*(180/Math.PI)*l.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=a,a=l.transform.local_scale_x,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=a,a=l.transform.local_scale_y,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=a);l.pooled=!1;return l};Gb.__super__=Ra;Gb.prototype=F(Ra.prototype,{put:function(){Ra.prototype.put.call(this);null!=this.transformed_rect&&
(this.transformed_rect.put(),this.transformed_rect=null);this.pooled||(this.pooled=!0,Gb.pool.put_unsafe(this))},to_aabb:function(a){null==a&&(a=!1);if(a){a=null;if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;b=0!=c}else b=!1;if(b)a=this.transformed_rect.bounds(a);else if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),
c=b._y);var f=2*this.local_ex;b=this.transform;if(null==b.parent)var h=b.local_scale_x;else b.sync(),h=b._scale_x;f*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);b=cb.pool.get();null==h&&(h=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;h*=.5;b.min_x=e-f;b.min_y=c-h;b.max_x=e+f;b.max_y=c+h;b.pooled=!1;a=b}else b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,
null==b.parent?c=b.local_y:(b.sync(),c=b._y),f=2*this.local_ex,b=this.transform,null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x),f*=h,h=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),h*=b,null==h&&(h=1),null==f&&(f=1),null==c&&(c=0),null==e&&(e=0),f*=.5,h*=.5,a.min_x=e-f,a.min_y=c-h,a.max_x=e+f,a.max_y=c+h;this.put();return a}a=null;null!=this.transformed_rect?(b=this.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*
b._radians),c=0!=c):c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a)return b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,null==b.parent?c=b.local_y:(b.sync(),c=b._y),f=2*this.local_ex,b=this.transform,null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x),f*=h,h=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),h*=b,null==h&&(h=1),null==f&&(f=1),null==c&&(c=0),null==e&&(e=0),a=cb.pool.get(),null==h&&(h=1),null==
f&&(f=1),null==c&&(c=0),null==e&&(e=0),f*=.5,h*=.5,a.min_x=e-f,a.min_y=c-h,a.max_x=e+f,a.max_y=c+h,a.pooled=!1,a;b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);f=2*this.local_ex;b=this.transform;null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x);f*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;h*=.5;
a.min_x=e-f;a.min_y=c-h;a.max_x=e+f;a.max_y=c+h;return a},bounds:function(a){if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;c=0!=c}else c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);var f=2*this.local_ex;b=this.transform;if(null==b.parent)var h=b.local_scale_x;
else b.sync(),h=b._scale_x;f*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);a=cb.pool.get();null==h&&(h=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;h*=.5;a.min_x=e-f;a.min_y=c-h;a.max_x=e+f;a.max_y=c+h;a.pooled=!1;return a}b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);f=2*this.local_ex;b=this.transform;
null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x);f*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;h*=.5;a.min_x=e-f;a.min_y=c-h;a.max_x=e+f;a.max_y=c+h;return a},volume:function(){var a=2*this.local_ex,b=this.transform;if(null==b.parent)var c=b.local_scale_x;else b.sync(),c=b._scale_x;var e=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);
return a*c*e*b},intersect:function(a){return va.line_intersects_rect(a,this)},collides:function(a){return a.collide_rect(this)},collide_rect:function(a){return va.rect_and_rect(a,this)},collide_circle:function(a){return va.rect_and_circle(this,a)},collide_polygon:function(a){return va.rect_and_polygon(this,a)},set_parent:function(a){Ra.prototype.set_parent.call(this,a);if(null==this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*
b._radians;c=0!=c}else c=!1;if(c){c=ab.pool.get();c.count=4;b=0;for(var e=c.count;b<e;){var f=b++;if(null==c.local_vertices[f]){var h=c.local_vertices,t=new M(0,0);h[f]=t}}e=c.local_vertices[0];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[1];e.x=this.local_ex*this.transform.local_scale_x;e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[2];e.x=this.local_ex*this.transform.local_scale_x;e.y=this.local_ey*this.transform.local_scale_y;
e=c.local_vertices[3];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=this.local_ey*this.transform.local_scale_y;e=this.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=e;e=this.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=e;b=c.transform;e=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=e;e=this.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=e;e=this.transform.local_scale_y;b=c.transform;
b.dirty||b.set_dirty();b.local_scale_y=e;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;this.transformed_rect=c;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(e=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=e,e=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=e,b=this.transformed_rect.transform,e=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=
e,e=this.transform.local_scale_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=e,e=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=e);null!=this.transformed_rect&&this.transformed_rect.set_parent(a)},on_dirty:function(a){if(null==this.transformed_rect){var b=this.transform;null==b.parent?a=180/Math.PI*b.local_radians:(b.sync(),a=180/Math.PI*b._radians);a=0!=a}else a=!1;if(a){a=ab.pool.get();a.count=4;b=0;for(var c=a.count;b<
c;){var e=b++;if(null==a.local_vertices[e]){var f=a.local_vertices,h=new M(0,0);f[e]=h}}c=a.local_vertices[0];c.x=-(this.local_ex*this.transform.local_scale_x);c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[1];c.x=this.local_ex*this.transform.local_scale_x;c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[2];c.x=this.local_ex*this.transform.local_scale_x;c.y=this.local_ey*this.transform.local_scale_y;c=a.local_vertices[3];c.x=-(this.local_ex*this.transform.local_scale_x);
c.y=this.local_ey*this.transform.local_scale_y;c=this.transform.local_x;b=a.transform;b.dirty||b.set_dirty();b.local_x=c;c=this.transform.local_y;b=a.transform;b.dirty||b.set_dirty();b.local_y=c;b=a.transform;c=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=c;c=this.transform.local_scale_x;b=a.transform;b.dirty||b.set_dirty();b.local_scale_x=c;c=this.transform.local_scale_y;b=a.transform;b.dirty||b.set_dirty();b.local_scale_y=c;a.dirty_vertices=!0;a.dirty_bounds=
!0;a.pooled=!1;this.transformed_rect=a;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(c=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=c,c=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=c,b=this.transformed_rect.transform,c=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=c,c=this.transform.local_scale_x,b=this.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_scale_x=c,c=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=c)},__class__:Gb});var Ic=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_util_AABB"]=Ic;Ic.__name__=!0;Ic.__interfaces__=[Jb];Ic.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Ic};var cb=
function(){this.pooled=!1;this.min_x=0;this.max_x=1;this.min_y=0;this.max_y=1};n["echo.util.AABB"]=cb;cb.__name__=!0;cb.__interfaces__=[Xb];cb.prototype={put:function(){this.pooled||(this.pooled=!0,cb.pool.put_unsafe(this))},__class__:cb};var We={_new:function(a){null==a&&(a=0);return a}},id=function(a){this.type=a;this.members=[];this.count=0};n["echo.util.GenericPool_echo_util_QuadTree"]=id;id.__name__=!0;id.__interfaces__=[Jb];id.prototype={get:function(){return 0==this.count?ia.createInstance(this.type,
[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:id};var ge=function(a){this.re=new Cd(a);this.un=new Cd(a)};n["echo.util.History_Array_echo_data_BodyState"]=ge;ge.__name__=!0;ge.prototype={redo:function(){var a=this.re.pop();null!=a&&this.un.push(a);return a},undo:function(){var a=this.un.pop();null!=a&&this.re.push(a);return a},add:function(a){this.un.push(a);this.re.reset()},__class__:ge};var cd=function(){};n["echo.util.JSON"]=cd;cd.__name__=
!0;cd.copy_fields=function(a,b){if(null==a)return b;if(null==b)b=H.copy(a);else for(var c=0,e=H.fields(a);c<e.length;){var f=e[c];++c;b[f]=H.field(a,f)}return b};var Na=function(a,b){null==b&&(b=0);this.nodes_list=[];this.max_contents=10;this.max_depth=5;cb.call(this);null!=a&&(this.min_x=a.min_x,this.max_x=a.max_x,this.min_y=a.min_y,this.max_y=a.max_y);this.depth=b;this.children=Array(4);this.contents=[];this.contents_count=0};n["echo.util.QuadTree"]=Na;Na.__name__=!0;Na.__super__=cb;Na.prototype=
F(cb.prototype,{put:function(){if(!this.pooled){this.pooled=!0;for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];e.pooled||(e.pooled=!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,Na.pool.put_unsafe(e));this.children[c]=null}}this.contents_count=this.contents.length=0;this.nodes_list.length=0;Na.pool.put_unsafe(this)}},insert:function(a){if(null!=a.bounds){var b=a.bounds;if(b.min_x<
this.max_x&&b.max_x>=this.min_x&&b.min_y<this.max_y&&b.max_y>=this.min_y)if(null==this.children[0]&&this.contents_count+1>this.max_contents&&this.split(),null==this.children[0])b=this.get_first_null(this.contents),-1==b?this.contents.push(a):this.contents[b]=a,this.contents_count++;else{b=0;for(var c=this.children;b<c.length;){var e=c[b];++b;e.insert(a)}}}},remove:function(a,b){null==b&&(b=!0);if(null==this.children[0]){for(b=0;b<this.contents.length;){if(null!=this.contents[b]&&this.contents[b].id==
a.id)return this.contents[b]=null,this.contents_count--,!0;++b}return!1}for(var c=!1,e=0,f=this.children;e<f.length;){var h=f[e];++e;null!=h&&h.remove(a)&&(c=!0)}b&&c&&this.shake();return c},update:function(a,b){null==b&&(b=!0);this.remove(a,b);this.insert(a)},query:function(a,b){if(this.min_x<a.max_x&&this.max_x>=a.min_x&&this.min_y<a.max_y&&this.max_y>=a.min_y)if(null==this.children[0])for(var c=0,e=this.contents;c<e.length;){var f=e[c];++c;if(null!=f){var h=f.bounds;h=h.min_x<a.max_x&&h.max_x>=
a.min_x&&h.min_y<a.max_y&&h.max_y>=a.min_y}else h=!1;h&&b.push(f)}else for(c=0,e=this.children;c<e.length;)f=e[c],++c,f.query(a,b)},shake:function(){if(null==this.children[0])return!1;var a=this.get_count();if(0==a){a=0;for(var b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){for(var e=this.children[c],f=0,h=e.children.length;f<h;){var t=f++;if(null!=e.children[t]){e.children[t].clear_children();var l=e.children[t];l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=
0,l.nodes_list.length=0,Na.pool.put_unsafe(l));e.children[t]=null}}f=this.children[c];if(!f.pooled){f.pooled=!0;h=0;for(e=f.children.length;h<e;)t=h++,null!=f.children[t]&&(f.children[t].clear_children(),l=f.children[t],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,Na.pool.put_unsafe(l)),f.children[t]=null);f.contents.length=0;f.contents_count=0;f.nodes_list.length=0;Na.pool.put_unsafe(f)}this.children[c]=null}}}else if(a<this.max_contents){this.nodes_list.length=
0;for(this.nodes_list.push(this);0<this.nodes_list.length;)if(b=this.nodes_list.shift(),b!=this&&null==b.children[0])for(a=0,b=b.contents;a<b.length;)c=b[a],++a,-1==this.contents.indexOf(c)&&(f=this.get_first_null(this.contents),-1==f?this.contents.push(c):this.contents[f]=c,this.contents_count++);else for(f=0,h=b.children;f<h.length;)a=h[f],++f,this.nodes_list.push(a);a=0;for(b=this.children.length;a<b;)if(c=a++,null!=this.children[c]){e=this.children[c];f=0;for(h=e.children.length;f<h;)t=f++,null!=
e.children[t]&&(e.children[t].clear_children(),l=e.children[t],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,Na.pool.put_unsafe(l)),e.children[t]=null);f=this.children[c];if(!f.pooled){f.pooled=!0;h=0;for(e=f.children.length;h<e;)t=h++,null!=f.children[t]&&(f.children[t].clear_children(),l=f.children[t],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,Na.pool.put_unsafe(l)),f.children[t]=
null);f.contents.length=0;f.contents_count=0;f.nodes_list.length=0;Na.pool.put_unsafe(f)}this.children[c]=null}return!0}return!1},split:function(){if(!(this.depth+1>=this.max_depth)){for(var a=.5*(this.max_x-this.min_x),b=.5*(this.max_y-this.min_y),c=0;4>c;){var e=c++,f=Na.pool.get(),h=0,t=0,l=1,d=1;null==d&&(d=1);null==l&&(l=1);null==t&&(t=0);null==h&&(h=0);l*=.5;d*=.5;f.min_x=h-l;f.min_y=t-d;f.max_x=h+l;f.max_y=t+d;h=0;for(t=f.children.length;h<t;)l=h++,null!=f.children[l]&&(f.children[l].clear_children(),
d=f.children[l],d.pooled||(d.pooled=!0,d.clear_children(),d.contents.length=0,d.contents_count=0,d.nodes_list.length=0,Na.pool.put_unsafe(d)),f.children[l]=null);f.contents.length=0;f.contents_count=0;f.pooled=!1;switch(e){case 0:h=this.min_x+a;t=this.min_y+b;f.min_x=this.min_x;f.max_x=h;f.min_y=this.min_y;f.max_y=t;break;case 1:h=this.min_y+b;f.min_x=this.min_x+a;f.max_x=this.max_x;f.min_y=this.min_y;f.max_y=h;break;case 2:h=this.min_x+a;f.min_x=this.min_x;f.max_x=h;f.min_y=this.min_y+b;f.max_y=
this.max_y;break;case 3:f.min_x=this.min_x+a,f.max_x=this.max_x,f.min_y=this.min_y+b,f.max_y=this.max_y}f.depth=this.depth+1;h=this.max_depth;t=0;for(l=f.children.length;t<l;)if(d=t++,null!=f.children[d]){d=f.children[d];for(var g=0,m=d.children.length;g<m;){var r=g++;null!=d.children[r]&&d.children[r].set_max_depth(h)}d.max_depth=h}f.max_depth=h;h=this.max_contents;t=0;for(l=f.children.length;t<l;)if(d=t++,null!=f.children[d]){d=f.children[d];g=0;for(m=d.children.length;g<m;)if(r=g++,null!=d.children[r]){r=
d.children[r];for(var x=0,B=r.children.length;x<B;){var p=x++;null!=r.children[p]&&r.children[p].set_max_depth(h)}r.max_depth=h}d.max_depth=h}f.max_contents=h;f.shake();h=0;for(t=this.contents.length;h<t;)l=h++,null!=this.contents[l]&&f.insert(this.contents[l]);this.children[e]=f}this.contents_count=this.contents.length=0}},clear_children:function(){for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];e.pooled||(e.pooled=
!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,Na.pool.put_unsafe(e));this.children[c]=null}}},reset_data_flags:function(){for(var a=0,b=this.contents.length;a<b;){var c=a++;null!=this.contents[c]&&(this.contents[c].flag=!1)}a=0;for(b=this.children.length;a<b;)c=a++,null!=this.children[c]&&this.children[c].reset_data_flags()},get_count:function(){this.reset_data_flags();for(var a=0,b=0,c=this.contents.length;b<c;){var e=b++;null!=this.contents[e]&&(this.contents[e].flag=
!0,++a)}this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;){var f=this.nodes_list.shift();if(null==f.children[0])for(b=0,c=f.contents.length;b<c;)e=b++,null==f.contents[e]||f.contents[e].flag||(++a,f.contents[e].flag=!0);else for(b=0,c=f.children.length;b<c;)e=b++,this.nodes_list.push(f.children[e])}return a},get_first_null:function(a){for(var b=0,c=a.length;b<c;){var e=b++;if(null==a[e])return e}return-1},set_max_depth:function(a){for(var b=0,c=this.children.length;b<
c;){var e=b++;null!=this.children[e]&&this.children[e].set_max_depth(a)}return this.max_depth=a},__class__:Na,__properties__:{get_count:"get_count",set_max_depth:"set_max_depth"}});var Cd=function(a){this.a=Array(a);this.reset()};n["echo.util.Ring_Array_echo_data_BodyState"]=Cd;Cd.__name__=!0;Cd.prototype={pop:function(){if(0>=this.i+this.left-this.start)return null;0==this.i&&(this.i=this.a.length,this.left=0);return this.a[--this.i]},push:function(a){this.i==this.a.length&&(0<this.left&&this.start==
this.i&&(this.start=0),this.i=0,this.left=this.a.length);this.i+this.left-this.start==this.a.length&&this.start++;this.a[this.i++]=a},reset:function(){this.left=this.start=this.i=0},__class__:Cd};var va=function(){};n["echo.util.SAT"]=va;va.__name__=!0;va.line_intersects_rect=function(a,b){if(null!=b.transformed_rect){var c=b.transform;if(null==c.parent)var e=180/Math.PI*c.local_radians;else c.sync(),e=180/Math.PI*c._radians;var f=0!=e}else f=!1;if(f)return b.transformed_rect.intersect(a);var h=null;
if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var t=180/Math.PI*c.local_radians;else c.sync(),t=180/Math.PI*c._radians;var l=0==t}else l=!0;if(l){c=b.transform;null==c.parent?l=c.local_x:(c.sync(),l=c._x);var d=l-b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var g=0,m=c.count;g<m;){var r=g++;if(null!=c.local_vertices[r]){if(null==c._vertices[r]){var x=c._vertices,
B=new M(0,0);x[r]=B}var p=c.local_vertices[r].x,n=c.local_vertices[r].y;null==n&&(n=0);null==p&&(p=0);var k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[r];u.x=K;u.y=F}}g=0;for(m=c.count;g<m;){r=g++;u=c._vertices[(r+1)%c.count];v=u.x;q=u.y;var w=c._vertices[r],ba=v-w.x,A=q-w.y;v=ba;q=A;p=-q;q=v;v=p;null==c._normals[r]?(x=c._normals,B=new M(v,q),x[r]=B):(k=c._normals[r],k.x=v,k.y=q);var y=c._normals[r],na=y,G=y,H=G,ha=
H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia;na.x=C;na.y=Va}}l=null==c._vertices[0]}else l=!0;if(l)x=c.transform,null==x.parent?d=x.local_x:(x.sync(),d=x._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();g=0;for(m=c.count;g<m;)r=g++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(x=c._vertices,B=new M(0,0),x[r]=B),p=c.local_vertices[r].x,n=c.local_vertices[r].y,null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),
v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[r],u.x=K,u.y=F);g=0;for(m=c.count;g<m;)r=g++,u=c._vertices[(r+1)%c.count],v=u.x,q=u.y,w=c._vertices[r],ba=v-w.x,A=q-w.y,v=ba,q=A,p=-q,q=v,v=p,null==c._normals[r]?(x=c._normals,B=new M(v,q),x[r]=B):(k=c._normals[r],k.x=v,k.y=q),H=G=na=y=c._normals[r],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}l=c._vertices[0].x;g=1;for(m=c.count;g<m;){r=g++;if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();for(var N=0,T=c.count;N<T;){var E=N++;null!=c.local_vertices[E]&&(null==c._vertices[E]&&(x=c._vertices,B=new M(0,0),x[E]=B),p=c.local_vertices[E].x,n=c.local_vertices[E].y,null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[E],u.x=K,u.y=F)}for(var qa=0,Ya=c.count;qa<Ya;){var L=qa++;y=c._vertices[(L+1)%c.count];var P=y.x,I=y.y;w=c._vertices[L];ba=
P-w.x;A=I-w.y;P=ba;I=A;var Ha=-I;I=P;P=Ha;if(null==c._normals[L]){var la=c._normals,V=new M(P,I);la[L]=V}else{var S=c._normals[L];S.x=P;S.y=I}var Z=c._normals[L];H=G=na=Z;ha=H.x*H.x+H.y*H.y;z=0==ha?1:Math.sqrt(ha);D=G.x/z;ia=G.y/z;C=D;Va=ia;na.x=C;na.y=Va}}if(c._vertices[r].x<l){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var aa=0,hb=c.count;aa<hb;){var Q=aa++;if(null!=c.local_vertices[Q]){if(null==c._vertices[Q]){var fa=c._vertices,ea=new M(0,0);
fa[Q]=ea}var da=c.local_vertices[Q].x,X=c.local_vertices[Q].y;null==X&&(X=0);null==da&&(da=0);var W=c.transform.get_local_to_world_matrix(),Ea=da,ka=X,mb=1,ua=W.m00*Ea+W.m10*ka+W.m20*mb,oa=W.m01*Ea+W.m11*ka+W.m21*mb,ma=ua,Ua=oa,pa=c._vertices[Q];pa.x=ma;pa.y=Ua}}for(var Da=0,Xa=c.count;Da<Xa;){var ca=Da++,Ca=c._vertices[(ca+1)%c.count],ja=Ca.x,rb=Ca.y,xa=c._vertices[ca],ra=ja-xa.x,sa=rb-xa.y;ja=ra;rb=sa;var qb=-rb;rb=ja;ja=qb;if(null==c._normals[ca]){var ta=c._normals,Aa=new M(ja,rb);ta[ca]=Aa}else{var ya=
c._normals[ca];ya.x=ja;ya.y=rb}var Fa=c._normals[ca],Ba=Fa,za=Fa,wa=za,$a=wa.x*wa.x+wa.y*wa.y,Ga=0==$a?1:Math.sqrt($a),Qa=za.x/Ga,Ma=za.y/Ga,Na=Qa,La=Ma;Ba.x=Na;Ba.y=La}}l=c._vertices[r].x}}d=l}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var db=180/Math.PI*c.local_radians;else c.sync(),db=180/Math.PI*c._radians;var Ia=0==db}else Ia=!0;if(Ia){c=b.transform;null==c.parent?Ia=c.local_x:(c.sync(),Ia=c._x);var Oa=Ia+b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=
c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();g=0;for(m=c.count;g<m;)r=g++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(x=c._vertices,B=new M(0,0),x[r]=B),p=c.local_vertices[r].x,n=c.local_vertices[r].y,null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[r],u.x=K,u.y=F);g=0;for(m=c.count;g<m;)r=g++,u=c._vertices[(r+1)%c.count],v=u.x,
q=u.y,w=c._vertices[r],ba=v-w.x,A=q-w.y,v=ba,q=A,p=-q,q=v,v=p,null==c._normals[r]?(x=c._normals,B=new M(v,q),x[r]=B):(k=c._normals[r],k.x=v,k.y=q),H=G=na=y=c._normals[r],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}Ia=null==c._vertices[0]}else Ia=!0;if(Ia)x=c.transform,null==x.parent?Oa=x.local_x:(x.sync(),Oa=x._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();g=0;for(m=c.count;g<m;)r=g++,null!=c.local_vertices[r]&&
(null==c._vertices[r]&&(x=c._vertices,B=new M(0,0),x[r]=B),p=c.local_vertices[r].x,n=c.local_vertices[r].y,null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[r],u.x=K,u.y=F);g=0;for(m=c.count;g<m;)r=g++,u=c._vertices[(r+1)%c.count],v=u.x,q=u.y,w=c._vertices[r],ba=v-w.x,A=q-w.y,v=ba,q=A,p=-q,q=v,v=p,null==c._normals[r]?(x=c._normals,B=new M(v,q),x[r]=B):(k=c._normals[r],k.x=v,k.y=q),H=G=na=y=
c._normals[r],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}Ia=c._vertices[0].x;g=1;for(m=c.count;g<m;){r=g++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();N=0;for(T=c.count;N<T;)E=N++,null!=c.local_vertices[E]&&(null==c._vertices[E]&&(x=c._vertices,B=new M(0,0),x[E]=B),p=c.local_vertices[E].x,n=c.local_vertices[E].y,null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*
q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[E],u.x=K,u.y=F);qa=0;for(Ya=c.count;qa<Ya;)L=qa++,y=c._vertices[(L+1)%c.count],P=y.x,I=y.y,w=c._vertices[L],ba=P-w.x,A=I-w.y,P=ba,I=A,Ha=-I,I=P,P=Ha,null==c._normals[L]?(la=c._normals,V=new M(P,I),la[L]=V):(S=c._normals[L],S.x=P,S.y=I),H=G=na=Z=c._normals[L],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}if(c._vertices[r].x>Ia){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();
aa=0;for(hb=c.count;aa<hb;)Q=aa++,null!=c.local_vertices[Q]&&(null==c._vertices[Q]&&(fa=c._vertices,ea=new M(0,0),fa[Q]=ea),da=c.local_vertices[Q].x,X=c.local_vertices[Q].y,null==X&&(X=0),null==da&&(da=0),W=c.transform.get_local_to_world_matrix(),Ea=da,ka=X,mb=1,ua=W.m00*Ea+W.m10*ka+W.m20*mb,oa=W.m01*Ea+W.m11*ka+W.m21*mb,ma=ua,Ua=oa,pa=c._vertices[Q],pa.x=ma,pa.y=Ua);Da=0;for(Xa=c.count;Da<Xa;)ca=Da++,Ca=c._vertices[(ca+1)%c.count],ja=Ca.x,rb=Ca.y,xa=c._vertices[ca],ra=ja-xa.x,sa=rb-xa.y,ja=ra,rb=
sa,qb=-rb,rb=ja,ja=qb,null==c._normals[ca]?(ta=c._normals,Aa=new M(ja,rb),ta[ca]=Aa):(ya=c._normals[ca],ya.x=ja,ya.y=rb),wa=za=Ba=Fa=c._normals[ca],$a=wa.x*wa.x+wa.y*wa.y,Ga=0==$a?1:Math.sqrt($a),Qa=za.x/Ga,Ma=za.y/Ga,Na=Qa,La=Ma,Ba.x=Na,Ba.y=La}Ia=c._vertices[r].x}}Oa=Ia}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var fb=180/Math.PI*c.local_radians;else c.sync(),fb=180/Math.PI*c._radians;var Qc=0==fb}else Qc=!0;if(Qc){c=b.transform;null==c.parent?Qc=c.local_y:(c.sync(),Qc=c._y);
var Ra=Qc-b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();g=0;for(m=c.count;g<m;)r=g++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(x=c._vertices,B=new M(0,0),x[r]=B),p=c.local_vertices[r].x,n=c.local_vertices[r].y,null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[r],
u.x=K,u.y=F);g=0;for(m=c.count;g<m;)r=g++,u=c._vertices[(r+1)%c.count],v=u.x,q=u.y,w=c._vertices[r],ba=v-w.x,A=q-w.y,v=ba,q=A,p=-q,q=v,v=p,null==c._normals[r]?(x=c._normals,B=new M(v,q),x[r]=B):(k=c._normals[r],k.x=v,k.y=q),H=G=na=y=c._normals[r],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}Qc=null==c._vertices[0]}else Qc=!0;if(Qc)x=c.transform,null==x.parent?Ra=x.local_y:(x.sync(),Ra=x._y);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>
c.count;)c._vertices.pop();g=0;for(m=c.count;g<m;)r=g++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(x=c._vertices,B=new M(0,0),x[r]=B),p=c.local_vertices[r].x,n=c.local_vertices[r].y,null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[r],u.x=K,u.y=F);g=0;for(m=c.count;g<m;)r=g++,u=c._vertices[(r+1)%c.count],v=u.x,q=u.y,w=c._vertices[r],ba=v-w.x,A=q-w.y,v=ba,q=A,p=-q,q=v,v=p,null==c._normals[r]?
(x=c._normals,B=new M(v,q),x[r]=B):(k=c._normals[r],k.x=v,k.y=q),H=G=na=y=c._normals[r],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}Qc=c._vertices[0].y;g=1;for(m=c.count;g<m;){r=g++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();N=0;for(T=c.count;N<T;)E=N++,null!=c.local_vertices[E]&&(null==c._vertices[E]&&(x=c._vertices,B=new M(0,0),x[E]=B),p=c.local_vertices[E].x,n=c.local_vertices[E].y,null==n&&(n=0),null==p&&
(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[E],u.x=K,u.y=F);qa=0;for(Ya=c.count;qa<Ya;)L=qa++,y=c._vertices[(L+1)%c.count],P=y.x,I=y.y,w=c._vertices[L],ba=P-w.x,A=I-w.y,P=ba,I=A,Ha=-I,I=P,P=Ha,null==c._normals[L]?(la=c._normals,V=new M(P,I),la[L]=V):(S=c._normals[L],S.x=P,S.y=I),H=G=na=Z=c._normals[L],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}if(c._vertices[r].y<Qc){if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();aa=0;for(hb=c.count;aa<hb;)Q=aa++,null!=c.local_vertices[Q]&&(null==c._vertices[Q]&&(fa=c._vertices,ea=new M(0,0),fa[Q]=ea),da=c.local_vertices[Q].x,X=c.local_vertices[Q].y,null==X&&(X=0),null==da&&(da=0),W=c.transform.get_local_to_world_matrix(),Ea=da,ka=X,mb=1,ua=W.m00*Ea+W.m10*ka+W.m20*mb,oa=W.m01*Ea+W.m11*ka+W.m21*mb,ma=ua,Ua=oa,pa=c._vertices[Q],pa.x=ma,pa.y=Ua);Da=0;for(Xa=c.count;Da<Xa;)ca=Da++,Ca=c._vertices[(ca+1)%c.count],ja=Ca.x,rb=Ca.y,
xa=c._vertices[ca],ra=ja-xa.x,sa=rb-xa.y,ja=ra,rb=sa,qb=-rb,rb=ja,ja=qb,null==c._normals[ca]?(ta=c._normals,Aa=new M(ja,rb),ta[ca]=Aa):(ya=c._normals[ca],ya.x=ja,ya.y=rb),wa=za=Ba=Fa=c._normals[ca],$a=wa.x*wa.x+wa.y*wa.y,Ga=0==$a?1:Math.sqrt($a),Qa=za.x/Ga,Ma=za.y/Ga,Na=Qa,La=Ma,Ba.x=Na,Ba.y=La}Qc=c._vertices[r].y}}Ra=Qc}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var cb=180/Math.PI*c.local_radians;else c.sync(),cb=180/Math.PI*c._radians;var Rc=0==cb}else Rc=!0;if(Rc){c=b.transform;
null==c.parent?Rc=c.local_y:(c.sync(),Rc=c._y);var ab=Rc+b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();g=0;for(m=c.count;g<m;)r=g++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(x=c._vertices,B=new M(0,0),x[r]=B),p=c.local_vertices[r].x,n=c.local_vertices[r].y,null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=
k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[r],u.x=K,u.y=F);g=0;for(m=c.count;g<m;)r=g++,u=c._vertices[(r+1)%c.count],v=u.x,q=u.y,w=c._vertices[r],ba=v-w.x,A=q-w.y,v=ba,q=A,p=-q,q=v,v=p,null==c._normals[r]?(x=c._normals,B=new M(v,q),x[r]=B):(k=c._normals[r],k.x=v,k.y=q),H=G=na=y=c._normals[r],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}Rc=null==c._vertices[0]}else Rc=!0;if(Rc)x=c.transform,null==x.parent?ab=x.local_y:(x.sync(),ab=x._y);else{if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();g=0;for(m=c.count;g<m;)r=g++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(x=c._vertices,B=new M(0,0),x[r]=B),p=c.local_vertices[r].x,n=c.local_vertices[r].y,null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[r],u.x=K,u.y=F);g=0;for(m=c.count;g<m;)r=g++,u=c._vertices[(r+1)%c.count],v=u.x,q=u.y,w=c._vertices[r],ba=v-w.x,A=q-w.y,v=ba,q=A,p=
-q,q=v,v=p,null==c._normals[r]?(x=c._normals,B=new M(v,q),x[r]=B):(k=c._normals[r],k.x=v,k.y=q),H=G=na=y=c._normals[r],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}Rc=c._vertices[0].y;g=1;for(m=c.count;g<m;){r=g++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();N=0;for(T=c.count;N<T;)E=N++,null!=c.local_vertices[E]&&(null==c._vertices[E]&&(x=c._vertices,B=new M(0,0),x[E]=B),p=c.local_vertices[E].x,n=c.local_vertices[E].y,
null==n&&(n=0),null==p&&(p=0),k=c.transform.get_local_to_world_matrix(),v=p,q=n,U=1,R=k.m00*v+k.m10*q+k.m20*U,O=k.m01*v+k.m11*q+k.m21*U,K=R,F=O,u=c._vertices[E],u.x=K,u.y=F);qa=0;for(Ya=c.count;qa<Ya;)L=qa++,y=c._vertices[(L+1)%c.count],P=y.x,I=y.y,w=c._vertices[L],ba=P-w.x,A=I-w.y,P=ba,I=A,Ha=-I,I=P,P=Ha,null==c._normals[L]?(la=c._normals,V=new M(P,I),la[L]=V):(S=c._normals[L],S.x=P,S.y=I),H=G=na=Z=c._normals[L],ha=H.x*H.x+H.y*H.y,z=0==ha?1:Math.sqrt(ha),D=G.x/z,ia=G.y/z,C=D,Va=ia,na.x=C,na.y=Va}if(c._vertices[r].y>
Rc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();aa=0;for(hb=c.count;aa<hb;)Q=aa++,null!=c.local_vertices[Q]&&(null==c._vertices[Q]&&(fa=c._vertices,ea=new M(0,0),fa[Q]=ea),da=c.local_vertices[Q].x,X=c.local_vertices[Q].y,null==X&&(X=0),null==da&&(da=0),W=c.transform.get_local_to_world_matrix(),Ea=da,ka=X,mb=1,ua=W.m00*Ea+W.m10*ka+W.m20*mb,oa=W.m01*Ea+W.m11*ka+W.m21*mb,ma=ua,Ua=oa,pa=c._vertices[Q],pa.x=ma,pa.y=Ua);Da=0;for(Xa=c.count;Da<Xa;)ca=Da++,Ca=
c._vertices[(ca+1)%c.count],ja=Ca.x,rb=Ca.y,xa=c._vertices[ca],ra=ja-xa.x,sa=rb-xa.y,ja=ra,rb=sa,qb=-rb,rb=ja,ja=qb,null==c._normals[ca]?(ta=c._normals,Aa=new M(ja,rb),ta[ca]=Aa):(ya=c._normals[ca],ya.x=ja,ya.y=rb),wa=za=Ba=Fa=c._normals[ca],$a=wa.x*wa.x+wa.y*wa.y,Ga=0==$a?1:Math.sqrt($a),Qa=za.x/Ga,Ma=za.y/Ga,Na=Qa,La=Ma,Ba.x=Na,Ba.y=La}Rc=c._vertices[r].y}}ab=Rc}}p=d;n=Ra;var kb=Oa,xc=Ra;null==xc&&(xc=1);null==kb&&(kb=1);null==n&&(n=0);null==p&&(p=0);var Y=Fb.pool.get();Ha=p;X=n;var eb=kb,Pa=xc;
null==Pa&&(Pa=1);null==eb&&(eb=1);null==X&&(X=0);null==Ha&&(Ha=0);u=Y.start;u.x=Ha;u.y=X;u=Y.end;u.x=eb;u.y=Pa;Y.pooled=!1;var bb=(Y.get_dy()-Y.get_y())*(a.get_dx()-a.get_x())-(Y.get_dx()-Y.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(bb))var jb=null;else{var Kb=((Y.get_dx()-Y.get_x())*(a.get_y()-Y.get_y())-(Y.get_dy()-Y.get_y())*(a.get_x()-Y.get_x()))/bb,Uc=((a.get_dx()-a.get_x())*(a.get_y()-Y.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-Y.get_x()))/bb;if(0>Kb||1<Kb||0>Uc||1<Uc)jb=null;else{k=
a.start;var cc=Kb;S=a.end;w=a.start;var Mb=S.x-w.x,Ta=S.y-w.y;ba=Mb*cc;A=Ta*cc;var Ja=k.x+ba,Yb=k.y+A;k=a.start;var Ka=Ja-k.x,Wa=Yb-k.y,ob=Math.sqrt(Ka*Ka+Wa*Wa);k=a.start;w=a.end;Ka=w.x-k.x;Wa=w.y-k.y;var Sa=Math.sqrt(Ka*Ka+Wa*Wa)-ob,lb=0<=bb;k=Y.start;w=Y.end;Ka=w.x-k.x;Wa=w.y-k.y;var sb=Math.sqrt(Ka*Ka+Wa*Wa)*(lb?-1:1);u=va.norm;p=(Y.get_dy()-Y.get_y())/sb;n=-(Y.get_dx()-Y.get_x())/sb;u.x=p;u.y=n;var Za=va.norm.x,gb=va.norm.y,dc=lb;null==dc&&(dc=!1);r=Lb.pool.get();r.line=null;r.shape=null;r.line2=
null;var yb=dc;null==yb&&(yb=!1);r.distance=ob;r.overlap=Sa;r.inverse_normal=yb;u=r.hit;u.x=Ja;u.y=Yb;u=r.normal;u.x=Za;u.y=gb;r.pooled=!1;var ec=r;ec.line=a;ec.line2=Y;jb=ec}}null!=jb&&(h=jb);p=Oa;n=Ra;kb=Oa;xc=ab;null==xc&&(xc=1);null==kb&&(kb=1);null==n&&(n=0);null==p&&(p=0);u=Y.start;u.x=p;u.y=n;u=Y.end;u.x=kb;u.y=xc;bb=(Y.get_dy()-Y.get_y())*(a.get_dx()-a.get_x())-(Y.get_dx()-Y.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(bb)?jb=null:(Kb=((Y.get_dx()-Y.get_x())*(a.get_y()-Y.get_y())-(Y.get_dy()-
Y.get_y())*(a.get_x()-Y.get_x()))/bb,Uc=((a.get_dx()-a.get_x())*(a.get_y()-Y.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-Y.get_x()))/bb,0>Kb||1<Kb||0>Uc||1<Uc?jb=null:(k=a.start,cc=Kb,S=a.end,w=a.start,Mb=S.x-w.x,Ta=S.y-w.y,ba=Mb*cc,A=Ta*cc,Ja=k.x+ba,Yb=k.y+A,k=a.start,Ka=Ja-k.x,Wa=Yb-k.y,ob=Math.sqrt(Ka*Ka+Wa*Wa),k=a.start,w=a.end,Ka=w.x-k.x,Wa=w.y-k.y,Sa=Math.sqrt(Ka*Ka+Wa*Wa)-ob,lb=0<=bb,k=Y.start,w=Y.end,Ka=w.x-k.x,Wa=w.y-k.y,sb=Math.sqrt(Ka*Ka+Wa*Wa)*(lb?-1:1),u=va.norm,p=(Y.get_dy()-Y.get_y())/
sb,n=-(Y.get_dx()-Y.get_x())/sb,u.x=p,u.y=n,Za=va.norm.x,gb=va.norm.y,dc=lb,null==dc&&(dc=!1),r=Lb.pool.get(),r.line=null,r.shape=null,r.line2=null,yb=dc,null==yb&&(yb=!1),r.distance=ob,r.overlap=Sa,r.inverse_normal=yb,u=r.hit,u.x=Ja,u.y=Yb,u=r.normal,u.x=Za,u.y=gb,r.pooled=!1,ec=r,ec.line=a,ec.line2=Y,jb=ec));null!=jb&&(null==h||h.distance>jb.distance)&&(h=jb);p=Oa;n=ab;kb=d;xc=ab;null==xc&&(xc=1);null==kb&&(kb=1);null==n&&(n=0);null==p&&(p=0);u=Y.start;u.x=p;u.y=n;u=Y.end;u.x=kb;u.y=xc;bb=(Y.get_dy()-
Y.get_y())*(a.get_dx()-a.get_x())-(Y.get_dx()-Y.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(bb)?jb=null:(Kb=((Y.get_dx()-Y.get_x())*(a.get_y()-Y.get_y())-(Y.get_dy()-Y.get_y())*(a.get_x()-Y.get_x()))/bb,Uc=((a.get_dx()-a.get_x())*(a.get_y()-Y.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-Y.get_x()))/bb,0>Kb||1<Kb||0>Uc||1<Uc?jb=null:(k=a.start,cc=Kb,S=a.end,w=a.start,Mb=S.x-w.x,Ta=S.y-w.y,ba=Mb*cc,A=Ta*cc,Ja=k.x+ba,Yb=k.y+A,k=a.start,Ka=Ja-k.x,Wa=Yb-k.y,ob=Math.sqrt(Ka*Ka+Wa*Wa),k=a.start,w=a.end,
Ka=w.x-k.x,Wa=w.y-k.y,Sa=Math.sqrt(Ka*Ka+Wa*Wa)-ob,lb=0<=bb,k=Y.start,w=Y.end,Ka=w.x-k.x,Wa=w.y-k.y,sb=Math.sqrt(Ka*Ka+Wa*Wa)*(lb?-1:1),u=va.norm,p=(Y.get_dy()-Y.get_y())/sb,n=-(Y.get_dx()-Y.get_x())/sb,u.x=p,u.y=n,Za=va.norm.x,gb=va.norm.y,dc=lb,null==dc&&(dc=!1),r=Lb.pool.get(),r.line=null,r.shape=null,r.line2=null,yb=dc,null==yb&&(yb=!1),r.distance=ob,r.overlap=Sa,r.inverse_normal=yb,u=r.hit,u.x=Ja,u.y=Yb,u=r.normal,u.x=Za,u.y=gb,r.pooled=!1,ec=r,ec.line=a,ec.line2=Y,jb=ec));null!=jb&&(null==h||
h.distance>jb.distance)&&(h=jb);p=d;n=ab;kb=d;xc=Ra;null==xc&&(xc=1);null==kb&&(kb=1);null==n&&(n=0);null==p&&(p=0);u=Y.start;u.x=p;u.y=n;u=Y.end;u.x=kb;u.y=xc;bb=(Y.get_dy()-Y.get_y())*(a.get_dx()-a.get_x())-(Y.get_dx()-Y.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(bb)?jb=null:(Kb=((Y.get_dx()-Y.get_x())*(a.get_y()-Y.get_y())-(Y.get_dy()-Y.get_y())*(a.get_x()-Y.get_x()))/bb,Uc=((a.get_dx()-a.get_x())*(a.get_y()-Y.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-Y.get_x()))/bb,0>Kb||1<Kb||0>Uc||1<Uc?
jb=null:(k=a.start,cc=Kb,S=a.end,w=a.start,Mb=S.x-w.x,Ta=S.y-w.y,ba=Mb*cc,A=Ta*cc,Ja=k.x+ba,Yb=k.y+A,k=a.start,Ka=Ja-k.x,Wa=Yb-k.y,ob=Math.sqrt(Ka*Ka+Wa*Wa),k=a.start,w=a.end,Ka=w.x-k.x,Wa=w.y-k.y,Sa=Math.sqrt(Ka*Ka+Wa*Wa)-ob,lb=0<=bb,k=Y.start,w=Y.end,Ka=w.x-k.x,Wa=w.y-k.y,sb=Math.sqrt(Ka*Ka+Wa*Wa)*(lb?-1:1),u=va.norm,p=(Y.get_dy()-Y.get_y())/sb,n=-(Y.get_dx()-Y.get_x())/sb,u.x=p,u.y=n,Za=va.norm.x,gb=va.norm.y,dc=lb,null==dc&&(dc=!1),r=Lb.pool.get(),r.line=null,r.shape=null,r.line2=null,yb=dc,null==
yb&&(yb=!1),r.distance=ob,r.overlap=Sa,r.inverse_normal=yb,u=r.hit,u.x=Ja,u.y=Yb,u=r.normal,u.x=Za,u.y=gb,r.pooled=!1,ec=r,ec.line=a,ec.line2=Y,jb=ec));null!=jb&&(null==h||h.distance>jb.distance)&&(h=jb);null!=h&&(h.line=a,h.shape=b);return h};va.line_intersects_circle=function(a,b){var c=a.end,e=a.start,f=c.x-e.x,h=c.y-e.y;c=a.start;var t=b.transform;t.sync();var l=t._x,d=t._y,g=c.x-l;l=c.y-d;d=b.local_radius;t=b.transform;null==t.parent?c=t.local_scale_x:(t.sync(),c=t._scale_x);d*=c;c=f*f+h*h;e=
2*(g*f+l*h);h=e*e-4*c*(g*g+l*l-d*d);if(0>h)return null;h=Math.sqrt(h);f=(-e-h)/(2*c);h=(-e+h)/(2*c);return 0<=f&&1>=f?(c=a.start,h=f,t=a.end,e=a.start,f=t.x-e.x,g=t.y-e.y,f=c.x+f*h,h=c.y+g*h,c=a.start,t=f-c.x,c=h-c.y,g=Math.sqrt(t*t+c*c),c=a.start,e=a.end,t=e.x-c.x,c=e.y-c.y,e=Math.sqrt(t*t+c*c)-g,c=va.norm,t=b.transform,null==t.parent?l=t.local_x:(t.sync(),l=t._x),t=b.transform,null==t.parent?t=t.local_y:(t.sync(),t=t._y),c.x=f-l,c.y=h-t,c=va.norm,l=c.x/d,d=c.y/d,c.x=l,c.y=d,d=va.norm.x,t=va.norm.y,
l=Lb.pool.get(),l.line=null,l.shape=null,l.line2=null,c=!1,null==c&&(c=!1),l.distance=g,l.overlap=e,l.inverse_normal=c,c=l.hit,c.x=f,c.y=h,c=l.normal,c.x=d,c.y=t,l.pooled=!1,d=l,d.line=a,d.shape=b,d):0<=h&&1>=h?(c=a.start,t=a.end,e=a.start,f=t.x-e.x,g=t.y-e.y,f=c.x+f*h,h=c.y+g*h,c=a.start,t=f-c.x,c=h-c.y,g=Math.sqrt(t*t+c*c),c=a.start,e=a.end,t=e.x-c.x,c=e.y-c.y,e=Math.sqrt(t*t+c*c)-g,c=va.norm,t=b.transform,null==t.parent?l=t.local_x:(t.sync(),l=t._x),t=b.transform,null==t.parent?t=t.local_y:(t.sync(),
t=t._y),c.x=f-l,c.y=h-t,t=c=va.norm,l=-t.y,c.x=-t.x/d,c.y=l/d,d=va.norm.x,t=va.norm.y,c=!0,null==c&&(c=!1),l=Lb.pool.get(),l.line=null,l.shape=null,l.line2=null,null==c&&(c=!1),l.distance=g,l.overlap=e,l.inverse_normal=c,c=l.hit,c.x=f,c.y=h,c=l.normal,c.x=d,c.y=t,l.pooled=!1,d=l,d.line=a,d.shape=b,d):null};va.line_intersects_polygon=function(a,b){var c=null,e=Fb.pool.get(),f=0,h=0,t=1,l=1;null==l&&(l=1);null==t&&(t=1);null==h&&(h=0);null==f&&(f=0);var d=e.start;d.x=f;d.y=h;d=e.end;d.x=t;d.y=l;e.pooled=
!1;for(var g=0,m=b.count;g<m;){var r=g++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var x=0,p=b.count;x<p;){var B=x++;if(null!=b.local_vertices[B]){if(null==b._vertices[B]){var k=b._vertices,n=new M(0,0);k[B]=n}f=b.local_vertices[B].x;h=b.local_vertices[B].y;null==h&&(h=0);null==f&&(f=0);var v=b.transform.get_local_to_world_matrix(),q=f,u=h,U=v.m00*q+v.m10*u+1*v.m20,w=v.m01*q+v.m11*u+1*v.m21;d=b._vertices[B];d.x=U;d.y=w}}for(var R=0,O=b.count;R<
O;){var K=R++,H=b._vertices[(K+1)%b.count],F=H.x,ba=H.y,A=b._vertices[K],y=ba-A.y;F-=A.x;ba=y;var na=-ba;ba=F;F=na;if(null==b._normals[K]){var G=b._normals,ha=new M(F,ba);G[K]=ha}else{var z=b._normals[K];z.x=F;z.y=ba}var D=b._normals[K],ia=D,C=D,E=C,Va=E.x*E.x+E.y*E.y,L=0==Va?1:Math.sqrt(Va),N=C.y/L;ia.x=C.x/L;ia.y=N}}var P=b._vertices[r];if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var qa=0,T=b.count;qa<T;){var Ya=qa++;if(null!=b.local_vertices[Ya]){if(null==
b._vertices[Ya]){var I=b._vertices,Ha=new M(0,0);I[Ya]=Ha}var S=b.local_vertices[Ya].x,Q=b.local_vertices[Ya].y;null==Q&&(Q=0);null==S&&(S=0);var la=b.transform.get_local_to_world_matrix(),V=S,W=Q,X=la.m01*V+la.m11*W+1*la.m21,aa=b._vertices[Ya];aa.x=la.m00*V+la.m10*W+1*la.m20;aa.y=X}}for(var da=0,hb=b.count;da<hb;){var Z=da++,Ea=b._vertices[(Z+1)%b.count],fa=Ea.x,ea=Ea.y,ca=b._vertices[Z],ka=ea-ca.y;fa-=ca.x;ea=ka;var ja=-ea;ea=fa;fa=ja;if(null==b._normals[Z]){var mb=b._normals,ua=new M(fa,ea);mb[Z]=
ua}else{var oa=b._normals[Z];oa.x=fa;oa.y=ea}var ma=b._normals[Z],pa=ma,Da=ma,Ua=Da,Ca=Ua.x*Ua.x+Ua.y*Ua.y,xa=0==Ca?1:Math.sqrt(Ca),Xa=Da.y/xa;pa.x=Da.x/xa;pa.y=Xa}}var wa=b._vertices[(r+1)%b.count],ya=P.x,ra=P.y;t=wa.x;l=wa.y;null==l&&(l=1);null==t&&(t=1);null==ra&&(ra=0);null==ya&&(ya=0);var sa=e.start;sa.x=ya;sa.y=ra;var Ba=e.end;Ba.x=t;Ba.y=l;var qb=(e.get_dy()-e.get_y())*(a.get_dx()-a.get_x())-(e.get_dx()-e.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(qb))var za=null;else{var ta=((e.get_dx()-
e.get_x())*(a.get_y()-e.get_y())-(e.get_dy()-e.get_y())*(a.get_x()-e.get_x()))/qb,Aa=((a.get_dx()-a.get_x())*(a.get_y()-e.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-e.get_x()))/qb;if(0>ta||1<ta||0>Aa||1<Aa)za=null;else{var $a=a.start,Ga=ta,Ia=a.end,Fa=a.start,Qa=$a.x+(Ia.x-Fa.x)*Ga,Ma=$a.y+(Ia.y-Fa.y)*Ga,Na=a.start,La=Qa-Na.x,Ja=Ma-Na.y,Oa=Math.sqrt(La*La+Ja*Ja),Ra=a.start,ab=a.end,Ta=ab.x-Ra.x,Sa=ab.y-Ra.y,Za=Math.sqrt(Ta*Ta+Sa*Sa)-Oa,gb=0<=qb,db=e.start,kb=e.end,fb=kb.x-db.x,Y=kb.y-db.y,eb=Math.sqrt(fb*
fb+Y*Y)*(gb?-1:1),Pa=va.norm,bb=(e.get_dy()-e.get_y())/eb,jb=-(e.get_dx()-e.get_x())/eb;Pa.x=bb;Pa.y=jb;var Kb=va.norm.x,cb=va.norm.y,cc=gb;null==cc&&(cc=!1);var Mb=Lb.pool.get();Mb.line=null;Mb.shape=null;Mb.line2=null;var ib=cc;null==ib&&(ib=!1);Mb.distance=Oa;Mb.overlap=Za;Mb.inverse_normal=ib;var Jb=Mb.hit;Jb.x=Qa;Jb.y=Ma;var Yb=Mb.normal;Yb.x=Kb;Yb.y=cb;Mb.pooled=!1;var Ka=Mb;Ka.line=a;Ka.line2=e;za=Ka}}null!=za&&(null==c||c.distance>za.distance)&&(c=za)}null!=c&&(c.line=a,c.shape=b);return c};
va.rect_and_rect=function(a,b,c){null==c&&(c=!1);var e=null,f=a.transform;if(null==f.parent)var h=180/Math.PI*f.local_radians;else f.sync(),h=180/Math.PI*f._radians;0==h?(f=b.transform,null==f.parent?h=180/Math.PI*f.local_radians:(f.sync(),h=180/Math.PI*f._radians),h=0!=h):h=!0;if(h){if(null!=a.transformed_rect){e=va.rect_and_polygon(b,a.transformed_rect,c);if(null==e)return null;c?e.sa=a:e.sb=a;return e}if(null!=b.transformed_rect){e=va.rect_and_polygon(a,b.transformed_rect,!c);if(null==e)return null;
c?e.sa=b:e.sb=b;return e}}h=c?b:a;a=c?a:b;f=a.transform;null==f.parent?b=f.local_x:(f.sync(),b=f._x);f=h.transform;null==f.parent?f=f.local_x:(f.sync(),f=f._x);b-=f;f=a.transform;null==f.parent?c=f.local_y:(f.sync(),c=f._y);f=h.transform;null==f.parent?f=f.local_y:(f.sync(),f=f._y);f=c-f;c=h.local_ex*h.transform.local_scale_x+a.local_ex*a.transform.local_scale_x-Math.abs(b);if(0<c){var t=h.local_ey*h.transform.local_scale_y+a.local_ey*a.transform.local_scale_y-Math.abs(f);if(0<t){if(c<t){e=wc.pool.get();
e.sa=null;e.sb=null;for(var l=e.contact_count=0,d=e.contacts;l<d.length;){var g=d[l];++l;g.x=0;g.y=0}e.overlap=c;c=e.normal;c.x=0>b?-1:1;c.y=0}else{e=wc.pool.get();e.sa=null;e.sb=null;l=e.contact_count=0;for(d=e.contacts;l<d.length;)g=d[l],++l,g.x=0,g.y=0;e.overlap=t;c=e.normal;c.x=0;c.y=0>f?-1:1}e.pooled=!1;e.sa=h;e.sb=a}}return e};va.circle_and_circle=function(a,b,c){null==c&&(c=!1);var e=c?b:a;a=c?a:b;var f=a.transform;null==f.parent?b=f.local_x:(f.sync(),b=f._x);f=e.transform;null==f.parent?c=
f.local_x:(f.sync(),c=f._x);b-=c;f=a.transform;null==f.parent?c=f.local_y:(f.sync(),c=f._y);f=e.transform;null==f.parent?f=f.local_y:(f.sync(),f=f._y);c-=f;var h=e.local_radius;f=e.transform;if(null==f.parent)var t=f.local_scale_x;else f.sync(),t=f._scale_x;var l=a.local_radius;f=a.transform;null==f.parent?f=f.local_scale_x:(f.sync(),f=f._scale_x);h=h*t+l*f;t=b*b+c*c;f=null;if(t>=h*h)return f;if(1E-5>=Math.abs(t)){h=e.local_radius;f=e.transform;null==f.parent?b=f.local_scale_x:(f.sync(),b=f._scale_x);
b*=h;f=wc.pool.get();f.sa=null;f.sb=null;l=f.contact_count=0;for(var d=f.contacts;l<d.length;){var g=d[l];++l;g.x=0;g.y=0}f.overlap=b;h=f.normal;h.x=1;h.y=0}else{t=Math.sqrt(t);b/=t;c/=t;f=wc.pool.get();f.sa=null;f.sb=null;l=f.contact_count=0;for(d=f.contacts;l<d.length;)g=d[l],++l,g.x=0,g.y=0;f.overlap=h-t;h=f.normal;h.x=b;h.y=c}f.pooled=!1;f.sa=e;f.sb=a;return f};va.polygon_and_polygon=function(a,b,c){null==c&&(c=!1);var e=va.check_polygons(a,b,c);if(null==e)return null;a=va.check_polygons(b,a,
!c);if(null==a)return null;0>e.overlap&&(e.overlap=Math.abs(e.overlap));0>a.overlap&&(a.overlap=Math.abs(a.overlap));if(e.overlap<a.overlap)return a.put(),e;e.put();return a};va.rect_and_circle=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect){var e=a.transform;if(null==e.parent)var f=180/Math.PI*e.local_radians;else e.sync(),f=180/Math.PI*e._radians;f=0!=f}else f=!1;if(f){f=va.circle_and_polygon(b,a.transformed_rect,c);if(null==f)return null;c?f.sa=a:f.sb=a;return f}c?(e=b.transform,null==
e.parent?f=e.local_x:(e.sync(),f=e._x),e=a.transform):(e=a.transform,null==e.parent?f=e.local_x:(e.sync(),f=e._x),e=b.transform);if(null==e.parent)var h=e.local_x;else e.sync(),h=e._x;f-=h;c?(e=b.transform,null==e.parent?h=e.local_y:(e.sync(),h=e._y),e=a.transform):(e=a.transform,null==e.parent?h=e.local_y:(e.sync(),h=e._y),e=b.transform);if(null==e.parent)var d=e.local_y;else e.sync(),d=e._y;h-=d;var l=f,g=h;d=-(a.local_ex*a.transform.local_scale_x);var m=a.local_ex*a.transform.local_scale_x;l<d?
l=d:l>m&&(l=m);d=-(a.local_ey*a.transform.local_scale_y);m=a.local_ey*a.transform.local_scale_y;g<d?g=d:g>m&&(g=m);m=!1;d=b.local_radius;e=b.transform;null==e.parent?e=e.local_scale_x:(e.sync(),e=e._scale_x);d*=e;1E-5>=Math.abs(f-l)&&1E-5>=Math.abs(h-g)&&(m=!0,Math.abs(f)>Math.abs(h)?l=0<l?a.local_ex*a.transform.local_scale_x+d+.1:-(a.local_ex*a.transform.local_scale_x)-d-.1:g=0<g?a.local_ey*a.transform.local_scale_y+d+.1:-(a.local_ey*a.transform.local_scale_y)-d-.1);f-=l;h-=g;l=f*f+h*h;if(l>d*d&&
!m)return null;l=Math.sqrt(l);f/=l;h/=l;m&&(f*=-1,h*=-1);l=Math.abs(d-l);d=wc.pool.get();d.sa=null;d.sb=null;g=d.contact_count=0;for(m=d.contacts;g<m.length;)e=m[g],++g,e.x=0,e.y=0;d.overlap=l;l=d.normal;l.x=f;l.y=h;d.pooled=!1;f=d;f.sa=c?b:a;f.sb=c?a:b;return f};va.rect_and_polygon=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect)b=va.polygon_and_polygon(a.transformed_rect,b,c);else{var e=ab.pool.get();e.count=4;for(var f=0,h=e.count;f<h;){var d=f++;if(null==e.local_vertices[d]){var l=
e.local_vertices,g=new M(0,0);l[d]=g}}f=e.local_vertices[0];f.x=-(a.local_ex*a.transform.local_scale_x);f.y=-(a.local_ey*a.transform.local_scale_y);f=e.local_vertices[1];f.x=a.local_ex*a.transform.local_scale_x;f.y=-(a.local_ey*a.transform.local_scale_y);f=e.local_vertices[2];f.x=a.local_ex*a.transform.local_scale_x;f.y=a.local_ey*a.transform.local_scale_y;f=e.local_vertices[3];f.x=-(a.local_ex*a.transform.local_scale_x);f.y=a.local_ey*a.transform.local_scale_y;f=a.transform.local_x;h=e.transform;
h.dirty||h.set_dirty();h.local_x=f;f=a.transform.local_y;h=e.transform;h.dirty||h.set_dirty();h.local_y=f;h=e.transform;f=Math.PI/180*(180/Math.PI)*a.transform.local_radians;h.dirty||h.set_dirty();h.local_radians=f;f=a.transform.local_scale_x;h=e.transform;h.dirty||h.set_dirty();h.local_scale_x=f;f=a.transform.local_scale_y;h=e.transform;h.dirty||h.set_dirty();h.local_scale_y=f;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;e.set_parent(a.parent);b=va.polygon_and_polygon(e,b,c);e.put()}if(null==
b)return null;c?b.sb=a:b.sa=a;return b};va.circle_and_polygon=function(a,b,c){null==c&&(c=!1);var e=0,f=1073741823,h=a.transform;h.sync();var d=h._x,l=h._y,g=a.local_radius;h=a.transform;if(null==h.parent)var m=h.local_scale_x;else h.sync(),m=h._scale_x;for(var x=g*m,r=0,p=b.count;r<p;){var B=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var k=0,n=b.count;k<n;){var v=k++;if(null!=b.local_vertices[v]){if(null==b._vertices[v]){var q=b._vertices,u=
new M(0,0);q[v]=u}var U=b.local_vertices[v].x,w=b.local_vertices[v].y;null==w&&(w=0);null==U&&(U=0);var R=b.transform.get_local_to_world_matrix(),K=U,O=w,H=1,F=R.m00*K+R.m10*O+R.m20*H,ba=R.m01*K+R.m11*O+R.m21*H,A=F,y=ba,na=b._vertices[v];na.x=A;na.y=y}}for(var G=0,ha=b.count;G<ha;){var z=G++,D=b._vertices[(z+1)%b.count],ia=D.x,C=D.y,E=b._vertices[z],Va=ia-E.x,L=C-E.y;ia=Va;C=L;var N=-C;C=ia;ia=N;if(null==b._normals[z]){var P=b._normals,qa=new M(ia,C);P[z]=qa}else{var T=b._normals[z];T.x=ia;T.y=C}var Ya=
b._normals[z],I=Ya,Ha=Ya,S=Ha,la=S.x*S.x+S.y*S.y,Q=0==la?1:Math.sqrt(la),V=Ha.x/Q,W=Ha.y/Q,X=V,aa=W;I.x=X;I.y=aa}}var Z=b._vertices[B],da=d-Z.x,ea=l-Z.y;e=da*da+ea*ea;if(e<f){f=e;var fa=va.closest;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var hb=0,Ea=b.count;hb<Ea;){var ca=hb++;if(null!=b.local_vertices[ca]){if(null==b._vertices[ca]){var ka=b._vertices,ja=new M(0,0);ka[ca]=ja}var mb=b.local_vertices[ca].x,ua=b.local_vertices[ca].y;null==ua&&(ua=
0);null==mb&&(mb=0);var oa=b.transform.get_local_to_world_matrix(),ma=mb,Da=ua,pa=1,Ua=oa.m00*ma+oa.m10*Da+oa.m20*pa,Ca=oa.m01*ma+oa.m11*Da+oa.m21*pa,xa=Ua,wa=Ca,Xa=b._vertices[ca];Xa.x=xa;Xa.y=wa}}for(var ya=0,za=b.count;ya<za;){var ra=ya++,qb=b._vertices[(ra+1)%b.count],sa=qb.x,ta=qb.y,Ba=b._vertices[ra],Aa=sa-Ba.x,$a=ta-Ba.y;sa=Aa;ta=$a;var Ga=-ta;ta=sa;sa=Ga;if(null==b._normals[ra]){var Ia=b._normals,Fa=new M(sa,ta);Ia[ra]=Fa}else{var Qa=b._normals[ra];Qa.x=sa;Qa.y=ta}var Ma=b._normals[ra],Na=
Ma,La=Ma,Ja=La,Oa=Ja.x*Ja.x+Ja.y*Ja.y,Ra=0==Oa?1:Math.sqrt(Oa),ab=La.x/Ra,Ta=La.y/Ra,Sa=ab,gb=Ta;Na.x=Sa;Na.y=gb}}var db=b._vertices[B].x;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var Za=0,fb=b.count;Za<fb;){var kb=Za++;if(null!=b.local_vertices[kb]){if(null==b._vertices[kb]){var eb=b._vertices,Y=new M(0,0);eb[kb]=Y}var Pa=b.local_vertices[kb].x,cb=b.local_vertices[kb].y;null==cb&&(cb=0);null==Pa&&(Pa=0);var bb=b.transform.get_local_to_world_matrix(),
jb=Pa,Kb=cb,ib=1,cc=bb.m00*jb+bb.m10*Kb+bb.m20*ib,Mb=bb.m01*jb+bb.m11*Kb+bb.m21*ib,Fb=cc,Jb=Mb,Yb=b._vertices[kb];Yb.x=Fb;Yb.y=Jb}}for(var Ka=0,Wa=b.count;Ka<Wa;){var ob=Ka++,Hb=b._vertices[(ob+1)%b.count],lb=Hb.x,sb=Hb.y,wb=b._vertices[ob],Eb=lb-wb.x,dc=sb-wb.y;lb=Eb;sb=dc;var yb=-sb;sb=lb;lb=yb;if(null==b._normals[ob]){var ec=b._normals,nb=new M(lb,sb);ec[ob]=nb}else{var Xb=b._normals[ob];Xb.x=lb;Xb.y=sb}var tb=b._normals[ob],vb=tb,Bb=tb,jd=Bb,Ib=jd.x*jd.x+jd.y*jd.y,Gb=0==Ib?1:Math.sqrt(Ib),Lb=
Bb.x/Gb,Sb=Bb.y/Gb,Tb=Lb,Ub=Sb;vb.x=Tb;vb.y=Ub}}var xb=b._vertices[B].y;fa.x=db;fa.y=xb}}R=va.closest;da=R.x-d;ea=R.y-l;la=da*da+ea*ea;Q=0==la?1:Math.sqrt(la);var zb=da/Q,ub=ea/Q,pb=0;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();r=0;for(p=b.count;r<p;)B=r++,null!=b.local_vertices[B]&&(null==b._vertices[B]&&(q=b._vertices,u=new M(0,0),q[B]=u),U=b.local_vertices[B].x,w=b.local_vertices[B].y,null==w&&(w=0),null==U&&(U=0),R=b.transform.get_local_to_world_matrix(),
K=U,O=w,H=1,F=R.m00*K+R.m10*O+R.m20*H,ba=R.m01*K+R.m11*O+R.m21*H,A=F,y=ba,na=b._vertices[B],na.x=A,na.y=y);r=0;for(p=b.count;r<p;)B=r++,na=b._vertices[(B+1)%b.count],K=na.x,O=na.y,E=b._vertices[B],Va=K-E.x,L=O-E.y,K=Va,O=L,U=-O,O=K,K=U,null==b._normals[B]?(q=b._normals,u=new M(K,O),q[B]=u):(R=b._normals[B],R.x=K,R.y=O),S=Ha=I=D=b._normals[B],la=S.x*S.x+S.y*S.y,Q=0==la?1:Math.sqrt(la),V=Ha.x/Q,W=Ha.y/Q,X=V,aa=W,I.x=X,I.y=aa}E=b._vertices[0];var Sc=zb*E.x+ub*E.y,Ab=Sc;r=1;for(p=b.count;r<p;){var Vb=
r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();k=0;for(n=b.count;k<n;)B=k++,null!=b.local_vertices[B]&&(null==b._vertices[B]&&(q=b._vertices,u=new M(0,0),q[B]=u),U=b.local_vertices[B].x,w=b.local_vertices[B].y,null==w&&(w=0),null==U&&(U=0),R=b.transform.get_local_to_world_matrix(),K=U,O=w,H=1,F=R.m00*K+R.m10*O+R.m20*H,ba=R.m01*K+R.m11*O+R.m21*H,A=F,y=ba,na=b._vertices[B],na.x=A,na.y=y);G=0;for(ha=b.count;G<ha;)v=G++,D=b._vertices[(v+1)%b.count],ia=D.x,
C=D.y,E=b._vertices[v],Va=ia-E.x,L=C-E.y,ia=Va,C=L,N=-C,C=ia,ia=N,null==b._normals[v]?(P=b._normals,qa=new M(ia,C),P[v]=qa):(T=b._normals[v],T.x=ia,T.y=C),S=Ha=I=Ya=b._normals[v],la=S.x*S.x+S.y*S.y,Q=0==la?1:Math.sqrt(la),V=Ha.x/Q,W=Ha.y/Q,X=V,aa=W,I.x=X,I.y=aa}Z=b._vertices[Vb];pb=zb*Z.x+ub*Z.y;pb<Sc&&(Sc=pb);pb>Ab&&(Ab=pb)}var Pb=x,Zb=-x;Va=-d;L=-l;var Qb=zb*Va+ub*L;Sc+=Qb;Ab+=Qb;var Rb=Sc-Pb,Ob=Zb-Ab;if(0<Rb||0<Ob)return null;var Db=-(Pb-Sc);c&&(Db*=-1);U=zb;w=ub;g=wc.pool.get();g.sa=null;g.sb=
null;r=g.contact_count=0;for(p=g.contacts;r<p.length;){var hc=p[r];++r;hc.x=0;hc.y=0}g.overlap=Db;na=g.normal;na.x=U;na.y=w;g.pooled=!1;var Cb=g,lc=Math.abs(Db);r=0;for(p=b.count;r<p;){B=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();k=0;for(n=b.count;k<n;)v=k++,null!=b.local_vertices[v]&&(null==b._vertices[v]&&(q=b._vertices,u=new M(0,0),q[v]=u),U=b.local_vertices[v].x,w=b.local_vertices[v].y,null==w&&(w=0),null==U&&(U=0),R=b.transform.get_local_to_world_matrix(),
K=U,O=w,H=1,F=R.m00*K+R.m10*O+R.m20*H,ba=R.m01*K+R.m11*O+R.m21*H,A=F,y=ba,na=b._vertices[v],na.x=A,na.y=y);G=0;for(ha=b.count;G<ha;)z=G++,D=b._vertices[(z+1)%b.count],ia=D.x,C=D.y,E=b._vertices[z],Va=ia-E.x,L=C-E.y,ia=Va,C=L,N=-C,C=ia,ia=N,null==b._normals[z]?(P=b._normals,qa=new M(ia,C),P[z]=qa):(T=b._normals[z],T.x=ia,T.y=C),S=Ha=I=Ya=b._normals[z],la=S.x*S.x+S.y*S.y,Q=0==la?1:Math.sqrt(la),V=Ha.x/Q,W=Ha.y/Q,X=V,aa=W,I.x=X,I.y=aa}mb=b._normals[B].x;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>
b.count;)b._vertices.pop();hb=0;for(Ea=b.count;hb<Ea;)ca=hb++,null!=b.local_vertices[ca]&&(null==b._vertices[ca]&&(ka=b._vertices,ja=new M(0,0),ka[ca]=ja),Ga=b.local_vertices[ca].x,ua=b.local_vertices[ca].y,null==ua&&(ua=0),null==Ga&&(Ga=0),oa=b.transform.get_local_to_world_matrix(),ma=Ga,Da=ua,pa=1,Ua=oa.m00*ma+oa.m10*Da+oa.m20*pa,Ca=oa.m01*ma+oa.m11*Da+oa.m21*pa,xa=Ua,wa=Ca,fa=b._vertices[ca],fa.x=xa,fa.y=wa);ya=0;for(za=b.count;ya<za;)ra=ya++,Xa=b._vertices[(ra+1)%b.count],sa=Xa.x,ta=Xa.y,Z=b._vertices[ra],
Aa=sa-Z.x,$a=ta-Z.y,sa=Aa,ta=$a,db=-ta,ta=sa,sa=db,null==b._normals[ra]?(Ia=b._normals,Fa=new M(sa,ta),Ia[ra]=Fa):(Qa=b._normals[ra],Qa.x=sa,Qa.y=ta),Ja=La=Na=qb=b._normals[ra],Oa=Ja.x*Ja.x+Ja.y*Ja.y,Ra=0==Oa?1:Math.sqrt(Oa),ab=La.x/Ra,Ta=La.y/Ra,Sa=ab,gb=Ta,Na.x=Sa,Na.y=gb}zb=mb;ub=b._normals[B].y;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();Za=0;for(fb=b.count;Za<fb;)kb=Za++,null!=b.local_vertices[kb]&&(null==b._vertices[kb]&&(eb=b._vertices,Y=new M(0,
0),eb[kb]=Y),Pa=b.local_vertices[kb].x,cb=b.local_vertices[kb].y,null==cb&&(cb=0),null==Pa&&(Pa=0),bb=b.transform.get_local_to_world_matrix(),jb=Pa,Kb=cb,ib=1,cc=bb.m00*jb+bb.m10*Kb+bb.m20*ib,Mb=bb.m01*jb+bb.m11*Kb+bb.m21*ib,Fb=cc,Jb=Mb,Ma=b._vertices[kb],Ma.x=Fb,Ma.y=Jb);Ka=0;for(Wa=b.count;Ka<Wa;)ob=Ka++,Yb=b._vertices[(ob+1)%b.count],lb=Yb.x,sb=Yb.y,Ba=b._vertices[ob],Eb=lb-Ba.x,dc=sb-Ba.y,lb=Eb,sb=dc,yb=-sb,sb=lb,lb=yb,null==b._normals[ob]?(ec=b._normals,nb=new M(lb,sb),ec[ob]=nb):(Xb=b._normals[ob],
Xb.x=lb,Xb.y=sb),jd=Bb=vb=Hb=b._normals[ob],Ib=jd.x*jd.x+jd.y*jd.y,Gb=0==Ib?1:Math.sqrt(Ib),Lb=Bb.x/Gb,Sb=Bb.y/Gb,Tb=Lb,Ub=Sb,vb.x=Tb,vb.y=Ub}wb=b._vertices[0];Ab=Sc=zb*wb.x+ub*wb.y;for(var Nb=1,kc=b.count;Nb<kc;){Vb=Nb++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var nc=0,$b=b.count;nc<$b;){var Wb=nc++;if(null!=b.local_vertices[Wb]){if(null==b._vertices[Wb]){var uc=b._vertices,yc=new M(0,0);uc[Wb]=yc}var oc=b.local_vertices[Wb].x;xb=b.local_vertices[Wb].y;
null==xb&&(xb=0);null==oc&&(oc=0);var ac=b.transform.get_local_to_world_matrix(),pc=oc,qc=xb,jc=ac.m00*pc+ac.m10*qc+1*ac.m20,gc=ac.m01*pc+ac.m11*qc+1*ac.m21;tb=b._vertices[Wb];tb.x=jc;tb.y=gc}}for(var zc=0,Ac=b.count;zc<Ac;){var bc=zc++,tc=b._vertices[(bc+1)%b.count],vc=tc.x,ic=tc.y,Cc=b._vertices[bc],Nc=ic-Cc.y;vc-=Cc.x;ic=Nc;var Fc=-ic;ic=vc;vc=Fc;if(null==b._normals[bc]){var Bc=b._normals,Jc=new M(vc,ic);Bc[bc]=Jc}else{var Kc=b._normals[bc];Kc.x=vc;Kc.y=ic}var Lc=b._normals[bc],Mc=Lc,fc=Lc,mc=
fc,Dc=mc.x*mc.x+mc.y*mc.y,Ec=0==Dc?1:Math.sqrt(Dc),Oc=fc.y/Ec;Mc.x=fc.x/Ec;Mc.y=Oc}}var kd=b._vertices[Vb];pb=zb*kd.x+ub*kd.y;pb<Sc&&(Sc=pb);pb>Ab&&(Ab=pb)}Pb=x;Zb=-x;Qb=zb*-d+ub*-l;Sc+=Qb;Ab+=Qb;Rb=Sc-Pb;Ob=Zb-Ab;if(0<Rb||0<Ob)return Cb.put(),null;Db=-(Pb-Sc);c&&(Db*=-1);if(Math.abs(Db)<lc){var sc=Cb.normal;sc.x=zb;sc.y=ub;Cb.overlap=Db;lc=Math.abs(Db)}}Cb.sa=c?b:a;Cb.sb=c?a:b;Cb.overlap=Math.abs(Cb.overlap);c&&(na=Cb.normal,na.x=-na.x,na.y=-na.y);return Cb};va.check_polygons=function(a,b,c){null==
c&&(c=!1);for(var e=0,f=0,h=0,d=0,l=0,g=0,m=0,x=1073741823,r=null,p=0,B=0,k=0,n=a.count;k<n;){var v=k++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var q=0,u=a.count;q<u;){var U=q++;if(null!=a.local_vertices[U]){if(null==a._vertices[U]){var w=a._vertices,R=new M(0,0);w[U]=R}var K=a.local_vertices[U].x,O=a.local_vertices[U].y;null==O&&(O=0);null==K&&(K=0);var H=a.transform.get_local_to_world_matrix(),F=K,ba=O,na=H.m01*F+H.m11*ba+1*H.m21,A=a._vertices[U];
A.x=H.m00*F+H.m10*ba+1*H.m20;A.y=na}}for(var y=0,G=a.count;y<G;){var z=y++,ha=a._vertices[(z+1)%a.count],ia=ha.x,C=ha.y,D=a._vertices[z],E=C-D.y;ia-=D.x;C=E;var Va=-C;C=ia;ia=Va;if(null==a._normals[z]){var L=a._normals,N=new M(ia,C);L[z]=N}else{var T=a._normals[z];T.x=ia;T.y=C}var P=a._normals[z],qa=P,Ya=P,I=Ya,S=I.x*I.x+I.y*I.y,Ha=0==S?1:Math.sqrt(S),la=Ya.y/Ha;qa.x=Ya.x/Ha;qa.y=la}}var Q=a._normals[v].x;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var V=
0,W=a.count;V<W;){var X=V++;if(null!=a.local_vertices[X]){if(null==a._vertices[X]){var Z=a._vertices,aa=new M(0,0);Z[X]=aa}var ca=a.local_vertices[X].x,da=a.local_vertices[X].y;null==da&&(da=0);null==ca&&(ca=0);var ea=a.transform.get_local_to_world_matrix(),fa=ca,hb=da,Ea=ea.m01*fa+ea.m11*hb+1*ea.m21,oa=a._vertices[X];oa.x=ea.m00*fa+ea.m10*hb+1*ea.m20;oa.y=Ea}}for(var mb=0,ka=a.count;mb<ka;){var ja=mb++,ua=a._vertices[(ja+1)%a.count],ma=ua.x,Da=ua.y,pa=a._vertices[ja],ra=Da-pa.y;ma-=pa.x;Da=ra;var sa=
-Da;Da=ma;ma=sa;if(null==a._normals[ja]){var Ua=a._normals,ta=new M(ma,Da);Ua[ja]=ta}else{var va=a._normals[ja];va.x=ma;va.y=Da}var Ca=a._normals[ja],Xa=Ca,xa=Ca,wa=xa,ya=wa.x*wa.x+wa.y*wa.y,za=0==ya?1:Math.sqrt(ya),Ba=xa.y/za;Xa.x=xa.x/za;Xa.y=Ba}}p=Q;B=a._normals[v].y;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var qb=0,Ga=a.count;qb<Ga;){var Aa=qb++;if(null!=a.local_vertices[Aa]){if(null==a._vertices[Aa]){var $a=a._vertices,Ja=new M(0,0);$a[Aa]=
Ja}var Ia=a.local_vertices[Aa].x,Qa=a.local_vertices[Aa].y;null==Qa&&(Qa=0);null==Ia&&(Ia=0);var Fa=a.transform.get_local_to_world_matrix(),La=Ia,Ma=Qa,Na=Fa.m01*La+Fa.m11*Ma+1*Fa.m21,Oa=a._vertices[Aa];Oa.x=Fa.m00*La+Fa.m10*Ma+1*Fa.m20;Oa.y=Na}}for(var Ra=0,ab=a.count;Ra<ab;){var Pa=Ra++,Za=a._vertices[(Pa+1)%a.count],Ta=Za.x,Sa=Za.y,gb=a._vertices[Pa],cb=Sa-gb.y;Ta-=gb.x;Sa=cb;var db=-Sa;Sa=Ta;Ta=db;if(null==a._normals[Pa]){var Y=a._normals,fb=new M(Ta,Sa);Y[Pa]=fb}else{var eb=a._normals[Pa];eb.x=
Ta;eb.y=Sa}var bb=a._normals[Pa],jb=bb,ib=bb,Fb=ib,Jb=Fb.x*Fb.x+Fb.y*Fb.y,pb=0==Jb?1:Math.sqrt(Jb),zb=ib.y/pb;jb.x=ib.x/pb;jb.y=zb}}var ub=a._vertices[0];l=d=p*ub.x+B*ub.y;for(var wb=1,Ka=a.count;wb<Ka;){var Wa=wb++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var ob=0,Ab=a.count;ob<Ab;){var lb=ob++;if(null!=a.local_vertices[lb]){if(null==a._vertices[lb]){var sb=a._vertices,Xb=new M(0,0);sb[lb]=Xb}var tb=a.local_vertices[lb].x,vb=a.local_vertices[lb].y;
null==vb&&(vb=0);null==tb&&(tb=0);var yb=a.transform.get_local_to_world_matrix(),Bb=tb,Cb=vb,Hb=yb.m01*Bb+yb.m11*Cb+1*yb.m21,Db=a._vertices[lb];Db.x=yb.m00*Bb+yb.m10*Cb+1*yb.m20;Db.y=Hb}}for(var Eb=0,Ib=a.count;Eb<Ib;){var nb=Eb++,Gb=a._vertices[(nb+1)%a.count],xb=Gb.x,Pb=Gb.y,Lb=a._vertices[nb],Qb=Pb-Lb.y;xb-=Lb.x;Pb=Qb;var Sb=-Pb;Pb=xb;xb=Sb;if(null==a._normals[nb]){var Tb=a._normals,Ub=new M(xb,Pb);Tb[nb]=Ub}else{var Vb=a._normals[nb];Vb.x=xb;Vb.y=Pb}var Wb=a._normals[nb],Zb=Wb,Rb=Wb,Ob=Rb,ac=
Ob.x*Ob.x+Ob.y*Ob.y,bc=0==ac?1:Math.sqrt(ac),ic=Rb.y/bc;Zb.x=Rb.x/bc;Zb.y=ic}}var hc=a._vertices[Wa];h=p*hc.x+B*hc.y;h<d&&(d=h);h>l&&(l=h)}if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var vc=0,lc=b.count;vc<lc;){var Nb=vc++;if(null!=b.local_vertices[Nb]){if(null==b._vertices[Nb]){var nc=b._vertices,oc=new M(0,0);nc[Nb]=oc}var kc=b.local_vertices[Nb].x,mc=b.local_vertices[Nb].y;null==mc&&(mc=0);null==kc&&(kc=0);var $b=b.transform.get_local_to_world_matrix(),
pc=kc,qc=mc,zc=$b.m01*pc+$b.m11*qc+1*$b.m21,tc=b._vertices[Nb];tc.x=$b.m00*pc+$b.m10*qc+1*$b.m20;tc.y=zc}}for(var uc=0,Cc=b.count;uc<Cc;){var fc=uc++,yc=b._vertices[(fc+1)%b.count],jc=yc.x,gc=yc.y,Ac=b._vertices[fc],Kc=gc-Ac.y;jc-=Ac.x;gc=Kc;var Lc=-gc;gc=jc;jc=Lc;if(null==b._normals[fc]){var Mc=b._normals,Nc=new M(jc,gc);Mc[fc]=Nc}else{var Dc=b._normals[fc];Dc.x=jc;Dc.y=gc}var Ec=b._normals[fc],Fc=Ec,Bc=Ec,sc=Bc,Jc=sc.x*sc.x+sc.y*sc.y,Oc=0==Jc?1:Math.sqrt(Jc),ed=Bc.y/Oc;Fc.x=Bc.x/Oc;Fc.y=ed}}var Yc=
b._vertices[0];m=g=p*Yc.x+B*Yc.y;for(var Zc=1,nd=b.count;Zc<nd;){var pd=Zc++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var $c=0,qd=b.count;$c<qd;){var kd=$c++;if(null!=b.local_vertices[kd]){if(null==b._vertices[kd]){var ud=b._vertices,vd=new M(0,0);ud[kd]=vd}var Wc=b.local_vertices[kd].x,Xc=b.local_vertices[kd].y;null==Xc&&(Xc=0);null==Wc&&(Wc=0);var Gc=b.transform.get_local_to_world_matrix(),cd=Wc,dd=Xc,Ad=Gc.m01*cd+Gc.m11*dd+1*Gc.m21,fd=b._vertices[kd];
fd.x=Gc.m00*cd+Gc.m10*dd+1*Gc.m20;fd.y=Ad}}for(var gd=0,Bd=b.count;gd<Bd;){var Hc=gd++,hd=b._vertices[(Hc+1)%b.count],Pc=hd.x,Ic=hd.y,id=b._vertices[Hc],Cd=Ic-id.y;Pc-=id.x;Ic=Cd;var Ed=-Ic;Ic=Pc;Pc=Ed;if(null==b._normals[Hc]){var Fd=b._normals,Gd=new M(Pc,Ic);Fd[Hc]=Gd}else{var ld=b._normals[Hc];ld.x=Pc;ld.y=Ic}var md=b._normals[Hc],od=md,ad=md,Vc=ad,rd=Vc.x*Vc.x+Vc.y*Vc.y,sd=0==rd?1:Math.sqrt(rd),Hd=ad.y/sd;od.x=ad.x/sd;od.y=Hd}}var td=b._vertices[pd];h=p*td.x+B*td.y;h<g&&(g=h);h>m&&(m=h)}e=d-m;
f=g-l;if(0<e||0<f)return null;var Tc=-(m-d);c&&(Tc*=-1);if(Math.abs(Tc)<x){if(null==r){var Id=p,Jd=B,Dd=wc.pool.get();Dd.sa=null;Dd.sb=null;for(var bd=Dd.contact_count=0,wd=Dd.contacts;bd<wd.length;){var xd=wd[bd];++bd;xd.x=0;xd.y=0}Dd.overlap=Tc;var yd=Dd.normal;yd.x=Id;yd.y=Jd;Dd.pooled=!1;r=Dd}else{r.overlap=Tc;var zd=r.normal;zd.x=p;zd.y=B}x=Math.abs(Tc)}}if(null==r)return null;r.sa=c?b:a;r.sb=c?a:b;c&&(A=r.normal,A.x=-A.x,A.y=-A.y);return r};var sc=function(a,b,c,e,f){null==f&&(f=1);null==e&&
(e=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.dirty=this.inverse_dirty=this.coordinates_dirty=!1;this.local_to_world_matrix=new ie(1,0,0,0,1,0,0,0,1);this.children=[];this._scale_x=this._scale_y=1;this._x=this._y=this._radians=0;this.on_dirty=null;this.dirty||this.set_dirty();this.local_x=a;this.dirty||this.set_dirty();this.local_y=b;a=Math.PI/180*c;this.dirty||this.set_dirty();this.local_radians=a;this.dirty||this.set_dirty();this.local_scale_x=e;this.dirty||this.set_dirty();this.local_scale_y=
f};n["echo.util.Transform"]=sc;sc.__name__=!0;sc.__interfaces__=[mb];sc.prototype={set_parent:function(a,b){null!=this.parent&&G.remove(this.parent.children,this);this.parent=a;null!=a&&this.parent.children.push(this);this.set_dirty()},get_local_to_world_matrix:function(){if(this.dirty){if(null==this.parent){var a=this.local_to_world_matrix,b=Math.sin(this.local_radians),c=Math.cos(this.local_radians),e=c*this.local_scale_x,f=-b*this.local_scale_y,h=this.local_x;b*=this.local_scale_x;var d=c*this.local_scale_y,
l=this.local_y;a.m00=e;a.m10=f;a.m20=h;a.m01=b;a.m11=d;a.m21=l;a.m02=0;a.m12=0;a.m22=1}else{a=this.local_to_world_matrix;var g=this.parent.get_local_to_world_matrix();b=Math.sin(this.local_radians);c=Math.cos(this.local_radians);e=c*this.local_scale_x;f=-b*this.local_scale_y;h=this.local_x;b*=this.local_scale_x;d=c*this.local_scale_y;l=this.local_y;c=g.m00*f+g.m10*d+0*g.m20;var m=g.m00*h+g.m10*l+1*g.m20,x=g.m01*e+g.m11*b+0*g.m21,r=g.m01*f+g.m11*d+0*g.m21,p=g.m01*h+g.m11*l+1*g.m21,B=g.m02*e+g.m12*
b+0*g.m22;f=g.m02*f+g.m12*d+0*g.m22;h=g.m02*h+g.m12*l+1*g.m22;a.m00=g.m00*e+g.m10*b+0*g.m20;a.m10=c;a.m20=m;a.m01=x;a.m11=r;a.m21=p;a.m02=B;a.m12=f;a.m22=h}this.dirty=!1}return this.local_to_world_matrix},sync:function(){if(this.coordinates_dirty){var a=this.get_local_to_world_matrix();if(null==this.parent)this._x=this.local_x,this._y=this.local_y,this._scale_x=this.local_scale_x,this._scale_y=this.local_scale_y,this._radians=this.local_radians;else{var b=a.m00,c=a.m01,e=a.m10,f=a.m11;this._x=a.m20;
this._y=a.m21;this._scale_x=Math.sqrt(b*b+c*c);this._scale_y=Math.sqrt(e*e+f*f);this._radians=180/Math.PI*Math.atan2(-e/this._scale_y,b/this._scale_x)}this.coordinates_dirty=!1}},set_dirty:function(){this.dirty=this.inverse_dirty=this.coordinates_dirty=!0;for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.set_dirty()}if(null!=this.on_dirty)this.on_dirty(this)},__class__:sc};var Zb=p["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",
toString:d},Module:(g=function(a){return{_hx_index:1,m:a,__enum__:"haxe.StackItem",toString:d}},g._hx_name="Module",g.__params__=["m"],g),FilePos:(g=function(a,b,c,e){return{_hx_index:2,s:a,file:b,line:c,column:e,__enum__:"haxe.StackItem",toString:d}},g._hx_name="FilePos",g.__params__=["s","file","line","column"],g),Method:(g=function(a,b){return{_hx_index:3,classname:a,method:b,__enum__:"haxe.StackItem",toString:d}},g._hx_name="Method",g.__params__=["classname","method"],g),LocalFunction:(g=function(a){return{_hx_index:4,
v:a,__enum__:"haxe.StackItem",toString:d}},g._hx_name="LocalFunction",g.__params__=["v"],g)};Zb.__constructs__=[Zb.CFunction,Zb.Module,Zb.FilePos,Zb.Method,Zb.LocalFunction];var Bc={callStack:function(){return ma.toHaxe(ma.callStack())},exceptionStack:function(a){null==a&&(a=!1);var b=ma.toHaxe(ma.exceptionStack());return a?b:Bc.subtract(b,Bc.callStack())},toString:function(a){for(var b=new na,c=0;c<a.length;){var e=a[c];++c;b.b+="\nCalled from ";Bc.itemToString(b,e)}return b.b},subtract:function(a,
b){for(var c=-1,e=-1;++e<a.length;){for(var f=0,h=b.length;f<h;){var d=f++;if(Bc.equalItems(a[e],b[d])){if(0>c&&(c=e),++e,e>=a.length)break}else c=-1}if(0<=c)break}return 0<=c?a.slice(0,c):a},equalItems:function(a,b){if(null==a)return null==b?!0:!1;switch(a._hx_index){case 0:return null==b?!1:0==b._hx_index?!0:!1;case 1:return null==b?!1:1==b._hx_index?a.m==b.m:!1;case 2:if(null==b)return!1;if(2==b._hx_index){var c=b.s,e=b.line,f=b.column,h=a.column,d=a.line,l=a.s;return a.file==b.file&&d==e&&h==
f?Bc.equalItems(l,c):!1}return!1;case 3:return null==b?!1:3==b._hx_index?(c=b.method,e=a.method,a.classname==b.classname?e==c:!1):!1;case 4:return null==b?!1:4==b._hx_index?a.v==b.v:!1}},itemToString:function(a,b){switch(b._hx_index){case 0:a.b+="a C function";break;case 1:b=b.m;a.b+="module ";a.b+=null==b?"null":""+b;break;case 2:var c=b.s,e=b.file,f=b.line;b=b.column;null!=c&&(Bc.itemToString(a,c),a.b+=" (");a.b+=null==e?"null":""+e;a.b+=" line ";a.b+=null==f?"null":""+f;null!=b&&(a.b+=" column ",
a.b+=null==b?"null":""+b);null!=c&&(a.b+=")");break;case 3:c=b.classname;b=b.method;a.b+=m.string(null==c?"<unknown>":c);a.b+=".";a.b+=null==b?"null":""+b;break;case 4:b=b.v,a.b+="local function #",a.b+=null==b?"null":""+b}}},Jc=function(){};n["haxe.IMap"]=Jc;Jc.__name__=!0;Jc.__isInterface__=!0;Jc.prototype={__class__:Jc};var A=function(a,b,c){Error.call(this,a);this.message=a;this.__previousException=b;this.__nativeException=null!=c?c:this;this.__skipStack=0;a=Error.prepareStackTrace;Error.prepareStackTrace=
function(a){return a.stack};if(c instanceof Error)this.stack=c.stack;else{c=null;if(Error.captureStackTrace)Error.captureStackTrace(this,A),c=this;else if(c=Error(),"undefined"==typeof c.stack){try{throw c;}catch(e){}this.__skipStack++}this.stack=c.stack}Error.prepareStackTrace=a};n["haxe.Exception"]=A;A.__name__=!0;A.caught=function(a){return a instanceof A?a:a instanceof Error?new A(a.message,null,a):new Zc(a,null,a)};A.thrown=function(a){if(a instanceof A)return a.get_native();if(a instanceof Error)return a;
a=new Zc(a);a.__skipStack++;return a};A.__super__=Error;A.prototype=F(Error.prototype,{unwrap:function(){return this.__nativeException},toString:function(){return this.get_message()},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_native:function(){return this.__nativeException},get_stack:function(){var a=this.__exceptionStack;null==a&&(a=ma.toHaxe(ma.normalize(this.stack),this.__skipStack),this.setProperty("__exceptionStack",a));return a},setProperty:function(a,
b){try{Object.defineProperty(this,a,{value:b})}catch(c){this[a]=b}},__class__:A,__properties__:{get_native:"get_native",get_stack:"get_stack",get_message:"get_message"}});var ka=function(){};n["haxe.Log"]=ka;ka.__name__=!0;ka.formatOutput=function(a,b){var c=m.string(a);if(null==b)return c;var e=b.fileName+":"+b.lineNumber;if(null!=b.customParams){var f=0;for(b=b.customParams;f<b.length;)a=b[f],++f,c+=", "+m.string(a)}return e+": "+c};ka.trace=function(a,b){a=ka.formatOutput(a,b);"undefined"!=typeof console&&
null!=console.log&&console.log(a)};var ma=function(){};n["haxe.NativeStackTrace"]=ma;ma.__name__=!0;ma.saveStack=function(a){ma.lastError=a};ma.callStack=function(){var a=Error(""),b=ma.tryHaxeStack(a);if("undefined"==typeof b){try{throw a;}catch(c){}b=a.stack}return ma.normalize(b,2)};ma.exceptionStack=function(){return ma.normalize(ma.tryHaxeStack(ma.lastError))};ma.toHaxe=function(a,b){null==b&&(b=0);if(null==a)return[];if("string"==typeof a){a=a.split("\n");"Error"==a[0]&&a.shift();for(var c=
[],e=0,f=a.length;e<f;){var h=e++;if(!(b>h)){var d=a[h];h=d.match(/^    at ([A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=h){d=h[1].split(".");"$hxClasses"==d[0]&&d.shift();var l=d.pop(),g=h[2],x=m.parseInt(h[3]);h=m.parseInt(h[4]);c.push(Zb.FilePos("Anonymous function"==l?Zb.LocalFunction():"Global code"==l?null:Zb.Method(d.join("."),l),g,x,h))}else c.push(Zb.Module(ha.trim(d)))}}return c}return 0<b&&Array.isArray(a)?a.slice(b):a};ma.tryHaxeStack=function(a){if(null==a)return[];var b=
Error.prepareStackTrace;Error.prepareStackTrace=ma.prepareHxStackTrace;a=a.stack;Error.prepareStackTrace=b;return a};ma.prepareHxStackTrace=function(a,b){a=[];for(var c=0;c<b.length;){var e=b[c];++c;null!=ma.wrapCallSite&&(e=ma.wrapCallSite(e));var f=null,h=e.getFunctionName();if(null!=h){var d=h.lastIndexOf(".");0<=d?(f=h.substring(0,d),h=h.substring(d+1),f=Zb.Method(f,h)):f=Zb.Method(null,h)}h=e.getFileName();d=null==h?-1:h.indexOf("file:");null!=ma.wrapCallSite&&0<d&&(h=h.substring(d+6));a.push(Zb.FilePos(f,
h,e.getLineNumber(),e.getColumnNumber()))}return a};ma.normalize=function(a,b){null==b&&(b=0);if(Array.isArray(a)&&0<b)return a.slice(b);if("string"==typeof a){switch(a.substring(0,6)){case "Error\n":case "Error:":++b}return ma.skipLines(a,b)}return a};ma.skipLines=function(a,b,c){null==c&&(c=0);return 0<b?(c=a.indexOf("\n",c),0>c?"":ma.skipLines(a,--b,c+1)):a.substring(c)};var Ed=function(){};n["haxe._Unserializer.DefaultResolver"]=Ed;Ed.__name__=!0;Ed.prototype={resolveClass:function(a){return n[a]},
resolveEnum:function(a){return p[a]},__class__:Ed};var tb=function(a){this.buf=a;this.length=this.buf.length;this.pos=0;this.scache=[];this.cache=[];a=tb.DEFAULT_RESOLVER;null==a&&(a=new Ed,tb.DEFAULT_RESOLVER=a);this.resolver=a};n["haxe.Unserializer"]=tb;tb.__name__=!0;tb.initCodes=function(){for(var a=[],b=0,c=tb.BASE64.length;b<c;){var e=b++;a[tb.BASE64.charCodeAt(e)]=e}return a};tb.run=function(a){return(new tb(a)).unserialize()};tb.prototype={readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var e=
this.buf.charCodeAt(this.pos);if(e!=e)break;if(45==e){if(this.pos!=c)break;b=!0}else{if(48>e||57<e)break;a=10*a+(e-48)}this.pos++}b&&(a*=-1);return a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(b!=b)break;if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return parseFloat(G.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw A.thrown("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();
if("string"!=typeof b)throw A.thrown("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.buf.charCodeAt(this.pos++))throw A.thrown("Invalid enum format");var c=this.readDigits();if(0==c)return ia.createEnum(a,b);for(var e=[];0<c--;)e.push(this.unserialize());return ia.createEnum(a,b,e)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var a=this.unserialize(),b=this.resolver.resolveClass(a);if(null==b)throw A.thrown("Class not found "+
a);return b;case 66:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw A.thrown("Enum not found "+a);return b;case 67:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw A.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);b.hxUnserialize(this);if(103!=this.buf.charCodeAt(this.pos++))throw A.thrown("Invalid custom data");return b;case 77:a=new zb;this.cache.push(a);for(var c;104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),a.set(b,
this.unserialize());this.pos++;return a;case 82:a=this.readDigits();if(0>a||a>=this.scache.length)throw A.thrown("Invalid string reference");return this.scache[a];case 97:b=[];for(this.cache.push(b);;){c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}117==c?(this.pos++,a=this.readDigits(),b[b.length+a-1]=null):b.push(this.unserialize())}return b;case 98:a=new W;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),c=this.unserialize(),a.h[b]=c;this.pos++;return a;
case 99:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw A.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);this.unserializeObject(b);return b;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw A.thrown("Enum not found "+a);this.pos++;for(var e=this.readDigits(),f=c.__constructs__,h=Array(f.length),d=0,l=f.length;d<l;)b=d++,h[b]=f[b]._hx_name;
b=h[e];if(null==b)throw A.thrown("Unknown enum index "+a+"@"+e);b=this.unserializeEnum(c,b);this.cache.push(b);return b;case 107:return NaN;case 108:b=new ub;for(this.cache.push(b);104!=this.buf.charCodeAt(this.pos);)b.add(this.unserialize());this.pos++;return b;case 109:return-Infinity;case 110:return null;case 111:return b={},this.cache.push(b),this.unserializeObject(b),b;case 112:return Infinity;case 113:a=new Bb;this.cache.push(a);for(c=this.buf.charCodeAt(this.pos++);58==c;)b=this.readDigits(),
c=this.unserialize(),a.h[b]=c,c=this.buf.charCodeAt(this.pos++);if(104!=c)throw A.thrown("Invalid IntMap format");return a;case 114:a=this.readDigits();if(0>a||a>=this.cache.length)throw A.thrown("Invalid reference");return this.cache[a];case 115:a=this.readDigits();c=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw A.thrown("Invalid bytes length");e=tb.CODES;null==e&&(e=tb.initCodes(),tb.CODES=e);b=this.pos;f=a&3;h=b+(a-f);d=new La(new ArrayBuffer(3*(a>>2)+(2<=f?f-1:
0)));for(l=0;b<h;){var g=e[c.charCodeAt(b++)],m=e[c.charCodeAt(b++)];d.b[l++]=(g<<2|m>>4)&255;g=e[c.charCodeAt(b++)];d.b[l++]=(m<<4|g>>2)&255;m=e[c.charCodeAt(b++)];d.b[l++]=(g<<6|m)&255}2<=f&&(g=e[c.charCodeAt(b++)],m=e[c.charCodeAt(b++)],d.b[l++]=(g<<2|m>>4)&255,3==f&&(g=e[c.charCodeAt(b++)],d.b[l++]=(m<<4|g>>2)&255));this.pos+=a;this.cache.push(d);return d;case 116:return!0;case 118:return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&48<=this.buf.charCodeAt(this.pos+1)&&
57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+3)&&45==this.buf.charCodeAt(this.pos+4)?(b=G.strDate(G.substr(this.buf,this.pos,19)),this.pos+=19):b=new Date(this.readFloat()),this.cache.push(b),b;case 119:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw A.thrown("Enum not found "+a);b=this.unserializeEnum(c,this.unserialize());this.cache.push(b);
return b;case 120:throw A.thrown(this.unserialize());case 121:a=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw A.thrown("Invalid string length");b=G.substr(this.buf,this.pos,a);this.pos+=a;b=decodeURIComponent(b.split("+").join(" "));this.scache.push(b);return b;case 122:return 0}this.pos--;throw A.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos);},__class__:tb};var Zc=function(a,b,c){A.call(this,String(a),b,c);this.value=a;this.__skipStack++};
n["haxe.ValueException"]=Zc;Zc.__name__=!0;Zc.__super__=A;Zc.prototype=F(A.prototype,{unwrap:function(){return this.value},__class__:Zc});var Kc=function(){this.a1=1;this.a2=0};n["haxe.crypto.Adler32"]=Kc;Kc.__name__=!0;Kc.read=function(a){var b=new Kc,c=a.readByte(),e=a.readByte(),f=a.readByte();a=a.readByte();b.a1=f<<8|a;b.a2=c<<8|e;return b};Kc.prototype={update:function(a,b,c){var e=this.a1,f=this.a2,h=b;for(b+=c;h<b;)c=h++,e=(e+a.b[c])%65521,f=(f+e)%65521;this.a1=e;this.a2=f},equals:function(a){return a.a1==
this.a1?a.a2==this.a2:!1},__class__:Kc};var La=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};n["haxe.io.Bytes"]=La;La.__name__=!0;La.ofString=function(a,b){b=[];for(var c=0;c<a.length;){var e=a.charCodeAt(c++);55296<=e&&56319>=e&&(e=e-55232<<10|a.charCodeAt(c++)&1023);127>=e?b.push(e):(2047>=e?b.push(192|e>>6):(65535>=e?b.push(224|e>>12):(b.push(240|e>>18),b.push(128|e>>12&63)),b.push(128|e>>6&63)),b.push(128|e&63))}return new La((new Uint8Array(b)).buffer)};
La.ofData=function(a){var b=a.hxBytes;return null!=b?b:new La(a)};La.prototype={blit:function(a,b,c,e){if(0>a||0>c||0>e||a+e>this.length||c+e>b.length)throw A.thrown(Qb.OutsideBounds);0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},getString:function(a,b,c){if(0>a||0>b||a+b>this.length)throw A.thrown(Qb.OutsideBounds);c="";var e=this.b,f=B.fromCharCode,h=a;for(a+=b;h<a;)if(b=e[h++],128>b){if(0==b)break;c+=f(b)}else if(224>b)c+=f((b&63)<<6|e[h++]&127);else if(240>b){var d=
e[h++];c+=f((b&31)<<12|(d&127)<<6|e[h++]&127)}else{d=e[h++];var l=e[h++];b=(b&15)<<18|(d&127)<<12|(l&127)<<6|e[h++]&127;c+=f((b>>10)+55232);c+=f(b&1023|56320)}return c},toString:function(){return this.getString(0,this.length)},__class__:La};var ed=p["haxe.ds.Either"]={__ename__:!0,__constructs__:null,Left:(g=function(a){return{_hx_index:0,v:a,__enum__:"haxe.ds.Either",toString:d}},g._hx_name="Left",g.__params__=["v"],g),Right:(g=function(a){return{_hx_index:1,v:a,__enum__:"haxe.ds.Either",toString:d}},
g._hx_name="Right",g.__params__=["v"],g)};ed.__constructs__=[ed.Left,ed.Right];var Bb=function(){this.h={}};n["haxe.ds.IntMap"]=Bb;Bb.__name__=!0;Bb.__interfaces__=[Jc];Bb.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(+b);return new Oc(a)},iterator:function(){return{ref:this.h,
it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref[a]}}},toString:function(){var a="{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=null==c?"null":""+c;a+=" => ";a+=m.string(m.string(this.h[c]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:Bb};var ub=function(){this.length=0};n["haxe.ds.List"]=ub;ub.__name__=!0;ub.prototype={add:function(a){a=new Fd(a,null);null==this.h?this.h=a:this.q.next=a;this.q=a;this.length++},push:function(a){this.h=
a=new Fd(a,this.h);null==this.q&&(this.q=a);this.length++},first:function(){return null==this.h?null:this.h.item},pop:function(){if(null==this.h)return null;var a=this.h.item;this.h=this.h.next;null==this.h&&(this.q=null);this.length--;return a},isEmpty:function(){return null==this.h},toString:function(){var a,b=!0,c=this.h;for(a="{";null!=c;)b?b=!1:a+=", ",a+=m.string(m.string(c.item)),c=c.next;return a+"}"},__class__:ub};var Fd=function(a,b){this.item=a;this.next=b};n["haxe.ds._List.ListNode"]=
Fd;Fd.__name__=!0;Fd.prototype={__class__:Fd};var zb=function(){this.h={__keys__:{}}};n["haxe.ds.ObjectMap"]=zb;zb.__name__=!0;zb.__interfaces__=[Jc];zb.prototype={set:function(a,b){var c=a.__id__;null==c&&(c=a.__id__=u.$haxeUID++);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},exists:function(a){return null!=this.h.__keys__[a.__id__]},remove:function(a){a=a.__id__;if(null==this.h.__keys__[a])return!1;delete this.h[a];delete this.h.__keys__[a];return!0},keys:function(){var a=
[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return new Oc(a)},toString:function(){var a="{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=m.string(m.string(c));a+=" => ";a+=m.string(m.string(this.h[c.__id__]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:zb};var W=function(){this.h=Object.create(null)};n["haxe.ds.StringMap"]=W;W.__name__=!0;W.__interfaces__=[Jc];W.stringify=function(a){var b="{",c=!0,e;for(e in a)c?c=!1:b+=",",b+=e+" => "+m.string(a[e]);
return b+"}"};W.prototype={exists:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)},get:function(a){return this.h[a]},set:function(a,b){this.h[a]=b},remove:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)?(delete this.h[a],!0):!1},toString:function(){return W.stringify(this.h)},__class__:W};var Lc=function(a,b,c){A.call(this,a,b);this.posInfos=null==c?{fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:c;this.__skipStack++};n["haxe.exceptions.PosException"]=
Lc;Lc.__name__=!0;Lc.__super__=A;Lc.prototype=F(A.prototype,{toString:function(){return""+A.prototype.toString.call(this)+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber},__class__:Lc});var Gd=function(a,b,c){null==a&&(a="Not implemented");Lc.call(this,a,b,c);this.__skipStack++};n["haxe.exceptions.NotImplementedException"]=Gd;Gd.__name__=!0;Gd.__super__=Lc;Gd.prototype=F(Lc.prototype,{__class__:Gd});var ld=function(){this.size=
this.pos=0};n["haxe.io.BytesBuffer"]=ld;ld.__name__=!0;ld.prototype={addByte:function(a){this.pos==this.size&&this.grow(1);this.view.setUint8(this.pos++,a)},add:function(a){this.pos+a.length>this.size&&this.grow(a.length);if(0!=this.size){var b=new Uint8Array(a.b.buffer,a.b.byteOffset,a.length);this.u8.set(b,this.pos);this.pos+=a.length}},addBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw A.thrown(Qb.OutsideBounds);this.pos+c>this.size&&this.grow(c);0!=this.size&&(a=new Uint8Array(a.b.buffer,
a.b.byteOffset+b,c),this.u8.set(a,this.pos),this.pos+=c)},grow:function(a){var b=this.pos+a;for(a=0==this.size?16:this.size;a<b;)a=3*a>>1;b=new ArrayBuffer(a);var c=new Uint8Array(b);0<this.size&&c.set(this.u8);this.size=a;this.buffer=b;this.u8=c;this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new La(new ArrayBuffer(0));var a=new La(this.buffer);a.length=this.pos;return a},__class__:ld};var md=function(){};n["haxe.io.Input"]=md;md.__name__=!0;md.prototype={readByte:function(){throw new Gd(null,
null,{fileName:"haxe/io/Input.hx",lineNumber:53,className:"haxe.io.Input",methodName:"readByte"});},readBytes:function(a,b,c){var e=c,f=a.b;if(0>b||0>c||b+c>a.length)throw A.thrown(Qb.OutsideBounds);try{for(;0<e;)f[b]=this.readByte(),++b,--e}catch(h){if(ma.lastError=h,!(A.caught(h).unwrap()instanceof nd))throw h;}return c-e},readFullBytes:function(a,b,c){for(;0<c;){var e=this.readBytes(a,b,c);if(0==e)throw A.thrown(Qb.Blocked);b+=e;c-=e}},read:function(a){for(var b=new La(new ArrayBuffer(a)),c=0;0<
a;){var e=this.readBytes(b,c,a);if(0==e)throw A.thrown(Qb.Blocked);c+=e;a-=e}return b},readInt16:function(){var a=this.readByte(),b=this.readByte();a=this.bigEndian?b|a<<8:a|b<<8;return 0!=(a&32768)?a-65536:a},readUInt16:function(){var a=this.readByte(),b=this.readByte();return this.bigEndian?b|a<<8:a|b<<8},readInt32:function(){var a=this.readByte(),b=this.readByte(),c=this.readByte(),e=this.readByte();return this.bigEndian?e|c<<8|b<<16|a<<24:a|b<<8|c<<16|e<<24},readString:function(a,b){var c=new La(new ArrayBuffer(a));
this.readFullBytes(c,0,a);return c.getString(0,a,b)},__class__:md};var od=function(a,b,c){null==b&&(b=0);null==c&&(c=a.length-b);if(0>b||0>c||b+c>a.length)throw A.thrown(Qb.OutsideBounds);this.b=a.b;this.pos=b;this.totlen=this.len=c};n["haxe.io.BytesInput"]=od;od.__name__=!0;od.__super__=md;od.prototype=F(md.prototype,{readByte:function(){if(0==this.len)throw A.thrown(new nd);this.len--;return this.b[this.pos++]},readBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw A.thrown(Qb.OutsideBounds);
if(0==this.len&&0<c)throw A.thrown(new nd);this.len<c&&(c=this.len);var e=this.b;a=a.b;for(var f=0,h=c;f<h;){var d=f++;a[b+d]=e[this.pos+d]}this.pos+=c;this.len-=c;return c},__class__:od});var Ue=p["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:d},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:d}};Ue.__constructs__=[Ue.UTF8,Ue.RawNative];var nd=function(){};n["haxe.io.Eof"]=nd;nd.__name__=
!0;nd.prototype={toString:function(){return"Eof"},__class__:nd};var Qb=p["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:d},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:d},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:d},Custom:(g=function(a){return{_hx_index:3,e:a,__enum__:"haxe.io.Error",toString:d}},g._hx_name="Custom",g.__params__=["e"],g)};Qb.__constructs__=
[Qb.Blocked,Qb.Overflow,Qb.OutsideBounds,Qb.Custom];var ic=function(a){switch(a){case ".":case "..":this.dir=a;this.file="";return}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this.dir=G.substr(a,0,c),a=G.substr(a,c+1,null),this.backslash=!0):c<b?(this.dir=G.substr(a,0,b),a=G.substr(a,b+1,null)):this.dir=null;b=a.lastIndexOf(".");-1!=b?(this.ext=G.substr(a,b+1,null),this.file=G.substr(a,0,b)):(this.ext=null,this.file=a)};n["haxe.io.Path"]=ic;ic.__name__=!0;ic.directory=function(a){a=new ic(a);
return null==a.dir?"":a.dir};ic.prototype={__class__:ic};var Oc=function(a){this.current=0;this.array=a};n["haxe.iterators.ArrayIterator"]=Oc;Oc.__name__=!0;Oc.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Oc};var Mc=p["haxe.zip.ExtraField"]={__ename__:!0,__constructs__:null,FUnknown:(g=function(a,b){return{_hx_index:0,tag:a,bytes:b,__enum__:"haxe.zip.ExtraField",toString:d}},g._hx_name="FUnknown",g.__params__=["tag",
"bytes"],g),FInfoZipUnicodePath:(g=function(a,b){return{_hx_index:1,name:a,crc:b,__enum__:"haxe.zip.ExtraField",toString:d}},g._hx_name="FInfoZipUnicodePath",g.__params__=["name","crc"],g),FUtf8:{_hx_name:"FUtf8",_hx_index:2,__enum__:"haxe.zip.ExtraField",toString:d}};Mc.__constructs__=[Mc.FUnknown,Mc.FInfoZipUnicodePath,Mc.FUtf8];var Rb=p["haxe.zip.Huffman"]={__ename__:!0,__constructs__:null,Found:(g=function(a){return{_hx_index:0,i:a,__enum__:"haxe.zip.Huffman",toString:d}},g._hx_name="Found",g.__params__=
["i"],g),NeedBit:(g=function(a,b){return{_hx_index:1,left:a,right:b,__enum__:"haxe.zip.Huffman",toString:d}},g._hx_name="NeedBit",g.__params__=["left","right"],g),NeedBits:(g=function(a,b){return{_hx_index:2,n:a,table:b,__enum__:"haxe.zip.Huffman",toString:d}},g._hx_name="NeedBits",g.__params__=["n","table"],g)};Rb.__constructs__=[Rb.Found,Rb.NeedBit,Rb.NeedBits];var je=function(){};n["haxe.zip.HuffTools"]=je;je.__name__=!0;je.prototype={treeDepth:function(a){switch(a._hx_index){case 0:return 0;case 1:var b=
a.right;a=this.treeDepth(a.left);b=this.treeDepth(b);return 1+(a<b?a:b);case 2:throw A.thrown("assert");}},treeCompress:function(a){var b=this.treeDepth(a);if(0==b)return a;if(1==b){if(1==a._hx_index)return b=a.right,Rb.NeedBit(this.treeCompress(a.left),this.treeCompress(b));throw A.thrown("assert");}for(var c=[],e=0,f=1<<b;e<f;)e++,c.push(Rb.Found(-1));this.treeWalk(c,0,0,b,a);return Rb.NeedBits(b,c)},treeWalk:function(a,b,c,e,f){if(1==f._hx_index){var h=f.left,d=f.right;0<e?(this.treeWalk(a,b,c+
1,e-1,h),this.treeWalk(a,b|1<<c,c+1,e-1,d)):a[b]=this.treeCompress(f)}else a[b]=this.treeCompress(f)},treeMake:function(a,b,c,e){if(e>b)throw A.thrown("Invalid huffman");var f=c<<5|e;if(a.h.hasOwnProperty(f))return Rb.Found(a.h[f]);c<<=1;++e;return Rb.NeedBit(this.treeMake(a,b,c,e),this.treeMake(a,b,c|1,e))},make:function(a,b,c,e){if(1==c)return Rb.NeedBit(Rb.Found(0),Rb.Found(0));var f=[],h=[];if(32<e)throw A.thrown("Invalid huffman");for(var d=0,l=e;d<l;)d++,f.push(0),h.push(0);d=0;for(l=c;d<l;){var g=
d++;g=a[g+b];if(g>=e)throw A.thrown("Invalid huffman");f[g]++}var m=0;d=1;for(l=e-1;d<l;)g=d++,m=m+f[g]<<1,h[g]=m;f=new Bb;d=0;for(l=c;d<l;)g=d++,c=a[g+b],0!=c&&(m=h[c-1],h[c-1]=m+1,f.h[m<<5|c]=g);return this.treeCompress(Rb.NeedBit(this.treeMake(f,e,0,1),this.treeMake(f,e,1,1)))},__class__:je};var ke=function(a){this.buffer=new La(new ArrayBuffer(65536));this.pos=0;a&&(this.crc=new Kc)};n["haxe.zip._InflateImpl.Window"]=ke;ke.__name__=!0;ke.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,
0,32768);var a=new La(new ArrayBuffer(65536));this.pos-=32768;a.blit(0,this.buffer,32768,this.pos);this.buffer=a},addBytes:function(a,b,c){65536<this.pos+c&&this.slide();this.buffer.blit(this.pos,a,b,c);this.pos+=c},addByte:function(a){65536==this.pos&&this.slide();this.buffer.b[this.pos]=a&255;this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){null!=this.crc&&this.crc.update(this.buffer,0,this.pos);return this.crc},__class__:ke};
var db=p["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:null,Head:{_hx_name:"Head",_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:d},Block:{_hx_name:"Block",_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:d},CData:{_hx_name:"CData",_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",toString:d},Flat:{_hx_name:"Flat",_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:d},Crc:{_hx_name:"Crc",_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:d},
Dist:{_hx_name:"Dist",_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:d},DistOne:{_hx_name:"DistOne",_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:d},Done:{_hx_name:"Done",_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:d}};db.__constructs__=[db.Head,db.Block,db.CData,db.Flat,db.Crc,db.Dist,db.DistOne,db.Done];var ib=function(a,b,c){null==c&&(c=!0);null==b&&(b=!0);this.isFinal=!1;this.htools=new je;this.huffman=this.buildFixedHuffman();this.huffdist=null;this.dist=
this.len=0;this.state=b?db.Head:db.Block;this.input=a;this.needed=this.nbits=this.bits=0;this.output=null;this.outpos=0;this.lengths=[];this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);
this.lengths.push(-1);this.lengths.push(-1);this.window=new ke(c)};n["haxe.zip.InflateImpl"]=ib;ib.__name__=!0;ib.prototype={buildFixedHuffman:function(){if(null!=ib.FIXED_HUFFMAN)return ib.FIXED_HUFFMAN;for(var a=[],b=0;288>b;){var c=b++;a.push(143>=c?8:255>=c?9:279>=c?7:8)}ib.FIXED_HUFFMAN=this.htools.make(a,0,288,10);return ib.FIXED_HUFFMAN},readBytes:function(a,b,c){this.needed=c;this.outpos=b;this.output=a;if(0<c)for(;this.inflateLoop(););return c-this.needed},getBits:function(a){for(;this.nbits<
a;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var b=this.bits&(1<<a)-1;this.nbits-=a;this.bits>>=a;return b},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var a=1==(this.bits&1);this.nbits--;this.bits>>=1;return a},getRevBits:function(a){return 0==a?0:this.getBit()?1<<a-1|this.getRevBits(a-1):this.getRevBits(a-1)},resetBits:function(){this.nbits=this.bits=0},addBytes:function(a,b,c){this.window.addBytes(a,b,c);this.output.blit(this.outpos,a,b,c);this.needed-=
c;this.outpos+=c},addByte:function(a){this.window.addByte(a);this.output.b[this.outpos]=a&255;this.needed--;this.outpos++},addDistOne:function(a){for(var b=this.window.getLastChar(),c=0;c<a;)c++,this.addByte(b)},addDist:function(a,b){this.addBytes(this.window.buffer,this.window.pos-a,b)},applyHuffman:function(a){switch(a._hx_index){case 0:var b=a.i;return b;case 1:return b=a.left,a=a.right,this.applyHuffman(this.getBit()?a:b);case 2:return b=a.n,this.applyHuffman(a.table[this.getBits(b)])}},inflateLengths:function(a,
b){for(var c=0,e=0;c<b;){var f=this.applyHuffman(this.huffman);switch(f){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:e=f;a[c]=f;++c;break;case 16:f=c+3+this.getBits(2);if(f>b)throw A.thrown("Invalid data");for(;c<f;)a[c]=e,++c;break;case 17:c+=3+this.getBits(3);if(c>b)throw A.thrown("Invalid data");break;case 18:c+=11+this.getBits(7);if(c>b)throw A.thrown("Invalid data");break;default:throw A.thrown("Invalid data");}}},inflateLoop:function(){switch(this.state._hx_index){case 0:var a=
this.input.readByte();if(8!=(a&15))throw A.thrown("Invalid data");var b=this.input.readByte(),c=0!=(b&32);if(0!=((a<<8)+b)%31)throw A.thrown("Invalid data");if(c)throw A.thrown("Unsupported dictionary");this.state=db.Block;return!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:this.len=this.input.readUInt16();if(this.input.readUInt16()!=65535-this.len)throw A.thrown("Invalid data");this.state=db.Flat;a=this.inflateLoop();this.resetBits();return a;case 1:return this.huffman=this.buildFixedHuffman(),
this.huffdist=null,this.state=db.CData,!0;case 2:a=this.getBits(5)+257;b=this.getBits(5)+1;var e=this.getBits(4)+4;c=0;for(var f=e;c<f;){var h=c++;this.lengths[ib.CODE_LENGTHS_POS[h]]=this.getBits(3)}c=e;for(f=19;c<f;)h=c++,this.lengths[ib.CODE_LENGTHS_POS[h]]=0;this.huffman=this.htools.make(this.lengths,0,19,8);e=[];c=0;for(f=a+b;c<f;)c++,e.push(0);this.inflateLengths(e,a+b);this.huffdist=this.htools.make(e,a,b,16);this.huffman=this.htools.make(e,0,a,16);this.state=db.CData;return!0;default:throw A.thrown("Invalid data");
}case 2:b=this.applyHuffman(this.huffman);if(256>b)return this.addByte(b),0<this.needed;if(256==b)this.state=this.isFinal?db.Crc:db.Block;else{b-=257;a=ib.LEN_EXTRA_BITS_TBL[b];if(-1==a)throw A.thrown("Invalid data");this.len=ib.LEN_BASE_VAL_TBL[b]+this.getBits(a);b=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);a=ib.DIST_EXTRA_BITS_TBL[b];if(-1==a)throw A.thrown("Invalid data");this.dist=ib.DIST_BASE_VAL_TBL[b]+this.getBits(a);if(this.dist>this.window.available())throw A.thrown("Invalid data");
this.state=1==this.dist?db.DistOne:db.Dist}return!0;case 3:return a=this.len<this.needed?this.len:this.needed,b=this.input.read(a),this.len-=a,this.addBytes(b,0,a),0==this.len&&(this.state=this.isFinal?db.Crc:db.Block),0<this.needed;case 4:a=this.window.checksum();if(null==a)return this.state=db.Done,!0;b=Kc.read(this.input);if(!a.equals(b))throw A.thrown("Invalid CRC");this.state=db.Done;return!0;case 5:for(;0<this.len&&0<this.needed;)a=this.len<this.dist?this.len:this.dist,a=this.needed<a?this.needed:
a,this.addDist(this.dist,a),this.len-=a;0==this.len&&(this.state=db.CData);return 0<this.needed;case 6:return a=this.len<this.needed?this.len:this.needed,this.addDistOne(a),this.len-=a,0==this.len&&(this.state=db.CData),0<this.needed;case 7:return!1}},__class__:ib};var pd=function(a){this.i=a};n["haxe.zip.Reader"]=pd;pd.__name__=!0;pd.readZip=function(a){return(new pd(a)).read()};pd.prototype={readZipDate:function(){var a=this.i.readUInt16(),b=a>>11&31,c=a>>5&63;a&=31;var e=this.i.readUInt16();return new Date((e>>
9)+1980,(e>>5&15)-1,e&31,b,c,a<<1)},readExtraFields:function(a){for(var b=new ub;0<a;){if(4>a)throw A.thrown("Invalid extra fields data");var c=this.i.readUInt16(),e=this.i.readUInt16();if(a<e)throw A.thrown("Invalid extra fields data");if(28789==c){var f=this.i.readByte();if(1!=f){var h=new ld;h.addByte(f);h.add(this.i.read(e-1));b.add(Mc.FUnknown(c,h.getBytes()))}else c=this.i.readInt32(),f=this.i.read(e-5).toString(),b.add(Mc.FInfoZipUnicodePath(f,c))}else b.add(Mc.FUnknown(c,this.i.read(e)));
a-=4+e}return b},readEntryHeader:function(){var a=this.i,b=a.readInt32();if(33639248==b||101010256==b)return null;if(67324752!=b)throw A.thrown("Invalid Zip Data");a.readUInt16();b=a.readUInt16();var c=0!=(b&2048),e=a.readUInt16(),f=0!=e;if(f&&8!=e)throw A.thrown("Unsupported compression "+e);e=this.readZipDate();var h=a.readInt32(),d=a.readInt32(),l=a.readInt32(),g=a.readInt16(),m=a.readInt16();a=a.readString(g);m=this.readExtraFields(m);c&&m.push(Mc.FUtf8);0!=(b&8)&&(d=-1);return{fileName:a,fileSize:l,
fileTime:e,compressed:f,dataSize:d,data:null,crc32:h,extraFields:m}},read:function(){for(var a=new ub,b=null;;){var c=this.readEntryHeader();if(null==c)break;if(0>c.dataSize){null==b&&(b=new La(new ArrayBuffer(65536)));for(var e=new ld,f=new ib(this.i,!1,!1);;){var h=f.readBytes(b,0,65536);e.addBytes(b,0,h);if(65536>h)break}c.data=e.getBytes();c.crc32=this.i.readInt32();134695760==c.crc32&&(c.crc32=this.i.readInt32());c.dataSize=this.i.readInt32();c.fileSize=this.i.readInt32();c.dataSize=c.fileSize;
c.compressed=!1}else c.data=this.i.read(c.dataSize);a.add(c)}return a},__class__:pd};var Wb=function(a,b){this.message=a;this.pos=b};n["hxjsonast.Error"]=Wb;Wb.__name__=!0;Wb.prototype={__class__:Wb};var Fa=function(a,b){this.value=a;this.pos=b};n["hxjsonast.Json"]=Fa;Fa.__name__=!0;Fa.prototype={__class__:Fa};var ta=p["hxjsonast.JsonValue"]={__ename__:!0,__constructs__:null,JString:(g=function(a){return{_hx_index:0,s:a,__enum__:"hxjsonast.JsonValue",toString:d}},g._hx_name="JString",g.__params__=
["s"],g),JNumber:(g=function(a){return{_hx_index:1,s:a,__enum__:"hxjsonast.JsonValue",toString:d}},g._hx_name="JNumber",g.__params__=["s"],g),JObject:(g=function(a){return{_hx_index:2,fields:a,__enum__:"hxjsonast.JsonValue",toString:d}},g._hx_name="JObject",g.__params__=["fields"],g),JArray:(g=function(a){return{_hx_index:3,values:a,__enum__:"hxjsonast.JsonValue",toString:d}},g._hx_name="JArray",g.__params__=["values"],g),JBool:(g=function(a){return{_hx_index:4,b:a,__enum__:"hxjsonast.JsonValue",
toString:d}},g._hx_name="JBool",g.__params__=["b"],g),JNull:{_hx_name:"JNull",_hx_index:5,__enum__:"hxjsonast.JsonValue",toString:d}};ta.__constructs__=[ta.JString,ta.JNumber,ta.JObject,ta.JArray,ta.JBool,ta.JNull];var le=function(a,b,c){this.name=a;this.namePos=b;this.value=c};n["hxjsonast.JObjectField"]=le;le.__name__=!0;le.prototype={__class__:le};var $d=function(a,b){this.source=a;this.filename=b;this.pos=0};n["hxjsonast.Parser"]=$d;$d.__name__=!0;$d.prototype={doParse:function(){for(var a=this.parseRec(),
b;;){var c=b=this.source.charCodeAt(this.pos++);if(c!=c)break;switch(b){case 9:case 10:case 13:case 32:break;default:this.invalidChar()}}return a},parseRec:function(){for(;;){var a=this.source.charCodeAt(this.pos++);switch(a){case 9:case 10:case 13:case 32:break;case 34:var b=this.pos,c=this.parseString();return new Fa(ta.JString(c),new xa(this.filename,b-1,this.pos));case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:b=this.pos-1;c=45==a;var e=!c;a=48==a;for(var f=
!1,h=!1,d=!1,l=!1;;){switch(this.source.charCodeAt(this.pos++)){case 43:case 45:h&&!d||this.invalidNumber(b);e=!1;d=!0;break;case 46:(c||f||h)&&this.invalidNumber(b);e=!1;f=!0;break;case 48:a&&!f&&this.invalidNumber(b);c&&(c=!1,a=!0);e=!0;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:a&&!f&&this.invalidNumber(b);c&&(c=!1);e=!0;a=!1;break;case 69:case 101:(c||a||h)&&this.invalidNumber(b);e=!1;h=!0;break;default:e||this.invalidNumber(b),this.pos--,l=!0}if(l)break}c=G.substr(this.source,
b,this.pos-b);return new Fa(ta.JNumber(c),new xa(this.filename,b,this.pos));case 91:for(b=[],c=null,e=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 44:c?c=!1:this.invalidChar();break;case 93:return 0==c&&this.invalidChar(),new Fa(ta.JArray(b),new xa(this.filename,e,this.pos));default:c&&this.invalidChar(),this.pos--,b.push(this.parseRec()),c=!0}case 102:b=this.pos;if(97!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||
115!=this.source.charCodeAt(this.pos++)||101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new Fa(ta.JBool(!1),new xa(this.filename,b-1,this.pos));case 110:b=this.pos;if(117!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new Fa(ta.JNull,new xa(this.filename,b-1,this.pos));case 116:b=this.pos;if(114!=this.source.charCodeAt(this.pos++)||117!=this.source.charCodeAt(this.pos++)||
101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new Fa(ta.JBool(!0),new xa(this.filename,b-1,this.pos));case 123:for(b=[],c=Object.create(null),a=h=e=null,f=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 34:(null!=e||a)&&this.invalidChar();h=this.pos-1;e=this.parseString();h=new xa(this.filename,h,this.pos);if(Object.prototype.hasOwnProperty.call(c,e))throw A.thrown(new Wb('Duplicate field name "'+e+'"',h));c[e]=!0;break;
case 44:a?a=!1:this.invalidChar();break;case 58:null==e&&this.invalidChar();b.push(new le(e,h,this.parseRec()));h=e=null;a=!0;break;case 125:return null==e&&0!=a||this.invalidChar(),new Fa(ta.JObject(b),new xa(this.filename,f,this.pos));default:this.invalidChar()}default:this.invalidChar()}}},parseString:function(){for(var a=this.pos,b=null;;){var c=this.source.charCodeAt(this.pos++);if(34==c)break;if(92==c){null==b&&(b=new na);c=this.source;var e=this.pos-a-1;b.b+=null==e?G.substr(c,a,null):G.substr(c,
a,e);c=this.source.charCodeAt(this.pos++);switch(c){case 34:case 47:case 92:b.b+=String.fromCodePoint(c);break;case 98:b.b+=String.fromCodePoint(8);break;case 102:b.b+=String.fromCodePoint(12);break;case 110:b.b+=String.fromCodePoint(10);break;case 114:b.b+=String.fromCodePoint(13);break;case 116:b.b+=String.fromCodePoint(9);break;case 117:a=m.parseInt("0x"+G.substr(this.source,this.pos,4));this.pos+=4;b.b+=String.fromCodePoint(a);break;default:throw A.thrown(new Wb("Invalid escape sequence \\"+String.fromCodePoint(c),
new xa(this.filename,this.pos-2,this.pos)));}a=this.pos}else if(c!=c)throw this.pos--,A.thrown(new Wb("Unclosed string",new xa(this.filename,a-1,this.pos)));}if(null==b)return G.substr(this.source,a,this.pos-a-1);c=this.source;e=this.pos-a-1;b.b+=null==e?G.substr(c,a,null):G.substr(c,a,e);return b.b},invalidChar:function(){this.pos--;throw A.thrown(new Wb("Invalid character: "+this.source.charAt(this.pos),new xa(this.filename,this.pos,this.pos+1)));},invalidNumber:function(a){throw A.thrown(new Wb("Invalid number: "+
this.source.substring(a,this.pos),new xa(this.filename,a,this.pos)));},__class__:$d};var xa=function(a,b,c){this.file=a;this.min=b;this.max=c};n["hxjsonast.Position"]=xa;xa.__name__=!0;xa.prototype={__class__:xa};var ja=function(){};n["js.Boot"]=ja;ja.__name__=!0;ja.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;var b=a.__class__;if(null!=b)return b;a=ja.__nativeClassName(a);return null!=a?ja.__resolveNativeClass(a):null};ja.__string_rec=function(a,b){if(null==a)return"null";
if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a.__enum__){var e=p[a.__enum__].__constructs__[a._hx_index];c=e._hx_name;if(e.__params__){b+="\t";var f=[],h=0;for(e=e.__params__;h<e.length;){var d=e[h];h+=1;f.push(ja.__string_rec(a[d],b))}return c+"("+f.join(",")+")"}return c}if(a instanceof Array){c="[";b+="\t";f=0;for(h=a.length;f<h;)e=f++,c+=(0<e?",":"")+ja.__string_rec(a[e],b);return c+
"]"}try{f=a.toString}catch(l){return ma.lastError=l,"???"}if(null!=f&&f!=Object.toString&&"function"==typeof f&&(c=a.toString(),"[object Object]"!=c))return c;c="{\n";b+="\t";f=null!=a.hasOwnProperty;h=null;for(h in a)f&&!a.hasOwnProperty(h)||"prototype"==h||"__class__"==h||"__super__"==h||"__interfaces__"==h||"__properties__"==h||(2!=c.length&&(c+=", \n"),c+=b+h+" : "+ja.__string_rec(a[h],b));b=b.substring(1);return c+("\n"+b+"}");case "string":return a;default:return String(a)}};ja.__interfLoop=
function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var e=0,f=c.length;e<f;){var h=e++;h=c[h];if(h==b||ja.__interfLoop(h,b))return!0}return ja.__interfLoop(a.__super__,b)};ja.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array;case Ye:return"boolean"==typeof a;case Ze:return null!=a;case $e:return"number"==typeof a;case af:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==
typeof b){if(ja.__downcastCheck(a,b))return!0}else{if("object"==typeof b&&ja.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==bf&&null!=a.__name__||b==cf&&null!=a.__ename__?!0:null!=a.__enum__?p[a.__enum__]==b:!1}};ja.__downcastCheck=function(a,b){return a instanceof b?!0:b.__isInterface__?ja.__interfLoop(ja.getClass(a),b):!1};ja.__cast=function(a,b){if(null==a||ja.__instanceof(a,b))return a;throw A.thrown("Cannot cast "+m.string(a)+" to "+m.string(b));};ja.__nativeClassName=function(a){a=
ja.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};ja.__isNativeObj=function(a){return null!=ja.__nativeClassName(a)};ja.__resolveNativeClass=function(a){return u[a]};var ra=p["json2object.Error"]={__ename__:!0,__constructs__:null,IncorrectType:(g=function(a,b,c){return{_hx_index:0,variable:a,expected:b,pos:c,__enum__:"json2object.Error",toString:d}},g._hx_name="IncorrectType",g.__params__=["variable","expected","pos"],g),IncorrectEnumValue:(g=function(a,
b,c){return{_hx_index:1,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:d}},g._hx_name="IncorrectEnumValue",g.__params__=["value","expected","pos"],g),InvalidEnumConstructor:(g=function(a,b,c){return{_hx_index:2,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:d}},g._hx_name="InvalidEnumConstructor",g.__params__=["value","expected","pos"],g),UninitializedVariable:(g=function(a,b){return{_hx_index:3,variable:a,pos:b,__enum__:"json2object.Error",toString:d}},g._hx_name=
"UninitializedVariable",g.__params__=["variable","pos"],g),UnknownVariable:(g=function(a,b){return{_hx_index:4,variable:a,pos:b,__enum__:"json2object.Error",toString:d}},g._hx_name="UnknownVariable",g.__params__=["variable","pos"],g),ParserError:(g=function(a,b){return{_hx_index:5,message:a,pos:b,__enum__:"json2object.Error",toString:d}},g._hx_name="ParserError",g.__params__=["message","pos"],g),CustomFunctionException:(g=function(a,b){return{_hx_index:6,e:a,pos:b,__enum__:"json2object.Error",toString:d}},
g._hx_name="CustomFunctionException",g.__params__=["e","pos"],g)};ra.__constructs__=[ra.IncorrectType,ra.IncorrectEnumValue,ra.InvalidEnumConstructor,ra.UninitializedVariable,ra.UnknownVariable,ra.ParserError,ra.CustomFunctionException];var Ib=p["json2object.InternalError"]={__ename__:!0,__constructs__:null,AbstractNoJsonRepresentation:(g=function(a){return{_hx_index:0,name:a,__enum__:"json2object.InternalError",toString:d}},g._hx_name="AbstractNoJsonRepresentation",g.__params__=["name"],g),CannotGenerateSchema:(g=
function(a){return{_hx_index:1,name:a,__enum__:"json2object.InternalError",toString:d}},g._hx_name="CannotGenerateSchema",g.__params__=["name"],g),HandleExpr:{_hx_name:"HandleExpr",_hx_index:2,__enum__:"json2object.InternalError",toString:d},ParsingThrow:{_hx_name:"ParsingThrow",_hx_index:3,__enum__:"json2object.InternalError",toString:d},UnsupportedAbstractEnumType:(g=function(a){return{_hx_index:4,name:a,__enum__:"json2object.InternalError",toString:d}},g._hx_name="UnsupportedAbstractEnumType",
g.__params__=["name"],g),UnsupportedEnumAbstractValue:(g=function(a){return{_hx_index:5,name:a,__enum__:"json2object.InternalError",toString:d}},g._hx_name="UnsupportedEnumAbstractValue",g.__params__=["name"],g),UnsupportedMapKeyType:(g=function(a){return{_hx_index:6,name:a,__enum__:"json2object.InternalError",toString:d}},g._hx_name="UnsupportedMapKeyType",g.__params__=["name"],g),UnsupportedSchemaObjectType:(g=function(a){return{_hx_index:7,name:a,__enum__:"json2object.InternalError",toString:d}},
g._hx_name="UnsupportedSchemaObjectType",g.__params__=["name"],g),UnsupportedSchemaType:(g=function(a){return{_hx_index:8,type:a,__enum__:"json2object.InternalError",toString:d}},g._hx_name="UnsupportedSchemaType",g.__params__=["type"],g)};Ib.__constructs__=[Ib.AbstractNoJsonRepresentation,Ib.CannotGenerateSchema,Ib.HandleExpr,Ib.ParsingThrow,Ib.UnsupportedAbstractEnumType,Ib.UnsupportedEnumAbstractValue,Ib.UnsupportedMapKeyType,Ib.UnsupportedSchemaObjectType,Ib.UnsupportedSchemaType];var Le=function(){};
n["json2object.ErrorUtils"]=Le;Le.__name__=!0;Le.convertError=function(a){switch(a._hx_index){case 0:var b=a.pos;var c=b;break;case 1:c=b=a.pos;break;case 2:c=b=a.pos;break;case 3:c=b=a.pos;break;case 4:c=b=a.pos;break;case 5:c=b=a.pos;break;case 6:c=b=a.pos}b="";if(null!=c){var e=""==c.file?"line":""+c.file+":";1==c.lines.length?b=""+e+c.lines[0].number+": characters "+c.lines[0].start+"-"+c.lines[0].end+" : ":1<c.lines.length&&(b=""+e+c.lines[0].number+": lines "+c.lines[0].number+"-"+c.lines[c.lines.length-
1].number+" : ")}switch(a._hx_index){case 0:return c=a.variable,a=a.expected,b+("Variable '"+c+"' should be of type '"+a+"'");case 1:return c=a.value,a=a.expected,b+("Identifier '"+c+"' isn't part of '"+a+"'");case 2:return c=a.value,a=a.expected,b+("Enum argument '"+c+"' should be of type '"+a+"'");case 3:return c=a.variable,b+("Variable '"+c+"' should be in the json");case 4:return c=a.variable,b+("Variable '"+c+"' isn't part of the schema");case 5:return b+("Parser error: "+a.message);case 6:return a=
a.e,b+("Custom function exception: "+(null==a?"null":m.string(a)))}};var Zd=function(a){this.linesInfo=[];for(var b=0,c,e=0,f=0;e<a.length;)switch(a.charAt(e)){case "\n":c=e;this.linesInfo.push({number:f,start:b,end:c});++f;++e;b=e;break;case "\r":c=e;"\n"==a.charAt(e+1)&&++c;this.linesInfo.push({number:f,start:b,end:c});++f;b=e=c+1;break;default:++e}this.linesInfo.push({number:f,start:b,end:e})};n["json2object.PositionUtils"]=Zd;Zd.__name__=!0;Zd.prototype={convertPosition:function(a){var b=a.min,
c=a.max;a={file:a.file,min:b+1,max:c+1,lines:[]};var e=0,f=this.linesInfo.length-1;if(b>this.linesInfo[0].end)for(;f>e;){var h=(e+f)/2|0,d=this.linesInfo[h];d.start==b&&(f=e=h);d.end<b&&(e=h+1);if(d.start>b||d.end>=b&&d.start<b)f=h}for(f=this.linesInfo.length;e<f;){h=e++;d=this.linesInfo[h];if(d.start<=b&&d.end>=c){a.lines.push({number:d.number+1,start:b-d.start+1,end:c-d.start+1});break}d.start<=b&&b<=d.end&&a.lines.push({number:d.number+1,start:b-d.start+1,end:d.end+1});d.start<=c&&c<=d.end&&a.lines.push({number:d.number+
1,start:d.start+1,end:c-d.start+1});if(d.start>=c||d.end>=c)break}return a},__class__:Zd};var Qd=function(){this.connected=!0;this.buttons=[];this.axes=[]};n["lime._internal.backend.html5.GameDeviceData"]=Qd;Qd.__name__=!0;Qd.prototype={__class__:Qd};var V=function(){this.validStatus0=(new z("Tizen","gi")).match(window.navigator.userAgent)};n["lime._internal.backend.html5.HTML5HTTPRequest"]=V;V.__name__=!0;V.loadImage=function(a){var b=new vb;V.activeRequests<V.requestLimit?(V.activeRequests++,V.__loadImage(a,
b,0)):V.requestQueue.add({instance:null,uri:a,promise:b,type:"IMAGE",options:0});return b.future};V.loadImageFromBytes=function(a,b){var c=URL.createObjectURL(new Blob([a.b.bufferValue],{type:b}));return null!=c?(a=new vb,V.activeRequests<V.requestLimit?(V.activeRequests++,V.__loadImage(c,a,1)):V.requestQueue.add({instance:null,uri:c,promise:a,type:"IMAGE",options:1}),a.future):V.loadImage("data:"+b+";base64,"+lc.encode(a))};V.processQueue=function(){if(V.activeRequests<V.requestLimit&&0<V.requestQueue.length){V.activeRequests++;
var a=V.requestQueue.pop();switch(a.type){case "BINARY":a.instance.__loadData(a.uri,a.promise);break;case "IMAGE":V.__loadImage(a.uri,a.promise,a.options);break;case "TEXT":a.instance.__loadText(a.uri,a.promise);break;default:V.activeRequests--}}};V.__fixHostname=function(a){return null==a?"":a};V.__fixPort=function(a,b){if(null==a||""==a)switch(b){case "ftp:":return"21";case "gopher:":return"70";case "http:":return"80";case "https:":return"443";case "ws:":return"80";case "wss:":return"443";default:return""}return a};
V.__fixProtocol=function(a){return null==a||""==a?"http:":a};V.__isInMemoryURI=function(a){return ha.startsWith(a,"data:")?!0:ha.startsWith(a,"blob:")};V.__isSameOrigin=function(a){if(null==a||""==a||V.__isInMemoryURI(a))return!0;null==V.originElement&&(V.originElement=window.document.createElement("a"),V.originHostname=V.__fixHostname(u.location.hostname),V.originProtocol=V.__fixProtocol(u.location.protocol),V.originPort=V.__fixPort(u.location.port,V.originProtocol));var b=V.originElement;b.href=
a;""==b.hostname&&(b.href=b.href);var c=V.__fixHostname(b.hostname);a=V.__fixProtocol(b.protocol);b=V.__fixPort(b.port,a);c=""==c||c==V.originHostname;b=""==b||b==V.originPort;return"file:"!=a&&c?b:!1};V.__loadImage=function(a,b,c){var e=new Image;V.__isSameOrigin(a)||(e.crossOrigin="Anonymous");null==V.supportsImageProgress&&(V.supportsImageProgress="onprogress"in e);if(V.supportsImageProgress||V.__isInMemoryURI(a))e.addEventListener("load",function(f){V.__revokeBlobURI(a,c);f=new Cc(null,e.width,
e.height);f.__srcImage=e;V.activeRequests--;V.processQueue();b.complete(new Ga(f))},!1),e.addEventListener("progress",function(a){b.progress(a.loaded,a.total)},!1),e.addEventListener("error",function(e){V.__revokeBlobURI(a,c);V.activeRequests--;V.processQueue();b.error(e.detail)},!1),e.src=a;else{var f=new XMLHttpRequest;f.onload=function(a){V.activeRequests--;V.processQueue();(new Ga).__fromBytes(La.ofData(f.response),function(a){b.complete(a)})};f.onerror=function(a){b.error(a.message)};f.onprogress=
function(a){a.lengthComputable&&b.progress(a.loaded,a.total)};f.open("GET",a,!0);f.responseType="arraybuffer";f.overrideMimeType("text/plain; charset=x-user-defined");f.send(null)}};V.__revokeBlobURI=function(a,b){0!=(b&1)&&URL.revokeObjectURL(a)};V.prototype={init:function(a){this.parent=a},load:function(a,b,c){this.request=new XMLHttpRequest;"POST"==this.parent.method?this.request.upload.addEventListener("progress",b,!1):this.request.addEventListener("progress",b,!1);this.request.onreadystatechange=
c;b="";if(null==this.parent.data){c=Object.keys(this.parent.formData.h);for(var e=c.length,f=0;f<e;){var h=c[f++];0<b.length&&(b+="&");var d=this.parent.formData.h[h];if(-1<h.indexOf("[]")&&d instanceof Array){var l=[];for(d=y(d);d.hasNext();){var g=d.next();l.push(encodeURIComponent(g))}l=l.join("&amp;"+h+"=");b+=encodeURIComponent(h)+"="+l}else l=encodeURIComponent(h)+"=",h=m.string(d),b+=l+encodeURIComponent(h)}"GET"==this.parent.method&&""!=b&&(a=-1<a.indexOf("?")?a+("&"+b):a+("?"+b),b="")}this.request.open(m.string(this.parent.method),
a,!0);0<this.parent.timeout&&(this.request.timeout=this.parent.timeout);this.binary&&(this.request.responseType="arraybuffer");a=null;l=0;for(c=this.parent.headers;l<c.length;)e=c[l],++l,"Content-Type"==e.name?a=e.value:this.request.setRequestHeader(e.name,e.value);null!=this.parent.contentType&&(a=this.parent.contentType);null==a&&(null!=this.parent.data?a="application/octet-stream":""!=b&&(a="application/x-www-form-urlencoded"));null!=a&&this.request.setRequestHeader("Content-Type",a);this.parent.withCredentials&&
(this.request.withCredentials=!0);null!=this.parent.data?this.request.send(this.parent.data.b.bufferValue):this.request.send(b)},loadData:function(a){var b=new vb;V.activeRequests<V.requestLimit?(V.activeRequests++,this.__loadData(a,b)):V.requestQueue.add({instance:this,uri:a,promise:b,type:"BINARY",options:0});return b.future},loadText:function(a){var b=new vb;V.activeRequests<V.requestLimit?(V.activeRequests++,this.__loadText(a,b)):V.requestQueue.add({instance:this,uri:a,promise:b,type:"TEXT",options:0});
return b.future},processResponse:function(){if(this.parent.enableResponseHeaders){this.parent.responseHeaders=[];for(var a,b,c=0,e=this.request.getAllResponseHeaders().split("\n");c<e.length;)b=e[c],++c,a=ha.trim(G.substr(b,0,b.indexOf(":"))),b=ha.trim(G.substr(b,b.indexOf(":")+1,null)),""!=a&&this.parent.responseHeaders.push(new me(a,b))}this.parent.responseStatus=this.request.status},__loadData:function(a,b){var c=this;this.binary=!0;this.load(a,function(a){b.progress(a.loaded,a.total)},function(a){4==
c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>c.request.status||c.validStatus0&&0==c.request.status)?(a=null,""==c.request.responseType?null!=c.request.responseText&&(a=La.ofString(c.request.responseText)):null!=c.request.response&&(a=La.ofData(c.request.response)),c.processResponse(),b.complete(a)):(c.processResponse(),b.error(c.request.status)),c.request=null,V.activeRequests--,V.processQueue())})},__loadText:function(a,b){var c=this;this.binary=!1;this.load(a,function(a){b.progress(a.loaded,
a.total)},function(a){4==c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>=c.request.status||c.validStatus0&&0==c.request.status)?(c.processResponse(),b.complete(c.request.responseText)):(c.processResponse(),b.error(c.request.status)),c.request=null,V.activeRequests--,V.processQueue())})},__class__:V};var $c=function(a){this.unusedTouchesPool=new ub;this.scale=1;this.currentTouches=new Bb;this.parent=a;this.cursor=Sb.DEFAULT;this.cacheMouseY=this.cacheMouseX=0;var b=a.__attributes;
Object.prototype.hasOwnProperty.call(b,"context")||(b.context={});this.renderType=b.context.type;Object.prototype.hasOwnProperty.call(b,"element")&&(a.element=b.element);var c=a.element;Object.prototype.hasOwnProperty.call(b,"allowHighDPI")&&b.allowHighDPI&&"dom"!=this.renderType&&(this.scale=window.devicePixelRatio);a.__scale=this.scale;this.setWidth=Object.prototype.hasOwnProperty.call(b,"width")?b.width:0;this.setHeight=Object.prototype.hasOwnProperty.call(b,"height")?b.height:0;a.__width=this.setWidth;
a.__height=this.setHeight;a.id=$c.windowID++;c instanceof HTMLCanvasElement?this.canvas=c:"dom"==this.renderType?this.div=window.document.createElement("div"):this.canvas=window.document.createElement("canvas");if(null!=this.canvas){var e=this.canvas.style;e.setProperty("-webkit-transform","translateZ(0)",null);e.setProperty("transform","translateZ(0)",null)}else null!=this.div&&(e=this.div.style,e.setProperty("-webkit-transform","translate3D(0,0,0)",null),e.setProperty("transform","translate3D(0,0,0)",
null),e.position="relative",e.overflow="hidden",e.setProperty("-webkit-user-select","none",null),e.setProperty("-moz-user-select","none",null),e.setProperty("-ms-user-select","none",null),e.setProperty("-o-user-select","none",null));0==a.__width&&0==a.__height&&(null!=c?(a.__width=c.clientWidth,a.__height=c.clientHeight):(a.__width=window.innerWidth,a.__height=window.innerHeight),this.cacheElementWidth=a.__width,this.cacheElementHeight=a.__height,this.resizeElement=!0);null!=this.canvas?(this.canvas.width=
Math.round(a.__width*this.scale),this.canvas.height=Math.round(a.__height*this.scale),this.canvas.style.width=a.__width+"px",this.canvas.style.height=a.__height+"px"):(this.div.style.width=a.__width+"px",this.div.style.height=a.__height+"px");if(Object.prototype.hasOwnProperty.call(b,"resizable")&&b.resizable||!Object.prototype.hasOwnProperty.call(b,"width")&&0==this.setWidth&&0==this.setHeight)a.__resizable=!0;this.updateSize();if(null!=c){null!=this.canvas?c!=this.canvas&&c.appendChild(this.canvas):
c.appendChild(this.div);b="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" ");for(e=0;e<b.length;){var f=b[e];++e;c.addEventListener(f,q(this,this.handleMouseEvent),!0)}c.addEventListener("contextmenu",q(this,this.handleContextMenuEvent),!0);c.addEventListener("dragstart",q(this,this.handleDragEvent),!0);c.addEventListener("dragover",q(this,this.handleDragEvent),!0);c.addEventListener("drop",q(this,this.handleDragEvent),!0);c.addEventListener("touchstart",q(this,this.handleTouchEvent),
!0);c.addEventListener("touchmove",q(this,this.handleTouchEvent),!0);c.addEventListener("touchend",q(this,this.handleTouchEvent),!0);c.addEventListener("touchcancel",q(this,this.handleTouchEvent),!0);c.addEventListener("gamepadconnected",q(this,this.handleGamepadEvent),!0);c.addEventListener("gamepaddisconnected",q(this,this.handleGamepadEvent),!0)}this.createContext();"webgl"==a.context.type&&(this.canvas.addEventListener("webglcontextlost",q(this,this.handleContextEvent),!1),this.canvas.addEventListener("webglcontextrestored",
q(this,this.handleContextEvent),!1))};n["lime._internal.backend.html5.HTML5Window"]=$c;$c.__name__=!0;$c.prototype={close:function(){this.parent.application.__removeWindow(this.parent)},createContext:function(){var a=new ne,b=this.parent.__attributes.context;a.window=this.parent;a.attributes=b;if(null!=this.div)a.dom=this.div,a.type="dom",a.version="";else if(null!=this.canvas){var c=null,e="canvas"==this.renderType,f="opengl"==this.renderType||"opengles"==this.renderType||"webgl"==this.renderType,
h=!Object.prototype.hasOwnProperty.call(b,"version")||"1"!=b.version,d=!1;if(f||!e&&(!Object.prototype.hasOwnProperty.call(b,"hardware")||b.hardware)){e=Object.prototype.hasOwnProperty.call(b,"background")&&null==b.background;f=Object.prototype.hasOwnProperty.call(b,"colorDepth")?b.colorDepth:16;var l=Object.prototype.hasOwnProperty.call(b,"antialiasing")&&0<b.antialiasing,g=Object.prototype.hasOwnProperty.call(b,"depth")?b.depth:!0;b=Object.prototype.hasOwnProperty.call(b,"stencil")&&b.stencil;b=
{alpha:e||16<f,antialias:l,depth:g,premultipliedAlpha:!0,stencil:b,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1};e=["webgl","experimental-webgl"];h&&e.unshift("webgl2");for(h=0;h<e.length&&(f=e[h],++h,c=this.canvas.getContext(f,b),null!=c&&"webgl2"==f&&(d=!0),null==c););}null==c?(a.canvas2D=this.canvas.getContext("2d"),a.type="canvas",a.version=""):(a.webgl=df.fromWebGL2RenderContext(c),d&&(a.webgl2=c),null==ad.context&&(ad.context=c,ad.type="webgl",ad.version=d?2:1),a.type="webgl",a.version=
d?"2":"1")}this.parent.context=a},handleContextEvent:function(a){switch(a.type){case "webglcontextlost":a.cancelable&&a.preventDefault();this.parent.context=null;this.parent.onRenderContextLost.dispatch();break;case "webglcontextrestored":this.createContext(),this.parent.onRenderContextRestored.dispatch(this.parent.context)}},handleContextMenuEvent:function(a){(this.parent.onMouseUp.canceled||this.parent.onMouseDown.canceled)&&a.cancelable&&a.preventDefault()},handleDragEvent:function(a){switch(a.type){case "dragover":return a.preventDefault(),
!1;case "dragstart":if("img"==ja.__cast(a.target,HTMLElement).nodeName.toLowerCase()&&a.cancelable)return a.preventDefault(),!1;break;case "drop":if(null!=a.dataTransfer&&0<a.dataTransfer.files.length)return this.parent.onDropFile.dispatch(a.dataTransfer.files),a.preventDefault(),!1}return!0},handleGamepadEvent:function(a){switch(a.type){case "gamepadconnected":fb.__connect(a.gamepad.index);"standard"==a.gamepad.mapping&&Pa.__connect(a.gamepad.index);break;case "gamepaddisconnected":fb.__disconnect(a.gamepad.index),
Pa.__disconnect(a.gamepad.index)}},handleMouseEvent:function(a){if("wheel"!=a.type){if(null!=this.parent.element)if(null!=this.canvas){var b=this.canvas.getBoundingClientRect();var c=this.parent.__width/b.width*(a.clientX-b.left);b=this.parent.__height/b.height*(a.clientY-b.top)}else null!=this.div?(b=this.div.getBoundingClientRect(),c=a.clientX-b.left,b=a.clientY-b.top):(b=this.parent.element.getBoundingClientRect(),c=this.parent.__width/b.width*(a.clientX-b.left),b=this.parent.__height/b.height*
(a.clientY-b.top));else c=a.clientX,b=a.clientY;switch(a.type){case "mousedown":a.currentTarget==this.parent.element&&window.addEventListener("mouseup",q(this,this.handleMouseEvent));this.parent.onMouseDown.dispatch(c,b,a.button);this.parent.onMouseDown.canceled&&a.cancelable&&a.preventDefault();break;case "mouseenter":a.target==this.parent.element&&(this.parent.onEnter.dispatch(),this.parent.onEnter.canceled&&a.cancelable&&a.preventDefault());break;case "mouseleave":a.target==this.parent.element&&
(this.parent.onLeave.dispatch(),this.parent.onLeave.canceled&&a.cancelable&&a.preventDefault());break;case "mousemove":if(c!=this.cacheMouseX||b!=this.cacheMouseY)this.parent.onMouseMove.dispatch(c,b),this.parent.onMouseMoveRelative.dispatch(c-this.cacheMouseX,b-this.cacheMouseY),(this.parent.onMouseMove.canceled||this.parent.onMouseMoveRelative.canceled)&&a.cancelable&&a.preventDefault();break;case "mouseup":window.removeEventListener("mouseup",q(this,this.handleMouseEvent)),a.currentTarget==this.parent.element&&
a.stopPropagation(),this.parent.onMouseUp.dispatch(c,b,a.button),this.parent.onMouseUp.canceled&&a.cancelable&&a.preventDefault()}this.cacheMouseX=c;this.cacheMouseY=b}else{switch(a.deltaMode){case 0:c=Nc.PIXELS;break;case 1:c=Nc.LINES;break;case 2:c=Nc.PAGES;break;default:c=Nc.UNKNOWN}this.parent.onMouseWheel.dispatch(a.deltaX,-a.deltaY,c);this.parent.onMouseWheel.canceled&&a.cancelable&&a.preventDefault()}},handleResizeEvent:function(a){this.primaryTouch=null;this.updateSize()},handleTouchEvent:function(a){a.cancelable&&
a.preventDefault();var b=null;null!=this.parent.element&&(b=null!=this.canvas?this.canvas.getBoundingClientRect():null!=this.div?this.div.getBoundingClientRect():this.parent.element.getBoundingClientRect());var c=this.setWidth,e=this.setHeight;if(0==c||0==e)null!=b?(c=b.width,e=b.height):e=c=1;for(var f,h,d,l,g,m=0,x=a.changedTouches;m<x.length;){var r=x[m];++m;null!=b?(h=c/b.width*(r.clientX-b.left),d=e/b.height*(r.clientY-b.top)):(h=r.clientX,d=r.clientY);if("touchstart"==a.type)f=this.unusedTouchesPool.pop(),
null==f?f=new Eb(h/c,d/e,r.identifier,0,0,r.force,this.parent.id):(f.x=h/c,f.y=d/e,f.id=r.identifier,f.dx=0,f.dy=0,f.pressure=r.force,f.device=this.parent.id),this.currentTouches.h[r.identifier]=f,Eb.onStart.dispatch(f),null==this.primaryTouch&&(this.primaryTouch=f),f==this.primaryTouch&&this.parent.onMouseDown.dispatch(h,d,0);else if(f=this.currentTouches.h[r.identifier],null!=f)switch(l=f.x,g=f.y,f.x=h/c,f.y=d/e,f.dx=f.x-l,f.dy=f.y-g,f.pressure=r.force,a.type){case "touchcancel":Eb.onCancel.dispatch(f);
this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(f);f==this.primaryTouch&&(this.primaryTouch=null);break;case "touchend":Eb.onEnd.dispatch(f);this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(f);f==this.primaryTouch&&(this.parent.onMouseUp.dispatch(h,d,0),this.primaryTouch=null);break;case "touchmove":Eb.onMove.dispatch(f),f==this.primaryTouch&&this.parent.onMouseMove.dispatch(h,d)}}},updateSize:function(){if(this.parent.__resizable){if(null!=this.parent.element){var a=
this.parent.element.clientWidth;var b=this.parent.element.clientHeight}else a=window.innerWidth,b=window.innerHeight;if(a!=this.cacheElementWidth||b!=this.cacheElementHeight){this.cacheElementWidth=a;this.cacheElementHeight=b;var c=this.resizeElement||0==this.setWidth&&0==this.setHeight;if(null!=this.parent.element&&(null==this.div||null!=this.div&&c))if(c){if(this.parent.__width!=a||this.parent.__height!=b)this.parent.__width=a,this.parent.__height=b,null!=this.canvas?this.parent.element!=this.canvas&&
(this.canvas.width=Math.round(a*this.scale),this.canvas.height=Math.round(b*this.scale),this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"):(this.div.style.width=a+"px",this.div.style.height=b+"px"),this.parent.onResize.dispatch(a,b)}else{c=0!=this.setWidth?a/this.setWidth:1;var e=0!=this.setHeight?b/this.setHeight:1,f=a,h=b,d=0,l=0;c<e?(h=Math.floor(this.setHeight*c),l=Math.floor((b-h)/2)):(f=Math.floor(this.setWidth*e),d=Math.floor((a-f)/2));null!=this.canvas?this.parent.element!=this.canvas&&
(this.canvas.style.width=f+"px",this.canvas.style.height=h+"px",this.canvas.style.marginLeft=d+"px",this.canvas.style.marginTop=l+"px"):(this.div.style.width=f+"px",this.div.style.height=h+"px",this.div.style.marginLeft=d+"px",this.div.style.marginTop=l+"px")}}}},__class__:$c};var lc=function(){};n["lime._internal.format.Base64"]=lc;lc.__name__=!0;lc.encode=function(a){var b=[],c=lc.DICTIONARY,e=lc.EXTENDED_DICTIONARY,f=a.length,h=Math.floor(f/3),d=2*h;b.length=2*Math.ceil(f/3);for(var l=0,g=0,m;g<
d;)m=a.b[l]<<16|a.b[l+1]<<8|a.b[l+2],b[g]=e[m>>12&4095],b[g+1]=e[m&4095],l+=3,g+=2;switch(f-3*h){case 1:m=a.b[l]<<16;b[g]=e[m>>12&4095];b[g+1]="==";break;case 2:m=a.b[l]<<16|a.b[l+1]<<8,b[g]=e[m>>12&4095],b[g+1]=c[m>>6&63]+"="}return b.join("")};var Me=function(){};n["lime._internal.format.Deflate"]=Me;Me.__name__=!0;Me.decompress=function(a){a=pako.inflateRaw(a.b.bufferValue);return La.ofData(a)};var Ne=function(){};n["lime._internal.format.GZip"]=Ne;Ne.__name__=!0;Ne.decompress=function(a){a=pako.ungzip(a.b.bufferValue);
return La.ofData(a)};var Oe=function(){};n["lime._internal.format.LZMA"]=Oe;Oe.__name__=!0;Oe.decompress=function(a){return null};var Pe=function(){};n["lime._internal.format.Zlib"]=Pe;Pe.__name__=!0;Pe.decompress=function(a){a=pako.inflate(a.b.bufferValue);return La.ofData(a)};var Hb=function(){};n["lime._internal.graphics.ImageCanvasUtil"]=Hb;Hb.__name__=!0;Hb.convertToCanvas=function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage?(null==c.__srcCanvas&&(Hb.createCanvas(a,c.__srcImage.width,
c.__srcImage.height),c.__srcContext.drawImage(c.__srcImage,0,0)),c.__srcImage=null):null==c.__srcCanvas&&null!=c.data?(a.set_transparent(!0),Hb.createCanvas(a,c.width,c.height),Hb.createImageData(a),c.__srcContext.putImageData(c.__srcImageData,0,0)):a.type==nc.DATA&&null!=c.__srcImageData&&a.dirty&&(c.__srcContext.putImageData(c.__srcImageData,0,0),a.dirty=!1);b?(c.data=null,c.__srcImageData=null):null==c.data&&null!=c.__srcImageData&&(c.data=c.__srcImageData.data);a.type=nc.CANVAS};Hb.convertToData=
function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage&&Hb.convertToCanvas(a);if(null!=c.__srcCanvas&&null==c.data)Hb.createImageData(a),a.type==nc.CANVAS&&(a.dirty=!1);else if(a.type==nc.CANVAS&&null!=c.__srcCanvas&&a.dirty){if(null==c.__srcImageData)Hb.createImageData(a);else{c.__srcImageData=c.__srcContext.getImageData(0,0,c.width,c.height);var e=c.__srcImageData.data.buffer;e=null!=e?new Uint8Array(e):null;c.data=e}a.dirty=!1}b&&(a.buffer.__srcCanvas=null,a.buffer.__srcContext=null);
a.type=nc.DATA};Hb.createCanvas=function(a,b,c){var e=a.buffer;null==e.__srcCanvas&&(e.__srcCanvas=window.document.createElement("canvas"),e.__srcCanvas.width=b,e.__srcCanvas.height=c,a.get_transparent()?e.__srcContext=e.__srcCanvas.getContext("2d"):(a.get_transparent()||e.__srcCanvas.setAttribute("moz-opaque","true"),e.__srcContext=e.__srcCanvas.getContext("2d",{alpha:!1})))};Hb.createImageData=function(a){a=a.buffer;if(null==a.__srcImageData){null==a.data?a.__srcImageData=a.__srcContext.getImageData(0,
0,a.width,a.height):(a.__srcImageData=a.__srcContext.createImageData(a.width,a.height),a.__srcImageData.data.set(a.data));var b=a.__srcImageData.data.buffer;b=null!=b?new Uint8Array(b):null;a.data=b}};Hb.fillRect=function(a,b,c,e){Hb.convertToCanvas(a);if(1==e){e=c>>16&255;var f=c>>8&255;var h=c&255;c=a.get_transparent()?c>>24&255:255}else e=c>>24&255,f=c>>16&255,h=c>>8&255,c=a.get_transparent()?c&255:255;0==b.x&&0==b.y&&b.width==a.width&&b.height==a.height&&a.get_transparent()&&0==c?a.buffer.__srcCanvas.width=
a.buffer.width:(255>c&&a.buffer.__srcContext.clearRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY),0<c&&(a.buffer.__srcContext.fillStyle="rgba("+e+", "+f+", "+h+", "+c/255+")",a.buffer.__srcContext.fillRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY)),a.dirty=!0,a.version++)};var Qe=function(){};n["lime._internal.graphics.ImageDataUtil"]=Qe;Qe.__name__=!0;Qe.fillRect=function(a,b,c,e){switch(e){case 1:c=(c>>>16&255)<<24|(c>>>8&255)<<16|(c&255)<<8|c>>>24&
255;break;case 2:c=(c>>>8&255)<<24|(c>>>16&255)<<16|(c>>>24&255)<<8|c&255}a.get_transparent()||(c=(c>>>24&255)<<24|(c>>>16&255)<<16|(c>>>8&255)<<8|255);var f=a.buffer.data;if(null!=f){e=a.buffer.format;var h=a.buffer.premultiplied;h&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Tb.a16=Tb.__alpha16[c&255],c=((c>>>24&255)*Tb.a16>>16&255)<<24|((c>>>16&255)*Tb.a16>>16&255)<<16|((c>>>8&255)*Tb.a16>>16&255)<<8|c&255));b=new oe(a,b);for(var d,l=0,g=b.height;l<g;){h=l++;d=b.byteOffset+b.stride*h;for(var m=0,x=
b.width;m<x;){h=m++;var r=d+4*h,p=e;h=!1;null==h&&(h=!1);null==p&&(p=0);h&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Tb.a16=Tb.__alpha16[c&255],c=((c>>>24&255)*Tb.a16>>16&255)<<24|((c>>>16&255)*Tb.a16>>16&255)<<16|((c>>>8&255)*Tb.a16>>16&255)<<8|c&255));switch(p){case 0:f[r]=c>>>24&255;f[r+1]=c>>>16&255;f[r+2]=c>>>8&255;f[r+3]=c&255;break;case 1:f[r]=c&255;f[r+1]=c>>>24&255;f[r+2]=c>>>16&255;f[r+3]=c>>>8&255;break;case 2:f[r]=c>>>8&255,f[r+1]=c>>>16&255,f[r+2]=c>>>24&255,f[r+3]=c&255}}}a.dirty=!0;a.version++}};
var oe=function(a,b){this.image=a;null==b?this.rect=a.get_rect():(0>b.x&&(b.x=0),0>b.y&&(b.y=0),b.x+b.width>a.width&&(b.width=a.width-b.x),b.y+b.height>a.height&&(b.height=a.height-b.y),0>b.width&&(b.width=0),0>b.height&&(b.height=0),this.rect=b);this.stride=a.buffer.get_stride();this.__update()};n["lime._internal.graphics._ImageDataUtil.ImageDataView"]=oe;oe.__name__=!0;oe.prototype={__update:function(){this.x=Math.ceil(this.rect.x);this.y=Math.ceil(this.rect.y);this.width=Math.floor(this.rect.width);
this.height=Math.floor(this.rect.height);this.byteOffset=this.stride*(this.y+this.image.offsetY)+4*(this.x+this.image.offsetX)},__class__:oe};var Ia=function(a,b){null==b&&(b=!1);if(null!=a)if(b)b=new vb,b.future=this,wb.queue({promise:b,work:a});else try{this.value=a(),this.isComplete=!0}catch(c){ma.lastError=c,this.error=A.caught(c).unwrap(),this.isError=!0}};n["lime.app.Future"]=Ia;Ia.__name__=!0;Ia.withValue=function(a){var b=new Ia;b.isComplete=!0;b.value=a;return b};Ia.prototype={onComplete:function(a){null!=
a&&(this.isComplete?a(this.value):this.isError||(null==this.__completeListeners&&(this.__completeListeners=[]),this.__completeListeners.push(a)));return this},onError:function(a){null!=a&&(this.isError?a(this.error):this.isComplete||(null==this.__errorListeners&&(this.__errorListeners=[]),this.__errorListeners.push(a)));return this},onProgress:function(a){null!=a&&(null==this.__progressListeners&&(this.__progressListeners=[]),this.__progressListeners.push(a));return this},then:function(a){if(this.isComplete)return a(this.value);
if(this.isError){var b=new Ia;b.isError=!0;b.error=this.error;return b}var c=new vb;this.onError(q(c,c.error));this.onProgress(q(c,c.progress));this.onComplete(function(b){b=a(b);b.onError(q(c,c.error));b.onComplete(q(c,c.complete))});return c.future},__class__:Ia};var wb=function(){};n["lime.app._Future.FutureWork"]=wb;wb.__name__=!0;wb.queue=function(a){null==wb.threadPool&&(wb.threadPool=new pe,wb.threadPool.doWork.add(wb.threadPool_doWork),wb.threadPool.onComplete.add(wb.threadPool_onComplete),
wb.threadPool.onError.add(wb.threadPool_onError));wb.threadPool.queue(a)};wb.threadPool_doWork=function(a){try{var b=a.work();wb.threadPool.sendComplete({promise:a.promise,result:b})}catch(c){ma.lastError=c,b=A.caught(c).unwrap(),wb.threadPool.sendError({promise:a.promise,error:b})}};wb.threadPool_onComplete=function(a){a.promise.complete(a.result)};wb.threadPool_onError=function(a){a.promise.error(a.error)};var vb=function(){this.future=new Ia};n["lime.app.Promise"]=vb;vb.__name__=!0;vb.prototype=
{complete:function(a){if(!this.future.isError&&(this.future.isComplete=!0,this.future.value=a,null!=this.future.__completeListeners)){for(var b=0,c=this.future.__completeListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__completeListeners=null}return this},completeWith:function(a){a.onComplete(q(this,this.complete));a.onError(q(this,this.error));a.onProgress(q(this,this.progress));return this},error:function(a){if(!this.future.isComplete&&(this.future.isError=!0,this.future.error=a,null!=this.future.__errorListeners)){for(var b=
0,c=this.future.__errorListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__errorListeners=null}return this},progress:function(a,b){if(!this.future.isError&&!this.future.isComplete&&null!=this.future.__progressListeners)for(var c=0,e=this.future.__progressListeners;c<e.length;){var f=e[c];++c;f(a,b)}return this},__class__:vb};var fc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Dynamic_Void"]=fc;fc.__name__=!0;fc.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:fc};var qe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Float_Float_Float_Void"]=qe;qe.__name__=!0;qe.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,
b,c){this.canceled=!1;for(var e=this.__listeners,f=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),f[h]?++h:this.remove(e[h]),!this.canceled););},__class__:qe};var re=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Float_Float_Int_Void"]=re;re.__name__=!0;re.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,
0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,f=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),f[h]?++h:this.remove(e[h]),!this.canceled););},__class__:re};var qd=function(){this.canceled=
!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Float_Float_Void"]=qd;qd.__name__=!0;qd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:qd};var se=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Float_Float_lime_ui_MouseButton_Void"]=se;se.__name__=!0;se.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=
0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,
f=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),f[h]?++h:this.remove(e[h]),!this.canceled););},__class__:se};var te=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Float_Float_lime_ui_MouseWheelMode_Void"]=te;te.__name__=!0;te.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,f=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),f[h]?++h:this.remove(e[h]),!this.canceled););},__class__:te};var ue=function(){this.canceled=!1;this.__listeners=
[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Int_Float_Float_Void"]=ue;ue.__name__=!0;ue.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:ue};var ve=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};n["lime.app._Event_Int_Float_Void"]=ve;ve.__name__=!0;ve.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:ve};var Vc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Int_Int_Void"]=Vc;Vc.__name__=!0;Vc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>
this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?
++f:this.remove(c[f]),!this.canceled););},__class__:Vc};var gc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Int_Void"]=gc;gc.__name__=!0;gc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},
remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:gc};var we=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Int_lime_ui_JoystickHatPosition_Void"]=
we;we.__name__=!0;we.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:we};var xe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_String_Int_Int_Void"]=xe;xe.__name__=
!0;xe.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:xe};var rd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_String_Void"]=rd;rd.__name__=!0;rd.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:rd};var Ta=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_Void_Void"]=Ta;Ta.__name__=!0;Ta.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(){this.canceled=!1;for(var a=this.__listeners,b=this.__repeat,c=0;c<a.length&&(a[c](),b[c]?++c:this.remove(a[c]),!this.canceled););},__class__:Ta};var sd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};n["lime.app._Event_lime_graphics_RenderContext_Void"]=sd;sd.__name__=!0;sd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:sd};var ye=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_lime_ui_GamepadAxis_Float_Void"]=ye;ye.__name__=!0;ye.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=
this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=
this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:ye};var Hd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_lime_ui_GamepadButton_Void"]=Hd;Hd.__name__=!0;Hd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);
return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Hd};var ze=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};n["lime.app._Event_lime_ui_Gamepad_Void"]=ze;ze.__name__=!0;ze.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:ze};var Ae=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_lime_ui_Joystick_Void"]=Ae;Ae.__name__=!0;Ae.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<
f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&
(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Ae};var td=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_lime_ui_KeyCode_lime_ui_KeyModifier_Void"]=td;td.__name__=!0;td.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:td};var mc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=
[]};n["lime.app._Event_lime_ui_Touch_Void"]=mc;mc.__name__=!0;mc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:mc};var Rd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};n["lime.app._Event_lime_ui_Window_Void"]=Rd;Rd.__name__=!0;Rd.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Rd};var Ga=function(a,b,c,e,f,h,d){null==f&&(f=-1);null==e&&(e=-1);null==c&&(c=0);null==b&&(b=0);this.offsetX=b;this.offsetY=c;this.width=e;this.height=f;this.version=0;null==d&&(d=nc.CANVAS);this.type=d;if(null==a){if(0<e&&0<f)switch(this.type._hx_index){case 0:this.buffer=new Cc(null,
e,f);Hb.createCanvas(this,e,f);null!=h&&0!=h&&this.fillRect(new ud(0,0,e,f),h);break;case 1:a=e*f*4,a=null!=a?new Uint8Array(a):null,this.buffer=new Cc(a,e,f),null!=h&&0!=h&&this.fillRect(new ud(0,0,e,f),h)}}else this.__fromImageBuffer(a)};n["lime.graphics.Image"]=Ga;Ga.__name__=!0;Ga.fromFile=function(a){if(null==a)return null;var b=new Ga;return b.__fromFile(a)?b:null};Ga.loadFromBytes=function(a){if(null==a)return Ia.withValue(null);if(Ga.__isPNG(a))var b="image/png";else if(Ga.__isJPG(a))b="image/jpeg";
else if(Ga.__isGIF(a))b="image/gif";else if(Ga.__isWebP(a))b="image/webp";else return Ia.withValue(null);return V.loadImageFromBytes(a,b)};Ga.loadFromFile=function(a){return null==a?Ia.withValue(null):V.loadImage(a)};Ga.__isGIF=function(a){if(null==a||6>a.length)return!1;a=a.getString(0,6);return"GIF87a"!=a?"GIF89a"==a:!0};Ga.__isJPG=function(a){return null==a||4>a.length?!1:255==a.b[0]&&216==a.b[1]&&255==a.b[a.length-2]?217==a.b[a.length-1]:!1};Ga.__isPNG=function(a){return null==a||8>a.length?!1:
137==a.b[0]&&80==a.b[1]&&78==a.b[2]&&71==a.b[3]&&13==a.b[4]&&10==a.b[5]&&26==a.b[6]?10==a.b[7]:!1};Ga.__isWebP=function(a){return null==a||16>a.length?!1:"RIFF"==a.getString(0,4)?"WEBP"==a.getString(8,4):!1};Ga.prototype={fillRect:function(a,b,c){a=this.__clipRect(a);if(null!=this.buffer&&null!=a)switch(this.type._hx_index){case 0:Hb.fillRect(this,a,b,c);break;case 1:Hb.convertToData(this);if(0==this.buffer.data.length)break;Qe.fillRect(this,a,b,c);break;case 2:a.offset(this.offsetX,this.offsetY);
if(null==c)b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255;else switch(c){case 1:break;case 2:b=(b&255)<<24|(b>>>8&255)<<16|(b>>>16&255)<<8|b>>>24&255;break;default:b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255}this.buffer.__srcBitmapData.fillRect(a.__toFlashRectangle(),b)}},__clipRect:function(a){return null==a||0>a.x&&(a.width-=-a.x,a.x=0,0>=a.x+a.width)||0>a.y&&(a.height-=-a.y,a.y=0,0>=a.y+a.height)||a.x+a.width>=this.width&&(a.width-=a.x+a.width-this.width,0>=a.width)||a.y+
a.height>=this.height&&(a.height-=a.y+a.height-this.height,0>=a.height)?null:a},__fromBase64:function(a,b,c){var e=this,f=new Image;f.addEventListener("load",function(a){e.buffer=new Cc(null,f.width,f.height);e.buffer.__srcImage=f;e.offsetX=0;e.offsetY=0;e.width=e.buffer.width;e.height=e.buffer.height;null!=c&&c(e)},!1);f.src="data:"+b+";base64,"+a},__fromBytes:function(a,b){if(Ga.__isPNG(a))var c="image/png";else if(Ga.__isJPG(a))c="image/jpeg";else if(Ga.__isGIF(a))c="image/gif";else return!1;this.__fromBase64(lc.encode(a),
c,b);return!0},__fromFile:function(a,b,c){var e=this,f=new Image;V.__isSameOrigin(a)||(f.crossOrigin="Anonymous");f.onload=function(a){e.buffer=new Cc(null,f.width,f.height);e.buffer.__srcImage=f;e.width=f.width;e.height=f.height;null!=b&&b(e)};f.onerror=function(a){null!=c&&c()};f.src=a;return!0},__fromImageBuffer:function(a){this.buffer=a;null!=a&&(-1==this.width&&(this.width=a.width),-1==this.height&&(this.height=a.height))},get_data:function(){null==this.buffer.data&&0<this.buffer.width&&0<this.buffer.height&&
Hb.convertToData(this);return this.buffer.data},get_rect:function(){return new ud(0,0,this.width,this.height)},get_transparent:function(){return null==this.buffer?!1:this.buffer.transparent},set_transparent:function(a){return null==this.buffer?!1:this.buffer.transparent=a},__class__:Ga,__properties__:{set_transparent:"set_transparent",get_transparent:"get_transparent",get_rect:"get_rect",get_data:"get_data"}};var Cc=function(a,b,c,e,f){null==e&&(e=32);null==c&&(c=0);null==b&&(b=0);this.data=a;this.width=
b;this.height=c;this.bitsPerPixel=e;this.format=null==f?0:f;this.premultiplied=!1;this.transparent=!0};n["lime.graphics.ImageBuffer"]=Cc;Cc.__name__=!0;Cc.prototype={get_stride:function(){return this.width*(this.bitsPerPixel/8|0)},__class__:Cc,__properties__:{get_stride:"get_stride"}};var nc=p["lime.graphics.ImageType"]={__ename__:!0,__constructs__:null,CANVAS:{_hx_name:"CANVAS",_hx_index:0,__enum__:"lime.graphics.ImageType",toString:d},DATA:{_hx_name:"DATA",_hx_index:1,__enum__:"lime.graphics.ImageType",
toString:d},FLASH:{_hx_name:"FLASH",_hx_index:2,__enum__:"lime.graphics.ImageType",toString:d},CUSTOM:{_hx_name:"CUSTOM",_hx_index:3,__enum__:"lime.graphics.ImageType",toString:d}};nc.__constructs__=[nc.CANVAS,nc.DATA,nc.FLASH,nc.CUSTOM];var ne=function(){};n["lime.graphics.RenderContext"]=ne;ne.__name__=!0;ne.prototype={__class__:ne};var df={fromWebGL2RenderContext:function(a){return a}},ad=function(){};n["lime.graphics.opengl.GL"]=ad;ad.__name__=!0;var Tb={},ud=function(a,b,c,e){null==e&&(e=0);
null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.width=c;this.height=e};n["lime.math.Rectangle"]=ud;ud.__name__=!0;ud.prototype={offset:function(a,b){this.x+=a;this.y+=b},__toFlashRectangle:function(){return null},__class__:ud};var eb=function(){};n["lime.media.AudioBuffer"]=eb;eb.__name__=!0;eb.fromBytes=function(a){if(null==a)return null;var b=new eb;b.set_src(new Howl({src:["data:"+eb.__getCodec(a)+";base64,"+lc.encode(a)],html5:!0,preload:!1}));return b};eb.fromFile=function(a){if(null==
a)return null;var b=new eb;b.__srcHowl=new Howl({src:[a],preload:!1});return b};eb.fromFiles=function(a){var b=new eb;b.__srcHowl=new Howl({src:a,preload:!1});return b};eb.loadFromFile=function(a){var b=new vb,c=eb.fromFile(a);null!=c?null!=c&&(c.__srcHowl.on("load",function(){b.complete(c)}),c.__srcHowl.on("loaderror",function(a,c){b.error(c)}),c.__srcHowl.load()):b.error(null);return b.future};eb.loadFromFiles=function(a){var b=new vb,c=eb.fromFiles(a);null!=c?(c.__srcHowl.on("load",function(){b.complete(c)}),
c.__srcHowl.on("loaderror",function(){b.error(null)}),c.__srcHowl.load()):b.error(null);return b.future};eb.__getCodec=function(a){switch(a.getString(0,4)){case "OggS":return"audio/ogg";case "RIFF":if("WAVE"==a.getString(8,4))return"audio/wav";var b=a.b[1],c=a.b[2];switch(a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}break;case "fLaC":return"audio/flac";default:switch(b=a.b[1],c=a.b[2],a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";
break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}}za.error("Unsupported sound format",{fileName:"lime/media/AudioBuffer.hx",lineNumber:362,className:"lime.media.AudioBuffer",methodName:"__getCodec"});return null};eb.prototype={set_src:function(a){return this.__srcHowl=a},__class__:eb,__properties__:{set_src:"set_src"}};var Ce=function(a){if("custom"!=a){if(null==a||"web"==a)try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.web=new window.AudioContext,
this.type="web"}catch(b){ma.lastError=b}null==this.web&&"web"!=a&&(this.html5=new Be,this.type="html5")}else this.type="custom"};n["lime.media.AudioContext"]=Ce;Ce.__name__=!0;Ce.prototype={__class__:Ce};var Fc=function(){};n["lime.media.AudioManager"]=Fc;Fc.__name__=!0;Fc.init=function(a){if(null==Fc.context){if(null==a&&(Fc.context=new Ce,a=Fc.context,"openal"==a.type)){var b=a.openal,c=b.openDevice();c=b.createContext(c);b.makeContextCurrent(c);b.processContext(c)}Fc.context=a}};var Be=function(){};
n["lime.media.HTML5AudioContext"]=Be;Be.__name__=!0;Be.prototype={__class__:Be};var Re=function(){};n["lime.media.OpenALAudioContext"]=Re;Re.__name__=!0;Re.prototype={createContext:function(a,b){return yc.createContext(a,b)},makeContextCurrent:function(a){return yc.makeContextCurrent(a)},openDevice:function(a){return yc.openDevice(a)},processContext:function(a){yc.processContext(a)},__class__:Re};var yc=function(){};n["lime.media.openal.ALC"]=yc;yc.__name__=!0;yc.createContext=function(a,b){return null};
yc.makeContextCurrent=function(a){return!1};yc.openDevice=function(a){return null};yc.processContext=function(a){};var Tc=function(){};n["lime.net._IHTTPRequest"]=Tc;Tc.__name__=!0;Tc.__isInterface__=!0;Tc.prototype={__class__:Tc};var Nb=function(a){this.uri=a;this.contentType="application/x-www-form-urlencoded";this.followRedirects=!0;this.enableResponseHeaders=!1;this.formData=new W;this.headers=[];this.method="GET";this.timeout=3E4;this.withCredentials=!1;this.__backend=new V;this.__backend.init(this)};
n["lime.net._HTTPRequest.AbstractHTTPRequest"]=Nb;Nb.__name__=!0;Nb.__interfaces__=[Tc];Nb.prototype={__class__:Nb};var vd=function(a){Nb.call(this,a)};n["lime.net._HTTPRequest_Bytes"]=vd;vd.__name__=!0;vd.__super__=Nb;vd.prototype=F(Nb.prototype,{fromBytes:function(a){return a},load:function(a){var b=this;null!=a&&(this.uri=a);var c=new vb;a=this.__backend.loadData(this.uri);a.onProgress(q(c,c.progress));a.onError(q(c,c.error));a.onComplete(function(a){b.responseData=b.fromBytes(a);c.complete(b.responseData)});
return c.future},__class__:vd});var Id=function(a){Nb.call(this,a)};n["lime.net._HTTPRequest_String"]=Id;Id.__name__=!0;Id.__super__=Nb;Id.prototype=F(Nb.prototype,{load:function(a){var b=this;null!=a&&(this.uri=a);var c=new vb;a=this.__backend.loadText(this.uri);a.onProgress(q(c,c.progress));a.onError(q(c,c.error));a.onComplete(function(a){b.responseData=a;c.complete(b.responseData)});return c.future},__class__:Id});var me=function(a,b){null==b&&(b="");this.name=a;this.value=b};n["lime.net.HTTPRequestHeader"]=
me;me.__name__=!0;me.prototype={__class__:me};var Jd=function(a){Nb.call(this,a)};n["lime.net._HTTPRequest_lime_utils_Bytes"]=Jd;Jd.__name__=!0;Jd.__super__=vd;Jd.prototype=F(vd.prototype,{fromBytes:function(a){return oc.fromBytes(a)},__class__:Jd});var kc=function(a,b){this.onUpdate=new qe;this.type=a;this.id=b};n["lime.system.Sensor"]=kc;kc.__name__=!0;kc.registerSensor=function(a,b){a=new kc(a,b);kc.sensors.push(a);return kc.sensorByID.h[b]=a};kc.prototype={__class__:kc};var Te=p["lime.system.SensorType"]=
{__ename__:!0,__constructs__:null,ACCELEROMETER:{_hx_name:"ACCELEROMETER",_hx_index:0,__enum__:"lime.system.SensorType",toString:d}};Te.__constructs__=[Te.ACCELEROMETER];var Vb=function(){};n["lime.system.System"]=Vb;Vb.__name__=!0;Vb.embed=k.lime.embed=function(a,b,c,e,f){if(null!=Vb.__applicationEntryPoint&&Object.prototype.hasOwnProperty.call(Vb.__applicationEntryPoint.h,a)){var h="string"==typeof b?window.document.getElementById(b):null==b?window.document.createElement("div"):b;null==h?window.console.log("[lime.embed] ERROR: Cannot find target element: "+
m.string(b)):(null==c&&(c=0),null==e&&(e=0),null==f&&(f={}),Object.prototype.hasOwnProperty.call(f,"background")&&"string"==typeof f.background&&(b=ha.replace(m.string(f.background),"#",""),-1<b.indexOf("0x")?f.background=m.parseInt(b):f.background=m.parseInt("0x"+b)),f.element=h,f.width=c,f.height=e,Vb.__applicationEntryPoint.h[a](f))}};Vb.exit=function(a){};Vb.__registerEntryPoint=function(a,b){null==Vb.__applicationEntryPoint&&(Vb.__applicationEntryPoint=new W);Vb.__applicationEntryPoint.h[a]=
b};var pe=function(a,b){null==b&&(b=1);null==a&&(a=0);this.onRun=new fc;this.onError=new fc;this.onComplete=new fc;this.doWork=new fc;this.minThreads=a;this.maxThreads=b;this.currentThreads=0};n["lime.system.ThreadPool"]=pe;pe.__name__=!0;pe.prototype={queue:function(a){this.runWork(a)},sendComplete:function(a){this.onComplete.dispatch(a)},sendError:function(a){this.onError.dispatch(a)},runWork:function(a){this.onRun.dispatch(a);this.doWork.dispatch(a)},__class__:pe};var pb=function(a){null!=a&&(this.name=
a);this.__init||(void 0==this.ascender&&(this.ascender=0),void 0==this.descender&&(this.descender=0),void 0==this.height&&(this.height=0),void 0==this.numGlyphs&&(this.numGlyphs=0),void 0==this.underlinePosition&&(this.underlinePosition=0),void 0==this.underlineThickness&&(this.underlineThickness=0),void 0==this.unitsPerEM&&(this.unitsPerEM=0),null!=this.__fontID?aa.isLocal(this.__fontID)&&this.__fromBytes(aa.getBytes(this.__fontID)):null!=this.__fontPath&&this.__fromFile(this.__fontPath))};n["lime.text.Font"]=
pb;pb.__name__=!0;pb.fromFile=function(a){if(null==a)return null;var b=new pb;b.__fromFile(a);return b};pb.loadFromName=function(a){return(new pb).__loadFromName(a)};pb.__measureFontNode=function(a){var b=window.document.createElement("span");b.setAttribute("aria-hidden","true");var c=window.document.createTextNode("BESbswy");b.appendChild(c);c=b.style;c.display="block";c.position="absolute";c.top="-9999px";c.left="-9999px";c.fontSize="300px";c.width="auto";c.height="auto";c.lineHeight="normal";c.margin=
"0";c.padding="0";c.fontVariant="normal";c.whiteSpace="nowrap";c.fontFamily=a;window.document.body.appendChild(b);return b};pb.prototype={__fromBytes:function(a){this.__fontPath=null},__fromFile:function(a){this.__fontPath=a},__loadFromName:function(a){var b=this,c=new vb;this.name=a;var e=u.navigator.userAgent.toLowerCase(),f=0<=e.indexOf(" safari/")&&0>e.indexOf(" chrome/");e=(new z("(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)","i")).match(e);if(!f&&!e&&window.document.fonts&&(g=window.document.fonts,
q(g,g.load)))window.document.fonts.load("1em '"+a+"'").then(function(a){c.complete(b)},function(e){za.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",lineNumber:513,className:"lime.text.Font",methodName:"__loadFromName"});c.complete(b)});else{var h=pb.__measureFontNode("'"+a+"', sans-serif"),d=pb.__measureFontNode("'"+a+"', serif"),l=h.offsetWidth,m=d.offsetWidth,x=-1,p=0,r,B;x=window.setInterval(function(){p+=1;r=h.offsetWidth!=l||d.offsetWidth!=m;B=3E3<=50*p;if(r||B)window.clearInterval(x),
h.parentNode.removeChild(h),d.parentNode.removeChild(d),d=h=null,B&&za.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",lineNumber:548,className:"lime.text.Font",methodName:"__loadFromName"}),c.complete(b)},50)}return c.future},__class__:pb};var Pa=function(a){this.onDisconnect=new Ta;this.onButtonUp=new Hd;this.onButtonDown=new Hd;this.onAxisMove=new ye;this.id=a;this.connected=!0};n["lime.ui.Gamepad"]=Pa;Pa.__name__=!0;Pa.__connect=function(a){if(!Pa.devices.h.hasOwnProperty(a)){var b=
new Pa(a);Pa.devices.h[a]=b;Pa.onConnect.dispatch(b)}};Pa.__disconnect=function(a){var b=Pa.devices.h[a];null!=b&&(b.connected=!1);Pa.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};Pa.prototype={__class__:Pa};var fb=function(a){this.onTrackballMove=new ue;this.onHatMove=new we;this.onDisconnect=new Ta;this.onButtonUp=new gc;this.onButtonDown=new gc;this.onAxisMove=new ve;this.id=a;this.connected=!0};n["lime.ui.Joystick"]=fb;fb.__name__=!0;fb.__connect=function(a){if(!fb.devices.h.hasOwnProperty(a)){var b=
new fb(a);fb.devices.h[a]=b;fb.onConnect.dispatch(b)}};fb.__disconnect=function(a){var b=fb.devices.h[a];null!=b&&(b.connected=!1);fb.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};fb.__getDeviceData=function(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():null};fb.prototype={__class__:fb};var Sb=p["lime.ui.MouseCursor"]={__ename__:!0,__constructs__:null,ARROW:{_hx_name:"ARROW",_hx_index:0,__enum__:"lime.ui.MouseCursor",toString:d},
CROSSHAIR:{_hx_name:"CROSSHAIR",_hx_index:1,__enum__:"lime.ui.MouseCursor",toString:d},DEFAULT:{_hx_name:"DEFAULT",_hx_index:2,__enum__:"lime.ui.MouseCursor",toString:d},MOVE:{_hx_name:"MOVE",_hx_index:3,__enum__:"lime.ui.MouseCursor",toString:d},POINTER:{_hx_name:"POINTER",_hx_index:4,__enum__:"lime.ui.MouseCursor",toString:d},RESIZE_NESW:{_hx_name:"RESIZE_NESW",_hx_index:5,__enum__:"lime.ui.MouseCursor",toString:d},RESIZE_NS:{_hx_name:"RESIZE_NS",_hx_index:6,__enum__:"lime.ui.MouseCursor",toString:d},
RESIZE_NWSE:{_hx_name:"RESIZE_NWSE",_hx_index:7,__enum__:"lime.ui.MouseCursor",toString:d},RESIZE_WE:{_hx_name:"RESIZE_WE",_hx_index:8,__enum__:"lime.ui.MouseCursor",toString:d},TEXT:{_hx_name:"TEXT",_hx_index:9,__enum__:"lime.ui.MouseCursor",toString:d},WAIT:{_hx_name:"WAIT",_hx_index:10,__enum__:"lime.ui.MouseCursor",toString:d},WAIT_ARROW:{_hx_name:"WAIT_ARROW",_hx_index:11,__enum__:"lime.ui.MouseCursor",toString:d},CUSTOM:{_hx_name:"CUSTOM",_hx_index:12,__enum__:"lime.ui.MouseCursor",toString:d}};
Sb.__constructs__=[Sb.ARROW,Sb.CROSSHAIR,Sb.DEFAULT,Sb.MOVE,Sb.POINTER,Sb.RESIZE_NESW,Sb.RESIZE_NS,Sb.RESIZE_NWSE,Sb.RESIZE_WE,Sb.TEXT,Sb.WAIT,Sb.WAIT_ARROW,Sb.CUSTOM];var Nc=p["lime.ui.MouseWheelMode"]={__ename__:!0,__constructs__:null,PIXELS:{_hx_name:"PIXELS",_hx_index:0,__enum__:"lime.ui.MouseWheelMode",toString:d},LINES:{_hx_name:"LINES",_hx_index:1,__enum__:"lime.ui.MouseWheelMode",toString:d},PAGES:{_hx_name:"PAGES",_hx_index:2,__enum__:"lime.ui.MouseWheelMode",toString:d},UNKNOWN:{_hx_name:"UNKNOWN",
_hx_index:3,__enum__:"lime.ui.MouseWheelMode",toString:d}};Nc.__constructs__=[Nc.PIXELS,Nc.LINES,Nc.PAGES,Nc.UNKNOWN];var Eb=function(a,b,c,e,f,h,d){this.x=a;this.y=b;this.id=c;this.dx=e;this.dy=f;this.pressure=h;this.device=d};n["lime.ui.Touch"]=Eb;Eb.__name__=!0;Eb.prototype={__class__:Eb};var Td=function(a,b){this.onTextInput=new rd;this.onTextEdit=new xe;this.onRestore=new Ta;this.onResize=new Vc;this.onRenderContextRestored=new sd;this.onRenderContextLost=new Ta;this.onRender=new sd;this.onMove=
new qd;this.onMouseWheel=new te;this.onMouseUp=new re;this.onMouseMoveRelative=new qd;this.onMouseMove=new qd;this.onMouseDown=new se;this.onMinimize=new Ta;this.onLeave=new Ta;this.onKeyUp=new td;this.onKeyDown=new td;this.onFullscreen=new Ta;this.onFocusOut=new Ta;this.onFocusIn=new Ta;this.onExpose=new Ta;this.onEnter=new Ta;this.onDropFile=new rd;this.onDeactivate=new Ta;this.onClose=new Ta;this.onActivate=new Ta;this.application=a;this.__attributes=null!=b?b:{};Object.prototype.hasOwnProperty.call(this.__attributes,
"parameters")&&(this.parameters=this.__attributes.parameters);this.__height=this.__width=0;this.__fullscreen=!1;this.__scale=1;this.__y=this.__x=0;this.__title="";this.id=-1;this.__backend=new $c(this)};n["lime.ui.Window"]=Td;Td.__name__=!0;Td.prototype={close:function(){this.__backend.close()},__class__:Td};var Ob=function(){this.data=new W;this.paths=[]};n["lime.utils.AssetBundle"]=Ob;Ob.__name__=!0;Ob.fromBytes=function(a){a=new od(a);return Ob.__extractBundle(a)};Ob.loadFromBytes=function(a){return Ia.withValue(Ob.fromBytes(a))};
Ob.loadFromFile=function(a){return oc.loadFromFile(a).then(Ob.loadFromBytes)};Ob.__extractBundle=function(a){var b=pd.readZip(a);a=new Ob;for(b=b.h;null!=b;){var c=b.item;b=b.next;if(c.compressed){var e=a.data,f=c.fileName,h=oc.decompress(c.data,bd.DEFLATE);e.h[f]=h}else a.data.h[c.fileName]=c.data;a.paths.push(c.fileName)}return a};Ob.prototype={__class__:Ob};var De=function(){this.enabled=!0;this.audio=new W;this.font=new W;this.image=new W;this.version=540319};n["lime.utils.AssetCache"]=De;De.__name__=
!0;De.prototype={exists:function(a,b){return("IMAGE"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.image.h,a)||("FONT"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.font.h,a)||("SOUND"==b||"MUSIC"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.audio.h,a)?!0:!1},set:function(a,b,c){switch(b){case "FONT":this.font.h[a]=c;break;case "IMAGE":if(!(c instanceof Ga))throw A.thrown("Cannot cache non-Image asset: "+m.string(c)+" as Image");this.image.h[a]=c;break;case "MUSIC":case "SOUND":if(!(c instanceof
eb))throw A.thrown("Cannot cache non-AudioBuffer asset: "+m.string(c)+" as AudioBuffer");this.audio.h[a]=c;break;default:throw A.thrown(b+" assets are not cachable");}},clear:function(a){if(null==a)this.audio=new W,this.font=new W,this.image=new W;else{var b=this.audio.h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var f=b[e++];if(ha.startsWith(f,a)){var h=this.audio;Object.prototype.hasOwnProperty.call(h.h,f)&&delete h.h[f]}}b=this.font.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)f=b[e++],ha.startsWith(f,
a)&&(h=this.font,Object.prototype.hasOwnProperty.call(h.h,f)&&delete h.h[f]);b=this.image.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)f=b[e++],ha.startsWith(f,a)&&(h=this.image,Object.prototype.hasOwnProperty.call(h.h,f)&&delete h.h[f])}},__class__:De};var hc=function(){this.types=new W;this.sizes=new W;this.preload=new W;this.paths=new W;this.pathGroups=new W;this.classTypes=new W;this.cachedText=new W;this.cachedImages=new W;this.cachedFonts=new W;this.cachedBytes=new W;this.cachedAudioBuffers=new W;
this.onChange=new Ta;this.bytesTotal=this.bytesLoaded=0};n["lime.utils.AssetLibrary"]=hc;hc.__name__=!0;hc.fromBundle=function(a){if(Object.prototype.hasOwnProperty.call(a.data.h,"library.json")){var b=nb.fromBytes(a.data.h["library.json"]);if(null!=b){if(null==b.libraryType)var c=new hc;else if(c=n[b.libraryType],null!=c)c=ia.createInstance(c,b.libraryArgs);else return za.warn("Could not find library type: "+b.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:122,className:"lime.utils.AssetLibrary",
methodName:"fromBundle"}),null;c.__fromBundle(a,b);return c}}else return c=new hc,c.__fromBundle(a),c;return null};hc.fromManifest=function(a){if(null==a)return null;if(null==a.libraryType)var b=new hc;else if(b=n[a.libraryType],null!=b)b=ia.createInstance(b,a.libraryArgs);else return za.warn("Could not find library type: "+a.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:160,className:"lime.utils.AssetLibrary",methodName:"fromManifest"}),null;b.__fromManifest(a);return b};hc.prototype=
{exists:function(a,b){b=null!=b?ja.__cast(b,String):null;a=this.types.h[a];return null==a||a!=b&&("SOUND"!=b&&"MUSIC"!=b||"MUSIC"!=a&&"SOUND"!=a)&&"BINARY"!=b&&null!=b&&("BINARY"!=a||"TEXT"!=b)?!1:!0},getAsset:function(a,b){switch(b){case "BINARY":return this.getBytes(a);case "FONT":return this.getFont(a);case "IMAGE":return this.getImage(a);case "MUSIC":case "SOUND":return this.getAudioBuffer(a);case "TEMPLATE":throw A.thrown("Not sure how to get template: "+a);case "TEXT":return this.getText(a);
default:throw A.thrown("Unknown asset type: "+b);}},getAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?this.cachedAudioBuffers.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?eb.fromBytes(ja.__cast(ia.createInstance(this.classTypes.h[a],[]),La)):eb.fromFile(this.paths.h[a])},getBytes:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a))return this.cachedBytes.h[a];if(Object.prototype.hasOwnProperty.call(this.cachedText.h,
a)){var b=oc.ofString(this.cachedText.h[a]);return this.cachedBytes.h[a]=b}return Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?ja.__cast(ia.createInstance(this.classTypes.h[a],[]),La):oc.fromFile(this.paths.h[a])},getFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?this.cachedFonts.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?ja.__cast(ia.createInstance(this.classTypes.h[a],[]),pb):pb.fromFile(this.paths.h[a])},getImage:function(a){return Object.prototype.hasOwnProperty.call(this.cachedImages.h,
a)?this.cachedImages.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?ja.__cast(ia.createInstance(this.classTypes.h[a],[]),Ga):Ga.fromFile(this.paths.h[a])},getText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return this.cachedText.h[a];a=this.getBytes(a);return null==a?null:a.getString(0,a.length)},isLocal:function(a,b){if(Object.prototype.hasOwnProperty.call(this.classTypes.h,a))return!0;b=null!=b?ja.__cast(b,String):null;if(null==b)return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,
a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a);switch(b){case "FONT":return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a);case "IMAGE":return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a);case "MUSIC":case "SOUND":return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a);default:return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a)}},load:function(){if(this.loaded)return Ia.withValue(this);
if(null==this.promise){this.promise=new vb;this.bytesLoadedCache=new W;this.assetsLoaded=0;this.assetsTotal=1;for(var a=Object.keys(this.preload.h),b=a.length,c=0;c<b;){var e=a[c++];if(this.preload.h[e]){za.verbose("Preloading asset: "+e+" ["+this.types.h[e]+"]",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:405,className:"lime.utils.AssetLibrary",methodName:"load"});var f=this.types.h[e];if(null!=f)switch(f){case "BINARY":this.assetsTotal++;f=this.loadBytes(e);f.onProgress(function(a,b){return function(c,
e){b[0](a[0],c,e)}}([e],[q(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[q(this,this.load_onError)]));f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[q(this,this.loadBytes_onComplete)]));break;case "FONT":this.assetsTotal++;f=this.loadFont(e);f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[q(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[q(this,this.load_onError)]));
f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[q(this,this.loadFont_onComplete)]));break;case "IMAGE":this.assetsTotal++;f=this.loadImage(e);f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[q(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[q(this,this.load_onError)]));f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[q(this,this.loadImage_onComplete)]));break;case "MUSIC":case "SOUND":this.assetsTotal++;
f=this.loadAudioBuffer(e);f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[q(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[q(this,this.loadAudioBuffer_onError)]));f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[q(this,this.loadAudioBuffer_onComplete)]));break;case "TEXT":this.assetsTotal++,f=this.loadText(e),f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[q(this,this.load_onProgress)])),f.onError(function(a,
b){return function(c){b[0](a[0],c)}}([e],[q(this,this.load_onError)])),f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[q(this,this.loadText_onComplete)]))}}}this.__assetLoaded(null)}return this.promise.future},loadAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?Ia.withValue(this.cachedAudioBuffers.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ia.withValue(ia.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.pathGroups.h,
a)?eb.loadFromFiles(this.pathGroups.h[a]):eb.loadFromFile(this.paths.h[a])},loadBytes:function(a){return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ia.withValue(this.cachedBytes.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ia.withValue(ia.createInstance(this.classTypes.h[a],[])):oc.loadFromFile(this.paths.h[a])},loadFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?Ia.withValue(this.cachedFonts.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,
a)?(a=ia.createInstance(this.classTypes.h[a],[]),a.__loadFromName(a.name)):pb.loadFromName(this.paths.h[a])},loadImage:function(a){var b=this;return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a)?Ia.withValue(this.cachedImages.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ia.withValue(ia.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ga.loadFromBytes(this.cachedBytes.h[a]).then(function(c){var e=b.cachedBytes;Object.prototype.hasOwnProperty.call(e.h,
a)&&delete e.h[a];b.cachedImages.h[a]=c;return Ia.withValue(c)}):Ga.loadFromFile(this.paths.h[a])},loadText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return Ia.withValue(this.cachedText.h[a]);if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)||Object.prototype.hasOwnProperty.call(this.classTypes.h,a)){var b=this.getBytes(a);if(null==b)return Ia.withValue(null);b=b.getString(0,b.length);this.cachedText.h[a]=b;return Ia.withValue(b)}return(new Id).load(this.paths.h[a])},
unload:function(){},__assetLoaded:function(a){this.assetsLoaded++;null!=a&&za.verbose("Loaded asset: "+a+" ["+this.types.h[a]+"] ("+(this.assetsLoaded-1)+"/"+(this.assetsTotal-1)+")",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:619,className:"lime.utils.AssetLibrary",methodName:"__assetLoaded"});if(null!=a){var b=Object.prototype.hasOwnProperty.call(this.sizes.h,a)?this.sizes.h[a]:0;if(Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)){var c=this.bytesLoadedCache.h[a];c<b&&(this.bytesLoaded+=
b-c)}else this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b}this.assetsLoaded<this.assetsTotal?this.promise.progress(this.bytesLoaded,this.bytesTotal):(this.loaded=!0,this.promise.progress(this.bytesTotal,this.bytesTotal),this.promise.complete(this))},__cacheBreak:function(a){return aa.__cacheBreak(a)},__fromBundle:function(a,b){if(null!=b){var c=0;for(b=b.assets;c<b.length;){var e=b[c];++c;var f=Object.prototype.hasOwnProperty.call(e,"id")?e.id:e.path;var h=a.data.h[e.path];if(Object.prototype.hasOwnProperty.call(e,
"type")){var d=e.type;"TEXT"==d?this.cachedText.h[f]=null!=h?m.string(h):null:this.cachedBytes.h[f]=h;this.types.h[f]=e.type}else this.cachedBytes.h[f]=h,this.types.h[f]="BINARY"}}else for(c=0,b=a.paths;c<b.length;)f=b[c],++c,this.cachedBytes.h[f]=a.data.h[f],this.types.h[f]="BINARY"},__fromManifest:function(a){var b=2<=a.version,c=a.rootPath;null==c&&(c="");""!=c&&(c+="/");for(var e=0,f=a.assets;e<f.length;){var h=f[e];++e;var d=b&&Object.prototype.hasOwnProperty.call(h,"size")?h.size:100;var l=
Object.prototype.hasOwnProperty.call(h,"id")?h.id:h.path;if(Object.prototype.hasOwnProperty.call(h,"path")){var g=this.paths;var x=this.__cacheBreak(this.__resolvePath(c+m.string(H.field(h,"path"))));g.h[l]=x}if(Object.prototype.hasOwnProperty.call(h,"pathGroup")){g=H.field(h,"pathGroup");x=0;for(var p=g.length;x<p;){var r=x++;g[r]=this.__cacheBreak(this.__resolvePath(c+g[r]))}this.pathGroups.h[l]=g}this.sizes.h[l]=d;this.types.h[l]=h.type;Object.prototype.hasOwnProperty.call(h,"preload")&&(this.preload.h[l]=
H.field(h,"preload"));Object.prototype.hasOwnProperty.call(h,"className")&&(d=H.field(h,"className"),d=n[d],this.classTypes.h[l]=d)}e=this.bytesTotal=0;for(f=a.assets;e<f.length;)h=f[e],++e,l=Object.prototype.hasOwnProperty.call(h,"id")?h.id:h.path,Object.prototype.hasOwnProperty.call(this.preload.h,l)&&this.preload.h[l]&&Object.prototype.hasOwnProperty.call(this.sizes.h,l)&&(this.bytesTotal+=this.sizes.h[l])},__resolvePath:function(a){a=ha.replace(a,"\\","/");var b=a.indexOf(":");ha.startsWith(a,
"http")&&0<b?(b+=3,a=G.substr(a,0,b)+ha.replace(G.substr(a,b,null),"//","/")):a=ha.replace(a,"//","/");if(-1<a.indexOf("./")){a=a.split("/");b=[];for(var c=0,e=a.length;c<e;){var f=c++;".."==a[f]?0==f||".."==b[f-1]?b.push(".."):b.pop():"."==a[f]?0==f&&b.push("."):b.push(a[f])}a=b.join("/")}return a},loadAudioBuffer_onComplete:function(a,b){this.cachedAudioBuffers.h[a]=b;if(Object.prototype.hasOwnProperty.call(this.pathGroups.h,a))for(var c=this.pathGroups.h[a],e=Object.keys(this.pathGroups.h),f=e.length,
h=0;h<f;){var d=e[h++];if(d!=a)for(var l=0;l<c.length;){var g=c[l];++l;if(-1<this.pathGroups.h[d].indexOf(g)){this.cachedAudioBuffers.h[d]=b;break}}}this.__assetLoaded(a)},loadAudioBuffer_onError:function(a,b){null!=b&&""!=b?za.warn('Could not load "'+a+'": '+m.string(b),{fileName:"lime/utils/AssetLibrary.hx",lineNumber:865,className:"lime.utils.AssetLibrary",methodName:"loadAudioBuffer_onError"}):za.warn('Could not load "'+a+'"',{fileName:"lime/utils/AssetLibrary.hx",lineNumber:869,className:"lime.utils.AssetLibrary",
methodName:"loadAudioBuffer_onError"});this.loadAudioBuffer_onComplete(a,new eb)},loadBytes_onComplete:function(a,b){this.cachedBytes.h[a]=b;this.__assetLoaded(a)},loadFont_onComplete:function(a,b){this.cachedFonts.h[a]=b;this.__assetLoaded(a)},loadImage_onComplete:function(a,b){this.cachedImages.h[a]=b;this.__assetLoaded(a)},loadText_onComplete:function(a,b){this.cachedText.h[a]=b;this.__assetLoaded(a)},load_onError:function(a,b){null!=b&&""!=b?this.promise.error('Error loading asset "'+a+'": '+
m.string(b)):this.promise.error('Error loading asset "'+a+'"')},load_onProgress:function(a,b,c){if(0<b){var e=this.sizes.h[a];0<c?(b/=c,1<b&&(b=1),b=Math.floor(b*e)):b>e&&(b=e);Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)?(e=this.bytesLoadedCache.h[a],b!=e&&(this.bytesLoaded+=b-e)):this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b;this.promise.progress(this.bytesLoaded,this.bytesTotal)}},__class__:hc};var nb=function(){this.assets=[];this.libraryArgs=[];this.version=2};n["lime.utils.AssetManifest"]=
nb;nb.__name__=!0;nb.fromBytes=function(a,b){return null!=a?nb.parse(a.getString(0,a.length),b):null};nb.loadFromFile=function(a,b){a=nb.__resolvePath(a);b=nb.__resolveRootPath(b,a);return null==a?null:oc.loadFromFile(a).then(function(a){return Ia.withValue(nb.fromBytes(a,b))})};nb.parse=function(a,b){if(null==a||""==a)return null;a=JSON.parse(a);var c=new nb;Object.prototype.hasOwnProperty.call(a,"name")&&(c.name=a.name);Object.prototype.hasOwnProperty.call(a,"libraryType")&&(c.libraryType=a.libraryType);
Object.prototype.hasOwnProperty.call(a,"libraryArgs")&&(c.libraryArgs=a.libraryArgs);if(Object.prototype.hasOwnProperty.call(a,"assets")){var e=a.assets;Object.prototype.hasOwnProperty.call(a,"version")&&2>=a.version?c.assets=tb.run(e):c.assets=e}Object.prototype.hasOwnProperty.call(a,"rootPath")&&(c.rootPath=a.rootPath);null!=b&&""!=b&&(c.rootPath=null==c.rootPath||""==c.rootPath?b:b+"/"+c.rootPath);return c};nb.__resolvePath=function(a){if(null==a)return null;var b=a.indexOf("?");var c=-1<b?G.substr(a,
0,b):a;for(c=ha.replace(c,"\\","/");ha.endsWith(c,"/");)c=G.substr(c,0,c.length-1);return ha.endsWith(c,".bundle")?-1<b?c+"/library.json"+G.substr(a,b,null):c+"/library.json":a};nb.__resolveRootPath=function(a,b){if(null!=a)return a;a=b.indexOf("?");a=-1<a?G.substr(b,0,a):b;for(a=ha.replace(a,"\\","/");ha.endsWith(a,"/");){if("/"==a)return a;a=G.substr(a,0,a.length-1)}return ha.endsWith(a,".bundle")?a:ic.directory(a)};nb.prototype={__class__:nb};var aa=function(){};n["lime.utils.Assets"]=aa;aa.__name__=
!0;aa.getAsset=function(a,b,c){if(c&&aa.cache.enabled)switch(b){case "BINARY":case "TEXT":c=!1;break;case "FONT":var e=aa.cache.font.h[a];if(null!=e)return e;break;case "IMAGE":e=aa.cache.image.h[a];if(aa.isValidImage(e))return e;break;case "MUSIC":case "SOUND":e=aa.cache.audio.h[a];if(aa.isValidAudio(e))return e;break;case "TEMPLATE":throw A.thrown("Not sure how to get template: "+a);default:return null}var f=a.indexOf(":");e=a.substring(0,f);f=a.substring(f+1);var h=aa.getLibrary(e);if(null!=h)if(h.exists(f,
b)){if(h.isLocal(f,b))return e=h.getAsset(f,b),c&&aa.cache.enabled&&aa.cache.set(a,b,e),e;za.error(b+' asset "'+a+'" exists, but only asynchronously',{fileName:"lime/utils/Assets.hx",lineNumber:133,className:"lime.utils.Assets",methodName:"getAsset"})}else za.error("There is no "+b+' asset with an ID of "'+a+'"',{fileName:"lime/utils/Assets.hx",lineNumber:138,className:"lime.utils.Assets",methodName:"getAsset"});else za.error(aa.__libraryNotFound(e),{fileName:"lime/utils/Assets.hx",lineNumber:143,
className:"lime.utils.Assets",methodName:"getAsset"});return null};aa.getBytes=function(a){return aa.getAsset(a,"BINARY",!1)};aa.getLibrary=function(a){if(null==a||""==a)a="default";return aa.libraries.h[a]};aa.isLocal=function(a,b,c){null==c&&(c=!0);if(c&&aa.cache.enabled&&aa.cache.exists(a,b))return!0;var e=a.indexOf(":");c=a.substring(0,e);a=a.substring(e+1);c=aa.getLibrary(c);return null!=c?c.isLocal(a,b):!1};aa.isValidAudio=function(a){return null!=a};aa.isValidImage=function(a){return null!=
a?null!=a.buffer:!1};aa.loadLibrary=function(a){var b=new vb,c=aa.getLibrary(a);if(null!=c)return c.load();c=a;var e=null;if(Object.prototype.hasOwnProperty.call(aa.bundlePaths.h,a))Ob.loadFromFile(aa.bundlePaths.h[a]).onComplete(function(c){null==c?b.error('Cannot load bundle for library "'+a+'"'):(c=hc.fromBundle(c),null==c?b.error('Cannot open library "'+a+'"'):(aa.libraries.h[a]=c,c.onChange.add((g=aa.onChange,q(g,g.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+
a+'"')});else Object.prototype.hasOwnProperty.call(aa.libraryPaths.h,a)?(c=aa.libraryPaths.h[a],e=ic.directory(c)):(ha.endsWith(c,".bundle")?(e=c,c+="/library.json"):e=ic.directory(c),c=aa.__cacheBreak(c)),nb.loadFromFile(c,e).onComplete(function(c){null==c?b.error('Cannot parse asset manifest for library "'+a+'"'):(c=hc.fromManifest(c),null==c?b.error('Cannot open library "'+a+'"'):(aa.libraries.h[a]=c,c.onChange.add((g=aa.onChange,q(g,g.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+
a+'"')});return b.future};aa.registerLibrary=function(a,b){if(Object.prototype.hasOwnProperty.call(aa.libraries.h,a)){if(aa.libraries.h[a]==b)return;aa.unloadLibrary(a)}null!=b&&b.onChange.add(aa.library_onChange);aa.libraries.h[a]=b};aa.unloadLibrary=function(a){if(null==a||""==a)a="default";var b=aa.libraries.h[a];null!=b&&(aa.cache.clear(a+":"),b.onChange.remove(aa.library_onChange),b.unload());b=aa.libraries;Object.prototype.hasOwnProperty.call(b.h,a)&&delete b.h[a]};aa.__cacheBreak=function(a){0<
aa.cache.version&&(a=-1<a.indexOf("?")?a+("&"+aa.cache.version):a+("?"+aa.cache.version));return a};aa.__libraryNotFound=function(a){if(null==a||""==a)a="default";return null==ba.current||null==ba.current.__preloader||ba.current.__preloader.complete?'There is no asset library named "'+a+'"':'There is no asset library named "'+a+'", or it is not yet preloaded'};aa.library_onChange=function(){aa.cache.clear();aa.onChange.dispatch()};var oc={_new:function(a,b){return new La(b)},decompress:function(a,
b){switch(b._hx_index){case 0:return Me.decompress(a);case 1:return Ne.decompress(a);case 2:return Oe.decompress(a);case 3:return Pe.decompress(a)}},fromBytes:function(a){return null==a?null:oc._new(a.length,a.b.bufferValue)},fromFile:function(a){return null},loadFromFile:function(a){return(new Jd).load(a)},ofString:function(a){a=La.ofString(a);return oc._new(a.length,a.b.bufferValue)}},bd=p["lime.utils.CompressionAlgorithm"]={__ename__:!0,__constructs__:null,DEFLATE:{_hx_name:"DEFLATE",_hx_index:0,
__enum__:"lime.utils.CompressionAlgorithm",toString:d},GZIP:{_hx_name:"GZIP",_hx_index:1,__enum__:"lime.utils.CompressionAlgorithm",toString:d},LZMA:{_hx_name:"LZMA",_hx_index:2,__enum__:"lime.utils.CompressionAlgorithm",toString:d},ZLIB:{_hx_name:"ZLIB",_hx_index:3,__enum__:"lime.utils.CompressionAlgorithm",toString:d}};bd.__constructs__=[bd.DEFLATE,bd.GZIP,bd.LZMA,bd.ZLIB];var za=function(){};n["lime.utils.Log"]=za;za.__name__=!0;za.error=function(a,b){if(1<=za.level){a="["+b.className+"] ERROR: "+
m.string(a);if(za.throwErrors)throw A.thrown(a);console.error(a)}};za.verbose=function(a,b){5<=za.level&&(a="["+b.className+"] "+m.string(a),console.log(a))};za.warn=function(a,b){2<=za.level&&console.warn("["+b.className+"] WARNING: "+m.string(a))};var Sd=function(){this.bytesTotalCache=new W;this.bytesLoadedCache2=new W;this.bytesLoadedCache=new zb;this.onProgress=new Vc;this.onComplete=new Ta;this.bytesTotal=this.bytesLoaded=0;this.libraries=[];this.libraryNames=[];this.onProgress.add(q(this,this.update))};
n["lime.utils.Preloader"]=Sd;Sd.__name__=!0;Sd.prototype={addLibrary:function(a){this.libraries.push(a)},addLibraryName:function(a){-1==this.libraryNames.indexOf(a)&&this.libraryNames.push(a)},load:function(){for(var a=this,b=0,c=this.libraries;b<c.length;){var e=c[b];++b;this.bytesTotal+=e.bytesTotal}this.loadedLibraries=-1;this.preloadStarted=!1;b=0;for(c=this.libraries;b<c.length;)e=[c[b]],++b,za.verbose("Preloading asset library",{fileName:"lime/utils/Preloader.hx",lineNumber:132,className:"lime.utils.Preloader",
methodName:"load"}),e[0].load().onProgress(function(b){return function(c,e){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+c:a.bytesLoaded+(c-a.bytesLoadedCache.h[b[0].__id__]);a.bytesLoadedCache.set(b[0],c);a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal)}}(e)).onComplete(function(b){return function(c){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+b[0].bytesTotal:a.bytesLoaded+(b[0].bytesTotal-a.bytesLoadedCache.h[b[0].__id__]);
a.loadedAssetLibrary()}}(e)).onError(function(){return function(a){za.error(a,{fileName:"lime/utils/Preloader.hx",lineNumber:168,className:"lime.utils.Preloader",methodName:"load"})}}());b=0;for(c=this.libraryNames;b<c.length;)++b,this.bytesTotal+=200;this.loadedLibraries++;this.preloadStarted=!0;this.updateProgress()},loadedAssetLibrary:function(a){this.loadedLibraries++;var b=this.loadedLibraries;this.preloadStarted||++b;var c=this.libraries.length+this.libraryNames.length;null!=a?za.verbose("Loaded asset library: "+
a+" ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",lineNumber:195,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"}):za.verbose("Loaded asset library ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",lineNumber:199,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"});this.updateProgress()},start:function(){this.complete||this.simulateProgress||!this.preloadComplete||(this.complete=!0,this.onComplete.dispatch())},update:function(a,b){},updateProgress:function(){var a=
this;this.simulateProgress||this.onProgress.dispatch(this.bytesLoaded,this.bytesTotal);if(this.loadedLibraries==this.libraries.length&&!this.initLibraryNames){this.initLibraryNames=!0;for(var b=0,c=this.libraryNames;b<c.length;){var e=[c[b]];++b;za.verbose("Preloading asset library: "+e[0],{fileName:"lime/utils/Preloader.hx",lineNumber:236,className:"lime.utils.Preloader",methodName:"updateProgress"});aa.loadLibrary(e[0]).onProgress(function(b){return function(c,e){0<e&&(Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,
b[0])||(a.bytesTotalCache.h[b[0]]=e,a.bytesTotal+=e-200),c>e&&(c=e),Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:a.bytesLoaded+=c,a.bytesLoadedCache2.h[b[0]]=c,a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal))}}(e)).onComplete(function(b){return function(c){c=200;Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])&&(c=a.bytesTotalCache.h[b[0]]);Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,
b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:a.bytesLoaded+=c;a.loadedAssetLibrary(b[0])}}(e)).onError(function(){return function(a){za.error(a,{fileName:"lime/utils/Preloader.hx",lineNumber:290,className:"lime.utils.Preloader",methodName:"updateProgress"})}}())}}this.simulateProgress||this.loadedLibraries!=this.libraries.length+this.libraryNames.length||(this.preloadComplete||(this.preloadComplete=!0,za.verbose("Preload complete",{fileName:"lime/utils/Preloader.hx",lineNumber:301,className:"lime.utils.Preloader",
methodName:"updateProgress"})),this.start())},__class__:Sd};var ce=function(a,b){this.drawNeedsUpdate=!1;this.totalTicksPassed=this.elapsedMsSinceLastTick=0;this.isUpdating=!1;this.window=a;this.config=null!=b?b:{framesPerSecond:60,drawOnlyWhenRequested:!1};this.setTickDuration(Math.floor(1E3/this.config.framesPerSecond));this.loop=new wd;this.loop.onInit(this)};n["ob.gum.Gum"]=ce;ce.__name__=!0;ce.prototype={setTickDuration:function(a){this.tickDurationMs=a},toggleUpdate:function(a){this.isUpdating=
null!=a?a:!this.isUpdating},changeLoop:function(a){this.loop=a;this.loop.onInit(this)},onUpdate:function(a){this.isUpdating&&(this.loop.onUpdate(a),this.elapsedMsSinceLastTick+=a,this.elapsedMsSinceLastTick>=this.tickDurationMs&&(this.elapsedMsSinceLastTick=0,this.totalTicksPassed++,this.drawNeedsUpdate=this.loop.onTick(a)),!this.config.drawOnlyWhenRequested||this.drawNeedsUpdate)&&(this.loop.onDraw(a),this.drawNeedsUpdate=!1)},onKeyDown:function(a,b){this.loop.onKeyDown(a,b)},onKeyUp:function(a,
b){this.loop.onKeyUp(a,b)},onMouseMove:function(a,b){this.loop.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.loop.onMouseDown(a,b,c)},onMouseUp:function(a,b,c){this.loop.onMouseUp(a,b,c)},onMouseScroll:function(a,b,c){this.loop.onMouseScroll(a,b,c)},onWindowResize:function(a,b){this.loop.onWindowResize(a,b)},__class__:ce};var wd=function(){};n["ob.gum.LoadingLoop"]=wd;wd.__name__=!0;wd.__interfaces__=[E];wd.prototype={onTick:function(a){return!1},onInit:function(a){this.gum=a;ka.trace("LoadingLoop onInit",
{fileName:"ob/gum/Core.hx",lineNumber:136,className:"ob.gum.LoadingLoop",methodName:"onInit"})},onUpdate:function(a){},onDraw:function(a){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){},__class__:wd};var zc=function(){};n["ob.gum.backends.PaletteExtensions"]=zc;zc.__name__=!0;zc.toRGBA=function(a){for(var b=[],c=0;c<a.length;){var e=a[c];++c;b.push(zc.RGBA(e))}return b};
zc.RGBA=function(a,b){null==b&&(b=255);return a<<8|b};zc.changeAlpha=function(a,b){return(a&-16777216)>>24<<24|(a&16711680)>>16<<16|(a&65280)>>8<<8|b};var ee=function(a){this.imageCache=[];this.fontCache=[];this.paths=a};n["ob.gum.backends.Assets"]=ee;ee.__name__=!0;ee.prototype={Preload:function(a){ka.trace("begin loading "+m.string(this.paths),{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:141,className:"ob.gum.backends.Assets",methodName:"Preload"});this.onReady=a;this.loadFonts()},loadFonts:function(a){null==
a&&(a=0);var b=this;if(a>this.paths.fonts.length-1)this.loadImages();else{var c=this.paths.fonts[a];ka.trace("loading font index "+a+" "+c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:153,className:"ob.gum.backends.Assets",methodName:"loadFonts"});(new Ee(c)).load(function(c){b.fontCache.push(c);a+=1;b.loadFonts(a)})}},loadImages:function(){var a,b=this;ka.trace("load images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:163,className:"ob.gum.backends.Assets",methodName:"loadImages"});
var c=!1;if(0>=this.paths.images.length)ka.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:166,className:"ob.gum.backends.Assets",methodName:"loadImages"}),this.onReady();else{ka.trace("loading "+this.paths.images.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:169,className:"ob.gum.backends.Assets",methodName:"loadImages"});var e=this.paths.images,f=c,h=function(a,c){ka.trace(c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:172,className:"ob.gum.backends.Assets",
methodName:"loadImages"});ka.trace("starting without images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:173,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()},d=function(a){b.imageCache=a;ka.trace("loaded "+b.imageCache.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:177,className:"ob.gum.backends.Assets",methodName:"loadImages"});ka.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:178,className:"ob.gum.backends.Assets",
methodName:"loadImages"});b.onReady()};null==f&&(f=!1);var l=[],g=e.length;var m=0;for(a=e.length;m<a;){var x=[m++];var r=[e[x[0]]];c=f;var p=null==h?null:function(a){return function(b){h(a[0],b)}}(x);x=null==d?null:function(a){return function(b){l[a[0]]=b;0==--g&&d(l)}}(x);null==c&&(c=!1);""!=Ja.corsServer&&(new z("^https?://","")).match(r[0])&&(r[0]="//"+Ja.corsServer+"/"+r[0]);var B=Ga.loadFromFile(r[0]);c&&(ka.trace('Start loading image "'+r[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",
methodName:"image"}),B.onProgress(function(a){return function(b,c){Ja.onProgressDebug(b,c,a[0])}}(r)),B.onError(Ja.onErrorDebug),B.onComplete(function(a){return function(b){Ja.onCompleteDebug(a[0])}}(r)));if(null!=p)B.onError(p);if(null!=x)B.onComplete(x)}}},__class__:ee};var Fe=function(){this.weight=.5;this.zIndex=this.tilt=0;this.width=this.height=16;this.bgColor=255;this.color=-855703297};n["ob.gum.backends.FontStyle"]=Fe;Fe.__name__=!0;Fe.prototype={__class__:Fe};var Aa=function(){};n["peote.text.BackgroundElement"]=
Aa;Aa.__name__=!0;var ae=function(){};n["peote.text.FontConfig"]=ae;ae.__name__=!0;ae.prototype={__class__:ae};var ac=function(a){this.uniformFloats=[];this.hasFragmentInjection=this.ready=!1;this.fragmentFloatPrecision=null;this.formulaHasChanged=!1;this.formula=new W;this.colorFormula="";this.used_by_ColorFormula=this.usedID_by_ColorFormula=0;this.textureID_Defaults=[];this.customTextureIdentifiers=[];this.activeUnits=[];this.activeTextures=[];this.textureLayers=new Bb;this.textureListPicking=new xd(new zb);
this.textureList=new xd(new zb);this.glShaderConfig={isPICKING:!1,isES3:!1,isINSTANCED:!1,isUBO:!1,IN:"attribute",VARIN:"varying",VAROUT:"varying",hasTEXTURES:!1,hasTEXTURE_FUNCTIONS:!1,hasFRAGMENT_INJECTION:!1,FRAGMENT_PROGRAM_UNIFORMS:"",FRAGMENT_CALC_LAYER:"",TEXTURES:[],TEXTURE_DEFAULTS:[],isDISCARD:!0,DISCARD:"0.0",isPIXELSNAPPING:!1,PIXELDIVISOR:"1.0",VERTEX_FLOAT_PRECISION:null,VERTEX_INT_PRECISION:null,VERTEX_SAMPLER_PRECISION:null,FRAGMENT_FLOAT_PRECISION:null,FRAGMENT_INT_PRECISION:null,
FRAGMENT_SAMPLER_PRECISION:null,VERTEX_INJECTION:"",FRAGMENT_INJECTION:"",SIZE_FORMULA:null,POS_FORMULA:null,ROTZ_FORMULA:null,PIVOT_FORMULA:null,FORMULA_VARYINGS:{},FORMULA_CONSTANTS:{},FRAGMENT_EXTENSIONS:[]};this.gl=this.glProgram=this.glProgramPicking=this.glVertexShader=this.glFragmentShader=this.glVertexShaderPicking=this.glFragmentShaderPicking=null;this.displays=[];this.autoUpdateTextures=this.isVisible=!0;this.clearMask=!1;this.mask=0;this.colorEnabled=!0;this.buffer=a;this.alphaEnabled=
a.hasAlpha();this.zIndexEnabled=a.hasZindex();this.colorIdentifiers=a.getColorIdentifiers();this.customIdentifiers=a.getCustomIdentifiers();this.customVaryings=a.getCustomVaryings();this.textureIdentifiers=a.getTextureIdentifiers();this.defaultColorFormula=a.getDefaultColorFormula();this.defaultFormulaVars=a.getDefaultFormulaVars();var b=a.getFormulas().h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var f=b[e++],h=this.formula,d=a.getFormulas().h[f];h.h[f]=d}try{$b.resolveFormulaCyclic(a.getFormulas())}catch(l){throw ma.lastError=
l,a=A.caught(l).unwrap(),A.thrown('Error: cyclic reference of "'+m.string(a.errVar)+'" inside @formula "'+m.string(a.formula)+'" for "'+m.string(a.errKey)+'"');}$b.resolveFormulaVars(a.getFormulas(),a.getAttributes());this.parseColorFormula()};n["peote.view.Program"]=ac;ac.__name__=!0;ac.prototype={addToDisplay:function(a,b,c){null==c&&(c=!1);if(0>this.displays.indexOf(a)){this.displays.push(a);var e=a.gl;if(null!=e&&e!=this.gl){for(var f=0,h=this.displays;f<h.length;){var d=h[f];++f;if(null!=d.gl&&
d.gl!=e)throw A.thrown("Error, program can not used inside different gl-contexts");}null!=this.gl&&(this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)));this.gl=e;Q.isES3&&(this.glShaderConfig.isES3=!0,this.glShaderConfig.IN="in",this.glShaderConfig.VARIN=
"in",this.glShaderConfig.VAROUT="out");Q.isUBO&&(this.glShaderConfig.isUBO=!0);Q.isINSTANCED&&(this.glShaderConfig.isINSTANCED=!0);this.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=this.gl.getExtension("OES_standard_derivatives")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=this.gl.getExtension("EXT_color_buffer_float")?this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):null!=this.gl.getExtension("OES_texture_float")&&
this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});this.buffer.setNewGLContext(this.gl);this.createProg();this.buffer.hasPicking()&&this.createProg(!0);f=0;for(h=this.activeTextures;f<h.length;){var l=h[f];++f;e=this.gl;if(null!=e&&e!=l.gl){d=0;for(var g=l.programs;d<g.length;){var m=g[d];++d;if(null!=m.gl&&m.gl!=e)throw A.thrown("Error, texture can not used inside different gl-contexts");}g=0;for(m=l.displays;g<m.length;)if(d=m[g],++g,null!=d.gl&&d.gl!=e)throw A.thrown("Error, texture can not used inside different gl-contexts");
null!=l.gl&&(l.gl.deleteTexture(l.glTexture),l.glTexture=null,0==l.displays.length&&null!=l.framebuffer&&(l.gl.deleteFramebuffer(l.framebuffer),l.framebuffer=null,null!=l.glDepthBuffer&&l.gl.deleteRenderbuffer(l.glDepthBuffer),l.glDepthBuffer=null));l.gl=e;if(l.width>l.gl.getParameter(l.gl.MAX_TEXTURE_SIZE)||l.height>l.gl.getParameter(l.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");l.glTexture=Db.createEmptyTexture(l.gl,l.width,l.height,l.colorChannels,
l.createMipmaps,l.magFilter,l.minFilter,l.useFloat);if(0<l.displays.length&&null==l.framebuffer){l.glDepthBuffer=l.gl.createRenderbuffer();e=l.gl;d=l.glTexture;g=l.glDepthBuffer;m=l.width;var x=l.height,r=e.createFramebuffer();e.bindRenderbuffer(e.RENDERBUFFER,g);Oa.clearGlErrorQueue(e);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT24,m,x);Oa.getLastGlError(e)==e.INVALID_ENUM&&(ka.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",
methodName:"createFramebuffer"}),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,m,x));e.bindFramebuffer(e.FRAMEBUFFER,r);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,g);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,d,0);if(e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");e.bindFramebuffer(e.FRAMEBUFFER,null);e.bindRenderbuffer(e.RENDERBUFFER,null);l.framebuffer=r;l.updated=
!0}for(e=l.images.keys();e.hasNext();)d=e.next(),l.bufferImage(d,l.images.h[d.__id__])}}}}a.programList.add(this,b,c)},createProg:function(a){null==a&&(a=!1);this.glShaderConfig.isPICKING=a;if(null!=this.fragmentFloatPrecision)this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=this.fragmentFloatPrecision;else if(this.buffer.needFragmentPrecision()&&23>Sa.FragmentFloat.medium){var b=Sa.FragmentFloat;this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.high?"highp":0<b.medium?"mediump":0<b.low?"lowp":null}else b=
Sa.FragmentFloat,this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.medium?"mediump":0<b.low?"lowp":null;this.parseAndResolveFormulas();var c=this.gl,e=this.gl.VERTEX_SHADER,f=this.buffer.getVertexShader(),h=this.glShaderConfig;f=new wa(f);var d=Oa.rStartspaces,g=Oa.rEmptylines;h=f.execute(h).replace(g.r,"\n").replace(d.r,"");f=c.createShader(e);c.shaderSource(f,h);c.compileShader(f);if(0==c.getShaderParameter(f,c.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+
" shader\n"+m.string(c.getShaderInfoLog(f)));b=f;c=this.gl;e=this.gl.FRAGMENT_SHADER;f=this.buffer.getFragmentShader();h=this.glShaderConfig;f=new wa(f);d=Oa.rStartspaces;g=Oa.rEmptylines;h=f.execute(h).replace(g.r,"\n").replace(d.r,"");f=c.createShader(e);c.shaderSource(f,h);c.compileShader(f);if(0==c.getShaderParameter(f,c.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+m.string(c.getShaderInfoLog(f)));e=f;h=this.gl.createProgram();this.gl.attachShader(h,
b);this.gl.attachShader(h,e);this.buffer.bindAttribLocations(this.gl,h);c=this.gl;c.linkProgram(h);if(0==c.getProgramParameter(h,c.LINK_STATUS))throw A.thrown(m.string(c.getProgramInfoLog(h))+"VALIDATE_STATUS: "+m.string(c.getProgramParameter(h,c.VALIDATE_STATUS))+"ERROR: "+m.string(c.getError()));!a&&Q.isUBO?(c=this.gl.getUniformBlockIndex(h,"uboView"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(h,c,0),c=this.gl.getUniformBlockIndex(h,"uboDisplay"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(h,
c,1)):a?(this.uRESOLUTION_PICK=this.gl.getUniformLocation(h,"uResolution"),this.uZOOM_PICK=this.gl.getUniformLocation(h,"uZoom"),this.uOFFSET_PICK=this.gl.getUniformLocation(h,"uOffset")):(this.uRESOLUTION=this.gl.getUniformLocation(h,"uResolution"),this.uZOOM=this.gl.getUniformLocation(h,"uZoom"),this.uOFFSET=this.gl.getUniformLocation(h,"uOffset"));if(a)for(this.uTIME_PICK=this.gl.getUniformLocation(h,"uTime"),this.uniformFloatPickLocations=[],c=0,f=this.uniformFloats;c<f.length;)d=f[c],++c,this.uniformFloatPickLocations.push(this.gl.getUniformLocation(h,
d.name));else for(this.uTIME=this.gl.getUniformLocation(h,"uTime"),this.uniformFloatLocations=[],c=0,f=this.uniformFloats;c<f.length;)d=f[c],++c,this.uniformFloatLocations.push(this.gl.getUniformLocation(h,d.name));if(a){this.textureListPicking.clear();c=0;for(f=this.activeTextures.length;c<f;)a=c++,this.textureListPicking.add(new yd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(h,"uTexture"+a)),null,!1);this.glProgramPicking=h;this.glVertexShaderPicking=b;this.glFragmentShaderPicking=
e}else{this.textureList.clear();c=0;for(f=this.activeTextures.length;c<f;)a=c++,this.textureList.add(new yd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(h,"uTexture"+a)),null,!1);this.glProgram=h;this.glVertexShader=b;this.glFragmentShader=e}this.ready=!0},parseColorFormula:function(){var a="";if(""!=this.colorFormula)a=this.colorFormula;else if(""!=this.defaultColorFormula)a=this.defaultColorFormula;else{for(var b=this.colorIdentifiers.slice(),c=[],e=0,f=this.textureIdentifiers.length;e<
f;){var h=e++;this.textureLayers.h.hasOwnProperty(h)&&c.push(this.textureIdentifiers[h])}e=0;for(f=this.customTextureIdentifiers.length;e<f;)h=e++,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+h)&&c.push(this.customTextureIdentifiers[h]);if(0==b.length+c.length){var d=-16776961;c=""+m.string((d>>24&255)/255);var g=""+m.string((d>>16&255)/255),x=""+m.string((d>>8&255)/255);d=""+m.string((d&255)/255);a="vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=g.indexOf(".")||
-1!=g.indexOf("e-")?g:g+".0")+", "+((-1!=x.indexOf(".")||-1!=x.indexOf("e-")?x:x+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")}else{0<c.length&&(a=c.shift(),0<b.length&&(a=""+b.shift()+" * "+a));for(e=0;e<c.length;)g=c[e],++e,0<b.length&&(g=""+b.shift()+" * "+g+" "),a="mix( "+a+", "+g+", ("+g+").a )";for(;0<b.length;)a+=(""!=a?"*":"")+b.shift(),0<b.length&&(a="("+a+" + "+b.shift()+")")}}e=0;for(f=this.colorIdentifiers.length;e<f;)h=e++,b=new z("(^|.*?[^\\w.])"+this.colorIdentifiers[h]+
"\\b.*?","g"),b.match(a)&&(a=a.replace(b.r,"$1c"+h));e=0;for(f=this.customIdentifiers.length;e<f;)if(h=e++,b=new z("(^|.*?[^\\w.])"+this.customIdentifiers[h]+"\\b.*?","g"),b.match(a))if(null!=this.customVaryings[h])a=a.replace(b.r,"$1"+this.customVaryings[h]);else throw A.thrown("Error while parsing ColorFormula: custom identifier "+this.customIdentifiers[h]+" need @varying to access in fragmentshader");this.textureID_Defaults=[];e=this.usedID_by_ColorFormula=this.used_by_ColorFormula=0;for(f=this.textureIdentifiers.length;e<
f;)h=e++,b=new z("(^|.*?[^\\w.])"+this.textureIdentifiers[h]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(h)&&(a=a.replace(b.r,"$1t"+h)),this.used_by_ColorFormula|=1<<h),b=new z("(^|.*?[^\\w.])"+(this.textureIdentifiers[h]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+h),this.usedID_by_ColorFormula|=1<<h,this.textureLayers.h.hasOwnProperty(h)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[h]],c=""+m.string((d>>24&255)/255),g=""+m.string((d>>16&255)/255),x=""+m.string((d>>
8&255)/255),d=""+m.string((d&255)/255),this.textureID_Defaults.push({layer:h,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=g.indexOf(".")||-1!=g.indexOf("e-")?g:g+".0")+", "+((-1!=x.indexOf(".")||-1!=x.indexOf("e-")?x:x+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")})));e=0;for(f=this.customTextureIdentifiers.length;e<f;)h=e++,b=new z("(^|.*?[^\\w.])"+this.customTextureIdentifiers[h]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+
h)&&(a=a.replace(b.r,"$1t"+(this.textureIdentifiers.length+h))),this.used_by_ColorFormula|=1<<this.textureIdentifiers.length+h),b=new z("(^|.*?[^\\w.])"+(this.customTextureIdentifiers[h]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+(this.textureIdentifiers.length+h)),this.usedID_by_ColorFormula|=1<<this.textureIdentifiers.length+h,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+h)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[this.textureIdentifiers.length+h]],c=
""+m.string((d>>24&255)/255),g=""+m.string((d>>16&255)/255),x=""+m.string((d>>8&255)/255),d=""+m.string((d&255)/255),this.textureID_Defaults.push({layer:this.textureIdentifiers.length+h,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=g.indexOf(".")||-1!=g.indexOf("e-")?g:g+".0")+", "+((-1!=x.indexOf(".")||-1!=x.indexOf("e-")?x:x+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")})));e=Object.keys(this.defaultFormulaVars.h);f=e.length;for(h=0;h<f;)c=e[h++],
b=new z("(^|.*?[^\\w.])"+c+"\\b.*?","g"),b.match(a)&&(d=this.defaultFormulaVars.h[c],c=""+m.string((d>>24&255)/255),g=""+m.string((d>>16&255)/255),x=""+m.string((d>>8&255)/255),d=""+m.string((d&255)/255),a=a.replace(b.r,"$1vec4("+((-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=g.indexOf(".")||-1!=g.indexOf("e-")?g:g+".0")+", "+((-1!=x.indexOf(".")||-1!=x.indexOf("e-")?x:x+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")"))));this.glShaderConfig.FRAGMENT_CALC_LAYER=a},
setColorFormula:function(a,b,c){null==a&&(a="");this.colorFormula=a;if(null!=b){a=Object.keys(b.h);for(var e=a.length,f=0;f<e;){var h=a[f++];if(!(new z("^([a-zA-z_]+\\d*)+$","g")).match(h))throw A.thrown('Error: "'+h+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');this.defaultFormulaVars.h[h]=b.h[h]}}null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},setFormula:function(a,b,c){var e=this.buffer.getFormulaNames().h[a];if(null!=
e)ka.trace("  set formula: "+e+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:514,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[e]=b;else{e=[];var f=this.buffer.getFormulaNames().h;f=Object.keys(f);for(var h=f.length,d=0;d<h;){var g=f[d++];e.push(this.buffer.getFormulaNames().h[g])}if(0<=e.indexOf(a))this.formula.h[a]=b;else if(0<=this.buffer.getFormulaVaryings().indexOf(a))ka.trace("  set formula for varying: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:522,
className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[a]=b;else if(0<=this.buffer.getFormulaConstants().indexOf(a))ka.trace("  set formula for constant: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:526,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[a]=b;else if(0<=this.buffer.getFormulaCustoms().indexOf(a))ka.trace("  set formula for custom: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:530,className:"peote.view.Program",methodName:"setFormula"}),
this.formula.h[a]=b;else throw A.thrown("Error: can not set Formula for "+a+" if there is no property defined for @"+a+" inside Element");}this.formulaHasChanged=!0;null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},parseAndResolveFormulas:function(){var a=this;if(this.formulaHasChanged){for(var b=new W,c=Object.keys(this.formula.h),e=c.length,f=0;f<e;){var h=c[f++];b.h[h]=this.formula.h[h]}var d=b;try{$b.resolveFormulaCyclic(d)}catch(l){throw ma.lastError=l,b=A.caught(l).unwrap(),
A.thrown('Error: cyclic reference of "'+m.string(b.errVar)+'" inside formula "'+m.string(b.formula)+'" for "'+m.string(b.errKey)+'"');}$b.resolveFormulaVars(d,this.buffer.getAttributes());b=function(b,c,e,f){var h=a.buffer.getFormulaNames().h[b];null==h&&(h="");var g=a.buffer.getFormulaNames().h[c];null==g&&(g="");var l=d.h[h],t=d.h[g];return l!=a.buffer.getFormulas().h[h]||t!=a.buffer.getFormulas().h[g]?(null==l&&(l=a.buffer.getAttributes().h[h]),null==l&&(l=e),null==t&&(t=a.buffer.getAttributes().h[g]),
null==t&&(t=f),"rotation"==b&&"0.0"!=l&&(l="("+l+")/180.0*"+Math.PI),"zIndex"==c&&"0.0"!=t&&(b=""+m.string(a.buffer.getMaxZindex()),t="clamp( "+t+"/"+(-1!=b.indexOf(".")||-1!=b.indexOf("e-")?b:b+".0")+", -1.0, 1.0)"),"vec2("+l+", "+t+")"):null};this.glShaderConfig.SIZE_FORMULA=b("sizeX","sizeY","100.0","100.0");this.glShaderConfig.POS_FORMULA=b("posX","posY","0.0","0.0");this.glShaderConfig.ROTZ_FORMULA=b("rotation","zIndex","0.0","0.0");this.glShaderConfig.PIVOT_FORMULA=b("pivotX","pivotY","0.0",
"0.0");b=0;for(c=this.buffer.getFormulaVaryings();b<c.length;)e=c[b],++b,f=d.h[e],f!=this.buffer.getFormulas().h[e]?(null==f&&(f=this.buffer.getAttributes().h[e]),this.glShaderConfig.FORMULA_VARYINGS[e]=f,ka.trace(" -- replacing Formula "+e+" => "+f,{fileName:"peote/view/Program.hx",lineNumber:591,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_VARYINGS[e]=null;b=0;for(c=this.buffer.getFormulaConstants();b<c.length;)e=c[b],++b,f=d.h[e],null!=f&&f!=
this.buffer.getAttributes().h[e]?(this.glShaderConfig.FORMULA_CONSTANTS[e]=f,ka.trace(" -- replacing Formula "+e+" => "+f,{fileName:"peote/view/Program.hx",lineNumber:601,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_CONSTANTS[e]=null}},getTextureIndexByIdentifier:function(a,b){null==b&&(b=!0);var c=this.textureIdentifiers.indexOf(a);if(0>c&&(c=this.customTextureIdentifiers.indexOf(a),0>c&&b)){if(!(new z("^([a-zA-z_]+\\d*)+$","g")).match(a))throw A.thrown('Error: "'+
a+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');c=this.textureIdentifiers.length+this.customTextureIdentifiers.length;this.customTextureIdentifiers.push(a)}return c},setTexture:function(a,b,c){b=this.getTextureIndexByIdentifier(b);this.textureLayers.h[b]=[a];null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},updateTextures:function(){for(var a=[],b=this.textureLayers.keys();b.hasNext();)for(var c=b.next(),e=0,f=this.textureLayers.h[c];e<
f.length;)c=f[e],++e,0>a.indexOf(c)&&a.push(c);for(var h=this.activeTextures.length;0<h--;)if(0>a.indexOf(this.activeTextures[h])){if(!G.remove(this.activeTextures[h].programs,this))throw A.thrown("Error, this texture is not used by program anymore");this.activeTextures.splice(h,1);this.activeUnits.splice(h,1)}for(e=0;e<a.length;)if(c=a[e],++e,0>this.activeTextures.indexOf(c)){this.activeTextures.push(c);for(f=0;0<=this.activeUnits.indexOf(f);)++f;this.activeUnits.push(f);if(0<=c.programs.indexOf(this))throw A.thrown("Error, texture is already used by program");
b=this.gl;if(null!=b&&b!=c.gl){f=0;for(h=c.programs;f<h.length;){var d=h[f];++f;if(null!=d.gl&&d.gl!=b)throw A.thrown("Error, texture can not used inside different gl-contexts");}f=0;for(h=c.displays;f<h.length;)if(d=h[f],++f,null!=d.gl&&d.gl!=b)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=c.gl&&(c.gl.deleteTexture(c.glTexture),c.glTexture=null,0==c.displays.length&&null!=c.framebuffer&&(c.gl.deleteFramebuffer(c.framebuffer),c.framebuffer=null,null!=c.glDepthBuffer&&
c.gl.deleteRenderbuffer(c.glDepthBuffer),c.glDepthBuffer=null));c.gl=b;if(c.width>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE)||c.height>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");c.glTexture=Db.createEmptyTexture(c.gl,c.width,c.height,c.colorChannels,c.createMipmaps,c.magFilter,c.minFilter,c.useFloat);if(0<c.displays.length&&null==c.framebuffer){c.glDepthBuffer=c.gl.createRenderbuffer();f=c.gl;b=c.glTexture;h=c.glDepthBuffer;d=c.width;
var g=c.height,x=f.createFramebuffer();f.bindRenderbuffer(f.RENDERBUFFER,h);Oa.clearGlErrorQueue(f);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT24,d,g);Oa.getLastGlError(f)==f.INVALID_ENUM&&(ka.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,d,g));f.bindFramebuffer(f.FRAMEBUFFER,x);f.framebufferRenderbuffer(f.FRAMEBUFFER,
f.DEPTH_ATTACHMENT,f.RENDERBUFFER,h);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,b,0);if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);c.framebuffer=x;c.updated=!0}for(f=c.images.keys();f.hasNext();)b=f.next(),c.bufferImage(b,c.images.h[b.__id__])}c.programs.push(this)}this.parseColorFormula();this.glShaderConfig.hasFRAGMENT_INJECTION=
this.hasFragmentInjection;this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS="";this.glShaderConfig.TEXTURES=[];if(0==this.activeTextures.length)this.glShaderConfig.hasTEXTURES=!1;else{this.glShaderConfig.hasTEXTURES=!0;e=0;for(f=this.activeTextures.length;e<f;)h=e++,this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS+="uniform sampler2D uTexture"+h+";";for(b=this.textureLayers.keys();b.hasNext();){c=b.next();a=[];d=this.textureLayers.h[c];e=0;for(f=d.length;e<f;){h=e++;g=""+m.string(d[h].slotWidth/d[h].width);
x=""+m.string(d[h].slotHeight/d[h].height);var p=""+m.string(d[h].slotsX*d[h].slotWidth/d[h].width),B=""+m.string(d[h].slotsY*d[h].slotHeight/d[h].height);a.push({UNIT_VALUE:h+1+".0",TEXTURE:"uTexture"+this.activeTextures.indexOf(d[h]),SLOTS_X:d[h].slotsX+".0",SLOTS_Y:d[h].slotsY+".0",SLOT_WIDTH:-1!=g.indexOf(".")||-1!=g.indexOf("e-")?g:g+".0",SLOT_HEIGHT:-1!=x.indexOf(".")||-1!=x.indexOf("e-")?x:x+".0",SLOTS_WIDTH:-1!=p.indexOf(".")||-1!=p.indexOf("e-")?p:p+".0",SLOTS_HEIGHT:-1!=B.indexOf(".")||
-1!=B.indexOf("e-")?B:B+".0",TILES_X:d[h].tilesX+".0",TILES_Y:d[h].tilesY+".0",TEXTURE_WIDTH:d[h].width+".0",TEXTURE_HEIGHT:d[h].height+".0",FIRST:0==h,LAST:h==d.length-1})}this.glShaderConfig.TEXTURES.push({LAYER:c,UNITS:a,USED:0<(this.used_by_ColorFormula&1<<c),USED_ID:0<(this.usedID_by_ColorFormula&1<<c)})}}this.glShaderConfig.TEXTURE_DEFAULTS=[];e=0;for(f=this.textureID_Defaults;e<f.length;)a=f[e],++e,this.glShaderConfig.TEXTURE_DEFAULTS.push({LAYER:a.layer,DEFAULT_VALUE:a.value});this.glShaderConfig.hasTEXTURE_FUNCTIONS=
0==this.usedID_by_ColorFormula&&0==this.textureID_Defaults.length?!1:!0;null!=this.gl&&(this.ready=!1,this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)),this.createProg(),this.buffer.hasPicking()&&this.createProg(!0))},__class__:ac};var Md=function(a,b,c,
e){null==e&&(e=!1);null==c&&(c=!1);this.isMasked=this.hasBackground=!1;this._buffer=new zd(1024,1024,!0);ac.call(this,this._buffer);c&&(this.isMasked=!0,this.maskBuffer=new Kd(16,16,!0),this.maskProgram=new ac(this.maskBuffer),this.maskProgram.mask=2,this.maskProgram.colorEnabled=!1,this.mask=1,this.hasBackground&&(this.backgroundProgram.mask=1));e&&(this.hasBackground=!0,this.backgroundBuffer=new Ld(16,16,!0),this.backgroundProgram=new ac(this.backgroundBuffer),this.isMasked&&(this.backgroundProgram.mask=
1));this.font=a;this.autoUpdateTextures=!1;this.setTexture(a.textureCache,"TEX");this.fontStyle=b;this.alphaEnabled=!0;this.font.config.distancefield?(a=""+m.string(.5),a=-1!=a.indexOf(".")||-1!=a.indexOf("e-")?a:a+".0",this.setColorFormula("mix(bgColor,color,smoothstep( weight - "+a+" * fwidth(TEX.r), weight + "+a+" * fwidth(TEX.r), TEX.r))")):this.setColorFormula("mix(bgColor,color,TEX.r)");this.setFormula("x","x + (1.0-aPosition.y)*width*tilt");this.updateTextures()};n["peote.text.FontProgram__ob_gum_backends_PeoteView_FontStyle"]=
Md;Md.__name__=!0;Md.__super__=ac;Md.prototype=F(ac.prototype,{addToDisplay:function(a,b,c){null==c&&(c=!1);ac.prototype.addToDisplay.call(this,a,b,c);this.isMasked&&this.maskProgram.addToDisplay(a,this,!0);this.hasBackground&&this.backgroundProgram.addToDisplay(a,this,!0)},__class__:Md});var Ee=function(a,b,c,e){null==e&&(e=16384);null==c&&(c=!0);this.rHexToDec=new z('("\\s*)?(0x[0-9a-f]+)(\\s*")?',"gi");this.rComments=new z("//.*?$","gm");this.rParsePathConfig=new z("^(.*?)([^/]+)$","");this.kerning=
!1;if(this.rParsePathConfig.match(a))this.path=this.rParsePathConfig.matched(1),this.jsonFilename=this.rParsePathConfig.matched(2);else throw A.thrown("Can't load font, error in path to jsonfile: \""+a+'"');this.ranges=b;this.kerning=c;this.maxTextureSize=e};n["peote.text.Font__ob_gum_backends_PeoteView_FontStyle"]=Ee;Ee.__name__=!0;Ee.prototype={createFontProgram:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);return new Md(this,a,b,c)},createFontStyle:function(){return new Fe},load:function(a,b,
c){null==c&&(c=!1);var e=this,f=c,h=function(f){f=f.replace(e.rComments.r,"");f=e.rHexToDec.map(f,function(a){return m.string(m.parseInt(a.matched(2)))});var h=new Qa;e.config=h.fromJson(f,e.path+e.jsonFilename);f=0;for(h=h.errors;f<h.length;){var d=h[f];++f;switch(d._hx_index){case 0:var g=d.variable;var l=d.expected;g=d.pos;break;case 1:g=d.pos;break;case 2:g=d.pos;break;case 3:g=d.pos;break;case 4:g=d.pos;break;case 5:g=d.pos;break;case 6:g=d.pos}ka.trace(g.lines[0].number,{fileName:"peote/text/Font.hx",
lineNumber:246,className:"peote.text.Font__ob_gum_backends_PeoteView_FontStyle",methodName:"load"});null!=g&&ka.trace(Le.convertError(d),{fileName:g.file,lineNumber:g.lines[0].number,className:"",methodName:""})}if(e.config.packed)throw f='Error, metadata of FontStyle class has to be "@packed" for "'+e.path+e.jsonFilename+'" and "packed":true',ka.trace(f,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(f);e.kerning&&null!=e.config.kerning&&(e.kerning=e.config.kerning);
if(null==e.ranges&&1<e.config.ranges.length)throw f='Error, set FontStyle to @multiSlot and/or @multiTexture or define a single range while Font creation or inside "'+e.path+e.jsonFilename+'"',ka.trace(f,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(f);d=[];f=0;for(h=e.config.ranges;f<h.length;){var t=h[f];++f;var x=t.range.min,p=t.range.max;if(null!=e.ranges)for(g=0,l=e.ranges;g<l.length;){var B=l[g];++g;if(B.min>=x&&B.min<=p||B.max>=x&&B.max<=p){d.push(t);break}}else d.push(t);
if(1==d.length)break}if(0==d.length)throw f='Error, can not found any ranges inside font-config "'+e.path+e.jsonFilename+'" that fit '+m.string(e.ranges),ka.trace(f,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(f);e.config.ranges=d;e.init(a,b,c)};null==f&&(f=!1);var d=this.path+this.jsonFilename,g=null==h?null:h,x=null==h?null:function(a){h(a.toString())};null==f&&(f=!1);""!=Ja.corsServer&&(new z("^https?://","")).match(d)&&(d="//"+Ja.corsServer+"/"+d);var p=oc.loadFromFile(d);
f&&(ka.trace('Start loading bytes "'+d+'"',{fileName:"utils/Loader.hx",lineNumber:81,className:"utils.Loader",methodName:"bytes"}),p.onProgress(function(a,b){Ja.onProgressDebug(a,b,d)}),p.onError(Ja.onErrorDebug),p.onComplete(function(a){Ja.onCompleteDebug(d)}));if(null!=g)p.onError(g);if(null!=x)p.onComplete(x)},init:function(a,b,c){for(var e=0,f=0,h=0,d=this.config.ranges;h<d.length;){var g=d[h];++h;g.slot.width>e&&(e=g.slot.width);g.slot.height>f&&(f=g.slot.height)}this.textureCache=new Ge(e,f,
this.config.ranges.length,4,!1,1,1,null,this.maxTextureSize);this.loadImages(null,a,b,c)},loadImages:function(a,b,c,e){var f=this,h=this.config.ranges;a=Array(h.length);for(var d=0,g=h.length;d<g;){var m=d++;a[m]=f.path+h[m].image}h=e;var x=function(a,b,e){null!=c&&c(b,e)},p=function(a,b){if(null!=f.config.ranges[a].tiles){var c=f.config.ranges[a].tiles.x;var e=f.config.ranges[a].tiles.y}else if(null!=f.config.tiles)c=f.config.tiles.x,e=f.config.tiles.y;else throw b='Error, can not found tiles inside font-config "'+
f.path+f.jsonFilename+'"',ka.trace(b,{fileName:f.path+f.jsonFilename,lineNumber:0,className:"",methodName:""}),A.thrown(b);if(null!=f.config.ranges[a].line){var h=f.config.ranges[a].line.height/b.height*e;var d=f.config.ranges[a].line.base/b.height*e}else null!=f.config.line?(h=f.config.line.height/b.height*e,d=f.config.line.base/b.height*e):d=h=1;a=f.config.ranges[a].range;f.textureCache.setImage(b,0,c,e);f.rangeMapping={min:a.min,max:a.max,height:h,base:d}},r=function(a){b(f)};null==h&&(h=!1);var B=
a.length;d=0;for(g=a.length;d<g;){m=[d++];var k=[a[m[0]]];e=h;var n=null==x?null:function(a){return function(b,c){null!=x&&x(a[0],b,c)}}(m);m=null==r?null:function(a){return function(c){null!=p&&p(a[0],c);0==--B&&b(f)}}(m);null==e&&(e=!1);""!=Ja.corsServer&&(new z("^https?://","")).match(k[0])&&(k[0]="//"+Ja.corsServer+"/"+k[0]);var v=Ga.loadFromFile(k[0]);e&&(ka.trace('Start loading image "'+k[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),v.onProgress(function(a){return function(b,
c){Ja.onProgressDebug(b,c,a[0])}}(k)),v.onError(Ja.onErrorDebug),v.onComplete(function(a){return function(b){Ja.onCompleteDebug(a[0])}}(k)));if(null!=n)v.onProgress(n);if(null!=m)v.onComplete(m)}},__class__:Ee};var Xe=function(){};n["peote.text.Gl3FontData"]=Xe;Xe.__name__=!0;var ca=function(){this.bytePos=-1;this.weight=this.tilt=this.zIndex=this.width=this.height=this.tile=0;this.bgColor=255;this.color=-1;this.x=this.y=0;this.char=-1};n["peote.text.Glyph__ob_gum_backends_PeoteView_FontStyle"]=ca;
ca.__name__=!0;ca.prototype={__class__:ca};var ya=function(){};n["peote.text.MaskElement"]=ya;ya.__name__=!0;var be=function(a,b){this.min=a;this.max=b};n["peote.text.Range"]=be;be.__name__=!0;be.prototype={__class__:be};var Dc=function(){};n["peote.view.BufferInterface"]=Dc;Dc.__name__=!0;Dc.__isInterface__=!0;Dc.prototype={__class__:Dc};var Ld=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=
a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);Q.isINSTANCED?(null==Aa.instanceBytes&&(Aa.instanceBytes=new Ab(new ArrayBuffer(12)),Aa.instanceBytes.b[0]=1,Aa.instanceBytes.b[1]=1,Aa.instanceBytes.b[2]=1,Aa.instanceBytes.b[3]=1,Aa.instanceBytes.b[4]=0,Aa.instanceBytes.b[5]=1,Aa.instanceBytes.b[6]=1,Aa.instanceBytes.b[7]=0,Aa.instanceBytes.b[8]=0,Aa.instanceBytes.b[9]=
0,Aa.instanceBytes.b[10]=0,Aa.instanceBytes.b[11]=0),this._elemBuffSize=24):this._elemBuffSize=168;this._bytes=new Ab(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};n["peote.view.Buffer_BackgroundElement"]=Ld;Ld.__name__=!0;Ld.__interfaces__=[Dc];Ld.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),Q.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),Q.isVAO&&this._gl.deleteVertexArray(this._glVAO));
this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);Q.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=Aa.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),
a.bindBuffer(a.ARRAY_BUFFER,null));Q.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),Q.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,24,0),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,
24,4),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,24,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,24,16),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,28,0),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,28,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,
!1,28,8),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,28,16),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,28,24)),this._gl.bindVertexArray(null))}},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( 0.0, aRotZ )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- rotZ.y,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color"]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return Aa.DEFAULT_FORMULA_VARS},getFormulas:function(){return Aa.FORMULAS},getAttributes:function(){return Aa.ATTRIBUTES},getFormulaNames:function(){return Aa.FORMULA_NAMES},getFormulaVaryings:function(){return""==Aa.FORMULA_VARYINGS?[]:Aa.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==Aa.FORMULA_CONSTANTS?[]:Aa.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==Aa.FORMULA_CUSTOMS?[]:Aa.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!0},hasPicking:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,4,"aColorStart0");a.bindAttribLocation(b,3,"aRotZ");a.bindAttribLocation(b,1,"aPos");
a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;Q.isINSTANCED?(Q.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,24,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(3),
b.vertexAttribPointer(3,1,b.FLOAT,!1,24,4),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,24,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,24,16),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(Q.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,
!0,28,0),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,28,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,28,8),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,28,16),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,28,24)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));Q.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(4),b.disableVertexAttribArray(3),
b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Ld};var zd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);Q.isINSTANCED?(null==ca.instanceBytes&&
(ca.instanceBytes=new Ab(new ArrayBuffer(12)),ca.instanceBytes.b[0]=1,ca.instanceBytes.b[1]=1,ca.instanceBytes.b[2]=1,ca.instanceBytes.b[3]=1,ca.instanceBytes.b[4]=0,ca.instanceBytes.b[5]=1,ca.instanceBytes.b[6]=1,ca.instanceBytes.b[7]=0,ca.instanceBytes.b[8]=0,ca.instanceBytes.b[9]=0,ca.instanceBytes.b[10]=0,ca.instanceBytes.b[11]=0),this._elemBuffSize=40):this._elemBuffSize=240;this._bytes=new Ab(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};n["peote.view.Buffer_Glyph__ob_gum_backends_PeoteView_FontStyle"]=zd;zd.__name__=!0;zd.__interfaces__=[Dc];zd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),Q.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),Q.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,
0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);Q.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=ca.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));Q.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),Q.isINSTANCED?(a=this._gl,b=this._glBuffer,
a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,40,0),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,4),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,40,8),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),
a.vertexAttribPointer(1,2,a.FLOAT,!1,40,12),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,20),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,28),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,1,a.SHORT,!1,40,36),a.vertexAttribDivisor(7,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,
40,0),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,4),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,40,8),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,12),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,20),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,28),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,1,a.SHORT,!1,40,36),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,
2,a.UNSIGNED_BYTE,!1,40,38)),this._gl.bindVertexArray(null))}},update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(Q.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.color;e.b_Int32[c.bytePos+4>>2]=c.bgColor;e.b_UFloat32[c.bytePos+8>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151));e.b_UFloat32[c.bytePos+12>>2]=c.x;e.b_UFloat32[c.bytePos+16>>2]=c.y;e.b_UFloat32[c.bytePos+20>>2]=c.width;e.b_UFloat32[c.bytePos+24>>2]=c.height;e.b_UFloat32[c.bytePos+28>>2]=c.weight;
e.b_UFloat32[c.bytePos+32>>2]=c.tilt;e.b_Uint16[c.bytePos+36>>1]=c.tile&65535}else c=this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.color,e.b_Int32[c.bytePos+4>>2]=c.bgColor,e.b_UFloat32[c.bytePos+8>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+12>>2]=c.x,e.b_UFloat32[c.bytePos+16>>2]=c.y,e.b_UFloat32[c.bytePos+20>>2]=c.width,e.b_UFloat32[c.bytePos+24>>2]=c.height,e.b_UFloat32[c.bytePos+28>>2]=c.weight,e.b_UFloat32[c.bytePos+32>>2]=c.tilt,e.b_Uint16[c.bytePos+36>>
1]=c.tile&65535,e.b[c.bytePos+38]=1,e.b[c.bytePos+39]=1,e.b_Int32[c.bytePos+40>>2]=c.color,e.b_Int32[c.bytePos+44>>2]=c.bgColor,e.b_UFloat32[c.bytePos+48>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+52>>2]=c.x,e.b_UFloat32[c.bytePos+56>>2]=c.y,e.b_UFloat32[c.bytePos+60>>2]=c.width,e.b_UFloat32[c.bytePos+64>>2]=c.height,e.b_UFloat32[c.bytePos+68>>2]=c.weight,e.b_UFloat32[c.bytePos+72>>2]=c.tilt,e.b_Uint16[c.bytePos+76>>1]=c.tile&65535,e.b[c.bytePos+78]=1,e.b[c.bytePos+79]=1,
e.b_Int32[c.bytePos+80>>2]=c.color,e.b_Int32[c.bytePos+84>>2]=c.bgColor,e.b_UFloat32[c.bytePos+88>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+92>>2]=c.x,e.b_UFloat32[c.bytePos+96>>2]=c.y,e.b_UFloat32[c.bytePos+100>>2]=c.width,e.b_UFloat32[c.bytePos+104>>2]=c.height,e.b_UFloat32[c.bytePos+108>>2]=c.weight,e.b_UFloat32[c.bytePos+112>>2]=c.tilt,e.b_Uint16[c.bytePos+116>>1]=c.tile&65535,e.b[c.bytePos+118]=0,e.b[c.bytePos+119]=1,e.b_Int32[c.bytePos+120>>2]=c.color,e.b_Int32[c.bytePos+
124>>2]=c.bgColor,e.b_UFloat32[c.bytePos+128>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+132>>2]=c.x,e.b_UFloat32[c.bytePos+136>>2]=c.y,e.b_UFloat32[c.bytePos+140>>2]=c.width,e.b_UFloat32[c.bytePos+144>>2]=c.height,e.b_UFloat32[c.bytePos+148>>2]=c.weight,e.b_UFloat32[c.bytePos+152>>2]=c.tilt,e.b_Uint16[c.bytePos+156>>1]=c.tile&65535,e.b[c.bytePos+158]=1,e.b[c.bytePos+159]=0,e.b_Int32[c.bytePos+160>>2]=c.color,e.b_Int32[c.bytePos+164>>2]=c.bgColor,e.b_UFloat32[c.bytePos+168>>
2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+172>>2]=c.x,e.b_UFloat32[c.bytePos+176>>2]=c.y,e.b_UFloat32[c.bytePos+180>>2]=c.width,e.b_UFloat32[c.bytePos+184>>2]=c.height,e.b_UFloat32[c.bytePos+188>>2]=c.weight,e.b_UFloat32[c.bytePos+192>>2]=c.tilt,e.b_Uint16[c.bytePos+196>>1]=c.tile&65535,e.b[c.bytePos+198]=0,e.b[c.bytePos+199]=0,e.b_Int32[c.bytePos+200>>2]=c.color,e.b_Int32[c.bytePos+204>>2]=c.bgColor,e.b_UFloat32[c.bytePos+208>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),
e.b_UFloat32[c.bytePos+212>>2]=c.x,e.b_UFloat32[c.bytePos+216>>2]=c.y,e.b_UFloat32[c.bytePos+220>>2]=c.width,e.b_UFloat32[c.bytePos+224>>2]=c.height,e.b_UFloat32[c.bytePos+228>>2]=c.weight,e.b_UFloat32[c.bytePos+232>>2]=c.tilt,e.b_Uint16[c.bytePos+236>>1]=c.tile&65535,e.b[c.bytePos+238]=0,e.b[c.bytePos+239]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null)},updateElement:function(a){if(Q.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.color;b.b_Int32[a.bytePos+4>>2]=a.bgColor;b.b_UFloat32[a.bytePos+8>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151));b.b_UFloat32[a.bytePos+12>>2]=a.x;b.b_UFloat32[a.bytePos+16>>2]=a.y;b.b_UFloat32[a.bytePos+20>>2]=a.width;b.b_UFloat32[a.bytePos+24>>2]=a.height;b.b_UFloat32[a.bytePos+28>>2]=a.weight;b.b_UFloat32[a.bytePos+32>>2]=a.tilt;b.b_Uint16[a.bytePos+36>>1]=a.tile&65535}else b=this._bytes,b.b_Int32[a.bytePos>>
2]=a.color,b.b_Int32[a.bytePos+4>>2]=a.bgColor,b.b_UFloat32[a.bytePos+8>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+12>>2]=a.x,b.b_UFloat32[a.bytePos+16>>2]=a.y,b.b_UFloat32[a.bytePos+20>>2]=a.width,b.b_UFloat32[a.bytePos+24>>2]=a.height,b.b_UFloat32[a.bytePos+28>>2]=a.weight,b.b_UFloat32[a.bytePos+32>>2]=a.tilt,b.b_Uint16[a.bytePos+36>>1]=a.tile&65535,b.b[a.bytePos+38]=1,b.b[a.bytePos+39]=1,b.b_Int32[a.bytePos+40>>2]=a.color,b.b_Int32[a.bytePos+44>>2]=a.bgColor,b.b_UFloat32[a.bytePos+
48>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+52>>2]=a.x,b.b_UFloat32[a.bytePos+56>>2]=a.y,b.b_UFloat32[a.bytePos+60>>2]=a.width,b.b_UFloat32[a.bytePos+64>>2]=a.height,b.b_UFloat32[a.bytePos+68>>2]=a.weight,b.b_UFloat32[a.bytePos+72>>2]=a.tilt,b.b_Uint16[a.bytePos+76>>1]=a.tile&65535,b.b[a.bytePos+78]=1,b.b[a.bytePos+79]=1,b.b_Int32[a.bytePos+80>>2]=a.color,b.b_Int32[a.bytePos+84>>2]=a.bgColor,b.b_UFloat32[a.bytePos+88>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+
92>>2]=a.x,b.b_UFloat32[a.bytePos+96>>2]=a.y,b.b_UFloat32[a.bytePos+100>>2]=a.width,b.b_UFloat32[a.bytePos+104>>2]=a.height,b.b_UFloat32[a.bytePos+108>>2]=a.weight,b.b_UFloat32[a.bytePos+112>>2]=a.tilt,b.b_Uint16[a.bytePos+116>>1]=a.tile&65535,b.b[a.bytePos+118]=0,b.b[a.bytePos+119]=1,b.b_Int32[a.bytePos+120>>2]=a.color,b.b_Int32[a.bytePos+124>>2]=a.bgColor,b.b_UFloat32[a.bytePos+128>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+132>>2]=a.x,b.b_UFloat32[a.bytePos+136>>2]=a.y,
b.b_UFloat32[a.bytePos+140>>2]=a.width,b.b_UFloat32[a.bytePos+144>>2]=a.height,b.b_UFloat32[a.bytePos+148>>2]=a.weight,b.b_UFloat32[a.bytePos+152>>2]=a.tilt,b.b_Uint16[a.bytePos+156>>1]=a.tile&65535,b.b[a.bytePos+158]=1,b.b[a.bytePos+159]=0,b.b_Int32[a.bytePos+160>>2]=a.color,b.b_Int32[a.bytePos+164>>2]=a.bgColor,b.b_UFloat32[a.bytePos+168>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+172>>2]=a.x,b.b_UFloat32[a.bytePos+176>>2]=a.y,b.b_UFloat32[a.bytePos+180>>2]=a.width,b.b_UFloat32[a.bytePos+
184>>2]=a.height,b.b_UFloat32[a.bytePos+188>>2]=a.weight,b.b_UFloat32[a.bytePos+192>>2]=a.tilt,b.b_Uint16[a.bytePos+196>>1]=a.tile&65535,b.b[a.bytePos+198]=0,b.b[a.bytePos+199]=0,b.b_Int32[a.bytePos+200>>2]=a.color,b.b_Int32[a.bytePos+204>>2]=a.bgColor,b.b_UFloat32[a.bytePos+208>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+212>>2]=a.x,b.b_UFloat32[a.bytePos+216>>2]=a.y,b.b_UFloat32[a.bytePos+220>>2]=a.width,b.b_UFloat32[a.bytePos+224>>2]=a.height,b.b_UFloat32[a.bytePos+228>>
2]=a.weight,b.b_UFloat32[a.bytePos+232>>2]=a.tilt,b.b_Uint16[a.bytePos+236>>1]=a.tile&65535,b.b[a.bytePos+238]=0,b.b[a.bytePos+239]=0;if(-1==a.bytePos)throw A.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw A.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");
var b=this._maxElements+this._growSize,c=new Ab(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var f=this._maxElements;c<f;){var h=c++,d=this._elements[h];e=this._bytes;var g=d.bytePos,m=this._elemBuffSize;null==m&&(m=0);null==g&&(g=0);e=0<m?new Uint8Array(e.b.bufferValue,g,m):new Uint8Array(e.b.bufferValue,g);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),
this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),Q.isVAO&&(this._gl.bindVertexArray(this._glVAO),Q.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,
c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.vertexAttribDivisor(2,
1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.vertexAttribDivisor(7,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.enableVertexAttribArray(1),
b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,38)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;g=a.bytePos;m=this._elemBuffSize;null==m&&(m=0);null==g&&(g=0);
e=0<m?new Uint8Array(e.b.bufferValue,g,m):new Uint8Array(e.b.bufferValue,g);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw A.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t\n\t\n\t::IN:: vec4 aColorStart0;::IN:: vec4 aColorStart1;\n\t\n\t::IN:: vec2 aFloat0;::IN:: float aShort0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;::if isES3::flat ::end::::VAROUT:: vec4 vColor1;\n\t::if isES3::flat ::end::::VAROUT:: vec2 vSize; ::if isES3::flat ::end:: ::VAROUT:: float vPack0;\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VAROUT:: float vTexPack0;\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;vSize = size;\n\t\t\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( 0.0, aRotZ )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; vColor1 = aColorStart1.wzyx; \n\n\t\tvPack0 = ::if FORMULA_VARYINGS.weight::::FORMULA_VARYINGS.weight::::else::aFloat0.x::end::;\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\tvTexPack0 = ::if FORMULA_VARYINGS.tile::::FORMULA_VARYINGS.tile::::else::aShort0::end::;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- rotZ.y,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; ::if isES3::flat ::end::::VARIN:: vec4 vColor1; \n\t::if isES3::flat ::end::::VARIN:: vec2 vSize; ::if isES3::flat ::end:: ::VARIN:: float vPack0;\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VARIN:: float vTexPack0;\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; vec4 c1 = vColor1; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color","bgColor"]},getCustomIdentifiers:function(){return["weight","tilt"]},getCustomVaryings:function(){return["vPack0","null"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return ca.DEFAULT_FORMULA_VARS},getFormulas:function(){return ca.FORMULAS},getAttributes:function(){return ca.ATTRIBUTES},getFormulaNames:function(){return ca.FORMULA_NAMES},getFormulaVaryings:function(){return""==
ca.FORMULA_VARYINGS?[]:ca.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==ca.FORMULA_CONSTANTS?[]:ca.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==ca.FORMULA_CUSTOMS?[]:ca.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!0},hasPicking:function(){return!1},needFragmentPrecision:function(){return!0},bindAttribLocations:function(a,b){a.bindAttribLocation(b,4,"aColorStart0");a.bindAttribLocation(b,
5,"aColorStart1");a.bindAttribLocation(b,3,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,7,"aShort0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;Q.isINSTANCED?(Q.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,
c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.vertexAttribDivisor(2,
1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.vertexAttribDivisor(7,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(Q.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,
4,b.UNSIGNED_BYTE,!0,40,4),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,38)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,
0,6*a));Q.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(4),b.disableVertexAttribArray(5),b.disableVertexAttribArray(3),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),b.disableVertexAttribArray(6),b.disableVertexAttribArray(7));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:zd};var Kd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=
this._glVAO=null;if(0>=a)throw A.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);Q.isINSTANCED?(null==ya.instanceBytes&&(ya.instanceBytes=new Ab(new ArrayBuffer(12)),ya.instanceBytes.b[0]=1,ya.instanceBytes.b[1]=1,ya.instanceBytes.b[2]=1,ya.instanceBytes.b[3]=1,ya.instanceBytes.b[4]=0,ya.instanceBytes.b[5]=1,ya.instanceBytes.b[6]=1,ya.instanceBytes.b[7]=0,ya.instanceBytes.b[8]=
0,ya.instanceBytes.b[9]=0,ya.instanceBytes.b[10]=0,ya.instanceBytes.b[11]=0),this._elemBuffSize=8):this._elemBuffSize=72;this._bytes=new Ab(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};n["peote.view.Buffer_MaskElement"]=Kd;Kd.__name__=!0;Kd.__interfaces__=[Dc];Kd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),Q.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),
Q.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);Q.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=ya.instanceBytes,b=new Uint8Array(b.b.bufferValue,
0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));Q.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),Q.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,8,0),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,8,4),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,12,0),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,12,4),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null))}},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\t\n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t\n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\t\n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return[]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return ya.DEFAULT_FORMULA_VARS},getFormulas:function(){return ya.FORMULAS},getAttributes:function(){return ya.ATTRIBUTES},getFormulaNames:function(){return ya.FORMULA_NAMES},getFormulaVaryings:function(){return""==ya.FORMULA_VARYINGS?[]:ya.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==ya.FORMULA_CONSTANTS?[]:ya.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==ya.FORMULA_CUSTOMS?[]:ya.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,0,"aPosition")},
render:function(a,b,c){a=this._maxElements;Q.isINSTANCED?(Q.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,
0,6,a)):(Q.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));Q.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));
this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Kd};var Vd=function(a,b,c,e,f){null==f&&(f=0);this.renderFramebufferSkipFrames=this.renderFramebufferFrame=0;this._renderFramebufferEnabled=!1;this.framebufferTextureSlot=0;this.peoteView=this.gl=this.fbTexture=null;this.alpha=1;this.red=this.green=this.blue=0;this.backgroundAlpha=this.backgroundDepth=this.backgroundEnabled=!1;this.isVisible=!0;this.xz=this.yz=this.zoom=this.xZoom=this.yZoom=1;this.width=this.height=this.x=this.y=this.xOffset=
this.yOffset=0;if(Q.isUBO){var h=this.uniformBuffer,d=this.gl;null!=d&&(h.uniformBytes.b_UFloat32[0]=a+this.xOffset,d.bindBuffer(d.UNIFORM_BUFFER,h.uniformBuffer),d.bufferSubData(d.UNIFORM_BUFFER,0,h.xOffestBufferPointer),d.bindBuffer(d.UNIFORM_BUFFER,null))}this.x=a;Q.isUBO&&(h=this.uniformBuffer,d=this.gl,null!=d&&(h.uniformBytes.b_UFloat32[1]=b+this.yOffset,d.bindBuffer(d.UNIFORM_BUFFER,h.uniformBuffer),d.bufferSubData(d.UNIFORM_BUFFER,4,h.yOffestBufferPointer),d.bindBuffer(d.UNIFORM_BUFFER,null)));
this.y=b;this.width=c;this.height=e;this.red=(f>>24&255)/255;this.green=(f>>16&255)/255;this.blue=(f>>8&255)/255;this.alpha=(f&255)/255;this.backgroundEnabled=0<this.alpha;this.backgroundAlpha=1>this.alpha;this.programList=new He(new zb);Q.isUBO&&(this.uniformBuffer=new Nd,this.uniformBufferFB=new Nd,this.uniformBufferViewFB=new Od)};n["peote.view.Display"]=Vd;Vd.__name__=!0;Vd.prototype={addToPeoteView:function(a,b,c){null==c&&(c=!1);this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));
a.displayList.add(this,b,c)},setNewGLContext:function(a){if(null!=a&&a!=this.gl){null!=this.gl&&Q.isUBO&&(this.uniformBuffer.deleteGLBuffer(this.gl),this.uniformBufferFB.deleteGLBuffer(this.gl),this.uniformBufferViewFB.deleteGLBuffer(this.gl));this.gl=a;Q.isUBO&&(this.uniformBuffer.createGLBuffer(this.gl,this.x+this.xOffset,this.y+this.yOffset,this.xz,this.yz),this.uniformBufferFB.createGLBuffer(this.gl,this.xOffset,this.yOffset-this.height,this.xz,this.yz),this.uniformBufferViewFB.createGLBuffer(this.gl,
this.width,-this.height,0,0,1,1));for(var b=this.programList.first;null!=b;){var c=b.value;b=b.next;if(null!=a&&a!=c.gl){for(var e=0,f=c.displays;e<f.length;){var h=f[e];++e;if(null!=h.gl&&h.gl!=a)throw A.thrown("Error, program can not used inside different gl-contexts");}null!=c.gl&&(c.gl.deleteShader(c.glVertexShader),c.gl.deleteShader(c.glFragmentShader),c.gl.deleteProgram(c.glProgram),c.buffer.hasPicking()&&(c.gl.deleteShader(c.glVertexShaderPicking),c.gl.deleteShader(c.glFragmentShaderPicking),
c.gl.deleteProgram(c.glProgramPicking)));c.gl=a;Q.isES3&&(c.glShaderConfig.isES3=!0,c.glShaderConfig.IN="in",c.glShaderConfig.VARIN="in",c.glShaderConfig.VAROUT="out");Q.isUBO&&(c.glShaderConfig.isUBO=!0);Q.isINSTANCED&&(c.glShaderConfig.isINSTANCED=!0);c.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=c.gl.getExtension("OES_standard_derivatives")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=c.gl.getExtension("EXT_color_buffer_float")?c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):
null!=c.gl.getExtension("OES_texture_float")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});c.buffer.setNewGLContext(c.gl);c.createProg();c.buffer.hasPicking()&&c.createProg(!0);e=0;for(f=c.activeTextures;e<f.length;){h=f[e];++e;var d=c.gl;if(null!=d&&d!=h.gl){for(var g=0,m=h.programs;g<m.length;){var x=m[g];++g;if(null!=x.gl&&x.gl!=d)throw A.thrown("Error, texture can not used inside different gl-contexts");}x=0;for(g=h.displays;x<g.length;)if(m=g[x],++x,null!=m.gl&&
m.gl!=d)throw A.thrown("Error, texture can not used inside different gl-contexts");null!=h.gl&&(h.gl.deleteTexture(h.glTexture),h.glTexture=null,0==h.displays.length&&null!=h.framebuffer&&(h.gl.deleteFramebuffer(h.framebuffer),h.framebuffer=null,null!=h.glDepthBuffer&&h.gl.deleteRenderbuffer(h.glDepthBuffer),h.glDepthBuffer=null));h.gl=d;if(h.width>h.gl.getParameter(h.gl.MAX_TEXTURE_SIZE)||h.height>h.gl.getParameter(h.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");
h.glTexture=Db.createEmptyTexture(h.gl,h.width,h.height,h.colorChannels,h.createMipmaps,h.magFilter,h.minFilter,h.useFloat);if(0<h.displays.length&&null==h.framebuffer){h.glDepthBuffer=h.gl.createRenderbuffer();d=h.gl;x=h.glTexture;g=h.glDepthBuffer;m=h.width;var p=h.height,r=d.createFramebuffer();d.bindRenderbuffer(d.RENDERBUFFER,g);Oa.clearGlErrorQueue(d);d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT24,m,p);Oa.getLastGlError(d)==d.INVALID_ENUM&&(ka.trace("switching to DEPTH_COMPONENT16 for framebuffer",
{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,m,p));d.bindFramebuffer(d.FRAMEBUFFER,r);d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,g);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,x,0);if(d.checkFramebufferStatus(d.FRAMEBUFFER)!=d.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");d.bindFramebuffer(d.FRAMEBUFFER,
null);d.bindRenderbuffer(d.RENDERBUFFER,null);h.framebuffer=r;h.updated=!0}for(d=h.images.keys();d.hasNext();)x=d.next(),h.bufferImage(x,h.images.h[x.__id__])}}}}if(null!=this.fbTexture&&(b=this.fbTexture,null!=a&&a!=b.gl)){e=0;for(f=b.programs;e<f.length;)if(x=f[e],++e,null!=x.gl&&x.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");e=0;for(f=b.displays;e<f.length;)if(h=f[e],++e,null!=h.gl&&h.gl!=a)throw A.thrown("Error, texture can not used inside different gl-contexts");
null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");b.glTexture=Db.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,
b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();d=b.gl;x=b.glTexture;g=b.glDepthBuffer;m=b.width;p=b.height;r=d.createFramebuffer();d.bindRenderbuffer(d.RENDERBUFFER,g);Oa.clearGlErrorQueue(d);d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT24,m,p);Oa.getLastGlError(d)==d.INVALID_ENUM&&(ka.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",
methodName:"createFramebuffer"}),d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,m,p));d.bindFramebuffer(d.FRAMEBUFFER,r);d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,g);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,x,0);if(d.checkFramebufferStatus(d.FRAMEBUFFER)!=d.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");d.bindFramebuffer(d.FRAMEBUFFER,null);d.bindRenderbuffer(d.RENDERBUFFER,null);b.framebuffer=r;b.updated=
!0}for(d=b.images.keys();d.hasNext();)x=d.next(),b.bufferImage(x,b.images.h[x.__id__])}}},addProgram:function(a,b,c){null==c&&(c=!1);a.addToDisplay(this,b,c)},__class__:Vd};var ef={fromRenderContext:function(a){if(null!=a.webgl2)return ka.trace("WEBGL2 detected.",{fileName:"peote/view/PeoteGL.hx",lineNumber:86,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),Q.isUBO=!0,Q.isINSTANCED=!0,Q.isVAO=!0,Q.isES3=!0,a.webgl2;if(null!=a.webgl)return ka.trace("WEBGL1 detected.",
{fileName:"peote/view/PeoteGL.hx",lineNumber:91,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),a.webgl;window.alert("Error: missing webgl context");return null}},Q=function(){};n["peote.view.Version"]=Q;Q.__name__=!0;var Sa=function(){};n["peote.view.Precision"]=Sa;Sa.__name__=!0;var Ud=function(a,b,c){null==c&&(c=!0);null==b&&(b=255);this.speed=1;this.startTime=this.stopTime=0;this.isRun=!1;this.xOffset=this.yOffset=0;this.xz=this.yz=1;this.maskState=0;this.glStateAlpha=
this.glStateDepth=!1;this.colorState=!0;this.alpha=1;this.red=this.green=this.blue=0;this.gl=ef.fromRenderContext(a.context);this.width=a.__width;this.height=a.__height;this.red=(b>>24&255)/255;this.green=(b>>16&255)/255;this.blue=(b>>8&255)/255;this.alpha=(b&255)/255;Q.isUBO&&(this.uniformBuffer=new Od,this.uniformBuffer.createGLBuffer(this.gl,this.width,this.height,this.xOffset,this.yOffset,this.xz,this.yz));this.maxTextureImageUnits=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS);this.glStateTexture=
b=Array(this.maxTextureImageUnits);b=this.gl;var e=b.VERTEX_SHADER,f=Sa.VertexFloat,h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(f.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(f.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(f.low=h.precision);e=b.VERTEX_SHADER;f=Sa.VertexInt;h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(f.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(f.medium=h.precision);h=b.getShaderPrecisionFormat(e,
b.LOW_FLOAT);null!=h&&(f.low=h.precision);e=b.VERTEX_SHADER;f=Sa.VertexSampler;h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(f.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(f.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(f.low=h.precision);e=b.FRAGMENT_SHADER;f=Sa.FragmentFloat;h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(f.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(f.medium=h.precision);h=
b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(f.low=h.precision);e=b.FRAGMENT_SHADER;f=Sa.FragmentInt;h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(f.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(f.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(f.low=h.precision);e=b.FRAGMENT_SHADER;f=Sa.FragmentSampler;h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(f.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=
h&&(f.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(f.low=h.precision);Q.isINSTANCED?(this.pickInt32=b=new Int32Array(4),this.pickTexture=Db.createPickingTexture(this.gl,!0)):(this.pickUInt8=b=new Uint8Array(4),this.pickTexture=Db.createPickingTexture(this.gl));this.pickDepthBuffer=this.gl.createRenderbuffer();b=this.gl;e=this.pickTexture;f=this.pickDepthBuffer;h=b.createFramebuffer();b.bindRenderbuffer(b.RENDERBUFFER,f);Oa.clearGlErrorQueue(b);b.renderbufferStorage(b.RENDERBUFFER,
b.DEPTH_COMPONENT24,1,1);Oa.getLastGlError(b)==b.INVALID_ENUM&&(ka.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,1,1));b.bindFramebuffer(b.FRAMEBUFFER,h);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,f);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,e,0);if(b.checkFramebufferStatus(b.FRAMEBUFFER)!=
b.FRAMEBUFFER_COMPLETE)throw A.thrown("Error: Framebuffer not complete!");b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindRenderbuffer(b.RENDERBUFFER,null);this.pickFB=h;this.background=new Ie(this.gl);this.displayList=new Pd(new zb);this.framebufferDisplayList=new Pd(new zb);c&&(a.onRender.add(q(this,this.render)),a.onResize.add(q(this,this.resize)))};n["peote.view.PeoteView"]=Ud;Ud.__name__=!0;Ud.prototype={isTextureStateChange:function(a,b){return b.updated?(b.updated=!1,this.glStateTexture=Array(this.maxTextureImageUnits),
this.glStateTexture[a]=b.glTexture,!0):this.glStateTexture[a]!=b.glTexture?(this.glStateTexture[a]=b.glTexture,!0):!1},start:function(){if(!this.isRun){var a=this.stopTime;this.startTime=this.stopTime=(new Date).getTime()/1E3-a;this.isRun=!0}},addDisplay:function(a,b,c){null==c&&(c=!1);a.addToPeoteView(this,b,c)},resize:function(a,b){this.width=a;this.height=b;if(Q.isUBO){var c=this.uniformBuffer,e=this.gl;c.uniformBytes.b_UFloat32[0]=a;c.uniformBytes.b_UFloat32[1]=b;e.bindBuffer(e.UNIFORM_BUFFER,
c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,0,c.resolutionBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}},render:function(a){for(this.displayListItem=this.framebufferDisplayList.first;null!=this.displayListItem;){if(this.displayListItem.value._renderFramebufferEnabled)if(this.displayListItem.value.renderFramebufferFrame==this.displayListItem.value.renderFramebufferSkipFrames){var b=this.displayListItem.value;a=null;null==a&&(a=b.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,
b.fbTexture.framebuffer);this.gl.viewport(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.scissor(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);b.fbTexture.clearOnRenderInto?this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|
this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(b.backgroundEnabled){1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=b.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&
(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=0);this.background.render(b.red,b.green,b.blue,b.alpha)}for(b.programListItem=b.programList.first;null!=b.programListItem;){a=b.programListItem.value;a.gl.useProgram(a.glProgram);for(a.textureListItem=a.textureList.first;null!=a.textureListItem;)this.isTextureStateChange(a.textureListItem.value.unit,a.textureListItem.value.texture)&&(a.gl.activeTexture(a.gl.TEXTURE0+a.textureListItem.value.unit),a.gl.bindTexture(a.gl.TEXTURE_2D,
a.textureListItem.value.texture.glTexture)),a.gl.uniform1i(a.textureListItem.value.uniformLoc,a.textureListItem.value.unit),a.textureListItem=a.textureListItem.next;Q.isUBO?(a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,0,b.uniformBufferViewFB.uniformBuffer),a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,1,b.uniformBufferFB.uniformBuffer)):(a.gl.uniform2f(a.uRESOLUTION,b.width,-b.height),a.gl.uniform2f(a.uZOOM,b.xz,b.yz),a.gl.uniform2f(a.uOFFSET,(b.xOffset+this.xOffset)/b.xz,(b.yOffset+this.yOffset-b.height)/
b.yz));a.gl.uniform1f(a.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(var e=a.uniformFloats.length;c<e;){var f=c++;a.gl.uniform1f(a.uniformFloatLocations[f],a.uniformFloats[f].value)}c=a.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=a.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=a.alphaEnabled)&&
!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=a.mask;e=a.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&
this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);a.buffer.render(this,b,a);a.gl.useProgram(null);b.programListItem=b.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);b.fbTexture.createMipmaps&&(this.gl.bindTexture(this.gl.TEXTURE_2D,b.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null),b.fbTexture.updated=!0);this.displayListItem.value.renderFramebufferFrame=
0}else this.displayListItem.value.renderFramebufferFrame++;this.displayListItem=this.displayListItem.next}b=this.width;c=this.height;this.gl.viewport(0,0,b,c);this.gl.scissor(0,0,b,c);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(this.red,this.green,this.blue,this.alpha);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);for(this.displayListItem=
this.displayList.first;null!=this.displayListItem;){a=this.displayListItem.value;if(a.isVisible){b=this.width;c=this.height;var h=this.xz,d=this.yz;e=Math.floor((a.x+this.xOffset)*h);f=Math.floor((a.y+this.yOffset)*d);h=Math.floor(a.width*h);d=Math.floor(a.height*d);0>e&&(h+=e);e=Math.max(0,Math.min(b,e))|0;h=Math.max(0,Math.min(b-e,h))|0;0>f&&(d+=f);f=Math.max(0,Math.min(c,f))|0;d=Math.max(0,Math.min(c-f,d))|0;this.gl.scissor(e,c-d-f,h,d);a.backgroundEnabled&&(1!=this.colorState&&(this.colorState=
!0,this.gl.colorMask(!0,!0,!0,!0)),(c=a.backgroundDepth)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST)),(c=a.backgroundAlpha)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND)),0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=0),this.background.render(a.red,
a.green,a.blue,a.alpha));for(a.programListItem=a.programList.first;null!=a.programListItem;){b=a.programListItem.value;if(b.isVisible){b.gl.useProgram(b.glProgram);for(b.textureListItem=b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),b.gl.uniform1i(b.textureListItem.value.uniformLoc,
b.textureListItem.value.unit),b.textureListItem=b.textureListItem.next;Q.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,this.uniformBuffer.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,1,a.uniformBuffer.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,this.width,this.height),b.gl.uniform2f(b.uZOOM,this.xz*a.xz,this.yz*a.yz),b.gl.uniform2f(b.uOFFSET,(a.x+a.xOffset+this.xOffset)/a.xz,(a.y+a.yOffset+this.yOffset)/a.yz));b.gl.uniform1f(b.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:
this.stopTime)*this.speed);c=0;for(e=b.uniformFloats.length;c<e;)f=c++,b.gl.uniform1f(b.uniformFloatLocations[f],b.uniformFloats[f].value);c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&
(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),
this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);b.buffer.render(this,a,b);b.gl.useProgram(null)}a.programListItem=a.programListItem.next}}this.displayListItem=this.displayListItem.next}},__class__:Ud};var yd=function(a,b,c){this.unit=a;this.texture=b;this.uniformLoc=c};n["peote.view.ActiveTexture"]=yd;yd.__name__=!0;yd.prototype={__class__:yd};var Ge=function(a,b,c,e,f,h,d,g,m){null==m&&(m=16384);null==g&&(g=!1);null==d&&(d=0);null==h&&(h=0);null==f&&(f=!1);null==e&&(e=4);null==c&&(c=
1);this.displays=[];this.programs=[];this.useFloat=this.updated=!1;this.magFilter=this.minFilter=0;this.createMipmaps=!1;this.images=new zb;this.imageSlots=this.freeSlots=this.slotsX=this.slotsY=this.tilesX=this.tilesY=1;this.width=this.height=0;this.colorChannels=4;this.clearOnRenderInto=!0;this.gl=this.glTexture=this.framebuffer=this.glDepthBuffer=null;this.slotWidth=a;this.slotHeight=b;this.imageSlots=this.freeSlots=c;this.colorChannels=e;this.createMipmaps=f;this.magFilter=d;this.minFilter=h;
this.useFloat=g;a=Db.optimalTextureSize(c,a,b,m);this.width=a.width;this.height=a.height;this.slotsX=a.slotsX;this.slotsY=a.slotsY};n["peote.view.Texture"]=Ge;Ge.__name__=!0;Ge.prototype={setImage:function(a,b,c,e){null==b&&(b=0);if(null!=this.images.h.__keys__[a.__id__])throw A.thrown("Error, image is already inside texture inside slot "+this.images.h[a.__id__].imageSlot);null!=c&&(this.tilesX=c);null!=e&&(this.tilesY=e);this.images.set(a,{imageSlot:b});this.freeSlots--;if(null!=this.gl){if(null==
this.glTexture){if(this.width>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)||this.height>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE))throw A.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");this.glTexture=Db.createEmptyTexture(this.gl,this.width,this.height,this.colorChannels,this.createMipmaps,this.magFilter,this.minFilter,this.useFloat)}this.bufferImage(a,{imageSlot:b})}},bufferImage:function(a,b){var c=this.gl,e=b.imageSlot%this.slotsX*this.slotWidth;b=this.slotHeight*Math.floor(b.imageSlot/
this.slotsX);var f=a.width,h=a.height,d=this.createMipmaps,g=this.useFloat;null==g&&(g=!1);null==d&&(d=!1);c.bindTexture(c.TEXTURE_2D,this.glTexture);if(g){g=f*h*4;g=null!=g?new Float32Array(g):null;for(var m=0,x=f*h*4;m<x;){var p=m++;g[p]=Va.toFloat(a.get_data()[p])/Va.toFloat(255)}c.texSubImage2D(c.TEXTURE_2D,0,e,b,f,h,c.RGBA,c.FLOAT,g)}else c.texSubImage2D(c.TEXTURE_2D,0,e,b,f,h,c.RGBA,c.UNSIGNED_BYTE,a.get_data());d&&c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null);this.updated=
!0},__class__:Ge};var Nd=function(){var a=this.uniformBytes=new Ab(new ArrayBuffer(32)),b=0;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=4;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b)};n["peote.view.UniformBufferDisplay"]=
Nd;Nd.__name__=!0;Nd.prototype={createGLBuffer:function(a,b,c,e,f){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=f;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},__class__:Nd};
var Od=function(){var a=this.uniformBytes=new Ab(new ArrayBuffer(48)),b=0;null==b&&(b=0);this.resolutionBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=16;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=20;null==b&&(b=0);this.yZoomBufferPointer=
a=new Uint8Array(a.b.bufferValue,b)};n["peote.view.UniformBufferView"]=Od;Od.__name__=!0;Od.prototype={createGLBuffer:function(a,b,c,e,f,h,d){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=f;this.uniformBytes.b_UFloat32[4]=h;this.uniformBytes.b_UFloat32[5]=d;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,
b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},__class__:Od};var Se=function(a,b){this.name=a;this.value=b};n["peote.view.UniformFloat"]=Se;Se.__name__=!0;Se.prototype={__class__:Se};var Ie=function(a){this.gl=a;this.createBuffer();this.createProgram()};n["peote.view.utils.Background"]=Ie;Ie.__name__=!0;Ie.prototype={createBuffer:function(){var a=new Ab(new ArrayBuffer(32));a.b_UFloat32[0]=1;a.b_UFloat32[1]=1;a.b_UFloat32[2]=0;
a.b_UFloat32[3]=1;a.b_UFloat32[4]=1;a.b_UFloat32[5]=0;a.b_UFloat32[6]=0;a.b_UFloat32[7]=0;this.buffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);a=new Uint8Array(a.b.bufferValue,0);this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},createProgram:function(){var a="",b=Sa.VertexFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Sa.VertexFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));
b=this.gl;var c=this.gl.VERTEX_SHADER,e=b.createShader(c);b.shaderSource(e,a+"\t\n\t\t\tattribute vec2 aPosition;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_Position = mat4 (\n\t\t\t\t\tvec4(2.0, 0.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, -2.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, 0.0, -1.0, 0.0),\n\t\t\t\t\tvec4(-1.0, 1.0, 0.0, 1.0)\n\t\t\t\t) * vec4 (aPosition, -1.0 ,1.0);\n\t\t\t}\n\t\t");b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?
"vertex":"fragment")+" shader\n"+m.string(b.getShaderInfoLog(e)));var f=e;b=Sa.FragmentFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Sa.FragmentFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));b=this.gl;c=this.gl.FRAGMENT_SHADER;e=b.createShader(c);b.shaderSource(e,a+"\n\t\t\tuniform vec4 uRGBA;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_FragColor = uRGBA;\n\t\t\t\t\n\t\t\t\t// TODO: Fix for old FF\n\t\t\t\tgl_FragColor.w = clamp(uRGBA.w, 0.003, 1.0);\n\t\t\t}\n\t\t");
b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw A.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+m.string(b.getShaderInfoLog(e)));a=e;this.glProgram=this.gl.createProgram();this.gl.attachShader(this.glProgram,f);this.gl.attachShader(this.glProgram,a);this.gl.deleteShader(f);this.gl.deleteShader(a);this.gl.bindAttribLocation(this.glProgram,0,"aPosition");b=this.gl;f=this.glProgram;b.linkProgram(f);if(0==b.getProgramParameter(f,b.LINK_STATUS))throw A.thrown(m.string(b.getProgramInfoLog(f))+
"VALIDATE_STATUS: "+m.string(b.getProgramParameter(f,b.VALIDATE_STATUS))+"ERROR: "+m.string(b.getError()));this.uRGBA=this.gl.getUniformLocation(this.glProgram,"uRGBA")},render:function(a,b,c,e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);this.gl.enableVertexAttribArray(0);this.gl.vertexAttribPointer(0,2,this.gl.FLOAT,!1,8,0);this.gl.useProgram(this.glProgram);this.gl.uniform4f(this.uRGBA,a,b,c,e);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);this.gl.disableVertexAttribArray(0);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
null)},__class__:Ie};var Ab=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b;this.b_UFloat32=new Float32Array(a);this.b_Int32=new Int32Array(a);this.b_Uint16=new Uint16Array(a)};n["peote.view.utils.BufferBytes"]=Ab;Ab.__name__=!0;Ab.prototype={blit:function(a,b,c,e){0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},fill:function(a,b,c){for(var e=0;e<b;)e++,this.b[a++]=c},__class__:Ab};var Oa=function(){};n["peote.view.utils.GLTool"]=
Oa;Oa.__name__=!0;Oa.clearGlErrorQueue=function(a){for(;a.getError()!=a.NO_ERROR;);};Oa.getLastGlError=function(a){var b=a.getError();b!=a.NO_ERROR&&(b==a.INVALID_ENUM?ka.trace("(GL-Error: INVALID_ENUM)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:22,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.INVALID_VALUE?ka.trace("(GL-Error: INVALID_VALUE)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:23,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==
a.INVALID_OPERATION?ka.trace("(GL-Error: INVALID_OPERATION)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:24,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.OUT_OF_MEMORY?ka.trace("(GL-Error: OUT_OF_MEMORY)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:25,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):ka.trace("GL-Error: "+b,{fileName:"peote/view/utils/GLTool.hx",lineNumber:26,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}));return b};
var pc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};n["peote.view.utils.RenderListItem_peote_view_ActiveTexture"]=pc;pc.__name__=!0;pc.prototype={__class__:pc};var qc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};n["peote.view.utils.RenderListItem_peote_view_Display"]=qc;qc.__name__=!0;qc.prototype={__class__:qc};var jc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=
this);null!=c&&(c.prev=this)};n["peote.view.utils.RenderListItem_peote_view_Program"]=jc;jc.__name__=!0;jc.prototype={__class__:jc};var xd=function(a){this.first=this.last=null;this.itemMap=a};n["peote.view.utils.RenderList_peote_view_ActiveTexture"]=xd;xd.__name__=!0;xd.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new pc(a,null,null);else if(null==b)b=this.first=new pc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new pc(a,c.prev,c),c==this.first&&(this.first=
b);else throw A.thrown("Error on add: "+m.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new pc(a,null,null);else if(null==b)b=this.last=new pc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new pc(a,c,c.next),c==this.last&&(this.last=b);else throw A.thrown("Error on add: "+m.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=
c.prev));this.itemMap.set(a,b)},clear:function(){for(;null!=this.first;){null!=this.last.value&&this.itemMap.remove(this.last.value);var a=this.last;a==this.first&&(this.first=a.next);a==this.last&&(this.last=a.prev);null!=a.prev&&(a.prev.next=a.next);null!=a.next&&(a.next.prev=a.prev)}},__class__:xd};var Pd=function(a){this.first=this.last=null;this.itemMap=a};n["peote.view.utils.RenderList_peote_view_Display"]=Pd;Pd.__name__=!0;Pd.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=
this.last=new qc(a,null,null);else if(null==b)b=this.first=new qc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new qc(a,c.prev,c),c==this.first&&(this.first=b);else throw A.thrown("Error on add: "+m.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new qc(a,null,null);else if(null==b)b=this.last=new qc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new qc(a,c,c.next),c==this.last&&(this.last=b);else throw A.thrown("Error on add: "+m.string(b)+" is not in list.");
c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},__class__:Pd};var He=function(a){this.first=this.last=null;this.itemMap=a};n["peote.view.utils.RenderList_peote_view_Program"]=He;He.__name__=!0;He.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new jc(a,null,null);else if(null==b)b=this.first=new jc(a,null,this.first);else if(c=
this.itemMap.get(b),null!=c)b=new jc(a,c.prev,c),c==this.first&&(this.first=b);else throw A.thrown("Error on add: "+m.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new jc(a,null,null);else if(null==b)b=this.last=new jc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new jc(a,c,c.next),c==this.last&&(this.last=b);else throw A.thrown("Error on add: "+m.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&
(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},__class__:He};var Db=function(){};n["peote.view.utils.TexUtils"]=Db;Db.__name__=!0;Db.createEmptyTexture=function(a,b,c,e,f,h,d,g){null==g&&(g=!1);null==d&&(d=0);null==h&&(h=0);null==f&&(f=!1);e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e);Oa.clearGlErrorQueue(a);if(g){g=a.TEXTURE_2D;var l=a.RGBA32F,m=a.RGBA,x=a.FLOAT,p=0;0==p?a.texImage2D(g,0,l,b,c,0,m,x,null):a.texImage2D(g,0,l,b,
c,0,m,x,p);Oa.getLastGlError(a)==a.INVALID_VALUE&&(ka.trace("switching to RGBA16F for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:25,className:"peote.view.utils.TexUtils",methodName:"createEmptyTexture"}),g=a.TEXTURE_2D,l=a.RGBA16F,m=a.RGBA,x=a.FLOAT,p=0,0==p?a.texImage2D(g,0,l,b,c,0,m,x,null):a.texImage2D(g,0,l,b,c,0,m,x,p),Oa.getLastGlError(a)==a.INVALID_VALUE&&(ka.trace("switching to RGBA for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",
lineNumber:28,className:"peote.view.utils.TexUtils",methodName:"createEmptyTexture"}),g=a.TEXTURE_2D,m=l=a.RGBA,x=a.FLOAT,p=0,0==p?a.texImage2D(g,0,l,b,c,0,m,x,null):a.texImage2D(g,0,l,b,c,0,m,x,p)))}else g=a.TEXTURE_2D,m=l=a.RGBA,x=a.UNSIGNED_BYTE,p=0,0==p?a.texImage2D(g,0,l,b,c,0,m,x,null):a.texImage2D(g,0,l,b,c,0,m,x,p);if(Oa.getLastGlError(a)==a.OUT_OF_MEMORY)throw A.thrown("OUT OF GPU MEMORY while texture creation");1==h?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MAG_FILTER,a.NEAREST);if(f)switch(d){case 1:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR);break;case 2:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_NEAREST);break;case 3:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_LINEAR);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST)}else 1==d?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);f&&a.generateMipmap(a.TEXTURE_2D);a.bindTexture(a.TEXTURE_2D,null);return e};Db.createPickingTexture=function(a,b){null==b&&(b=!1);var c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c);if(b){b=a.TEXTURE_2D;var e=a.RGBA32I,f=a.RGBA_INTEGER,h=a.INT,d=0}else b=a.TEXTURE_2D,f=e=a.RGBA,h=a.UNSIGNED_BYTE,d=0;0==d?a.texImage2D(b,0,e,1,1,0,f,h,null):a.texImage2D(b,0,e,1,
1,0,f,h,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null);return c};Db.optimalTextureSize=function(a,b,c,e,f,h){null==f&&(f=!0);h=Math.ceil(Math.log(e)/Math.log(2));for(var d=Math.ceil(Math.log(a*b*c)/Math.log(2)),g,m=1,x=d-1,p=Math.floor(Math.abs(m-x)),B=(1<<h)*(1<<
h),k=!1,n=Math.floor(Math.min(h,d)),v;1<<n>=b;){for(v=Math.floor(Math.min(h,d-n+1));1<<v>=c&&!(Math.floor((1<<n)/b)*Math.floor((1<<v)/c)<a);){g=(1<<n)*(1<<v)-a*b*c;if(0>g)break;g<=B&&(g==B?Math.abs(n-v)<p&&(p=Math.floor(Math.abs(n-v)),m=n,x=v,k=!0):(m=n,x=v,B=g,k=!0));--v}--n}if(k)m=1<<m,x=1<<x;else{if(f)throw A.thrown("Error: max texture-size ("+e+") is to small for "+a+" images ("+b+" x "+c+")");if(b>e||c>e)throw A.thrown("Error: max texture-size ("+e+") is to small for image ("+b+" x "+c+")");
m=x=e}return{width:m,height:x,slotsX:m/b|0,slotsY:x/c|0,imageSlots:(m/b|0)*(x/c|0)}};var $b=function(){};n["peote.view.utils.Util"]=$b;$b.__name__=!0;$b.resolveFormulaCyclic=function(a){for(var b=[],c=a.h,e=Object.keys(c),f=e.length,h=0;h<f;)if(c=e[h++],c=$b.resolveFormulaKey(c,a,b),null!=c.errKey)throw A.thrown(c);c=a.h;b=Object.keys(c);e=b.length;for(f=0;f<e;)c=b[f++],h=a.h[c].replace(/___:::___/g,""),a.h[c]=h};$b.resolveFormulaKey=function(a,b,c,e){null==e&&(e=[a]);null==c&&(c=[]);var f=b.h[a];
if(0<=c.indexOf(a))return{formula:f,errKey:null,errVar:null};for(var h=Object.keys(b.h),d=h.length,g=0;g<d;){var m=h[g++];if(m!=a){var x=new z("(^|.*?[^\\w.])"+m+"\\b.*?","g");if(x.match(f)){if(0<=e.indexOf(m))return{formula:f,errKey:a,errVar:m};m=$b.resolveFormulaKey(m,b,c,e.concat([m]));if(null!=m.errKey)return m;f=f.replace(x.r,"$1(___:::___"+m.formula+"___:::___)")}}}b.h[a]=f;c.push(a);return{formula:f,errKey:null,errVar:null}};$b.resolveFormulaVars=function(a,b){for(var c=a.h,e=Object.keys(c),
f=e.length,h=0;h<f;){var d=e[h++],g=a.h[d];c=b.h;c=Object.keys(c);for(var m=c.length,x=0;x<m;){var p=c[x++],B=new z("(^|.*?[^\\w.])"+p+"\\b.*?","g");B.match(g)&&(g=g.replace(B.r,"$1("+b.h[p]+")"))}a.h[d]=g}};var Xc=function(a,b,c,e,f){this.char=a;this.glyph=b;this.paletteIndexFg=c;this.paletteIndexBg=e;this.bgIntensity=f};n["tyke.GlyphModel"]=Xc;Xc.__name__=!0;Xc.prototype={__class__:Xc};var de=function(a,b){this.numCellsWide=a;this.numCellsHigh=b};n["tyke.GlyphLoopConfig"]=de;de.__name__=!0;de.prototype=
{__class__:de};var bc=function(){};n["tyke.CellWorks"]=bc;bc.__name__=!0;bc.randomise=function(a,b,c,e,f,h){null==h&&(h=!0);null==f&&(f=!0);f&&(c.paletteIndexFg=e.randomIndex());h&&(c.char=ff+Math.ceil(gf*Math.random()))};bc.cyclePalette=function(a,b,c,e){null==c&&(c=0);a.paletteIndexFg=b.cyclePalette(c);bc.cycle++;a.bgIntensity=Math.ceil(255*Math.abs(Math.sin(.01*bc.cycle)))};var Wd=function(a,b){null==b&&(b=-1);this.paletteCycleIndex=this.transparent=0;this.defaultBgIndex=b;this.colors=a};n["tyke.Palette"]=
Wd;Wd.__name__=!0;Wd.prototype={cyclePalette:function(a){null==a&&(a=0);var b=this.paletteCycleIndex;a=this.colors.length-a;this.paletteCycleIndex++;this.paletteCycleIndex>=a&&(this.paletteCycleIndex=0);return b>=this.colors.length?this.colors.length-1:b},randomIndex:function(){return Math.ceil((this.colors.length-1)*Math.random())},setColors:function(a){this.colors=a},colorOrDefault:function(a){return 0>a?this.transparent:this.colors[a]},__class__:Wd};var Xd=function(a){this.sortOrder=[];this.bindings=
new Bb;for(var b=0;b<a.length;){var c=a[b];++b;this._bind(c)}};n["tyke.KeyPresses_tyke_GlyphLoop"]=Xd;Xd.__name__=!0;Xd.prototype={handle:function(a,b){this.lastHandled=a;this.bindings.exists(a)&&this.bindings.get(a).handle(b)},_bind:function(a){this.sortOrder.push(a.code);this.bindings.set(a.code,a)},bind:function(a,b,c,e){this._bind({description:c,label:b,code:a,handle:e})},describe:function(a){return""+a.label+" "+a.description},listBindings:function(){for(var a=[],b=0,c=this.sortOrder;b<c.length;){var e=
c[b];++b;a.push(this.describe(this.bindings.get(e)))}return a},__class__:Xd};var Gc=function(a,b,c,e,f,h){this.numColumns=a;this.numRows=b;this.cellWidth=c;this.cellHeight=e;this.palette=f;this.cellInit=h};n["tyke.LayerConfig"]=Gc;Gc.__name__=!0;Gc.prototype={__class__:Gc};var Je=function(a,b,c){this.font=a;this.fontStyle=b;this.fontProgram=c};n["tyke.Text"]=Je;Je.__name__=!0;Je.prototype={__class__:Je};var Ke=function(){};n["tyke.Glyphs"]=Ke;Ke.__name__=!0;Ke.initText=function(a,b){var c=b.createFontStyle();
c.width=b.config.width;c.height=b.config.height;var e=b.createFontProgram(c);null!=a&&a.addProgram(e);return new Je(b,c,e)};var Yd=function(){this.onMove=function(a,b){};this.onUp=function(a,b,c){ka.trace("mouse up "+a+" "+b+" "+c,{fileName:"tyke/Mouse.hx",lineNumber:11,className:"tyke.Mouse",methodName:"onUp"})};this.onDown=function(a,b,c){ka.trace("mouse down "+a+" "+b+" "+c,{fileName:"tyke/Mouse.hx",lineNumber:7,className:"tyke.Mouse",methodName:"onDown"})}};n["tyke.Mouse"]=Yd;Yd.__name__=!0;Yd.prototype=
{__class__:Yd};var Ac=function(){};n["tyke.Sixteen"]=Ac;Ac.__name__=!0;var Ja=function(){};n["utils.Loader"]=Ja;Ja.__name__=!0;Ja.onProgressDebug=function(a,b,c){ka.trace("...loading "+a+"/"+b+' of "'+c+'"',{fileName:"utils/Loader.hx",lineNumber:11,className:"utils.Loader",methodName:"onProgressDebug"})};Ja.onErrorDebug=function(a){ka.trace("Error - "+a,{fileName:"utils/Loader.hx",lineNumber:15,className:"utils.Loader",methodName:"onErrorDebug"})};Ja.onCompleteDebug=function(a){ka.trace('Loading complete "'+
a+'"',{fileName:"utils/Loader.hx",lineNumber:19,className:"utils.Loader",methodName:"onCompleteDebug"})};var Ub=p["utils._MultipassTemplate.TemplateExpr"]={__ename__:!0,__constructs__:null,OpVar:(g=function(a){return{_hx_index:0,v:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:d}},g._hx_name="OpVar",g.__params__=["v"],g),OpExpr:(g=function(a){return{_hx_index:1,expr:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:d}},g._hx_name="OpExpr",g.__params__=["expr"],g),OpIf:(g=function(a,
b,c){return{_hx_index:2,expr:a,eif:b,eelse:c,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:d}},g._hx_name="OpIf",g.__params__=["expr","eif","eelse"],g),OpStr:(g=function(a){return{_hx_index:3,str:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:d}},g._hx_name="OpStr",g.__params__=["str"],g),OpBlock:(g=function(a){return{_hx_index:4,l:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:d}},g._hx_name="OpBlock",g.__params__=["l"],g),OpForeach:(g=function(a,b){return{_hx_index:5,
expr:a,loop:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:d}},g._hx_name="OpForeach",g.__params__=["expr","loop"],g),OpMacro:(g=function(a,b){return{_hx_index:6,name:a,params:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:d}},g._hx_name="OpMacro",g.__params__=["name","params"],g)};Ub.__constructs__=[Ub.OpVar,Ub.OpExpr,Ub.OpIf,Ub.OpStr,Ub.OpBlock,Ub.OpForeach,Ub.OpMacro];var wa=function(a){a=this.parseTokens(a);this.expr=this.parseBlock(a);if(!a.isEmpty())throw A.thrown("Unexpected '"+
m.string(a.first().s)+"'");};n["utils.MultipassTemplate"]=wa;wa.__name__=!0;wa.prototype={execute:function(a,b){this.macros=null==b?{}:b;this.context=a;this.stack=new ub;this.buf=new na;this.run(this.expr);return this.buf.b},resolve:function(a){if("__current__"==a)return this.context;var b=H.getProperty(this.context,a);if(null!=b||Object.prototype.hasOwnProperty.call(this.context,a))return b;for(var c=this.stack.h;null!=c;){b=c.item;c=c.next;var e=b;b=H.getProperty(e,a);if(null!=b||Object.prototype.hasOwnProperty.call(e,
a))return b}if(!Object.prototype.hasOwnProperty.call(wa.globals,a))throw A.thrown(a);return H.field(wa.globals,a)},parseTokens:function(a){for(var b=new ub;wa.splitter.match(a);){var c=wa.splitter.matchedPos();0<c.pos&&b.add({p:G.substr(a,0,c.pos),s:!0,l:null});if(58==G.cca(a,c.pos))b.add({p:G.substr(a,c.pos+2,c.len-4),s:!1,l:null}),a=wa.splitter.matchedRight();else{c=c.pos+c.len;for(var e=1,f=[],h="";;){var d=G.cca(a,c);++c;if(40==d)++e;else if(41==d){if(--e,0>=e)break}else if(null==d)throw A.thrown("Unclosed macro parenthesis");
44==d&&1==e?(f.push(h),h=""):h+=String.fromCodePoint(d)}f.push(h);b.add({p:wa.splitter.matched(2),s:!1,l:f});a=G.substr(a,c,a.length-c)}}0<a.length&&b.add({p:a,s:!0,l:null});return b},parseBlock:function(a){for(var b=new ub;;){var c=a.first();if(null==c)break;if(!c.s&&("end"==c.p||"else"==c.p||"elseif "==G.substr(c.p,0,7)))break;b.add(this.parse(a))}return 1==b.length?b.first():Ub.OpBlock(b)},parse:function(a){var b=a.pop(),c=b.p;if(b.s)return Ub.OpStr(c);if(null!=b.l){a=new ub;var e=0;for(b=b.l;e<
b.length;){var f=b[e];++e;a.add(this.parseBlock(this.parseTokens(f)))}return Ub.OpMacro(c,a)}if("if "==G.substr(c,0,3)){c=G.substr(c,3,c.length-3);e=null;try{e=this.parseExpr(c)}catch(h){ma.lastError=h;b=A.caught(h).unwrap();if("string"==typeof b)throw ka.trace(b,{fileName:"utils/MultipassTemplate.hx",lineNumber:211,className:"utils.MultipassTemplate",methodName:"parse"}),A.thrown(b);throw h;}c=this.parseBlock(a);b=a.first();if(null==b)throw A.thrown("Unclosed 'if'");if("end"==b.p)a.pop(),f=null;
else if("else"==b.p){if(a.pop(),f=this.parseBlock(a),b=a.pop(),null==b||"end"!=b.p)throw A.thrown("Unclosed 'else'");}else b.p=G.substr(b.p,4,b.p.length-4),f=this.parse(a);return Ub.OpIf(e,c,f)}if("foreach "==G.substr(c,0,8)){c=G.substr(c,8,c.length-8);e=this.parseExpr(c);c=this.parseBlock(a);b=a.pop();if(null==b||"end"!=b.p)throw A.thrown("Unclosed 'foreach'");return Ub.OpForeach(e,c)}return wa.expr_splitter.match(c)?Ub.OpExpr(this.parseExpr(c)):Ub.OpVar(c)},parseExpr:function(a){for(var b=new ub,
c=a;wa.expr_splitter.match(a);){var e=wa.expr_splitter.matchedPos();0!=e.pos&&b.add({p:G.substr(a,0,e.pos),s:!0});a=wa.expr_splitter.matched(0);b.add({p:a,s:0<=a.indexOf('"')});a=wa.expr_splitter.matchedRight()}0!=a.length&&b.add({p:a,s:!0});try{var f=this.makeExpr(b);if(!b.isEmpty())throw A.thrown(b.first().p);}catch(h){ma.lastError=h;b=A.caught(h).unwrap();if("string"==typeof b)throw A.thrown("Unexpected '"+b+"' in "+c);throw h;}return function(){try{return f()}catch(t){ma.lastError=t;var a=A.caught(t).unwrap();
throw A.thrown({v:a,expr:c});}}},makeConst:function(a){wa.expr_trim.match(a);a=wa.expr_trim.matched(1);if(34==G.cca(a,0)){var b=G.substr(a,1,a.length-2);return function(){return b}}if(wa.expr_int.match(a)){var c=m.parseInt(a);return function(){return c}}if(wa.expr_float.match(a)){var e=parseFloat(a);return function(){return e}}var f=this;return function(){return f.resolve(a)}},makePath:function(a,b){var c=b.first();if(null==c||"."!=c.p)return a;b.pop();c=b.pop();if(null==c||!c.s)throw A.thrown(c.p);
var e=c.p;wa.expr_trim.match(e);e=wa.expr_trim.matched(1);return this.makePath(function(){return H.field(a(),e)},b)},makeExpr:function(a){return this.makePath(this.makeExpr2(a),a)},makeExpr2:function(a){var b=a.pop();if(null==b)throw A.thrown("<eof>");if(b.s)return this.makeConst(b.p);switch(b.p){case "!":var c=this.makeExpr(a);return function(){var a=c();return null!=a?0==a:!0};case "(":var e=this.makeExpr(a);b=a.pop();if(null==b||b.s)throw A.thrown(b);if(")"==b.p)return e;var f=this.makeExpr(a);
a=a.pop();if(null==a||")"!=a.p)throw A.thrown(a);switch(b.p){case "!=":return function(){return e()!=f()};case "&&":return function(){return e()&&f()};case "*":return function(){return e()*f()};case "+":return function(){return e()+f()};case "-":return function(){return e()-f()};case "/":return function(){return e()/f()};case "<":return function(){return e()<f()};case "<=":return function(){return e()<=f()};case "==":return function(){return e()==f()};case ">":return function(){return e()>f()};case ">=":return function(){return e()>=
f()};case "||":return function(){return e()||f()};default:throw A.thrown("Unknown operation "+b.p);}case "-":var h=this.makeExpr(a);return function(){return-h()}}throw A.thrown(b.p);},run:function(a){switch(a._hx_index){case 0:var b=a.v;try{var c=this.buf,e=m.string(this.resolve(b));c.b+=m.string(e)}catch(rc){ma.lastError=rc,this.buf.b+=m.string("::"+b+"::")}break;case 1:var f=a.expr;try{c=this.buf,e=m.string(f()),c.b+=m.string(e)}catch(rc){ma.lastError=rc,b=A.caught(rc).unwrap(),this.buf.b+=m.string("::("+
m.string(b.expr)+")::")}break;case 2:f=a.expr;e=a.eif;c=a.eelse;try{b=f(),null==b||0==b?null!=c&&this.run(c):this.run(e)}catch(rc){ma.lastError=rc,b=A.caught(rc).unwrap(),this.buf.b+=m.string("::if "+m.string(b.expr)+"::"),this.run(e),null!=c&&(this.buf.b+="::else::",this.run(c)),this.buf.b+="::end::"}break;case 3:b=a.str;this.buf.b+=null==b?"null":""+b;break;case 4:for(a=a.l.h;null!=a;){var h=a.item;a=a.next;f=h;this.run(f)}break;case 5:f=a.expr;c=a.loop;try{b=f();try{e=y(b);if(null==e.hasNext)throw A.thrown(null);
b=e}catch(rc){ma.lastError=rc;try{if(null==b.hasNext)throw A.thrown(null);}catch(J){throw A.thrown("Cannot iter on "+m.string(b));}}for(this.stack.push(this.context);b.hasNext();)this.context=b.next(),this.run(c);this.context=this.stack.pop()}catch(rc){ma.lastError=rc,b=A.caught(rc).unwrap(),this.buf.b+=m.string("::foreach "+m.string(b.v)+"::"),this.run(c),this.buf.b+="::end::"}break;case 6:f=a.name;a=a.params;b=H.field(this.macros,f);var d=[],g=this.buf;d.push(q(this,this.resolve));for(a=a.h;null!=
a;)h=a.item,a=a.next,0==h._hx_index?(h=h.v,d.push(this.resolve(h))):(this.buf=new na,this.run(h),d.push(this.buf.b));this.buf=g;try{c=this.buf,e=m.string(b.apply(this.macros,d)),c.b+=m.string(e)}catch(rc){ma.lastError=rc;a=A.caught(rc).unwrap();try{var x=d.join(",")}catch(J){x="???"}b="Macro call "+f+"("+x+") failed ("+m.string(a)+")";throw A.thrown(b);}}},__class__:wa};u.$haxeUID|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(G.now=performance.now.bind(performance));n.Math=
Math;null==String.fromCodePoint&&(String.fromCodePoint=function(a){return 65536>a?String.fromCharCode(a):String.fromCharCode((a>>10)+55232)+String.fromCharCode((a&1023)+56320)});String.prototype.__class__=n.String=String;String.__name__=!0;n.Array=Array;Array.__name__=!0;Date.prototype.__class__=n.Date=Date;Date.__name__="Date";var af={},Ze={},$e=Number,Ye=Boolean,bf={},cf={};zb.count=0;ja.__toStr={}.toString;var Ve=new Uint32Array(256);Tb.__alpha16=Ve;for(var Ec=0;256>Ec;){var Wc=Ec++;Tb.__alpha16[Wc]=
Math.ceil(257.00392156862745*Wc)}Ve=new Uint8Array(511);Tb.__clamp=Ve;for(Ec=0;255>Ec;)Wc=Ec++,Tb.__clamp[Wc]=Wc;for(Ec=255;511>Ec;)Wc=Ec++,Tb.__clamp[Wc]=255;za.level=3;"undefined"==typeof console&&(console={});null==console.log&&(console.log=function(){});Ha.default_mass=-1;Ha.minimum_mass=1E-4;Ha.ids=0;Ea.qr=[];Ea.sqr=[];oa.cached_listeners=new qb;oa.cached_collisions=[];oa.cached_body=new Ha({mass:1});Fb.pool=new vc(Fb);tc.global=new tc(null,null,null,null,null);uc.pool=new Ad(uc);wc.pool=new fd(wc);
xb.pool=new gd(xb);Lb.pool=new Bd(Lb);Cb.pool=new Hc(Cb);ab.pool=new hd(ab);Gb.pool=new Pc(Gb);cb.pool=new Ic(cb);Na.pool=new id(Na);va.norm=new M(0,0);va.closest=new M(0,0);tb.DEFAULT_RESOLVER=new Ed;tb.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";ib.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1];ib.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];ib.DIST_EXTRA_BITS_TBL=[0,0,
0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1];ib.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];ib.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];V.activeRequests=0;V.requestLimit=17;V.requestQueue=new ub;$c.windowID=0;lc.DICTIONARY="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");lc.EXTENDED_DICTIONARY=function(a){a=[];for(var b=0,c=lc.DICTIONARY;b<
c.length;){var e=c[b];++b;for(var f=0,h=lc.DICTIONARY;f<h.length;){var d=h[f];++f;a.push(e+d)}}return a}(this);kc.sensorByID=new Bb;kc.sensors=[];Pa.devices=new Bb;Pa.onConnect=new ze;fb.devices=new Bb;fb.onConnect=new Ae;Eb.onCancel=new mc;Eb.onEnd=new mc;Eb.onMove=new mc;Eb.onStart=new mc;aa.cache=new De;aa.onChange=new Ta;aa.bundlePaths=new W;aa.libraries=new W;aa.libraryPaths=new W;za.throwErrors=!0;Aa.FORMULAS=new W;Aa.ATTRIBUTES=function(a){a=new W;a.h.zStart="aRotZ";a.h.zEnd="aRotZ";a.h.z=
"aRotZ";a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);Aa.FORMULA_NAMES=function(a){a=new W;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.zIndex="z";return a}(this);Aa.FORMULA_VARYINGS="";Aa.FORMULA_CONSTANTS="";Aa.FORMULA_CUSTOMS="";Aa.DEFAULT_FORMULA_VARS=new W;ca.__meta__={fields:{x:{posX:null},y:{posY:null},
color:{color:null},bgColor:{color:null},weight:{custom:null,varying:null},tilt:{custom:null},zIndex:{zIndex:null},width:{sizeX:null,varying:null},height:{sizeY:null},tile:{texTile:null}}};ca.FORMULAS=new W;ca.ATTRIBUTES=function(a){a=new W;a.h.zIndexStart="aRotZ";a.h.zIndexEnd="aRotZ";a.h.zIndex="aRotZ";a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.widthStart="aSize.x";a.h.widthEnd="aSize.x";a.h.width="aSize.x";a.h.weightStart="aFloat0.x";
a.h.weightEnd="aFloat0.x";a.h.weight="aFloat0.x";a.h.tiltStart="aFloat0.y";a.h.tiltEnd="aFloat0.y";a.h.tilt="aFloat0.y";a.h.tileStart="aShort0";a.h.tileEnd="aShort0";a.h.tile="aShort0";a.h.heightStart="aSize.y";a.h.heightEnd="aSize.y";a.h.height="aSize.y";return a}(this);ca.FORMULA_NAMES=function(a){a=new W;a.h.sizeX="width";a.h.sizeY="height";a.h.posX="x";a.h.posY="y";a.h.zIndex="zIndex";return a}(this);ca.FORMULA_VARYINGS="weight,tile";ca.FORMULA_CONSTANTS="";ca.FORMULA_CUSTOMS="tilt";ca.DEFAULT_FORMULA_VARS=
new W;ya.FORMULAS=new W;ya.ATTRIBUTES=function(a){a=new W;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);ya.FORMULA_NAMES=function(a){a=new W;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";return a}(this);ya.FORMULA_VARYINGS="";ya.FORMULA_CONSTANTS="";ya.FORMULA_CUSTOMS="";ya.DEFAULT_FORMULA_VARS=new W;Q.isES3=
!1;Q.isUBO=!1;Q.isINSTANCED=!1;Q.isVAO=!1;Sa.VertexFloat={high:0,medium:0,low:0};Sa.VertexInt={high:0,medium:0,low:0};Sa.VertexSampler={high:0,medium:0,low:0};Sa.FragmentFloat={high:0,medium:0,low:0};Sa.FragmentInt={high:0,medium:0,low:0};Sa.FragmentSampler={high:0,medium:0,low:0};Oa.rEmptylines=new z("([ \t]*\r?\n)+","g");Oa.rStartspaces=new z("^([ \t]*\r?\n)+","g");bc.cycle=0;var ff=32,gf=96;Ac.Versitle=[789263,11485010,6240601,3025207,9460890,14126402,9656635,9278124,13926320,14540112,7714118,
4877746,15977364,15724777,10999514,5677512];Ac.Soldier=[16776666,15848094,11897966,7031361,3875874,6707539,10722679,15457388,14258237,10965293,7022375,3873571,1511181,1978151,5333837,10336876];Ac.VanillaMilkshake=[2631726,7100017,14272703,16351876,11577828,11324644,11789274,16689892,8890505,11594643,15332765,16770758,14590859,16761732,16775072,16775140];Ja.corsServer="";wa.splitter=new z('(::[A-Za-z0-9_ ()&|!+=/><*."-]+::|\\$\\$([A-Za-z0-9_-]+)\\()',"");wa.expr_splitter=new z('(\\(|\\)|[ \r\n\t]*"[^"]*"[ \r\n\t]*|[!+=/><*.&|-]+)',
"");wa.expr_trim=new z("^[ ]*([^ ]+)[ ]*$","");wa.expr_int=new z("^[0-9]+$","");wa.expr_float=new z("^([+-]?)(?=\\d|,\\d)\\d*(,\\d*)?([Ee]([+-]?\\d+))?$","");wa.globals={};w.main()})("undefined"!=typeof k?k:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof y?y:"undefined"!=typeof self?self:this)};E.lime.embed=function(u){var y={},w=E.lime.$scripts[u];if(!w)throw Error('Cannot find project name "'+u+'"');w(y,k);for(var z in y)E[z]=
E[z]||y[z];(w=y.lime||window.lime)&&w.embed&&this!=w.embed&&w.embed.apply(w,arguments);return y};"function"==typeof define&&define.amd&&(define([],function(){return E.lime}),define.__amd=define.amd,define.amd=null)})("undefined"!=typeof exports?exports:"function"==typeof define&&define.amd?{}:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
!function(){var E=function(){this.init()};E.prototype={init:function(){var d=this||k;return d._counter=1E3,d._html5AudioPool=[],d.html5PoolSize=10,d._codecs={},d._howls=[],d._muted=!1,d._volume=1,d._canPlayEvent="canplaythrough",d._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,d.masterGain=null,d.noAudio=!1,d.usingWebAudio=!0,d.autoSuspend=!0,d.ctx=null,d.autoUnlock=!0,d._setup(),d},volume:function(d){var p=this||k;if(d=parseFloat(d),p.ctx||n(),void 0!==d&&0<=d&&1>=
d){if(p._volume=d,p._muted)return p;p.usingWebAudio&&p.masterGain.gain.setValueAtTime(d,k.ctx.currentTime);for(var g=0;g<p._howls.length;g++)if(!p._howls[g]._webAudio)for(var q=p._howls[g]._getSoundIds(),u=0;u<q.length;u++){var w=p._howls[g]._soundById(q[u]);w&&w._node&&(w._node.volume=w._volume*d)}return p}return p._volume},mute:function(d){var p=this||k;p.ctx||n();p._muted=d;p.usingWebAudio&&p.masterGain.gain.setValueAtTime(d?0:p._volume,k.ctx.currentTime);for(var g=0;g<p._howls.length;g++)if(!p._howls[g]._webAudio)for(var q=
p._howls[g]._getSoundIds(),u=0;u<q.length;u++){var w=p._howls[g]._soundById(q[u]);w&&w._node&&(w._node.muted=!!d||w._muted)}return p},unload:function(){for(var d=this||k,p=d._howls.length-1;0<=p;p--)d._howls[p].unload();return d.usingWebAudio&&d.ctx&&void 0!==d.ctx.close&&(d.ctx.close(),d.ctx=null,n()),d},codecs:function(d){return(this||k)._codecs[d.replace(/^x-/,"")]},_setup:function(){var d=this||k;if(d.state=d.ctx?d.ctx.state||"suspended":"suspended",d._autoSuspend(),!d.usingWebAudio)if("undefined"!=
typeof Audio)try{var p=new Audio;void 0===p.oncanplaythrough&&(d._canPlayEvent="canplay")}catch(g){d.noAudio=!0}else d.noAudio=!0;try{p=new Audio,p.muted&&(d.noAudio=!0)}catch(g){}return d.noAudio||d._setupCodecs(),d},_setupCodecs:function(){var d=this||k,p=null;try{p="undefined"!=typeof Audio?new Audio:null}catch(O){return d}if(!p||"function"!=typeof p.canPlayType)return d;var g=p.canPlayType("audio/mpeg;").replace(/^no$/,""),n=d._navigator&&d._navigator.userAgent.match(/OPR\/([0-6].)/g);n=n&&33>
parseInt(n[0].split("/")[1],10);return d._codecs={mp3:!(n||!g&&!p.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!g,opus:!!p.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!p.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!p.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!p.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!p.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!p.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(p.canPlayType("audio/x-m4a;")||
p.canPlayType("audio/m4a;")||p.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(p.canPlayType("audio/x-mp4;")||p.canPlayType("audio/mp4;")||p.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!p.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!p.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!p.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(p.canPlayType("audio/x-flac;")||p.canPlayType("audio/flac;")).replace(/^no$/,"")},d},_unlockAudio:function(){var d=
this||k,p=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome|Safari/i.test(d._navigator&&d._navigator.userAgent);if(!d._audioUnlocked&&d.ctx&&p){d._audioUnlocked=!1;d.autoUnlock=!1;d._mobileUnloaded||44100===d.ctx.sampleRate||(d._mobileUnloaded=!0,d.unload());d._scratchBuffer=d.ctx.createBuffer(1,1,22050);var g=function(p){for(p=0;p<d.html5PoolSize;p++){var n=new Audio;n._unlocked=!0;d._releaseHtml5Audio(n)}for(p=0;p<d._howls.length;p++)if(!d._howls[p]._webAudio){n=d._howls[p]._getSoundIds();
for(var k=0;k<n.length;k++){var q=d._howls[p]._soundById(n[k]);q&&q._node&&!q._node._unlocked&&(q._node._unlocked=!0,q._node.load())}}d._autoResume();var u=d.ctx.createBufferSource();u.buffer=d._scratchBuffer;u.connect(d.ctx.destination);void 0===u.start?u.noteOn(0):u.start(0);"function"==typeof d.ctx.resume&&d.ctx.resume();u.onended=function(){u.disconnect(0);d._audioUnlocked=!0;document.removeEventListener("touchstart",g,!0);document.removeEventListener("touchend",g,!0);document.removeEventListener("click",
g,!0);for(var p=0;p<d._howls.length;p++)d._howls[p]._emit("unlock")}};return document.addEventListener("touchstart",g,!0),document.addEventListener("touchend",g,!0),document.addEventListener("click",g,!0),d}},_obtainHtml5Audio:function(){var d=this||k;if(d._html5AudioPool.length)return d._html5AudioPool.pop();d=(new Audio).play();return d&&"undefined"!=typeof Promise&&(d instanceof Promise||"function"==typeof d.then)&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),
new Audio},_releaseHtml5Audio:function(d){var p=this||k;return d._unlocked&&p._html5AudioPool.push(d),p},_autoSuspend:function(){var d=this;if(d.autoSuspend&&d.ctx&&void 0!==d.ctx.suspend&&k.usingWebAudio){for(var p=0;p<d._howls.length;p++)if(d._howls[p]._webAudio)for(var g=0;g<d._howls[p]._sounds.length;g++)if(!d._howls[p]._sounds[g]._paused)return d;return d._suspendTimer&&clearTimeout(d._suspendTimer),d._suspendTimer=setTimeout(function(){d.autoSuspend&&(d._suspendTimer=null,d.state="suspending",
d.ctx.suspend().then(function(){d.state="suspended";d._resumeAfterSuspend&&(delete d._resumeAfterSuspend,d._autoResume())}))},3E4),d}},_autoResume:function(){var d=this;if(d.ctx&&void 0!==d.ctx.resume&&k.usingWebAudio)return"running"===d.state&&d._suspendTimer?(clearTimeout(d._suspendTimer),d._suspendTimer=null):"suspended"===d.state?(d.ctx.resume().then(function(){d.state="running";for(var p=0;p<d._howls.length;p++)d._howls[p]._emit("resume")}),d._suspendTimer&&(clearTimeout(d._suspendTimer),d._suspendTimer=
null)):"suspending"===d.state&&(d._resumeAfterSuspend=!0),d}};var k=new E,u=function(d){if(!d.src||0===d.src.length)return void console.error("An array of source files must be passed with any new Howl.");this.init(d)};u.prototype={init:function(d){var p=this;return k.ctx||n(),p._autoplay=d.autoplay||!1,p._format="string"!=typeof d.format?d.format:[d.format],p._html5=d.html5||!1,p._muted=d.mute||!1,p._loop=d.loop||!1,p._pool=d.pool||5,p._preload="boolean"!=typeof d.preload||d.preload,p._rate=d.rate||
1,p._sprite=d.sprite||{},p._src="string"!=typeof d.src?d.src:[d.src],p._volume=void 0!==d.volume?d.volume:1,p._xhrWithCredentials=d.xhrWithCredentials||!1,p._duration=0,p._state="unloaded",p._sounds=[],p._endTimers={},p._queue=[],p._playLock=!1,p._onend=d.onend?[{fn:d.onend}]:[],p._onfade=d.onfade?[{fn:d.onfade}]:[],p._onload=d.onload?[{fn:d.onload}]:[],p._onloaderror=d.onloaderror?[{fn:d.onloaderror}]:[],p._onplayerror=d.onplayerror?[{fn:d.onplayerror}]:[],p._onpause=d.onpause?[{fn:d.onpause}]:[],
p._onplay=d.onplay?[{fn:d.onplay}]:[],p._onstop=d.onstop?[{fn:d.onstop}]:[],p._onmute=d.onmute?[{fn:d.onmute}]:[],p._onvolume=d.onvolume?[{fn:d.onvolume}]:[],p._onrate=d.onrate?[{fn:d.onrate}]:[],p._onseek=d.onseek?[{fn:d.onseek}]:[],p._onunlock=d.onunlock?[{fn:d.onunlock}]:[],p._onresume=[],p._webAudio=k.usingWebAudio&&!p._html5,void 0!==k.ctx&&k.ctx&&k.autoUnlock&&k._unlockAudio(),k._howls.push(p),p._autoplay&&p._queue.push({event:"play",action:function(){p.play()}}),p._preload&&p.load(),p},load:function(){var d=
null;if(k.noAudio)return void this._emit("loaderror",null,"No audio support.");"string"==typeof this._src&&(this._src=[this._src]);for(var p=0;p<this._src.length;p++){var g;if(this._format&&this._format[p])var n=this._format[p];else{if("string"!=typeof(g=this._src[p])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(g))||(n=/\.([^.]+)$/.exec(g.split("?",1)[0]));n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),
n&&k.codecs(n)){d=this._src[p];break}}return d?(this._src=d,this._state="loading","https:"===window.location.protocol&&"http:"===d.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new y(this),this._webAudio&&z(this),this):void this._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(d,p){var g=this,n=null;if("number"==typeof d)n=d,d=null;else{if("string"==typeof d&&"loaded"===g._state&&!g._sprite[d])return null;if(void 0===d&&(d="__default",!g._playLock)){for(var q=
0,u=0;u<g._sounds.length;u++)g._sounds[u]._paused&&!g._sounds[u]._ended&&(q++,n=g._sounds[u]._id);1===q?d=null:n=null}}var w=n?g._soundById(n):g._inactiveSound();if(!w)return null;if(n&&!d&&(d=w._sprite||"__default"),"loaded"!==g._state){w._sprite=d;w._ended=!1;var F=w._id;return g._queue.push({event:"play",action:function(){g.play(F)}}),F}if(n&&!w._paused)return p||g._loadQueue("play"),w._id;g._webAudio&&k._autoResume();var y=Math.max(0,0<w._seek?w._seek:g._sprite[d][0]/1E3),z=Math.max(0,(g._sprite[d][0]+
g._sprite[d][1])/1E3-y),E=1E3*z/Math.abs(w._rate),N=g._sprite[d][0]/1E3,ea=(g._sprite[d][0]+g._sprite[d][1])/1E3,Ca=!(!w._loop&&!g._sprite[d][2]);w._sprite=d;w._ended=!1;var K=function(){w._paused=!1;w._seek=y;w._start=N;w._stop=ea;w._loop=Ca};if(y>=ea)return void g._ended(w);var T=w._node;if(g._webAudio)n=function(){g._playLock=!1;K();g._refreshBuffer(w);T.gain.setValueAtTime(w._muted||g._muted?0:w._volume,k.ctx.currentTime);w._playStart=k.ctx.currentTime;void 0===T.bufferSource.start?w._loop?T.bufferSource.noteGrainOn(0,
y,86400):T.bufferSource.noteGrainOn(0,y,z):w._loop?T.bufferSource.start(0,y,86400):T.bufferSource.start(0,y,z);E!==1/0&&(g._endTimers[w._id]=setTimeout(g._ended.bind(g,w),E));p||setTimeout(function(){g._emit("play",w._id);g._loadQueue()},0)},"running"===k.state?n():(g._playLock=!0,g.once("resume",n),g._clearTimer(w._id));else{var qa=function(){T.currentTime=y;T.muted=w._muted||g._muted||k._muted||T.muted;T.volume=w._volume*k.volume();T.playbackRate=w._rate;try{var n=T.play();if(n&&"undefined"!=typeof Promise&&
(n instanceof Promise||"function"==typeof n.then)?(g._playLock=!0,K(),n.then(function(){g._playLock=!1;T._unlocked=!0;p||(g._emit("play",w._id),g._loadQueue())}).catch(function(){g._playLock=!1;g._emit("playerror",w._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");w._ended=!0;w._paused=!0})):p||(g._playLock=!1,K(),g._emit("play",w._id),g._loadQueue()),T.playbackRate=w._rate,T.paused)return void g._emit("playerror",
w._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==d||w._loop?g._endTimers[w._id]=setTimeout(g._ended.bind(g,w),E):(g._endTimers[w._id]=function(){g._ended(w);T.removeEventListener("ended",g._endTimers[w._id],!1)},T.addEventListener("ended",g._endTimers[w._id],!1))}catch(L){g._emit("playerror",w._id,L)}};n=window&&window.ejecta||!T.readyState&&k._navigator.isCocoonJS;if(3<=T.readyState||
n)qa();else{g._playLock=!0;var P=function(){qa();T.removeEventListener(k._canPlayEvent,P,!1)};T.addEventListener(k._canPlayEvent,P,!1);g._clearTimer(w._id)}}return w._id},pause:function(d,p){var g=this;if("loaded"!==g._state||g._playLock)return g._queue.push({event:"pause",action:function(){g.pause(d)}}),g;for(var n=g._getSoundIds(d),k=0;k<n.length;k++){g._clearTimer(n[k]);var q=g._soundById(n[k]);if(q&&!q._paused&&(q._seek=g.seek(n[k]),q._rateSeek=0,q._paused=!0,g._stopFade(n[k]),q._node))if(g._webAudio){if(!q._node.bufferSource)continue;
void 0===q._node.bufferSource.stop?q._node.bufferSource.noteOff(0):q._node.bufferSource.stop(0);g._cleanBuffer(q._node)}else isNaN(q._node.duration)&&q._node.duration!==1/0||q._node.pause();p||g._emit("pause",q?q._id:null)}return g},stop:function(d,p){var g=this;if("loaded"!==g._state||g._playLock)return g._queue.push({event:"stop",action:function(){g.stop(d)}}),g;for(var n=g._getSoundIds(d),k=0;k<n.length;k++){g._clearTimer(n[k]);var q=g._soundById(n[k]);q&&(q._seek=q._start||0,q._rateSeek=0,q._paused=
!0,q._ended=!0,g._stopFade(n[k]),q._node&&(g._webAudio?q._node.bufferSource&&(void 0===q._node.bufferSource.stop?q._node.bufferSource.noteOff(0):q._node.bufferSource.stop(0),g._cleanBuffer(q._node)):isNaN(q._node.duration)&&q._node.duration!==1/0||(q._node.currentTime=q._start||0,q._node.pause())),p||g._emit("stop",q._id))}return g},mute:function(d,p){var g=this;if("loaded"!==g._state||g._playLock)return g._queue.push({event:"mute",action:function(){g.mute(d,p)}}),g;if(void 0===p){if("boolean"!=typeof d)return g._muted;
g._muted=d}for(var n=g._getSoundIds(p),q=0;q<n.length;q++){var u=g._soundById(n[q]);u&&(u._muted=d,u._interval&&g._stopFade(u._id),g._webAudio&&u._node?u._node.gain.setValueAtTime(d?0:u._volume,k.ctx.currentTime):u._node&&(u._node.muted=!!k._muted||d),g._emit("mute",u._id))}return g},volume:function(){var d,p,g=this,n=arguments;if(0===n.length)return g._volume;1===n.length||2===n.length&&void 0===n[1]?0<=g._getSoundIds().indexOf(n[0])?p=parseInt(n[0],10):d=parseFloat(n[0]):2<=n.length&&(d=parseFloat(n[0]),
p=parseInt(n[1],10));var q;if(!(void 0!==d&&0<=d&&1>=d))return q=p?g._soundById(p):g._sounds[0],q?q._volume:0;if("loaded"!==g._state||g._playLock)return g._queue.push({event:"volume",action:function(){g.volume.apply(g,n)}}),g;void 0===p&&(g._volume=d);p=g._getSoundIds(p);for(var u=0;u<p.length;u++)(q=g._soundById(p[u]))&&(q._volume=d,n[2]||g._stopFade(p[u]),g._webAudio&&q._node&&!q._muted?q._node.gain.setValueAtTime(d,k.ctx.currentTime):q._node&&!q._muted&&(q._node.volume=d*k.volume()),g._emit("volume",
q._id));return g},fade:function(d,p,g,n){var q=this;if("loaded"!==q._state||q._playLock)return q._queue.push({event:"fade",action:function(){q.fade(d,p,g,n)}}),q;d=parseFloat(d);p=parseFloat(p);g=parseFloat(g);q.volume(d,n);for(var u=q._getSoundIds(n),w=0;w<u.length;w++){var F=q._soundById(u[w]);if(F){if(n||q._stopFade(u[w]),q._webAudio&&!F._muted){var y=k.ctx.currentTime,z=y+g/1E3;F._volume=d;F._node.gain.setValueAtTime(d,y);F._node.gain.linearRampToValueAtTime(p,z)}q._startFadeInterval(F,d,p,g,
u[w],void 0===n)}}return q},_startFadeInterval:function(d,p,g,n,k,q){var u=this,w=p,F=g-p;k=Math.abs(F/.01);k=Math.max(4,0<k?n/k:n);var y=Date.now();d._fadeTo=g;d._interval=setInterval(function(){var k=(Date.now()-y)/n;y=Date.now();w+=F*k;w=Math.max(0,w);w=Math.min(1,w);w=Math.round(100*w)/100;u._webAudio?d._volume=w:u.volume(w,d._id,!0);q&&(u._volume=w);(g<p&&w<=g||g>p&&w>=g)&&(clearInterval(d._interval),d._interval=null,d._fadeTo=null,u.volume(g,d._id),u._emit("fade",d._id))},k)},_stopFade:function(d){var p=
this._soundById(d);return p&&p._interval&&(this._webAudio&&p._node.gain.cancelScheduledValues(k.ctx.currentTime),clearInterval(p._interval),p._interval=null,this.volume(p._fadeTo,d),p._fadeTo=null,this._emit("fade",d)),this},loop:function(){var d,p,g,n=arguments;if(0===n.length)return this._loop;if(1===n.length){if("boolean"!=typeof n[0])return!!(g=this._soundById(parseInt(n[0],10)))&&g._loop;this._loop=d=n[0]}else 2===n.length&&(d=n[0],p=parseInt(n[1],10));p=this._getSoundIds(p);for(n=0;n<p.length;n++)(g=
this._soundById(p[n]))&&(g._loop=d,this._webAudio&&g._node&&g._node.bufferSource&&(g._node.bufferSource.loop=d,d&&(g._node.bufferSource.loopStart=g._start||0,g._node.bufferSource.loopEnd=g._stop)));return this},rate:function(){var d,p,g=this,n=arguments;0===n.length?p=g._sounds[0]._id:1===n.length?0<=g._getSoundIds().indexOf(n[0])?p=parseInt(n[0],10):d=parseFloat(n[0]):2===n.length&&(d=parseFloat(n[0]),p=parseInt(n[1],10));var q;if("number"!=typeof d)return q=g._soundById(p),q?q._rate:g._rate;if("loaded"!==
g._state||g._playLock)return g._queue.push({event:"rate",action:function(){g.rate.apply(g,n)}}),g;void 0===p&&(g._rate=d);p=g._getSoundIds(p);for(var u=0;u<p.length;u++)if(q=g._soundById(p[u])){g.playing(p[u])&&(q._rateSeek=g.seek(p[u]),q._playStart=g._webAudio?k.ctx.currentTime:q._playStart);q._rate=d;g._webAudio&&q._node&&q._node.bufferSource?q._node.bufferSource.playbackRate.setValueAtTime(d,k.ctx.currentTime):q._node&&(q._node.playbackRate=d);var w=g.seek(p[u]);w=1E3*((g._sprite[q._sprite][0]+
g._sprite[q._sprite][1])/1E3-w)/Math.abs(q._rate);!g._endTimers[p[u]]&&q._paused||(g._clearTimer(p[u]),g._endTimers[p[u]]=setTimeout(g._ended.bind(g,q),w));g._emit("rate",q._id)}return g},seek:function(){var d,p,g=this,n=arguments;0===n.length?p=g._sounds[0]._id:1===n.length?0<=g._getSoundIds().indexOf(n[0])?p=parseInt(n[0],10):g._sounds.length&&(p=g._sounds[0]._id,d=parseFloat(n[0])):2===n.length&&(d=parseFloat(n[0]),p=parseInt(n[1],10));if(void 0===p)return g;if("loaded"!==g._state||g._playLock)return g._queue.push({event:"seek",
action:function(){g.seek.apply(g,n)}}),g;var q=g._soundById(p);if(q){if(!("number"==typeof d&&0<=d))return g._webAudio?(d=g.playing(p)?k.ctx.currentTime-q._playStart:0,q._seek+((q._rateSeek?q._rateSeek-q._seek:0)+d*Math.abs(q._rate))):q._node.currentTime;var u=g.playing(p);u&&g.pause(p,!0);q._seek=d;q._ended=!1;g._clearTimer(p);g._webAudio||!q._node||isNaN(q._node.duration)||(q._node.currentTime=d);var w=function(){g._emit("seek",p);u&&g.play(p,!0)};if(u&&!g._webAudio){var F=function(){g._playLock?
setTimeout(F,0):w()};setTimeout(F,0)}else w()}return g},playing:function(d){if("number"==typeof d)return d=this._soundById(d),!!d&&!d._paused;for(d=0;d<this._sounds.length;d++)if(!this._sounds[d]._paused)return!0;return!1},duration:function(d){var p=this._duration;d=this._soundById(d);return d&&(p=this._sprite[d._sprite][1]/1E3),p},state:function(){return this._state},unload:function(){for(var d=this._sounds,p=0;p<d.length;p++)(d[p]._paused||this.stop(d[p]._id),this._webAudio)||(/MSIE |Trident\//.test(k._navigator&&
k._navigator.userAgent)||(d[p]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),d[p]._node.removeEventListener("error",d[p]._errorFn,!1),d[p]._node.removeEventListener(k._canPlayEvent,d[p]._loadFn,!1),k._releaseHtml5Audio(d[p]._node)),delete d[p]._node,this._clearTimer(d[p]._id);p=k._howls.indexOf(this);0<=p&&k._howls.splice(p,1);d=!0;for(p=0;p<k._howls.length;p++)if(k._howls[p]._src===this._src||0<=this._src.indexOf(k._howls[p]._src)){d=!1;break}return w&&
d&&delete w[this._src],k.noAudio=!1,this._state="unloaded",this._sounds=[],null},on:function(d,p,g,n){d=this["_on"+d];return"function"==typeof p&&d.push(n?{id:g,fn:p,once:n}:{id:g,fn:p}),this},off:function(d,p,g){var n=this["_on"+d];if("number"==typeof p&&(g=p,p=null),p||g)for(d=0;d<n.length;d++){var k=g===n[d].id;if(p===n[d].fn&&k||!p&&k){n.splice(d,1);break}}else if(d)this["_on"+d]=[];else for(p=Object.keys(this),d=0;d<p.length;d++)0===p[d].indexOf("_on")&&Array.isArray(this[p[d]])&&(this[p[d]]=
[]);return this},once:function(d,p,g){return this.on(d,p,g,1),this},_emit:function(d,p,g){for(var n=this["_on"+d],k=n.length-1;0<=k;k--)n[k].id&&n[k].id!==p&&"load"!==d||(setTimeout(function(d){d.call(this,p,g)}.bind(this,n[k].fn),0),n[k].once&&this.off(d,n[k].fn,n[k].id));return this._loadQueue(d),this},_loadQueue:function(d){if(0<this._queue.length){var p=this._queue[0];p.event===d&&(this._queue.shift(),this._loadQueue());d||p.action()}return this},_ended:function(d){var p=d._sprite;if(!this._webAudio&&
d._node&&!d._node.paused&&!d._node.ended&&d._node.currentTime<d._stop)return setTimeout(this._ended.bind(this,d),100),this;p=!(!d._loop&&!this._sprite[p][2]);if(this._emit("end",d._id),!this._webAudio&&p&&this.stop(d._id,!0).play(d._id),this._webAudio&&p){this._emit("play",d._id);d._seek=d._start||0;d._rateSeek=0;d._playStart=k.ctx.currentTime;var g=1E3*(d._stop-d._start)/Math.abs(d._rate);this._endTimers[d._id]=setTimeout(this._ended.bind(this,d),g)}return this._webAudio&&!p&&(d._paused=!0,d._ended=
!0,d._seek=d._start||0,d._rateSeek=0,this._clearTimer(d._id),this._cleanBuffer(d._node),k._autoSuspend()),this._webAudio||p||this.stop(d._id,!0),this},_clearTimer:function(d){if(this._endTimers[d]){if("function"!=typeof this._endTimers[d])clearTimeout(this._endTimers[d]);else{var p=this._soundById(d);p&&p._node&&p._node.removeEventListener("ended",this._endTimers[d],!1)}delete this._endTimers[d]}return this},_soundById:function(d){for(var p=0;p<this._sounds.length;p++)if(d===this._sounds[p]._id)return this._sounds[p];
return null},_inactiveSound:function(){this._drain();for(var d=0;d<this._sounds.length;d++)if(this._sounds[d]._ended)return this._sounds[d].reset();return new y(this)},_drain:function(){var d=this._pool,p=0,g;if(!(this._sounds.length<d)){for(g=0;g<this._sounds.length;g++)this._sounds[g]._ended&&p++;for(g=this._sounds.length-1;0<=g&&!(p<=d);g--)this._sounds[g]._ended&&(this._webAudio&&this._sounds[g]._node&&this._sounds[g]._node.disconnect(0),this._sounds.splice(g,1),p--)}},_getSoundIds:function(d){if(void 0===
d){d=[];for(var p=0;p<this._sounds.length;p++)d.push(this._sounds[p]._id);return d}return[d]},_refreshBuffer:function(d){return d._node.bufferSource=k.ctx.createBufferSource(),d._node.bufferSource.buffer=w[this._src],d._panner?d._node.bufferSource.connect(d._panner):d._node.bufferSource.connect(d._node),d._node.bufferSource.loop=d._loop,d._loop&&(d._node.bufferSource.loopStart=d._start||0,d._node.bufferSource.loopEnd=d._stop||0),d._node.bufferSource.playbackRate.setValueAtTime(d._rate,k.ctx.currentTime),
this},_cleanBuffer:function(d){var p=k._navigator&&0<=k._navigator.vendor.indexOf("Apple");if(k._scratchBuffer&&d.bufferSource&&(d.bufferSource.onended=null,d.bufferSource.disconnect(0),p))try{d.bufferSource.buffer=k._scratchBuffer}catch(g){}return d.bufferSource=null,this}};var y=function(d){this._parent=d;this.init()};y.prototype={init:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._paused=!0,this._ended=!0,
this._sprite="__default",this._id=++k._counter,d._sounds.push(this),this.create(),this},create:function(){var d=this._parent,p=k._muted||this._muted||this._parent._muted?0:this._volume;return d._webAudio?(this._node=void 0===k.ctx.createGain?k.ctx.createGainNode():k.ctx.createGain(),this._node.gain.setValueAtTime(p,k.ctx.currentTime),this._node.paused=!0,this._node.connect(k.masterGain)):(this._node=k._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",
this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(k._canPlayEvent,this._loadFn,!1),this._node.src=d._src,this._node.preload="auto",this._node.volume=p*k.volume(),this._node.load()),this},reset:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++k._counter,this},_errorListener:function(){this._parent._emit("loaderror",
this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var d=this._parent;d._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue());this._node.removeEventListener(k._canPlayEvent,this._loadFn,!1)}};var w={},z=function(d){var p=d._src;if(w[p])return d._duration=w[p].duration,void q(d);
if(/^data:[^;]+;base64,/.test(p)){for(var g=atob(p.split(",")[1]),n=new Uint8Array(g.length),k=0;k<g.length;++k)n[k]=g.charCodeAt(k);N(n.buffer,d)}else{var u=new XMLHttpRequest;u.open("GET",p,!0);u.withCredentials=d._xhrWithCredentials;u.responseType="arraybuffer";u.onload=function(){var g=(u.status+"")[0];if("0"!==g&&"2"!==g&&"3"!==g)return void d._emit("loaderror",null,"Failed loading audio file with status: "+u.status+".");N(u.response,d)};u.onerror=function(){d._webAudio&&(d._html5=!0,d._webAudio=
!1,d._sounds=[],delete w[p],d.load())};F(u)}},F=function(d){try{d.send()}catch(p){d.onerror()}},N=function(d,p){var g=function(){p._emit("loaderror",null,"Decoding audio data failed.")},n=function(d){d&&0<p._sounds.length?(w[p._src]=d,q(p,d)):g()};"undefined"!=typeof Promise&&1===k.ctx.decodeAudioData.length?k.ctx.decodeAudioData(d).then(n).catch(g):k.ctx.decodeAudioData(d,n,g)},q=function(d,p){p&&!d._duration&&(d._duration=p.duration);0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*
d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue())},n=function(){if(k.usingWebAudio){try{"undefined"!=typeof AudioContext?k.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?k.ctx=new webkitAudioContext:k.usingWebAudio=!1}catch(g){k.usingWebAudio=!1}k.ctx||(k.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(k._navigator&&k._navigator.platform),p=k._navigator&&k._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);p=p?parseInt(p[1],10):null;d&&p&&9>p&&(d=
/safari/.test(k._navigator&&k._navigator.userAgent.toLowerCase()),(k._navigator&&k._navigator.standalone&&!d||k._navigator&&!k._navigator.standalone&&!d)&&(k.usingWebAudio=!1));k.usingWebAudio&&(k.masterGain=void 0===k.ctx.createGain?k.ctx.createGainNode():k.ctx.createGain(),k.masterGain.gain.setValueAtTime(k._muted?0:1,k.ctx.currentTime),k.masterGain.connect(k.ctx.destination));k._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:k,Howl:u}});"undefined"!=typeof exports&&
(exports.Howler=k,exports.Howl=u);"undefined"!=typeof window?(window.HowlerGlobal=E,window.Howler=k,window.Howl=u,window.Sound=y):"undefined"!=typeof global&&(global.HowlerGlobal=E,global.Howler=k,global.Howl=u,global.Sound=y)}();
!function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(k){if(!this.ctx||!this.ctx.listener)return this;for(var u=this._howls.length-1;0<=u;u--)this._howls[u].stereo(k);return this};HowlerGlobal.prototype.pos=function(k,u,y){return this.ctx&&this.ctx.listener?(u="number"!=typeof u?this._pos[1]:u,y="number"!=typeof y?this._pos[2]:y,"number"!=typeof k?this._pos:(this._pos=[k,u,y],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],
Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this};HowlerGlobal.prototype.orientation=function(k,u,y,w,z,F){if(!this.ctx||!this.ctx.listener)return this;var E=this._orientation;return u="number"!=typeof u?E[1]:u,y="number"!=typeof y?E[2]:y,w="number"!=typeof w?E[3]:w,z="number"!=
typeof z?E[4]:z,F="number"!=typeof F?E[5]:F,"number"!=typeof k?E:(this._orientation=[k,u,y,w,z,F],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(k,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(u,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(y,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(k,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(u,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(y,
Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(k,u,y,w,z,F),this)};Howl.prototype.init=function(k){return function(u){return this._orientation=u.orientation||[1,0,0],this._stereo=u.stereo||null,this._pos=u.pos||null,this._pannerAttr={coneInnerAngle:void 0!==u.coneInnerAngle?u.coneInnerAngle:360,coneOuterAngle:void 0!==u.coneOuterAngle?u.coneOuterAngle:360,coneOuterGain:void 0!==u.coneOuterGain?u.coneOuterGain:0,distanceModel:void 0!==u.distanceModel?u.distanceModel:"inverse",maxDistance:void 0!==
u.maxDistance?u.maxDistance:1E4,panningModel:void 0!==u.panningModel?u.panningModel:"HRTF",refDistance:void 0!==u.refDistance?u.refDistance:1,rolloffFactor:void 0!==u.rolloffFactor?u.rolloffFactor:1},this._onstereo=u.onstereo?[{fn:u.onstereo}]:[],this._onpos=u.onpos?[{fn:u.onpos}]:[],this._onorientation=u.onorientation?[{fn:u.onorientation}]:[],k.call(this,u)}}(Howl.prototype.init);Howl.prototype.stereo=function(k,u){var y=this;if(!y._webAudio)return y;if("loaded"!==y._state)return y._queue.push({event:"stereo",
action:function(){y.stereo(k,u)}}),y;var w=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===u){if("number"!=typeof k)return y._stereo;y._stereo=k;y._pos=[k,0,0]}for(var z=y._getSoundIds(u),F=0;F<z.length;F++){var N=y._soundById(z[F]);if(N){if("number"!=typeof k)return N._stereo;N._stereo=k;N._pos=[k,0,0];N._node&&(N._pannerAttr.panningModel="equalpower",N._panner&&N._panner.pan||E(N,w),"spatial"===w?void 0!==N._panner.positionX?(N._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),
N._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),N._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):N._panner.setPosition(k,0,0):N._panner.pan.setValueAtTime(k,Howler.ctx.currentTime));y._emit("stereo",N._id)}}return y};Howl.prototype.pos=function(k,u,y,w){var z=this;if(!z._webAudio)return z;if("loaded"!==z._state)return z._queue.push({event:"pos",action:function(){z.pos(k,u,y,w)}}),z;if(u="number"!=typeof u?0:u,y="number"!=typeof y?-.5:y,void 0===w){if("number"!=typeof k)return z._pos;
z._pos=[k,u,y]}for(var F=z._getSoundIds(w),N=0;N<F.length;N++){var q=z._soundById(F[N]);if(q){if("number"!=typeof k)return q._pos;q._pos=[k,u,y];q._node&&(q._panner&&!q._panner.pan||E(q,"spatial"),void 0!==q._panner.positionX?(q._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),q._panner.positionY.setValueAtTime(u,Howler.ctx.currentTime),q._panner.positionZ.setValueAtTime(y,Howler.ctx.currentTime)):q._panner.setPosition(k,u,y));z._emit("pos",q._id)}}return z};Howl.prototype.orientation=function(k,
u,y,w){var z=this;if(!z._webAudio)return z;if("loaded"!==z._state)return z._queue.push({event:"orientation",action:function(){z.orientation(k,u,y,w)}}),z;if(u="number"!=typeof u?z._orientation[1]:u,y="number"!=typeof y?z._orientation[2]:y,void 0===w){if("number"!=typeof k)return z._orientation;z._orientation=[k,u,y]}for(var F=z._getSoundIds(w),N=0;N<F.length;N++){var q=z._soundById(F[N]);if(q){if("number"!=typeof k)return q._orientation;q._orientation=[k,u,y];q._node&&(q._panner||(q._pos||(q._pos=
z._pos||[0,0,-.5]),E(q,"spatial")),void 0!==q._panner.orientationX?(q._panner.orientationX.setValueAtTime(k,Howler.ctx.currentTime),q._panner.orientationY.setValueAtTime(u,Howler.ctx.currentTime),q._panner.orientationZ.setValueAtTime(y,Howler.ctx.currentTime)):q._panner.setOrientation(k,u,y));z._emit("orientation",q._id)}}return z};Howl.prototype.pannerAttr=function(){var k,u,y=arguments;if(!this._webAudio)return this;if(0===y.length)return this._pannerAttr;if(1===y.length){if("object"!=typeof y[0])return u=
this._soundById(parseInt(y[0],10)),u?u._pannerAttr:this._pannerAttr;var w=y[0];void 0===k&&(w.pannerAttr||(w.pannerAttr={coneInnerAngle:w.coneInnerAngle,coneOuterAngle:w.coneOuterAngle,coneOuterGain:w.coneOuterGain,distanceModel:w.distanceModel,maxDistance:w.maxDistance,refDistance:w.refDistance,rolloffFactor:w.rolloffFactor,panningModel:w.panningModel}),this._pannerAttr={coneInnerAngle:void 0!==w.pannerAttr.coneInnerAngle?w.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:void 0!==w.pannerAttr.coneOuterAngle?
w.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:void 0!==w.pannerAttr.coneOuterGain?w.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:void 0!==w.pannerAttr.distanceModel?w.pannerAttr.distanceModel:this._distanceModel,maxDistance:void 0!==w.pannerAttr.maxDistance?w.pannerAttr.maxDistance:this._maxDistance,refDistance:void 0!==w.pannerAttr.refDistance?w.pannerAttr.refDistance:this._refDistance,rolloffFactor:void 0!==w.pannerAttr.rolloffFactor?w.pannerAttr.rolloffFactor:this._rolloffFactor,
panningModel:void 0!==w.pannerAttr.panningModel?w.pannerAttr.panningModel:this._panningModel})}else 2===y.length&&(w=y[0],k=parseInt(y[1],10));k=this._getSoundIds(k);for(y=0;y<k.length;y++)if(u=this._soundById(k[y])){var z=u._pannerAttr;z={coneInnerAngle:void 0!==w.coneInnerAngle?w.coneInnerAngle:z.coneInnerAngle,coneOuterAngle:void 0!==w.coneOuterAngle?w.coneOuterAngle:z.coneOuterAngle,coneOuterGain:void 0!==w.coneOuterGain?w.coneOuterGain:z.coneOuterGain,distanceModel:void 0!==w.distanceModel?w.distanceModel:
z.distanceModel,maxDistance:void 0!==w.maxDistance?w.maxDistance:z.maxDistance,refDistance:void 0!==w.refDistance?w.refDistance:z.refDistance,rolloffFactor:void 0!==w.rolloffFactor?w.rolloffFactor:z.rolloffFactor,panningModel:void 0!==w.panningModel?w.panningModel:z.panningModel};var F=u._panner;F?(F.coneInnerAngle=z.coneInnerAngle,F.coneOuterAngle=z.coneOuterAngle,F.coneOuterGain=z.coneOuterGain,F.distanceModel=z.distanceModel,F.maxDistance=z.maxDistance,F.refDistance=z.refDistance,F.rolloffFactor=
z.rolloffFactor,F.panningModel=z.panningModel):(u._pos||(u._pos=this._pos||[0,0,-.5]),E(u,"spatial"))}return this};Sound.prototype.init=function(k){return function(){var u=this._parent;this._orientation=u._orientation;this._stereo=u._stereo;this._pos=u._pos;this._pannerAttr=u._pannerAttr;k.call(this);this._stereo?u.stereo(this._stereo):this._pos&&u.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init);Sound.prototype.reset=function(k){return function(){var u=this._parent;return this._orientation=
u._orientation,this._stereo=u._stereo,this._pos=u._pos,this._pannerAttr=u._pannerAttr,this._stereo?u.stereo(this._stereo):this._pos?u.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,u._refreshBuffer(this)),k.call(this)}}(Sound.prototype.reset);var E=function(k,u){"spatial"===(u||"spatial")?(k._panner=Howler.ctx.createPanner(),k._panner.coneInnerAngle=k._pannerAttr.coneInnerAngle,k._panner.coneOuterAngle=k._pannerAttr.coneOuterAngle,
k._panner.coneOuterGain=k._pannerAttr.coneOuterGain,k._panner.distanceModel=k._pannerAttr.distanceModel,k._panner.maxDistance=k._pannerAttr.maxDistance,k._panner.refDistance=k._pannerAttr.refDistance,k._panner.rolloffFactor=k._pannerAttr.rolloffFactor,k._panner.panningModel=k._pannerAttr.panningModel,void 0!==k._panner.positionX?(k._panner.positionX.setValueAtTime(k._pos[0],Howler.ctx.currentTime),k._panner.positionY.setValueAtTime(k._pos[1],Howler.ctx.currentTime),k._panner.positionZ.setValueAtTime(k._pos[2],
Howler.ctx.currentTime)):k._panner.setPosition(k._pos[0],k._pos[1],k._pos[2]),void 0!==k._panner.orientationX?(k._panner.orientationX.setValueAtTime(k._orientation[0],Howler.ctx.currentTime),k._panner.orientationY.setValueAtTime(k._orientation[1],Howler.ctx.currentTime),k._panner.orientationZ.setValueAtTime(k._orientation[2],Howler.ctx.currentTime)):k._panner.setOrientation(k._orientation[0],k._orientation[1],k._orientation[2])):(k._panner=Howler.ctx.createStereoPanner(),k._panner.pan.setValueAtTime(k._stereo,
Howler.ctx.currentTime));k._panner.connect(k._node);k._paused||k._parent.pause(k._id,!0).play(k._id,!0)}}();
!function(E){"object"==typeof exports&&"undefined"!=typeof module?module.exports=E():"function"==typeof define&&define.amd?define([],E):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=E()}(function(){return function w(k,u,y){function z(q,n){if(!u[q]){if(!k[q]){var d="function"==typeof require&&require;if(!n&&d)return d(q,!0);if(F)return F(q,!0);n=Error("Cannot find module '"+q+"'");throw n.code="MODULE_NOT_FOUND",n;}n=u[q]={exports:{}};
k[q][0].call(n.exports,function(d){var g=k[q][1][d];return z(g?g:d)},n,n.exports,w,k,u,y)}return u[q].exports}for(var F="function"==typeof require&&require,N=0;N<y.length;N++)z(y[N]);return z}({1:[function(k,u,y){function w(k){if(!(this instanceof w))return new w(k);k=this.options=N.assign({level:U,method:R,chunkSize:16384,windowBits:15,memLevel:8,strategy:O,to:""},k||{});k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&16>k.windowBits&&(k.windowBits+=16);this.err=0;this.msg=
"";this.ended=!1;this.chunks=[];this.strm=new d;this.strm.avail_out=0;var u=F.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(u!==g)throw Error(n[u]);if(k.header&&F.deflateSetHeader(this.strm,k.header),k.dictionary){var y;if(y="string"==typeof k.dictionary?q.string2buf(k.dictionary):"[object ArrayBuffer]"===p.call(k.dictionary)?new Uint8Array(k.dictionary):k.dictionary,u=F.deflateSetDictionary(this.strm,y),u!==g)throw Error(n[u]);this._dict_set=!0}}function z(d,g){g=
new w(g);if(g.push(d,!0),g.err)throw g.msg;return g.result}var F=k("./zlib/deflate"),N=k("./utils/common"),q=k("./utils/strings"),n=k("./zlib/messages"),d=k("./zlib/zstream"),p=Object.prototype.toString,g=0,U=-1,O=0,R=8;w.prototype.push=function(d,n){var k,u=this.strm,w=this.options.chunkSize;if(this.ended)return!1;n=n===~~n?n:!0===n?4:0;"string"==typeof d?u.input=q.string2buf(d):"[object ArrayBuffer]"===p.call(d)?u.input=new Uint8Array(d):u.input=d;u.next_in=0;u.avail_in=u.input.length;do{if(0===
u.avail_out&&(u.output=new N.Buf8(w),u.next_out=0,u.avail_out=w),k=F.deflate(u,n),1!==k&&k!==g)return this.onEnd(k),this.ended=!0,!1;0!==u.avail_out&&(0!==u.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(q.buf2binstring(N.shrinkBuf(u.output,u.next_out))):this.onData(N.shrinkBuf(u.output,u.next_out)))}while((0<u.avail_in||0===u.avail_out)&&1!==k);return 4===n?(k=F.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===g):2!==n||(this.onEnd(g),u.avail_out=0,!0)};w.prototype.onData=
function(d){this.chunks.push(d)};w.prototype.onEnd=function(d){d===g&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=N.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};y.Deflate=w;y.deflate=z;y.deflateRaw=function(d,g){return g=g||{},g.raw=!0,z(d,g)};y.gzip=function(d,g){return g=g||{},g.gzip=!0,z(d,g)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(k,u,y){function w(k){if(!(this instanceof
w))return new w(k);var q=this.options=N.assign({chunkSize:16384,windowBits:0,to:""},k||{});q.raw&&0<=q.windowBits&&16>q.windowBits&&(q.windowBits=-q.windowBits,0===q.windowBits&&(q.windowBits=-15));!(0<=q.windowBits&&16>q.windowBits)||k&&k.windowBits||(q.windowBits+=32);15<q.windowBits&&48>q.windowBits&&0===(15&q.windowBits)&&(q.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new p;this.strm.avail_out=0;k=F.inflateInit2(this.strm,q.windowBits);if(k!==n.Z_OK)throw Error(d[k]);
this.header=new g;F.inflateGetHeader(this.strm,this.header)}function z(d,g){g=new w(g);if(g.push(d,!0),g.err)throw g.msg;return g.result}var F=k("./zlib/inflate"),N=k("./utils/common"),q=k("./utils/strings"),n=k("./zlib/constants"),d=k("./zlib/messages"),p=k("./zlib/zstream"),g=k("./zlib/gzheader"),U=Object.prototype.toString;w.prototype.push=function(d,g){var p,k,u,w,y,z=this.strm,R=this.options.chunkSize,O=this.options.dictionary,K=!1;if(this.ended)return!1;g=g===~~g?g:!0===g?n.Z_FINISH:n.Z_NO_FLUSH;
"string"==typeof d?z.input=q.binstring2buf(d):"[object ArrayBuffer]"===U.call(d)?z.input=new Uint8Array(d):z.input=d;z.next_in=0;z.avail_in=z.input.length;do{if(0===z.avail_out&&(z.output=new N.Buf8(R),z.next_out=0,z.avail_out=R),p=F.inflate(z,n.Z_NO_FLUSH),p===n.Z_NEED_DICT&&O&&(y="string"==typeof O?q.string2buf(O):"[object ArrayBuffer]"===U.call(O)?new Uint8Array(O):O,p=F.inflateSetDictionary(this.strm,y)),p===n.Z_BUF_ERROR&&!0===K&&(p=n.Z_OK,K=!1),p!==n.Z_STREAM_END&&p!==n.Z_OK)return this.onEnd(p),
this.ended=!0,!1;z.next_out&&(0!==z.avail_out&&p!==n.Z_STREAM_END&&(0!==z.avail_in||g!==n.Z_FINISH&&g!==n.Z_SYNC_FLUSH)||("string"===this.options.to?(k=q.utf8border(z.output,z.next_out),u=z.next_out-k,w=q.buf2string(z.output,k),z.next_out=u,z.avail_out=R-u,u&&N.arraySet(z.output,z.output,k,u,0),this.onData(w)):this.onData(N.shrinkBuf(z.output,z.next_out))));0===z.avail_in&&0===z.avail_out&&(K=!0)}while((0<z.avail_in||0===z.avail_out)&&p!==n.Z_STREAM_END);return p===n.Z_STREAM_END&&(g=n.Z_FINISH),
g===n.Z_FINISH?(p=F.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===n.Z_OK):g!==n.Z_SYNC_FLUSH||(this.onEnd(n.Z_OK),z.avail_out=0,!0)};w.prototype.onData=function(d){this.chunks.push(d)};w.prototype.onEnd=function(d){d===n.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=N.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};y.Inflate=w;y.inflate=z;y.inflateRaw=function(d,g){return g=g||{},g.raw=!0,z(d,g)};y.ungzip=z},{"./utils/common":3,
"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(k,u,y){k="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;y.assign=function(k){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var q=u.shift();if(q){if("object"!=typeof q)throw new TypeError(q+"must be non-object");for(var n in q)q.hasOwnProperty(n)&&(k[n]=q[n])}}return k};y.shrinkBuf=function(k,u){return k.length===
u?k:k.subarray?k.subarray(0,u):(k.length=u,k)};var w={arraySet:function(k,u,q,n,d){if(u.subarray&&k.subarray)return void k.set(u.subarray(q,q+n),d);for(var p=0;p<n;p++)k[d+p]=u[q+p]},flattenChunks:function(k){var u,q;var n=q=0;for(u=k.length;n<u;n++)q+=k[n].length;var d=new Uint8Array(q);n=q=0;for(u=k.length;n<u;n++){var p=k[n];d.set(p,q);q+=p.length}return d}},z={arraySet:function(k,u,q,n,d){for(var p=0;p<n;p++)k[d+p]=u[q+p]},flattenChunks:function(k){return[].concat.apply([],k)}};y.setTyped=function(k){k?
(y.Buf8=Uint8Array,y.Buf16=Uint16Array,y.Buf32=Int32Array,y.assign(y,w)):(y.Buf8=Array,y.Buf16=Array,y.Buf32=Array,y.assign(y,z))};y.setTyped(k)},{}],4:[function(k,u,y){function w(n,d){if(65537>d&&(n.subarray&&N||!n.subarray&&F))return String.fromCharCode.apply(null,z.shrinkBuf(n,d));for(var p="",g=0;g<d;g++)p+=String.fromCharCode(n[g]);return p}var z=k("./common"),F=!0,N=!0;try{String.fromCharCode.apply(null,[0])}catch(n){F=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(n){N=!1}var q=
new z.Buf8(256);for(k=0;256>k;k++)q[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;q[254]=q[254]=1;y.string2buf=function(n){var d,p,g,k=n.length,q=0;for(p=0;p<k;p++){var u=n.charCodeAt(p);55296===(64512&u)&&p+1<k&&(d=n.charCodeAt(p+1),56320===(64512&d)&&(u=65536+(u-55296<<10)+(d-56320),p++));q+=128>u?1:2048>u?2:65536>u?3:4}var w=new z.Buf8(q);for(p=g=0;g<q;p++)u=n.charCodeAt(p),55296===(64512&u)&&p+1<k&&(d=n.charCodeAt(p+1),56320===(64512&d)&&(u=65536+(u-55296<<10)+(d-56320),p++)),128>u?w[g++]=
u:2048>u?(w[g++]=192|u>>>6,w[g++]=128|63&u):65536>u?(w[g++]=224|u>>>12,w[g++]=128|u>>>6&63,w[g++]=128|63&u):(w[g++]=240|u>>>18,w[g++]=128|u>>>12&63,w[g++]=128|u>>>6&63,w[g++]=128|63&u);return w};y.buf2binstring=function(n){return w(n,n.length)};y.binstring2buf=function(n){for(var d=new z.Buf8(n.length),p=0,g=d.length;p<g;p++)d[p]=n.charCodeAt(p);return d};y.buf2string=function(n,d){var p,g,k,u=d||n.length,z=Array(2*u);for(d=p=0;d<u;)if(g=n[d++],128>g)z[p++]=g;else if(k=q[g],4<k)z[p++]=65533,d+=k-
1;else{for(g&=2===k?31:3===k?15:7;1<k&&d<u;)g=g<<6|63&n[d++],k--;1<k?z[p++]=65533:65536>g?z[p++]=g:(g-=65536,z[p++]=55296|g>>10&1023,z[p++]=56320|1023&g)}return w(z,p)};y.utf8border=function(n,d){var p;d=d||n.length;d>n.length&&(d=n.length);for(p=d-1;0<=p&&128===(192&n[p]);)p--;return 0>p?d:0===p?d:p+q[n[p]]>d?p:d}},{"./common":3}],5:[function(k,u,y){u.exports=function(k,u,y,N){var q=65535&k|0;k=k>>>16&65535|0;for(var n;0!==y;){n=2E3<y?2E3:y;y-=n;do q=q+u[N++]|0,k=k+q|0;while(--n);q%=65521;k%=65521}return q|
k<<16|0}},{}],6:[function(k,u,y){u.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(k,u,y){var w=function(){for(var k,u=[],w=0;256>w;w++){k=w;
for(var q=0;8>q;q++)k=1&k?3988292384^k>>>1:k>>>1;u[w]=k}return u}();u.exports=function(k,u,y,q){y=q+y;for(k^=-1;q<y;q++)k=k>>>8^w[255&(k^u[q])];return k^-1}},{}],8:[function(k,u,y){function w(d,g){return d.msg=Ca[g],g}function z(d){for(var g=d.length;0<=--g;)d[g]=0}function F(d){var g=d.state,m=g.pending;m>d.avail_out&&(m=d.avail_out);0!==m&&(la.arraySet(d.output,g.pending_buf,g.pending_out,m,d.next_out),d.next_out+=m,g.pending_out+=m,d.total_out+=m,d.avail_out-=m,g.pending-=m,0===g.pending&&(g.pending_out=
0))}function N(d,g){ua._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,g);d.block_start=d.strstart;F(d.strm)}function q(d,g){d.pending_buf[d.pending++]=g}function n(d,g){d.pending_buf[d.pending++]=g>>>8&255;d.pending_buf[d.pending++]=255&g}function d(d,g){var m,x,p=d.max_chain_length,k=d.strstart,n=d.prev_length,q=d.nice_match,u=d.strstart>d.w_size-fa?d.strstart-(d.w_size-fa):0,v=d.window,w=d.w_mask,K=d.prev,y=d.strstart+X,z=v[k+n-1],H=v[k+n];d.prev_length>=d.good_match&&
(p>>=2);q>d.lookahead&&(q=d.lookahead);do if(m=g,v[m+n]===H&&v[m+n-1]===z&&v[m]===v[k]&&v[++m]===v[k+1]){k+=2;for(m++;v[++k]===v[++m]&&v[++k]===v[++m]&&v[++k]===v[++m]&&v[++k]===v[++m]&&v[++k]===v[++m]&&v[++k]===v[++m]&&v[++k]===v[++m]&&v[++k]===v[++m]&&k<y;);if(x=X-(y-k),k=y-X,x>n){if(d.match_start=g,n=x,x>=q)break;z=v[k+n-1];H=v[k+n]}}while((g=K[g&w])>u&&0!==--p);return n<=d.lookahead?n:d.lookahead}function p(d){var g,m,p=d.w_size;do{if(m=d.window_size-d.lookahead-d.strstart,d.strstart>=p+(p-fa)){la.arraySet(d.window,
d.window,p,p,0);d.match_start-=p;d.strstart-=p;d.block_start-=p;var k=g=d.hash_size;do{var n=d.head[--k];d.head[k]=n>=p?n-p:0}while(--g);k=g=p;do n=d.prev[--k],d.prev[k]=n>=p?n-p:0;while(--g);m+=p}if(0===d.strm.avail_in)break;k=d.strm;n=d.window;var x=d.strstart+d.lookahead,q=k.avail_in;if(g=(q>m&&(q=m),0===q?0:(k.avail_in-=q,la.arraySet(n,k.input,k.next_in,q,x),1===k.state.wrap?k.adler=S(k.adler,n,q,x):2===k.state.wrap&&(k.adler=ea(k.adler,n,q,x)),k.next_in+=q,k.total_in+=q,q)),d.lookahead+=g,d.lookahead+
d.insert>=Z)for(m=d.strstart-d.insert,d.ins_h=d.window[m],d.ins_h=(d.ins_h<<d.hash_shift^d.window[m+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[m+Z-1])&d.hash_mask,d.prev[m&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=m,m++,d.insert--,!(d.lookahead+d.insert<Z)););}while(d.lookahead<fa&&0!==d.strm.avail_in)}function g(g,k){for(var m,n;;){if(g.lookahead<fa){if(p(g),g.lookahead<fa&&k===K)return D;if(0===g.lookahead)break}if(m=0,g.lookahead>=Z&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+
Z-1])&g.hash_mask,m=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),0!==m&&g.strstart-m<=g.w_size-fa&&(g.match_length=d(g,m)),g.match_length>=Z)if(n=ua._tr_tally(g,g.strstart-g.match_start,g.match_length-Z),g.lookahead-=g.match_length,g.match_length<=g.max_lazy_match&&g.lookahead>=Z){g.match_length--;do g.strstart++,g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+Z-1])&g.hash_mask,m=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart;while(0!==--g.match_length);
g.strstart++}else g.strstart+=g.match_length,g.match_length=0,g.ins_h=g.window[g.strstart],g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+1])&g.hash_mask;else n=ua._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++;if(n&&(N(g,!1),0===g.strm.avail_out))return D}return g.insert=g.strstart<Z-1?g.strstart:Z-1,k===T?(N(g,!0),0===g.strm.avail_out?da:Ba):g.last_lit&&(N(g,!1),0===g.strm.avail_out)?D:Za}function U(g,k){for(var m,n,q;;){if(g.lookahead<fa){if(p(g),g.lookahead<fa&&k===K)return D;
if(0===g.lookahead)break}if(m=0,g.lookahead>=Z&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+Z-1])&g.hash_mask,m=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),g.prev_length=g.match_length,g.prev_match=g.match_start,g.match_length=Z-1,0!==m&&g.prev_length<g.max_lazy_match&&g.strstart-m<=g.w_size-fa&&(g.match_length=d(g,m),5>=g.match_length&&(g.strategy===L||g.match_length===Z&&4096<g.strstart-g.match_start)&&(g.match_length=Z-1)),g.prev_length>=Z&&g.match_length<=g.prev_length){q=
g.strstart+g.lookahead-Z;n=ua._tr_tally(g,g.strstart-1-g.prev_match,g.prev_length-Z);g.lookahead-=g.prev_length-1;g.prev_length-=2;do++g.strstart<=q&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+Z-1])&g.hash_mask,m=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart);while(0!==--g.prev_length);if(g.match_available=0,g.match_length=Z-1,g.strstart++,n&&(N(g,!1),0===g.strm.avail_out))return D}else if(g.match_available){if(n=ua._tr_tally(g,0,g.window[g.strstart-1]),n&&N(g,!1),
g.strstart++,g.lookahead--,0===g.strm.avail_out)return D}else g.match_available=1,g.strstart++,g.lookahead--}return g.match_available&&(ua._tr_tally(g,0,g.window[g.strstart-1]),g.match_available=0),g.insert=g.strstart<Z-1?g.strstart:Z-1,k===T?(N(g,!0),0===g.strm.avail_out?da:Ba):g.last_lit&&(N(g,!1),0===g.strm.avail_out)?D:Za}function O(d,g,m,k,p){this.good_length=d;this.max_lazy=g;this.nice_length=m;this.max_chain=k;this.func=p}function R(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=
this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=$a;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=
this.ins_h=0;this.dyn_ltree=new la.Buf16(2*sa);this.dyn_dtree=new la.Buf16(2*(2*gb+1));this.bl_tree=new la.Buf16(2*(2*v+1));z(this.dyn_ltree);z(this.dyn_dtree);z(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new la.Buf16(Ma+1);this.heap=new la.Buf16(2*Da+1);z(this.heap);this.heap_max=this.heap_len=0;this.depth=new la.Buf16(2*Da+1);z(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=
0}function ba(d){var g;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=Ua,g=d.state,g.pending=0,g.pending_out=0,0>g.wrap&&(g.wrap=-g.wrap),g.status=g.wrap?I:C,d.adler=2===g.wrap?0:1,g.last_flush=K,ua._tr_init(g),qa):w(d,P)}function Ya(d){var g=ba(d);g===qa&&(d=d.state,d.window_size=2*d.w_size,z(d.head),d.max_lazy_match=pa[d.level].max_lazy,d.good_match=pa[d.level].good_length,d.nice_match=pa[d.level].nice_length,d.max_chain_length=pa[d.level].max_chain,d.strstart=0,d.block_start=0,d.lookahead=
0,d.insert=0,d.match_length=d.prev_length=Z-1,d.match_available=0,d.ins_h=0);return g}function hb(d,g,m,k,p,n){if(!d)return P;var B=1;if(g===G&&(g=6),0>k?(B=0,k=-k):15<k&&(B=2,k-=16),1>p||p>Xa||m!==$a||8>k||15<k||0>g||9<g||0>n||n>Qa)return w(d,P);8===k&&(k=9);var q=new R;return d.state=q,q.strm=d,q.wrap=B,q.gzhead=null,q.w_bits=k,q.w_size=1<<q.w_bits,q.w_mask=q.w_size-1,q.hash_bits=p+7,q.hash_size=1<<q.hash_bits,q.hash_mask=q.hash_size-1,q.hash_shift=~~((q.hash_bits+Z-1)/Z),q.window=new la.Buf8(2*
q.w_size),q.head=new la.Buf16(q.hash_size),q.prev=new la.Buf16(q.w_size),q.lit_bufsize=1<<p+6,q.pending_buf_size=4*q.lit_bufsize,q.pending_buf=new la.Buf8(q.pending_buf_size),q.d_buf=1*q.lit_bufsize,q.l_buf=3*q.lit_bufsize,q.level=g,q.strategy=n,q.method=m,Ya(d)}var la=k("../utils/common"),ua=k("./trees"),S=k("./adler32"),ea=k("./crc32"),Ca=k("./messages"),K=0,T=4,qa=0,P=-2,G=-1,L=1,Qa=4,Ua=2,$a=8,Xa=9,Da=286,gb=30,v=19,sa=2*Da+1,Ma=15,Z=3,X=258,fa=X+Z+1,I=42,C=113,D=1,Za=2,da=3,Ba=4;var pa=[new O(0,
0,0,0,function(d,g){var m=65535;for(m>d.pending_buf_size-5&&(m=d.pending_buf_size-5);;){if(1>=d.lookahead){if(p(d),0===d.lookahead&&g===K)return D;if(0===d.lookahead)break}d.strstart+=d.lookahead;d.lookahead=0;var k=d.block_start+m;if((0===d.strstart||d.strstart>=k)&&(d.lookahead=d.strstart-k,d.strstart=k,N(d,!1),0===d.strm.avail_out)||d.strstart-d.block_start>=d.w_size-fa&&(N(d,!1),0===d.strm.avail_out))return D}return d.insert=0,g===T?(N(d,!0),0===d.strm.avail_out?da:Ba):(d.strstart>d.block_start&&
N(d,!1),D)}),new O(4,4,8,4,g),new O(4,5,16,8,g),new O(4,6,32,32,g),new O(4,4,16,16,U),new O(8,16,32,32,U),new O(8,16,128,128,U),new O(8,32,128,256,U),new O(32,128,258,1024,U),new O(32,258,258,4096,U)];y.deflateInit=function(d,g){return hb(d,g,$a,15,8,0)};y.deflateInit2=hb;y.deflateReset=Ya;y.deflateResetKeep=ba;y.deflateSetHeader=function(d,g){return d&&d.state?2!==d.state.wrap?P:(d.state.gzhead=g,qa):P};y.deflate=function(d,g){var m,k;if(!d||!d.state||5<g||0>g)return d?w(d,P):P;if(k=d.state,!d.output||
!d.input&&0!==d.avail_in||666===k.status&&g!==T)return w(d,0===d.avail_out?-5:P);if(k.strm=d,m=k.last_flush,k.last_flush=g,k.status===I)if(2===k.wrap)d.adler=0,q(k,31),q(k,139),q(k,8),k.gzhead?(q(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),q(k,255&k.gzhead.time),q(k,k.gzhead.time>>8&255),q(k,k.gzhead.time>>16&255),q(k,k.gzhead.time>>24&255),q(k,9===k.level?2:2<=k.strategy||2>k.level?4:0),q(k,255&k.gzhead.os),k.gzhead.extra&&k.gzhead.extra.length&&
(q(k,255&k.gzhead.extra.length),q(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(d.adler=ea(d.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=69):(q(k,0),q(k,0),q(k,0),q(k,0),q(k,0),q(k,9===k.level?2:2<=k.strategy||2>k.level?4:0),q(k,3),k.status=C);else{var v=$a+(k.w_bits-8<<4)<<8;v|=(2<=k.strategy||2>k.level?0:6>k.level?1:6===k.level?2:3)<<6;0!==k.strstart&&(v|=32);k.status=C;n(k,v+(31-v%31));0!==k.strstart&&(n(k,d.adler>>>16),n(k,65535&d.adler));d.adler=1}if(69===k.status)if(k.gzhead.extra){for(v=
k.pending;k.gzindex<(65535&k.gzhead.extra.length)&&(k.pending!==k.pending_buf_size||(k.gzhead.hcrc&&k.pending>v&&(d.adler=ea(d.adler,k.pending_buf,k.pending-v,v)),F(d),v=k.pending,k.pending!==k.pending_buf_size));)q(k,255&k.gzhead.extra[k.gzindex]),k.gzindex++;k.gzhead.hcrc&&k.pending>v&&(d.adler=ea(d.adler,k.pending_buf,k.pending-v,v));k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=73)}else k.status=73;if(73===k.status)if(k.gzhead.name){v=k.pending;do{if(k.pending===k.pending_buf_size&&
(k.gzhead.hcrc&&k.pending>v&&(d.adler=ea(d.adler,k.pending_buf,k.pending-v,v)),F(d),v=k.pending,k.pending===k.pending_buf_size)){var u=1;break}u=k.gzindex<k.gzhead.name.length?255&k.gzhead.name.charCodeAt(k.gzindex++):0;q(k,u)}while(0!==u);k.gzhead.hcrc&&k.pending>v&&(d.adler=ea(d.adler,k.pending_buf,k.pending-v,v));0===u&&(k.gzindex=0,k.status=91)}else k.status=91;if(91===k.status)if(k.gzhead.comment){v=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>v&&(d.adler=ea(d.adler,
k.pending_buf,k.pending-v,v)),F(d),v=k.pending,k.pending===k.pending_buf_size)){u=1;break}u=k.gzindex<k.gzhead.comment.length?255&k.gzhead.comment.charCodeAt(k.gzindex++):0;q(k,u)}while(0!==u);k.gzhead.hcrc&&k.pending>v&&(d.adler=ea(d.adler,k.pending_buf,k.pending-v,v));0===u&&(k.status=103)}else k.status=103;if(103===k.status&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&F(d),k.pending+2<=k.pending_buf_size&&(q(k,255&d.adler),q(k,d.adler>>8&255),d.adler=0,k.status=C)):k.status=C),0!==k.pending){if(F(d),
0===d.avail_out)return k.last_flush=-1,qa}else if(0===d.avail_in&&(g<<1)-(4<g?9:0)<=(m<<1)-(4<m?9:0)&&g!==T)return w(d,-5);if(666===k.status&&0!==d.avail_in)return w(d,-5);if(0!==d.avail_in||0!==k.lookahead||g!==K&&666!==k.status){if(2===k.strategy)a:{for(var x;;){if(0===k.lookahead&&(p(k),0===k.lookahead)){if(g===K){var y=D;break a}break}if(k.match_length=0,x=ua._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++,x&&(N(k,!1),0===k.strm.avail_out)){y=D;break a}}y=(k.insert=0,g===T?(N(k,
!0),0===k.strm.avail_out?da:Ba):k.last_lit&&(N(k,!1),0===k.strm.avail_out)?D:Za)}else if(3===k.strategy)a:{var G,H;for(x=k.window;;){if(k.lookahead<=X){if(p(k),k.lookahead<=X&&g===K){y=D;break a}if(0===k.lookahead)break}if(k.match_length=0,k.lookahead>=Z&&0<k.strstart&&(H=k.strstart-1,G=x[H],G===x[++H]&&G===x[++H]&&G===x[++H])){for(m=k.strstart+X;G===x[++H]&&G===x[++H]&&G===x[++H]&&G===x[++H]&&G===x[++H]&&G===x[++H]&&G===x[++H]&&G===x[++H]&&H<m;);k.match_length=X-(m-H);k.match_length>k.lookahead&&
(k.match_length=k.lookahead)}if(k.match_length>=Z?(y=ua._tr_tally(k,1,k.match_length-Z),k.lookahead-=k.match_length,k.strstart+=k.match_length,k.match_length=0):(y=ua._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++),y&&(N(k,!1),0===k.strm.avail_out)){y=D;break a}}y=(k.insert=0,g===T?(N(k,!0),0===k.strm.avail_out?da:Ba):k.last_lit&&(N(k,!1),0===k.strm.avail_out)?D:Za)}else y=pa[k.level].func(k,g);if(y!==da&&y!==Ba||(k.status=666),y===D||y===da)return 0===d.avail_out&&(k.last_flush=-1),
qa;if(y===Za&&(1===g?ua._tr_align(k):5!==g&&(ua._tr_stored_block(k,0,0,!1),3===g&&(z(k.head),0===k.lookahead&&(k.strstart=0,k.block_start=0,k.insert=0))),F(d),0===d.avail_out))return k.last_flush=-1,qa}return g!==T?qa:0>=k.wrap?1:(2===k.wrap?(q(k,255&d.adler),q(k,d.adler>>8&255),q(k,d.adler>>16&255),q(k,d.adler>>24&255),q(k,255&d.total_in),q(k,d.total_in>>8&255),q(k,d.total_in>>16&255),q(k,d.total_in>>24&255)):(n(k,d.adler>>>16),n(k,65535&d.adler)),F(d),0<k.wrap&&(k.wrap=-k.wrap),0!==k.pending?qa:
1)};y.deflateEnd=function(d){var g;return d&&d.state?(g=d.state.status,g!==I&&69!==g&&73!==g&&91!==g&&103!==g&&g!==C&&666!==g?w(d,P):(d.state=null,g===C?w(d,-3):qa)):P};y.deflateSetDictionary=function(d,g){var m,k,n;var q=g.length;if(!d||!d.state||(m=d.state,k=m.wrap,2===k||1===k&&m.status!==I||m.lookahead))return P;1===k&&(d.adler=S(d.adler,g,q,0));m.wrap=0;q>=m.w_size&&(0===k&&(z(m.head),m.strstart=0,m.block_start=0,m.insert=0),n=new la.Buf8(m.w_size),la.arraySet(n,g,q-m.w_size,m.w_size,0),g=n,
q=m.w_size);n=d.avail_in;var v=d.next_in;var u=d.input;d.avail_in=q;d.next_in=0;d.input=g;for(p(m);m.lookahead>=Z;){g=m.strstart;q=m.lookahead-(Z-1);do m.ins_h=(m.ins_h<<m.hash_shift^m.window[g+Z-1])&m.hash_mask,m.prev[g&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=g,g++;while(--q);m.strstart=g;m.lookahead=Z-1;p(m)}return m.strstart+=m.lookahead,m.block_start=m.strstart,m.insert=m.lookahead,m.lookahead=0,m.match_length=m.prev_length=Z-1,m.match_available=0,d.next_in=v,d.input=u,d.avail_in=n,m.wrap=k,
qa};y.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(k,u,y){u.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],10:[function(k,u,y){u.exports=function(k,u){var w,y,q;var n=k.state;var d=k.next_in;var p=k.input;var g=d+(k.avail_in-5);var z=k.next_out;var O=k.output;u=z-(u-k.avail_out);var R=z+(k.avail_out-257);
var ba=n.dmax;var Ya=n.wsize;var hb=n.whave;var la=n.wnext;var ua=n.window;var S=n.hold;var ea=n.bits;var Ca=n.lencode;var K=n.distcode;var T=(1<<n.lenbits)-1;var qa=(1<<n.distbits)-1;a:do{15>ea&&(S+=p[d++]<<ea,ea+=8,S+=p[d++]<<ea,ea+=8);var P=Ca[S&T];b:for(;;){if(w=P>>>24,S>>>=w,ea-=w,w=P>>>16&255,0===w)O[z++]=65535&P;else{if(!(16&w)){if(0===(64&w)){P=Ca[(65535&P)+(S&(1<<w)-1)];continue b}if(32&w){n.mode=12;break a}k.msg="invalid literal/length code";n.mode=30;break a}var G=65535&P;(w&=15)&&(ea<
w&&(S+=p[d++]<<ea,ea+=8),G+=S&(1<<w)-1,S>>>=w,ea-=w);15>ea&&(S+=p[d++]<<ea,ea+=8,S+=p[d++]<<ea,ea+=8);P=K[S&qa];c:for(;;){if(w=P>>>24,S>>>=w,ea-=w,w=P>>>16&255,!(16&w)){if(0===(64&w)){P=K[(65535&P)+(S&(1<<w)-1)];continue c}k.msg="invalid distance code";n.mode=30;break a}if(y=65535&P,w&=15,ea<w&&(S+=p[d++]<<ea,ea+=8,ea<w&&(S+=p[d++]<<ea,ea+=8)),y+=S&(1<<w)-1,y>ba){k.msg="invalid distance too far back";n.mode=30;break a}if(S>>>=w,ea-=w,w=z-u,y>w){if(w=y-w,w>hb&&n.sane){k.msg="invalid distance too far back";
n.mode=30;break a}if(P=0,q=ua,0===la){if(P+=Ya-w,w<G){G-=w;do O[z++]=ua[P++];while(--w);P=z-y;q=O}}else if(la<w){if(P+=Ya+la-w,w-=la,w<G){G-=w;do O[z++]=ua[P++];while(--w);if(P=0,la<G){w=la;G-=w;do O[z++]=ua[P++];while(--w);P=z-y;q=O}}}else if(P+=la-w,w<G){G-=w;do O[z++]=ua[P++];while(--w);P=z-y;q=O}for(;2<G;)O[z++]=q[P++],O[z++]=q[P++],O[z++]=q[P++],G-=3;G&&(O[z++]=q[P++],1<G&&(O[z++]=q[P++]))}else{P=z-y;do O[z++]=O[P++],O[z++]=O[P++],O[z++]=O[P++],G-=3;while(2<G);G&&(O[z++]=O[P++],1<G&&(O[z++]=
O[P++]))}break}}break}}while(d<g&&z<R);G=ea>>3;d-=G;ea-=G<<3;k.next_in=d;k.next_out=z;k.avail_in=d<g?5+(g-d):5-(d-g);k.avail_out=z<R?257+(R-z):257-(z-R);n.hold=S&(1<<ea)-1;n.bits=ea}},{}],11:[function(k,u,y){function w(d){return(d>>>24&255)+(d>>>8&65280)+((65280&d)<<8)+((255&d)<<24)}function z(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=
this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new U.Buf16(320);this.work=new U.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function F(d){var g;return d&&d.state?(g=d.state,d.total_in=d.total_out=g.total=0,d.msg="",g.wrap&&(d.adler=1&g.wrap),g.mode=ua,g.last=0,g.havedict=0,g.dmax=32768,g.head=null,g.hold=0,g.bits=0,g.lencode=g.lendyn=new U.Buf32(S),g.distcode=g.distdyn=
new U.Buf32(ea),g.sane=1,g.back=-1,hb):la}function N(d){var g;return d&&d.state?(g=d.state,g.wsize=0,g.whave=0,g.wnext=0,F(d)):la}function q(d,g){var k,p;return d&&d.state?(p=d.state,0>g?(k=0,g=-g):(k=(g>>4)+1,48>g&&(g&=15)),g&&(8>g||15<g)?la:(null!==p.window&&p.wbits!==g&&(p.window=null),p.wrap=k,p.wbits=g,N(d))):la}function n(d,g){var k,p;return d?(p=new z,d.state=p,p.window=null,k=q(d,g),k!==hb&&(d.state=null),k):la}function d(d,g,k,p){var n;d=d.state;return null===d.window&&(d.wsize=1<<d.wbits,
d.wnext=0,d.whave=0,d.window=new U.Buf8(d.wsize)),p>=d.wsize?(U.arraySet(d.window,g,k-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(n=d.wsize-d.wnext,n>p&&(n=p),U.arraySet(d.window,g,k-p,n,d.wnext),p-=n,p?(U.arraySet(d.window,g,k-p,p,0),d.wnext=p,d.whave=d.wsize):(d.wnext+=n,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=n))),0}var p,g,U=k("../utils/common"),O=k("./adler32"),R=k("./crc32"),ba=k("./inffast"),Ya=k("./inftrees"),hb=0,la=-2,ua=1,S=852,ea=592,Ca=!0;y.inflateReset=N;y.inflateReset2=
q;y.inflateResetKeep=F;y.inflateInit=function(d){return n(d,15)};y.inflateInit2=n;y.inflate=function(k,n){var q,u,y,z,F,K,N,T=0,S=new U.Buf8(4),ea=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&0!==k.avail_in)return la;var v=k.state;12===v.mode&&(v.mode=13);var sa=k.next_out;var Ma=k.output;var Z=k.avail_out;var X=k.next_in;var fa=k.input;var I=k.avail_in;var C=v.hold;var D=v.bits;var Za=I;var da=Z;var Ba=hb;a:for(;;)switch(v.mode){case ua:if(0===v.wrap){v.mode=
13;break}for(;16>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if(2&v.wrap&&35615===C){v.check=0;S[0]=255&C;S[1]=C>>>8&255;v.check=R(v.check,S,2,0);D=C=0;v.mode=2;break}if(v.flags=0,v.head&&(v.head.done=!1),!(1&v.wrap)||(((255&C)<<8)+(C>>8))%31){k.msg="incorrect header check";v.mode=30;break}if(8!==(15&C)){k.msg="unknown compression method";v.mode=30;break}if(C>>>=4,D-=4,K=(15&C)+8,0===v.wbits)v.wbits=K;else if(K>v.wbits){k.msg="invalid window size";v.mode=30;break}v.dmax=1<<K;k.adler=v.check=1;v.mode=
512&C?10:12;D=C=0;break;case 2:for(;16>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if(v.flags=C,8!==(255&v.flags)){k.msg="unknown compression method";v.mode=30;break}if(57344&v.flags){k.msg="unknown header flags set";v.mode=30;break}v.head&&(v.head.text=C>>8&1);512&v.flags&&(S[0]=255&C,S[1]=C>>>8&255,v.check=R(v.check,S,2,0));D=C=0;v.mode=3;case 3:for(;32>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}v.head&&(v.head.time=C);512&v.flags&&(S[0]=255&C,S[1]=C>>>8&255,S[2]=C>>>16&255,S[3]=C>>>24&255,v.check=
R(v.check,S,4,0));D=C=0;v.mode=4;case 4:for(;16>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}v.head&&(v.head.xflags=255&C,v.head.os=C>>8);512&v.flags&&(S[0]=255&C,S[1]=C>>>8&255,v.check=R(v.check,S,2,0));D=C=0;v.mode=5;case 5:if(1024&v.flags){for(;16>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}v.length=C;v.head&&(v.head.extra_len=C);512&v.flags&&(S[0]=255&C,S[1]=C>>>8&255,v.check=R(v.check,S,2,0));D=C=0}else v.head&&(v.head.extra=null);v.mode=6;case 6:if(1024&v.flags&&(q=v.length,q>I&&(q=I),q&&(v.head&&
(K=v.head.extra_len-v.length,v.head.extra||(v.head.extra=Array(v.head.extra_len)),U.arraySet(v.head.extra,fa,X,q,K)),512&v.flags&&(v.check=R(v.check,fa,q,X)),I-=q,X+=q,v.length-=q),v.length))break a;v.length=0;v.mode=7;case 7:if(2048&v.flags){if(0===I)break a;q=0;do K=fa[X+q++],v.head&&K&&65536>v.length&&(v.head.name+=String.fromCharCode(K));while(K&&q<I);if(512&v.flags&&(v.check=R(v.check,fa,q,X)),I-=q,X+=q,K)break a}else v.head&&(v.head.name=null);v.length=0;v.mode=8;case 8:if(4096&v.flags){if(0===
I)break a;q=0;do K=fa[X+q++],v.head&&K&&65536>v.length&&(v.head.comment+=String.fromCharCode(K));while(K&&q<I);if(512&v.flags&&(v.check=R(v.check,fa,q,X)),I-=q,X+=q,K)break a}else v.head&&(v.head.comment=null);v.mode=9;case 9:if(512&v.flags){for(;16>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if(C!==(65535&v.check)){k.msg="header crc mismatch";v.mode=30;break}D=C=0}v.head&&(v.head.hcrc=v.flags>>9&1,v.head.done=!0);k.adler=v.check=0;v.mode=12;break;case 10:for(;32>D;){if(0===I)break a;I--;C+=fa[X++]<<
D;D+=8}k.adler=v.check=w(C);D=C=0;v.mode=11;case 11:if(0===v.havedict)return k.next_out=sa,k.avail_out=Z,k.next_in=X,k.avail_in=I,v.hold=C,v.bits=D,2;k.adler=v.check=1;v.mode=12;case 12:if(5===n||6===n)break a;case 13:if(v.last){C>>>=7&D;D-=7&D;v.mode=27;break}for(;3>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}switch(v.last=1&C,C>>>=1,--D,3&C){case 0:v.mode=14;break;case 1:var pa=v;if(Ca){p=new U.Buf32(512);g=new U.Buf32(32);for(y=0;144>y;)pa.lens[y++]=8;for(;256>y;)pa.lens[y++]=9;for(;280>y;)pa.lens[y++]=
7;for(;288>y;)pa.lens[y++]=8;Ya(1,pa.lens,0,288,p,0,pa.work,{bits:9});for(y=0;32>y;)pa.lens[y++]=5;Ya(2,pa.lens,0,32,g,0,pa.work,{bits:5});Ca=!1}pa.lencode=p;pa.lenbits=9;pa.distcode=g;pa.distbits=5;if(v.mode=20,6===n){C>>>=2;D-=2;break a}break;case 2:v.mode=17;break;case 3:k.msg="invalid block type",v.mode=30}C>>>=2;D-=2;break;case 14:C>>>=7&D;for(D-=7&D;32>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if((65535&C)!==(C>>>16^65535)){k.msg="invalid stored block lengths";v.mode=30;break}if(v.length=
65535&C,C=0,D=0,v.mode=15,6===n)break a;case 15:v.mode=16;case 16:if(q=v.length){if(q>I&&(q=I),q>Z&&(q=Z),0===q)break a;U.arraySet(Ma,fa,X,q,sa);I-=q;X+=q;Z-=q;sa+=q;v.length-=q;break}v.mode=12;break;case 17:for(;14>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if(v.nlen=(31&C)+257,C>>>=5,D-=5,v.ndist=(31&C)+1,C>>>=5,D-=5,v.ncode=(15&C)+4,C>>>=4,D-=4,286<v.nlen||30<v.ndist){k.msg="too many length or distance symbols";v.mode=30;break}v.have=0;v.mode=18;case 18:for(;v.have<v.ncode;){for(;3>D;){if(0===
I)break a;I--;C+=fa[X++]<<D;D+=8}v.lens[ea[v.have++]]=7&C;C>>>=3;D-=3}for(;19>v.have;)v.lens[ea[v.have++]]=0;if(v.lencode=v.lendyn,v.lenbits=7,N={bits:v.lenbits},Ba=Ya(0,v.lens,0,19,v.lencode,0,v.work,N),v.lenbits=N.bits,Ba){k.msg="invalid code lengths set";v.mode=30;break}v.have=0;v.mode=19;case 19:for(;v.have<v.nlen+v.ndist;){for(;T=v.lencode[C&(1<<v.lenbits)-1],z=T>>>24,pa=65535&T,!(z<=D);){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if(16>pa)C>>>=z,D-=z,v.lens[v.have++]=pa;else{if(16===pa){for(y=
z+2;D<y;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if(C>>>=z,D-=z,0===v.have){k.msg="invalid bit length repeat";v.mode=30;break}K=v.lens[v.have-1];q=3+(3&C);C>>>=2;D-=2}else if(17===pa){for(y=z+3;D<y;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}C>>>=z;D-=z;K=0;q=3+(7&C);C>>>=3;D-=3}else{for(y=z+7;D<y;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}C>>>=z;D-=z;K=0;q=11+(127&C);C>>>=7;D-=7}if(v.have+q>v.nlen+v.ndist){k.msg="invalid bit length repeat";v.mode=30;break}for(;q--;)v.lens[v.have++]=K}}if(30===v.mode)break;
if(0===v.lens[256]){k.msg="invalid code -- missing end-of-block";v.mode=30;break}if(v.lenbits=9,N={bits:v.lenbits},Ba=Ya(1,v.lens,0,v.nlen,v.lencode,0,v.work,N),v.lenbits=N.bits,Ba){k.msg="invalid literal/lengths set";v.mode=30;break}if(v.distbits=6,v.distcode=v.distdyn,N={bits:v.distbits},Ba=Ya(2,v.lens,v.nlen,v.ndist,v.distcode,0,v.work,N),v.distbits=N.bits,Ba){k.msg="invalid distances set";v.mode=30;break}if(v.mode=20,6===n)break a;case 20:v.mode=21;case 21:if(6<=I&&258<=Z){k.next_out=sa;k.avail_out=
Z;k.next_in=X;k.avail_in=I;v.hold=C;v.bits=D;ba(k,da);sa=k.next_out;Ma=k.output;Z=k.avail_out;X=k.next_in;fa=k.input;I=k.avail_in;C=v.hold;D=v.bits;12===v.mode&&(v.back=-1);break}for(v.back=0;T=v.lencode[C&(1<<v.lenbits)-1],z=T>>>24,y=T>>>16&255,pa=65535&T,!(z<=D);){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if(y&&0===(240&y)){var x=z;var H=y;for(F=pa;T=v.lencode[F+((C&(1<<x+H)-1)>>x)],z=T>>>24,y=T>>>16&255,pa=65535&T,!(x+z<=D);){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}C>>>=x;D-=x;v.back+=x}if(C>>>=
z,D-=z,v.back+=z,v.length=pa,0===y){v.mode=26;break}if(32&y){v.back=-1;v.mode=12;break}if(64&y){k.msg="invalid literal/length code";v.mode=30;break}v.extra=15&y;v.mode=22;case 22:if(v.extra){for(y=v.extra;D<y;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}v.length+=C&(1<<v.extra)-1;C>>>=v.extra;D-=v.extra;v.back+=v.extra}v.was=v.length;v.mode=23;case 23:for(;T=v.distcode[C&(1<<v.distbits)-1],z=T>>>24,y=T>>>16&255,pa=65535&T,!(z<=D);){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if(0===(240&y)){x=z;H=y;for(F=
pa;T=v.distcode[F+((C&(1<<x+H)-1)>>x)],z=T>>>24,y=T>>>16&255,pa=65535&T,!(x+z<=D);){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}C>>>=x;D-=x;v.back+=x}if(C>>>=z,D-=z,v.back+=z,64&y){k.msg="invalid distance code";v.mode=30;break}v.offset=pa;v.extra=15&y;v.mode=24;case 24:if(v.extra){for(y=v.extra;D<y;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}v.offset+=C&(1<<v.extra)-1;C>>>=v.extra;D-=v.extra;v.back+=v.extra}if(v.offset>v.dmax){k.msg="invalid distance too far back";v.mode=30;break}v.mode=25;case 25:if(0===
Z)break a;if(q=da-Z,v.offset>q){if(q=v.offset-q,q>v.whave&&v.sane){k.msg="invalid distance too far back";v.mode=30;break}q>v.wnext?(q-=v.wnext,u=v.wsize-q):u=v.wnext-q;q>v.length&&(q=v.length);y=v.window}else y=Ma,u=sa-v.offset,q=v.length;q>Z&&(q=Z);Z-=q;v.length-=q;do Ma[sa++]=y[u++];while(--q);0===v.length&&(v.mode=21);break;case 26:if(0===Z)break a;Ma[sa++]=v.length;Z--;v.mode=21;break;case 27:if(v.wrap){for(;32>D;){if(0===I)break a;I--;C|=fa[X++]<<D;D+=8}if(da-=Z,k.total_out+=da,v.total+=da,da&&
(k.adler=v.check=v.flags?R(v.check,Ma,da,sa-da):O(v.check,Ma,da,sa-da)),da=Z,(v.flags?C:w(C))!==v.check){k.msg="incorrect data check";v.mode=30;break}D=C=0}v.mode=28;case 28:if(v.wrap&&v.flags){for(;32>D;){if(0===I)break a;I--;C+=fa[X++]<<D;D+=8}if(C!==(4294967295&v.total)){k.msg="incorrect length check";v.mode=30;break}D=C=0}v.mode=29;case 29:Ba=1;break a;case 30:Ba=-3;break a;case 31:return-4;default:return la}return k.next_out=sa,k.avail_out=Z,k.next_in=X,k.avail_in=I,v.hold=C,v.bits=D,(v.wsize||
da!==k.avail_out&&30>v.mode&&(27>v.mode||4!==n))&&d(k,k.output,k.next_out,da-k.avail_out)?(v.mode=31,-4):(Za-=k.avail_in,da-=k.avail_out,k.total_in+=Za,k.total_out+=da,v.total+=da,v.wrap&&da&&(k.adler=v.check=v.flags?R(v.check,Ma,da,k.next_out-da):O(v.check,Ma,da,k.next_out-da)),k.data_type=v.bits+(v.last?64:0)+(12===v.mode?128:0)+(20===v.mode||15===v.mode?256:0),(0===Za&&0===da||4===n)&&Ba===hb&&(Ba=-5),Ba)};y.inflateEnd=function(d){if(!d||!d.state)return la;var g=d.state;return g.window&&(g.window=
null),d.state=null,hb};y.inflateGetHeader=function(d,g){var k;return d&&d.state?(k=d.state,0===(2&k.wrap)?la:(k.head=g,g.done=!1,hb)):la};y.inflateSetDictionary=function(g,k){var p,n,q=k.length;return g&&g.state?(p=g.state,0!==p.wrap&&11!==p.mode?la:11===p.mode&&(n=1,n=O(n,k,q,0),n!==p.check)?-3:d(g,k,q,q)?(p.mode=31,-4):(p.havedict=1,hb)):la};y.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(k,u,y){var w=
k("../utils/common"),z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],F=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],N=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],q=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];u.exports=function(k,d,p,g,u,y,R,ba){var n,U,O,ua,S,ea,Ca=ba.bits,K,T,
qa,P,G,L=0,Qa,Ua=null,$a=0,Xa=new w.Buf16(16);var Da=new w.Buf16(16);var gb=null,v=0;for(K=0;15>=K;K++)Xa[K]=0;for(T=0;T<g;T++)Xa[d[p+T]]++;var sa=Ca;for(qa=15;1<=qa&&0===Xa[qa];qa--);if(sa>qa&&(sa=qa),0===qa)return u[y++]=20971520,u[y++]=20971520,ba.bits=1,0;for(Ca=1;Ca<qa&&0===Xa[Ca];Ca++);sa<Ca&&(sa=Ca);for(K=n=1;15>=K;K++)if(n<<=1,n-=Xa[K],0>n)return-1;if(0<n&&(0===k||1!==qa))return-1;Da[1]=0;for(K=1;15>K;K++)Da[K+1]=Da[K]+Xa[K];for(T=0;T<g;T++)0!==d[p+T]&&(R[Da[d[p+T]]++]=T);if(0===k?(Ua=gb=
R,ua=19):1===k?(Ua=z,$a-=257,gb=F,v-=257,ua=256):(Ua=N,gb=q,ua=-1),Qa=0,T=0,K=Ca,Da=y,P=sa,G=0,O=-1,L=1<<sa,g=L-1,1===k&&852<L||2===k&&592<L)return 1;for(var Ma=0;;){Ma++;var Z=K-G;R[T]<ua?(S=0,ea=R[T]):R[T]>ua?(S=gb[v+R[T]],ea=Ua[$a+R[T]]):(S=96,ea=0);n=1<<K-G;Ca=U=1<<P;do U-=n,u[Da+(Qa>>G)+U]=Z<<24|S<<16|ea|0;while(0!==U);for(n=1<<K-1;Qa&n;)n>>=1;if(0!==n?(Qa&=n-1,Qa+=n):Qa=0,T++,0===--Xa[K]){if(K===qa)break;K=d[p+R[T]]}if(K>sa&&(Qa&g)!==O){0===G&&(G=sa);Da+=Ca;P=K-G;for(n=1<<P;P+G<qa&&(n-=Xa[P+
G],!(0>=n));)P++,n<<=1;if(L+=1<<P,1===k&&852<L||2===k&&592<L)return 1;O=Qa&g;u[O]=sa<<24|P<<16|Da-y|0}}return 0!==Qa&&(u[Da+Qa]=K-G<<24|4194304),ba.bits=sa,0}},{"../utils/common":3}],13:[function(k,u,y){u.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(k,u,y){function w(d){for(var g=d.length;0<=--g;)d[g]=0}function z(d,g,k,p,n){this.static_tree=d;this.extra_bits=
g;this.extra_base=k;this.elems=p;this.max_length=n;this.has_stree=d&&d.length}function F(d,g){this.dyn_tree=d;this.max_code=0;this.stat_desc=g}function N(d,g){d.pending_buf[d.pending++]=255&g;d.pending_buf[d.pending++]=g>>>8&255}function q(d,g,k){d.bi_valid>$a-k?(d.bi_buf|=g<<d.bi_valid&65535,N(d,d.bi_buf),d.bi_buf=g>>$a-d.bi_valid,d.bi_valid+=k-$a):(d.bi_buf|=g<<d.bi_valid&65535,d.bi_valid+=k)}function n(d,g,k){q(d,k[2*g],k[2*g+1])}function d(d,g){var k=0;do k|=1&d,d>>>=1,k<<=1;while(0<--g);return k>>>
1}function p(g,k,p){var m,n=Array(Ua+1),q=0;for(m=1;m<=Ua;m++)n[m]=q=q+p[m-1]<<1;for(p=0;p<=k;p++)m=g[2*p+1],0!==m&&(g[2*p]=d(n[m]++,m))}function g(d){var g;for(g=0;g<P;g++)d.dyn_ltree[2*g]=0;for(g=0;g<G;g++)d.dyn_dtree[2*g]=0;for(g=0;g<L;g++)d.bl_tree[2*g]=0;d.dyn_ltree[2*Xa]=1;d.opt_len=d.static_len=0;d.last_lit=d.matches=0}function U(d){8<d.bi_valid?N(d,d.bi_buf):0<d.bi_valid&&(d.pending_buf[d.pending++]=d.bi_buf);d.bi_buf=0;d.bi_valid=0}function O(d,g,k,p){var m=2*g,n=2*k;return d[m]<d[n]||d[m]===
d[n]&&p[g]<=p[k]}function R(d,g,k){for(var m=d.heap[k],p=k<<1;p<=d.heap_len&&(p<d.heap_len&&O(g,d.heap[p+1],d.heap[p],d.depth)&&p++,!O(g,m,d.heap[p],d.depth));)d.heap[k]=d.heap[p],k=p,p<<=1;d.heap[k]=m}function ba(d,g,k){var m,p,v=0;if(0!==d.last_lit){do{var u=d.pending_buf[d.d_buf+2*v]<<8|d.pending_buf[d.d_buf+2*v+1];var w=d.pending_buf[d.l_buf+v];v++;0===u?n(d,w,g):(m=D[w],n(d,m+qa+1,g),p=sa[m],0!==p&&(w-=Za[m],q(d,w,p)),u--,m=256>u?C[u]:C[256+(u>>>7)],n(d,m,k),p=Ma[m],0!==p&&(u-=da[m],q(d,u,p)))}while(v<
d.last_lit)}n(d,Xa,g)}function Ya(d,g){var k,m=g.dyn_tree;var n=g.stat_desc.static_tree;var q=g.stat_desc.has_stree,v=g.stat_desc.elems,u=-1;d.heap_len=0;d.heap_max=Qa;for(k=0;k<v;k++)0!==m[2*k]?(d.heap[++d.heap_len]=u=k,d.depth[k]=0):m[2*k+1]=0;for(;2>d.heap_len;){var w=d.heap[++d.heap_len]=2>u?++u:0;m[2*w]=1;d.depth[w]=0;d.opt_len--;q&&(d.static_len-=n[2*w+1])}g.max_code=u;for(k=d.heap_len>>1;1<=k;k--)R(d,m,k);w=v;do k=d.heap[1],d.heap[1]=d.heap[d.heap_len--],R(d,m,1),n=d.heap[1],d.heap[--d.heap_max]=
k,d.heap[--d.heap_max]=n,m[2*w]=m[2*k]+m[2*n],d.depth[w]=(d.depth[k]>=d.depth[n]?d.depth[k]:d.depth[n])+1,m[2*k+1]=m[2*n+1]=w,d.heap[1]=w++,R(d,m,1);while(2<=d.heap_len);d.heap[--d.heap_max]=d.heap[1];var x,y;k=g.dyn_tree;w=g.max_code;v=g.stat_desc.static_tree;var z=g.stat_desc.has_stree,B=g.stat_desc.extra_bits,C=g.stat_desc.extra_base,D=g.stat_desc.max_length,F=0;for(q=0;q<=Ua;q++)d.bl_count[q]=0;k[2*d.heap[d.heap_max]+1]=0;for(g=d.heap_max+1;g<Qa;g++)n=d.heap[g],q=k[2*k[2*n+1]+1]+1,q>D&&(q=D,F++),
k[2*n+1]=q,n>w||(d.bl_count[q]++,x=0,n>=C&&(x=B[n-C]),y=k[2*n],d.opt_len+=y*(q+x),z&&(d.static_len+=y*(v[2*n+1]+x)));if(0!==F){do{for(q=D-1;0===d.bl_count[q];)q--;d.bl_count[q]--;d.bl_count[q+1]+=2;d.bl_count[D]--;F-=2}while(0<F);for(q=D;0!==q;q--)for(n=d.bl_count[q];0!==n;)x=d.heap[--g],x>w||(k[2*x+1]!==q&&(d.opt_len+=(q-k[2*x+1])*k[2*x],k[2*x+1]=q),n--)}p(m,u,d.bl_count)}function hb(d,g,k){var m,p=-1,n=g[1],q=0,u=7,w=4;0===n&&(u=138,w=3);g[2*(k+1)+1]=65535;for(m=0;m<=k;m++){var x=n;n=g[2*(m+1)+
1];++q<u&&x===n||(q<w?d.bl_tree[2*x]+=q:0!==x?(x!==p&&d.bl_tree[2*x]++,d.bl_tree[2*Da]++):10>=q?d.bl_tree[2*gb]++:d.bl_tree[2*v]++,q=0,p=x,0===n?(u=138,w=3):x===n?(u=6,w=3):(u=7,w=4))}}function la(d,g,k){var m,p,u=-1,w=g[1],x=0,y=7,z=4;0===w&&(y=138,z=3);for(m=0;m<=k;m++)if(p=w,w=g[2*(m+1)+1],!(++x<y&&p===w)){if(x<z){do n(d,p,d.bl_tree);while(0!==--x)}else 0!==p?(p!==u&&(n(d,p,d.bl_tree),x--),n(d,Da,d.bl_tree),q(d,x-3,2)):10>=x?(n(d,gb,d.bl_tree),q(d,x-3,3)):(n(d,v,d.bl_tree),q(d,x-11,7));x=0;u=p;
0===w?(y=138,z=3):p===w?(y=6,z=3):(y=7,z=4)}}function ua(d){var g,k=4093624447;for(g=0;31>=g;g++,k>>>=1)if(1&k&&0!==d.dyn_ltree[2*g])return Ca;if(0!==d.dyn_ltree[18]||0!==d.dyn_ltree[20]||0!==d.dyn_ltree[26])return K;for(g=32;g<qa;g++)if(0!==d.dyn_ltree[2*g])return K;return Ca}function S(d,g,k,p){q(d,(T<<1)+(p?1:0),3);U(d);N(d,k);N(d,~k);ea.arraySet(d.pending_buf,d.window,g,k,d.pending);d.pending+=k}var ea=k("../utils/common"),Ca=0,K=1,T=0,qa=256,P=qa+1+29,G=30,L=19,Qa=2*P+1,Ua=15,$a=16,Xa=256,Da=
16,gb=17,v=18,sa=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ma=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fa=Array(2*(P+2));w(fa);var I=Array(2*G);w(I);var C=Array(512);w(C);var D=Array(256);w(D);var Za=Array(29);w(Za);var da=Array(G);w(da);var Ba,pa,x,H=!1;y._tr_init=function(k){if(!H){var m,n,q,u=Array(Ua+1);for(q=n=0;28>q;q++)for(Za[q]=n,m=0;m<1<<sa[q];m++)D[n++]=
q;D[n-1]=q;for(q=n=0;16>q;q++)for(da[q]=n,m=0;m<1<<Ma[q];m++)C[n++]=q;for(n>>=7;q<G;q++)for(da[q]=n<<7,m=0;m<1<<Ma[q]-7;m++)C[256+n++]=q;for(m=0;m<=Ua;m++)u[m]=0;for(m=0;143>=m;)fa[2*m+1]=8,m++,u[8]++;for(;255>=m;)fa[2*m+1]=9,m++,u[9]++;for(;279>=m;)fa[2*m+1]=7,m++,u[7]++;for(;287>=m;)fa[2*m+1]=8,m++,u[8]++;p(fa,P+1,u);for(m=0;m<G;m++)I[2*m+1]=5,I[2*m]=d(m,5);Ba=new z(fa,sa,qa+1,P,Ua);pa=new z(I,Ma,0,G,Ua);x=new z([],Z,0,L,7);H=!0}k.l_desc=new F(k.dyn_ltree,Ba);k.d_desc=new F(k.dyn_dtree,pa);k.bl_desc=
new F(k.bl_tree,x);k.bi_buf=0;k.bi_valid=0;g(k)};y._tr_stored_block=S;y._tr_flush_block=function(d,k,p,n){var m=0;if(0<d.level){2===d.strm.data_type&&(d.strm.data_type=ua(d));Ya(d,d.l_desc);Ya(d,d.d_desc);hb(d,d.dyn_ltree,d.l_desc.max_code);hb(d,d.dyn_dtree,d.d_desc.max_code);Ya(d,d.bl_desc);for(m=L-1;3<=m&&0===d.bl_tree[2*X[m]+1];m--);m=(d.opt_len+=3*(m+1)+14,m);var u=d.opt_len+3+7>>>3;var v=d.static_len+3+7>>>3;v<=u&&(u=v)}else u=v=p+5;if(p+4<=u&&-1!==k)S(d,k,p,n);else if(4===d.strategy||v===u)q(d,
2+(n?1:0),3),ba(d,fa,I);else{q(d,4+(n?1:0),3);k=d.l_desc.max_code+1;p=d.d_desc.max_code+1;m+=1;q(d,k-257,5);q(d,p-1,5);q(d,m-4,4);for(u=0;u<m;u++)q(d,d.bl_tree[2*X[u]+1],3);la(d,d.dyn_ltree,k-1);la(d,d.dyn_dtree,p-1);ba(d,d.dyn_ltree,d.dyn_dtree)}g(d);n&&U(d)};y._tr_tally=function(d,g,k){return d.pending_buf[d.d_buf+2*d.last_lit]=g>>>8&255,d.pending_buf[d.d_buf+2*d.last_lit+1]=255&g,d.pending_buf[d.l_buf+d.last_lit]=255&k,d.last_lit++,0===g?d.dyn_ltree[2*k]++:(d.matches++,g--,d.dyn_ltree[2*(D[k]+
qa+1)]++,d.dyn_dtree[2*(256>g?C[g]:C[256+(g>>>7)])]++),d.last_lit===d.lit_bufsize-1};y._tr_align=function(d){q(d,2,3);n(d,Xa,fa);16===d.bi_valid?(N(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}},{"../utils/common":3}],15:[function(k,u,y){u.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;
this.adler=0}},{}],"/":[function(k,u,y){y=k("./lib/utils/common").assign;var w=k("./lib/deflate"),z=k("./lib/inflate");k=k("./lib/zlib/constants");var F={};y(F,w,z,k);u.exports=F},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});
var saveAs=saveAs||function(E){if(!("undefined"===typeof E||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var k=E.document.createElementNS("http://www.w3.org/1999/xhtml","a"),u="download"in k,y=/constructor/i.test(E.HTMLElement)||E.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent),z=function(d){(E.setImmediate||E.setTimeout)(function(){throw d;},0)},F=function(d){setTimeout(function(){"string"===typeof d?(E.URL||E.webkitURL||E).revokeObjectURL(d):d.remove()},4E4)},N=function(d){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?
new Blob([String.fromCharCode(65279),d],{type:d.type}):d},q=function(d,p,g){g||(d=N(d));var n=this,q="application/octet-stream"===d.type,R=function(){var d=["writestart","progress","write","writeend"];d=[].concat(d);for(var g=d.length;g--;){var k=n["on"+d[g]];if("function"===typeof k)try{k.call(n,n)}catch(ua){z(ua)}}};n.readyState=n.INIT;if(u){var ba=(E.URL||E.webkitURL||E).createObjectURL(d);setTimeout(function(){k.href=ba;k.download=p;var d=new MouseEvent("click");k.dispatchEvent(d);R();F(ba);n.readyState=
n.DONE})}else(function(){if((w||q&&y)&&E.FileReader){var g=new FileReader;g.onloadend=function(){var d=w?g.result:g.result.replace(/^data:[^;]*;/,"data:attachment/file;");E.open(d,"_blank")||(E.location.href=d);n.readyState=n.DONE;R()};g.readAsDataURL(d);n.readyState=n.INIT}else ba||(ba=(E.URL||E.webkitURL||E).createObjectURL(d)),q?E.location.href=ba:E.open(ba,"_blank")||(E.location.href=ba),n.readyState=n.DONE,R(),F(ba)})()},n=q.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(d,
k,g){k=k||d.name||"download";g||(d=N(d));return navigator.msSaveOrOpenBlob(d,k)};n.abort=function(){};n.readyState=n.INIT=0;n.WRITING=1;n.DONE=2;n.error=n.onwritestart=n.onprogress=n.onwrite=n.onabort=n.onerror=n.onwriteend=null;return function(d,k,g){return new q(d,k||d.name||"download",g)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
"undefined"!==typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!==typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs});"function"==typeof define&&define.__amd&&(define.amd=define.__amd,delete define.__amd);
