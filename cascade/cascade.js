/*
 howler.js v2.1.1 | (c) 2013-2018, James Simpson of GoldFire Studios | MIT License | howlerjs.com  Spatial Plugin  @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(H,k,v){H!=Array.prototype&&H!=Object.prototype&&(H[k]=v.value)};
$jscomp.getGlobal=function(H){H=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,H];for(var k=0;k<H.length;++k){var v=H[k];if(v&&v.Math==Math)return v}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(H,k,v,t){if(k){v=$jscomp.global;H=H.split(".");for(t=0;t<H.length-1;t++){var B=H[t];B in v||(v[B]={});v=v[B]}H=H[H.length-1];t=v[H];k=k(t);k!=t&&null!=k&&$jscomp.defineProperty(v,H,{configurable:!0,writable:!0,value:k})}};
$jscomp.polyfill("String.fromCodePoint",function(H){return H?H:function(k){for(var v="",t=0;t<arguments.length;t++){var B=Number(arguments[t]);if(0>B||1114111<B||B!==Math.floor(B))throw new RangeError("invalid_code_point "+B);65535>=B?v+=String.fromCharCode(B):(B-=65536,v+=String.fromCharCode(B>>>10&1023|55296),v+=String.fromCharCode(B&1023|56320))}return v}},"es6","es3");$jscomp.arrayIteratorImpl=function(H){var k=0;return function(){return k<H.length?{done:!1,value:H[k++]}:{done:!0}}};
$jscomp.arrayIterator=function(H){return{next:$jscomp.arrayIteratorImpl(H)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(H,k){this.$jscomp$symbol$id_=H;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:k})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function H(v){if(this instanceof H)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(v||"")+"_"+k++,v)}var k=0;return H}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var H=$jscomp.global.Symbol.iterator;H||(H=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[H]&&$jscomp.defineProperty(Array.prototype,H,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var H=$jscomp.global.Symbol.asyncIterator;H||(H=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(H){$jscomp.initSymbolIterator();H={next:H};H[$jscomp.global.Symbol.iterator]=function(){return this};return H};
$jscomp.iteratorFromArray=function(H,k){$jscomp.initSymbolIterator();H instanceof String&&(H+="");var v=0,t={next:function(){if(v<H.length){var B=v++;return{value:k(B,H[B]),done:!1}}t.next=function(){return{done:!0,value:void 0}};return t.next()}};t[Symbol.iterator]=function(){return t};return t};$jscomp.polyfill("Array.prototype.values",function(H){return H?H:function(){return $jscomp.iteratorFromArray(this,function(k,v){return v})}},"es8","es3");
$jscomp.checkStringArgs=function(H,k,v){if(null==H)throw new TypeError("The 'this' value for String.prototype."+v+" must not be null or undefined");if(k instanceof RegExp)throw new TypeError("First argument to String.prototype."+v+" must not be a regular expression");return H+""};
$jscomp.polyfill("String.prototype.startsWith",function(H){return H?H:function(k,v){var t=$jscomp.checkStringArgs(this,k,"startsWith");k+="";var B=t.length,z=k.length;v=Math.max(0,Math.min(v|0,t.length));for(var u=0;u<z&&v<B;)if(t[v++]!=k[u++])return!1;return u>=z}},"es6","es3");$jscomp.polyfill("Array.prototype.keys",function(H){return H?H:function(){return $jscomp.iteratorFromArray(this,function(k){return k})}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(H){return H?H:function(k,v){var t=$jscomp.checkStringArgs(this,k,"endsWith");k+="";void 0===v&&(v=t.length);v=Math.max(0,Math.min(v|0,t.length));for(var B=k.length;0<B&&0<v;)if(t[--v]!=k[--B])return!1;return 0>=B}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(H){return H?H:function(k,v,t){var B=this.length||0;0>v&&(v=Math.max(0,B+v));if(null==t||t>B)t=B;t=Number(t);0>t&&(t=Math.max(0,B+t));for(v=Number(v||0);v<t;v++)this[v]=k;return this}},"es6","es3");
(function(H,k){H.lime=H.lime||{};H.lime.$scripts=H.lime.$scripts||{};H.lime.$scripts.cascade=function(k,t){(function(k,v){function u(a,b){a=Object.create(a);for(var c in b)a[c]=b[c];b.toString!==Object.prototype.toString&&(a.toString=b.toString);return a}function t(a){return Math.ceil(a*Math.random())}function B(a){return a instanceof Array?new Oc(a):a.iterator()}function p(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=v.$haxeUID++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];
null==c&&(c=b.bind(a),a.hx__closures__[b.__id__]=c);return c}k.echo=k.echo||{};k.lime=k.lime||{};var d={},h=function(){return xa.__string_rec(this,"")},w=w||{},m,ea=function(){};d["lime.app.IModule"]=ea;ea.__name__=!0;ea.__isInterface__=!0;var L=function(){this.onExit=new Ac};d["lime.app.Module"]=L;L.__name__=!0;L.__interfaces__=[ea];L.prototype={__class__:L};var wa=function(a){this.gameDeviceCache=new Gb;this.parent=a;this.nextUpdate=this.lastUpdate=this.currentUpdate=0;this.framePeriod=-1;Gc.init();
this.accelerometer=pc.registerSensor(Xe.ACCELEROMETER,0)};d["lime._internal.backend.html5.HTML5Application"]=wa;wa.__name__=!0;wa.prototype={convertKeyCode:function(a){if(65<=a&&90>=a)return a+32;switch(a){case 12:return 1073741980;case 16:return 1073742049;case 17:return 1073742048;case 18:return 1073742050;case 19:return 1073741896;case 20:return 1073741881;case 33:return 1073741899;case 34:return 1073741902;case 35:return 1073741901;case 36:return 1073741898;case 37:return 1073741904;case 38:return 1073741906;
case 39:return 1073741903;case 40:return 1073741905;case 41:return 1073741943;case 43:return 1073741940;case 44:return 1073741894;case 45:return 1073741897;case 46:return 127;case 91:return 1073742051;case 92:return 1073742055;case 93:return 1073742055;case 95:return 1073742106;case 96:return 1073741922;case 97:return 1073741913;case 98:return 1073741914;case 99:return 1073741915;case 100:return 1073741916;case 101:return 1073741917;case 102:return 1073741918;case 103:return 1073741919;case 104:return 1073741920;
case 105:return 1073741921;case 106:return 1073741909;case 107:return 1073741911;case 108:return 1073741923;case 109:return 1073741910;case 110:return 1073741923;case 111:return 1073741908;case 112:return 1073741882;case 113:return 1073741883;case 114:return 1073741884;case 115:return 1073741885;case 116:return 1073741886;case 117:return 1073741887;case 118:return 1073741888;case 119:return 1073741889;case 120:return 1073741890;case 121:return 1073741891;case 122:return 1073741892;case 123:return 1073741893;
case 124:return 1073741928;case 125:return 1073741929;case 126:return 1073741930;case 127:return 1073741931;case 128:return 1073741932;case 129:return 1073741933;case 130:return 1073741934;case 131:return 1073741935;case 132:return 1073741936;case 133:return 1073741937;case 134:return 1073741938;case 135:return 1073741939;case 144:return 1073741907;case 145:return 1073741895;case 160:return 94;case 161:return 33;case 163:return 35;case 164:return 36;case 166:return 1073742094;case 167:return 1073742095;
case 168:return 1073742097;case 169:return 41;case 170:return 42;case 171:return 96;case 172:return 1073741898;case 173:return 45;case 174:return 1073741953;case 175:return 1073741952;case 176:return 1073742082;case 177:return 1073742083;case 178:return 1073742084;case 179:return 1073742085;case 180:return 1073742089;case 181:return 1073742086;case 182:return 1073741953;case 183:return 1073741952;case 186:return 59;case 187:return 61;case 188:return 44;case 189:return 45;case 190:return 46;case 191:return 47;
case 192:return 96;case 193:return 63;case 194:return 1073741923;case 219:return 91;case 220:return 92;case 221:return 93;case 222:return 39;case 223:return 96;case 224:return 1073742051;case 226:return 92}return a},exec:function(){window.addEventListener("keydown",p(this,this.handleKeyEvent),!1);window.addEventListener("keyup",p(this,this.handleKeyEvent),!1);window.addEventListener("focus",p(this,this.handleWindowEvent),!1);window.addEventListener("blur",p(this,this.handleWindowEvent),!1);window.addEventListener("resize",
p(this,this.handleWindowEvent),!1);window.addEventListener("beforeunload",p(this,this.handleWindowEvent),!1);window.addEventListener("devicemotion",p(this,this.handleSensorEvent),!1);CanvasRenderingContext2D.prototype.isPointInStroke||(CanvasRenderingContext2D.prototype.isPointInStroke=function(a,b,c){return!1});CanvasRenderingContext2D.prototype.isPointInPath||(CanvasRenderingContext2D.prototype.isPointInPath=function(a,b,c){return!1});0=="performance"in window&&(window.performance={});if(0=="now"in
window.performance){var a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart);window.performance.now=function(){return Date.now()-a}}for(var b=0,c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"]||window[c[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=
function(a,c){var e=(new Date).getTime(),f=Math.max(0,16-(e-b));c=window.setTimeout(function(){a(e+f)},f);b=e+f;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});window.requestAnimFrame=window.requestAnimationFrame;this.lastUpdate=(new Date).getTime();this.handleApplicationEvent();return 0},exit:function(){},handleApplicationEvent:function(a){a=0;for(var b=this.parent.__windows;a<b.length;){var c=b[a];++a;c.__backend.updateSize()}this.updateGameDevices();
this.currentUpdate=(new Date).getTime();if(this.currentUpdate>=this.nextUpdate){this.deltaTime=this.currentUpdate-this.lastUpdate;a=0;for(b=this.parent.__windows;a<b.length;)c=b[a],++a,this.parent.onUpdate.dispatch(this.deltaTime|0),null!=c.context&&c.onRender.dispatch(c.context);this.nextUpdate=0>this.framePeriod?this.currentUpdate:this.currentUpdate-this.currentUpdate%this.framePeriod+this.framePeriod;this.lastUpdate=this.currentUpdate}window.requestAnimationFrame(p(this,this.handleApplicationEvent))},
handleKeyEvent:function(a){if(null!=this.parent.__window){var b=this.convertKeyCode(null!=a.keyCode?a.keyCode:a.which),c=(a.shiftKey?3:0)|(a.ctrlKey?192:0)|(a.altKey?768:0)|(a.metaKey?3072:0);"keydown"==a.type?(this.parent.__window.onKeyDown.dispatch(b,c),this.parent.__window.onKeyDown.canceled&&a.cancelable&&a.preventDefault()):(this.parent.__window.onKeyUp.dispatch(b,c),this.parent.__window.onKeyUp.canceled&&a.cancelable&&a.preventDefault())}},handleSensorEvent:function(a){this.accelerometer.onUpdate.dispatch(a.accelerationIncludingGravity.x,
a.accelerationIncludingGravity.y,a.accelerationIncludingGravity.z)},handleWindowEvent:function(a){if(null!=this.parent.__window)switch(a.type){case "blur":this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0);break;case "focus":this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1);break;case "resize":this.parent.__window.__backend.handleResizeEvent(a);break;case "visibilitychange":window.document.hidden?
this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0):this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1)}},updateGameDevices:function(){var a=$a.__getDeviceData();if(null!=a)for(var b,c,e,f,g,x=0,l=a.length;x<l;)if(b=x++,f=a[b],null!=f){if(!this.gameDeviceCache.h.hasOwnProperty(b)){g=new Sd;g.id=b;g.connected=f.connected;c=0;for(e=f.buttons.length;c<e;){var d=c++;g.buttons.push(f.buttons[d].value)}c=
0;for(e=f.axes.length;c<e;)d=c++,g.axes.push(f.axes[d]);"standard"==f.mapping&&(g.isGamepad=!0);this.gameDeviceCache.h[b]=g;f.connected&&($a.__connect(b),g.isGamepad&&bb.__connect(b))}g=this.gameDeviceCache.h[b];e=$a.devices.h[b];c=bb.devices.h[b];if(f.connected){for(var la=0,A=f.buttons.length;la<A;){var r=la++;d=f.buttons[r].value;if(d!=g.buttons[r]){if(6==r)e.onAxisMove.dispatch(f.axes.length,d),null!=c&&c.onAxisMove.dispatch(4,d);else if(7==r)e.onAxisMove.dispatch(f.axes.length+1,d),null!=c&&
c.onAxisMove.dispatch(5,d);else if(0<d?e.onButtonDown.dispatch(r):e.onButtonUp.dispatch(r),null!=c){switch(r){case 0:b=0;break;case 1:b=1;break;case 2:b=2;break;case 3:b=3;break;case 4:b=9;break;case 5:b=10;break;case 8:b=4;break;case 9:b=6;break;case 10:b=7;break;case 11:b=8;break;case 12:b=11;break;case 13:b=12;break;case 14:b=13;break;case 15:b=14;break;case 16:b=5;break;default:continue}0<d?c.onButtonDown.dispatch(b):c.onButtonUp.dispatch(b)}g.buttons[r]=d}}b=0;for(d=f.axes.length;b<d;)la=b++,
f.axes[la]!=g.axes[la]&&(e.onAxisMove.dispatch(la,f.axes[la]),null!=c&&c.onAxisMove.dispatch(la,f.axes[la]),g.axes[la]=f.axes[la])}else g.connected&&(g.connected=!1,$a.__disconnect(b),bb.__disconnect(b))}},__class__:wa};var fa=function(){this.onCreateWindow=new Td;this.onUpdate=new Ac;this.onExit=new Ac;null==fa.current&&(fa.current=this);this.meta=new S;this.modules=[];this.__windowByID=new Gb;this.__windows=[];this.__backend=new wa(this);this.__registerLimeModule(this);this.__preloader=new Ud;this.__preloader.onProgress.add(p(this,
this.onPreloadProgress));this.__preloader.onComplete.add(p(this,this.onPreloadComplete))};d["lime.app.Application"]=fa;fa.__name__=!0;fa.__super__=L;fa.prototype=u(L.prototype,{createWindow:function(a){a=this.__createWindow(a);this.__addWindow(a);return a},exec:function(){fa.current=this;return this.__backend.exec()},onGamepadAxisMove:function(a,b,c){},onGamepadButtonDown:function(a,b){},onGamepadButtonUp:function(a,b){},onGamepadConnect:function(a){},onGamepadDisconnect:function(a){},onJoystickAxisMove:function(a,
b,c){},onJoystickButtonDown:function(a,b){},onJoystickButtonUp:function(a,b){},onJoystickConnect:function(a){},onJoystickDisconnect:function(a){},onJoystickHatMove:function(a,b,c){},onJoystickTrackballMove:function(a,b,c,e){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onModuleExit:function(a){},onMouseDown:function(a,b,c){},onMouseMove:function(a,b){},onMouseMoveRelative:function(a,b){},onMouseUp:function(a,b,c){},onMouseWheel:function(a,b,c){},onPreloadComplete:function(){},onPreloadProgress:function(a,
b){},onRenderContextLost:function(){},onRenderContextRestored:function(a){},onTextEdit:function(a,b,c){},onTextInput:function(a){},onTouchCancel:function(a){},onTouchEnd:function(a){},onTouchMove:function(a){},onTouchStart:function(a){},onWindowActivate:function(){},onWindowClose:function(){},onWindowCreate:function(){},onWindowDeactivate:function(){},onWindowDropFile:function(a){},onWindowEnter:function(){},onWindowExpose:function(){},onWindowFocusIn:function(){},onWindowFocusOut:function(){},onWindowFullscreen:function(){},
onWindowLeave:function(){},onWindowMove:function(a,b){},onWindowMinimize:function(){},onWindowResize:function(a,b){},onWindowRestore:function(){},render:function(a){},update:function(a){},__addWindow:function(a){if(null!=a){this.__windows.push(a);this.__windowByID.h[a.id]=a;var b=p(this,this.__onWindowClose);a.onClose.add(function(){b(a)},!1,-1E4);null==this.__window&&(this.__window=a,a.onActivate.add(p(this,this.onWindowActivate)),a.onRenderContextLost.add(p(this,this.onRenderContextLost)),a.onRenderContextRestored.add(p(this,
this.onRenderContextRestored)),a.onDeactivate.add(p(this,this.onWindowDeactivate)),a.onDropFile.add(p(this,this.onWindowDropFile)),a.onEnter.add(p(this,this.onWindowEnter)),a.onExpose.add(p(this,this.onWindowExpose)),a.onFocusIn.add(p(this,this.onWindowFocusIn)),a.onFocusOut.add(p(this,this.onWindowFocusOut)),a.onFullscreen.add(p(this,this.onWindowFullscreen)),a.onKeyDown.add(p(this,this.onKeyDown)),a.onKeyUp.add(p(this,this.onKeyUp)),a.onLeave.add(p(this,this.onWindowLeave)),a.onMinimize.add(p(this,
this.onWindowMinimize)),a.onMouseDown.add(p(this,this.onMouseDown)),a.onMouseMove.add(p(this,this.onMouseMove)),a.onMouseMoveRelative.add(p(this,this.onMouseMoveRelative)),a.onMouseUp.add(p(this,this.onMouseUp)),a.onMouseWheel.add(p(this,this.onMouseWheel)),a.onMove.add(p(this,this.onWindowMove)),a.onRender.add(p(this,this.render)),a.onResize.add(p(this,this.onWindowResize)),a.onRestore.add(p(this,this.onWindowRestore)),a.onTextEdit.add(p(this,this.onTextEdit)),a.onTextInput.add(p(this,this.onTextInput)),
this.onWindowCreate());this.onCreateWindow.dispatch(a)}},__createWindow:function(a){a=new Vd(this,a);return-1==a.id?null:a},__registerLimeModule:function(a){a.onUpdate.add(p(this,this.update));a.onExit.add(p(this,this.onModuleExit),!1,0);a.onExit.add(p(this,this.__onModuleExit),!1,0);for(a=bb.devices.iterator();a.hasNext();){var b=a.next();this.__onGamepadConnect(b)}bb.onConnect.add(p(this,this.__onGamepadConnect));for(a=$a.devices.iterator();a.hasNext();)b=a.next(),this.__onJoystickConnect(b);$a.onConnect.add(p(this,
this.__onJoystickConnect));Lb.onCancel.add(p(this,this.onTouchCancel));Lb.onStart.add(p(this,this.onTouchStart));Lb.onMove.add(p(this,this.onTouchMove));Lb.onEnd.add(p(this,this.onTouchEnd))},__removeWindow:function(a){null!=a&&this.__windowByID.h.hasOwnProperty(a.id)&&(this.__window==a&&(this.__window=null),K.remove(this.__windows,a),this.__windowByID.remove(a.id),a.close(),0==this.__windows.length&&Ub.exit(0))},__onGamepadConnect:function(a){this.onGamepadConnect(a);var b=p(this,this.onGamepadAxisMove),
c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=p(this,this.onGamepadButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);var f=p(this,this.onGamepadButtonUp);c=function(b){f(a,b)};a.onButtonUp.add(c);var g=p(this,this.onGamepadDisconnect);a.onDisconnect.add(function(){g(a)})},__onJoystickConnect:function(a){this.onJoystickConnect(a);var b=p(this,this.onJoystickAxisMove),c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=p(this,this.onJoystickButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);
var f=p(this,this.onJoystickButtonUp);c=function(b){f(a,b)};a.onButtonUp.add(c);var g=p(this,this.onJoystickDisconnect);a.onDisconnect.add(function(){g(a)});var x=p(this,this.onJoystickHatMove);c=function(b,c){x(a,b,c)};a.onHatMove.add(c);var l=p(this,this.onJoystickTrackballMove);c=function(b,c,e){l(a,b,c,e)};a.onTrackballMove.add(c)},__onModuleExit:function(a){this.__backend.exit()},__onWindowClose:function(a){if(this.__window==a)this.onWindowClose();this.__removeWindow(a)},__class__:fa});var z=
function(){};d.ApplicationMain=z;z.__name__=!0;z.main=function(){Ub.__registerEntryPoint("cascade",z.create)};z.create=function(a){ya.init(a);var b=new C;b.meta.h.build="1";b.meta.h.company="ob";b.meta.h.file="cascade";b.meta.h.name="tyke";b.meta.h.packageName="tyke";b.meta.h.version="0.0.1";var c={allowHighDPI:!1,alwaysOnTop:!1,borderless:!1,element:null,frameRate:60,height:496,hidden:!1,maximized:!1,minimized:!1,parameters:{},resizable:!0,title:"tyke",width:800,x:null,y:null,context:{antialiasing:0,
background:16777215,colorDepth:32,depth:!0,hardware:!0,stencil:!1,type:null,vsync:!0}};if(null==b.__window&&null!=a)for(var e=0,f=R.fields(a);e<f.length;){var g=f[e];++e;Object.prototype.hasOwnProperty.call(c,g)?c[g]=R.field(a,g):Object.prototype.hasOwnProperty.call(c.context,g)&&(c.context[g]=R.field(a,g))}b.createWindow(c);e=0;for(f=ya.preloadLibraries;e<f.length;)a=f[e],++e,b.__preloader.addLibrary(a);e=0;for(f=ya.preloadLibraryNames;e<f.length;)a=f[e],++e,b.__preloader.addLibraryName(a);b.__preloader.load();
z.start(b)};z.start=function(a){a.exec()};var H=function(a,b,c,e,f,g,x,l,d){this.displayColumns=a;this.displayRows=b;this.playableColumnsWidth=c;this.displayPixelsWide=e;this.displayPixelsHigh=f;this.playBoundsLeft=g;this.playBoundsRight=x;this.playBoundsTop=l;this.playBoundsBottom=d};d.ScreenGeometry=H;H.__name__=!0;H.prototype={__class__:H};var ma=function(){};d["ob.gum.ILoop"]=ma;ma.__name__=!0;ma.__isInterface__=!0;ma.prototype={__class__:ma};var V=function(){};d["ob.gum.backends.PeoteViewLoop"]=
V;V.__name__=!0;V.__interfaces__=[ma];V.prototype={onInit:function(a){this.gum=a;this.peoteView=new Wd(a.window);this.w=null==a.config.displayWidth?a.window.__width:a.config.displayWidth;this.h=null==a.config.displayHeight?a.window.__height:a.config.displayHeight;this.ratio=this.w/this.h;this.display=new Xd(0,0,a.window.__width,a.window.__height,255);this.peoteView.addDisplay(this.display);this.peoteView.start();this.setZoom()},setZoom:function(){var a=this.display,b=this.gum.window.__width/this.w|
0;a.xz=a.zoom*b;if(X.isUBO){var c=a.uniformBuffer,e=a.gl;c.uniformBytes.b_UFloat32[2]=a.xz;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,8,c.xZoomBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null);c=a.uniformBufferFB;e=a.gl;c.uniformBytes.b_UFloat32[2]=a.xz;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,8,c.xZoomBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}a.xZoom=b;a=this.display;b=this.gum.window.__height/this.h|0;a.yz=a.zoom*
b;X.isUBO&&(c=a.uniformBuffer,e=a.gl,c.uniformBytes.b_UFloat32[3]=a.yz,e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer),e.bufferSubData(e.UNIFORM_BUFFER,12,c.yZoomBufferPointer),e.bindBuffer(e.UNIFORM_BUFFER,null),c=a.uniformBufferFB,e=a.gl,c.uniformBytes.b_UFloat32[3]=a.yz,e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer),e.bufferSubData(e.UNIFORM_BUFFER,12,c.yZoomBufferPointer),e.bindBuffer(e.UNIFORM_BUFFER,null));a.yZoom=b;this.display.width=this.gum.window.__width;this.display.height=this.gum.window.__height},
onUpdate:function(a){},onTick:function(a){return!1},onDraw:function(a){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){this.peoteView.resize(a,b);this.setZoom()},__class__:V};var ca=function(a,b,c){this.alwaysDraw=!1;this.onInitComplete=function(){};this.data=a;this.assets=b;this.palette=null!=c?c:new Yd(tc.toRGBA(Ne.Versitle));this.layers=[];this.keyboard=
new Zd([]);this.mouse=new $d};d["tyke.GlyphLoop"]=ca;ca.__name__=!0;ca.__super__=V;ca.prototype=u(V.prototype,{onInit:function(a){var b=this;V.prototype.onInit.call(this,a);this.assets.Preload(function(){b.text=Oe.initText(b.display,b.assets.fontCache[0]);b.display.addProgram(b.text.fontProgram);b.onInitComplete()})},onTick:function(a){for(var b=!1,c=0,e=this.layers;c<e.length;){var f=e[c];++c;f.onTick(a);f.hasChanged&&(b=!0)}return this.alwaysDraw?!0:b},onDraw:function(a){a=0;for(var b=this.layers;a<
b.length;){var c=b[a];++a;c.hasChanged&&(c.draw(),c.hasChanged=!1)}this.text.fontProgram._buffer.update()},onKeyDown:function(a,b){this.keyboard.handle(a,this)},onMouseDown:function(a,b,c){this.mouse.onDown(a,b,c)},onMouseUp:function(a,b,c){this.mouse.onUp(a,b,c)},onMouseMove:function(a,b){this.mouse.onMove(a,b)},__class__:ca});var na=function(a,b,c){ca.call(this,a,b,c);this.onInitComplete=p(this,this.begin)};d.Cascade=na;na.__name__=!0;na.__super__=ca;na.prototype=u(ca.prototype,{getInitFor:function(a,
b,c,e){var f=this,g=b;return function(a,l){var x=a*f.text.fontStyle.width,d=l*f.text.fontStyle.height,A=K.cca(" ",0);a<e.playBoundsLeft||a>e.playBoundsRight?A=K.cca(" ",0):l<e.playBoundsTop?(A=K.cca("0",0),b=7):l<e.playBoundsBottom&&(b=g,A=t(8)-1,A=K.cca("ABCDEFGHIJKLMNOPQRSTUVWYZ",A));a=f.text.fontProgram;l=f.text.fontStyle;var r=a.font;r=A>=r.rangeMapping.min&&A<=r.rangeMapping.max?r.rangeMapping:null;if(null!=r){var h=new ia;l=null!=l?l:a.fontStyle;h.width=l.width;h.height=l.height;h.color=l.color;
h.bgColor=l.bgColor;h.weight=l.weight;h.tilt=l.tilt;h.zIndex=l.zIndex;h.char=A;h.tile=A-r.min;h.x=x;h.y=d;a._buffer.addElement(h);x=h}else x=null;return new dd(A,x,b,c,1)}},begin:function(){var a=this;this.gum.setTickDuration(Math.floor(1E3/(2*this.gum.config.framesPerSecond)));var b=Math.ceil(this.display.width/this.text.fontStyle.width),c=.5*(b-19)|0;this.geometry=new H(b,Math.ceil(this.display.height/this.text.fontStyle.height),19,this.display.width,this.display.height,c-1,b-c,3,12);b=new ae(this.geometry.displayColumns,
this.geometry.displayRows,Math.ceil(this.text.fontStyle.width),Math.ceil(this.text.fontStyle.height),this.palette,this.getInitFor(" ",1,3,this.geometry));this.playWidth=b.numColumns*b.cellWidth;this.playHeight=b.numRows*b.cellHeight;this.cascade=new P(b,this.text.fontProgram,this.geometry);this.layers=[this.cascade];this.isPlayerOnLeft=!0;this.mouse.onDown=function(b,c,g){a.isCascading||(b=a.cascade.screenToGrid(b,c,a.playWidth,a.playHeight),b=a.cascade.get(b.x,b.y),b.char!=a.cascade.emptyChar&&b.char>=
a.cascade.minChar&&(a.cascade.clearAllMatching(b.char),a.isCascading=!0))};this.gum.toggleUpdate(!0)},onTick:function(a){this.isCascading&&(this.cascade.changed(this.isPlayerOnLeft)?this.cascade.hasChanged=!0:(this.isCascading=!1,this.swapPlayer(),this.cascade.showPlayerTurn(this.isPlayerOnLeft)));return ca.prototype.onTick.call(this,a)},swapPlayer:function(){this.isPlayerOnLeft=!this.isPlayerOnLeft},__class__:na});var M=function(a,b){this.numColumns=a;this.numRows=b};d["tyke.GridLogic"]=M;M.__name__=
!0;M.prototype={column:function(a){return a%this.numColumns|0},row:function(a){return a/this.numColumns|0},index:function(a,b){return a+this.numColumns*b},__class__:M};var da=function(a,b,c){M.call(this,a,b);this.cellInit=c;this.init()};d["tyke.GridStructure"]=da;da.__name__=!0;da.__super__=M;da.prototype=u(M.prototype,{init:function(){this.cells=[];for(var a=0,b=this.numColumns*this.numRows;a<b;){var c=a++,e=this.column(c);c=this.row(c);this.cells.push(this.cellInit(e,c))}},forEachCanExitEarly:function(a,
b){null==b&&(b=!1);var c;if(b)for(b=this.cells.length;0<b--&&!(c=a(this.column(b),this.row(b),this.cells[b])););else for(var e=0,f=this.cells;e<f.length&&!(c=f[e],b=e++,c=a(this.column(b),this.row(b),c)););},indexesInSection:function(a,b,c,e){var f=new M(c,e),g=[],x=0;for(c*=e;x<c;){var l=x++;e=f.column(l)+a;l=f.row(l)+b;g.push(this.index(e,l))}return g},get:function(a,b){return this.cells[this.index(a,b)]},__class__:da});var qa=function(a,b){this.hasChanged=!1;da.call(this,a.numColumns,a.numRows,
a.cellInit);this.palette=a.palette;this.fontProgram=b;b.fontStyle.bgColor=0;null==a.cellInit&&(a.cellInit=function(c,e){c*=a.cellWidth;e*=a.cellHeight;var f=b.fontStyle,g=b.font;g=32>=g.rangeMapping.min&&32<=g.rangeMapping.max?g.rangeMapping:null;if(null!=g){var x=new ia;f=null!=f?f:b.fontStyle;x.width=f.width;x.height=f.height;x.color=f.color;x.bgColor=f.bgColor;x.weight=f.weight;x.tilt=f.tilt;x.zIndex=f.zIndex;x.char=32;x.tile=32-g.min;x.x=c;x.y=e;b._buffer.addElement(x);c=x}else c=null;return new dd(0,
c,10,-1,1)})};d["tyke.GlyphGrid"]=qa;qa.__name__=!0;qa.__super__=da;qa.prototype=u(da.prototype,{onTick:function(a){},draw:function(){for(var a=0,b=this.cells;a<b.length;){var c=b[a];a++;var e=c;e.glyph.color=this.palette.colorOrDefault(e.paletteIndexFg);c=this.palette.colorOrDefault(e.paletteIndexBg);0<e.paletteIndexBg&&(e.glyph.bgColor=tc.changeAlpha(c,Math.ceil(255*e.bgIntensity)));var f=this.fontProgram;c=e.glyph;e=0==e.char?K.cca(" ",0):e.char;f=f.font;f=e>=f.rangeMapping.min&&e<=f.rangeMapping.max?
f.rangeMapping:null;null!=f&&(c.char=e,c.tile=e-f.min)}},screenToGrid:function(a,b,c,e){return new Hc(Math.floor(a/c*(c/this.fontProgram.fontStyle.width)),Math.floor(b/e*(e/this.fontProgram.fontStyle.height)))},writeText:function(a,b,c,e){null==e&&(e=0);c=c.split("");var f=0;for(e=0==e?c.length:e;f<e;){var g=f++,x=g<c.length?c[g]:" ";ja.trace("column "+a+" "+x,{fileName:"tyke/Layers.hx",lineNumber:101,className:"tyke.GlyphGrid",methodName:"writeText"});g=this.get(a+g,b);g.char=K.cca(x,0);g.paletteIndexFg=
9}this.hasChanged=!0},__class__:qa});var P=function(a,b,c){this.modRemove=K.cca("-",0);this.modAdd=K.cca("+",0);this.canFallTo=[new Hc(0,1),new Hc(1,1),new Hc(-1,1)];this.treasureChar=K.cca("0",0);this.minChar=K.cca("A",0);this.emptyChar=K.cca(" ",0);qa.call(this,a,b);this.geometry=c;this.clickableIndexes=this.indexesInSection(this.geometry.playBoundsLeft,this.geometry.playBoundsTop,this.geometry.playableColumnsWidth+3,this.geometry.playBoundsBottom-this.geometry.playBoundsTop);this.initModifiers();
this.initPlayers();this.showPlayerTurn(!0)};d.CascadeLayer=P;P.__name__=!0;P.__super__=qa;P.prototype=u(qa.prototype,{setupPlayer:function(a){return new T(a,0,[])},setupScoreBoard:function(a,b,c){return new Sa(new Hc(a,b),c,0,3,5,1)},clearAllMatching:function(a){for(var b=0,c=0,e=this.clickableIndexes;c<e.length;){var f=e[c];++c;f=this.cells[f];f.char==a&&(f.char=this.emptyChar,++b,this.hasChanged=!0)}},moved:function(a,b,c,e){b=this.get(b,c);c=b.char==this.modAdd||b.char==this.modRemove;if(b.char==
this.emptyChar||c){if(c){var f=b.char==this.modAdd?1:-1;(e?this.player1:this.player2).modifiers.push(new Ya(b.char,function(a){return a*f}))}b.char=a.char;b.paletteIndexFg=a.paletteIndexFg;a.char=this.emptyChar;return!0}return!1},isInPlayableBounds:function(a,b){return a>=this.geometry.playBoundsLeft&&0<=b&&a<=this.geometry.playBoundsRight?b<this.numRows:!1},changed:function(a){var b=this,c=!1,e=a?this.player1:this.player2,f=a?this.player1ScoreBoard:this.player2ScoreBoard;this.forEachCanExitEarly(function(g,
x,l){if(l.char==b.treasureChar)if(x!=b.numRows-1)for(var d=0,la=b.canFallTo;d<la.length;){var A=la[d];++d;var r=A.x+g;A=A.y+x;if(b.isInPlayableBounds(r,A)&&b.moved(l,r,A,a)){c=!0;break}}else{l.char=b.emptyChar;c=!0;e.score+=5;g=0;for(x=e.modifiers;g<x.length;)l=x[g],g++,e.score+=l.scoreMod(5);b.writeText(f.position.x,f.scoreRow,"# "+e.score,f.width)}c&&b.updateModText(e,f,5);return c},!0);return c},initModifiers:function(){var a=this.geometry.playBoundsTop+1;a=this.indexesInSection(this.geometry.playBoundsLeft,
a,this.geometry.playableColumnsWidth+2,this.geometry.playBoundsBottom-a-1);var b=this.modRemove,c=a[t(a.length)-1];this.cells[c].char=b;this.cells[c].paletteIndexFg=15;b=this.modAdd;c=a[t(a.length)-1];this.cells[c].char=b;this.cells[c].paletteIndexFg=15;b=this.modRemove;c=a[t(a.length)-1];this.cells[c].char=b;this.cells[c].paletteIndexFg=15;b=this.modAdd;c=a[t(a.length)-1];this.cells[c].char=b;this.cells[c].paletteIndexFg=15},initPlayers:function(){this.player1=this.setupPlayer("Player 1");this.player2=
this.setupPlayer("Player 2");this.player1ScoreBoard=this.setupScoreBoard(0,2,this.geometry.playBoundsLeft);this.player2ScoreBoard=this.setupScoreBoard(this.geometry.playBoundsRight+1,2,this.geometry.playBoundsLeft);this.writeText(this.player1ScoreBoard.position.x,this.player1ScoreBoard.nameRow,this.player1.name,this.player1ScoreBoard.width);this.writeText(this.player2ScoreBoard.position.x,this.player2ScoreBoard.nameRow,this.player2.name,this.player2ScoreBoard.width);this.updateModText(this.player1,
this.player1ScoreBoard,5);this.updateModText(this.player2,this.player2ScoreBoard,5)},showPlayerTurn:function(a){var b=a?this.player1ScoreBoard:this.player2ScoreBoard;a=a?this.player2ScoreBoard:this.player1ScoreBoard;this.writeText(b.position.x,b.turnIndicatorRow,"-------^",b.width);this.writeText(a.position.x,a.turnIndicatorRow,"        ",a.width)},updateModText:function(a,b,c){var e=b.position.x+1,f=b.width-1;this.writeText(e,b.modsRow,"+"+c,f);var g=0;for(a=a.modifiers;g<a.length;){var x=a[g],l=
g++;this.writeText(e,b.modsRow+l+1,""+String.fromCodePoint(x.charCode)+c,f)}},__class__:P});var T=function(a,b,c){this.name=a;this.score=b;this.modifiers=c};d.Player=T;T.__name__=!0;T.prototype={__class__:T};var Sa=function(a,b,c,e,f,g){this.position=a;this.width=b;this.nameRow=c;this.scoreRow=e;this.modsRow=f;this.turnIndicatorRow=g};d.ScoreBoard=Sa;Sa.__name__=!0;Sa.prototype={__class__:Sa};var Ya=function(a,b){this.charCode=a;this.scoreMod=b};d.Modifier=Ya;Ya.__name__=!0;Ya.prototype={__class__:Ya};
var Ca=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};d.EReg=Ca;Ca.__name__=!0;Ca.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw y.thrown("EReg::matched");},matchedRight:function(){if(null==this.r.m)throw y.thrown("No string matched");var a=this.r.m.index+this.r.m[0].length;return K.substr(this.r.s,a,this.r.s.length-a)},matchedPos:function(){if(null==
this.r.m)throw y.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(a,b,c){null==c&&(c=-1);if(this.r.global){if(this.r.lastIndex=b,this.r.m=this.r.exec(0>c?a:K.substr(a,0,b+c)),c=null!=this.r.m)this.r.s=a}else if(c=this.match(0>c?K.substr(a,b,null):K.substr(a,b,c)))this.r.s=a,this.r.m.index+=b;return c},map:function(a,b){for(var c=0,e="";!(c>=a.length);){if(!this.matchSub(a,c)){e+=E.string(K.substr(a,c,null));break}var f=this.matchedPos();e+=E.string(K.substr(a,
c,f.pos-c));e+=E.string(b(this));0==f.len?(e+=E.string(K.substr(a,f.pos,1)),c=f.pos+1):c=f.pos+f.len;if(!this.r.global)break}!this.r.global&&0<c&&c<a.length&&(e+=E.string(K.substr(a,c,null)));return e},__class__:Ca};var K=function(){};d.HxOverrides=K;K.__name__=!0;K.strDate=function(a){switch(a.length){case 8:a=a.split(":");var b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:return a=a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);case 19:return a=
a.split(" "),b=a[0].split("-"),a=a[1].split(":"),new Date(b[0],b[1]-1,b[2],a[0],a[1],a[2]);default:throw y.thrown("Invalid date format : "+a);}};K.cca=function(a,b){a=a.charCodeAt(b);if(a==a)return a};K.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};K.remove=function(a,b){b=a.indexOf(b);if(-1==b)return!1;a.splice(b,1);return!0};K.now=function(){return Date.now()};var I=function(a,b,c){this.errors=a;this.putils=b;this.errorType=c};
d["json2object.reader.BaseParser"]=I;I.__name__=!0;I.prototype={fromJson:function(a,b){null==b&&(b="");this.putils=new be(a);this.errors=[];try{var c=(new ce(a,b)).doParse();this.loadJson(c)}catch(e){if(oa.lastError=e,a=y.caught(e).unwrap(),a instanceof Ob)this.errors.push(ua.ParserError(a.message,this.putils.convertPosition(a.pos)));else throw e;}return this.value},loadJson:function(a,b){null==b&&(b="");var c=this.putils.convertPosition(a.pos);a=a.value;switch(a._hx_index){case 0:this.loadJsonString(a.s,
c,b);break;case 1:this.loadJsonNumber(a.s,c,b);break;case 2:this.loadJsonObject(a.fields,c,b);break;case 3:this.loadJsonArray(a.values,c,b);break;case 4:this.loadJsonBool(a.b,c,b);break;case 5:this.loadJsonNull(c,b)}return this.value},loadJsonNull:function(a,b){this.onIncorrectType(a,b)},loadJsonString:function(a,b,c){this.onIncorrectType(b,c)},loadJsonNumber:function(a,b,c){this.onIncorrectType(b,c)},loadJsonUInt:function(a,b,c,e){var f=0;a=za.trim(a);"-"==a.charAt(0)&&(a=K.substr(a,1,null));var g=
za.startsWith(a,"0x");g&&(a=K.substr(a,2,null));for(var x=g?16:10,l=1,d=a.length-1;0<=d;){var la=g?E.parseInt("0x"+a.charAt(d)):E.parseInt(a.charAt(d));if(null==la)return this.onIncorrectType(b,c),e;f+=l*la;l*=x;--d}return f},loadJsonInt:function(a,b,c,e){if(null!=E.parseInt(a)&&E.parseInt(a)==parseFloat(a))return E.parseInt(a);this.onIncorrectType(b,c);return e},loadJsonFloat:function(a,b,c,e){if(null!=E.parseInt(a))return parseFloat(a);this.onIncorrectType(b,c);return e},loadJsonBool:function(a,
b,c){this.onIncorrectType(b,c)},loadJsonArray:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArrayValue:function(a,b,c){for(var e=[],f=0;f<a.length;){var g=a[f];++f;try{var x=b(g,c)}catch(l){if(oa.lastError=l,g=y.caught(l).unwrap(),xa.__instanceof(g,qb)){if(g!=qb.ParsingThrow)throw y.thrown(g);continue}else throw l;}e.push(x)}return e},loadJsonObject:function(a,b,c){this.onIncorrectType(b,c)},loadObjectField:function(a,b,c,e,f,g){try{var x=a(b.value,b.name);this.mapSet(e,c,!0);return x}catch(l){if(oa.lastError=
l,a=y.caught(l).unwrap(),xa.__instanceof(a,qb)){if(a!=qb.ParsingThrow)throw y.thrown(a);}else this.errors.push(ua.CustomFunctionException(a,g))}return f},objectSetupAssign:function(a,b,c){for(var e=0,f=b.length;e<f;){var g=e++;this.mapSet(a,b[g],c[g])}},objectErrors:function(a,b){b=this.putils.convertPosition(new Da(b.file,b.max-1,b.max-1));for(var c=Object.keys(a.h),e=c.length,f=0;f<e;){var g=c[f++];a.h[g]||this.errors.push(ua.UninitializedVariable(g,b))}},onIncorrectType:function(a,b){this.parsingThrow()},
parsingThrow:function(){if(0!=this.errorType)throw y.thrown(qb.ParsingThrow);},mapSet:function(a,b,c){a.h[b]=c},__class__:I};var Va=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_0=Va;Va.__name__=!0;Va.__super__=I;Va.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"peote.text.FontConfig",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new S;this.objectSetupAssign(c,
"packed distancefield kerning width height color bgColor line tiles rangeSplitSize ranges".split(" "),[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "bgColor":this.value.bgColor=this.loadObjectField((m=new Aa(this.errors,this.putils,1),p(m,m.loadJson)),f,"bgColor",c,this.value.bgColor,b);break;case "color":this.value.color=this.loadObjectField((m=new Aa(this.errors,this.putils,1),p(m,m.loadJson)),f,"color",c,this.value.color,
b);break;case "distancefield":this.value.distancefield=this.loadObjectField((m=new F(this.errors,this.putils,1),p(m,m.loadJson)),f,"distancefield",c,this.value.distancefield,b);break;case "height":this.value.height=this.loadObjectField((m=new ka(this.errors,this.putils,1),p(m,m.loadJson)),f,"height",c,this.value.height,b);break;case "kerning":this.value.kerning=this.loadObjectField((m=new fb(this.errors,this.putils,1),p(m,m.loadJson)),f,"kerning",c,this.value.kerning,b);break;case "line":this.value.line=
this.loadObjectField((m=new ra(this.errors,this.putils,1),p(m,m.loadJson)),f,"line",c,this.value.line,b);break;case "packed":this.value.packed=this.loadObjectField((m=new F(this.errors,this.putils,1),p(m,m.loadJson)),f,"packed",c,this.value.packed,b);break;case "rangeSplitSize":this.value.rangeSplitSize=this.loadObjectField((m=new ha(this.errors,this.putils,1),p(m,m.loadJson)),f,"rangeSplitSize",c,this.value.rangeSplitSize,b);break;case "ranges":this.value.ranges=this.loadObjectField((m=new ob(this.errors,
this.putils,1),p(m,m.loadJson)),f,"ranges",c,this.value.ranges,b);break;case "tiles":this.value.tiles=this.loadObjectField((m=new n(this.errors,this.putils,1),p(m,m.loadJson)),f,"tiles",c,this.value.tiles,b);break;case "width":this.value.width=this.loadObjectField((m=new ka(this.errors,this.putils,1),p(m,m.loadJson)),f,"width",c,this.value.width,b);break;default:this.errors.push(ua.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(de.prototype);
a.packed=!1;a.distancefield=!1;a.kerning=null;a.width=16;a.height=16;a.color=-1;a.bgColor=0;a.line=null;a.tiles=null;a.rangeSplitSize=4096;a.ranges=(new ob([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1)));return a},__class__:Va});var ob=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_1=ob;ob.__name__=!0;ob.__super__=I;ob.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"Array<{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }>",
a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonArray:function(a,b,c){this.value=this.loadJsonArrayValue(a,(m=new Wa(this.errors,this.putils,2),p(m,m.loadJson)),c)},__class__:ob});var q=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c);this.value=0};d.JsonParser_10=q;q.__name__=!0;q.__super__=I;q.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"UInt",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,
b,c){this.value=this.loadJsonUInt(a,b,c,this.value)},__class__:q});var Wa=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_11=Wa;Wa.__name__=!0;Wa.__super__=I;Wa.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }",a));I.prototype.onIncorrectType.call(this,
a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new S;this.objectSetupAssign(c,"data image line range slot tiles".split(" "),[!0,!1,!0,!1,!1,!0]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "data":this.value.data=this.loadObjectField((m=new jb(this.errors,this.putils,1),p(m,m.loadJson)),f,"data",c,this.value.data,b);break;case "image":this.value.image=this.loadObjectField((m=new Z(this.errors,this.putils,1),p(m,m.loadJson)),
f,"image",c,this.value.image,b);break;case "line":this.value.line=this.loadObjectField((m=new aa(this.errors,this.putils,1),p(m,m.loadJson)),f,"line",c,this.value.line,b);break;case "range":this.value.range=this.loadObjectField((m=new ba(this.errors,this.putils,1),p(m,m.loadJson)),f,"range",c,this.value.range,b);break;case "slot":this.value.slot=this.loadObjectField((m=new N(this.errors,this.putils,1),p(m,m.loadJson)),f,"slot",c,this.value.slot,b);break;case "tiles":this.value.tiles=this.loadObjectField((m=
new D(this.errors,this.putils,1),p(m,m.loadJson)),f,"tiles",c,this.value.tiles,b);break;default:this.errors.push(ua.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{data:(new jb([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1))),image:(new Z([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1))),line:(new aa([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1))),range:(new ba([],this.putils,0)).loadJson(new Ma(Ha.JNull,
new Da("",0,1))),slot:(new N([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1))),tiles:(new D([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1)))}},__class__:Wa});var jb=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_13=jb;jb.__name__=!0;jb.__super__=I;jb.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"String",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,
b,c){this.value=a},__class__:jb});var Z=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_14=Z;Z.__name__=!0;Z.__super__=I;Z.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"String",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,b,c){this.value=a},__class__:Z});var aa=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_16=aa;aa.__name__=!0;aa.__super__=I;aa.prototype=
u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"{ height : Float, base : Float }",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new S;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "base":this.value.base=this.loadObjectField((m=new ka(this.errors,this.putils,1),p(m,m.loadJson)),f,"base",c,this.value.base,
b);break;case "height":this.value.height=this.loadObjectField((m=new ka(this.errors,this.putils,1),p(m,m.loadJson)),f,"height",c,this.value.height,b);break;default:this.errors.push(ua.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new ka([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1))),height:(new ka([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1)))}},__class__:aa});var ba=function(a,b,c){null==c&&(c=
0);I.call(this,a,b,c)};d.JsonParser_17=ba;ba.__name__=!0;ba.__super__=I;ba.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"peote.text.Range",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new S;this.objectSetupAssign(c,["min","max"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "max":this.value.max=this.loadObjectField((m=new ha(this.errors,
this.putils,1),p(m,m.loadJson)),f,"max",c,this.value.max,b);break;case "min":this.value.min=this.loadObjectField((m=new ha(this.errors,this.putils,1),p(m,m.loadJson)),f,"min",c,this.value.min,b);break;default:this.errors.push(ua.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(ee.prototype);a.min=(new ha([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1)));a.max=(new ha([],this.putils,0)).loadJson(new Ma(Ha.JNull,
new Da("",0,1)));return a},__class__:ba});var N=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_18=N;N.__name__=!0;N.__super__=I;N.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"{ width : Int, height : Int }",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new S;this.objectSetupAssign(c,["height","width"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=
a[e];++e;switch(f.name){case "height":this.value.height=this.loadObjectField((m=new ha(this.errors,this.putils,1),p(m,m.loadJson)),f,"height",c,this.value.height,b);break;case "width":this.value.width=this.loadObjectField((m=new ha(this.errors,this.putils,1),p(m,m.loadJson)),f,"width",c,this.value.width,b);break;default:this.errors.push(ua.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{height:(new ha([],this.putils,0)).loadJson(new Ma(Ha.JNull,
new Da("",0,1))),width:(new ha([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1)))}},__class__:N});var F=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c);this.value=!1};d.JsonParser_2=F;F.__name__=!0;F.__super__=I;F.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"Bool",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonBool:function(a,b,c){this.value=a},__class__:F});var D=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_20=
D;D.__name__=!0;D.__super__=I;D.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"{ y : Int, x : Int }",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new S;this.objectSetupAssign(c,["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "x":this.value.x=this.loadObjectField((m=new ha(this.errors,this.putils,1),p(m,m.loadJson)),f,
"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((m=new ha(this.errors,this.putils,1),p(m,m.loadJson)),f,"y",c,this.value.y,b);break;default:this.errors.push(ua.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new ha([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1))),y:(new ha([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1)))}},__class__:D});var fb=function(a,b,c){null==c&&(c=0);I.call(this,
a,b,c)};d.JsonParser_4=fb;fb.__name__=!0;fb.__super__=I;fb.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"Bool",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonBool:function(a,b,c){this.value=a},__class__:fb});var ka=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c);this.value=0};d.JsonParser_5=ka;ka.__name__=!0;ka.__super__=I;ka.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,
"Float",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonFloat(a,b,c,this.value)},__class__:ka});var Aa=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_6=Aa;Aa.__name__=!0;Aa.__super__=I;Aa.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"peote.view.Color",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=(new q(this.errors,this.putils,0)).loadJson(new Ma(Ha.JNumber(a),
new Da(b.file,b.min-1,b.max-1)),c)},__class__:Aa});var ra=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_7=ra;ra.__name__=!0;ra.__super__=I;ra.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"{ height : Float, base : Float }",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new S;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=
0;e<a.length;){var f=a[e];++e;switch(f.name){case "base":this.value.base=this.loadObjectField((m=new ka(this.errors,this.putils,1),p(m,m.loadJson)),f,"base",c,this.value.base,b);break;case "height":this.value.height=this.loadObjectField((m=new ka(this.errors,this.putils,1),p(m,m.loadJson)),f,"height",c,this.value.height,b);break;default:this.errors.push(ua.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new ka([],this.putils,
0)).loadJson(new Ma(Ha.JNull,new Da("",0,1))),height:(new ka([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1)))}},__class__:ra});var n=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c)};d.JsonParser_8=n;n.__name__=!0;n.__super__=I;n.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"{ y : Int, x : Int }",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new S;this.objectSetupAssign(c,
["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var f=a[e];++e;switch(f.name){case "x":this.value.x=this.loadObjectField((m=new ha(this.errors,this.putils,1),p(m,m.loadJson)),f,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((m=new ha(this.errors,this.putils,1),p(m,m.loadJson)),f,"y",c,this.value.y,b);break;default:this.errors.push(ua.UnknownVariable(f.name,this.putils.convertPosition(f.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new ha([],
this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1))),y:(new ha([],this.putils,0)).loadJson(new Ma(Ha.JNull,new Da("",0,1)))}},__class__:n});var ha=function(a,b,c){null==c&&(c=0);I.call(this,a,b,c);this.value=0};d.JsonParser_9=ha;ha.__name__=!0;ha.__super__=I;ha.prototype=u(I.prototype,{onIncorrectType:function(a,b){this.errors.push(ua.IncorrectType(b,"Int",a));I.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonInt(a,b,c,this.value)},__class__:ha});
var Q=function(){this.isReadyForUpdate=!1;fa.call(this)};d["ob.gum.backends.App"]=Q;Q.__name__=!0;Q.__super__=fa;Q.prototype=u(fa.prototype,{init:function(a,b){this.gum=new fe(a,b);this.isReadyForUpdate=!0},onWindowCreate:function(){ja.trace("App onWindowCreate",{fileName:"ob/gum/backends/Lime.hx",lineNumber:22,className:"ob.gum.backends.App",methodName:"onWindowCreate"});switch(this.__window.context.type){case "opengl":case "opengles":case "webgl":try{this.init(this.__window)}catch(b){var a=y.caught(b);
ja.trace(Ic.toString(Ic.exceptionStack()),{fileName:"ob/gum/backends/Lime.hx",lineNumber:28,className:"ob.gum.backends.App",methodName:"onWindowCreate",customParams:[a]})}break;default:throw y.thrown("Sorry, only works with OpenGL.");}},update:function(a){if(this.isReadyForUpdate)this.gum.onUpdate(a)},onKeyDown:function(a,b){this.gum.onKeyDown(a,b)},onKeyUp:function(a,b){this.gum.onKeyUp(a,b)},onMouseMove:function(a,b){this.gum.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.gum.onMouseDown(a,
b,c)},onMouseUp:function(a,b,c){this.gum.onMouseUp(a,b,c)},onMouseWheel:function(a,b,c){this.gum.onMouseScroll(a,b,c)},onWindowResize:function(a,b){fa.prototype.onWindowResize.call(this,a,b);this.gum.onWindowResize(a,b)},__class__:Q});var C=function(){Q.call(this)};d.Main=C;C.__name__=!0;C.__super__=Q;C.prototype=u(Q.prototype,{init:function(a,b){Q.prototype.init.call(this,a,{framesPerSecond:30,drawOnlyWhenRequested:!0,displayWidth:800,displayHeight:496,displayIsScaled:!0});b=new ge(40,40);a=new he({fonts:["assets/fonts/tiled/hack_ascii.json"],
images:[]});this.gum.changeLoop(new na(b,a))},__class__:C});var ya=function(){};d.ManifestResources=ya;ya.__name__=!0;ya.init=function(a){ya.preloadLibraries=[];ya.preloadLibraryNames=[];ya.rootPath=null;null!=a&&Object.prototype.hasOwnProperty.call(a,"rootPath")&&(ya.rootPath=R.field(a,"rootPath"));null==ya.rootPath&&(ya.rootPath="./");a=Ab.parse('{"name":null,"assets":"aoy4:pathy40:assets%2Ffonts%2Ftiled%2Fhack_ascii.jsony4:sizei1258y4:typey4:TEXTy2:idR1y7:preloadtgoR0y39:assets%2Ffonts%2Ftiled%2Fhack_ascii.pngR2i12425R3y5:IMAGER5R7R6tgh","rootPath":null,"version":2,"libraryArgs":[],"libraryType":null}',
ya.rootPath);a=Pb.fromManifest(a);Y.registerLibrary("default",a);a=Y.getLibrary("default");null!=a?ya.preloadLibraries.push(a):ya.preloadLibraryNames.push("default")};Math.__name__=!0;var R=function(){};d.Reflect=R;R.__name__=!0;R.field=function(a,b){try{return a[b]}catch(c){return oa.lastError=c,null}};R.getProperty=function(a,b){var c;if(null==a)return null;var e=a.__properties__?c=a.__properties__["get_"+b]:!1;return e?a[c]():a[b]};R.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,
e;for(e in a)"__id__"!=e&&"hx__closures__"!=e&&c.call(a,e)&&b.push(e)}return b};R.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};R.compareMethods=function(a,b){return a==b?!0:R.isFunction(a)&&R.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};R.copy=function(a){if(null==a)return null;for(var b={},c=0,e=R.fields(a);c<e.length;){var f=e[c];++c;b[f]=R.field(a,f)}return b};var E=function(){};d.Std=E;E.__name__=!0;E.string=function(a){return xa.__string_rec(a,
"")};E.parseInt=function(a){if(null!=a)for(var b=0,c=a.length;b<c;){var e=b++,f=a.charCodeAt(e);if(8>=f||14<=f&&32!=f&&45!=f)if(b=a.charCodeAt(e+1),a=parseInt(a,120==b||88==b?16:10),isNaN(a))break;else return a}return null};var Na=function(){};d["_String.String_Impl_"]=Na;Na.__name__=!0;Na.fromCharCode=function(a){return String.fromCodePoint(a)};var kb=function(){this.b=""};d.StringBuf=kb;kb.__name__=!0;kb.prototype={__class__:kb};var za=function(){};d.StringTools=za;za.__name__=!0;za.startsWith=
function(a,b){return a.length>=b.length?0==a.lastIndexOf(b,0):!1};za.endsWith=function(a,b){var c=b.length,e=a.length;return e>=c?a.indexOf(b,e-c)==e-c:!1};za.isSpace=function(a,b){a=K.cca(a,b);return 8<a&&14>a?!0:32==a};za.ltrim=function(a){for(var b=a.length,c=0;c<b&&za.isSpace(a,c);)++c;return 0<c?K.substr(a,c,b-c):a};za.rtrim=function(a){for(var b=a.length,c=0;c<b&&za.isSpace(a,b-c-1);)++c;return 0<c?K.substr(a,0,b-c):a};za.trim=function(a){return za.ltrim(za.rtrim(a))};za.replace=function(a,
b,c){return a.split(b).join(c)};var Ja=function(){};d.Type=Ja;Ja.__name__=!0;Ja.createInstance=function(a,b){return new (Function.prototype.bind.apply(a,[null].concat(b)))};Ja.createEnum=function(a,b,c){var e=R.field(a,b);if(null==e)throw y.thrown("No such constructor "+b);if(R.isFunction(e)){if(null==c)throw y.thrown("Constructor "+b+" need parameters");return e.apply(a,c)}if(null!=c&&0!=c.length)throw y.thrown("Constructor "+b+" does not need parameters");return e};var Hb={toFloat:function(a){return 0>
a?4294967296+a:a+0}},ic=function(){};d["echo.util.Disposable"]=ic;ic.__name__=!0;ic.__isInterface__=!0;var cb=function(a){this.transform=new Jc;this.layer_mask=$e._new();this.layers=$e._new();var b=new O(0,0);this.drag=b;this.max_velocity=b=new O(0,0);this.torque=0;this.acceleration=b=new O(0,0);this.velocity=b=new O(0,0);this.material=cc.global;this.id=++cb.ids;this.active=!0;this.shapes=[];this.data={};this.disposed=!1;this.transform.on_dirty=p(this,this.on_dirty);this.load_options(a)};d["echo.Body"]=
cb;cb.__name__=!0;cb.__interfaces__=[ic];cb.__properties__={get_defaults:"get_defaults"};cb.get_defaults=function(){return{kinematic:!1,mass:cb.default_mass,x:0,y:0,rotation:0,scale_x:1,scale_y:1,velocity_x:0,velocity_y:0,rotational_velocity:0,max_velocity_x:0,max_velocity_y:0,max_velocity_length:0,max_rotational_velocity:1E4,drag_x:0,drag_y:0,drag_length:0,rotational_drag:0}};cb.prototype={load_options:function(a){a=zd.copy_fields(a,cb.get_defaults());for(var b=0,c=this.shapes;b<c.length;){var e=
c[b];++b;e.put()}this.shapes.length=0;c=a.x;b=this.transform;b.dirty||b.set_dirty();b.local_x=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);c=a.y;b=this.transform;b.dirty||b.set_dirty();b.local_y=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);b=this.transform;c=Math.PI/180*a.rotation;b.dirty||b.set_dirty();b.local_radians=c;if(null!=this.on_rotate)this.on_rotate(180/Math.PI*this.transform.local_radians);c=a.scale_x;b=this.transform;
b.dirty||b.set_dirty();b.local_scale_x=c;c=a.scale_y;b=this.transform;b.dirty||b.set_dirty();b.local_scale_y=c;this.kinematic=a.kinematic;this.material=null!=a.material?a.material:null!=a.gravity_scale||null!=a.elasticity?new cc(a.elasticity,null,null,null,a.gravity_scale):cc.global;c=this.velocity;c.x=a.velocity_x;c.y=a.velocity_y;this.rotational_velocity=a.rotational_velocity;c=this.max_velocity;c.x=a.max_velocity_x;c.y=a.max_velocity_y;this.max_velocity_length=a.max_velocity_length;this.max_rotational_velocity=
a.max_rotational_velocity;c=this.drag;c.x=a.drag_x;c.y=a.drag_y;this.drag_length=a.drag_length;this.rotational_drag=a.rotational_drag;this.last_rotation=this.last_y=this.last_x=NaN;this.dirty=!0;if(null!=a.shape){e=Ta.get(a.shape);var f=-1;null==f&&(f=-1);-1==this.shapes.indexOf(e)&&(-1<f?this.shapes[f]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)))}if(null!=a.shapes)for(b=
0,c=a.shapes;b<c.length;)e=c[b],++b,e=Ta.get(e),f=-1,null==f&&(f=-1),-1==this.shapes.indexOf(e)&&(-1<f?this.shapes[f]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));null!=a.shape_instance&&(e=a.shape_instance,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))));
if(null!=a.shape_instances)for(b=0,c=a.shape_instances;b<c.length;)e=c[b],++b,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));b=a.mass;if(null==b)c=a.mass,c<cb.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&
null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);else switch(b){case -1:b=a=0;for(c=this.shapes;b<c.length;)e=c[b],++b,a+=e.volume()*this.material.density;a<cb.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=a,this.inverse_mass=
1/this.mass);break;case 0:c=0;c<cb.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);break;default:c=a.mass,c<cb.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):
(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass)}},bounds:function(a){if(0==this.shapes.length){var b=this.transform.local_x,c=this.transform.local_y,e=1,f=1;null==f&&(f=1);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);a=ab.pool.get();var g=b;null==f&&(f=1);null==e&&(e=1);null==c&&(c=0);null==g&&(g=0);e*=.5;f*=.5;a.min_x=g-e;a.min_y=c-f;a.max_x=g+e;a.max_y=c+f;a.pooled=!1;return a}g=this.shapes[0].bounds();if(1<this.shapes.length)for(f=
1,e=this.shapes.length;f<e;)c=f++,c=this.shapes[c].bounds(),g.min_x>c.min_x&&(g.min_x=c.min_x),g.min_y>c.min_y&&(g.min_y=c.min_y),g.max_x<c.max_x&&(g.max_x=c.max_x),g.max_y<c.max_y&&(g.max_y=c.max_y),c.put();null==a&&(a=ab.pool.get(),c=b=0,f=e=1,null==f&&(f=1),null==e&&(e=1),null==c&&(c=0),null==b&&(b=0),e*=.5,f*=.5,a.min_x=b-e,a.min_y=c-f,a.max_x=b+e,a.max_y=c+f,a.pooled=!1);a.min_x=g.min_x;a.max_x=g.max_x;a.min_y=g.min_y;a.max_y=g.max_y;g.put();return a},on_dirty:function(a){this.dirty=!0;0>=this.mass&&
null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))},__class__:cb};var Ea=function(){};d["echo.Collisions"]=Ea;Ea.__name__=!0;Ea.update_quadtree=function(a){for(var b=0,c=a.members;b<c.length;){var e=c[b];++b;if(!e.disposed){e.collided=!1;for(var f=0,g=e.shapes;f<g.length;){var x=g[f];++f;x.collided=!1}e.active&&0<e.mass&&e.dirty&&0<e.shapes.length&&(null==e.quadtree_data.bounds?e.quadtree_data.bounds=e.bounds():e.bounds(e.quadtree_data.bounds),
a.quadtree.update(e.quadtree_data,!1),e.dirty=!1)}}a.quadtree.shake()};Ea.query=function(a,b){Ea.update_quadtree(a);b=null==b?a.listeners.members:b.members;for(var c=0;c<b.length;){var e=b[c];++c;e.quadtree_results.length=0;var f=e.a;switch(f._hx_index){case 0:f=f.v;var g=e.b;switch(g._hx_index){case 0:f=Ea.overlap_body_and_body_bounds(f,g.v);null!=f&&e.quadtree_results.push(f);break;case 1:Ea.overlap_body_and_bodies_bounds(f,g.v,a,e.quadtree_results)}break;case 1:switch(f=f.v,g=e.b,g._hx_index){case 0:Ea.overlap_body_and_bodies_bounds(g.v,
f,a,e.quadtree_results);break;case 1:g=g.v,Ea.overlap_bodies_and_bodies_bounds(f,g,a,e.quadtree_results),f!=g&&Ea.overlap_bodies_and_bodies_bounds(g,f,a,e.quadtree_results)}}f=0;for(g=e.last_collisions;f<g.length;){var x=g[f];++f;x.put()}e.last_collisions.length=e.collisions.length;f=0;for(g=e.collisions.length;f<g;)x=f++,e.last_collisions[x]=e.collisions[x];f=e.collisions.length=0;for(g=e.quadtree_results;f<g.length;)if(x=g[f],++f,x.a.disposed||x.b.disposed)x.put();else if(x.a.id==x.b.id)x.put();
else{for(var l=!1,d=0,la=e.collisions;d<la.length;){var A=la[d];++d;if(A.a.id==x.a.id&&A.b.id==x.b.id||A.b.id==x.a.id&&A.a.id==x.b.id){l=!0;break}}if(l)x.put();else{if(1==x.a.shapes.length&&1==x.b.shapes.length)l=x.a.shapes[0].collides(x.b.shapes[0]),null!=l&&x.data.push(l);else for(l=x.a.shapes,d=0,la=l.length;d<la;){A=d++;for(var r=x.b.shapes,h=l[A].bounds(),m=0,n=r.length;m<n;){var C=m++,Q=r[C].bounds();h.min_x<Q.max_x&&h.max_x>=Q.min_x&&h.min_y<Q.max_y&&h.max_y>=Q.min_y&&(C=l[A].collides(r[C]),
null!=C&&x.data.push(C));Q.put()}h.put()}if(0==x.data.length)x.put();else if(null==e.condition||e.condition(x.a,x.b,x.data)&&!x.a.disposed&&!x.b.disposed){l=0;for(d=x.data;l<d.length;)la=d[l],++l,la.sa.collided=la.sb.collided=!0;x.a.collided=x.b.collided=!0;e.collisions.push(x)}else x.put()}}}};Ea.notify=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(null!=c.enter||null!=c.stay)for(var e=0,f=c.collisions;e<f.length;){var g=f[e];++e;if(!g.a.disposed&&!g.b.disposed){if(null!=
c.enter){var x=!1;for(var l=0,d=c.last_collisions;l<d.length;){var la=d[l];++l;if(la.a==g.a&&la.b==g.b||la.a==g.b&&la.b==g.a){x=!0;break}}x=!x}else x=!1;x?c.enter(g.a,g.b,g.data):null!=c.stay&&c.stay(g.a,g.b,g.data)}}if(null!=c.exit)for(e=0,f=c.last_collisions;e<f.length;){g=f[e];++e;if(g.a.disposed||g.b.disposed)x=!1;else{x=!1;l=0;for(d=c.collisions;l<d.length;)if(la=d[l],++l,la.a==g.a&&la.b==g.b||la.a==g.b&&la.b==g.a){x=!0;break}x=!x}x&&c.exit(g.a,g.b)}}};Ea.overlap_bodies_and_bodies_bounds=function(a,
b,c,e){if(0!=a.length&&0!=b.length)for(var f=0;f<a.length;){var g=a[f];++f;Ea.overlap_body_and_bodies_bounds(g,b,c,e)}};Ea.overlap_body_and_bodies_bounds=function(a,b,c,e){if(!(a.disposed||0==a.shapes.length||!a.active||0>=a.mass)){var f=a.bounds();Ea.qr.length=0;Ea.sqr.length=0;c.quadtree.query(f,Ea.qr);c.static_quadtree.query(f,Ea.sqr);for(c=0;c<b.length;){var g=b[c];++c;if(!g.disposed&&0!=g.shapes.length&&g.active&&(0==a.layer_mask||0==g.layer_mask||0!=(a.layer_mask&g.layers)&&0!=(g.layer_mask&
a.layers)))for(var x=0,l=0<g.mass?Ea.qr:Ea.sqr;x<l.length;){var d=l[x];++x;d.id==g.id&&(d=dc.pool.get(),d.a=a,d.b=g,d.data.length=0,d.pooled=!1,e.push(d))}}f.put()}};Ea.overlap_body_and_body_bounds=function(a,b){if(a.disposed||b.disposed||0==a.shapes.length||0==b.shapes.length||!a.active||!b.active||a==b||0!=a.layer_mask&&0!=b.layer_mask&&(0==(a.layer_mask&b.layers)||0==(b.layer_mask&a.layers))||0>=a.mass&&0>=b.mass)return null;var c=a.bounds(),e=b.bounds(),f=c.min_x<e.max_x&&c.max_x>=e.min_x&&c.min_y<
e.max_y&&c.max_y>=e.min_y;c.put();e.put();return f?(c=dc.pool.get(),c.a=a,c.b=b,c.data.length=0,c.pooled=!1,c):null};var Pc=function(a){this.members=null==a?[]:a};d["echo.Listeners"]=Pc;Pc.__name__=!0;Pc.__interfaces__=[ic];Pc.prototype={add:function(a,b,c){c=zd.copy_fields(c,Qc.get_defaults());a=new Qc(a,b,c.separate,[],[],null,null,null,null,[],c.percent_correction,c.correction_threshold);null!=c.enter&&(a.enter=c.enter);null!=c.stay&&(a.stay=c.stay);null!=c.exit&&(a.exit=c.exit);null!=c.condition&&
(a.condition=c.condition);this.members.push(a);return a},clear:function(){this.members.length=0},__class__:Pc};var sa=k.echo.Echo=function(){};d["echo.Echo"]=sa;sa.__name__=!0;sa.start=function(a){return new ed(a)};sa.make=function(a,b){return a.add(new cb(b))};sa.listen=function(a,b,c,e){return null==b?null==c?a.listeners.add(fd.Right(a.members),fd.Right(a.members),e):a.listeners.add(c,c,e):null==c?a.listeners.add(b,b,e):a.listeners.add(b,c,e)};sa.check=function(a,b,c,e){sa.cached_listeners.clear();
null==b&&null==c?sa.cached_listeners.add(fd.Right(a.members),fd.Right(a.members),e):null==b?sa.cached_listeners.add(c,c,e):null==c?sa.cached_listeners.add(b,b,e):sa.cached_listeners.add(b,c,e);Ea.query(a,sa.cached_listeners);gd.separate(a,sa.cached_listeners);Ea.notify(a,sa.cached_listeners)};sa.step=function(a,b){if(null!=a.history){for(var c=a.history,e=[],f=0,g=a.members;f<g.length;){var x=g[f];++f;e.push(new ie(x.id,x.transform.local_x,x.transform.local_y,180/Math.PI*x.transform.local_radians,
x.velocity.x,x.velocity.y,x.acceleration.x,x.acceleration.y,x.rotational_velocity))}c.add(e)}b/=a.iterations;e=0;for(f=a.iterations;e<f;)e++,gd.step(a,b),Ea.query(a),gd.separate(a),Ea.notify(a)};sa.linecast_floats=function(a,b,c,e,f,g,x){null==x&&(x=!0);null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=Ib.pool.get();null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var d=l.start;d.x=a;d.y=b;d=l.end;d.x=c;d.y=e;l.pooled=!1;f=sa.linecast(l,f,g,x);l.pooled||(l.pooled=!0,Ib.pool.put_unsafe(l));
return f};sa.linecast_vector=function(a,b,c,e,f,g){null==g&&(g=!0);var x=Ib.pool.get();x.set_from_vector(a,b,c);x.pooled=!1;a=sa.linecast(x,e,f,g);x.pooled||(x.pooled=!0,Ib.pool.put_unsafe(x));return a};sa.linecast_vectors=function(a,b,c,e,f){f=a.x;var g=a.y;a=b.x;var x=b.y;null==x&&(x=1);null==a&&(a=1);null==g&&(g=0);null==f&&(f=0);b=Ib.pool.get();null==x&&(x=1);null==a&&(a=1);null==g&&(g=0);null==f&&(f=0);var l=b.start;l.x=f;l.y=g;l=b.end;l.x=a;l.y=x;b.pooled=!1;c=sa.linecast(b,c,e);b.pooled||(b.pooled=
!0,Ib.pool.put_unsafe(b));return c};sa.linecast=function(a,b,c,e){null==e&&(e=!0);var f=null,g=Math.min(a.start.x,a.end.x),x=Math.min(a.start.y,a.end.y),l=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,a.end.y),la=ab.pool.get();la.min_x=g;la.max_x=l;la.min_y=x;la.max_y=d;la.pooled=!1;var A=b;switch(A._hx_index){case 0:var r=A.v;if(!r.disposed&&r.active){var h=r.bounds();if(la.min_x<h.max_x&&la.max_x>=h.min_x&&la.min_y<h.max_y&&la.max_y>=h.min_y){var m=0;for(e=r.shapes.length;m<e;)x=m++,g=r.shapes[x].intersect(a),
null!=g&&(null==f&&(x=Qb.pool.get(),x.line=a,x.body=r,x.data.length=0,x.pooled=!1,f=x),f.data.push(g))}h.put()}break;case 1:if(b=A.v,null==c)for(A=0;A<b.length;){if(r=b[A],++A,null!=r&&!r.disposed&&r.active){h=r.bounds();x=Qb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;if(la.min_x<h.max_x&&la.max_x>=h.min_x&&la.min_y<h.max_y&&la.max_y>=h.min_y)for(m=0,e=r.shapes.length;m<e;)x=m++,g=r.shapes[x].intersect(a),null!=g&&c.data.push(g);h.put();if(0<c.data.length)if(null!=f){if(0==f.data.length)g=
null;else if(1==f.data.length)g=f.data[0];else{h=f.data[0];r=1;for(g=f.data.length;r<g;)x=r++,null!=f.data[x]&&f.data[x].distance<h.distance&&(h=f.data[x]);g=h}h=g.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];e=1;for(g=c.data.length;e<g;)x=e++,null!=c.data[x]&&c.data[x].distance<r.distance&&(r=c.data[x]);e=r}g=h>e.distance}else g=!0;else g=!1;g?(null!=f&&f.put(),f=c):c.put()}}else{A=0;for(m=sa.cached_collisions;A<m.length;)h=m[A],++A,h.put();sa.cached_collisions.length=
0;h=sa.cached_body;g=la.min_x;x=la.min_y;l=la.max_x;d=la.max_y;r=tb.pool.get();A=.5*(g+l);m=.5*(x+d);g=l-g;d-=x;null==d&&(d=0);null==g&&(g=1);null==m&&(m=0);null==A&&(A=0);l=r.transform;l.dirty||l.set_dirty();l.local_x=A;l=r.transform;l.dirty||l.set_dirty();l.local_y=m;A=.5*g;l=r.transform;null==l.parent?m=l.local_scale_x:(l.sync(),m=l._scale_x);r.local_ex=A/m;if(null!=r.transformed_rect){l=r.transformed_rect;l.count=4;A=0;for(m=l.count;A<m;)if(x=A++,null==l.local_vertices[x]){var n=l.local_vertices,
C=new O(0,0);n[x]=C}A=l.local_vertices[0];A.x=-(r.local_ex*r.transform.local_scale_x);A.y=-(r.local_ey*r.transform.local_scale_y);A=l.local_vertices[1];A.x=r.local_ex*r.transform.local_scale_x;A.y=-(r.local_ey*r.transform.local_scale_y);A=l.local_vertices[2];A.x=r.local_ex*r.transform.local_scale_x;A.y=r.local_ey*r.transform.local_scale_y;A=l.local_vertices[3];A.x=-(r.local_ex*r.transform.local_scale_x);A.y=r.local_ey*r.transform.local_scale_y;A=r.transform.local_x;n=l.transform;n.dirty||n.set_dirty();
n.local_x=A;A=r.transform.local_y;n=l.transform;n.dirty||n.set_dirty();n.local_y=A;n=l.transform;A=Math.PI/180*(180/Math.PI)*r.transform.local_radians;n.dirty||n.set_dirty();n.local_radians=A;A=r.transform.local_scale_x;n=l.transform;n.dirty||n.set_dirty();n.local_scale_x=A;A=r.transform.local_scale_y;n=l.transform;n.dirty||n.set_dirty();n.local_scale_y=A;l.dirty_vertices=!0;l.dirty_bounds=!0}A=.5*(0>=d?g:d);l=r.transform;null==l.parent?m=l.local_scale_y:(l.sync(),m=l._scale_y);r.local_ey=A/m;if(null!=
r.transformed_rect){l=r.transformed_rect;l.count=4;A=0;for(m=l.count;A<m;)x=A++,null==l.local_vertices[x]&&(n=l.local_vertices,C=new O(0,0),n[x]=C);A=l.local_vertices[0];A.x=-(r.local_ex*r.transform.local_scale_x);A.y=-(r.local_ey*r.transform.local_scale_y);A=l.local_vertices[1];A.x=r.local_ex*r.transform.local_scale_x;A.y=-(r.local_ey*r.transform.local_scale_y);A=l.local_vertices[2];A.x=r.local_ex*r.transform.local_scale_x;A.y=r.local_ey*r.transform.local_scale_y;A=l.local_vertices[3];A.x=-(r.local_ex*
r.transform.local_scale_x);A.y=r.local_ey*r.transform.local_scale_y;A=r.transform.local_x;n=l.transform;n.dirty||n.set_dirty();n.local_x=A;A=r.transform.local_y;n=l.transform;n.dirty||n.set_dirty();n.local_y=A;n=l.transform;A=Math.PI/180*(180/Math.PI)*r.transform.local_radians;n.dirty||n.set_dirty();n.local_radians=A;A=r.transform.local_scale_x;n=l.transform;n.dirty||n.set_dirty();n.local_scale_x=A;A=r.transform.local_scale_y;n=l.transform;n.dirty||n.set_dirty();n.local_scale_y=A;l.dirty_vertices=
!0;l.dirty_bounds=!0}l=r.transform;A=Math.PI/180*0;l.dirty||l.set_dirty();l.local_radians=A;l=r.transform;l.dirty||l.set_dirty();l.local_scale_x=1;l=r.transform;l.dirty||l.set_dirty();l.local_scale_y=1;null==r.transformed_rect?(l=r.transform,null==l.parent?g=180/Math.PI*l.local_radians:(l.sync(),g=180/Math.PI*l._radians),g=0!=g):g=!1;if(g){g=Xa.pool.get();g.count=4;A=0;for(m=g.count;A<m;)x=A++,null==g.local_vertices[x]&&(d=g.local_vertices,C=new O(0,0),d[x]=C);A=g.local_vertices[0];A.x=-(r.local_ex*
r.transform.local_scale_x);A.y=-(r.local_ey*r.transform.local_scale_y);A=g.local_vertices[1];A.x=r.local_ex*r.transform.local_scale_x;A.y=-(r.local_ey*r.transform.local_scale_y);A=g.local_vertices[2];A.x=r.local_ex*r.transform.local_scale_x;A.y=r.local_ey*r.transform.local_scale_y;A=g.local_vertices[3];A.x=-(r.local_ex*r.transform.local_scale_x);A.y=r.local_ey*r.transform.local_scale_y;A=r.transform.local_x;l=g.transform;l.dirty||l.set_dirty();l.local_x=A;A=r.transform.local_y;l=g.transform;l.dirty||
l.set_dirty();l.local_y=A;l=g.transform;A=Math.PI/180*(180/Math.PI)*r.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=A;A=r.transform.local_scale_x;l=g.transform;l.dirty||l.set_dirty();l.local_scale_x=A;A=r.transform.local_scale_y;l=g.transform;l.dirty||l.set_dirty();l.local_scale_y=A;g.dirty_vertices=!0;g.dirty_bounds=!0;g.pooled=!1;r.transformed_rect=g;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(A=r.transform.local_x,l=r.transformed_rect.transform,l.dirty||
l.set_dirty(),l.local_x=A,A=r.transform.local_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_y=A,l=r.transformed_rect.transform,A=Math.PI/180*(180/Math.PI)*r.transform.local_radians,l.dirty||l.set_dirty(),l.local_radians=A,A=r.transform.local_scale_x,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_x=A,A=r.transform.local_scale_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_y=A);r.pooled=!1;null!=h.shapes[0]&&h.shapes[0].put();h.shapes[0]=
r;h.shapes[0].set_parent(h);h.dirty=!0;0>=h.mass&&null!=h.world&&(h.bounds(h.quadtree_data.bounds),h.world.static_quadtree.update(h.quadtree_data));e&&Ea.update_quadtree(c);Ea.overlap_body_and_bodies_bounds(sa.cached_body,b,c,sa.cached_collisions);A=0;for(m=sa.cached_collisions;A<m.length;){h=m[A];++A;r=h.b;x=Qb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;e=0;for(r=h.b.shapes.length;e<r;)x=e++,g=h.b.shapes[x].intersect(a),null!=g&&c.data.push(g);if(0<c.data.length)if(null!=f){if(0==
f.data.length)g=null;else if(1==f.data.length)g=f.data[0];else{h=f.data[0];g=1;for(e=f.data.length;g<e;)x=g++,null!=f.data[x]&&f.data[x].distance<h.distance&&(h=f.data[x]);g=h}h=g.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];g=1;for(b=c.data.length;g<b;)x=g++,null!=c.data[x]&&c.data[x].distance<r.distance&&(r=c.data[x]);e=r}g=h>e.distance}else g=!0;else g=!1;g?(null!=f&&f.put(),f=c):c.put()}sa.cached_body.shapes[0].put()}}la.put();return f};sa.linecast_all=
function(a,b,c,e){null==e&&(e=!0);var f=[],g=Math.min(a.start.x,a.end.x),x=Math.min(a.start.y,a.end.y),l=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,a.end.y),h=ab.pool.get();h.min_x=g;h.max_x=l;h.min_y=x;h.max_y=d;h.pooled=!1;var A=b;switch(A._hx_index){case 0:var r=A.v;x=Qb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;var n=r.bounds();if(h.min_x<n.max_x&&h.max_x>=n.min_x&&h.min_y<n.max_y&&h.max_y>=n.min_y){var m=0;for(e=r.shapes.length;m<e;)x=m++,x=r.shapes[x].intersect(a),null!=
x&&c.data.push(x)}n.put();0<c.data.length?f.push(c):c.put();break;case 1:if(b=A.v,null==c)for(A=0;A<b.length;){if(r=b[A],++A,null!=r){n=r.bounds();x=Qb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;if(h.min_x<n.max_x&&h.max_x>=n.min_x&&h.min_y<n.max_y&&h.max_y>=n.min_y)for(m=0,e=r.shapes.length;m<e;)x=m++,x=r.shapes[x].intersect(a),null!=x&&c.data.push(x);n.put();0<c.data.length?f.push(c):c.put()}}else{A=0;for(m=sa.cached_collisions;A<m.length;)n=m[A],++A,n.put();sa.cached_collisions.length=
0;n=sa.cached_body;g=h.min_x;x=h.min_y;l=h.max_x;d=h.max_y;r=tb.pool.get();A=.5*(g+l);m=.5*(x+d);g=l-g;d-=x;null==d&&(d=0);null==g&&(g=1);null==m&&(m=0);null==A&&(A=0);l=r.transform;l.dirty||l.set_dirty();l.local_x=A;l=r.transform;l.dirty||l.set_dirty();l.local_y=m;A=.5*g;l=r.transform;null==l.parent?m=l.local_scale_x:(l.sync(),m=l._scale_x);r.local_ex=A/m;if(null!=r.transformed_rect){l=r.transformed_rect;l.count=4;A=0;for(m=l.count;A<m;)if(x=A++,null==l.local_vertices[x]){var C=l.local_vertices,
Q=new O(0,0);C[x]=Q}A=l.local_vertices[0];A.x=-(r.local_ex*r.transform.local_scale_x);A.y=-(r.local_ey*r.transform.local_scale_y);A=l.local_vertices[1];A.x=r.local_ex*r.transform.local_scale_x;A.y=-(r.local_ey*r.transform.local_scale_y);A=l.local_vertices[2];A.x=r.local_ex*r.transform.local_scale_x;A.y=r.local_ey*r.transform.local_scale_y;A=l.local_vertices[3];A.x=-(r.local_ex*r.transform.local_scale_x);A.y=r.local_ey*r.transform.local_scale_y;A=r.transform.local_x;C=l.transform;C.dirty||C.set_dirty();
C.local_x=A;A=r.transform.local_y;C=l.transform;C.dirty||C.set_dirty();C.local_y=A;C=l.transform;A=Math.PI/180*(180/Math.PI)*r.transform.local_radians;C.dirty||C.set_dirty();C.local_radians=A;A=r.transform.local_scale_x;C=l.transform;C.dirty||C.set_dirty();C.local_scale_x=A;A=r.transform.local_scale_y;C=l.transform;C.dirty||C.set_dirty();C.local_scale_y=A;l.dirty_vertices=!0;l.dirty_bounds=!0}A=.5*(0>=d?g:d);l=r.transform;null==l.parent?m=l.local_scale_y:(l.sync(),m=l._scale_y);r.local_ey=A/m;if(null!=
r.transformed_rect){l=r.transformed_rect;l.count=4;A=0;for(m=l.count;A<m;)x=A++,null==l.local_vertices[x]&&(C=l.local_vertices,Q=new O(0,0),C[x]=Q);A=l.local_vertices[0];A.x=-(r.local_ex*r.transform.local_scale_x);A.y=-(r.local_ey*r.transform.local_scale_y);A=l.local_vertices[1];A.x=r.local_ex*r.transform.local_scale_x;A.y=-(r.local_ey*r.transform.local_scale_y);A=l.local_vertices[2];A.x=r.local_ex*r.transform.local_scale_x;A.y=r.local_ey*r.transform.local_scale_y;A=l.local_vertices[3];A.x=-(r.local_ex*
r.transform.local_scale_x);A.y=r.local_ey*r.transform.local_scale_y;A=r.transform.local_x;C=l.transform;C.dirty||C.set_dirty();C.local_x=A;A=r.transform.local_y;C=l.transform;C.dirty||C.set_dirty();C.local_y=A;C=l.transform;A=Math.PI/180*(180/Math.PI)*r.transform.local_radians;C.dirty||C.set_dirty();C.local_radians=A;A=r.transform.local_scale_x;C=l.transform;C.dirty||C.set_dirty();C.local_scale_x=A;A=r.transform.local_scale_y;C=l.transform;C.dirty||C.set_dirty();C.local_scale_y=A;l.dirty_vertices=
!0;l.dirty_bounds=!0}l=r.transform;A=Math.PI/180*0;l.dirty||l.set_dirty();l.local_radians=A;l=r.transform;l.dirty||l.set_dirty();l.local_scale_x=1;l=r.transform;l.dirty||l.set_dirty();l.local_scale_y=1;null==r.transformed_rect?(l=r.transform,null==l.parent?A=180/Math.PI*l.local_radians:(l.sync(),A=180/Math.PI*l._radians),A=0!=A):A=!1;if(A){g=Xa.pool.get();g.count=4;A=0;for(m=g.count;A<m;)x=A++,null==g.local_vertices[x]&&(d=g.local_vertices,Q=new O(0,0),d[x]=Q);A=g.local_vertices[0];A.x=-(r.local_ex*
r.transform.local_scale_x);A.y=-(r.local_ey*r.transform.local_scale_y);A=g.local_vertices[1];A.x=r.local_ex*r.transform.local_scale_x;A.y=-(r.local_ey*r.transform.local_scale_y);A=g.local_vertices[2];A.x=r.local_ex*r.transform.local_scale_x;A.y=r.local_ey*r.transform.local_scale_y;A=g.local_vertices[3];A.x=-(r.local_ex*r.transform.local_scale_x);A.y=r.local_ey*r.transform.local_scale_y;A=r.transform.local_x;l=g.transform;l.dirty||l.set_dirty();l.local_x=A;A=r.transform.local_y;l=g.transform;l.dirty||
l.set_dirty();l.local_y=A;l=g.transform;A=Math.PI/180*(180/Math.PI)*r.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=A;A=r.transform.local_scale_x;l=g.transform;l.dirty||l.set_dirty();l.local_scale_x=A;A=r.transform.local_scale_y;l=g.transform;l.dirty||l.set_dirty();l.local_scale_y=A;g.dirty_vertices=!0;g.dirty_bounds=!0;g.pooled=!1;r.transformed_rect=g;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(A=r.transform.local_x,l=r.transformed_rect.transform,l.dirty||
l.set_dirty(),l.local_x=A,A=r.transform.local_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_y=A,l=r.transformed_rect.transform,A=Math.PI/180*(180/Math.PI)*r.transform.local_radians,l.dirty||l.set_dirty(),l.local_radians=A,A=r.transform.local_scale_x,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_x=A,A=r.transform.local_scale_y,l=r.transformed_rect.transform,l.dirty||l.set_dirty(),l.local_scale_y=A);r.pooled=!1;null!=n.shapes[0]&&n.shapes[0].put();n.shapes[0]=
r;n.shapes[0].set_parent(n);n.dirty=!0;0>=n.mass&&null!=n.world&&(n.bounds(n.quadtree_data.bounds),n.world.static_quadtree.update(n.quadtree_data));e&&Ea.update_quadtree(c);Ea.overlap_body_and_bodies_bounds(sa.cached_body,b,c,sa.cached_collisions);A=0;for(m=sa.cached_collisions;A<m.length;){n=m[A];++A;r=n.b;x=Qb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;e=0;for(b=n.b.shapes.length;e<b;)x=e++,x=n.b.shapes[x].intersect(a),null!=x&&c.data.push(x);0<c.data.length?f.push(c):c.put()}sa.cached_body.shapes[0].put()}}h.put();
return f};sa.undo=function(a){if(null!=a.history){var b=a.history.undo();if(null!=b){for(var c=0;c<b.length;){var e=b[c];++c;for(var f=0,g=a.members;f<g.length;){var x=g[f];++f;if(e.id==x.id){var l=e.x,d=x.transform;d.dirty||d.set_dirty();d.local_x=l;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);l=e.y;d=x.transform;d.dirty||d.set_dirty();d.local_y=l;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);l=x.transform;d=Math.PI/180*e.rotation;l.dirty||l.set_dirty();
l.local_radians=d;if(null!=x.on_rotate)x.on_rotate(180/Math.PI*x.transform.local_radians);l=x.velocity;l.x=e.velocity_x;l.y=e.velocity_y;l=x.acceleration;l.x=e.acceleration_x;l.y=e.acceleration_y;x.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}}return a};sa.redo=function(a){if(null!=a.history){var b=a.history.redo();if(null!=b)for(var c=0;c<b.length;){var e=b[c];++c;for(var f=0,g=a.members;f<g.length;){var x=g[f];++f;if(e.id==x.id){var l=e.x,d=x.transform;d.dirty||d.set_dirty();
d.local_x=l;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);l=e.y;d=x.transform;d.dirty||d.set_dirty();d.local_y=l;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);l=x.transform;d=Math.PI/180*e.rotation;l.dirty||l.set_dirty();l.local_radians=d;if(null!=x.on_rotate)x.on_rotate(180/Math.PI*x.transform.local_radians);l=x.velocity;l.x=e.velocity_x;l.y=e.velocity_y;l=x.acceleration;l.x=e.acceleration_x;l.y=e.acceleration_y;x.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}return a};
var Mb=function(){};d["echo.util.Poolable"]=Mb;Mb.__name__=!0;Mb.__isInterface__=!0;var Vb=function(){};d["echo.util.Pool"]=Vb;Vb.__name__=!0;Vb.__isInterface__=!0;var hd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_Line"]=hd;hd.__name__=!0;hd.__interfaces__=[Vb];hd.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:hd};var Ib=function(a,
b,c,e){null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this.pooled=!1;this.start=a=new O(a,b);this.end=a=new O(c,e)};d["echo.Line"]=Ib;Ib.__name__=!0;Ib.__interfaces__=[Mb];Ib.prototype={set_from_vector:function(a,b,c){var e=Math.PI/180*b;b=a.x;var f=a.y,g=a.x+c*Math.cos(e);a=a.y+c*Math.sin(e);null==a&&(a=1);null==g&&(g=1);null==f&&(f=0);null==b&&(b=0);c=this.start;c.x=b;c.y=f;c=this.end;c.x=g;c.y=a;return this},get_x:function(){return this.start.x},get_y:function(){return this.start.y},
get_dx:function(){return this.end.x},get_dy:function(){return this.end.y},__class__:Ib,__properties__:{get_dy:"get_dy",get_dx:"get_dx",get_y:"get_y",get_x:"get_x"}};var Qc=function(a,b,c,e,f,g,x,l,d,h,n,r){this.a=a;this.b=b;this.separate=c;this.collisions=e;this.last_collisions=f;this.enter=g;this.stay=x;this.exit=l;this.condition=d;this.quadtree_results=h;this.percent_correction=n;this.correction_threshold=r};d["echo.Listener"]=Qc;Qc.__name__=!0;Qc.__properties__={get_defaults:"get_defaults"};Qc.get_defaults=
function(){return{separate:!0,percent_correction:.9,correction_threshold:.013}};Qc.prototype={__class__:Qc};var cc=function(a,b,c,e,f){this.gravity_scale=1;this.friction=this.static_friction=0;this.density=1;this.elasticity=0;null!=a&&(this.elasticity=a);null!=b&&(this.density=b);null!=c&&(this.friction=c);null!=e&&(this.static_friction=e);null!=f&&(this.gravity_scale=f)};d["echo.Material"]=cc;cc.__name__=!0;cc.prototype={__class__:cc};var gd=function(){};d["echo.Physics"]=gd;gd.__name__=!0;gd.step=
function(a,b){for(var c=0,e=a.members;c<e.length;){var f=e[c];++c;if(0<f.mass&&!f.disposed&&f.active){f.last_x=f.transform.local_x;f.last_y=f.transform.local_y;f.last_rotation=180/Math.PI*f.transform.local_radians;var g=f.acceleration.x*f.inverse_mass,x=f.acceleration.y*f.inverse_mass;f.kinematic||(g+=a.gravity.x*f.material.gravity_scale,x+=a.gravity.y*f.material.gravity_scale);var l=f.velocity.x,d=f.drag.x,h=f.max_velocity.x;1E-5>=Math.abs(g)?1E-5>=Math.abs(d)||(d*=b,l=0<l-d?l-d:0>l+d?l+d:0):l+=
g*b;1E-5>=Math.abs(h)||(g=-h,l<g?l=g:l>h&&(l=h));f.velocity.x=l;l=f.velocity.y;g=f.drag.y;h=f.max_velocity.y;1E-5>=Math.abs(x)?1E-5>=Math.abs(g)||(g*=b,l=0<l-g?l-g:0>l+g?l+g:0):l+=x*b;1E-5>=Math.abs(h)||(x=-h,l<x?l=x:l>h&&(l=h));f.velocity.y=l;0<f.drag_length?(x=f.acceleration,x=0==x.x&&0==x.y):x=!1;x?(x=f.velocity,x=!(0==x.x&&0==x.y)):x=!1;x&&(x=h=f.velocity,x=Math.sqrt(x.x*x.x+x.y*x.y)-f.drag_length*b,g=l=h,g=g.x*g.x+g.y*g.y,g=0==g?1:Math.sqrt(g),d=h.y/g*x,l.x=h.x/g*x,l.y=d);0<f.max_velocity_length?
(x=f.velocity,x=Math.sqrt(x.x*x.x+x.y*x.y)>f.max_velocity_length):x=!1;x&&(h=f.velocity,x=f.max_velocity_length,g=l=h,g=g.x*g.x+g.y*g.y,g=0==g?1:Math.sqrt(g),d=h.y/g*x,l.x=h.x/g*x,l.y=d);x=f.transform.local_x+f.velocity.x*b;l=f.transform;l.dirty||l.set_dirty();l.local_x=x;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y);x=f.transform.local_y+f.velocity.y*b;l=f.transform;l.dirty||l.set_dirty();l.local_y=x;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y);x=
f.rotational_velocity;h=f.rotational_drag;g=f.torque*f.inverse_mass;l=f.max_rotational_velocity;1E-5>=Math.abs(h)?1E-5>=Math.abs(g)||(g*=b,x=0<x-g?x-g:0>x+g?x+g:0):x+=h*b;1E-5>=Math.abs(l)||(h=-l,x<h?x=h:x>l&&(x=l));f.rotational_velocity=x;x=f.transform;l=Math.PI/180*(180/Math.PI*f.transform.local_radians+f.rotational_velocity*b);x.dirty||x.set_dirty();x.local_radians=l;if(null!=f.on_rotate)f.on_rotate(180/Math.PI*f.transform.local_radians)}}};gd.separate=function(a,b){a=null==b?a.listeners.members:
b.members;for(b=0;b<a.length;){var c=a[b];++b;if(c.separate)for(var e=0,f=c.collisions;e<f.length;){var g=f[e];++e;for(var x=0,l=g.data.length;x<l;){var d=x++,h=g.a,n=g.b;d=g.data[d];var r=c.correction_threshold,m=c.percent_correction;null==m&&(m=.9);null==r&&(r=.013);if(d.sa.solid&&d.sb.solid&&h.active&&n.active&&!h.disposed&&!n.disposed&&!(0>=h.mass&&0>=n.mass)){var C=(h.velocity.x-n.velocity.x)*d.normal.x+(h.velocity.y-n.velocity.y)*d.normal.y,Q=h.inverse_mass+n.inverse_mass;if(0<C){var w=-(1+
.5*(h.material.elasticity+n.material.elasticity))*C/Q;C=-w*d.normal.x;w=-w*d.normal.y;h.kinematic||(h.velocity.x-=C*h.inverse_mass,h.velocity.y-=w*h.inverse_mass);n.kinematic||(n.velocity.x+=C*n.inverse_mass,n.velocity.y+=w*n.inverse_mass)}m*=Math.max(d.overlap-r,0)/Q;r=m*d.normal.x;d=m*d.normal.y;if(!h.kinematic){m=h.transform.local_x-h.inverse_mass*r;Q=h.transform;Q.dirty||Q.set_dirty();Q.local_x=m;if(null!=h.on_move)h.on_move(h.transform.local_x,h.transform.local_y);m=h.transform.local_y-h.inverse_mass*
d;Q=h.transform;Q.dirty||Q.set_dirty();Q.local_y=m;if(null!=h.on_move)h.on_move(h.transform.local_x,h.transform.local_y)}if(!n.kinematic){h=n.transform.local_x+n.inverse_mass*r;r=n.transform;r.dirty||r.set_dirty();r.local_x=h;if(null!=n.on_move)n.on_move(n.transform.local_x,n.transform.local_y);h=n.transform.local_y+n.inverse_mass*d;d=n.transform;d.dirty||d.set_dirty();d.local_y=h;if(null!=n.on_move)n.on_move(n.transform.local_x,n.transform.local_y)}}}}}};var Ta=function(a,b,c){null==c&&(c=0);null==
b&&(b=0);null==a&&(a=0);this.solid=!0;var e=this.transform=new Jc;e.dirty||e.set_dirty();e.local_x=a;e=this.transform;e.dirty||e.set_dirty();e.local_y=b;e=this.transform;a=Math.PI/180*c;e.dirty||e.set_dirty();e.local_radians=a};d["echo.Shape"]=Ta;Ta.__name__=!0;Ta.__properties__={get_defaults:"get_defaults"};Ta.get=function(a){a=zd.copy_fields(a,Ta.get_defaults());switch(a.type){case 0:var b=a.offset_x,c=a.offset_y,e=a.width,f=a.height,g=a.rotation,x=a.scale_x,l=a.scale_y;null==l&&(l=1);null==x&&
(x=1);null==g&&(g=0);null==f&&(f=0);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);var d=tb.pool.get();var h=b,n=c;b=f;null==l&&(l=1);null==x&&(x=1);null==g&&(g=0);null==b&&(b=0);null==e&&(e=1);null==n&&(n=0);null==h&&(h=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=h;c=d.transform;c.dirty||c.set_dirty();c.local_y=n;h=.5*e;c=d.transform;null==c.parent?n=c.local_scale_x:(c.sync(),n=c._scale_x);d.local_ex=h/n;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;h=0;for(n=c.count;h<n;)if(f=
h++,null==c.local_vertices[f]){var r=c.local_vertices,m=new O(0,0);r[f]=m}h=c.local_vertices[0];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=-(d.local_ey*d.transform.local_scale_y);h=c.local_vertices[1];h.x=d.local_ex*d.transform.local_scale_x;h.y=-(d.local_ey*d.transform.local_scale_y);h=c.local_vertices[2];h.x=d.local_ex*d.transform.local_scale_x;h.y=d.local_ey*d.transform.local_scale_y;h=c.local_vertices[3];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=d.local_ey*d.transform.local_scale_y;
h=d.transform.local_x;r=c.transform;r.dirty||r.set_dirty();r.local_x=h;h=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=h;r=c.transform;h=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=h;h=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=h;h=d.transform.local_scale_y;r=c.transform;r.dirty||r.set_dirty();r.local_scale_y=h;c.dirty_vertices=!0;c.dirty_bounds=!0}h=.5*(0>=b?e:b);c=d.transform;null==c.parent?n=
c.local_scale_y:(c.sync(),n=c._scale_y);d.local_ey=h/n;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;h=0;for(n=c.count;h<n;)f=h++,null==c.local_vertices[f]&&(r=c.local_vertices,m=new O(0,0),r[f]=m);h=c.local_vertices[0];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=-(d.local_ey*d.transform.local_scale_y);h=c.local_vertices[1];h.x=d.local_ex*d.transform.local_scale_x;h.y=-(d.local_ey*d.transform.local_scale_y);h=c.local_vertices[2];h.x=d.local_ex*d.transform.local_scale_x;h.y=d.local_ey*
d.transform.local_scale_y;h=c.local_vertices[3];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=d.local_ey*d.transform.local_scale_y;h=d.transform.local_x;r=c.transform;r.dirty||r.set_dirty();r.local_x=h;h=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=h;r=c.transform;h=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=h;h=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=h;h=d.transform.local_scale_y;r=c.transform;
r.dirty||r.set_dirty();r.local_scale_y=h;c.dirty_vertices=!0;c.dirty_bounds=!0}c=d.transform;h=Math.PI/180*g;c.dirty||c.set_dirty();c.local_radians=h;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=x;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=l;null==d.transformed_rect?(c=d.transform,null==c.parent?l=180/Math.PI*c.local_radians:(c.sync(),l=180/Math.PI*c._radians),l=0!=l):l=!1;if(l){e=Xa.pool.get();e.count=4;h=0;for(n=e.count;h<n;)f=h++,null==e.local_vertices[f]&&(l=e.local_vertices,
m=new O(0,0),l[f]=m);h=e.local_vertices[0];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=-(d.local_ey*d.transform.local_scale_y);h=e.local_vertices[1];h.x=d.local_ex*d.transform.local_scale_x;h.y=-(d.local_ey*d.transform.local_scale_y);h=e.local_vertices[2];h.x=d.local_ex*d.transform.local_scale_x;h.y=d.local_ey*d.transform.local_scale_y;h=e.local_vertices[3];h.x=-(d.local_ex*d.transform.local_scale_x);h.y=d.local_ey*d.transform.local_scale_y;h=d.transform.local_x;c=e.transform;c.dirty||c.set_dirty();
c.local_x=h;h=d.transform.local_y;c=e.transform;c.dirty||c.set_dirty();c.local_y=h;c=e.transform;h=Math.PI/180*(180/Math.PI)*d.transform.local_radians;c.dirty||c.set_dirty();c.local_radians=h;h=d.transform.local_scale_x;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=h;h=d.transform.local_scale_y;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=h;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;d.transformed_rect=e;d.transformed_rect.set_parent(d.parent)}else null!=d.transformed_rect&&(h=
d.transform.local_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_x=h,h=d.transform.local_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_y=h,c=d.transformed_rect.transform,h=Math.PI/180*(180/Math.PI)*d.transform.local_radians,c.dirty||c.set_dirty(),c.local_radians=h,h=d.transform.local_scale_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_scale_x=h,h=d.transform.local_scale_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_scale_y=h);
d.pooled=!1;break;case 1:b=a.offset_x;c=a.offset_y;r=a.radius;g=a.rotation;x=a.scale_x;l=a.scale_y;null==l&&(l=1);null==x&&(x=1);null==g&&(g=0);null==r&&(r=1);null==c&&(c=0);null==b&&(b=0);d=Bb.pool.get();h=b;n=c;e=r;null==l&&(l=1);null==x&&(x=1);null==g&&(g=0);null==e&&(e=1);null==n&&(n=0);null==h&&(h=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=h;c=d.transform;c.dirty||c.set_dirty();c.local_y=n;c=d.transform;h=Math.PI/180*g;c.dirty||c.set_dirty();c.local_radians=h;c=d.transform;c.dirty||c.set_dirty();
c.local_scale_x=x;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=l;c=d.transform;null==c.parent?l=c.local_scale_x:(c.sync(),l=c._scale_x);d.local_radius=e/l;d.pooled=!1;break;case 2:if(null!=a.vertices)b=a.offset_x,c=a.offset_y,g=a.rotation,d=a.vertices,x=a.scale_x,l=a.scale_y,null==l&&(l=1),null==x&&(x=1),null==g&&(g=0),null==c&&(c=0),null==b&&(b=0),e=Xa.pool.get(),h=b,n=c,null==l&&(l=1),null==x&&(x=1),null==g&&(g=0),null==n&&(n=0),null==h&&(h=0),c=e.transform,c.dirty||c.set_dirty(),c.local_x=
h,c=e.transform,c.dirty||c.set_dirty(),c.local_y=n,c=e.transform,h=Math.PI/180*g,c.dirty||c.set_dirty(),c.local_radians=h,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_x=x,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_y=l,l=null,e.local_vertices=null==d?[]:d;else{b=a.offset_x;c=a.offset_y;n=a.sides;r=a.radius;g=a.rotation;x=a.scale_x;l=a.scale_y;null==l&&(l=1);null==x&&(x=1);null==g&&(g=0);null==r&&(r=1);null==n&&(n=3);null==c&&(c=0);null==b&&(b=0);if(3>n)throw y.thrown("Polygons require 3 sides as a minimum");
e=Xa.pool.get();var C=2*Math.PI/n;d=[];for(h=0;h<n;)f=h++,f=f*C+.5*(Math.PI-C),m=new O(Math.cos(f)*r,Math.sin(f)*r),d.push(m);h=b;n=c;null==l&&(l=1);null==x&&(x=1);null==g&&(g=0);null==n&&(n=0);null==h&&(h=0);c=e.transform;c.dirty||c.set_dirty();c.local_x=h;c=e.transform;c.dirty||c.set_dirty();c.local_y=n;c=e.transform;h=Math.PI/180*g;c.dirty||c.set_dirty();c.local_radians=h;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=x;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=l;l=null;e.local_vertices=
null==d?[]:d}e.count=null!=l&&0<=l?l:e.local_vertices.length;if(l>e.local_vertices.length)for(h=e.local_vertices.length,n=l;h<n;)f=h++,l=e.local_vertices,m=new O(0,0),l[f]=m;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;d=e}d.solid=a.solid;return d};Ta.get_defaults=function(){return{type:0,radius:1,width:1,height:0,sides:3,rotation:0,scale_x:1,scale_y:1,offset_x:0,offset_y:0,solid:!0}};Ta.prototype={put:function(){this.transform.set_parent(null);this.parent=null;this.collided=!1},set_parent:function(a){this.parent!=
a&&(this.parent=a,this.transform.set_parent(null==a?null:a.transform))},bounds:function(a){if(null==a){var b=this.transform;if(null==b.parent)var c=b.local_x;else b.sync(),c=b._x;b=this.transform;if(null==b.parent)var e=b.local_y;else b.sync(),e=b._y;var f=0;b=0;null==b&&(b=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);a=ab.pool.get();null==b&&(b=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);f*=.5;b*=.5;a.min_x=c-f;a.min_y=e-b;a.max_x=c+f;a.max_y=e+b;a.pooled=!1;return a}b=this.transform;null==
b.parent?c=b.local_x:(b.sync(),c=b._x);b=this.transform;null==b.parent?e=b.local_y:(b.sync(),e=b._y);b=f=0;null==b&&(b=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);f*=.5;b*=.5;a.min_x=c-f;a.min_y=e-b;a.max_x=c+f;a.max_y=e+b;return a},volume:function(){return 0},intersect:function(a){return null},collides:function(a){return null},collide_rect:function(a){return null},collide_circle:function(a){return null},collide_polygon:function(a){return null},__class__:Ta};var ed=function(a){this.members=null==
a.members?[]:a.members;this.init=!1;var b;if(1>a.width)throw y.thrown("World must have a width of at least 1");this.width=b=a.width;this.init&&this.reset_quadtrees();if(1>a.height)throw y.thrown("World must have a width of at least 1");this.height=b=a.height;this.init&&this.reset_quadtrees();this.x=null==a.x?0:a.x;this.init&&this.reset_quadtrees();this.y=null==a.y?0:a.y;this.init&&this.reset_quadtrees();this.gravity=new O(null==a.gravity_x?0:a.gravity_x,null==a.gravity_y?0:a.gravity_y);this.reset_quadtrees();
this.listeners=new Pc(a.listeners);this.iterations=null==a.iterations?5:a.iterations;null!=a.history&&(this.history=new je(a.history))};d["echo.World"]=ed;ed.__name__=!0;ed.__interfaces__=[ic];ed.prototype={add:function(a){if(a.world==this)return a;null!=a.world&&(null!=a.world&&a.world.remove(a),null!=a.quadtree_data&&null!=a.quadtree_data.bounds&&a.quadtree_data.bounds.put());a.world=this;a.dirty=!0;this.members.push(a);a.quadtree_data=new ke(a.id,a.bounds(),!1);0>=a.mass?this.static_quadtree.insert(a.quadtree_data):
this.quadtree.insert(a.quadtree_data);return a},remove:function(a){this.quadtree.remove(a.quadtree_data);this.static_quadtree.remove(a.quadtree_data);K.remove(this.members,a);a.world=null;return a},reset_quadtrees:function(){this.init=!0;if(null!=this.quadtree){var a=this.quadtree;if(!a.pooled){a.pooled=!0;for(var b=0,c=a.children.length;b<c;){var e=b++;if(null!=a.children[e]){a.children[e].clear_children();var f=a.children[e];f.pooled||(f.pooled=!0,f.clear_children(),f.contents.length=0,f.contents_count=
0,f.nodes_list.length=0,Pa.pool.put_unsafe(f));a.children[e]=null}}a.contents.length=0;a.contents_count=0;a.nodes_list.length=0;Pa.pool.put_unsafe(a)}}var g=Pa.pool.get();c=b=0;var d=1,l=1;null==l&&(l=1);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);d*=.5;l*=.5;g.min_x=b-d;g.min_y=c-l;g.max_x=b+d;g.max_y=c+l;b=0;for(c=g.children.length;b<c;)e=b++,null!=g.children[e]&&(g.children[e].clear_children(),a=g.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=0,a.nodes_list.length=
0,Pa.pool.put_unsafe(a)),g.children[e]=null);g.contents.length=0;g.contents_count=0;g.pooled=!1;this.quadtree=g;if(null!=this.static_quadtree&&(a=this.static_quadtree,!a.pooled)){a.pooled=!0;b=0;for(c=a.children.length;b<c;)e=b++,null!=a.children[e]&&(a.children[e].clear_children(),f=a.children[e],f.pooled||(f.pooled=!0,f.clear_children(),f.contents.length=0,f.contents_count=0,f.nodes_list.length=0,Pa.pool.put_unsafe(f)),a.children[e]=null);a.contents.length=0;a.contents_count=0;a.nodes_list.length=
0;Pa.pool.put_unsafe(a)}g=Pa.pool.get();c=b=0;l=d=1;null==l&&(l=1);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);d*=.5;l*=.5;g.min_x=b-d;g.min_y=c-l;g.max_x=b+d;g.max_y=c+l;b=0;for(c=g.children.length;b<c;)e=b++,null!=g.children[e]&&(g.children[e].clear_children(),a=g.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=0,a.nodes_list.length=0,Pa.pool.put_unsafe(a)),g.children[e]=null);g.contents.length=0;g.contents_count=0;g.pooled=!1;this.static_quadtree=g;g=
null;if(null!=g){b=this.x+.5*this.width;c=this.y+.5*this.height;d=this.width;l=this.height;null==l&&(l=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);a=g.transform;a.dirty||a.set_dirty();a.local_x=b;a=g.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*d;a=g.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);g.local_ex=b/a;if(null!=g.transformed_rect){a=g.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)if(e=b++,null==a.local_vertices[e]){f=a.local_vertices;var h=new O(0,0);f[e]=
h}b=a.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=a.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;
b=g.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=g.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=g.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*(0>=l?d:l);a=g.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);g.local_ey=b/a;if(null!=g.transformed_rect){a=
g.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,h=new O(0,0),f[e]=h);b=a.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=a.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);
b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=g.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=g.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=g.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=g.transform;
b=Math.PI/180*0;a.dirty||a.set_dirty();a.local_radians=b;a=g.transform;a.dirty||a.set_dirty();a.local_scale_x=1;a=g.transform;a.dirty||a.set_dirty();a.local_scale_y=1;null==g.transformed_rect?(a=g.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){l=Xa.pool.get();l.count=4;b=0;for(c=l.count;b<c;)e=b++,null==l.local_vertices[e]&&(a=l.local_vertices,h=new O(0,0),a[e]=h);b=l.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*
g.transform.local_scale_y);b=l.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=l.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=l.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;a=l.transform;a.dirty||a.set_dirty();a.local_x=b;b=g.transform.local_y;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;
b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=g.transform.local_scale_x;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=g.transform.local_scale_y;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=b;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;g.transformed_rect=l;g.transformed_rect.set_parent(g.parent)}else null!=g.transformed_rect&&(b=g.transform.local_x,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=g.transform.local_y,
a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=g.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*g.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=g.transform.local_scale_x,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=g.transform.local_scale_y,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_y=b)}else{b=this.x+.5*this.width;c=this.y+.5*this.height;d=this.width;l=this.height;null==l&&(l=0);null==d&&(d=1);
null==c&&(c=0);null==b&&(b=0);g=tb.pool.get();var n=0,m=1,r=1;null==r&&(r=1);null==m&&(m=1);null==n&&(n=0);null==l&&(l=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);a=g.transform;a.dirty||a.set_dirty();a.local_x=b;a=g.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*d;a=g.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);g.local_ex=b/a;if(null!=g.transformed_rect){a=g.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,h=new O(0,
0),f[e]=h);b=a.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=a.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=
b;b=g.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=g.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=g.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*(0>=l?d:l);a=g.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);g.local_ey=b/a;if(null!=g.transformed_rect){a=
g.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,h=new O(0,0),f[e]=h);b=a.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=a.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=a.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);
b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=g.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=g.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=g.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=g.transform;
b=Math.PI/180*n;a.dirty||a.set_dirty();a.local_radians=b;a=g.transform;a.dirty||a.set_dirty();a.local_scale_x=m;a=g.transform;a.dirty||a.set_dirty();a.local_scale_y=r;null==g.transformed_rect?(a=g.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){l=Xa.pool.get();l.count=4;b=0;for(c=l.count;b<c;)e=b++,null==l.local_vertices[e]&&(a=l.local_vertices,h=new O(0,0),a[e]=h);b=l.local_vertices[0];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=-(g.local_ey*
g.transform.local_scale_y);b=l.local_vertices[1];b.x=g.local_ex*g.transform.local_scale_x;b.y=-(g.local_ey*g.transform.local_scale_y);b=l.local_vertices[2];b.x=g.local_ex*g.transform.local_scale_x;b.y=g.local_ey*g.transform.local_scale_y;b=l.local_vertices[3];b.x=-(g.local_ex*g.transform.local_scale_x);b.y=g.local_ey*g.transform.local_scale_y;b=g.transform.local_x;a=l.transform;a.dirty||a.set_dirty();a.local_x=b;b=g.transform.local_y;a=l.transform;a.dirty||a.set_dirty();a.local_y=b;a=l.transform;
b=Math.PI/180*(180/Math.PI)*g.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=g.transform.local_scale_x;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=g.transform.local_scale_y;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=b;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;g.transformed_rect=l;g.transformed_rect.set_parent(g.parent)}else null!=g.transformed_rect&&(b=g.transform.local_x,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=g.transform.local_y,
a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=g.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*g.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=g.transform.local_scale_x,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=g.transform.local_scale_y,a=g.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_y=b);g.pooled=!1}b=g.to_aabb(!0);a=this.quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;
a=this.static_quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;b=0;for(c=this.members;b<c.length;)g=c[b],++b,0<g.mass?g.dirty=!0:(g.bounds(g.quadtree_data.bounds),this.static_quadtree.update(g.quadtree_data))},__class__:ed};var ie=function(a,b,c,e,f,g,d,l,h){this.id=a;this.x=b;this.y=c;this.rotation=e;this.velocity_x=f;this.velocity_y=g;this.acceleration_x=d;this.acceleration_y=l;this.rotational_velocity=h};d["echo.data.BodyState"]=ie;ie.__name__=!0;ie.prototype={__class__:ie};
var Ad=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_Collision"]=Ad;Ad.__name__=!0;Ad.__interfaces__=[Vb];Ad.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Ad};var dc=function(){this.pooled=!1;this.data=[]};d["echo.data.Collision"]=dc;dc.__name__=!0;dc.__interfaces__=[Mb];dc.prototype={put:function(){if(!this.pooled){for(var a=
0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;dc.pool.put_unsafe(this)}},__class__:dc};var Kc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_CollisionData"]=Kc;Kc.__name__=!0;Kc.__interfaces__=[Vb];Kc.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Kc};var uc=function(){this.pooled=!1;var a=new O(0,0);this.normal=
a;a=new O(0,0);var b=new O(0,0);this.contacts=[a,b].slice(0);this.overlap=this.contact_count=0};d["echo.data.CollisionData"]=uc;uc.__name__=!0;uc.__interfaces__=[Mb];uc.prototype={put:function(){this.pooled||(this.pooled=!0,uc.pool.put_unsafe(this))},__class__:uc};var id=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_Intersection"]=id;id.__name__=!0;id.__interfaces__=[Vb];id.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,[]):this.members[--this.count]},
put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:id};var Qb=function(){this.pooled=!1;this.data=[]};d["echo.data.Intersection"]=Qb;Qb.__name__=!0;Qb.__interfaces__=[Mb];Qb.prototype={put:function(){if(!this.pooled){for(var a=0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;Qb.pool.put_unsafe(this)}},__class__:Qb};var Rc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_IntersectionData"]=Rc;Rc.__name__=!0;Rc.__interfaces__=
[Vb];Rc.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Rc};var Wb=function(){this.inverse_normal=this.pooled=!1;var a=new O(0,0);this.normal=a;this.distance=this.overlap=0;this.hit=a=new O(0,0);this.hit=a=new O(0,0);this.normal=a=new O(0,0)};d["echo.data.IntersectionData"]=Wb;Wb.__name__=!0;Wb.__interfaces__=[Mb];Wb.prototype={put:function(){this.pooled||(this.pooled=
!0,Wb.pool.put_unsafe(this))},__class__:Wb};var ke=function(a,b,c){this.flag=!1;this.bounds=null;this.id=a;null!=b&&(this.bounds=b);null!=c&&(this.flag=c)};d["echo.data.QuadTreeData"]=ke;ke.__name__=!0;ke.prototype={__class__:ke};var le=function(a,b,c,e,f,g,d,l,h){this.m00=a;this.m10=b;this.m20=c;this.m01=e;this.m11=f;this.m21=g;this.m02=d;this.m12=l;this.m22=h};d["echo.math.Matrix3Default"]=le;le.__name__=!0;le.prototype={__class__:le};var O=function(a,b){this.x=a;this.y=b};d["echo.math.Vector2Default"]=
O;O.__name__=!0;O.prototype={__class__:O};var Lc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Circle"]=Lc;Lc.__name__=!0;Lc.__interfaces__=[Vb];Lc.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Lc};var Bb=function(){this.pooled=!1;Ta.call(this);this.type=1;var a=this.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=
a._scale_x);this.local_radius=0/a};d["echo.shape.Circle"]=Bb;Bb.__name__=!0;Bb.__interfaces__=[Mb];Bb.get=function(a,b,c,e,f,g){null==g&&(g=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var d=Bb.pool.get();null==g&&(g=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=d.transform;l.dirty||l.set_dirty();l.local_x=a;l=d.transform;l.dirty||l.set_dirty();l.local_y=b;l=d.transform;a=Math.PI/180*e;l.dirty||l.set_dirty();l.local_radians=a;
l=d.transform;l.dirty||l.set_dirty();l.local_scale_x=f;l=d.transform;l.dirty||l.set_dirty();l.local_scale_y=g;l=d.transform;null==l.parent?a=l.local_scale_x:(l.sync(),a=l._scale_x);d.local_radius=c/a;d.pooled=!1;return d};Bb.__super__=Ta;Bb.prototype=u(Ta.prototype,{put:function(){Ta.prototype.put.call(this);this.pooled||(this.pooled=!0,Bb.pool.put_unsafe(this))},bounds:function(a){var b=this.local_radius,c=this.transform;null==c.parent?c=c.local_scale_x:(c.sync(),c=c._scale_x);b=b*c*2;if(null==a){c=
this.transform;if(null==c.parent)var e=c.local_x;else c.sync(),e=c._x;c=this.transform;if(null==c.parent)var f=c.local_y;else c.sync(),f=c._y;c=b;null==b&&(b=1);null==c&&(c=1);null==f&&(f=0);null==e&&(e=0);a=ab.pool.get();null==b&&(b=1);null==c&&(c=1);null==f&&(f=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=f-b;a.max_x=e+c;a.max_y=f+b;a.pooled=!1;return a}c=this.transform;null==c.parent?e=c.local_x:(c.sync(),e=c._x);c=this.transform;null==c.parent?f=c.local_y:(c.sync(),f=c._y);c=b;null==b&&(b=
1);null==c&&(c=1);null==f&&(f=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=f-b;a.max_x=e+c;a.max_y=f+b;return a},volume:function(){var a=this.local_radius,b=this.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);a*=b;return Math.PI*a*a},intersect:function(a){return Ba.line_intersects_circle(a,this)},collides:function(a){return a.collide_circle(this)},collide_rect:function(a){return Ba.rect_and_circle(a,this,!0)},collide_circle:function(a){return Ba.circle_and_circle(a,this)},
collide_polygon:function(a){return Ba.circle_and_polygon(this,a,!0)},__class__:Bb});var jd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Polygon"]=jd;jd.__name__=!0;jd.__interfaces__=[Vb];jd.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:jd};var Xa=function(a){this.pooled=!1;Ta.call(this);this.type=2;this._vertices=[];this._normals=
[];var b=ab.pool.get(),c=0,e=0,f=1,g=1;null==g&&(g=1);null==f&&(f=1);null==e&&(e=0);null==c&&(c=0);f*=.5;g*=.5;b.min_x=c-f;b.min_y=e-g;b.max_x=c+f;b.max_y=e+g;b.pooled=!1;this._bounds=b;this.transform.on_dirty=p(this,this.on_dirty);this.local_vertices=null==a?[]:a;this.count=this.local_vertices.length;if(null>this.local_vertices.length)for(a=this.local_vertices.length;null>a;)b=a++,c=this.local_vertices,e=new O(0,0),c[b]=e;this.dirty_bounds=this.dirty_vertices=!0};d["echo.shape.Polygon"]=Xa;Xa.__name__=
!0;Xa.__interfaces__=[Mb];Xa.get=function(a,b,c,e,f,g,d){null==d&&(d=1);null==g&&(g=1);null==f&&(f=0);null==e&&(e=1);null==c&&(c=3);null==b&&(b=0);null==a&&(a=0);if(3>c)throw y.thrown("Polygons require 3 sides as a minimum");for(var l=Xa.pool.get(),x=2*Math.PI/c,h,n=[],r=0;r<c;){h=r++;h=h*x+.5*(Math.PI-x);var m=new O(Math.cos(h)*e,Math.sin(h)*e);n.push(m)}r=a;null==d&&(d=1);null==g&&(g=1);null==f&&(f=0);null==b&&(b=0);null==r&&(r=0);a=l.transform;a.dirty||a.set_dirty();a.local_x=r;a=l.transform;a.dirty||
a.set_dirty();a.local_y=b;a=l.transform;f*=Math.PI/180;a.dirty||a.set_dirty();a.local_radians=f;a=l.transform;a.dirty||a.set_dirty();a.local_scale_x=g;a=l.transform;a.dirty||a.set_dirty();a.local_scale_y=d;l.local_vertices=null==n?[]:n;l.count=l.local_vertices.length;if(null>l.local_vertices.length)for(r=l.local_vertices.length,c=null;r<c;)h=r++,n=l.local_vertices,m=new O(0,0),n[h]=m;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;return l};Xa.__super__=Ta;Xa.prototype=u(Ta.prototype,{put:function(){Ta.prototype.put.call(this);
this.pooled||(this.pooled=!0,Xa.pool.put_unsafe(this))},bounds:function(a){if(this.dirty_bounds){this.dirty_bounds=!1;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var f=this._vertices,g=new O(0,0);f[e]=g}var d=this.local_vertices[e].x,l=this.local_vertices[e].y;null==l&&(l=0);null==d&&(d=0);f=this.transform.get_local_to_world_matrix();g=
d;d=f.m01*g+f.m11*l+1*f.m21;var h=this._vertices[e];h.x=f.m00*g+f.m10*l+1*f.m20;h.y=d}}b=0;for(c=this.count;b<c;)e=b++,h=this._vertices[(e+1)%this.count],g=h.x,l=h.y,f=this._vertices[e],l-=f.y,g-=f.x,d=-l,l=g,g=d,null==this._normals[e]?(f=this._normals,g=new O(g,l),f[e]=g):(f=this._normals[e],f.x=g,f.y=l),l=e=g=this._normals[e],l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),f=g.y/l,e.x=g.x/l,e.y=f}h=this._vertices;g=h[0].x;l=h[0].y;f=h[0].x;d=h[0].y;b=1;for(c=this.count;b<c;)e=b++,h[e].x<g&&(g=h[e].x),h[e].y<
l&&(l=h[e].y),h[e].x>f&&(f=h[e].x),h[e].y>d&&(d=h[e].y);b=this._bounds;b.min_x=g;b.max_x=f;b.min_y=l;b.max_y=d}if(null==a)return b=this._bounds,a=b.min_x,c=b.min_y,e=b.max_x,g=b.max_y,b=ab.pool.get(),b.min_x=a,b.max_x=e,b.min_y=c,b.max_y=g,b.pooled=!1,b;b=this._bounds;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;return a},volume:function(){var a=0;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<
c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var f=this._vertices,g=new O(0,0);f[e]=g}var d=this.local_vertices[e].x,l=this.local_vertices[e].y;null==l&&(l=0);null==d&&(d=0);f=this.transform.get_local_to_world_matrix();g=d;var h=f.m01*g+f.m11*l+1*f.m21;d=this._vertices[e];d.x=f.m00*g+f.m10*l+1*f.m20;d.y=h}}b=0;for(c=this.count;b<c;)e=b++,d=this._vertices[(e+1)%this.count],g=d.x,l=d.y,f=this._vertices[e],l-=f.y,g-=f.x,d=-l,l=g,g=d,null==this._normals[e]?(f=this._normals,
g=new O(g,l),f[e]=g):(f=this._normals[e],f.x=g,f.y=l),l=e=g=this._normals[e],l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),f=g.y/l,e.x=g.x/l,e.y=f}g=this._vertices;d=g[g.length-1];b=0;for(c=this.count;b<c;)e=b++,e=g[e],a+=e.x*d.y-d.x*e.y,d=e;return.5*Math.abs(a)},intersect:function(a){return Ba.line_intersects_polygon(a,this)},collides:function(a){return a.collide_polygon(this)},collide_rect:function(a){return Ba.rect_and_polygon(a,this,!0)},collide_circle:function(a){return Ba.circle_and_polygon(a,this)},
collide_polygon:function(a){return Ba.polygon_and_polygon(a,this,!0)},on_dirty:function(a){this.dirty_bounds=this.dirty_vertices=!0},__class__:Xa});var Bd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Rect"]=Bd;Bd.__name__=!0;Bd.__interfaces__=[Vb];Bd.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Bd};var tb=function(){this.pooled=
!1;Ta.call(this);this.local_ex=0;if(null!=this.transformed_rect){var a=this.transformed_rect;a.count=4;for(var b=0,c=a.count;b<c;){var e=b++;if(null==a.local_vertices[e]){var f=a.local_vertices,g=new O(0,0);f[e]=g}}b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;
b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=this.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;f.dirty||f.set_dirty();f.local_radians=b;b=this.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=
b;b=this.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.local_ey=0;if(null!=this.transformed_rect){a=this.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(f=a.local_vertices,g=new O(0,0),f[e]=g);b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*
this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;f=a.transform;f.dirty||f.set_dirty();f.local_x=b;b=this.transform.local_y;f=a.transform;f.dirty||f.set_dirty();f.local_y=b;f=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;f.dirty||f.set_dirty();
f.local_radians=b;b=this.transform.local_scale_x;f=a.transform;f.dirty||f.set_dirty();f.local_scale_x=b;b=this.transform.local_scale_y;f=a.transform;f.dirty||f.set_dirty();f.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.type=0;this.transform.on_dirty=p(this,this.on_dirty)};d["echo.shape.Rect"]=tb;tb.__name__=!0;tb.__interfaces__=[Mb];tb.get=function(a,b,c,e,f,g,d){null==d&&(d=1);null==g&&(g=1);null==f&&(f=0);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var l=tb.pool.get(),
x=b;null==d&&(d=1);null==g&&(g=1);null==f&&(f=0);null==e&&(e=0);null==c&&(c=1);null==x&&(x=0);null==a&&(a=0);b=l.transform;b.dirty||b.set_dirty();b.local_x=a;b=l.transform;b.dirty||b.set_dirty();b.local_y=x;a=.5*c;b=l.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);l.local_ex=a/b;if(null!=l.transformed_rect){b=l.transformed_rect;b.count=4;a=0;for(x=b.count;a<x;){var h=a++;if(null==b.local_vertices[h]){var n=b.local_vertices,r=new O(0,0);n[h]=r}}a=b.local_vertices[0];a.x=-(l.local_ex*
l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=b.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;n=b.transform;n.dirty||n.set_dirty();n.local_x=a;a=l.transform.local_y;n=b.transform;n.dirty||
n.set_dirty();n.local_y=a;n=b.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;n.dirty||n.set_dirty();n.local_radians=a;a=l.transform.local_scale_x;n=b.transform;n.dirty||n.set_dirty();n.local_scale_x=a;a=l.transform.local_scale_y;n=b.transform;n.dirty||n.set_dirty();n.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}a=.5*(0>=e?c:e);b=l.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);l.local_ey=a/b;if(null!=l.transformed_rect){b=l.transformed_rect;b.count=4;
a=0;for(x=b.count;a<x;)h=a++,null==b.local_vertices[h]&&(n=b.local_vertices,r=new O(0,0),n[h]=r);a=b.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=b.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=b.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;
a=l.transform.local_x;n=b.transform;n.dirty||n.set_dirty();n.local_x=a;a=l.transform.local_y;n=b.transform;n.dirty||n.set_dirty();n.local_y=a;n=b.transform;a=Math.PI/180*(180/Math.PI)*l.transform.local_radians;n.dirty||n.set_dirty();n.local_radians=a;a=l.transform.local_scale_x;n=b.transform;n.dirty||n.set_dirty();n.local_scale_x=a;a=l.transform.local_scale_y;n=b.transform;n.dirty||n.set_dirty();n.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}b=l.transform;a=Math.PI/180*f;b.dirty||b.set_dirty();
b.local_radians=a;b=l.transform;b.dirty||b.set_dirty();b.local_scale_x=g;b=l.transform;b.dirty||b.set_dirty();b.local_scale_y=d;null==l.transformed_rect?(b=l.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*b._radians),c=0!=c):c=!1;if(c){c=Xa.pool.get();c.count=4;a=0;for(x=c.count;a<x;)h=a++,null==c.local_vertices[h]&&(e=c.local_vertices,r=new O(0,0),e[h]=r);a=c.local_vertices[0];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=-(l.local_ey*l.transform.local_scale_y);
a=c.local_vertices[1];a.x=l.local_ex*l.transform.local_scale_x;a.y=-(l.local_ey*l.transform.local_scale_y);a=c.local_vertices[2];a.x=l.local_ex*l.transform.local_scale_x;a.y=l.local_ey*l.transform.local_scale_y;a=c.local_vertices[3];a.x=-(l.local_ex*l.transform.local_scale_x);a.y=l.local_ey*l.transform.local_scale_y;a=l.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=a;a=l.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=a;b=c.transform;a=Math.PI/180*(180/Math.PI)*
l.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=a;a=l.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=a;a=l.transform.local_scale_y;b=c.transform;b.dirty||b.set_dirty();b.local_scale_y=a;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;l.transformed_rect=c;l.transformed_rect.set_parent(l.parent)}else null!=l.transformed_rect&&(a=l.transform.local_x,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=a,a=l.transform.local_y,b=l.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_y=a,b=l.transformed_rect.transform,a=Math.PI/180*(180/Math.PI)*l.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=a,a=l.transform.local_scale_x,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=a,a=l.transform.local_scale_y,b=l.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=a);l.pooled=!1;return l};tb.__super__=Ta;tb.prototype=u(Ta.prototype,{put:function(){Ta.prototype.put.call(this);null!=this.transformed_rect&&
(this.transformed_rect.put(),this.transformed_rect=null);this.pooled||(this.pooled=!0,tb.pool.put_unsafe(this))},to_aabb:function(a){null==a&&(a=!1);if(a){a=null;if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;b=0!=c}else b=!1;if(b)a=this.transformed_rect.bounds(a);else if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),
c=b._y);var f=2*this.local_ex;b=this.transform;if(null==b.parent)var g=b.local_scale_x;else b.sync(),g=b._scale_x;f*=g;g=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);g*=b;null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);b=ab.pool.get();null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;g*=.5;b.min_x=e-f;b.min_y=c-g;b.max_x=e+f;b.max_y=c+g;b.pooled=!1;a=b}else b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,
null==b.parent?c=b.local_y:(b.sync(),c=b._y),f=2*this.local_ex,b=this.transform,null==b.parent?g=b.local_scale_x:(b.sync(),g=b._scale_x),f*=g,g=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),g*=b,null==g&&(g=1),null==f&&(f=1),null==c&&(c=0),null==e&&(e=0),f*=.5,g*=.5,a.min_x=e-f,a.min_y=c-g,a.max_x=e+f,a.max_y=c+g;this.put();return a}a=null;null!=this.transformed_rect?(b=this.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*
b._radians),c=0!=c):c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a)return b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,null==b.parent?c=b.local_y:(b.sync(),c=b._y),f=2*this.local_ex,b=this.transform,null==b.parent?g=b.local_scale_x:(b.sync(),g=b._scale_x),f*=g,g=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),g*=b,null==g&&(g=1),null==f&&(f=1),null==c&&(c=0),null==e&&(e=0),a=ab.pool.get(),null==g&&(g=1),null==
f&&(f=1),null==c&&(c=0),null==e&&(e=0),f*=.5,g*=.5,a.min_x=e-f,a.min_y=c-g,a.max_x=e+f,a.max_y=c+g,a.pooled=!1,a;b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);f=2*this.local_ex;b=this.transform;null==b.parent?g=b.local_scale_x:(b.sync(),g=b._scale_x);f*=g;g=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);g*=b;null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;g*=.5;
a.min_x=e-f;a.min_y=c-g;a.max_x=e+f;a.max_y=c+g;return a},bounds:function(a){if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;c=0!=c}else c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);var f=2*this.local_ex;b=this.transform;if(null==b.parent)var g=b.local_scale_x;
else b.sync(),g=b._scale_x;f*=g;g=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);g*=b;null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);a=ab.pool.get();null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;g*=.5;a.min_x=e-f;a.min_y=c-g;a.max_x=e+f;a.max_y=c+g;a.pooled=!1;return a}b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);f=2*this.local_ex;b=this.transform;
null==b.parent?g=b.local_scale_x:(b.sync(),g=b._scale_x);f*=g;g=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);g*=b;null==g&&(g=1);null==f&&(f=1);null==c&&(c=0);null==e&&(e=0);f*=.5;g*=.5;a.min_x=e-f;a.min_y=c-g;a.max_x=e+f;a.max_y=c+g;return a},volume:function(){var a=2*this.local_ex,b=this.transform;if(null==b.parent)var c=b.local_scale_x;else b.sync(),c=b._scale_x;var e=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);
return a*c*e*b},intersect:function(a){return Ba.line_intersects_rect(a,this)},collides:function(a){return a.collide_rect(this)},collide_rect:function(a){return Ba.rect_and_rect(a,this)},collide_circle:function(a){return Ba.rect_and_circle(this,a)},collide_polygon:function(a){return Ba.rect_and_polygon(this,a)},set_parent:function(a){Ta.prototype.set_parent.call(this,a);if(null==this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*
b._radians;c=0!=c}else c=!1;if(c){c=Xa.pool.get();c.count=4;b=0;for(var e=c.count;b<e;){var f=b++;if(null==c.local_vertices[f]){var g=c.local_vertices,d=new O(0,0);g[f]=d}}e=c.local_vertices[0];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[1];e.x=this.local_ex*this.transform.local_scale_x;e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[2];e.x=this.local_ex*this.transform.local_scale_x;e.y=this.local_ey*this.transform.local_scale_y;
e=c.local_vertices[3];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=this.local_ey*this.transform.local_scale_y;e=this.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=e;e=this.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=e;b=c.transform;e=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=e;e=this.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=e;e=this.transform.local_scale_y;b=c.transform;
b.dirty||b.set_dirty();b.local_scale_y=e;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;this.transformed_rect=c;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(e=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=e,e=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=e,b=this.transformed_rect.transform,e=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=
e,e=this.transform.local_scale_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=e,e=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=e);null!=this.transformed_rect&&this.transformed_rect.set_parent(a)},on_dirty:function(a){if(null==this.transformed_rect){var b=this.transform;null==b.parent?a=180/Math.PI*b.local_radians:(b.sync(),a=180/Math.PI*b._radians);a=0!=a}else a=!1;if(a){a=Xa.pool.get();a.count=4;b=0;for(var c=a.count;b<
c;){var e=b++;if(null==a.local_vertices[e]){var f=a.local_vertices,g=new O(0,0);f[e]=g}}c=a.local_vertices[0];c.x=-(this.local_ex*this.transform.local_scale_x);c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[1];c.x=this.local_ex*this.transform.local_scale_x;c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[2];c.x=this.local_ex*this.transform.local_scale_x;c.y=this.local_ey*this.transform.local_scale_y;c=a.local_vertices[3];c.x=-(this.local_ex*this.transform.local_scale_x);
c.y=this.local_ey*this.transform.local_scale_y;c=this.transform.local_x;b=a.transform;b.dirty||b.set_dirty();b.local_x=c;c=this.transform.local_y;b=a.transform;b.dirty||b.set_dirty();b.local_y=c;b=a.transform;c=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=c;c=this.transform.local_scale_x;b=a.transform;b.dirty||b.set_dirty();b.local_scale_x=c;c=this.transform.local_scale_y;b=a.transform;b.dirty||b.set_dirty();b.local_scale_y=c;a.dirty_vertices=!0;a.dirty_bounds=
!0;a.pooled=!1;this.transformed_rect=a;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(c=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=c,c=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=c,b=this.transformed_rect.transform,c=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=c,c=this.transform.local_scale_x,b=this.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_scale_x=c,c=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=c)},__class__:tb});var Cd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_util_AABB"]=Cd;Cd.__name__=!0;Cd.__interfaces__=[Vb];Cd.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Cd};var ab=
function(){this.pooled=!1;this.min_x=0;this.max_x=1;this.min_y=0;this.max_y=1};d["echo.util.AABB"]=ab;ab.__name__=!0;ab.__interfaces__=[Mb];ab.prototype={put:function(){this.pooled||(this.pooled=!0,ab.pool.put_unsafe(this))},__class__:ab};var $e={_new:function(a){null==a&&(a=0);return a}},Dd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_util_QuadTree"]=Dd;Dd.__name__=!0;Dd.__interfaces__=[Vb];Dd.prototype={get:function(){return 0==this.count?Ja.createInstance(this.type,
[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Dd};var je=function(a){this.re=new Ed(a);this.un=new Ed(a)};d["echo.util.History_Array_echo_data_BodyState"]=je;je.__name__=!0;je.prototype={redo:function(){var a=this.re.pop();null!=a&&this.un.push(a);return a},undo:function(){var a=this.un.pop();null!=a&&this.re.push(a);return a},add:function(a){this.un.push(a);this.re.reset()},__class__:je};var zd=function(){};d["echo.util.JSON"]=zd;zd.__name__=
!0;zd.copy_fields=function(a,b){if(null==a)return b;if(null==b)b=R.copy(a);else for(var c=0,e=R.fields(a);c<e.length;){var f=e[c];++c;b[f]=R.field(a,f)}return b};var Pa=function(a,b){null==b&&(b=0);this.nodes_list=[];this.max_contents=10;this.max_depth=5;ab.call(this);null!=a&&(this.min_x=a.min_x,this.max_x=a.max_x,this.min_y=a.min_y,this.max_y=a.max_y);this.depth=b;this.children=Array(4);this.contents=[];this.contents_count=0};d["echo.util.QuadTree"]=Pa;Pa.__name__=!0;Pa.__super__=ab;Pa.prototype=
u(ab.prototype,{put:function(){if(!this.pooled){this.pooled=!0;for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];e.pooled||(e.pooled=!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,Pa.pool.put_unsafe(e));this.children[c]=null}}this.contents_count=this.contents.length=0;this.nodes_list.length=0;Pa.pool.put_unsafe(this)}},insert:function(a){if(null!=a.bounds){var b=a.bounds;if(b.min_x<
this.max_x&&b.max_x>=this.min_x&&b.min_y<this.max_y&&b.max_y>=this.min_y)if(null==this.children[0]&&this.contents_count+1>this.max_contents&&this.split(),null==this.children[0])b=this.get_first_null(this.contents),-1==b?this.contents.push(a):this.contents[b]=a,this.contents_count++;else{b=0;for(var c=this.children;b<c.length;){var e=c[b];++b;e.insert(a)}}}},remove:function(a,b){null==b&&(b=!0);if(null==this.children[0]){for(b=0;b<this.contents.length;){if(null!=this.contents[b]&&this.contents[b].id==
a.id)return this.contents[b]=null,this.contents_count--,!0;++b}return!1}for(var c=!1,e=0,f=this.children;e<f.length;){var g=f[e];++e;null!=g&&g.remove(a)&&(c=!0)}b&&c&&this.shake();return c},update:function(a,b){null==b&&(b=!0);this.remove(a,b);this.insert(a)},query:function(a,b){if(this.min_x<a.max_x&&this.max_x>=a.min_x&&this.min_y<a.max_y&&this.max_y>=a.min_y)if(null==this.children[0])for(var c=0,e=this.contents;c<e.length;){var f=e[c];++c;if(null!=f){var g=f.bounds;g=g.min_x<a.max_x&&g.max_x>=
a.min_x&&g.min_y<a.max_y&&g.max_y>=a.min_y}else g=!1;g&&b.push(f)}else for(c=0,e=this.children;c<e.length;)f=e[c],++c,f.query(a,b)},shake:function(){if(null==this.children[0])return!1;var a=this.get_count();if(0==a){a=0;for(var b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){for(var e=this.children[c],f=0,g=e.children.length;f<g;){var d=f++;if(null!=e.children[d]){e.children[d].clear_children();var l=e.children[d];l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=
0,l.nodes_list.length=0,Pa.pool.put_unsafe(l));e.children[d]=null}}f=this.children[c];if(!f.pooled){f.pooled=!0;g=0;for(e=f.children.length;g<e;)d=g++,null!=f.children[d]&&(f.children[d].clear_children(),l=f.children[d],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,Pa.pool.put_unsafe(l)),f.children[d]=null);f.contents.length=0;f.contents_count=0;f.nodes_list.length=0;Pa.pool.put_unsafe(f)}this.children[c]=null}}}else if(a<this.max_contents){this.nodes_list.length=
0;for(this.nodes_list.push(this);0<this.nodes_list.length;)if(b=this.nodes_list.shift(),b!=this&&null==b.children[0])for(a=0,b=b.contents;a<b.length;)c=b[a],++a,-1==this.contents.indexOf(c)&&(f=this.get_first_null(this.contents),-1==f?this.contents.push(c):this.contents[f]=c,this.contents_count++);else for(f=0,g=b.children;f<g.length;)a=g[f],++f,this.nodes_list.push(a);a=0;for(b=this.children.length;a<b;)if(c=a++,null!=this.children[c]){e=this.children[c];f=0;for(g=e.children.length;f<g;)d=f++,null!=
e.children[d]&&(e.children[d].clear_children(),l=e.children[d],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,Pa.pool.put_unsafe(l)),e.children[d]=null);f=this.children[c];if(!f.pooled){f.pooled=!0;g=0;for(e=f.children.length;g<e;)d=g++,null!=f.children[d]&&(f.children[d].clear_children(),l=f.children[d],l.pooled||(l.pooled=!0,l.clear_children(),l.contents.length=0,l.contents_count=0,l.nodes_list.length=0,Pa.pool.put_unsafe(l)),f.children[d]=
null);f.contents.length=0;f.contents_count=0;f.nodes_list.length=0;Pa.pool.put_unsafe(f)}this.children[c]=null}return!0}return!1},split:function(){if(!(this.depth+1>=this.max_depth)){for(var a=.5*(this.max_x-this.min_x),b=.5*(this.max_y-this.min_y),c=0;4>c;){var e=c++,f=Pa.pool.get(),g=0,d=0,l=1,h=1;null==h&&(h=1);null==l&&(l=1);null==d&&(d=0);null==g&&(g=0);l*=.5;h*=.5;f.min_x=g-l;f.min_y=d-h;f.max_x=g+l;f.max_y=d+h;g=0;for(d=f.children.length;g<d;)l=g++,null!=f.children[l]&&(f.children[l].clear_children(),
h=f.children[l],h.pooled||(h.pooled=!0,h.clear_children(),h.contents.length=0,h.contents_count=0,h.nodes_list.length=0,Pa.pool.put_unsafe(h)),f.children[l]=null);f.contents.length=0;f.contents_count=0;f.pooled=!1;switch(e){case 0:g=this.min_x+a;d=this.min_y+b;f.min_x=this.min_x;f.max_x=g;f.min_y=this.min_y;f.max_y=d;break;case 1:g=this.min_y+b;f.min_x=this.min_x+a;f.max_x=this.max_x;f.min_y=this.min_y;f.max_y=g;break;case 2:g=this.min_x+a;f.min_x=this.min_x;f.max_x=g;f.min_y=this.min_y+b;f.max_y=
this.max_y;break;case 3:f.min_x=this.min_x+a,f.max_x=this.max_x,f.min_y=this.min_y+b,f.max_y=this.max_y}f.depth=this.depth+1;g=this.max_depth;d=0;for(l=f.children.length;d<l;)if(h=d++,null!=f.children[h]){h=f.children[h];for(var n=0,m=h.children.length;n<m;){var r=n++;null!=h.children[r]&&h.children[r].set_max_depth(g)}h.max_depth=g}f.max_depth=g;g=this.max_contents;d=0;for(l=f.children.length;d<l;)if(h=d++,null!=f.children[h]){h=f.children[h];n=0;for(m=h.children.length;n<m;)if(r=n++,null!=h.children[r]){r=
h.children[r];for(var C=0,Q=r.children.length;C<Q;){var w=C++;null!=r.children[w]&&r.children[w].set_max_depth(g)}r.max_depth=g}h.max_depth=g}f.max_contents=g;f.shake();g=0;for(d=this.contents.length;g<d;)l=g++,null!=this.contents[l]&&f.insert(this.contents[l]);this.children[e]=f}this.contents_count=this.contents.length=0}},clear_children:function(){for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];e.pooled||(e.pooled=
!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,Pa.pool.put_unsafe(e));this.children[c]=null}}},reset_data_flags:function(){for(var a=0,b=this.contents.length;a<b;){var c=a++;null!=this.contents[c]&&(this.contents[c].flag=!1)}a=0;for(b=this.children.length;a<b;)c=a++,null!=this.children[c]&&this.children[c].reset_data_flags()},get_count:function(){this.reset_data_flags();for(var a=0,b=0,c=this.contents.length;b<c;){var e=b++;null!=this.contents[e]&&(this.contents[e].flag=
!0,++a)}this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;){var f=this.nodes_list.shift();if(null==f.children[0])for(b=0,c=f.contents.length;b<c;)e=b++,null==f.contents[e]||f.contents[e].flag||(++a,f.contents[e].flag=!0);else for(b=0,c=f.children.length;b<c;)e=b++,this.nodes_list.push(f.children[e])}return a},get_first_null:function(a){for(var b=0,c=a.length;b<c;){var e=b++;if(null==a[e])return e}return-1},set_max_depth:function(a){for(var b=0,c=this.children.length;b<
c;){var e=b++;null!=this.children[e]&&this.children[e].set_max_depth(a)}return this.max_depth=a},__class__:Pa,__properties__:{get_count:"get_count",set_max_depth:"set_max_depth"}});var Ed=function(a){this.a=Array(a);this.reset()};d["echo.util.Ring_Array_echo_data_BodyState"]=Ed;Ed.__name__=!0;Ed.prototype={pop:function(){if(0>=this.i+this.left-this.start)return null;0==this.i&&(this.i=this.a.length,this.left=0);return this.a[--this.i]},push:function(a){this.i==this.a.length&&(0<this.left&&this.start==
this.i&&(this.start=0),this.i=0,this.left=this.a.length);this.i+this.left-this.start==this.a.length&&this.start++;this.a[this.i++]=a},reset:function(){this.left=this.start=this.i=0},__class__:Ed};var Ba=function(){};d["echo.util.SAT"]=Ba;Ba.__name__=!0;Ba.line_intersects_rect=function(a,b){if(null!=b.transformed_rect){var c=b.transform;if(null==c.parent)var e=180/Math.PI*c.local_radians;else c.sync(),e=180/Math.PI*c._radians;var f=0!=e}else f=!1;if(f)return b.transformed_rect.intersect(a);var g=null;
if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var d=180/Math.PI*c.local_radians;else c.sync(),d=180/Math.PI*c._radians;var l=0==d}else l=!0;if(l){c=b.transform;null==c.parent?l=c.local_x:(c.sync(),l=c._x);var h=l-b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var n=0,m=c.count;n<m;){var r=n++;if(null!=c.local_vertices[r]){if(null==c._vertices[r]){var C=c._vertices,
Q=new O(0,0);C[r]=Q}var w=c.local_vertices[r].x,k=c.local_vertices[r].y;null==k&&(k=0);null==w&&(w=0);var q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[r];t.x=u;t.y=v}}n=0;for(m=c.count;n<m;){r=n++;t=c._vertices[(r+1)%c.count];p=t.x;E=t.y;var y=c._vertices[r],B=p-y.x,ya=E-y.y;p=B;E=ya;w=-E;E=p;p=w;null==c._normals[r]?(C=c._normals,Q=new O(p,E),C[r]=Q):(q=c._normals[r],q.x=p,q.y=E);var wa=c._normals[r],R=wa,G=wa,D=
G,ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z;R.x=Na;R.y=J}}l=null==c._vertices[0]}else l=!0;if(l)C=c.transform,null==C.parent?h=C.local_x:(C.sync(),h=C._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();n=0;for(m=c.count;n<m;)r=n++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,Q=new O(0,0),C[r]=Q),w=c.local_vertices[r].x,k=c.local_vertices[r].y,null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),
p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[r],t.x=u,t.y=v);n=0;for(m=c.count;n<m;)r=n++,t=c._vertices[(r+1)%c.count],p=t.x,E=t.y,y=c._vertices[r],B=p-y.x,ya=E-y.y,p=B,E=ya,w=-E,E=p,p=w,null==c._normals[r]?(C=c._normals,Q=new O(p,E),C[r]=Q):(q=c._normals[r],q.x=p,q.y=E),D=G=R=wa=c._normals[r],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}l=c._vertices[0].x;n=1;for(m=c.count;n<m;){r=n++;if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();for(var qa=0,da=c.count;qa<da;){var H=qa++;null!=c.local_vertices[H]&&(null==c._vertices[H]&&(C=c._vertices,Q=new O(0,0),C[H]=Q),w=c.local_vertices[H].x,k=c.local_vertices[H].y,null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[H],t.x=u,t.y=v)}for(var I=0,za=c.count;I<za;){var P=I++;wa=c._vertices[(P+1)%c.count];var T=wa.x,K=wa.y;y=c._vertices[P];
B=T-y.x;ya=K-y.y;T=B;K=ya;var N=-K;K=T;T=N;if(null==c._normals[P]){var pa=c._normals,U=new O(T,K);pa[P]=U}else{var V=c._normals[P];V.x=T;V.y=K}var Ca=c._normals[P];D=G=R=Ca;ha=D.x*D.x+D.y*D.y;fa=0==ha?1:Math.sqrt(ha);F=G.x/fa;z=G.y/fa;Na=F;J=z;R.x=Na;R.y=J}}if(c._vertices[r].x<l){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var Z=0,Y=c.count;Z<Y;){var ta=Z++;if(null!=c.local_vertices[ta]){if(null==c._vertices[ta]){var X=c._vertices,ca=new O(0,0);X[ta]=
ca}var ba=c.local_vertices[ta].x,aa=c.local_vertices[ta].y;null==aa&&(aa=0);null==ba&&(ba=0);var S=c.transform.get_local_to_world_matrix(),kb=ba,ja=aa,Ja=1,ma=S.m00*kb+S.m10*ja+S.m20*Ja,Sa=S.m01*kb+S.m11*ja+S.m21*Ja,ka=ma,oa=Sa,sa=c._vertices[ta];sa.x=ka;sa.y=oa}}for(var ra=0,Va=c.count;ra<Va;){var ia=ra++,xa=c._vertices[(ia+1)%c.count],na=xa.x,ub=xa.y,Da=c._vertices[ia],ua=na-Da.x,Ea=ub-Da.y;na=ua;ub=Ea;var Wa=-ub;ub=na;na=Wa;if(null==c._normals[ia]){var Ha=c._normals,La=new O(na,ub);Ha[ia]=La}else{var Ga=
c._normals[ia];Ga.x=na;Ga.y=ub}var Ma=c._normals[ia],Hb=Ma,va=Ma,Aa=va,Fa=Aa.x*Aa.x+Aa.y*Aa.y,Ka=0==Fa?1:Math.sqrt(Fa),Ya=va.x/Ka,jb=va.y/Ka,Pa=Ya,Oa=jb;Hb.x=Pa;Hb.y=Oa}}l=c._vertices[r].x}}h=l}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var Ua=180/Math.PI*c.local_radians;else c.sync(),Ua=180/Math.PI*c._radians;var Ia=0==Ua}else Ia=!0;if(Ia){c=b.transform;null==c.parent?Ia=c.local_x:(c.sync(),Ia=c._x);var cb=Ia+b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=
c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();n=0;for(m=c.count;n<m;)r=n++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,Q=new O(0,0),C[r]=Q),w=c.local_vertices[r].x,k=c.local_vertices[r].y,null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[r],t.x=u,t.y=v);n=0;for(m=c.count;n<m;)r=n++,t=c._vertices[(r+1)%c.count],p=t.x,
E=t.y,y=c._vertices[r],B=p-y.x,ya=E-y.y,p=B,E=ya,w=-E,E=p,p=w,null==c._normals[r]?(C=c._normals,Q=new O(p,E),C[r]=Q):(q=c._normals[r],q.x=p,q.y=E),D=G=R=wa=c._normals[r],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}Ia=null==c._vertices[0]}else Ia=!0;if(Ia)C=c.transform,null==C.parent?cb=C.local_x:(C.sync(),cb=C._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();n=0;for(m=c.count;n<m;)r=n++,null!=c.local_vertices[r]&&
(null==c._vertices[r]&&(C=c._vertices,Q=new O(0,0),C[r]=Q),w=c.local_vertices[r].x,k=c.local_vertices[r].y,null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[r],t.x=u,t.y=v);n=0;for(m=c.count;n<m;)r=n++,t=c._vertices[(r+1)%c.count],p=t.x,E=t.y,y=c._vertices[r],B=p-y.x,ya=E-y.y,p=B,E=ya,w=-E,E=p,p=w,null==c._normals[r]?(C=c._normals,Q=new O(p,E),C[r]=Q):(q=c._normals[r],q.x=p,q.y=E),D=G=R=wa=
c._normals[r],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}Ia=c._vertices[0].x;n=1;for(m=c.count;n<m;){r=n++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();qa=0;for(da=c.count;qa<da;)H=qa++,null!=c.local_vertices[H]&&(null==c._vertices[H]&&(C=c._vertices,Q=new O(0,0),C[H]=Q),w=c.local_vertices[H].x,k=c.local_vertices[H].y,null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+
q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[H],t.x=u,t.y=v);I=0;for(za=c.count;I<za;)P=I++,wa=c._vertices[(P+1)%c.count],T=wa.x,K=wa.y,y=c._vertices[P],B=T-y.x,ya=K-y.y,T=B,K=ya,N=-K,K=T,T=N,null==c._normals[P]?(pa=c._normals,U=new O(T,K),pa[P]=U):(V=c._normals[P],V.x=T,V.y=K),D=G=R=Ca=c._normals[P],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}if(c._vertices[r].x>Ia){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();
Z=0;for(Y=c.count;Z<Y;)ta=Z++,null!=c.local_vertices[ta]&&(null==c._vertices[ta]&&(X=c._vertices,ca=new O(0,0),X[ta]=ca),ba=c.local_vertices[ta].x,aa=c.local_vertices[ta].y,null==aa&&(aa=0),null==ba&&(ba=0),S=c.transform.get_local_to_world_matrix(),kb=ba,ja=aa,Ja=1,ma=S.m00*kb+S.m10*ja+S.m20*Ja,Sa=S.m01*kb+S.m11*ja+S.m21*Ja,ka=ma,oa=Sa,sa=c._vertices[ta],sa.x=ka,sa.y=oa);ra=0;for(Va=c.count;ra<Va;)ia=ra++,xa=c._vertices[(ia+1)%c.count],na=xa.x,ub=xa.y,Da=c._vertices[ia],ua=na-Da.x,Ea=ub-Da.y,na=ua,
ub=Ea,Wa=-ub,ub=na,na=Wa,null==c._normals[ia]?(Ha=c._normals,La=new O(na,ub),Ha[ia]=La):(Ga=c._normals[ia],Ga.x=na,Ga.y=ub),Aa=va=Hb=Ma=c._normals[ia],Fa=Aa.x*Aa.x+Aa.y*Aa.y,Ka=0==Fa?1:Math.sqrt(Fa),Ya=va.x/Ka,jb=va.y/Ka,Pa=Ya,Oa=jb,Hb.x=Pa,Hb.y=Oa}Ia=c._vertices[r].x}}cb=Ia}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var hb=180/Math.PI*c.local_radians;else c.sync(),hb=180/Math.PI*c._radians;var Sc=0==hb}else Sc=!0;if(Sc){c=b.transform;null==c.parent?Sc=c.local_y:(c.sync(),Sc=c._y);
var $a=Sc-b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();n=0;for(m=c.count;n<m;)r=n++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,Q=new O(0,0),C[r]=Q),w=c.local_vertices[r].x,k=c.local_vertices[r].y,null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[r],
t.x=u,t.y=v);n=0;for(m=c.count;n<m;)r=n++,t=c._vertices[(r+1)%c.count],p=t.x,E=t.y,y=c._vertices[r],B=p-y.x,ya=E-y.y,p=B,E=ya,w=-E,E=p,p=w,null==c._normals[r]?(C=c._normals,Q=new O(p,E),C[r]=Q):(q=c._normals[r],q.x=p,q.y=E),D=G=R=wa=c._normals[r],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}Sc=null==c._vertices[0]}else Sc=!0;if(Sc)C=c.transform,null==C.parent?$a=C.local_y:(C.sync(),$a=C._y);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>
c.count;)c._vertices.pop();n=0;for(m=c.count;n<m;)r=n++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,Q=new O(0,0),C[r]=Q),w=c.local_vertices[r].x,k=c.local_vertices[r].y,null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[r],t.x=u,t.y=v);n=0;for(m=c.count;n<m;)r=n++,t=c._vertices[(r+1)%c.count],p=t.x,E=t.y,y=c._vertices[r],B=p-y.x,ya=E-y.y,p=B,E=ya,w=-E,E=p,p=w,null==c._normals[r]?
(C=c._normals,Q=new O(p,E),C[r]=Q):(q=c._normals[r],q.x=p,q.y=E),D=G=R=wa=c._normals[r],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}Sc=c._vertices[0].y;n=1;for(m=c.count;n<m;){r=n++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();qa=0;for(da=c.count;qa<da;)H=qa++,null!=c.local_vertices[H]&&(null==c._vertices[H]&&(C=c._vertices,Q=new O(0,0),C[H]=Q),w=c.local_vertices[H].x,k=c.local_vertices[H].y,null==k&&(k=0),null==
w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[H],t.x=u,t.y=v);I=0;for(za=c.count;I<za;)P=I++,wa=c._vertices[(P+1)%c.count],T=wa.x,K=wa.y,y=c._vertices[P],B=T-y.x,ya=K-y.y,T=B,K=ya,N=-K,K=T,T=N,null==c._normals[P]?(pa=c._normals,U=new O(T,K),pa[P]=U):(V=c._normals[P],V.x=T,V.y=K),D=G=R=Ca=c._normals[P],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}if(c._vertices[r].y<Sc){if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();Z=0;for(Y=c.count;Z<Y;)ta=Z++,null!=c.local_vertices[ta]&&(null==c._vertices[ta]&&(X=c._vertices,ca=new O(0,0),X[ta]=ca),ba=c.local_vertices[ta].x,aa=c.local_vertices[ta].y,null==aa&&(aa=0),null==ba&&(ba=0),S=c.transform.get_local_to_world_matrix(),kb=ba,ja=aa,Ja=1,ma=S.m00*kb+S.m10*ja+S.m20*Ja,Sa=S.m01*kb+S.m11*ja+S.m21*Ja,ka=ma,oa=Sa,sa=c._vertices[ta],sa.x=ka,sa.y=oa);ra=0;for(Va=c.count;ra<Va;)ia=ra++,xa=c._vertices[(ia+1)%c.count],na=xa.x,ub=xa.y,
Da=c._vertices[ia],ua=na-Da.x,Ea=ub-Da.y,na=ua,ub=Ea,Wa=-ub,ub=na,na=Wa,null==c._normals[ia]?(Ha=c._normals,La=new O(na,ub),Ha[ia]=La):(Ga=c._normals[ia],Ga.x=na,Ga.y=ub),Aa=va=Hb=Ma=c._normals[ia],Fa=Aa.x*Aa.x+Aa.y*Aa.y,Ka=0==Fa?1:Math.sqrt(Fa),Ya=va.x/Ka,jb=va.y/Ka,Pa=Ya,Oa=jb,Hb.x=Pa,Hb.y=Oa}Sc=c._vertices[r].y}}$a=Sc}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var Ta=180/Math.PI*c.local_radians;else c.sync(),Ta=180/Math.PI*c._radians;var Tc=0==Ta}else Tc=!0;if(Tc){c=b.transform;
null==c.parent?Tc=c.local_y:(c.sync(),Tc=c._y);var ab=Tc+b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();n=0;for(m=c.count;n<m;)r=n++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,Q=new O(0,0),C[r]=Q),w=c.local_vertices[r].x,k=c.local_vertices[r].y,null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=
q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[r],t.x=u,t.y=v);n=0;for(m=c.count;n<m;)r=n++,t=c._vertices[(r+1)%c.count],p=t.x,E=t.y,y=c._vertices[r],B=p-y.x,ya=E-y.y,p=B,E=ya,w=-E,E=p,p=w,null==c._normals[r]?(C=c._normals,Q=new O(p,E),C[r]=Q):(q=c._normals[r],q.x=p,q.y=E),D=G=R=wa=c._normals[r],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}Tc=null==c._vertices[0]}else Tc=!0;if(Tc)C=c.transform,null==C.parent?ab=C.local_y:(C.sync(),ab=C._y);else{if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();n=0;for(m=c.count;n<m;)r=n++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,Q=new O(0,0),C[r]=Q),w=c.local_vertices[r].x,k=c.local_vertices[r].y,null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[r],t.x=u,t.y=v);n=0;for(m=c.count;n<m;)r=n++,t=c._vertices[(r+1)%c.count],p=t.x,E=t.y,y=c._vertices[r],B=p-y.x,ya=E-y.y,p=B,E=ya,
w=-E,E=p,p=w,null==c._normals[r]?(C=c._normals,Q=new O(p,E),C[r]=Q):(q=c._normals[r],q.x=p,q.y=E),D=G=R=wa=c._normals[r],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}Tc=c._vertices[0].y;n=1;for(m=c.count;n<m;){r=n++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();qa=0;for(da=c.count;qa<da;)H=qa++,null!=c.local_vertices[H]&&(null==c._vertices[H]&&(C=c._vertices,Q=new O(0,0),C[H]=Q),w=c.local_vertices[H].x,k=c.local_vertices[H].y,
null==k&&(k=0),null==w&&(w=0),q=c.transform.get_local_to_world_matrix(),p=w,E=k,L=1,ea=q.m00*p+q.m10*E+q.m20*L,M=q.m01*p+q.m11*E+q.m21*L,u=ea,v=M,t=c._vertices[H],t.x=u,t.y=v);I=0;for(za=c.count;I<za;)P=I++,wa=c._vertices[(P+1)%c.count],T=wa.x,K=wa.y,y=c._vertices[P],B=T-y.x,ya=K-y.y,T=B,K=ya,N=-K,K=T,T=N,null==c._normals[P]?(pa=c._normals,U=new O(T,K),pa[P]=U):(V=c._normals[P],V.x=T,V.y=K),D=G=R=Ca=c._normals[P],ha=D.x*D.x+D.y*D.y,fa=0==ha?1:Math.sqrt(ha),F=G.x/fa,z=G.y/fa,Na=F,J=z,R.x=Na,R.y=J}if(c._vertices[r].y>
Tc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();Z=0;for(Y=c.count;Z<Y;)ta=Z++,null!=c.local_vertices[ta]&&(null==c._vertices[ta]&&(X=c._vertices,ca=new O(0,0),X[ta]=ca),ba=c.local_vertices[ta].x,aa=c.local_vertices[ta].y,null==aa&&(aa=0),null==ba&&(ba=0),S=c.transform.get_local_to_world_matrix(),kb=ba,ja=aa,Ja=1,ma=S.m00*kb+S.m10*ja+S.m20*Ja,Sa=S.m01*kb+S.m11*ja+S.m21*Ja,ka=ma,oa=Sa,sa=c._vertices[ta],sa.x=ka,sa.y=oa);ra=0;for(Va=c.count;ra<Va;)ia=ra++,
xa=c._vertices[(ia+1)%c.count],na=xa.x,ub=xa.y,Da=c._vertices[ia],ua=na-Da.x,Ea=ub-Da.y,na=ua,ub=Ea,Wa=-ub,ub=na,na=Wa,null==c._normals[ia]?(Ha=c._normals,La=new O(na,ub),Ha[ia]=La):(Ga=c._normals[ia],Ga.x=na,Ga.y=ub),Aa=va=Hb=Ma=c._normals[ia],Fa=Aa.x*Aa.x+Aa.y*Aa.y,Ka=0==Fa?1:Math.sqrt(Fa),Ya=va.x/Ka,jb=va.y/Ka,Pa=Ya,Oa=jb,Hb.x=Pa,Hb.y=Oa}Tc=c._vertices[r].y}}ab=Tc}}w=h;k=$a;var lb=cb,vc=$a;null==vc&&(vc=1);null==lb&&(lb=1);null==k&&(k=0);null==w&&(w=0);var W=Ib.pool.get();N=w;aa=k;var Xa=lb,gb=
vc;null==gb&&(gb=1);null==Xa&&(Xa=1);null==aa&&(aa=0);null==N&&(N=0);t=W.start;t.x=N;t.y=aa;t=W.end;t.x=Xa;t.y=gb;W.pooled=!1;var db=(W.get_dy()-W.get_y())*(a.get_dx()-a.get_x())-(W.get_dx()-W.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(db))var pb=null;else{var mc=((W.get_dx()-W.get_x())*(a.get_y()-W.get_y())-(W.get_dy()-W.get_y())*(a.get_x()-W.get_x()))/db,Wc=((a.get_dx()-a.get_x())*(a.get_y()-W.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-W.get_x()))/db;if(0>mc||1<mc||0>Wc||1<Wc)pb=null;else{q=
a.start;var wc=mc;V=a.end;y=a.start;var Cb=V.x-y.x,bb=V.y-y.y;B=Cb*wc;ya=bb*wc;var Ra=q.x+B,Zb=q.y+ya;q=a.start;var Qa=Ra-q.x,Za=Zb-q.y,rb=Math.sqrt(Qa*Qa+Za*Za);q=a.start;y=a.end;Qa=y.x-q.x;Za=y.y-q.y;var eb=Math.sqrt(Qa*Qa+Za*Za)-rb,mb=0<=db;q=W.start;y=W.end;Qa=y.x-q.x;Za=y.y-q.y;var vb=Math.sqrt(Qa*Qa+Za*Za)*(mb?-1:1);t=Ba.norm;w=(W.get_dy()-W.get_y())/vb;k=-(W.get_dx()-W.get_x())/vb;t.x=w;t.y=k;var ib=Ba.norm.x,fb=Ba.norm.y,Nb=mb;null==Nb&&(Nb=!1);r=Wb.pool.get();r.line=null;r.shape=null;r.line2=
null;var yb=Nb;null==yb&&(yb=!1);r.distance=rb;r.overlap=eb;r.inverse_normal=yb;t=r.hit;t.x=Ra;t.y=Zb;t=r.normal;t.x=ib;t.y=fb;r.pooled=!1;var ec=r;ec.line=a;ec.line2=W;pb=ec}}null!=pb&&(g=pb);w=cb;k=$a;lb=cb;vc=ab;null==vc&&(vc=1);null==lb&&(lb=1);null==k&&(k=0);null==w&&(w=0);t=W.start;t.x=w;t.y=k;t=W.end;t.x=lb;t.y=vc;db=(W.get_dy()-W.get_y())*(a.get_dx()-a.get_x())-(W.get_dx()-W.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(db)?pb=null:(mc=((W.get_dx()-W.get_x())*(a.get_y()-W.get_y())-(W.get_dy()-
W.get_y())*(a.get_x()-W.get_x()))/db,Wc=((a.get_dx()-a.get_x())*(a.get_y()-W.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-W.get_x()))/db,0>mc||1<mc||0>Wc||1<Wc?pb=null:(q=a.start,wc=mc,V=a.end,y=a.start,Cb=V.x-y.x,bb=V.y-y.y,B=Cb*wc,ya=bb*wc,Ra=q.x+B,Zb=q.y+ya,q=a.start,Qa=Ra-q.x,Za=Zb-q.y,rb=Math.sqrt(Qa*Qa+Za*Za),q=a.start,y=a.end,Qa=y.x-q.x,Za=y.y-q.y,eb=Math.sqrt(Qa*Qa+Za*Za)-rb,mb=0<=db,q=W.start,y=W.end,Qa=y.x-q.x,Za=y.y-q.y,vb=Math.sqrt(Qa*Qa+Za*Za)*(mb?-1:1),t=Ba.norm,w=(W.get_dy()-W.get_y())/
vb,k=-(W.get_dx()-W.get_x())/vb,t.x=w,t.y=k,ib=Ba.norm.x,fb=Ba.norm.y,Nb=mb,null==Nb&&(Nb=!1),r=Wb.pool.get(),r.line=null,r.shape=null,r.line2=null,yb=Nb,null==yb&&(yb=!1),r.distance=rb,r.overlap=eb,r.inverse_normal=yb,t=r.hit,t.x=Ra,t.y=Zb,t=r.normal,t.x=ib,t.y=fb,r.pooled=!1,ec=r,ec.line=a,ec.line2=W,pb=ec));null!=pb&&(null==g||g.distance>pb.distance)&&(g=pb);w=cb;k=ab;lb=h;vc=ab;null==vc&&(vc=1);null==lb&&(lb=1);null==k&&(k=0);null==w&&(w=0);t=W.start;t.x=w;t.y=k;t=W.end;t.x=lb;t.y=vc;db=(W.get_dy()-
W.get_y())*(a.get_dx()-a.get_x())-(W.get_dx()-W.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(db)?pb=null:(mc=((W.get_dx()-W.get_x())*(a.get_y()-W.get_y())-(W.get_dy()-W.get_y())*(a.get_x()-W.get_x()))/db,Wc=((a.get_dx()-a.get_x())*(a.get_y()-W.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-W.get_x()))/db,0>mc||1<mc||0>Wc||1<Wc?pb=null:(q=a.start,wc=mc,V=a.end,y=a.start,Cb=V.x-y.x,bb=V.y-y.y,B=Cb*wc,ya=bb*wc,Ra=q.x+B,Zb=q.y+ya,q=a.start,Qa=Ra-q.x,Za=Zb-q.y,rb=Math.sqrt(Qa*Qa+Za*Za),q=a.start,y=a.end,
Qa=y.x-q.x,Za=y.y-q.y,eb=Math.sqrt(Qa*Qa+Za*Za)-rb,mb=0<=db,q=W.start,y=W.end,Qa=y.x-q.x,Za=y.y-q.y,vb=Math.sqrt(Qa*Qa+Za*Za)*(mb?-1:1),t=Ba.norm,w=(W.get_dy()-W.get_y())/vb,k=-(W.get_dx()-W.get_x())/vb,t.x=w,t.y=k,ib=Ba.norm.x,fb=Ba.norm.y,Nb=mb,null==Nb&&(Nb=!1),r=Wb.pool.get(),r.line=null,r.shape=null,r.line2=null,yb=Nb,null==yb&&(yb=!1),r.distance=rb,r.overlap=eb,r.inverse_normal=yb,t=r.hit,t.x=Ra,t.y=Zb,t=r.normal,t.x=ib,t.y=fb,r.pooled=!1,ec=r,ec.line=a,ec.line2=W,pb=ec));null!=pb&&(null==g||
g.distance>pb.distance)&&(g=pb);w=h;k=ab;lb=h;vc=$a;null==vc&&(vc=1);null==lb&&(lb=1);null==k&&(k=0);null==w&&(w=0);t=W.start;t.x=w;t.y=k;t=W.end;t.x=lb;t.y=vc;db=(W.get_dy()-W.get_y())*(a.get_dx()-a.get_x())-(W.get_dx()-W.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(db)?pb=null:(mc=((W.get_dx()-W.get_x())*(a.get_y()-W.get_y())-(W.get_dy()-W.get_y())*(a.get_x()-W.get_x()))/db,Wc=((a.get_dx()-a.get_x())*(a.get_y()-W.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-W.get_x()))/db,0>mc||1<mc||0>Wc||1<Wc?
pb=null:(q=a.start,wc=mc,V=a.end,y=a.start,Cb=V.x-y.x,bb=V.y-y.y,B=Cb*wc,ya=bb*wc,Ra=q.x+B,Zb=q.y+ya,q=a.start,Qa=Ra-q.x,Za=Zb-q.y,rb=Math.sqrt(Qa*Qa+Za*Za),q=a.start,y=a.end,Qa=y.x-q.x,Za=y.y-q.y,eb=Math.sqrt(Qa*Qa+Za*Za)-rb,mb=0<=db,q=W.start,y=W.end,Qa=y.x-q.x,Za=y.y-q.y,vb=Math.sqrt(Qa*Qa+Za*Za)*(mb?-1:1),t=Ba.norm,w=(W.get_dy()-W.get_y())/vb,k=-(W.get_dx()-W.get_x())/vb,t.x=w,t.y=k,ib=Ba.norm.x,fb=Ba.norm.y,Nb=mb,null==Nb&&(Nb=!1),r=Wb.pool.get(),r.line=null,r.shape=null,r.line2=null,yb=Nb,null==
yb&&(yb=!1),r.distance=rb,r.overlap=eb,r.inverse_normal=yb,t=r.hit,t.x=Ra,t.y=Zb,t=r.normal,t.x=ib,t.y=fb,r.pooled=!1,ec=r,ec.line=a,ec.line2=W,pb=ec));null!=pb&&(null==g||g.distance>pb.distance)&&(g=pb);null!=g&&(g.line=a,g.shape=b);return g};Ba.line_intersects_circle=function(a,b){var c=a.end,e=a.start,f=c.x-e.x,g=c.y-e.y;c=a.start;var d=b.transform;d.sync();var l=d._x,h=d._y,n=c.x-l;l=c.y-h;h=b.local_radius;d=b.transform;null==d.parent?c=d.local_scale_x:(d.sync(),c=d._scale_x);h*=c;c=f*f+g*g;e=
2*(n*f+l*g);g=e*e-4*c*(n*n+l*l-h*h);if(0>g)return null;g=Math.sqrt(g);f=(-e-g)/(2*c);g=(-e+g)/(2*c);return 0<=f&&1>=f?(c=a.start,g=f,d=a.end,e=a.start,f=d.x-e.x,n=d.y-e.y,f=c.x+f*g,g=c.y+n*g,c=a.start,d=f-c.x,c=g-c.y,n=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-n,c=Ba.norm,d=b.transform,null==d.parent?l=d.local_x:(d.sync(),l=d._x),d=b.transform,null==d.parent?d=d.local_y:(d.sync(),d=d._y),c.x=f-l,c.y=g-d,c=Ba.norm,l=c.x/h,h=c.y/h,c.x=l,c.y=h,h=Ba.norm.x,d=Ba.norm.y,
l=Wb.pool.get(),l.line=null,l.shape=null,l.line2=null,c=!1,null==c&&(c=!1),l.distance=n,l.overlap=e,l.inverse_normal=c,c=l.hit,c.x=f,c.y=g,c=l.normal,c.x=h,c.y=d,l.pooled=!1,h=l,h.line=a,h.shape=b,h):0<=g&&1>=g?(c=a.start,d=a.end,e=a.start,f=d.x-e.x,n=d.y-e.y,f=c.x+f*g,g=c.y+n*g,c=a.start,d=f-c.x,c=g-c.y,n=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-n,c=Ba.norm,d=b.transform,null==d.parent?l=d.local_x:(d.sync(),l=d._x),d=b.transform,null==d.parent?d=d.local_y:(d.sync(),
d=d._y),c.x=f-l,c.y=g-d,d=c=Ba.norm,l=-d.y,c.x=-d.x/h,c.y=l/h,h=Ba.norm.x,d=Ba.norm.y,c=!0,null==c&&(c=!1),l=Wb.pool.get(),l.line=null,l.shape=null,l.line2=null,null==c&&(c=!1),l.distance=n,l.overlap=e,l.inverse_normal=c,c=l.hit,c.x=f,c.y=g,c=l.normal,c.x=h,c.y=d,l.pooled=!1,h=l,h.line=a,h.shape=b,h):null};Ba.line_intersects_polygon=function(a,b){var c=null,e=Ib.pool.get(),f=0,g=0,d=1,l=1;null==l&&(l=1);null==d&&(d=1);null==g&&(g=0);null==f&&(f=0);var h=e.start;h.x=f;h.y=g;h=e.end;h.x=d;h.y=l;e.pooled=
!1;for(var n=0,m=b.count;n<m;){var r=n++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var C=0,q=b.count;C<q;){var Q=C++;if(null!=b.local_vertices[Q]){if(null==b._vertices[Q]){var w=b._vertices,k=new O(0,0);w[Q]=k}f=b.local_vertices[Q].x;g=b.local_vertices[Q].y;null==g&&(g=0);null==f&&(f=0);var p=b.transform.get_local_to_world_matrix(),E=f,t=g,y=p.m00*E+p.m10*t+1*p.m20,L=p.m01*E+p.m11*t+1*p.m21;h=b._vertices[Q];h.x=y;h.y=L}}for(var ea=0,M=b.count;ea<
M;){var u=ea++,v=b._vertices[(u+1)%b.count],B=v.x,R=v.y,ya=b._vertices[u],D=R-ya.y;B-=ya.x;R=D;var wa=-R;R=B;B=wa;if(null==b._normals[u]){var G=b._normals,ha=new O(B,R);G[u]=ha}else{var fa=b._normals[u];fa.x=B;fa.y=R}var F=b._normals[u],z=F,Na=F,H=Na,J=H.x*H.x+H.y*H.y,qa=0==J?1:Math.sqrt(J),P=Na.y/qa;z.x=Na.x/qa;z.y=P}}var T=b._vertices[r];if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var da=0,K=b.count;da<K;){var I=da++;if(null!=b.local_vertices[I]){if(null==
b._vertices[I]){var za=b._vertices,V=new O(0,0);za[I]=V}var N=b.local_vertices[I].x,ta=b.local_vertices[I].y;null==ta&&(ta=0);null==N&&(N=0);var pa=b.transform.get_local_to_world_matrix(),U=N,S=ta,Z=pa.m01*U+pa.m11*S+1*pa.m21,aa=b._vertices[I];aa.x=pa.m00*U+pa.m10*S+1*pa.m20;aa.y=Z}}for(var ba=0,Y=b.count;ba<Y;){var X=ba++,Ca=b._vertices[(X+1)%b.count],ca=Ca.x,ia=Ca.y,kb=b._vertices[X],na=ia-kb.y;ca-=kb.x;ia=na;var ja=-ia;ia=ca;ca=ja;if(null==b._normals[X]){var Ja=b._normals,sa=new O(ca,ia);Ja[X]=
sa}else{var ma=b._normals[X];ma.x=ca;ma.y=ia}var Sa=b._normals[X],ka=Sa,oa=Sa,ra=oa,xa=ra.x*ra.x+ra.y*ra.y,Da=0==xa?1:Math.sqrt(xa),Va=oa.y/Da;ka.x=oa.x/Da;ka.y=Va}}var Aa=b._vertices[(r+1)%b.count],Ga=T.x,ua=T.y;d=Aa.x;l=Aa.y;null==l&&(l=1);null==d&&(d=1);null==ua&&(ua=0);null==Ga&&(Ga=0);var Ea=e.start;Ea.x=Ga;Ea.y=ua;var Wa=e.end;Wa.x=d;Wa.y=l;var va=(e.get_dy()-e.get_y())*(a.get_dx()-a.get_x())-(e.get_dx()-e.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(va))var Ha=null;else{var Hb=((e.get_dx()-
e.get_x())*(a.get_y()-e.get_y())-(e.get_dy()-e.get_y())*(a.get_x()-e.get_x()))/va,La=((a.get_dx()-a.get_x())*(a.get_y()-e.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-e.get_x()))/va;if(0>Hb||1<Hb||0>La||1<La)Ha=null;else{var Fa=a.start,Ka=Hb,Ia=a.end,Ma=a.start,Ya=Fa.x+(Ia.x-Ma.x)*Ka,jb=Fa.y+(Ia.y-Ma.y)*Ka,Pa=a.start,Oa=Ya-Pa.x,Ra=jb-Pa.y,cb=Math.sqrt(Oa*Oa+Ra*Ra),$a=a.start,ab=a.end,bb=ab.x-$a.x,eb=ab.y-$a.y,ib=Math.sqrt(bb*bb+eb*eb)-cb,fb=0<=va,Ua=e.start,lb=e.end,hb=lb.x-Ua.x,W=lb.y-Ua.y,Ta=Math.sqrt(hb*
hb+W*W)*(fb?-1:1),Xa=Ba.norm,db=(e.get_dy()-e.get_y())/Ta,pb=-(e.get_dx()-e.get_x())/Ta;Xa.x=db;Xa.y=pb;var mc=Ba.norm.x,gb=Ba.norm.y,wc=fb;null==wc&&(wc=!1);var Cb=Wb.pool.get();Cb.line=null;Cb.shape=null;Cb.line2=null;var ob=wc;null==ob&&(ob=!1);Cb.distance=cb;Cb.overlap=ib;Cb.inverse_normal=ob;var nb=Cb.hit;nb.x=Ya;nb.y=jb;var Zb=Cb.normal;Zb.x=mc;Zb.y=gb;Cb.pooled=!1;var Qa=Cb;Qa.line=a;Qa.line2=e;Ha=Qa}}null!=Ha&&(null==c||c.distance>Ha.distance)&&(c=Ha)}null!=c&&(c.line=a,c.shape=b);return c};
Ba.rect_and_rect=function(a,b,c){null==c&&(c=!1);var e=null,f=a.transform;if(null==f.parent)var g=180/Math.PI*f.local_radians;else f.sync(),g=180/Math.PI*f._radians;0==g?(f=b.transform,null==f.parent?g=180/Math.PI*f.local_radians:(f.sync(),g=180/Math.PI*f._radians),g=0!=g):g=!0;if(g){if(null!=a.transformed_rect){e=Ba.rect_and_polygon(b,a.transformed_rect,c);if(null==e)return null;c?e.sa=a:e.sb=a;return e}if(null!=b.transformed_rect){e=Ba.rect_and_polygon(a,b.transformed_rect,!c);if(null==e)return null;
c?e.sa=b:e.sb=b;return e}}g=c?b:a;a=c?a:b;f=a.transform;null==f.parent?b=f.local_x:(f.sync(),b=f._x);f=g.transform;null==f.parent?f=f.local_x:(f.sync(),f=f._x);b-=f;f=a.transform;null==f.parent?c=f.local_y:(f.sync(),c=f._y);f=g.transform;null==f.parent?f=f.local_y:(f.sync(),f=f._y);f=c-f;c=g.local_ex*g.transform.local_scale_x+a.local_ex*a.transform.local_scale_x-Math.abs(b);if(0<c){var d=g.local_ey*g.transform.local_scale_y+a.local_ey*a.transform.local_scale_y-Math.abs(f);if(0<d){if(c<d){e=uc.pool.get();
e.sa=null;e.sb=null;for(var l=e.contact_count=0,h=e.contacts;l<h.length;){var n=h[l];++l;n.x=0;n.y=0}e.overlap=c;c=e.normal;c.x=0>b?-1:1;c.y=0}else{e=uc.pool.get();e.sa=null;e.sb=null;l=e.contact_count=0;for(h=e.contacts;l<h.length;)n=h[l],++l,n.x=0,n.y=0;e.overlap=d;c=e.normal;c.x=0;c.y=0>f?-1:1}e.pooled=!1;e.sa=g;e.sb=a}}return e};Ba.circle_and_circle=function(a,b,c){null==c&&(c=!1);var e=c?b:a;a=c?a:b;var f=a.transform;null==f.parent?b=f.local_x:(f.sync(),b=f._x);f=e.transform;null==f.parent?c=
f.local_x:(f.sync(),c=f._x);b-=c;f=a.transform;null==f.parent?c=f.local_y:(f.sync(),c=f._y);f=e.transform;null==f.parent?f=f.local_y:(f.sync(),f=f._y);c-=f;var g=e.local_radius;f=e.transform;if(null==f.parent)var d=f.local_scale_x;else f.sync(),d=f._scale_x;var l=a.local_radius;f=a.transform;null==f.parent?f=f.local_scale_x:(f.sync(),f=f._scale_x);g=g*d+l*f;d=b*b+c*c;f=null;if(d>=g*g)return f;if(1E-5>=Math.abs(d)){g=e.local_radius;f=e.transform;null==f.parent?b=f.local_scale_x:(f.sync(),b=f._scale_x);
b*=g;f=uc.pool.get();f.sa=null;f.sb=null;l=f.contact_count=0;for(var h=f.contacts;l<h.length;){var n=h[l];++l;n.x=0;n.y=0}f.overlap=b;g=f.normal;g.x=1;g.y=0}else{d=Math.sqrt(d);b/=d;c/=d;f=uc.pool.get();f.sa=null;f.sb=null;l=f.contact_count=0;for(h=f.contacts;l<h.length;)n=h[l],++l,n.x=0,n.y=0;f.overlap=g-d;g=f.normal;g.x=b;g.y=c}f.pooled=!1;f.sa=e;f.sb=a;return f};Ba.polygon_and_polygon=function(a,b,c){null==c&&(c=!1);var e=Ba.check_polygons(a,b,c);if(null==e)return null;a=Ba.check_polygons(b,a,
!c);if(null==a)return null;0>e.overlap&&(e.overlap=Math.abs(e.overlap));0>a.overlap&&(a.overlap=Math.abs(a.overlap));if(e.overlap<a.overlap)return a.put(),e;e.put();return a};Ba.rect_and_circle=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect){var e=a.transform;if(null==e.parent)var f=180/Math.PI*e.local_radians;else e.sync(),f=180/Math.PI*e._radians;f=0!=f}else f=!1;if(f){f=Ba.circle_and_polygon(b,a.transformed_rect,c);if(null==f)return null;c?f.sa=a:f.sb=a;return f}c?(e=b.transform,null==
e.parent?f=e.local_x:(e.sync(),f=e._x),e=a.transform):(e=a.transform,null==e.parent?f=e.local_x:(e.sync(),f=e._x),e=b.transform);if(null==e.parent)var g=e.local_x;else e.sync(),g=e._x;f-=g;c?(e=b.transform,null==e.parent?g=e.local_y:(e.sync(),g=e._y),e=a.transform):(e=a.transform,null==e.parent?g=e.local_y:(e.sync(),g=e._y),e=b.transform);if(null==e.parent)var d=e.local_y;else e.sync(),d=e._y;g-=d;var l=f,h=g;d=-(a.local_ex*a.transform.local_scale_x);var n=a.local_ex*a.transform.local_scale_x;l<d?
l=d:l>n&&(l=n);d=-(a.local_ey*a.transform.local_scale_y);n=a.local_ey*a.transform.local_scale_y;h<d?h=d:h>n&&(h=n);n=!1;d=b.local_radius;e=b.transform;null==e.parent?e=e.local_scale_x:(e.sync(),e=e._scale_x);d*=e;1E-5>=Math.abs(f-l)&&1E-5>=Math.abs(g-h)&&(n=!0,Math.abs(f)>Math.abs(g)?l=0<l?a.local_ex*a.transform.local_scale_x+d+.1:-(a.local_ex*a.transform.local_scale_x)-d-.1:h=0<h?a.local_ey*a.transform.local_scale_y+d+.1:-(a.local_ey*a.transform.local_scale_y)-d-.1);f-=l;g-=h;l=f*f+g*g;if(l>d*d&&
!n)return null;l=Math.sqrt(l);f/=l;g/=l;n&&(f*=-1,g*=-1);l=Math.abs(d-l);d=uc.pool.get();d.sa=null;d.sb=null;h=d.contact_count=0;for(n=d.contacts;h<n.length;)e=n[h],++h,e.x=0,e.y=0;d.overlap=l;l=d.normal;l.x=f;l.y=g;d.pooled=!1;f=d;f.sa=c?b:a;f.sb=c?a:b;return f};Ba.rect_and_polygon=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect)b=Ba.polygon_and_polygon(a.transformed_rect,b,c);else{var e=Xa.pool.get();e.count=4;for(var f=0,g=e.count;f<g;){var d=f++;if(null==e.local_vertices[d]){var l=
e.local_vertices,h=new O(0,0);l[d]=h}}f=e.local_vertices[0];f.x=-(a.local_ex*a.transform.local_scale_x);f.y=-(a.local_ey*a.transform.local_scale_y);f=e.local_vertices[1];f.x=a.local_ex*a.transform.local_scale_x;f.y=-(a.local_ey*a.transform.local_scale_y);f=e.local_vertices[2];f.x=a.local_ex*a.transform.local_scale_x;f.y=a.local_ey*a.transform.local_scale_y;f=e.local_vertices[3];f.x=-(a.local_ex*a.transform.local_scale_x);f.y=a.local_ey*a.transform.local_scale_y;f=a.transform.local_x;g=e.transform;
g.dirty||g.set_dirty();g.local_x=f;f=a.transform.local_y;g=e.transform;g.dirty||g.set_dirty();g.local_y=f;g=e.transform;f=Math.PI/180*(180/Math.PI)*a.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=f;f=a.transform.local_scale_x;g=e.transform;g.dirty||g.set_dirty();g.local_scale_x=f;f=a.transform.local_scale_y;g=e.transform;g.dirty||g.set_dirty();g.local_scale_y=f;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;e.set_parent(a.parent);b=Ba.polygon_and_polygon(e,b,c);e.put()}if(null==
b)return null;c?b.sb=a:b.sa=a;return b};Ba.circle_and_polygon=function(a,b,c){null==c&&(c=!1);var e=0,f=1073741823,g=a.transform;g.sync();var d=g._x,l=g._y,h=a.local_radius;g=a.transform;if(null==g.parent)var n=g.local_scale_x;else g.sync(),n=g._scale_x;for(var m=h*n,r=0,C=b.count;r<C;){var q=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var Q=0,w=b.count;Q<w;){var k=Q++;if(null!=b.local_vertices[k]){if(null==b._vertices[k]){var p=b._vertices,E=
new O(0,0);p[k]=E}var t=b.local_vertices[k].x,y=b.local_vertices[k].y;null==y&&(y=0);null==t&&(t=0);var L=b.transform.get_local_to_world_matrix(),ea=t,M=y,u=1,B=L.m00*ea+L.m10*M+L.m20*u,v=L.m01*ea+L.m11*M+L.m21*u,R=B,ya=v,D=b._vertices[k];D.x=R;D.y=ya}}for(var wa=0,G=b.count;wa<G;){var ha=wa++,fa=b._vertices[(ha+1)%b.count],F=fa.x,z=fa.y,Na=b._vertices[ha],H=F-Na.x,J=z-Na.y;F=H;z=J;var qa=-z;z=F;F=qa;if(null==b._normals[ha]){var T=b._normals,P=new O(F,z);T[ha]=P}else{var da=b._normals[ha];da.x=F;
da.y=z}var K=b._normals[ha],I=K,za=K,N=za,V=N.x*N.x+N.y*N.y,ta=0==V?1:Math.sqrt(V),pa=za.x/ta,U=za.y/ta,S=pa,aa=U;I.x=S;I.y=aa}}var Z=b._vertices[q],ba=d-Z.x,X=l-Z.y;e=ba*ba+X*X;if(e<f){f=e;var ca=Ba.closest;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var ia=0,Ca=b.count;ia<Ca;){var Y=ia++;if(null!=b.local_vertices[Y]){if(null==b._vertices[Y]){var kb=b._vertices,na=new O(0,0);kb[Y]=na}var ja=b.local_vertices[Y].x,Ja=b.local_vertices[Y].y;null==Ja&&
(Ja=0);null==ja&&(ja=0);var ma=b.transform.get_local_to_world_matrix(),Sa=ja,ka=Ja,sa=1,oa=ma.m00*Sa+ma.m10*ka+ma.m20*sa,ra=ma.m01*Sa+ma.m11*ka+ma.m21*sa,xa=oa,Da=ra,Aa=b._vertices[Y];Aa.x=xa;Aa.y=Da}}for(var Va=0,Ga=b.count;Va<Ga;){var ua=Va++,Ha=b._vertices[(ua+1)%b.count],va=Ha.x,Ea=Ha.y,Wa=b._vertices[ua],Hb=va-Wa.x,La=Ea-Wa.y;va=Hb;Ea=La;var Fa=-Ea;Ea=va;va=Fa;if(null==b._normals[ua]){var Ka=b._normals,Ia=new O(va,Ea);Ka[ua]=Ia}else{var Ma=b._normals[ua];Ma.x=va;Ma.y=Ea}var Ya=b._normals[ua],
jb=Ya,Pa=Ya,Oa=Pa,Ra=Oa.x*Oa.x+Oa.y*Oa.y,cb=0==Ra?1:Math.sqrt(Ra),$a=Pa.x/cb,ab=Pa.y/cb,bb=$a,eb=ab;jb.x=bb;jb.y=eb}}var fb=b._vertices[q].x;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var Ua=0,ib=b.count;Ua<ib;){var lb=Ua++;if(null!=b.local_vertices[lb]){if(null==b._vertices[lb]){var hb=b._vertices,W=new O(0,0);hb[lb]=W}var Ta=b.local_vertices[lb].x,Xa=b.local_vertices[lb].y;null==Xa&&(Xa=0);null==Ta&&(Ta=0);var db=b.transform.get_local_to_world_matrix(),
pb=Ta,gb=Xa,ob=1,nb=db.m00*pb+db.m10*gb+db.m20*ob,Cb=db.m01*pb+db.m11*gb+db.m21*ob,Eb=nb,Kb=Cb,Zb=b._vertices[lb];Zb.x=Eb;Zb.y=Kb}}for(var Qa=0,Za=b.count;Qa<Za;){var rb=Qa++,Lb=b._vertices[(rb+1)%b.count],mb=Lb.x,vb=Lb.y,Ab=b._vertices[rb],Mb=mb-Ab.x,Nb=vb-Ab.y;mb=Mb;vb=Nb;var yb=-vb;vb=mb;mb=yb;if(null==b._normals[rb]){var ec=b._normals,Jb=new O(mb,vb);ec[rb]=Jb}else{var Db=b._normals[rb];Db.x=mb;Db.y=vb}var Gb=b._normals[rb],qb=Gb,ic=Gb,kd=ic,Ib=kd.x*kd.x+kd.y*kd.y,tb=0==Ib?1:Math.sqrt(Ib),Wb=
ic.x/tb,Rb=ic.y/tb,Sb=Wb,Tb=Rb;qb.x=Sb;qb.y=Tb}}var Qb=b._vertices[q].y;ca.x=fb;ca.y=Qb}}L=Ba.closest;ba=L.x-d;X=L.y-l;V=ba*ba+X*X;ta=0==V?1:Math.sqrt(V);var zb=ba/ta,wb=X/ta,sb=0;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();r=0;for(C=b.count;r<C;)q=r++,null!=b.local_vertices[q]&&(null==b._vertices[q]&&(p=b._vertices,E=new O(0,0),p[q]=E),t=b.local_vertices[q].x,y=b.local_vertices[q].y,null==y&&(y=0),null==t&&(t=0),L=b.transform.get_local_to_world_matrix(),
ea=t,M=y,u=1,B=L.m00*ea+L.m10*M+L.m20*u,v=L.m01*ea+L.m11*M+L.m21*u,R=B,ya=v,D=b._vertices[q],D.x=R,D.y=ya);r=0;for(C=b.count;r<C;)q=r++,D=b._vertices[(q+1)%b.count],ea=D.x,M=D.y,Na=b._vertices[q],H=ea-Na.x,J=M-Na.y,ea=H,M=J,t=-M,M=ea,ea=t,null==b._normals[q]?(p=b._normals,E=new O(ea,M),p[q]=E):(L=b._normals[q],L.x=ea,L.y=M),N=za=I=fa=b._normals[q],V=N.x*N.x+N.y*N.y,ta=0==V?1:Math.sqrt(V),pa=za.x/ta,U=za.y/ta,S=pa,aa=U,I.x=S,I.y=aa}Na=b._vertices[0];var Uc=zb*Na.x+wb*Na.y,xb=Uc;r=1;for(C=b.count;r<
C;){var Ub=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();Q=0;for(w=b.count;Q<w;)q=Q++,null!=b.local_vertices[q]&&(null==b._vertices[q]&&(p=b._vertices,E=new O(0,0),p[q]=E),t=b.local_vertices[q].x,y=b.local_vertices[q].y,null==y&&(y=0),null==t&&(t=0),L=b.transform.get_local_to_world_matrix(),ea=t,M=y,u=1,B=L.m00*ea+L.m10*M+L.m20*u,v=L.m01*ea+L.m11*M+L.m21*u,R=B,ya=v,D=b._vertices[q],D.x=R,D.y=ya);wa=0;for(G=b.count;wa<G;)k=wa++,fa=b._vertices[(k+1)%
b.count],F=fa.x,z=fa.y,Na=b._vertices[k],H=F-Na.x,J=z-Na.y,F=H,z=J,qa=-z,z=F,F=qa,null==b._normals[k]?(T=b._normals,P=new O(F,z),T[k]=P):(da=b._normals[k],da.x=F,da.y=z),N=za=I=K=b._normals[k],V=N.x*N.x+N.y*N.y,ta=0==V?1:Math.sqrt(V),pa=za.x/ta,U=za.y/ta,S=pa,aa=U,I.x=S,I.y=aa}Z=b._vertices[Ub];sb=zb*Z.x+wb*Z.y;sb<Uc&&(Uc=sb);sb>xb&&(xb=sb)}var Vb=m,$b=-m;H=-d;J=-l;var Xb=zb*H+wb*J;Uc+=Xb;xb+=Xb;var ac=Uc-Vb,bc=$b-xb;if(0<ac||0<bc)return null;var Fb=-(Vb-Uc);c&&(Fb*=-1);t=zb;y=wb;h=uc.pool.get();
h.sa=null;h.sb=null;r=h.contact_count=0;for(C=h.contacts;r<C.length;){var Pb=C[r];++r;Pb.x=0;Pb.y=0}h.overlap=Fb;D=h.normal;D.x=t;D.y=y;h.pooled=!1;var Bb=h,nc=Math.abs(Fb);r=0;for(C=b.count;r<C;){q=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();Q=0;for(w=b.count;Q<w;)k=Q++,null!=b.local_vertices[k]&&(null==b._vertices[k]&&(p=b._vertices,E=new O(0,0),p[k]=E),t=b.local_vertices[k].x,y=b.local_vertices[k].y,null==y&&(y=0),null==t&&(t=0),L=b.transform.get_local_to_world_matrix(),
ea=t,M=y,u=1,B=L.m00*ea+L.m10*M+L.m20*u,v=L.m01*ea+L.m11*M+L.m21*u,R=B,ya=v,D=b._vertices[k],D.x=R,D.y=ya);wa=0;for(G=b.count;wa<G;)ha=wa++,fa=b._vertices[(ha+1)%b.count],F=fa.x,z=fa.y,Na=b._vertices[ha],H=F-Na.x,J=z-Na.y,F=H,z=J,qa=-z,z=F,F=qa,null==b._normals[ha]?(T=b._normals,P=new O(F,z),T[ha]=P):(da=b._normals[ha],da.x=F,da.y=z),N=za=I=K=b._normals[ha],V=N.x*N.x+N.y*N.y,ta=0==V?1:Math.sqrt(V),pa=za.x/ta,U=za.y/ta,S=pa,aa=U,I.x=S,I.y=aa}ja=b._normals[q].x;if(b.dirty_vertices){for(b.dirty_vertices=
!1;b._vertices.length>b.count;)b._vertices.pop();ia=0;for(Ca=b.count;ia<Ca;)Y=ia++,null!=b.local_vertices[Y]&&(null==b._vertices[Y]&&(kb=b._vertices,na=new O(0,0),kb[Y]=na),Fa=b.local_vertices[Y].x,Ja=b.local_vertices[Y].y,null==Ja&&(Ja=0),null==Fa&&(Fa=0),ma=b.transform.get_local_to_world_matrix(),Sa=Fa,ka=Ja,sa=1,oa=ma.m00*Sa+ma.m10*ka+ma.m20*sa,ra=ma.m01*Sa+ma.m11*ka+ma.m21*sa,xa=oa,Da=ra,ca=b._vertices[Y],ca.x=xa,ca.y=Da);Va=0;for(Ga=b.count;Va<Ga;)ua=Va++,Aa=b._vertices[(ua+1)%b.count],va=Aa.x,
Ea=Aa.y,Z=b._vertices[ua],Hb=va-Z.x,La=Ea-Z.y,va=Hb,Ea=La,fb=-Ea,Ea=va,va=fb,null==b._normals[ua]?(Ka=b._normals,Ia=new O(va,Ea),Ka[ua]=Ia):(Ma=b._normals[ua],Ma.x=va,Ma.y=Ea),Oa=Pa=jb=Ha=b._normals[ua],Ra=Oa.x*Oa.x+Oa.y*Oa.y,cb=0==Ra?1:Math.sqrt(Ra),$a=Pa.x/cb,ab=Pa.y/cb,bb=$a,eb=ab,jb.x=bb,jb.y=eb}zb=ja;wb=b._normals[q].y;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();Ua=0;for(ib=b.count;Ua<ib;)lb=Ua++,null!=b.local_vertices[lb]&&(null==b._vertices[lb]&&
(hb=b._vertices,W=new O(0,0),hb[lb]=W),Ta=b.local_vertices[lb].x,Xa=b.local_vertices[lb].y,null==Xa&&(Xa=0),null==Ta&&(Ta=0),db=b.transform.get_local_to_world_matrix(),pb=Ta,gb=Xa,ob=1,nb=db.m00*pb+db.m10*gb+db.m20*ob,Cb=db.m01*pb+db.m11*gb+db.m21*ob,Eb=nb,Kb=Cb,Ya=b._vertices[lb],Ya.x=Eb,Ya.y=Kb);Qa=0;for(Za=b.count;Qa<Za;)rb=Qa++,Zb=b._vertices[(rb+1)%b.count],mb=Zb.x,vb=Zb.y,Wa=b._vertices[rb],Mb=mb-Wa.x,Nb=vb-Wa.y,mb=Mb,vb=Nb,yb=-vb,vb=mb,mb=yb,null==b._normals[rb]?(ec=b._normals,Jb=new O(mb,
vb),ec[rb]=Jb):(Db=b._normals[rb],Db.x=mb,Db.y=vb),kd=ic=qb=Lb=b._normals[rb],Ib=kd.x*kd.x+kd.y*kd.y,tb=0==Ib?1:Math.sqrt(Ib),Wb=ic.x/tb,Rb=ic.y/tb,Sb=Wb,Tb=Rb,qb.x=Sb,qb.y=Tb}Ab=b._vertices[0];xb=Uc=zb*Ab.x+wb*Ab.y;for(var gc=1,pc=b.count;gc<pc;){Ub=gc++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var lc=0,xc=b.count;lc<xc;){var Ob=lc++;if(null!=b.local_vertices[Ob]){if(null==b._vertices[Ob]){var dc=b._vertices,Pc=new O(0,0);dc[Ob]=Pc}var Yb=b.local_vertices[Ob].x;
Qb=b.local_vertices[Ob].y;null==Qb&&(Qb=0);null==Yb&&(Yb=0);var hc=b.transform.get_local_to_world_matrix(),rc=Yb,sc=Qb,yc=hc.m00*rc+hc.m10*sc+1*hc.m20,Fc=hc.m01*rc+hc.m11*sc+1*hc.m21;Gb=b._vertices[Ob];Gb.x=yc;Gb.y=Fc}}for(var Ac=0,Hc=b.count;Ac<Hc;){var cc=Ac++,jc=b._vertices[(cc+1)%b.count],oc=jc.x,kc=jc.y,Gc=b._vertices[cc],tc=kc-Gc.y;oc-=Gc.x;kc=tc;var Ic=-kc;kc=oc;oc=Ic;if(null==b._normals[cc]){var Qc=b._normals,Mc=new O(oc,kc);Qc[cc]=Mc}else{var Nc=b._normals[cc];Nc.x=oc;Nc.y=kc}var Bc=b._normals[cc],
Cc=Bc,fc=Bc,qc=fc,Ec=qc.x*qc.x+qc.y*qc.y,zc=0==Ec?1:Math.sqrt(Ec),Oc=fc.y/zc;Cc.x=fc.x/zc;Cc.y=Oc}}var ld=b._vertices[Ub];sb=zb*ld.x+wb*ld.y;sb<Uc&&(Uc=sb);sb>xb&&(xb=sb)}Vb=m;$b=-m;Xb=zb*-d+wb*-l;Uc+=Xb;xb+=Xb;ac=Uc-Vb;bc=$b-xb;if(0<ac||0<bc)return Bb.put(),null;Fb=-(Vb-Uc);c&&(Fb*=-1);if(Math.abs(Fb)<nc){var Jc=Bb.normal;Jc.x=zb;Jc.y=wb;Bb.overlap=Fb;nc=Math.abs(Fb)}}Bb.sa=c?b:a;Bb.sb=c?a:b;Bb.overlap=Math.abs(Bb.overlap);c&&(D=Bb.normal,D.x=-D.x,D.y=-D.y);return Bb};Ba.check_polygons=function(a,
b,c){null==c&&(c=!1);for(var e=0,f=0,g=0,d=0,l=0,h=0,n=0,m=1073741823,r=null,C=0,q=0,Q=0,w=a.count;Q<w;){var k=Q++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var p=0,t=a.count;p<t;){var E=p++;if(null!=a.local_vertices[E]){if(null==a._vertices[E]){var L=a._vertices,y=new O(0,0);L[E]=y}var ea=a.local_vertices[E].x,M=a.local_vertices[E].y;null==M&&(M=0);null==ea&&(ea=0);var u=a.transform.get_local_to_world_matrix(),B=ea,v=M,D=u.m01*B+u.m11*v+1*u.m21,
R=a._vertices[E];R.x=u.m00*B+u.m10*v+1*u.m20;R.y=D}}for(var ya=0,wa=a.count;ya<wa;){var G=ya++,ha=a._vertices[(G+1)%a.count],fa=ha.x,F=ha.y,z=a._vertices[G],Na=F-z.y;fa-=z.x;F=Na;var H=-F;F=fa;fa=H;if(null==a._normals[G]){var J=a._normals,qa=new O(fa,F);J[G]=qa}else{var da=a._normals[G];da.x=fa;da.y=F}var T=a._normals[G],P=T,I=T,K=I,za=K.x*K.x+K.y*K.y,N=0==za?1:Math.sqrt(za),V=I.y/N;P.x=I.x/N;P.y=V}}var ta=a._normals[k].x;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();
for(var pa=0,U=a.count;pa<U;){var S=pa++;if(null!=a.local_vertices[S]){if(null==a._vertices[S]){var Z=a._vertices,aa=new O(0,0);Z[S]=aa}var Y=a.local_vertices[S].x,ba=a.local_vertices[S].y;null==ba&&(ba=0);null==Y&&(Y=0);var X=a.transform.get_local_to_world_matrix(),ca=Y,ia=ba,Ca=X.m01*ca+X.m11*ia+1*X.m21,ma=a._vertices[S];ma.x=X.m00*ca+X.m10*ia+1*X.m20;ma.y=Ca}}for(var Ja=0,ja=a.count;Ja<ja;){var kb=Ja++,na=a._vertices[(kb+1)%a.count],Sa=na.x,ka=na.y,sa=a._vertices[kb],oa=ka-sa.y;Sa-=sa.x;ka=oa;
var ra=-ka;ka=Sa;Sa=ra;if(null==a._normals[kb]){var ua=a._normals,va=new O(Sa,ka);ua[kb]=va}else{var Ea=a._normals[kb];Ea.x=Sa;Ea.y=ka}var Aa=a._normals[kb],Ba=Aa,Va=Aa,xa=Va,Da=xa.x*xa.x+xa.y*xa.y,Ga=0==Da?1:Math.sqrt(Da),Ha=Va.y/Ga;Ba.x=Va.x/Ga;Ba.y=Ha}}C=ta;q=a._normals[k].y;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var Wa=0,Hb=a.count;Wa<Hb;){var Fa=Wa++;if(null!=a.local_vertices[Fa]){if(null==a._vertices[Fa]){var La=a._vertices,Oa=new O(0,
0);La[Fa]=Oa}var Ka=a.local_vertices[Fa].x,Ma=a.local_vertices[Fa].y;null==Ma&&(Ma=0);null==Ka&&(Ka=0);var Ia=a.transform.get_local_to_world_matrix(),Pa=Ka,Ya=Ma,jb=Ia.m01*Pa+Ia.m11*Ya+1*Ia.m21,Ra=a._vertices[Fa];Ra.x=Ia.m00*Pa+Ia.m10*Ya+1*Ia.m20;Ra.y=jb}}for(var cb=0,$a=a.count;cb<$a;){var Ta=cb++,ab=a._vertices[(Ta+1)%a.count],Xa=ab.x,Ua=ab.y,bb=a._vertices[Ta],eb=Ua-bb.y;Xa-=bb.x;Ua=eb;var fb=-Ua;Ua=Xa;Xa=fb;if(null==a._normals[Ta]){var W=a._normals,ib=new O(Xa,Ua);W[Ta]=ib}else{var gb=a._normals[Ta];
gb.x=Xa;gb.y=Ua}var db=a._normals[Ta],hb=db,ob=db,nb=ob,sb=nb.x*nb.x+nb.y*nb.y,Cb=0==sb?1:Math.sqrt(sb),zb=ob.y/Cb;hb.x=ob.x/Cb;hb.y=zb}}var wb=a._vertices[0];l=d=C*wb.x+q*wb.y;for(var xb=1,Qa=a.count;xb<Qa;){var Za=xb++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var rb=0,Ab=a.count;rb<Ab;){var mb=rb++;if(null!=a.local_vertices[mb]){if(null==a._vertices[mb]){var vb=a._vertices,Db=new O(0,0);vb[mb]=Db}var ic=a.local_vertices[mb].x,Nb=a.local_vertices[mb].y;
null==Nb&&(Nb=0);null==ic&&(ic=0);var yb=a.transform.get_local_to_world_matrix(),Bb=ic,Eb=Nb,Kb=yb.m01*Bb+yb.m11*Eb+1*yb.m21,Fb=a._vertices[mb];Fb.x=yb.m00*Bb+yb.m10*Eb+1*yb.m20;Fb.y=Kb}}for(var Gb=0,Lb=a.count;Gb<Lb;){var qb=Gb++,Ib=a._vertices[(qb+1)%a.count],tb=Ib.x,Mb=Ib.y,Jb=a._vertices[qb],Qb=Mb-Jb.y;tb-=Jb.x;Mb=Qb;var Vb=-Mb;Mb=tb;tb=Vb;if(null==a._normals[qb]){var Wb=a._normals,Xb=new O(tb,Mb);Wb[qb]=Xb}else{var Rb=a._normals[qb];Rb.x=tb;Rb.y=Mb}var Sb=a._normals[qb],Tb=Sb,Ub=Sb,Ob=Ub,$b=
Ob.x*Ob.x+Ob.y*Ob.y,ac=0==$b?1:Math.sqrt($b),hc=Ub.y/ac;Tb.x=Ub.x/ac;Tb.y=hc}}var bc=a._vertices[Za];g=C*bc.x+q*bc.y;g<d&&(d=g);g>l&&(l=g)}if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var cc=0,kc=b.count;cc<kc;){var Pb=cc++;if(null!=b.local_vertices[Pb]){if(null==b._vertices[Pb]){var nc=b._vertices,oc=new O(0,0);nc[Pb]=oc}var gc=b.local_vertices[Pb].x,lc=b.local_vertices[Pb].y;null==lc&&(lc=0);null==gc&&(gc=0);var Yb=b.transform.get_local_to_world_matrix(),
pc=gc,qc=lc,xc=Yb.m01*pc+Yb.m11*qc+1*Yb.m21,rc=b._vertices[Pb];rc.x=Yb.m00*pc+Yb.m10*qc+1*Yb.m20;rc.y=xc}}for(var sc=0,Ac=b.count;sc<Ac;){var dc=sc++,Pc=b._vertices[(dc+1)%b.count],jc=Pc.x,fc=Pc.y,yc=b._vertices[dc],Fc=fc-yc.y;jc-=yc.x;fc=Fc;var Gc=-fc;fc=jc;jc=Gc;if(null==b._normals[dc]){var Hc=b._normals,Nc=new O(jc,fc);Hc[dc]=Nc}else{var Bc=b._normals[dc];Bc.x=jc;Bc.y=fc}var Cc=b._normals[dc],Ec=Cc,zc=Cc,tc=zc,Ic=tc.x*tc.x+tc.y*tc.y,Jc=0==Ic?1:Math.sqrt(Ic),Qc=zc.y/Jc;Ec.x=zc.x/Jc;Ec.y=Qc}}var Mc=
b._vertices[0];n=h=C*Mc.x+q*Mc.y;for(var Oc=1,fd=b.count;Oc<fd;){var gd=Oc++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var $c=0,pd=b.count;$c<pd;){var ld=$c++;if(null!=b.local_vertices[ld]){if(null==b._vertices[ld]){var rd=b._vertices,sd=new O(0,0);rd[ld]=sd}var Yc=b.local_vertices[ld].x,Zc=b.local_vertices[ld].y;null==Zc&&(Zc=0);null==Yc&&(Yc=0);var Dc=b.transform.get_local_to_world_matrix(),cd=Yc,dd=Zc,zd=Dc.m01*cd+Dc.m11*dd+1*Dc.m21,ed=b._vertices[ld];
ed.x=Dc.m00*cd+Dc.m10*dd+1*Dc.m20;ed.y=zd}}for(var hd=0,Ad=b.count;hd<Ad;){var Kc=hd++,id=b._vertices[(Kc+1)%b.count],Rc=id.x,Lc=id.y,jd=b._vertices[Kc],Bd=Lc-jd.y;Rc-=jd.x;Lc=Bd;var Cd=-Lc;Lc=Rc;Rc=Cd;if(null==b._normals[Kc]){var Dd=b._normals,Ed=new O(Rc,Lc);Dd[Kc]=Ed}else{var md=b._normals[Kc];md.x=Rc;md.y=Lc}var nd=b._normals[Kc],od=nd,ad=nd,Xc=ad,qd=Xc.x*Xc.x+Xc.y*Xc.y,td=0==qd?1:Math.sqrt(qd),Gd=ad.y/td;od.x=ad.x/td;od.y=Gd}}var ud=b._vertices[gd];g=C*ud.x+q*ud.y;g<h&&(h=g);g>n&&(n=g)}e=d-n;
f=h-l;if(0<e||0<f)return null;var Vc=-(n-d);c&&(Vc*=-1);if(Math.abs(Vc)<m){if(null==r){var Hd=C,Id=q,Fd=uc.pool.get();Fd.sa=null;Fd.sb=null;for(var bd=Fd.contact_count=0,vd=Fd.contacts;bd<vd.length;){var wd=vd[bd];++bd;wd.x=0;wd.y=0}Fd.overlap=Vc;var xd=Fd.normal;xd.x=Hd;xd.y=Id;Fd.pooled=!1;r=Fd}else{r.overlap=Vc;var yd=r.normal;yd.x=C;yd.y=q}m=Math.abs(Vc)}}if(null==r)return null;r.sa=c?b:a;r.sb=c?a:b;c&&(R=r.normal,R.x=-R.x,R.y=-R.y);return r};var Jc=function(a,b,c,e,f){null==f&&(f=1);null==e&&
(e=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.dirty=this.inverse_dirty=this.coordinates_dirty=!1;this.local_to_world_matrix=new le(1,0,0,0,1,0,0,0,1);this.children=[];this._scale_x=this._scale_y=1;this._x=this._y=this._radians=0;this.on_dirty=null;this.dirty||this.set_dirty();this.local_x=a;this.dirty||this.set_dirty();this.local_y=b;a=Math.PI/180*c;this.dirty||this.set_dirty();this.local_radians=a;this.dirty||this.set_dirty();this.local_scale_x=e;this.dirty||this.set_dirty();this.local_scale_y=
f};d["echo.util.Transform"]=Jc;Jc.__name__=!0;Jc.__interfaces__=[ic];Jc.prototype={set_parent:function(a,b){null!=this.parent&&K.remove(this.parent.children,this);this.parent=a;null!=a&&this.parent.children.push(this);this.set_dirty()},get_local_to_world_matrix:function(){if(this.dirty){if(null==this.parent){var a=this.local_to_world_matrix,b=Math.sin(this.local_radians),c=Math.cos(this.local_radians),e=c*this.local_scale_x,f=-b*this.local_scale_y,g=this.local_x;b*=this.local_scale_x;var d=c*this.local_scale_y,
l=this.local_y;a.m00=e;a.m10=f;a.m20=g;a.m01=b;a.m11=d;a.m21=l;a.m02=0;a.m12=0;a.m22=1}else{a=this.local_to_world_matrix;var h=this.parent.get_local_to_world_matrix();b=Math.sin(this.local_radians);c=Math.cos(this.local_radians);e=c*this.local_scale_x;f=-b*this.local_scale_y;g=this.local_x;b*=this.local_scale_x;d=c*this.local_scale_y;l=this.local_y;c=h.m00*f+h.m10*d+0*h.m20;var n=h.m00*g+h.m10*l+1*h.m20,m=h.m01*e+h.m11*b+0*h.m21,r=h.m01*f+h.m11*d+0*h.m21,C=h.m01*g+h.m11*l+1*h.m21,q=h.m02*e+h.m12*
b+0*h.m22;f=h.m02*f+h.m12*d+0*h.m22;g=h.m02*g+h.m12*l+1*h.m22;a.m00=h.m00*e+h.m10*b+0*h.m20;a.m10=c;a.m20=n;a.m01=m;a.m11=r;a.m21=C;a.m02=q;a.m12=f;a.m22=g}this.dirty=!1}return this.local_to_world_matrix},sync:function(){if(this.coordinates_dirty){var a=this.get_local_to_world_matrix();if(null==this.parent)this._x=this.local_x,this._y=this.local_y,this._scale_x=this.local_scale_x,this._scale_y=this.local_scale_y,this._radians=this.local_radians;else{var b=a.m00,c=a.m01,e=a.m10,f=a.m11;this._x=a.m20;
this._y=a.m21;this._scale_x=Math.sqrt(b*b+c*c);this._scale_y=Math.sqrt(e*e+f*f);this._radians=180/Math.PI*Math.atan2(-e/this._scale_y,b/this._scale_x)}this.coordinates_dirty=!1}},set_dirty:function(){this.dirty=this.inverse_dirty=this.coordinates_dirty=!0;for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.set_dirty()}if(null!=this.on_dirty)this.on_dirty(this)},__class__:Jc};var $b=w["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",
toString:h},Module:(m=function(a){return{_hx_index:1,m:a,__enum__:"haxe.StackItem",toString:h}},m._hx_name="Module",m.__params__=["m"],m),FilePos:(m=function(a,b,c,e){return{_hx_index:2,s:a,file:b,line:c,column:e,__enum__:"haxe.StackItem",toString:h}},m._hx_name="FilePos",m.__params__=["s","file","line","column"],m),Method:(m=function(a,b){return{_hx_index:3,classname:a,method:b,__enum__:"haxe.StackItem",toString:h}},m._hx_name="Method",m.__params__=["classname","method"],m),LocalFunction:(m=function(a){return{_hx_index:4,
v:a,__enum__:"haxe.StackItem",toString:h}},m._hx_name="LocalFunction",m.__params__=["v"],m)};$b.__constructs__=[$b.CFunction,$b.Module,$b.FilePos,$b.Method,$b.LocalFunction];var Ic={callStack:function(){return oa.toHaxe(oa.callStack())},exceptionStack:function(a){null==a&&(a=!1);var b=oa.toHaxe(oa.exceptionStack());return a?b:Ic.subtract(b,Ic.callStack())},toString:function(a){for(var b=new kb,c=0;c<a.length;){var e=a[c];++c;b.b+="\nCalled from ";Ic.itemToString(b,e)}return b.b},subtract:function(a,
b){for(var c=-1,e=-1;++e<a.length;){for(var f=0,g=b.length;f<g;){var d=f++;if(Ic.equalItems(a[e],b[d])){if(0>c&&(c=e),++e,e>=a.length)break}else c=-1}if(0<=c)break}return 0<=c?a.slice(0,c):a},equalItems:function(a,b){if(null==a)return null==b?!0:!1;switch(a._hx_index){case 0:return null==b?!1:0==b._hx_index?!0:!1;case 1:return null==b?!1:1==b._hx_index?a.m==b.m:!1;case 2:if(null==b)return!1;if(2==b._hx_index){var c=b.s,e=b.line,f=b.column,g=a.column,d=a.line,l=a.s;return a.file==b.file&&d==e&&g==
f?Ic.equalItems(l,c):!1}return!1;case 3:return null==b?!1:3==b._hx_index?(c=b.method,e=a.method,a.classname==b.classname?e==c:!1):!1;case 4:return null==b?!1:4==b._hx_index?a.v==b.v:!1}},itemToString:function(a,b){switch(b._hx_index){case 0:a.b+="a C function";break;case 1:b=b.m;a.b+="module ";a.b+=null==b?"null":""+b;break;case 2:var c=b.s,e=b.file,f=b.line;b=b.column;null!=c&&(Ic.itemToString(a,c),a.b+=" (");a.b+=null==e?"null":""+e;a.b+=" line ";a.b+=null==f?"null":""+f;null!=b&&(a.b+=" column ",
a.b+=null==b?"null":""+b);null!=c&&(a.b+=")");break;case 3:c=b.classname;b=b.method;a.b+=E.string(null==c?"<unknown>":c);a.b+=".";a.b+=null==b?"null":""+b;break;case 4:b=b.v,a.b+="local function #",a.b+=null==b?"null":""+b}}},Mc=function(){};d["haxe.IMap"]=Mc;Mc.__name__=!0;Mc.__isInterface__=!0;Mc.prototype={__class__:Mc};var y=function(a,b,c){Error.call(this,a);this.message=a;this.__previousException=b;this.__nativeException=null!=c?c:this;this.__skipStack=0;a=Error.prepareStackTrace;Error.prepareStackTrace=
function(a){return a.stack};if(c instanceof Error)this.stack=c.stack;else{c=null;if(Error.captureStackTrace)Error.captureStackTrace(this,y),c=this;else if(c=Error(),"undefined"==typeof c.stack){try{throw c;}catch(e){}this.__skipStack++}this.stack=c.stack}Error.prepareStackTrace=a};d["haxe.Exception"]=y;y.__name__=!0;y.caught=function(a){return a instanceof y?a:a instanceof Error?new y(a.message,null,a):new $c(a,null,a)};y.thrown=function(a){if(a instanceof y)return a.get_native();if(a instanceof Error)return a;
a=new $c(a);a.__skipStack++;return a};y.__super__=Error;y.prototype=u(Error.prototype,{unwrap:function(){return this.__nativeException},toString:function(){return this.get_message()},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_native:function(){return this.__nativeException},get_stack:function(){var a=this.__exceptionStack;null==a&&(a=oa.toHaxe(oa.normalize(this.stack),this.__skipStack),this.setProperty("__exceptionStack",a));return a},setProperty:function(a,
b){try{Object.defineProperty(this,a,{value:b})}catch(c){this[a]=b}},__class__:y,__properties__:{get_native:"get_native",get_stack:"get_stack",get_message:"get_message"}});var ja=function(){};d["haxe.Log"]=ja;ja.__name__=!0;ja.formatOutput=function(a,b){var c=E.string(a);if(null==b)return c;var e=b.fileName+":"+b.lineNumber;if(null!=b.customParams){var f=0;for(b=b.customParams;f<b.length;)a=b[f],++f,c+=", "+E.string(a)}return e+": "+c};ja.trace=function(a,b){a=ja.formatOutput(a,b);"undefined"!=typeof console&&
null!=console.log&&console.log(a)};var oa=function(){};d["haxe.NativeStackTrace"]=oa;oa.__name__=!0;oa.saveStack=function(a){oa.lastError=a};oa.callStack=function(){var a=Error(""),b=oa.tryHaxeStack(a);if("undefined"==typeof b){try{throw a;}catch(c){}b=a.stack}return oa.normalize(b,2)};oa.exceptionStack=function(){return oa.normalize(oa.tryHaxeStack(oa.lastError))};oa.toHaxe=function(a,b){null==b&&(b=0);if(null==a)return[];if("string"==typeof a){a=a.split("\n");"Error"==a[0]&&a.shift();for(var c=
[],e=0,f=a.length;e<f;){var g=e++;if(!(b>g)){var d=a[g];g=d.match(/^    at ([A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=g){d=g[1].split(".");"$hxClasses"==d[0]&&d.shift();var l=d.pop(),h=g[2],n=E.parseInt(g[3]);g=E.parseInt(g[4]);c.push($b.FilePos("Anonymous function"==l?$b.LocalFunction():"Global code"==l?null:$b.Method(d.join("."),l),h,n,g))}else c.push($b.Module(za.trim(d)))}}return c}return 0<b&&Array.isArray(a)?a.slice(b):a};oa.tryHaxeStack=function(a){if(null==a)return[];var b=
Error.prepareStackTrace;Error.prepareStackTrace=oa.prepareHxStackTrace;a=a.stack;Error.prepareStackTrace=b;return a};oa.prepareHxStackTrace=function(a,b){a=[];for(var c=0;c<b.length;){var e=b[c];++c;null!=oa.wrapCallSite&&(e=oa.wrapCallSite(e));var f=null,g=e.getFunctionName();if(null!=g){var d=g.lastIndexOf(".");0<=d?(f=g.substring(0,d),g=g.substring(d+1),f=$b.Method(f,g)):f=$b.Method(null,g)}g=e.getFileName();d=null==g?-1:g.indexOf("file:");null!=oa.wrapCallSite&&0<d&&(g=g.substring(d+6));a.push($b.FilePos(f,
g,e.getLineNumber(),e.getColumnNumber()))}return a};oa.normalize=function(a,b){null==b&&(b=0);if(Array.isArray(a)&&0<b)return a.slice(b);if("string"==typeof a){switch(a.substring(0,6)){case "Error\n":case "Error:":++b}return oa.skipLines(a,b)}return a};oa.skipLines=function(a,b,c){null==c&&(c=0);return 0<b?(c=a.indexOf("\n",c),0>c?"":oa.skipLines(a,--b,c+1)):a.substring(c)};var md=function(){};d["haxe._Unserializer.DefaultResolver"]=md;md.__name__=!0;md.prototype={resolveClass:function(a){return d[a]},
resolveEnum:function(a){return w[a]},__class__:md};var Jb=function(a){this.buf=a;this.length=this.buf.length;this.pos=0;this.scache=[];this.cache=[];a=Jb.DEFAULT_RESOLVER;null==a&&(a=new md,Jb.DEFAULT_RESOLVER=a);this.resolver=a};d["haxe.Unserializer"]=Jb;Jb.__name__=!0;Jb.initCodes=function(){for(var a=[],b=0,c=Jb.BASE64.length;b<c;){var e=b++;a[Jb.BASE64.charCodeAt(e)]=e}return a};Jb.run=function(a){return(new Jb(a)).unserialize()};Jb.prototype={readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var e=
this.buf.charCodeAt(this.pos);if(e!=e)break;if(45==e){if(this.pos!=c)break;b=!0}else{if(48>e||57<e)break;a=10*a+(e-48)}this.pos++}b&&(a*=-1);return a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(b!=b)break;if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return parseFloat(K.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw y.thrown("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();
if("string"!=typeof b)throw y.thrown("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.buf.charCodeAt(this.pos++))throw y.thrown("Invalid enum format");var c=this.readDigits();if(0==c)return Ja.createEnum(a,b);for(var e=[];0<c--;)e.push(this.unserialize());return Ja.createEnum(a,b,e)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var a=this.unserialize(),b=this.resolver.resolveClass(a);if(null==b)throw y.thrown("Class not found "+
a);return b;case 66:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw y.thrown("Enum not found "+a);return b;case 67:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw y.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);b.hxUnserialize(this);if(103!=this.buf.charCodeAt(this.pos++))throw y.thrown("Invalid custom data");return b;case 77:a=new zb;this.cache.push(a);for(var c;104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),a.set(b,
this.unserialize());this.pos++;return a;case 82:a=this.readDigits();if(0>a||a>=this.scache.length)throw y.thrown("Invalid string reference");return this.scache[a];case 97:b=[];for(this.cache.push(b);;){c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}117==c?(this.pos++,a=this.readDigits(),b[b.length+a-1]=null):b.push(this.unserialize())}return b;case 98:a=new S;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),c=this.unserialize(),a.h[b]=c;this.pos++;return a;
case 99:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw y.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);this.unserializeObject(b);return b;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw y.thrown("Enum not found "+a);this.pos++;for(var e=this.readDigits(),f=c.__constructs__,g=Array(f.length),d=0,l=f.length;d<l;)b=d++,g[b]=f[b]._hx_name;
b=g[e];if(null==b)throw y.thrown("Unknown enum index "+a+"@"+e);b=this.unserializeEnum(c,b);this.cache.push(b);return b;case 107:return NaN;case 108:b=new wb;for(this.cache.push(b);104!=this.buf.charCodeAt(this.pos);)b.add(this.unserialize());this.pos++;return b;case 109:return-Infinity;case 110:return null;case 111:return b={},this.cache.push(b),this.unserializeObject(b),b;case 112:return Infinity;case 113:a=new Gb;this.cache.push(a);for(c=this.buf.charCodeAt(this.pos++);58==c;)b=this.readDigits(),
c=this.unserialize(),a.h[b]=c,c=this.buf.charCodeAt(this.pos++);if(104!=c)throw y.thrown("Invalid IntMap format");return a;case 114:a=this.readDigits();if(0>a||a>=this.cache.length)throw y.thrown("Invalid reference");return this.cache[a];case 115:a=this.readDigits();c=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw y.thrown("Invalid bytes length");e=Jb.CODES;null==e&&(e=Jb.initCodes(),Jb.CODES=e);b=this.pos;f=a&3;g=b+(a-f);d=new Oa(new ArrayBuffer(3*(a>>2)+(2<=f?f-1:
0)));for(l=0;b<g;){var h=e[c.charCodeAt(b++)],n=e[c.charCodeAt(b++)];d.b[l++]=(h<<2|n>>4)&255;h=e[c.charCodeAt(b++)];d.b[l++]=(n<<4|h>>2)&255;n=e[c.charCodeAt(b++)];d.b[l++]=(h<<6|n)&255}2<=f&&(h=e[c.charCodeAt(b++)],n=e[c.charCodeAt(b++)],d.b[l++]=(h<<2|n>>4)&255,3==f&&(h=e[c.charCodeAt(b++)],d.b[l++]=(n<<4|h>>2)&255));this.pos+=a;this.cache.push(d);return d;case 116:return!0;case 118:return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&48<=this.buf.charCodeAt(this.pos+1)&&
57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+3)&&45==this.buf.charCodeAt(this.pos+4)?(b=K.strDate(K.substr(this.buf,this.pos,19)),this.pos+=19):b=new Date(this.readFloat()),this.cache.push(b),b;case 119:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw y.thrown("Enum not found "+a);b=this.unserializeEnum(c,this.unserialize());this.cache.push(b);
return b;case 120:throw y.thrown(this.unserialize());case 121:a=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw y.thrown("Invalid string length");b=K.substr(this.buf,this.pos,a);this.pos+=a;b=decodeURIComponent(b.split("+").join(" "));this.scache.push(b);return b;case 122:return 0}this.pos--;throw y.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos);},__class__:Jb};var $c=function(a,b,c){y.call(this,String(a),b,c);this.value=a;this.__skipStack++};
d["haxe.ValueException"]=$c;$c.__name__=!0;$c.__super__=y;$c.prototype=u(y.prototype,{unwrap:function(){return this.value},__class__:$c});var Nc=function(){this.a1=1;this.a2=0};d["haxe.crypto.Adler32"]=Nc;Nc.__name__=!0;Nc.read=function(a){var b=new Nc,c=a.readByte(),e=a.readByte(),f=a.readByte();a=a.readByte();b.a1=f<<8|a;b.a2=c<<8|e;return b};Nc.prototype={update:function(a,b,c){var e=this.a1,f=this.a2,g=b;for(b+=c;g<b;)c=g++,e=(e+a.b[c])%65521,f=(f+e)%65521;this.a1=e;this.a2=f},equals:function(a){return a.a1==
this.a1?a.a2==this.a2:!1},__class__:Nc};var Oa=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};d["haxe.io.Bytes"]=Oa;Oa.__name__=!0;Oa.ofString=function(a,b){b=[];for(var c=0;c<a.length;){var e=a.charCodeAt(c++);55296<=e&&56319>=e&&(e=e-55232<<10|a.charCodeAt(c++)&1023);127>=e?b.push(e):(2047>=e?b.push(192|e>>6):(65535>=e?b.push(224|e>>12):(b.push(240|e>>18),b.push(128|e>>12&63)),b.push(128|e>>6&63)),b.push(128|e&63))}return new Oa((new Uint8Array(b)).buffer)};
Oa.ofData=function(a){var b=a.hxBytes;return null!=b?b:new Oa(a)};Oa.prototype={blit:function(a,b,c,e){if(0>a||0>c||0>e||a+e>this.length||c+e>b.length)throw y.thrown(Xb.OutsideBounds);0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},getString:function(a,b,c){if(0>a||0>b||a+b>this.length)throw y.thrown(Xb.OutsideBounds);c="";var e=this.b,f=Na.fromCharCode,g=a;for(a+=b;g<a;)if(b=e[g++],128>b){if(0==b)break;c+=f(b)}else if(224>b)c+=f((b&63)<<6|e[g++]&127);else if(240>b){var d=
e[g++];c+=f((b&31)<<12|(d&127)<<6|e[g++]&127)}else{d=e[g++];var l=e[g++];b=(b&15)<<18|(d&127)<<12|(l&127)<<6|e[g++]&127;c+=f((b>>10)+55232);c+=f(b&1023|56320)}return c},toString:function(){return this.getString(0,this.length)},__class__:Oa};var fd=w["haxe.ds.Either"]={__ename__:!0,__constructs__:null,Left:(m=function(a){return{_hx_index:0,v:a,__enum__:"haxe.ds.Either",toString:h}},m._hx_name="Left",m.__params__=["v"],m),Right:(m=function(a){return{_hx_index:1,v:a,__enum__:"haxe.ds.Either",toString:h}},
m._hx_name="Right",m.__params__=["v"],m)};fd.__constructs__=[fd.Left,fd.Right];var Gb=function(){this.h={}};d["haxe.ds.IntMap"]=Gb;Gb.__name__=!0;Gb.__interfaces__=[Mc];Gb.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(+b);return new Oc(a)},iterator:function(){return{ref:this.h,
it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref[a]}}},toString:function(){var a="{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=null==c?"null":""+c;a+=" => ";a+=E.string(E.string(this.h[c]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:Gb};var wb=function(){this.length=0};d["haxe.ds.List"]=wb;wb.__name__=!0;wb.prototype={add:function(a){a=new nd(a,null);null==this.h?this.h=a:this.q.next=a;this.q=a;this.length++},push:function(a){this.h=
a=new nd(a,this.h);null==this.q&&(this.q=a);this.length++},first:function(){return null==this.h?null:this.h.item},pop:function(){if(null==this.h)return null;var a=this.h.item;this.h=this.h.next;null==this.h&&(this.q=null);this.length--;return a},isEmpty:function(){return null==this.h},toString:function(){var a,b=!0,c=this.h;for(a="{";null!=c;)b?b=!1:a+=", ",a+=E.string(E.string(c.item)),c=c.next;return a+"}"},__class__:wb};var nd=function(a,b){this.item=a;this.next=b};d["haxe.ds._List.ListNode"]=
nd;nd.__name__=!0;nd.prototype={__class__:nd};var zb=function(){this.h={__keys__:{}}};d["haxe.ds.ObjectMap"]=zb;zb.__name__=!0;zb.__interfaces__=[Mc];zb.prototype={set:function(a,b){var c=a.__id__;null==c&&(c=a.__id__=v.$haxeUID++);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},exists:function(a){return null!=this.h.__keys__[a.__id__]},remove:function(a){a=a.__id__;if(null==this.h.__keys__[a])return!1;delete this.h[a];delete this.h.__keys__[a];return!0},keys:function(){var a=
[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return new Oc(a)},toString:function(){var a="{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=E.string(E.string(c));a+=" => ";a+=E.string(E.string(this.h[c.__id__]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:zb};var S=function(){this.h=Object.create(null)};d["haxe.ds.StringMap"]=S;S.__name__=!0;S.__interfaces__=[Mc];S.stringify=function(a){var b="{",c=!0,e;for(e in a)c?c=!1:b+=",",b+=e+" => "+E.string(a[e]);
return b+"}"};S.prototype={exists:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)},get:function(a){return this.h[a]},set:function(a,b){this.h[a]=b},remove:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)?(delete this.h[a],!0):!1},toString:function(){return S.stringify(this.h)},__class__:S};var Bc=function(a,b,c){y.call(this,a,b);this.posInfos=null==c?{fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:c;this.__skipStack++};d["haxe.exceptions.PosException"]=
Bc;Bc.__name__=!0;Bc.__super__=y;Bc.prototype=u(y.prototype,{toString:function(){return""+y.prototype.toString.call(this)+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber},__class__:Bc});var od=function(a,b,c){null==a&&(a="Not implemented");Bc.call(this,a,b,c);this.__skipStack++};d["haxe.exceptions.NotImplementedException"]=od;od.__name__=!0;od.__super__=Bc;od.prototype=u(Bc.prototype,{__class__:od});var ad=function(){this.size=
this.pos=0};d["haxe.io.BytesBuffer"]=ad;ad.__name__=!0;ad.prototype={addByte:function(a){this.pos==this.size&&this.grow(1);this.view.setUint8(this.pos++,a)},add:function(a){this.pos+a.length>this.size&&this.grow(a.length);if(0!=this.size){var b=new Uint8Array(a.b.buffer,a.b.byteOffset,a.length);this.u8.set(b,this.pos);this.pos+=a.length}},addBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw y.thrown(Xb.OutsideBounds);this.pos+c>this.size&&this.grow(c);0!=this.size&&(a=new Uint8Array(a.b.buffer,
a.b.byteOffset+b,c),this.u8.set(a,this.pos),this.pos+=c)},grow:function(a){var b=this.pos+a;for(a=0==this.size?16:this.size;a<b;)a=3*a>>1;b=new ArrayBuffer(a);var c=new Uint8Array(b);0<this.size&&c.set(this.u8);this.size=a;this.buffer=b;this.u8=c;this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new Oa(new ArrayBuffer(0));var a=new Oa(this.buffer);a.length=this.pos;return a},__class__:ad};var Xc=function(){};d["haxe.io.Input"]=Xc;Xc.__name__=!0;Xc.prototype={readByte:function(){throw new od(null,
null,{fileName:"haxe/io/Input.hx",lineNumber:53,className:"haxe.io.Input",methodName:"readByte"});},readBytes:function(a,b,c){var e=c,f=a.b;if(0>b||0>c||b+c>a.length)throw y.thrown(Xb.OutsideBounds);try{for(;0<e;)f[b]=this.readByte(),++b,--e}catch(g){if(oa.lastError=g,!(y.caught(g).unwrap()instanceof pd))throw g;}return c-e},readFullBytes:function(a,b,c){for(;0<c;){var e=this.readBytes(a,b,c);if(0==e)throw y.thrown(Xb.Blocked);b+=e;c-=e}},read:function(a){for(var b=new Oa(new ArrayBuffer(a)),c=0;0<
a;){var e=this.readBytes(b,c,a);if(0==e)throw y.thrown(Xb.Blocked);c+=e;a-=e}return b},readInt16:function(){var a=this.readByte(),b=this.readByte();a=this.bigEndian?b|a<<8:a|b<<8;return 0!=(a&32768)?a-65536:a},readUInt16:function(){var a=this.readByte(),b=this.readByte();return this.bigEndian?b|a<<8:a|b<<8},readInt32:function(){var a=this.readByte(),b=this.readByte(),c=this.readByte(),e=this.readByte();return this.bigEndian?e|c<<8|b<<16|a<<24:a|b<<8|c<<16|e<<24},readString:function(a,b){var c=new Oa(new ArrayBuffer(a));
this.readFullBytes(c,0,a);return c.getString(0,a,b)},__class__:Xc};var qd=function(a,b,c){null==b&&(b=0);null==c&&(c=a.length-b);if(0>b||0>c||b+c>a.length)throw y.thrown(Xb.OutsideBounds);this.b=a.b;this.pos=b;this.totlen=this.len=c};d["haxe.io.BytesInput"]=qd;qd.__name__=!0;qd.__super__=Xc;qd.prototype=u(Xc.prototype,{readByte:function(){if(0==this.len)throw y.thrown(new pd);this.len--;return this.b[this.pos++]},readBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw y.thrown(Xb.OutsideBounds);
if(0==this.len&&0<c)throw y.thrown(new pd);this.len<c&&(c=this.len);var e=this.b;a=a.b;for(var f=0,g=c;f<g;){var d=f++;a[b+d]=e[this.pos+d]}this.pos+=c;this.len-=c;return c},__class__:qd});var Ye=w["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:h},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:h}};Ye.__constructs__=[Ye.UTF8,Ye.RawNative];var pd=function(){};d["haxe.io.Eof"]=pd;pd.__name__=
!0;pd.prototype={toString:function(){return"Eof"},__class__:pd};var Xb=w["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:h},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:h},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:h},Custom:(m=function(a){return{_hx_index:3,e:a,__enum__:"haxe.io.Error",toString:h}},m._hx_name="Custom",m.__params__=["e"],m)};Xb.__constructs__=
[Xb.Blocked,Xb.Overflow,Xb.OutsideBounds,Xb.Custom];var jc=function(a){switch(a){case ".":case "..":this.dir=a;this.file="";return}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this.dir=K.substr(a,0,c),a=K.substr(a,c+1,null),this.backslash=!0):c<b?(this.dir=K.substr(a,0,b),a=K.substr(a,b+1,null)):this.dir=null;b=a.lastIndexOf(".");-1!=b?(this.ext=K.substr(a,b+1,null),this.file=K.substr(a,0,b)):(this.ext=null,this.file=a)};d["haxe.io.Path"]=jc;jc.__name__=!0;jc.directory=function(a){a=new jc(a);
return null==a.dir?"":a.dir};jc.prototype={__class__:jc};var Oc=function(a){this.current=0;this.array=a};d["haxe.iterators.ArrayIterator"]=Oc;Oc.__name__=!0;Oc.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Oc};var Cc=w["haxe.zip.ExtraField"]={__ename__:!0,__constructs__:null,FUnknown:(m=function(a,b){return{_hx_index:0,tag:a,bytes:b,__enum__:"haxe.zip.ExtraField",toString:h}},m._hx_name="FUnknown",m.__params__=["tag",
"bytes"],m),FInfoZipUnicodePath:(m=function(a,b){return{_hx_index:1,name:a,crc:b,__enum__:"haxe.zip.ExtraField",toString:h}},m._hx_name="FInfoZipUnicodePath",m.__params__=["name","crc"],m),FUtf8:{_hx_name:"FUtf8",_hx_index:2,__enum__:"haxe.zip.ExtraField",toString:h}};Cc.__constructs__=[Cc.FUnknown,Cc.FInfoZipUnicodePath,Cc.FUtf8];var ac=w["haxe.zip.Huffman"]={__ename__:!0,__constructs__:null,Found:(m=function(a){return{_hx_index:0,i:a,__enum__:"haxe.zip.Huffman",toString:h}},m._hx_name="Found",m.__params__=
["i"],m),NeedBit:(m=function(a,b){return{_hx_index:1,left:a,right:b,__enum__:"haxe.zip.Huffman",toString:h}},m._hx_name="NeedBit",m.__params__=["left","right"],m),NeedBits:(m=function(a,b){return{_hx_index:2,n:a,table:b,__enum__:"haxe.zip.Huffman",toString:h}},m._hx_name="NeedBits",m.__params__=["n","table"],m)};ac.__constructs__=[ac.Found,ac.NeedBit,ac.NeedBits];var me=function(){};d["haxe.zip.HuffTools"]=me;me.__name__=!0;me.prototype={treeDepth:function(a){switch(a._hx_index){case 0:return 0;case 1:var b=
a.right;a=this.treeDepth(a.left);b=this.treeDepth(b);return 1+(a<b?a:b);case 2:throw y.thrown("assert");}},treeCompress:function(a){var b=this.treeDepth(a);if(0==b)return a;if(1==b){if(1==a._hx_index)return b=a.right,ac.NeedBit(this.treeCompress(a.left),this.treeCompress(b));throw y.thrown("assert");}for(var c=[],e=0,f=1<<b;e<f;)e++,c.push(ac.Found(-1));this.treeWalk(c,0,0,b,a);return ac.NeedBits(b,c)},treeWalk:function(a,b,c,e,f){if(1==f._hx_index){var g=f.left,d=f.right;0<e?(this.treeWalk(a,b,c+
1,e-1,g),this.treeWalk(a,b|1<<c,c+1,e-1,d)):a[b]=this.treeCompress(f)}else a[b]=this.treeCompress(f)},treeMake:function(a,b,c,e){if(e>b)throw y.thrown("Invalid huffman");var f=c<<5|e;if(a.h.hasOwnProperty(f))return ac.Found(a.h[f]);c<<=1;++e;return ac.NeedBit(this.treeMake(a,b,c,e),this.treeMake(a,b,c|1,e))},make:function(a,b,c,e){if(1==c)return ac.NeedBit(ac.Found(0),ac.Found(0));var f=[],g=[];if(32<e)throw y.thrown("Invalid huffman");for(var d=0,l=e;d<l;)d++,f.push(0),g.push(0);d=0;for(l=c;d<l;){var h=
d++;h=a[h+b];if(h>=e)throw y.thrown("Invalid huffman");f[h]++}var n=0;d=1;for(l=e-1;d<l;)h=d++,n=n+f[h]<<1,g[h]=n;f=new Gb;d=0;for(l=c;d<l;)h=d++,c=a[h+b],0!=c&&(n=g[c-1],g[c-1]=n+1,f.h[n<<5|c]=h);return this.treeCompress(ac.NeedBit(this.treeMake(f,e,0,1),this.treeMake(f,e,1,1)))},__class__:me};var ne=function(a){this.buffer=new Oa(new ArrayBuffer(65536));this.pos=0;a&&(this.crc=new Nc)};d["haxe.zip._InflateImpl.Window"]=ne;ne.__name__=!0;ne.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,
0,32768);var a=new Oa(new ArrayBuffer(65536));this.pos-=32768;a.blit(0,this.buffer,32768,this.pos);this.buffer=a},addBytes:function(a,b,c){65536<this.pos+c&&this.slide();this.buffer.blit(this.pos,a,b,c);this.pos+=c},addByte:function(a){65536==this.pos&&this.slide();this.buffer.b[this.pos]=a&255;this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){null!=this.crc&&this.crc.update(this.buffer,0,this.pos);return this.crc},__class__:ne};
var Ua=w["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:null,Head:{_hx_name:"Head",_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:h},Block:{_hx_name:"Block",_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:h},CData:{_hx_name:"CData",_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",toString:h},Flat:{_hx_name:"Flat",_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:h},Crc:{_hx_name:"Crc",_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:h},
Dist:{_hx_name:"Dist",_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:h},DistOne:{_hx_name:"DistOne",_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:h},Done:{_hx_name:"Done",_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:h}};Ua.__constructs__=[Ua.Head,Ua.Block,Ua.CData,Ua.Flat,Ua.Crc,Ua.Dist,Ua.DistOne,Ua.Done];var nb=function(a,b,c){null==c&&(c=!0);null==b&&(b=!0);this.isFinal=!1;this.htools=new me;this.huffman=this.buildFixedHuffman();this.huffdist=null;this.dist=
this.len=0;this.state=b?Ua.Head:Ua.Block;this.input=a;this.needed=this.nbits=this.bits=0;this.output=null;this.outpos=0;this.lengths=[];this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);
this.lengths.push(-1);this.lengths.push(-1);this.window=new ne(c)};d["haxe.zip.InflateImpl"]=nb;nb.__name__=!0;nb.prototype={buildFixedHuffman:function(){if(null!=nb.FIXED_HUFFMAN)return nb.FIXED_HUFFMAN;for(var a=[],b=0;288>b;){var c=b++;a.push(143>=c?8:255>=c?9:279>=c?7:8)}nb.FIXED_HUFFMAN=this.htools.make(a,0,288,10);return nb.FIXED_HUFFMAN},readBytes:function(a,b,c){this.needed=c;this.outpos=b;this.output=a;if(0<c)for(;this.inflateLoop(););return c-this.needed},getBits:function(a){for(;this.nbits<
a;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var b=this.bits&(1<<a)-1;this.nbits-=a;this.bits>>=a;return b},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var a=1==(this.bits&1);this.nbits--;this.bits>>=1;return a},getRevBits:function(a){return 0==a?0:this.getBit()?1<<a-1|this.getRevBits(a-1):this.getRevBits(a-1)},resetBits:function(){this.nbits=this.bits=0},addBytes:function(a,b,c){this.window.addBytes(a,b,c);this.output.blit(this.outpos,a,b,c);this.needed-=
c;this.outpos+=c},addByte:function(a){this.window.addByte(a);this.output.b[this.outpos]=a&255;this.needed--;this.outpos++},addDistOne:function(a){for(var b=this.window.getLastChar(),c=0;c<a;)c++,this.addByte(b)},addDist:function(a,b){this.addBytes(this.window.buffer,this.window.pos-a,b)},applyHuffman:function(a){switch(a._hx_index){case 0:var b=a.i;return b;case 1:return b=a.left,a=a.right,this.applyHuffman(this.getBit()?a:b);case 2:return b=a.n,this.applyHuffman(a.table[this.getBits(b)])}},inflateLengths:function(a,
b){for(var c=0,e=0;c<b;){var f=this.applyHuffman(this.huffman);switch(f){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:e=f;a[c]=f;++c;break;case 16:f=c+3+this.getBits(2);if(f>b)throw y.thrown("Invalid data");for(;c<f;)a[c]=e,++c;break;case 17:c+=3+this.getBits(3);if(c>b)throw y.thrown("Invalid data");break;case 18:c+=11+this.getBits(7);if(c>b)throw y.thrown("Invalid data");break;default:throw y.thrown("Invalid data");}}},inflateLoop:function(){switch(this.state._hx_index){case 0:var a=
this.input.readByte();if(8!=(a&15))throw y.thrown("Invalid data");var b=this.input.readByte(),c=0!=(b&32);if(0!=((a<<8)+b)%31)throw y.thrown("Invalid data");if(c)throw y.thrown("Unsupported dictionary");this.state=Ua.Block;return!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:this.len=this.input.readUInt16();if(this.input.readUInt16()!=65535-this.len)throw y.thrown("Invalid data");this.state=Ua.Flat;a=this.inflateLoop();this.resetBits();return a;case 1:return this.huffman=this.buildFixedHuffman(),
this.huffdist=null,this.state=Ua.CData,!0;case 2:a=this.getBits(5)+257;b=this.getBits(5)+1;var e=this.getBits(4)+4;c=0;for(var f=e;c<f;){var g=c++;this.lengths[nb.CODE_LENGTHS_POS[g]]=this.getBits(3)}c=e;for(f=19;c<f;)g=c++,this.lengths[nb.CODE_LENGTHS_POS[g]]=0;this.huffman=this.htools.make(this.lengths,0,19,8);e=[];c=0;for(f=a+b;c<f;)c++,e.push(0);this.inflateLengths(e,a+b);this.huffdist=this.htools.make(e,a,b,16);this.huffman=this.htools.make(e,0,a,16);this.state=Ua.CData;return!0;default:throw y.thrown("Invalid data");
}case 2:b=this.applyHuffman(this.huffman);if(256>b)return this.addByte(b),0<this.needed;if(256==b)this.state=this.isFinal?Ua.Crc:Ua.Block;else{b-=257;a=nb.LEN_EXTRA_BITS_TBL[b];if(-1==a)throw y.thrown("Invalid data");this.len=nb.LEN_BASE_VAL_TBL[b]+this.getBits(a);b=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);a=nb.DIST_EXTRA_BITS_TBL[b];if(-1==a)throw y.thrown("Invalid data");this.dist=nb.DIST_BASE_VAL_TBL[b]+this.getBits(a);if(this.dist>this.window.available())throw y.thrown("Invalid data");
this.state=1==this.dist?Ua.DistOne:Ua.Dist}return!0;case 3:return a=this.len<this.needed?this.len:this.needed,b=this.input.read(a),this.len-=a,this.addBytes(b,0,a),0==this.len&&(this.state=this.isFinal?Ua.Crc:Ua.Block),0<this.needed;case 4:a=this.window.checksum();if(null==a)return this.state=Ua.Done,!0;b=Nc.read(this.input);if(!a.equals(b))throw y.thrown("Invalid CRC");this.state=Ua.Done;return!0;case 5:for(;0<this.len&&0<this.needed;)a=this.len<this.dist?this.len:this.dist,a=this.needed<a?this.needed:
a,this.addDist(this.dist,a),this.len-=a;0==this.len&&(this.state=Ua.CData);return 0<this.needed;case 6:return a=this.len<this.needed?this.len:this.needed,this.addDistOne(a),this.len-=a,0==this.len&&(this.state=Ua.CData),0<this.needed;case 7:return!1}},__class__:nb};var rd=function(a){this.i=a};d["haxe.zip.Reader"]=rd;rd.__name__=!0;rd.readZip=function(a){return(new rd(a)).read()};rd.prototype={readZipDate:function(){var a=this.i.readUInt16(),b=a>>11&31,c=a>>5&63;a&=31;var e=this.i.readUInt16();return new Date((e>>
9)+1980,(e>>5&15)-1,e&31,b,c,a<<1)},readExtraFields:function(a){for(var b=new wb;0<a;){if(4>a)throw y.thrown("Invalid extra fields data");var c=this.i.readUInt16(),e=this.i.readUInt16();if(a<e)throw y.thrown("Invalid extra fields data");if(28789==c){var f=this.i.readByte();if(1!=f){var g=new ad;g.addByte(f);g.add(this.i.read(e-1));b.add(Cc.FUnknown(c,g.getBytes()))}else c=this.i.readInt32(),f=this.i.read(e-5).toString(),b.add(Cc.FInfoZipUnicodePath(f,c))}else b.add(Cc.FUnknown(c,this.i.read(e)));
a-=4+e}return b},readEntryHeader:function(){var a=this.i,b=a.readInt32();if(33639248==b||101010256==b)return null;if(67324752!=b)throw y.thrown("Invalid Zip Data");a.readUInt16();b=a.readUInt16();var c=0!=(b&2048),e=a.readUInt16(),f=0!=e;if(f&&8!=e)throw y.thrown("Unsupported compression "+e);e=this.readZipDate();var g=a.readInt32(),d=a.readInt32(),l=a.readInt32(),h=a.readInt16(),n=a.readInt16();a=a.readString(h);n=this.readExtraFields(n);c&&n.push(Cc.FUtf8);0!=(b&8)&&(d=-1);return{fileName:a,fileSize:l,
fileTime:e,compressed:f,dataSize:d,data:null,crc32:g,extraFields:n}},read:function(){for(var a=new wb,b=null;;){var c=this.readEntryHeader();if(null==c)break;if(0>c.dataSize){null==b&&(b=new Oa(new ArrayBuffer(65536)));for(var e=new ad,f=new nb(this.i,!1,!1);;){var g=f.readBytes(b,0,65536);e.addBytes(b,0,g);if(65536>g)break}c.data=e.getBytes();c.crc32=this.i.readInt32();134695760==c.crc32&&(c.crc32=this.i.readInt32());c.dataSize=this.i.readInt32();c.fileSize=this.i.readInt32();c.dataSize=c.fileSize;
c.compressed=!1}else c.data=this.i.read(c.dataSize);a.add(c)}return a},__class__:rd};var Ob=function(a,b){this.message=a;this.pos=b};d["hxjsonast.Error"]=Ob;Ob.__name__=!0;Ob.prototype={__class__:Ob};var Ma=function(a,b){this.value=a;this.pos=b};d["hxjsonast.Json"]=Ma;Ma.__name__=!0;Ma.prototype={__class__:Ma};var Ha=w["hxjsonast.JsonValue"]={__ename__:!0,__constructs__:null,JString:(m=function(a){return{_hx_index:0,s:a,__enum__:"hxjsonast.JsonValue",toString:h}},m._hx_name="JString",m.__params__=
["s"],m),JNumber:(m=function(a){return{_hx_index:1,s:a,__enum__:"hxjsonast.JsonValue",toString:h}},m._hx_name="JNumber",m.__params__=["s"],m),JObject:(m=function(a){return{_hx_index:2,fields:a,__enum__:"hxjsonast.JsonValue",toString:h}},m._hx_name="JObject",m.__params__=["fields"],m),JArray:(m=function(a){return{_hx_index:3,values:a,__enum__:"hxjsonast.JsonValue",toString:h}},m._hx_name="JArray",m.__params__=["values"],m),JBool:(m=function(a){return{_hx_index:4,b:a,__enum__:"hxjsonast.JsonValue",
toString:h}},m._hx_name="JBool",m.__params__=["b"],m),JNull:{_hx_name:"JNull",_hx_index:5,__enum__:"hxjsonast.JsonValue",toString:h}};Ha.__constructs__=[Ha.JString,Ha.JNumber,Ha.JObject,Ha.JArray,Ha.JBool,Ha.JNull];var oe=function(a,b,c){this.name=a;this.namePos=b;this.value=c};d["hxjsonast.JObjectField"]=oe;oe.__name__=!0;oe.prototype={__class__:oe};var ce=function(a,b){this.source=a;this.filename=b;this.pos=0};d["hxjsonast.Parser"]=ce;ce.__name__=!0;ce.prototype={doParse:function(){for(var a=this.parseRec(),
b;;){var c=b=this.source.charCodeAt(this.pos++);if(c!=c)break;switch(b){case 9:case 10:case 13:case 32:break;default:this.invalidChar()}}return a},parseRec:function(){for(;;){var a=this.source.charCodeAt(this.pos++);switch(a){case 9:case 10:case 13:case 32:break;case 34:var b=this.pos,c=this.parseString();return new Ma(Ha.JString(c),new Da(this.filename,b-1,this.pos));case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:b=this.pos-1;c=45==a;var e=!c;a=48==a;for(var f=
!1,g=!1,d=!1,l=!1;;){switch(this.source.charCodeAt(this.pos++)){case 43:case 45:g&&!d||this.invalidNumber(b);e=!1;d=!0;break;case 46:(c||f||g)&&this.invalidNumber(b);e=!1;f=!0;break;case 48:a&&!f&&this.invalidNumber(b);c&&(c=!1,a=!0);e=!0;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:a&&!f&&this.invalidNumber(b);c&&(c=!1);e=!0;a=!1;break;case 69:case 101:(c||a||g)&&this.invalidNumber(b);e=!1;g=!0;break;default:e||this.invalidNumber(b),this.pos--,l=!0}if(l)break}c=K.substr(this.source,
b,this.pos-b);return new Ma(Ha.JNumber(c),new Da(this.filename,b,this.pos));case 91:for(b=[],c=null,e=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 44:c?c=!1:this.invalidChar();break;case 93:return 0==c&&this.invalidChar(),new Ma(Ha.JArray(b),new Da(this.filename,e,this.pos));default:c&&this.invalidChar(),this.pos--,b.push(this.parseRec()),c=!0}case 102:b=this.pos;if(97!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||
115!=this.source.charCodeAt(this.pos++)||101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new Ma(Ha.JBool(!1),new Da(this.filename,b-1,this.pos));case 110:b=this.pos;if(117!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new Ma(Ha.JNull,new Da(this.filename,b-1,this.pos));case 116:b=this.pos;if(114!=this.source.charCodeAt(this.pos++)||117!=this.source.charCodeAt(this.pos++)||
101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new Ma(Ha.JBool(!0),new Da(this.filename,b-1,this.pos));case 123:for(b=[],c=Object.create(null),a=g=e=null,f=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 34:(null!=e||a)&&this.invalidChar();g=this.pos-1;e=this.parseString();g=new Da(this.filename,g,this.pos);if(Object.prototype.hasOwnProperty.call(c,e))throw y.thrown(new Ob('Duplicate field name "'+e+'"',g));c[e]=!0;break;
case 44:a?a=!1:this.invalidChar();break;case 58:null==e&&this.invalidChar();b.push(new oe(e,g,this.parseRec()));g=e=null;a=!0;break;case 125:return null==e&&0!=a||this.invalidChar(),new Ma(Ha.JObject(b),new Da(this.filename,f,this.pos));default:this.invalidChar()}default:this.invalidChar()}}},parseString:function(){for(var a=this.pos,b=null;;){var c=this.source.charCodeAt(this.pos++);if(34==c)break;if(92==c){null==b&&(b=new kb);c=this.source;var e=this.pos-a-1;b.b+=null==e?K.substr(c,a,null):K.substr(c,
a,e);c=this.source.charCodeAt(this.pos++);switch(c){case 34:case 47:case 92:b.b+=String.fromCodePoint(c);break;case 98:b.b+=String.fromCodePoint(8);break;case 102:b.b+=String.fromCodePoint(12);break;case 110:b.b+=String.fromCodePoint(10);break;case 114:b.b+=String.fromCodePoint(13);break;case 116:b.b+=String.fromCodePoint(9);break;case 117:a=E.parseInt("0x"+K.substr(this.source,this.pos,4));this.pos+=4;b.b+=String.fromCodePoint(a);break;default:throw y.thrown(new Ob("Invalid escape sequence \\"+String.fromCodePoint(c),
new Da(this.filename,this.pos-2,this.pos)));}a=this.pos}else if(c!=c)throw this.pos--,y.thrown(new Ob("Unclosed string",new Da(this.filename,a-1,this.pos)));}if(null==b)return K.substr(this.source,a,this.pos-a-1);c=this.source;e=this.pos-a-1;b.b+=null==e?K.substr(c,a,null):K.substr(c,a,e);return b.b},invalidChar:function(){this.pos--;throw y.thrown(new Ob("Invalid character: "+this.source.charAt(this.pos),new Da(this.filename,this.pos,this.pos+1)));},invalidNumber:function(a){throw y.thrown(new Ob("Invalid number: "+
this.source.substring(a,this.pos),new Da(this.filename,a,this.pos)));},__class__:ce};var Da=function(a,b,c){this.file=a;this.min=b;this.max=c};d["hxjsonast.Position"]=Da;Da.__name__=!0;Da.prototype={__class__:Da};var xa=function(){};d["js.Boot"]=xa;xa.__name__=!0;xa.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;var b=a.__class__;if(null!=b)return b;a=xa.__nativeClassName(a);return null!=a?xa.__resolveNativeClass(a):null};xa.__string_rec=function(a,b){if(null==a)return"null";
if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a.__enum__){var e=w[a.__enum__].__constructs__[a._hx_index];c=e._hx_name;if(e.__params__){b+="\t";var f=[],g=0;for(e=e.__params__;g<e.length;){var d=e[g];g+=1;f.push(xa.__string_rec(a[d],b))}return c+"("+f.join(",")+")"}return c}if(a instanceof Array){c="[";b+="\t";f=0;for(g=a.length;f<g;)e=f++,c+=(0<e?",":"")+xa.__string_rec(a[e],b);return c+
"]"}try{f=a.toString}catch(l){return oa.lastError=l,"???"}if(null!=f&&f!=Object.toString&&"function"==typeof f&&(c=a.toString(),"[object Object]"!=c))return c;c="{\n";b+="\t";f=null!=a.hasOwnProperty;g=null;for(g in a)f&&!a.hasOwnProperty(g)||"prototype"==g||"__class__"==g||"__super__"==g||"__interfaces__"==g||"__properties__"==g||(2!=c.length&&(c+=", \n"),c+=b+g+" : "+xa.__string_rec(a[g],b));b=b.substring(1);return c+("\n"+b+"}");case "string":return a;default:return String(a)}};xa.__interfLoop=
function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var e=0,f=c.length;e<f;){var g=e++;g=c[g];if(g==b||xa.__interfLoop(g,b))return!0}return xa.__interfLoop(a.__super__,b)};xa.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array;case bf:return"boolean"==typeof a;case cf:return null!=a;case df:return"number"==typeof a;case ef:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==
typeof b){if(xa.__downcastCheck(a,b))return!0}else{if("object"==typeof b&&xa.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==ff&&null!=a.__name__||b==gf&&null!=a.__ename__?!0:null!=a.__enum__?w[a.__enum__]==b:!1}};xa.__downcastCheck=function(a,b){return a instanceof b?!0:b.__isInterface__?xa.__interfLoop(xa.getClass(a),b):!1};xa.__cast=function(a,b){if(null==a||xa.__instanceof(a,b))return a;throw y.thrown("Cannot cast "+E.string(a)+" to "+E.string(b));};xa.__nativeClassName=function(a){a=
xa.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};xa.__isNativeObj=function(a){return null!=xa.__nativeClassName(a)};xa.__resolveNativeClass=function(a){return v[a]};var ua=w["json2object.Error"]={__ename__:!0,__constructs__:null,IncorrectType:(m=function(a,b,c){return{_hx_index:0,variable:a,expected:b,pos:c,__enum__:"json2object.Error",toString:h}},m._hx_name="IncorrectType",m.__params__=["variable","expected","pos"],m),IncorrectEnumValue:(m=function(a,
b,c){return{_hx_index:1,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:h}},m._hx_name="IncorrectEnumValue",m.__params__=["value","expected","pos"],m),InvalidEnumConstructor:(m=function(a,b,c){return{_hx_index:2,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:h}},m._hx_name="InvalidEnumConstructor",m.__params__=["value","expected","pos"],m),UninitializedVariable:(m=function(a,b){return{_hx_index:3,variable:a,pos:b,__enum__:"json2object.Error",toString:h}},m._hx_name=
"UninitializedVariable",m.__params__=["variable","pos"],m),UnknownVariable:(m=function(a,b){return{_hx_index:4,variable:a,pos:b,__enum__:"json2object.Error",toString:h}},m._hx_name="UnknownVariable",m.__params__=["variable","pos"],m),ParserError:(m=function(a,b){return{_hx_index:5,message:a,pos:b,__enum__:"json2object.Error",toString:h}},m._hx_name="ParserError",m.__params__=["message","pos"],m),CustomFunctionException:(m=function(a,b){return{_hx_index:6,e:a,pos:b,__enum__:"json2object.Error",toString:h}},
m._hx_name="CustomFunctionException",m.__params__=["e","pos"],m)};ua.__constructs__=[ua.IncorrectType,ua.IncorrectEnumValue,ua.InvalidEnumConstructor,ua.UninitializedVariable,ua.UnknownVariable,ua.ParserError,ua.CustomFunctionException];var qb=w["json2object.InternalError"]={__ename__:!0,__constructs__:null,AbstractNoJsonRepresentation:(m=function(a){return{_hx_index:0,name:a,__enum__:"json2object.InternalError",toString:h}},m._hx_name="AbstractNoJsonRepresentation",m.__params__=["name"],m),CannotGenerateSchema:(m=
function(a){return{_hx_index:1,name:a,__enum__:"json2object.InternalError",toString:h}},m._hx_name="CannotGenerateSchema",m.__params__=["name"],m),HandleExpr:{_hx_name:"HandleExpr",_hx_index:2,__enum__:"json2object.InternalError",toString:h},ParsingThrow:{_hx_name:"ParsingThrow",_hx_index:3,__enum__:"json2object.InternalError",toString:h},UnsupportedAbstractEnumType:(m=function(a){return{_hx_index:4,name:a,__enum__:"json2object.InternalError",toString:h}},m._hx_name="UnsupportedAbstractEnumType",
m.__params__=["name"],m),UnsupportedEnumAbstractValue:(m=function(a){return{_hx_index:5,name:a,__enum__:"json2object.InternalError",toString:h}},m._hx_name="UnsupportedEnumAbstractValue",m.__params__=["name"],m),UnsupportedMapKeyType:(m=function(a){return{_hx_index:6,name:a,__enum__:"json2object.InternalError",toString:h}},m._hx_name="UnsupportedMapKeyType",m.__params__=["name"],m),UnsupportedSchemaObjectType:(m=function(a){return{_hx_index:7,name:a,__enum__:"json2object.InternalError",toString:h}},
m._hx_name="UnsupportedSchemaObjectType",m.__params__=["name"],m),UnsupportedSchemaType:(m=function(a){return{_hx_index:8,type:a,__enum__:"json2object.InternalError",toString:h}},m._hx_name="UnsupportedSchemaType",m.__params__=["type"],m)};qb.__constructs__=[qb.AbstractNoJsonRepresentation,qb.CannotGenerateSchema,qb.HandleExpr,qb.ParsingThrow,qb.UnsupportedAbstractEnumType,qb.UnsupportedEnumAbstractValue,qb.UnsupportedMapKeyType,qb.UnsupportedSchemaObjectType,qb.UnsupportedSchemaType];var Pe=function(){};
d["json2object.ErrorUtils"]=Pe;Pe.__name__=!0;Pe.convertError=function(a){switch(a._hx_index){case 0:var b=a.pos;var c=b;break;case 1:c=b=a.pos;break;case 2:c=b=a.pos;break;case 3:c=b=a.pos;break;case 4:c=b=a.pos;break;case 5:c=b=a.pos;break;case 6:c=b=a.pos}b="";if(null!=c){var e=""==c.file?"line":""+c.file+":";1==c.lines.length?b=""+e+c.lines[0].number+": characters "+c.lines[0].start+"-"+c.lines[0].end+" : ":1<c.lines.length&&(b=""+e+c.lines[0].number+": lines "+c.lines[0].number+"-"+c.lines[c.lines.length-
1].number+" : ")}switch(a._hx_index){case 0:return c=a.variable,a=a.expected,b+("Variable '"+c+"' should be of type '"+a+"'");case 1:return c=a.value,a=a.expected,b+("Identifier '"+c+"' isn't part of '"+a+"'");case 2:return c=a.value,a=a.expected,b+("Enum argument '"+c+"' should be of type '"+a+"'");case 3:return c=a.variable,b+("Variable '"+c+"' should be in the json");case 4:return c=a.variable,b+("Variable '"+c+"' isn't part of the schema");case 5:return b+("Parser error: "+a.message);case 6:return a=
a.e,b+("Custom function exception: "+(null==a?"null":E.string(a)))}};var be=function(a){this.linesInfo=[];for(var b=0,c,e=0,f=0;e<a.length;)switch(a.charAt(e)){case "\n":c=e;this.linesInfo.push({number:f,start:b,end:c});++f;++e;b=e;break;case "\r":c=e;"\n"==a.charAt(e+1)&&++c;this.linesInfo.push({number:f,start:b,end:c});++f;b=e=c+1;break;default:++e}this.linesInfo.push({number:f,start:b,end:e})};d["json2object.PositionUtils"]=be;be.__name__=!0;be.prototype={convertPosition:function(a){var b=a.min,
c=a.max;a={file:a.file,min:b+1,max:c+1,lines:[]};var e=0,f=this.linesInfo.length-1;if(b>this.linesInfo[0].end)for(;f>e;){var g=(e+f)/2|0,d=this.linesInfo[g];d.start==b&&(f=e=g);d.end<b&&(e=g+1);if(d.start>b||d.end>=b&&d.start<b)f=g}for(f=this.linesInfo.length;e<f;){g=e++;d=this.linesInfo[g];if(d.start<=b&&d.end>=c){a.lines.push({number:d.number+1,start:b-d.start+1,end:c-d.start+1});break}d.start<=b&&b<=d.end&&a.lines.push({number:d.number+1,start:b-d.start+1,end:d.end+1});d.start<=c&&c<=d.end&&a.lines.push({number:d.number+
1,start:d.start+1,end:c-d.start+1});if(d.start>=c||d.end>=c)break}return a},__class__:be};var Sd=function(){this.connected=!0;this.buttons=[];this.axes=[]};d["lime._internal.backend.html5.GameDeviceData"]=Sd;Sd.__name__=!0;Sd.prototype={__class__:Sd};var U=function(){this.validStatus0=(new Ca("Tizen","gi")).match(window.navigator.userAgent)};d["lime._internal.backend.html5.HTML5HTTPRequest"]=U;U.__name__=!0;U.loadImage=function(a){var b=new Db;U.activeRequests<U.requestLimit?(U.activeRequests++,U.__loadImage(a,
b,0)):U.requestQueue.add({instance:null,uri:a,promise:b,type:"IMAGE",options:0});return b.future};U.loadImageFromBytes=function(a,b){var c=URL.createObjectURL(new Blob([a.b.bufferValue],{type:b}));return null!=c?(a=new Db,U.activeRequests<U.requestLimit?(U.activeRequests++,U.__loadImage(c,a,1)):U.requestQueue.add({instance:null,uri:c,promise:a,type:"IMAGE",options:1}),a.future):U.loadImage("data:"+b+";base64,"+nc.encode(a))};U.processQueue=function(){if(U.activeRequests<U.requestLimit&&0<U.requestQueue.length){U.activeRequests++;
var a=U.requestQueue.pop();switch(a.type){case "BINARY":a.instance.__loadData(a.uri,a.promise);break;case "IMAGE":U.__loadImage(a.uri,a.promise,a.options);break;case "TEXT":a.instance.__loadText(a.uri,a.promise);break;default:U.activeRequests--}}};U.__fixHostname=function(a){return null==a?"":a};U.__fixPort=function(a,b){if(null==a||""==a)switch(b){case "ftp:":return"21";case "gopher:":return"70";case "http:":return"80";case "https:":return"443";case "ws:":return"80";case "wss:":return"443";default:return""}return a};
U.__fixProtocol=function(a){return null==a||""==a?"http:":a};U.__isInMemoryURI=function(a){return za.startsWith(a,"data:")?!0:za.startsWith(a,"blob:")};U.__isSameOrigin=function(a){if(null==a||""==a||U.__isInMemoryURI(a))return!0;null==U.originElement&&(U.originElement=window.document.createElement("a"),U.originHostname=U.__fixHostname(v.location.hostname),U.originProtocol=U.__fixProtocol(v.location.protocol),U.originPort=U.__fixPort(v.location.port,U.originProtocol));var b=U.originElement;b.href=
a;""==b.hostname&&(b.href=b.href);var c=U.__fixHostname(b.hostname);a=U.__fixProtocol(b.protocol);b=U.__fixPort(b.port,a);c=""==c||c==U.originHostname;b=""==b||b==U.originPort;return"file:"!=a&&c?b:!1};U.__loadImage=function(a,b,c){var e=new Image;U.__isSameOrigin(a)||(e.crossOrigin="Anonymous");null==U.supportsImageProgress&&(U.supportsImageProgress="onprogress"in e);if(U.supportsImageProgress||U.__isInMemoryURI(a))e.addEventListener("load",function(f){U.__revokeBlobURI(a,c);f=new oc(null,e.width,
e.height);f.__srcImage=e;U.activeRequests--;U.processQueue();b.complete(new Ka(f))},!1),e.addEventListener("progress",function(a){b.progress(a.loaded,a.total)},!1),e.addEventListener("error",function(e){U.__revokeBlobURI(a,c);U.activeRequests--;U.processQueue();b.error(e.detail)},!1),e.src=a;else{var f=new XMLHttpRequest;f.onload=function(a){U.activeRequests--;U.processQueue();(new Ka).__fromBytes(Oa.ofData(f.response),function(a){b.complete(a)})};f.onerror=function(a){b.error(a.message)};f.onprogress=
function(a){a.lengthComputable&&b.progress(a.loaded,a.total)};f.open("GET",a,!0);f.responseType="arraybuffer";f.overrideMimeType("text/plain; charset=x-user-defined");f.send(null)}};U.__revokeBlobURI=function(a,b){0!=(b&1)&&URL.revokeObjectURL(a)};U.prototype={init:function(a){this.parent=a},load:function(a,b,c){this.request=new XMLHttpRequest;"POST"==this.parent.method?this.request.upload.addEventListener("progress",b,!1):this.request.addEventListener("progress",b,!1);this.request.onreadystatechange=
c;b="";if(null==this.parent.data){c=Object.keys(this.parent.formData.h);for(var e=c.length,f=0;f<e;){var g=c[f++];0<b.length&&(b+="&");var d=this.parent.formData.h[g];if(-1<g.indexOf("[]")&&d instanceof Array){var l=[];for(d=B(d);d.hasNext();){var h=d.next();l.push(encodeURIComponent(h))}l=l.join("&amp;"+g+"=");b+=encodeURIComponent(g)+"="+l}else l=encodeURIComponent(g)+"=",g=E.string(d),b+=l+encodeURIComponent(g)}"GET"==this.parent.method&&""!=b&&(a=-1<a.indexOf("?")?a+("&"+b):a+("?"+b),b="")}this.request.open(E.string(this.parent.method),
a,!0);0<this.parent.timeout&&(this.request.timeout=this.parent.timeout);this.binary&&(this.request.responseType="arraybuffer");a=null;l=0;for(c=this.parent.headers;l<c.length;)e=c[l],++l,"Content-Type"==e.name?a=e.value:this.request.setRequestHeader(e.name,e.value);null!=this.parent.contentType&&(a=this.parent.contentType);null==a&&(null!=this.parent.data?a="application/octet-stream":""!=b&&(a="application/x-www-form-urlencoded"));null!=a&&this.request.setRequestHeader("Content-Type",a);this.parent.withCredentials&&
(this.request.withCredentials=!0);null!=this.parent.data?this.request.send(this.parent.data.b.bufferValue):this.request.send(b)},loadData:function(a){var b=new Db;U.activeRequests<U.requestLimit?(U.activeRequests++,this.__loadData(a,b)):U.requestQueue.add({instance:this,uri:a,promise:b,type:"BINARY",options:0});return b.future},loadText:function(a){var b=new Db;U.activeRequests<U.requestLimit?(U.activeRequests++,this.__loadText(a,b)):U.requestQueue.add({instance:this,uri:a,promise:b,type:"TEXT",options:0});
return b.future},processResponse:function(){if(this.parent.enableResponseHeaders){this.parent.responseHeaders=[];for(var a,b,c=0,e=this.request.getAllResponseHeaders().split("\n");c<e.length;)b=e[c],++c,a=za.trim(K.substr(b,0,b.indexOf(":"))),b=za.trim(K.substr(b,b.indexOf(":")+1,null)),""!=a&&this.parent.responseHeaders.push(new pe(a,b))}this.parent.responseStatus=this.request.status},__loadData:function(a,b){var c=this;this.binary=!0;this.load(a,function(a){b.progress(a.loaded,a.total)},function(a){4==
c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>c.request.status||c.validStatus0&&0==c.request.status)?(a=null,""==c.request.responseType?null!=c.request.responseText&&(a=Oa.ofString(c.request.responseText)):null!=c.request.response&&(a=Oa.ofData(c.request.response)),c.processResponse(),b.complete(a)):(c.processResponse(),b.error(c.request.status)),c.request=null,U.activeRequests--,U.processQueue())})},__loadText:function(a,b){var c=this;this.binary=!1;this.load(a,function(a){b.progress(a.loaded,
a.total)},function(a){4==c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>=c.request.status||c.validStatus0&&0==c.request.status)?(c.processResponse(),b.complete(c.request.responseText)):(c.processResponse(),b.error(c.request.status)),c.request=null,U.activeRequests--,U.processQueue())})},__class__:U};var sd=function(a){this.unusedTouchesPool=new wb;this.scale=1;this.currentTouches=new Gb;this.parent=a;this.cursor=Rb.DEFAULT;this.cacheMouseY=this.cacheMouseX=0;var b=a.__attributes;
Object.prototype.hasOwnProperty.call(b,"context")||(b.context={});this.renderType=b.context.type;Object.prototype.hasOwnProperty.call(b,"element")&&(a.element=b.element);var c=a.element;Object.prototype.hasOwnProperty.call(b,"allowHighDPI")&&b.allowHighDPI&&"dom"!=this.renderType&&(this.scale=window.devicePixelRatio);a.__scale=this.scale;this.setWidth=Object.prototype.hasOwnProperty.call(b,"width")?b.width:0;this.setHeight=Object.prototype.hasOwnProperty.call(b,"height")?b.height:0;a.__width=this.setWidth;
a.__height=this.setHeight;a.id=sd.windowID++;c instanceof HTMLCanvasElement?this.canvas=c:"dom"==this.renderType?this.div=window.document.createElement("div"):this.canvas=window.document.createElement("canvas");if(null!=this.canvas){var e=this.canvas.style;e.setProperty("-webkit-transform","translateZ(0)",null);e.setProperty("transform","translateZ(0)",null)}else null!=this.div&&(e=this.div.style,e.setProperty("-webkit-transform","translate3D(0,0,0)",null),e.setProperty("transform","translate3D(0,0,0)",
null),e.position="relative",e.overflow="hidden",e.setProperty("-webkit-user-select","none",null),e.setProperty("-moz-user-select","none",null),e.setProperty("-ms-user-select","none",null),e.setProperty("-o-user-select","none",null));0==a.__width&&0==a.__height&&(null!=c?(a.__width=c.clientWidth,a.__height=c.clientHeight):(a.__width=window.innerWidth,a.__height=window.innerHeight),this.cacheElementWidth=a.__width,this.cacheElementHeight=a.__height,this.resizeElement=!0);null!=this.canvas?(this.canvas.width=
Math.round(a.__width*this.scale),this.canvas.height=Math.round(a.__height*this.scale),this.canvas.style.width=a.__width+"px",this.canvas.style.height=a.__height+"px"):(this.div.style.width=a.__width+"px",this.div.style.height=a.__height+"px");if(Object.prototype.hasOwnProperty.call(b,"resizable")&&b.resizable||!Object.prototype.hasOwnProperty.call(b,"width")&&0==this.setWidth&&0==this.setHeight)a.__resizable=!0;this.updateSize();if(null!=c){null!=this.canvas?c!=this.canvas&&c.appendChild(this.canvas):
c.appendChild(this.div);b="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" ");for(e=0;e<b.length;){var f=b[e];++e;c.addEventListener(f,p(this,this.handleMouseEvent),!0)}c.addEventListener("contextmenu",p(this,this.handleContextMenuEvent),!0);c.addEventListener("dragstart",p(this,this.handleDragEvent),!0);c.addEventListener("dragover",p(this,this.handleDragEvent),!0);c.addEventListener("drop",p(this,this.handleDragEvent),!0);c.addEventListener("touchstart",p(this,this.handleTouchEvent),
!0);c.addEventListener("touchmove",p(this,this.handleTouchEvent),!0);c.addEventListener("touchend",p(this,this.handleTouchEvent),!0);c.addEventListener("touchcancel",p(this,this.handleTouchEvent),!0);c.addEventListener("gamepadconnected",p(this,this.handleGamepadEvent),!0);c.addEventListener("gamepaddisconnected",p(this,this.handleGamepadEvent),!0)}this.createContext();"webgl"==a.context.type&&(this.canvas.addEventListener("webglcontextlost",p(this,this.handleContextEvent),!1),this.canvas.addEventListener("webglcontextrestored",
p(this,this.handleContextEvent),!1))};d["lime._internal.backend.html5.HTML5Window"]=sd;sd.__name__=!0;sd.prototype={close:function(){this.parent.application.__removeWindow(this.parent)},createContext:function(){var a=new qe,b=this.parent.__attributes.context;a.window=this.parent;a.attributes=b;if(null!=this.div)a.dom=this.div,a.type="dom",a.version="";else if(null!=this.canvas){var c=null,e="canvas"==this.renderType,f="opengl"==this.renderType||"opengles"==this.renderType||"webgl"==this.renderType,
g=!Object.prototype.hasOwnProperty.call(b,"version")||"1"!=b.version,d=!1;if(f||!e&&(!Object.prototype.hasOwnProperty.call(b,"hardware")||b.hardware)){e=Object.prototype.hasOwnProperty.call(b,"background")&&null==b.background;f=Object.prototype.hasOwnProperty.call(b,"colorDepth")?b.colorDepth:16;var l=Object.prototype.hasOwnProperty.call(b,"antialiasing")&&0<b.antialiasing,h=Object.prototype.hasOwnProperty.call(b,"depth")?b.depth:!0;b=Object.prototype.hasOwnProperty.call(b,"stencil")&&b.stencil;b=
{alpha:e||16<f,antialias:l,depth:h,premultipliedAlpha:!0,stencil:b,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1};e=["webgl","experimental-webgl"];g&&e.unshift("webgl2");for(g=0;g<e.length&&(f=e[g],++g,c=this.canvas.getContext(f,b),null!=c&&"webgl2"==f&&(d=!0),null==c););}null==c?(a.canvas2D=this.canvas.getContext("2d"),a.type="canvas",a.version=""):(a.webgl=hf.fromWebGL2RenderContext(c),d&&(a.webgl2=c),null==td.context&&(td.context=c,td.type="webgl",td.version=d?2:1),a.type="webgl",a.version=
d?"2":"1")}this.parent.context=a},handleContextEvent:function(a){switch(a.type){case "webglcontextlost":a.cancelable&&a.preventDefault();this.parent.context=null;this.parent.onRenderContextLost.dispatch();break;case "webglcontextrestored":this.createContext(),this.parent.onRenderContextRestored.dispatch(this.parent.context)}},handleContextMenuEvent:function(a){(this.parent.onMouseUp.canceled||this.parent.onMouseDown.canceled)&&a.cancelable&&a.preventDefault()},handleDragEvent:function(a){switch(a.type){case "dragover":return a.preventDefault(),
!1;case "dragstart":if("img"==xa.__cast(a.target,HTMLElement).nodeName.toLowerCase()&&a.cancelable)return a.preventDefault(),!1;break;case "drop":if(null!=a.dataTransfer&&0<a.dataTransfer.files.length)return this.parent.onDropFile.dispatch(a.dataTransfer.files),a.preventDefault(),!1}return!0},handleGamepadEvent:function(a){switch(a.type){case "gamepadconnected":$a.__connect(a.gamepad.index);"standard"==a.gamepad.mapping&&bb.__connect(a.gamepad.index);break;case "gamepaddisconnected":$a.__disconnect(a.gamepad.index),
bb.__disconnect(a.gamepad.index)}},handleMouseEvent:function(a){if("wheel"!=a.type){if(null!=this.parent.element)if(null!=this.canvas){var b=this.canvas.getBoundingClientRect();var c=this.parent.__width/b.width*(a.clientX-b.left);b=this.parent.__height/b.height*(a.clientY-b.top)}else null!=this.div?(b=this.div.getBoundingClientRect(),c=a.clientX-b.left,b=a.clientY-b.top):(b=this.parent.element.getBoundingClientRect(),c=this.parent.__width/b.width*(a.clientX-b.left),b=this.parent.__height/b.height*
(a.clientY-b.top));else c=a.clientX,b=a.clientY;switch(a.type){case "mousedown":a.currentTarget==this.parent.element&&window.addEventListener("mouseup",p(this,this.handleMouseEvent));this.parent.onMouseDown.dispatch(c,b,a.button);this.parent.onMouseDown.canceled&&a.cancelable&&a.preventDefault();break;case "mouseenter":a.target==this.parent.element&&(this.parent.onEnter.dispatch(),this.parent.onEnter.canceled&&a.cancelable&&a.preventDefault());break;case "mouseleave":a.target==this.parent.element&&
(this.parent.onLeave.dispatch(),this.parent.onLeave.canceled&&a.cancelable&&a.preventDefault());break;case "mousemove":if(c!=this.cacheMouseX||b!=this.cacheMouseY)this.parent.onMouseMove.dispatch(c,b),this.parent.onMouseMoveRelative.dispatch(c-this.cacheMouseX,b-this.cacheMouseY),(this.parent.onMouseMove.canceled||this.parent.onMouseMoveRelative.canceled)&&a.cancelable&&a.preventDefault();break;case "mouseup":window.removeEventListener("mouseup",p(this,this.handleMouseEvent)),a.currentTarget==this.parent.element&&
a.stopPropagation(),this.parent.onMouseUp.dispatch(c,b,a.button),this.parent.onMouseUp.canceled&&a.cancelable&&a.preventDefault()}this.cacheMouseX=c;this.cacheMouseY=b}else{switch(a.deltaMode){case 0:c=kc.PIXELS;break;case 1:c=kc.LINES;break;case 2:c=kc.PAGES;break;default:c=kc.UNKNOWN}this.parent.onMouseWheel.dispatch(a.deltaX,-a.deltaY,c);this.parent.onMouseWheel.canceled&&a.cancelable&&a.preventDefault()}},handleResizeEvent:function(a){this.primaryTouch=null;this.updateSize()},handleTouchEvent:function(a){a.cancelable&&
a.preventDefault();var b=null;null!=this.parent.element&&(b=null!=this.canvas?this.canvas.getBoundingClientRect():null!=this.div?this.div.getBoundingClientRect():this.parent.element.getBoundingClientRect());var c=this.setWidth,e=this.setHeight;if(0==c||0==e)null!=b?(c=b.width,e=b.height):e=c=1;for(var f,g,d,l,h,n=0,m=a.changedTouches;n<m.length;){var r=m[n];++n;null!=b?(g=c/b.width*(r.clientX-b.left),d=e/b.height*(r.clientY-b.top)):(g=r.clientX,d=r.clientY);if("touchstart"==a.type)f=this.unusedTouchesPool.pop(),
null==f?f=new Lb(g/c,d/e,r.identifier,0,0,r.force,this.parent.id):(f.x=g/c,f.y=d/e,f.id=r.identifier,f.dx=0,f.dy=0,f.pressure=r.force,f.device=this.parent.id),this.currentTouches.h[r.identifier]=f,Lb.onStart.dispatch(f),null==this.primaryTouch&&(this.primaryTouch=f),f==this.primaryTouch&&this.parent.onMouseDown.dispatch(g,d,0);else if(f=this.currentTouches.h[r.identifier],null!=f)switch(l=f.x,h=f.y,f.x=g/c,f.y=d/e,f.dx=f.x-l,f.dy=f.y-h,f.pressure=r.force,a.type){case "touchcancel":Lb.onCancel.dispatch(f);
this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(f);f==this.primaryTouch&&(this.primaryTouch=null);break;case "touchend":Lb.onEnd.dispatch(f);this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(f);f==this.primaryTouch&&(this.parent.onMouseUp.dispatch(g,d,0),this.primaryTouch=null);break;case "touchmove":Lb.onMove.dispatch(f),f==this.primaryTouch&&this.parent.onMouseMove.dispatch(g,d)}}},updateSize:function(){if(this.parent.__resizable){if(null!=this.parent.element){var a=
this.parent.element.clientWidth;var b=this.parent.element.clientHeight}else a=window.innerWidth,b=window.innerHeight;if(a!=this.cacheElementWidth||b!=this.cacheElementHeight){this.cacheElementWidth=a;this.cacheElementHeight=b;var c=this.resizeElement||0==this.setWidth&&0==this.setHeight;if(null!=this.parent.element&&(null==this.div||null!=this.div&&c))if(c){if(this.parent.__width!=a||this.parent.__height!=b)this.parent.__width=a,this.parent.__height=b,null!=this.canvas?this.parent.element!=this.canvas&&
(this.canvas.width=Math.round(a*this.scale),this.canvas.height=Math.round(b*this.scale),this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"):(this.div.style.width=a+"px",this.div.style.height=b+"px"),this.parent.onResize.dispatch(a,b)}else{c=0!=this.setWidth?a/this.setWidth:1;var e=0!=this.setHeight?b/this.setHeight:1,f=a,g=b,d=0,l=0;c<e?(g=Math.floor(this.setHeight*c),l=Math.floor((b-g)/2)):(f=Math.floor(this.setWidth*e),d=Math.floor((a-f)/2));null!=this.canvas?this.parent.element!=this.canvas&&
(this.canvas.style.width=f+"px",this.canvas.style.height=g+"px",this.canvas.style.marginLeft=d+"px",this.canvas.style.marginTop=l+"px"):(this.div.style.width=f+"px",this.div.style.height=g+"px",this.div.style.marginLeft=d+"px",this.div.style.marginTop=l+"px")}}}},__class__:sd};var nc=function(){};d["lime._internal.format.Base64"]=nc;nc.__name__=!0;nc.encode=function(a){var b=[],c=nc.DICTIONARY,e=nc.EXTENDED_DICTIONARY,f=a.length,g=Math.floor(f/3),d=2*g;b.length=2*Math.ceil(f/3);for(var l=0,h=0,n;h<
d;)n=a.b[l]<<16|a.b[l+1]<<8|a.b[l+2],b[h]=e[n>>12&4095],b[h+1]=e[n&4095],l+=3,h+=2;switch(f-3*g){case 1:n=a.b[l]<<16;b[h]=e[n>>12&4095];b[h+1]="==";break;case 2:n=a.b[l]<<16|a.b[l+1]<<8,b[h]=e[n>>12&4095],b[h+1]=c[n>>6&63]+"="}return b.join("")};var Qe=function(){};d["lime._internal.format.Deflate"]=Qe;Qe.__name__=!0;Qe.decompress=function(a){a=pako.inflateRaw(a.b.bufferValue);return Oa.ofData(a)};var Re=function(){};d["lime._internal.format.GZip"]=Re;Re.__name__=!0;Re.decompress=function(a){a=pako.ungzip(a.b.bufferValue);
return Oa.ofData(a)};var Se=function(){};d["lime._internal.format.LZMA"]=Se;Se.__name__=!0;Se.decompress=function(a){return null};var Te=function(){};d["lime._internal.format.Zlib"]=Te;Te.__name__=!0;Te.decompress=function(a){a=pako.inflate(a.b.bufferValue);return Oa.ofData(a)};var Eb=function(){};d["lime._internal.graphics.ImageCanvasUtil"]=Eb;Eb.__name__=!0;Eb.convertToCanvas=function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage?(null==c.__srcCanvas&&(Eb.createCanvas(a,c.__srcImage.width,
c.__srcImage.height),c.__srcContext.drawImage(c.__srcImage,0,0)),c.__srcImage=null):null==c.__srcCanvas&&null!=c.data?(a.set_transparent(!0),Eb.createCanvas(a,c.width,c.height),Eb.createImageData(a),c.__srcContext.putImageData(c.__srcImageData,0,0)):a.type==lc.DATA&&null!=c.__srcImageData&&a.dirty&&(c.__srcContext.putImageData(c.__srcImageData,0,0),a.dirty=!1);b?(c.data=null,c.__srcImageData=null):null==c.data&&null!=c.__srcImageData&&(c.data=c.__srcImageData.data);a.type=lc.CANVAS};Eb.convertToData=
function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage&&Eb.convertToCanvas(a);if(null!=c.__srcCanvas&&null==c.data)Eb.createImageData(a),a.type==lc.CANVAS&&(a.dirty=!1);else if(a.type==lc.CANVAS&&null!=c.__srcCanvas&&a.dirty){if(null==c.__srcImageData)Eb.createImageData(a);else{c.__srcImageData=c.__srcContext.getImageData(0,0,c.width,c.height);var e=c.__srcImageData.data.buffer;e=null!=e?new Uint8Array(e):null;c.data=e}a.dirty=!1}b&&(a.buffer.__srcCanvas=null,a.buffer.__srcContext=null);
a.type=lc.DATA};Eb.createCanvas=function(a,b,c){var e=a.buffer;null==e.__srcCanvas&&(e.__srcCanvas=window.document.createElement("canvas"),e.__srcCanvas.width=b,e.__srcCanvas.height=c,a.get_transparent()?e.__srcContext=e.__srcCanvas.getContext("2d"):(a.get_transparent()||e.__srcCanvas.setAttribute("moz-opaque","true"),e.__srcContext=e.__srcCanvas.getContext("2d",{alpha:!1})))};Eb.createImageData=function(a){a=a.buffer;if(null==a.__srcImageData){null==a.data?a.__srcImageData=a.__srcContext.getImageData(0,
0,a.width,a.height):(a.__srcImageData=a.__srcContext.createImageData(a.width,a.height),a.__srcImageData.data.set(a.data));var b=a.__srcImageData.data.buffer;b=null!=b?new Uint8Array(b):null;a.data=b}};Eb.fillRect=function(a,b,c,e){Eb.convertToCanvas(a);if(1==e){e=c>>16&255;var f=c>>8&255;var g=c&255;c=a.get_transparent()?c>>24&255:255}else e=c>>24&255,f=c>>16&255,g=c>>8&255,c=a.get_transparent()?c&255:255;0==b.x&&0==b.y&&b.width==a.width&&b.height==a.height&&a.get_transparent()&&0==c?a.buffer.__srcCanvas.width=
a.buffer.width:(255>c&&a.buffer.__srcContext.clearRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY),0<c&&(a.buffer.__srcContext.fillStyle="rgba("+e+", "+f+", "+g+", "+c/255+")",a.buffer.__srcContext.fillRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY)),a.dirty=!0,a.version++)};var Ue=function(){};d["lime._internal.graphics.ImageDataUtil"]=Ue;Ue.__name__=!0;Ue.fillRect=function(a,b,c,e){switch(e){case 1:c=(c>>>16&255)<<24|(c>>>8&255)<<16|(c&255)<<8|c>>>24&
255;break;case 2:c=(c>>>8&255)<<24|(c>>>16&255)<<16|(c>>>24&255)<<8|c&255}a.get_transparent()||(c=(c>>>24&255)<<24|(c>>>16&255)<<16|(c>>>8&255)<<8|255);var f=a.buffer.data;if(null!=f){e=a.buffer.format;var g=a.buffer.premultiplied;g&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Sb.a16=Sb.__alpha16[c&255],c=((c>>>24&255)*Sb.a16>>16&255)<<24|((c>>>16&255)*Sb.a16>>16&255)<<16|((c>>>8&255)*Sb.a16>>16&255)<<8|c&255));b=new re(a,b);for(var d,l=0,h=b.height;l<h;){g=l++;d=b.byteOffset+b.stride*g;for(var n=0,m=
b.width;n<m;){g=n++;var r=d+4*g,C=e;g=!1;null==g&&(g=!1);null==C&&(C=0);g&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Sb.a16=Sb.__alpha16[c&255],c=((c>>>24&255)*Sb.a16>>16&255)<<24|((c>>>16&255)*Sb.a16>>16&255)<<16|((c>>>8&255)*Sb.a16>>16&255)<<8|c&255));switch(C){case 0:f[r]=c>>>24&255;f[r+1]=c>>>16&255;f[r+2]=c>>>8&255;f[r+3]=c&255;break;case 1:f[r]=c&255;f[r+1]=c>>>24&255;f[r+2]=c>>>16&255;f[r+3]=c>>>8&255;break;case 2:f[r]=c>>>8&255,f[r+1]=c>>>16&255,f[r+2]=c>>>24&255,f[r+3]=c&255}}}a.dirty=!0;a.version++}};
var re=function(a,b){this.image=a;null==b?this.rect=a.get_rect():(0>b.x&&(b.x=0),0>b.y&&(b.y=0),b.x+b.width>a.width&&(b.width=a.width-b.x),b.y+b.height>a.height&&(b.height=a.height-b.y),0>b.width&&(b.width=0),0>b.height&&(b.height=0),this.rect=b);this.stride=a.buffer.get_stride();this.__update()};d["lime._internal.graphics._ImageDataUtil.ImageDataView"]=re;re.__name__=!0;re.prototype={__update:function(){this.x=Math.ceil(this.rect.x);this.y=Math.ceil(this.rect.y);this.width=Math.floor(this.rect.width);
this.height=Math.floor(this.rect.height);this.byteOffset=this.stride*(this.y+this.image.offsetY)+4*(this.x+this.image.offsetX)},__class__:re};var Ia=function(a,b){null==b&&(b=!1);if(null!=a)if(b)b=new Db,b.future=this,Kb.queue({promise:b,work:a});else try{this.value=a(),this.isComplete=!0}catch(c){oa.lastError=c,this.error=y.caught(c).unwrap(),this.isError=!0}};d["lime.app.Future"]=Ia;Ia.__name__=!0;Ia.withValue=function(a){var b=new Ia;b.isComplete=!0;b.value=a;return b};Ia.prototype={onComplete:function(a){null!=
a&&(this.isComplete?a(this.value):this.isError||(null==this.__completeListeners&&(this.__completeListeners=[]),this.__completeListeners.push(a)));return this},onError:function(a){null!=a&&(this.isError?a(this.error):this.isComplete||(null==this.__errorListeners&&(this.__errorListeners=[]),this.__errorListeners.push(a)));return this},onProgress:function(a){null!=a&&(null==this.__progressListeners&&(this.__progressListeners=[]),this.__progressListeners.push(a));return this},then:function(a){if(this.isComplete)return a(this.value);
if(this.isError){var b=new Ia;b.isError=!0;b.error=this.error;return b}var c=new Db;this.onError(p(c,c.error));this.onProgress(p(c,c.progress));this.onComplete(function(b){b=a(b);b.onError(p(c,c.error));b.onComplete(p(c,c.complete))});return c.future},__class__:Ia};var Kb=function(){};d["lime.app._Future.FutureWork"]=Kb;Kb.__name__=!0;Kb.queue=function(a){null==Kb.threadPool&&(Kb.threadPool=new se,Kb.threadPool.doWork.add(Kb.threadPool_doWork),Kb.threadPool.onComplete.add(Kb.threadPool_onComplete),
Kb.threadPool.onError.add(Kb.threadPool_onError));Kb.threadPool.queue(a)};Kb.threadPool_doWork=function(a){try{var b=a.work();Kb.threadPool.sendComplete({promise:a.promise,result:b})}catch(c){oa.lastError=c,b=y.caught(c).unwrap(),Kb.threadPool.sendError({promise:a.promise,error:b})}};Kb.threadPool_onComplete=function(a){a.promise.complete(a.result)};Kb.threadPool_onError=function(a){a.promise.error(a.error)};var Db=function(){this.future=new Ia};d["lime.app.Promise"]=Db;Db.__name__=!0;Db.prototype=
{complete:function(a){if(!this.future.isError&&(this.future.isComplete=!0,this.future.value=a,null!=this.future.__completeListeners)){for(var b=0,c=this.future.__completeListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__completeListeners=null}return this},completeWith:function(a){a.onComplete(p(this,this.complete));a.onError(p(this,this.error));a.onProgress(p(this,this.progress));return this},error:function(a){if(!this.future.isComplete&&(this.future.isError=!0,this.future.error=a,null!=this.future.__errorListeners)){for(var b=
0,c=this.future.__errorListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__errorListeners=null}return this},progress:function(a,b){if(!this.future.isError&&!this.future.isComplete&&null!=this.future.__progressListeners)for(var c=0,e=this.future.__progressListeners;c<e.length;){var f=e[c];++c;f(a,b)}return this},__class__:Db};var fc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Dynamic_Void"]=fc;fc.__name__=!0;fc.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:fc};var te=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Float_Void"]=te;te.__name__=!0;te.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,
b,c){this.canceled=!1;for(var e=this.__listeners,f=this.__repeat,g=0;g<e.length&&(e[g](a,b,c),f[g]?++g:this.remove(e[g]),!this.canceled););},__class__:te};var ue=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Int_Void"]=ue;ue.__name__=!0;ue.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,
0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,f=this.__repeat,g=0;g<e.length&&(e[g](a,b,c),f[g]?++g:this.remove(e[g]),!this.canceled););},__class__:ue};var Yc=function(){this.canceled=
!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Void"]=Yc;Yc.__name__=!0;Yc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:Yc};var ve=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_lime_ui_MouseButton_Void"]=ve;ve.__name__=!0;ve.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=
0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,
f=this.__repeat,g=0;g<e.length&&(e[g](a,b,c),f[g]?++g:this.remove(e[g]),!this.canceled););},__class__:ve};var we=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_lime_ui_MouseWheelMode_Void"]=we;we.__name__=!0;we.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,f=this.__repeat,g=0;g<e.length&&(e[g](a,b,c),f[g]?++g:this.remove(e[g]),!this.canceled););},__class__:we};var xe=function(){this.canceled=!1;this.__listeners=
[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Float_Float_Void"]=xe;xe.__name__=!0;xe.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:xe};var ye=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};d["lime.app._Event_Int_Float_Void"]=ye;ye.__name__=!0;ye.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:ye};var Gd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Int_Void"]=Gd;Gd.__name__=!0;Gd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>
this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?
++f:this.remove(c[f]),!this.canceled););},__class__:Gd};var Ac=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Void"]=Ac;Ac.__name__=!0;Ac.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},
remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Ac};var ze=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_lime_ui_JoystickHatPosition_Void"]=
ze;ze.__name__=!0;ze.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:ze};var Ae=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_String_Int_Int_Void"]=Ae;Ae.__name__=
!0;Ae.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:Ae};var ud=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_String_Void"]=ud;ud.__name__=!0;ud.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:ud};var Ra=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Void_Void"]=Ra;Ra.__name__=!0;Ra.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(){this.canceled=!1;for(var a=this.__listeners,b=this.__repeat,c=0;c<a.length&&(a[c](),b[c]?++c:this.remove(a[c]),!this.canceled););},__class__:Ra};var Vc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};d["lime.app._Event_lime_graphics_RenderContext_Void"]=Vc;Vc.__name__=!0;Vc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Vc};var Be=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_GamepadAxis_Float_Void"]=Be;Be.__name__=!0;Be.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=
this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=
this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:Be};var Hd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_GamepadButton_Void"]=Hd;Hd.__name__=!0;Hd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);
return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Hd};var Ce=function(){this.canceled=!1;this.__listeners=[];this.__priorities=
[];this.__repeat=[]};d["lime.app._Event_lime_ui_Gamepad_Void"]=Ce;Ce.__name__=!0;Ce.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Ce};var De=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Joystick_Void"]=De;De.__name__=!0;De.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<
f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&
(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:De};var Id=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_KeyCode_lime_ui_KeyModifier_Void"]=Id;Id.__name__=!0;Id.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,f=0;f<c.length&&(c[f](a,b),e[f]?++f:this.remove(c[f]),!this.canceled););},__class__:Id};var qc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=
[]};d["lime.app._Event_lime_ui_Touch_Void"]=qc;qc.__name__=!0;qc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,f=this.__priorities.length;e<f;){var g=e++;if(c>this.__priorities[g]){this.__listeners.splice(g,0,a);this.__priorities.splice(g,0,c);this.__repeat.splice(g,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:qc};var Td=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Window_Void"]=Td;Td.__name__=!0;Td.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)R.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Td};var Ka=function(a,b,c,e,f,g,d){null==f&&(f=-1);null==e&&(e=-1);null==c&&(c=0);null==b&&(b=0);this.offsetX=b;this.offsetY=c;this.width=e;this.height=f;this.version=0;null==d&&(d=lc.CANVAS);this.type=d;if(null==a){if(0<e&&0<f)switch(this.type._hx_index){case 0:this.buffer=new oc(null,
e,f);Eb.createCanvas(this,e,f);null!=g&&0!=g&&this.fillRect(new Zc(0,0,e,f),g);break;case 1:a=e*f*4,a=null!=a?new Uint8Array(a):null,this.buffer=new oc(a,e,f),null!=g&&0!=g&&this.fillRect(new Zc(0,0,e,f),g)}}else this.__fromImageBuffer(a)};d["lime.graphics.Image"]=Ka;Ka.__name__=!0;Ka.fromFile=function(a){if(null==a)return null;var b=new Ka;return b.__fromFile(a)?b:null};Ka.loadFromBytes=function(a){if(null==a)return Ia.withValue(null);if(Ka.__isPNG(a))var b="image/png";else if(Ka.__isJPG(a))b="image/jpeg";
else if(Ka.__isGIF(a))b="image/gif";else if(Ka.__isWebP(a))b="image/webp";else return Ia.withValue(null);return U.loadImageFromBytes(a,b)};Ka.loadFromFile=function(a){return null==a?Ia.withValue(null):U.loadImage(a)};Ka.__isGIF=function(a){if(null==a||6>a.length)return!1;a=a.getString(0,6);return"GIF87a"!=a?"GIF89a"==a:!0};Ka.__isJPG=function(a){return null==a||4>a.length?!1:255==a.b[0]&&216==a.b[1]&&255==a.b[a.length-2]?217==a.b[a.length-1]:!1};Ka.__isPNG=function(a){return null==a||8>a.length?!1:
137==a.b[0]&&80==a.b[1]&&78==a.b[2]&&71==a.b[3]&&13==a.b[4]&&10==a.b[5]&&26==a.b[6]?10==a.b[7]:!1};Ka.__isWebP=function(a){return null==a||16>a.length?!1:"RIFF"==a.getString(0,4)?"WEBP"==a.getString(8,4):!1};Ka.prototype={fillRect:function(a,b,c){a=this.__clipRect(a);if(null!=this.buffer&&null!=a)switch(this.type._hx_index){case 0:Eb.fillRect(this,a,b,c);break;case 1:Eb.convertToData(this);if(0==this.buffer.data.length)break;Ue.fillRect(this,a,b,c);break;case 2:a.offset(this.offsetX,this.offsetY);
if(null==c)b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255;else switch(c){case 1:break;case 2:b=(b&255)<<24|(b>>>8&255)<<16|(b>>>16&255)<<8|b>>>24&255;break;default:b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255}this.buffer.__srcBitmapData.fillRect(a.__toFlashRectangle(),b)}},__clipRect:function(a){return null==a||0>a.x&&(a.width-=-a.x,a.x=0,0>=a.x+a.width)||0>a.y&&(a.height-=-a.y,a.y=0,0>=a.y+a.height)||a.x+a.width>=this.width&&(a.width-=a.x+a.width-this.width,0>=a.width)||a.y+
a.height>=this.height&&(a.height-=a.y+a.height-this.height,0>=a.height)?null:a},__fromBase64:function(a,b,c){var e=this,f=new Image;f.addEventListener("load",function(a){e.buffer=new oc(null,f.width,f.height);e.buffer.__srcImage=f;e.offsetX=0;e.offsetY=0;e.width=e.buffer.width;e.height=e.buffer.height;null!=c&&c(e)},!1);f.src="data:"+b+";base64,"+a},__fromBytes:function(a,b){if(Ka.__isPNG(a))var c="image/png";else if(Ka.__isJPG(a))c="image/jpeg";else if(Ka.__isGIF(a))c="image/gif";else return!1;this.__fromBase64(nc.encode(a),
c,b);return!0},__fromFile:function(a,b,c){var e=this,f=new Image;U.__isSameOrigin(a)||(f.crossOrigin="Anonymous");f.onload=function(a){e.buffer=new oc(null,f.width,f.height);e.buffer.__srcImage=f;e.width=f.width;e.height=f.height;null!=b&&b(e)};f.onerror=function(a){null!=c&&c()};f.src=a;return!0},__fromImageBuffer:function(a){this.buffer=a;null!=a&&(-1==this.width&&(this.width=a.width),-1==this.height&&(this.height=a.height))},get_data:function(){null==this.buffer.data&&0<this.buffer.width&&0<this.buffer.height&&
Eb.convertToData(this);return this.buffer.data},get_rect:function(){return new Zc(0,0,this.width,this.height)},get_transparent:function(){return null==this.buffer?!1:this.buffer.transparent},set_transparent:function(a){return null==this.buffer?!1:this.buffer.transparent=a},__class__:Ka,__properties__:{set_transparent:"set_transparent",get_transparent:"get_transparent",get_rect:"get_rect",get_data:"get_data"}};var oc=function(a,b,c,e,f){null==e&&(e=32);null==c&&(c=0);null==b&&(b=0);this.data=a;this.width=
b;this.height=c;this.bitsPerPixel=e;this.format=null==f?0:f;this.premultiplied=!1;this.transparent=!0};d["lime.graphics.ImageBuffer"]=oc;oc.__name__=!0;oc.prototype={get_stride:function(){return this.width*(this.bitsPerPixel/8|0)},__class__:oc,__properties__:{get_stride:"get_stride"}};var lc=w["lime.graphics.ImageType"]={__ename__:!0,__constructs__:null,CANVAS:{_hx_name:"CANVAS",_hx_index:0,__enum__:"lime.graphics.ImageType",toString:h},DATA:{_hx_name:"DATA",_hx_index:1,__enum__:"lime.graphics.ImageType",
toString:h},FLASH:{_hx_name:"FLASH",_hx_index:2,__enum__:"lime.graphics.ImageType",toString:h},CUSTOM:{_hx_name:"CUSTOM",_hx_index:3,__enum__:"lime.graphics.ImageType",toString:h}};lc.__constructs__=[lc.CANVAS,lc.DATA,lc.FLASH,lc.CUSTOM];var qe=function(){};d["lime.graphics.RenderContext"]=qe;qe.__name__=!0;qe.prototype={__class__:qe};var hf={fromWebGL2RenderContext:function(a){return a}},td=function(){};d["lime.graphics.opengl.GL"]=td;td.__name__=!0;var Sb={},Zc=function(a,b,c,e){null==e&&(e=0);
null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.width=c;this.height=e};d["lime.math.Rectangle"]=Zc;Zc.__name__=!0;Zc.prototype={offset:function(a,b){this.x+=a;this.y+=b},__toFlashRectangle:function(){return null},__class__:Zc};var gb=function(){};d["lime.media.AudioBuffer"]=gb;gb.__name__=!0;gb.fromBytes=function(a){if(null==a)return null;var b=new gb;b.set_src(new Howl({src:["data:"+gb.__getCodec(a)+";base64,"+nc.encode(a)],html5:!0,preload:!1}));return b};gb.fromFile=function(a){if(null==
a)return null;var b=new gb;b.__srcHowl=new Howl({src:[a],preload:!1});return b};gb.fromFiles=function(a){var b=new gb;b.__srcHowl=new Howl({src:a,preload:!1});return b};gb.loadFromFile=function(a){var b=new Db,c=gb.fromFile(a);null!=c?null!=c&&(c.__srcHowl.on("load",function(){b.complete(c)}),c.__srcHowl.on("loaderror",function(a,c){b.error(c)}),c.__srcHowl.load()):b.error(null);return b.future};gb.loadFromFiles=function(a){var b=new Db,c=gb.fromFiles(a);null!=c?(c.__srcHowl.on("load",function(){b.complete(c)}),
c.__srcHowl.on("loaderror",function(){b.error(null)}),c.__srcHowl.load()):b.error(null);return b.future};gb.__getCodec=function(a){switch(a.getString(0,4)){case "OggS":return"audio/ogg";case "RIFF":if("WAVE"==a.getString(8,4))return"audio/wav";var b=a.b[1],c=a.b[2];switch(a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}break;case "fLaC":return"audio/flac";default:switch(b=a.b[1],c=a.b[2],a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";
break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}}va.error("Unsupported sound format",{fileName:"lime/media/AudioBuffer.hx",lineNumber:362,className:"lime.media.AudioBuffer",methodName:"__getCodec"});return null};gb.prototype={set_src:function(a){return this.__srcHowl=a},__class__:gb,__properties__:{set_src:"set_src"}};var Fe=function(a){if("custom"!=a){if(null==a||"web"==a)try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.web=new window.AudioContext,
this.type="web"}catch(b){oa.lastError=b}null==this.web&&"web"!=a&&(this.html5=new Ee,this.type="html5")}else this.type="custom"};d["lime.media.AudioContext"]=Fe;Fe.__name__=!0;Fe.prototype={__class__:Fe};var Gc=function(){};d["lime.media.AudioManager"]=Gc;Gc.__name__=!0;Gc.init=function(a){if(null==Gc.context){if(null==a&&(Gc.context=new Fe,a=Gc.context,"openal"==a.type)){var b=a.openal,c=b.openDevice();c=b.createContext(c);b.makeContextCurrent(c);b.processContext(c)}Gc.context=a}};var Ee=function(){};
d["lime.media.HTML5AudioContext"]=Ee;Ee.__name__=!0;Ee.prototype={__class__:Ee};var Ve=function(){};d["lime.media.OpenALAudioContext"]=Ve;Ve.__name__=!0;Ve.prototype={createContext:function(a,b){return Yb.createContext(a,b)},makeContextCurrent:function(a){return Yb.makeContextCurrent(a)},openDevice:function(a){return Yb.openDevice(a)},processContext:function(a){Yb.processContext(a)},__class__:Ve};var Yb=function(){};d["lime.media.openal.ALC"]=Yb;Yb.__name__=!0;Yb.createContext=function(a,b){return null};
Yb.makeContextCurrent=function(a){return!1};Yb.openDevice=function(a){return null};Yb.processContext=function(a){};var bd=function(){};d["lime.net._IHTTPRequest"]=bd;bd.__name__=!0;bd.__isInterface__=!0;bd.prototype={__class__:bd};var gc=function(a){this.uri=a;this.contentType="application/x-www-form-urlencoded";this.followRedirects=!0;this.enableResponseHeaders=!1;this.formData=new S;this.headers=[];this.method="GET";this.timeout=3E4;this.withCredentials=!1;this.__backend=new U;this.__backend.init(this)};
d["lime.net._HTTPRequest.AbstractHTTPRequest"]=gc;gc.__name__=!0;gc.__interfaces__=[bd];gc.prototype={__class__:gc};var Dc=function(a){gc.call(this,a)};d["lime.net._HTTPRequest_Bytes"]=Dc;Dc.__name__=!0;Dc.__super__=gc;Dc.prototype=u(gc.prototype,{fromBytes:function(a){return a},load:function(a){var b=this;null!=a&&(this.uri=a);var c=new Db;a=this.__backend.loadData(this.uri);a.onProgress(p(c,c.progress));a.onError(p(c,c.error));a.onComplete(function(a){b.responseData=b.fromBytes(a);c.complete(b.responseData)});
return c.future},__class__:Dc});var vd=function(a){gc.call(this,a)};d["lime.net._HTTPRequest_String"]=vd;vd.__name__=!0;vd.__super__=gc;vd.prototype=u(gc.prototype,{load:function(a){var b=this;null!=a&&(this.uri=a);var c=new Db;a=this.__backend.loadText(this.uri);a.onProgress(p(c,c.progress));a.onError(p(c,c.error));a.onComplete(function(a){b.responseData=a;c.complete(b.responseData)});return c.future},__class__:vd});var pe=function(a,b){null==b&&(b="");this.name=a;this.value=b};d["lime.net.HTTPRequestHeader"]=
pe;pe.__name__=!0;pe.prototype={__class__:pe};var wd=function(a){gc.call(this,a)};d["lime.net._HTTPRequest_lime_utils_Bytes"]=wd;wd.__name__=!0;wd.__super__=Dc;wd.prototype=u(Dc.prototype,{fromBytes:function(a){return hc.fromBytes(a)},__class__:wd});var pc=function(a,b){this.onUpdate=new te;this.type=a;this.id=b};d["lime.system.Sensor"]=pc;pc.__name__=!0;pc.registerSensor=function(a,b){a=new pc(a,b);pc.sensors.push(a);return pc.sensorByID.h[b]=a};pc.prototype={__class__:pc};var Xe=w["lime.system.SensorType"]=
{__ename__:!0,__constructs__:null,ACCELEROMETER:{_hx_name:"ACCELEROMETER",_hx_index:0,__enum__:"lime.system.SensorType",toString:h}};Xe.__constructs__=[Xe.ACCELEROMETER];var Ub=function(){};d["lime.system.System"]=Ub;Ub.__name__=!0;Ub.embed=k.lime.embed=function(a,b,c,e,f){if(null!=Ub.__applicationEntryPoint&&Object.prototype.hasOwnProperty.call(Ub.__applicationEntryPoint.h,a)){var g="string"==typeof b?window.document.getElementById(b):null==b?window.document.createElement("div"):b;null==g?window.console.log("[lime.embed] ERROR: Cannot find target element: "+
E.string(b)):(null==c&&(c=0),null==e&&(e=0),null==f&&(f={}),Object.prototype.hasOwnProperty.call(f,"background")&&"string"==typeof f.background&&(b=za.replace(E.string(f.background),"#",""),-1<b.indexOf("0x")?f.background=E.parseInt(b):f.background=E.parseInt("0x"+b)),f.element=g,f.width=c,f.height=e,Ub.__applicationEntryPoint.h[a](f))}};Ub.exit=function(a){};Ub.__registerEntryPoint=function(a,b){null==Ub.__applicationEntryPoint&&(Ub.__applicationEntryPoint=new S);Ub.__applicationEntryPoint.h[a]=
b};var se=function(a,b){null==b&&(b=1);null==a&&(a=0);this.onRun=new fc;this.onError=new fc;this.onComplete=new fc;this.doWork=new fc;this.minThreads=a;this.maxThreads=b;this.currentThreads=0};d["lime.system.ThreadPool"]=se;se.__name__=!0;se.prototype={queue:function(a){this.runWork(a)},sendComplete:function(a){this.onComplete.dispatch(a)},sendError:function(a){this.onError.dispatch(a)},runWork:function(a){this.onRun.dispatch(a);this.doWork.dispatch(a)},__class__:se};var sb=function(a){null!=a&&(this.name=
a);this.__init||(void 0==this.ascender&&(this.ascender=0),void 0==this.descender&&(this.descender=0),void 0==this.height&&(this.height=0),void 0==this.numGlyphs&&(this.numGlyphs=0),void 0==this.underlinePosition&&(this.underlinePosition=0),void 0==this.underlineThickness&&(this.underlineThickness=0),void 0==this.unitsPerEM&&(this.unitsPerEM=0),null!=this.__fontID?Y.isLocal(this.__fontID)&&this.__fromBytes(Y.getBytes(this.__fontID)):null!=this.__fontPath&&this.__fromFile(this.__fontPath))};d["lime.text.Font"]=
sb;sb.__name__=!0;sb.fromFile=function(a){if(null==a)return null;var b=new sb;b.__fromFile(a);return b};sb.loadFromName=function(a){return(new sb).__loadFromName(a)};sb.__measureFontNode=function(a){var b=window.document.createElement("span");b.setAttribute("aria-hidden","true");var c=window.document.createTextNode("BESbswy");b.appendChild(c);c=b.style;c.display="block";c.position="absolute";c.top="-9999px";c.left="-9999px";c.fontSize="300px";c.width="auto";c.height="auto";c.lineHeight="normal";c.margin=
"0";c.padding="0";c.fontVariant="normal";c.whiteSpace="nowrap";c.fontFamily=a;window.document.body.appendChild(b);return b};sb.prototype={__fromBytes:function(a){this.__fontPath=null},__fromFile:function(a){this.__fontPath=a},__loadFromName:function(a){var b=this,c=new Db;this.name=a;var e=v.navigator.userAgent.toLowerCase(),f=0<=e.indexOf(" safari/")&&0>e.indexOf(" chrome/");e=(new Ca("(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)","i")).match(e);if(!f&&!e&&window.document.fonts&&(m=window.document.fonts,
p(m,m.load)))window.document.fonts.load("1em '"+a+"'").then(function(a){c.complete(b)},function(e){va.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",lineNumber:513,className:"lime.text.Font",methodName:"__loadFromName"});c.complete(b)});else{var g=sb.__measureFontNode("'"+a+"', sans-serif"),d=sb.__measureFontNode("'"+a+"', serif"),l=g.offsetWidth,h=d.offsetWidth,n=-1,C=0,r,q;n=window.setInterval(function(){C+=1;r=g.offsetWidth!=l||d.offsetWidth!=h;q=3E3<=50*C;if(r||q)window.clearInterval(n),
g.parentNode.removeChild(g),d.parentNode.removeChild(d),d=g=null,q&&va.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",lineNumber:548,className:"lime.text.Font",methodName:"__loadFromName"}),c.complete(b)},50)}return c.future},__class__:sb};var bb=function(a){this.onDisconnect=new Ra;this.onButtonUp=new Hd;this.onButtonDown=new Hd;this.onAxisMove=new Be;this.id=a;this.connected=!0};d["lime.ui.Gamepad"]=bb;bb.__name__=!0;bb.__connect=function(a){if(!bb.devices.h.hasOwnProperty(a)){var b=
new bb(a);bb.devices.h[a]=b;bb.onConnect.dispatch(b)}};bb.__disconnect=function(a){var b=bb.devices.h[a];null!=b&&(b.connected=!1);bb.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};bb.prototype={__class__:bb};var $a=function(a){this.onTrackballMove=new xe;this.onHatMove=new ze;this.onDisconnect=new Ra;this.onButtonUp=new Ac;this.onButtonDown=new Ac;this.onAxisMove=new ye;this.id=a;this.connected=!0};d["lime.ui.Joystick"]=$a;$a.__name__=!0;$a.__connect=function(a){if(!$a.devices.h.hasOwnProperty(a)){var b=
new $a(a);$a.devices.h[a]=b;$a.onConnect.dispatch(b)}};$a.__disconnect=function(a){var b=$a.devices.h[a];null!=b&&(b.connected=!1);$a.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};$a.__getDeviceData=function(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():null};$a.prototype={__class__:$a};var Rb=w["lime.ui.MouseCursor"]={__ename__:!0,__constructs__:null,ARROW:{_hx_name:"ARROW",_hx_index:0,__enum__:"lime.ui.MouseCursor",toString:h},
CROSSHAIR:{_hx_name:"CROSSHAIR",_hx_index:1,__enum__:"lime.ui.MouseCursor",toString:h},DEFAULT:{_hx_name:"DEFAULT",_hx_index:2,__enum__:"lime.ui.MouseCursor",toString:h},MOVE:{_hx_name:"MOVE",_hx_index:3,__enum__:"lime.ui.MouseCursor",toString:h},POINTER:{_hx_name:"POINTER",_hx_index:4,__enum__:"lime.ui.MouseCursor",toString:h},RESIZE_NESW:{_hx_name:"RESIZE_NESW",_hx_index:5,__enum__:"lime.ui.MouseCursor",toString:h},RESIZE_NS:{_hx_name:"RESIZE_NS",_hx_index:6,__enum__:"lime.ui.MouseCursor",toString:h},
RESIZE_NWSE:{_hx_name:"RESIZE_NWSE",_hx_index:7,__enum__:"lime.ui.MouseCursor",toString:h},RESIZE_WE:{_hx_name:"RESIZE_WE",_hx_index:8,__enum__:"lime.ui.MouseCursor",toString:h},TEXT:{_hx_name:"TEXT",_hx_index:9,__enum__:"lime.ui.MouseCursor",toString:h},WAIT:{_hx_name:"WAIT",_hx_index:10,__enum__:"lime.ui.MouseCursor",toString:h},WAIT_ARROW:{_hx_name:"WAIT_ARROW",_hx_index:11,__enum__:"lime.ui.MouseCursor",toString:h},CUSTOM:{_hx_name:"CUSTOM",_hx_index:12,__enum__:"lime.ui.MouseCursor",toString:h}};
Rb.__constructs__=[Rb.ARROW,Rb.CROSSHAIR,Rb.DEFAULT,Rb.MOVE,Rb.POINTER,Rb.RESIZE_NESW,Rb.RESIZE_NS,Rb.RESIZE_NWSE,Rb.RESIZE_WE,Rb.TEXT,Rb.WAIT,Rb.WAIT_ARROW,Rb.CUSTOM];var kc=w["lime.ui.MouseWheelMode"]={__ename__:!0,__constructs__:null,PIXELS:{_hx_name:"PIXELS",_hx_index:0,__enum__:"lime.ui.MouseWheelMode",toString:h},LINES:{_hx_name:"LINES",_hx_index:1,__enum__:"lime.ui.MouseWheelMode",toString:h},PAGES:{_hx_name:"PAGES",_hx_index:2,__enum__:"lime.ui.MouseWheelMode",toString:h},UNKNOWN:{_hx_name:"UNKNOWN",
_hx_index:3,__enum__:"lime.ui.MouseWheelMode",toString:h}};kc.__constructs__=[kc.PIXELS,kc.LINES,kc.PAGES,kc.UNKNOWN];var Lb=function(a,b,c,e,f,g,d){this.x=a;this.y=b;this.id=c;this.dx=e;this.dy=f;this.pressure=g;this.device=d};d["lime.ui.Touch"]=Lb;Lb.__name__=!0;Lb.prototype={__class__:Lb};var Vd=function(a,b){this.onTextInput=new ud;this.onTextEdit=new Ae;this.onRestore=new Ra;this.onResize=new Gd;this.onRenderContextRestored=new Vc;this.onRenderContextLost=new Ra;this.onRender=new Vc;this.onMove=
new Yc;this.onMouseWheel=new we;this.onMouseUp=new ue;this.onMouseMoveRelative=new Yc;this.onMouseMove=new Yc;this.onMouseDown=new ve;this.onMinimize=new Ra;this.onLeave=new Ra;this.onKeyUp=new Id;this.onKeyDown=new Id;this.onFullscreen=new Ra;this.onFocusOut=new Ra;this.onFocusIn=new Ra;this.onExpose=new Ra;this.onEnter=new Ra;this.onDropFile=new ud;this.onDeactivate=new Ra;this.onClose=new Ra;this.onActivate=new Ra;this.application=a;this.__attributes=null!=b?b:{};Object.prototype.hasOwnProperty.call(this.__attributes,
"parameters")&&(this.parameters=this.__attributes.parameters);this.__height=this.__width=0;this.__fullscreen=!1;this.__scale=1;this.__y=this.__x=0;this.__title="";this.id=-1;this.__backend=new sd(this)};d["lime.ui.Window"]=Vd;Vd.__name__=!0;Vd.prototype={close:function(){this.__backend.close()},__class__:Vd};var bc=function(){this.data=new S;this.paths=[]};d["lime.utils.AssetBundle"]=bc;bc.__name__=!0;bc.fromBytes=function(a){a=new qd(a);return bc.__extractBundle(a)};bc.loadFromBytes=function(a){return Ia.withValue(bc.fromBytes(a))};
bc.loadFromFile=function(a){return hc.loadFromFile(a).then(bc.loadFromBytes)};bc.__extractBundle=function(a){var b=rd.readZip(a);a=new bc;for(b=b.h;null!=b;){var c=b.item;b=b.next;if(c.compressed){var e=a.data,f=c.fileName,g=hc.decompress(c.data,xd.DEFLATE);e.h[f]=g}else a.data.h[c.fileName]=c.data;a.paths.push(c.fileName)}return a};bc.prototype={__class__:bc};var Ge=function(){this.enabled=!0;this.audio=new S;this.font=new S;this.image=new S;this.version=961655};d["lime.utils.AssetCache"]=Ge;Ge.__name__=
!0;Ge.prototype={exists:function(a,b){return("IMAGE"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.image.h,a)||("FONT"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.font.h,a)||("SOUND"==b||"MUSIC"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.audio.h,a)?!0:!1},set:function(a,b,c){switch(b){case "FONT":this.font.h[a]=c;break;case "IMAGE":if(!(c instanceof Ka))throw y.thrown("Cannot cache non-Image asset: "+E.string(c)+" as Image");this.image.h[a]=c;break;case "MUSIC":case "SOUND":if(!(c instanceof
gb))throw y.thrown("Cannot cache non-AudioBuffer asset: "+E.string(c)+" as AudioBuffer");this.audio.h[a]=c;break;default:throw y.thrown(b+" assets are not cachable");}},clear:function(a){if(null==a)this.audio=new S,this.font=new S,this.image=new S;else{var b=this.audio.h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var f=b[e++];if(za.startsWith(f,a)){var g=this.audio;Object.prototype.hasOwnProperty.call(g.h,f)&&delete g.h[f]}}b=this.font.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)f=b[e++],za.startsWith(f,
a)&&(g=this.font,Object.prototype.hasOwnProperty.call(g.h,f)&&delete g.h[f]);b=this.image.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)f=b[e++],za.startsWith(f,a)&&(g=this.image,Object.prototype.hasOwnProperty.call(g.h,f)&&delete g.h[f])}},__class__:Ge};var Pb=function(){this.types=new S;this.sizes=new S;this.preload=new S;this.paths=new S;this.pathGroups=new S;this.classTypes=new S;this.cachedText=new S;this.cachedImages=new S;this.cachedFonts=new S;this.cachedBytes=new S;this.cachedAudioBuffers=new S;
this.onChange=new Ra;this.bytesTotal=this.bytesLoaded=0};d["lime.utils.AssetLibrary"]=Pb;Pb.__name__=!0;Pb.fromBundle=function(a){if(Object.prototype.hasOwnProperty.call(a.data.h,"library.json")){var b=Ab.fromBytes(a.data.h["library.json"]);if(null!=b){if(null==b.libraryType)var c=new Pb;else if(c=d[b.libraryType],null!=c)c=Ja.createInstance(c,b.libraryArgs);else return va.warn("Could not find library type: "+b.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:122,className:"lime.utils.AssetLibrary",
methodName:"fromBundle"}),null;c.__fromBundle(a,b);return c}}else return c=new Pb,c.__fromBundle(a),c;return null};Pb.fromManifest=function(a){if(null==a)return null;if(null==a.libraryType)var b=new Pb;else if(b=d[a.libraryType],null!=b)b=Ja.createInstance(b,a.libraryArgs);else return va.warn("Could not find library type: "+a.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:160,className:"lime.utils.AssetLibrary",methodName:"fromManifest"}),null;b.__fromManifest(a);return b};Pb.prototype=
{exists:function(a,b){b=null!=b?xa.__cast(b,String):null;a=this.types.h[a];return null==a||a!=b&&("SOUND"!=b&&"MUSIC"!=b||"MUSIC"!=a&&"SOUND"!=a)&&"BINARY"!=b&&null!=b&&("BINARY"!=a||"TEXT"!=b)?!1:!0},getAsset:function(a,b){switch(b){case "BINARY":return this.getBytes(a);case "FONT":return this.getFont(a);case "IMAGE":return this.getImage(a);case "MUSIC":case "SOUND":return this.getAudioBuffer(a);case "TEMPLATE":throw y.thrown("Not sure how to get template: "+a);case "TEXT":return this.getText(a);
default:throw y.thrown("Unknown asset type: "+b);}},getAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?this.cachedAudioBuffers.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?gb.fromBytes(xa.__cast(Ja.createInstance(this.classTypes.h[a],[]),Oa)):gb.fromFile(this.paths.h[a])},getBytes:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a))return this.cachedBytes.h[a];if(Object.prototype.hasOwnProperty.call(this.cachedText.h,
a)){var b=hc.ofString(this.cachedText.h[a]);return this.cachedBytes.h[a]=b}return Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?xa.__cast(Ja.createInstance(this.classTypes.h[a],[]),Oa):hc.fromFile(this.paths.h[a])},getFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?this.cachedFonts.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?xa.__cast(Ja.createInstance(this.classTypes.h[a],[]),sb):sb.fromFile(this.paths.h[a])},getImage:function(a){return Object.prototype.hasOwnProperty.call(this.cachedImages.h,
a)?this.cachedImages.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?xa.__cast(Ja.createInstance(this.classTypes.h[a],[]),Ka):Ka.fromFile(this.paths.h[a])},getText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return this.cachedText.h[a];a=this.getBytes(a);return null==a?null:a.getString(0,a.length)},isLocal:function(a,b){if(Object.prototype.hasOwnProperty.call(this.classTypes.h,a))return!0;b=null!=b?xa.__cast(b,String):null;if(null==b)return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,
a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a);switch(b){case "FONT":return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a);case "IMAGE":return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a);case "MUSIC":case "SOUND":return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a);default:return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a)}},load:function(){if(this.loaded)return Ia.withValue(this);
if(null==this.promise){this.promise=new Db;this.bytesLoadedCache=new S;this.assetsLoaded=0;this.assetsTotal=1;for(var a=Object.keys(this.preload.h),b=a.length,c=0;c<b;){var e=a[c++];if(this.preload.h[e]){va.verbose("Preloading asset: "+e+" ["+this.types.h[e]+"]",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:405,className:"lime.utils.AssetLibrary",methodName:"load"});var f=this.types.h[e];if(null!=f)switch(f){case "BINARY":this.assetsTotal++;f=this.loadBytes(e);f.onProgress(function(a,b){return function(c,
e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.load_onError)]));f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadBytes_onComplete)]));break;case "FONT":this.assetsTotal++;f=this.loadFont(e);f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.load_onError)]));
f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadFont_onComplete)]));break;case "IMAGE":this.assetsTotal++;f=this.loadImage(e);f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.load_onError)]));f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadImage_onComplete)]));break;case "MUSIC":case "SOUND":this.assetsTotal++;
f=this.loadAudioBuffer(e);f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)]));f.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadAudioBuffer_onError)]));f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadAudioBuffer_onComplete)]));break;case "TEXT":this.assetsTotal++,f=this.loadText(e),f.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)])),f.onError(function(a,
b){return function(c){b[0](a[0],c)}}([e],[p(this,this.load_onError)])),f.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadText_onComplete)]))}}}this.__assetLoaded(null)}return this.promise.future},loadAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?Ia.withValue(this.cachedAudioBuffers.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ia.withValue(Ja.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.pathGroups.h,
a)?gb.loadFromFiles(this.pathGroups.h[a]):gb.loadFromFile(this.paths.h[a])},loadBytes:function(a){return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ia.withValue(this.cachedBytes.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ia.withValue(Ja.createInstance(this.classTypes.h[a],[])):hc.loadFromFile(this.paths.h[a])},loadFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?Ia.withValue(this.cachedFonts.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,
a)?(a=Ja.createInstance(this.classTypes.h[a],[]),a.__loadFromName(a.name)):sb.loadFromName(this.paths.h[a])},loadImage:function(a){var b=this;return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a)?Ia.withValue(this.cachedImages.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ia.withValue(Ja.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ka.loadFromBytes(this.cachedBytes.h[a]).then(function(c){var e=b.cachedBytes;Object.prototype.hasOwnProperty.call(e.h,
a)&&delete e.h[a];b.cachedImages.h[a]=c;return Ia.withValue(c)}):Ka.loadFromFile(this.paths.h[a])},loadText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return Ia.withValue(this.cachedText.h[a]);if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)||Object.prototype.hasOwnProperty.call(this.classTypes.h,a)){var b=this.getBytes(a);if(null==b)return Ia.withValue(null);b=b.getString(0,b.length);this.cachedText.h[a]=b;return Ia.withValue(b)}return(new vd).load(this.paths.h[a])},
unload:function(){},__assetLoaded:function(a){this.assetsLoaded++;null!=a&&va.verbose("Loaded asset: "+a+" ["+this.types.h[a]+"] ("+(this.assetsLoaded-1)+"/"+(this.assetsTotal-1)+")",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:619,className:"lime.utils.AssetLibrary",methodName:"__assetLoaded"});if(null!=a){var b=Object.prototype.hasOwnProperty.call(this.sizes.h,a)?this.sizes.h[a]:0;if(Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)){var c=this.bytesLoadedCache.h[a];c<b&&(this.bytesLoaded+=
b-c)}else this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b}this.assetsLoaded<this.assetsTotal?this.promise.progress(this.bytesLoaded,this.bytesTotal):(this.loaded=!0,this.promise.progress(this.bytesTotal,this.bytesTotal),this.promise.complete(this))},__cacheBreak:function(a){return Y.__cacheBreak(a)},__fromBundle:function(a,b){if(null!=b){var c=0;for(b=b.assets;c<b.length;){var e=b[c];++c;var f=Object.prototype.hasOwnProperty.call(e,"id")?e.id:e.path;var g=a.data.h[e.path];if(Object.prototype.hasOwnProperty.call(e,
"type")){var d=e.type;"TEXT"==d?this.cachedText.h[f]=null!=g?E.string(g):null:this.cachedBytes.h[f]=g;this.types.h[f]=e.type}else this.cachedBytes.h[f]=g,this.types.h[f]="BINARY"}}else for(c=0,b=a.paths;c<b.length;)f=b[c],++c,this.cachedBytes.h[f]=a.data.h[f],this.types.h[f]="BINARY"},__fromManifest:function(a){var b=2<=a.version,c=a.rootPath;null==c&&(c="");""!=c&&(c+="/");for(var e=0,f=a.assets;e<f.length;){var g=f[e];++e;var h=b&&Object.prototype.hasOwnProperty.call(g,"size")?g.size:100;var l=
Object.prototype.hasOwnProperty.call(g,"id")?g.id:g.path;if(Object.prototype.hasOwnProperty.call(g,"path")){var n=this.paths;var m=this.__cacheBreak(this.__resolvePath(c+E.string(R.field(g,"path"))));n.h[l]=m}if(Object.prototype.hasOwnProperty.call(g,"pathGroup")){n=R.field(g,"pathGroup");m=0;for(var C=n.length;m<C;){var r=m++;n[r]=this.__cacheBreak(this.__resolvePath(c+n[r]))}this.pathGroups.h[l]=n}this.sizes.h[l]=h;this.types.h[l]=g.type;Object.prototype.hasOwnProperty.call(g,"preload")&&(this.preload.h[l]=
R.field(g,"preload"));Object.prototype.hasOwnProperty.call(g,"className")&&(h=R.field(g,"className"),h=d[h],this.classTypes.h[l]=h)}e=this.bytesTotal=0;for(f=a.assets;e<f.length;)g=f[e],++e,l=Object.prototype.hasOwnProperty.call(g,"id")?g.id:g.path,Object.prototype.hasOwnProperty.call(this.preload.h,l)&&this.preload.h[l]&&Object.prototype.hasOwnProperty.call(this.sizes.h,l)&&(this.bytesTotal+=this.sizes.h[l])},__resolvePath:function(a){a=za.replace(a,"\\","/");var b=a.indexOf(":");za.startsWith(a,
"http")&&0<b?(b+=3,a=K.substr(a,0,b)+za.replace(K.substr(a,b,null),"//","/")):a=za.replace(a,"//","/");if(-1<a.indexOf("./")){a=a.split("/");b=[];for(var c=0,e=a.length;c<e;){var f=c++;".."==a[f]?0==f||".."==b[f-1]?b.push(".."):b.pop():"."==a[f]?0==f&&b.push("."):b.push(a[f])}a=b.join("/")}return a},loadAudioBuffer_onComplete:function(a,b){this.cachedAudioBuffers.h[a]=b;if(Object.prototype.hasOwnProperty.call(this.pathGroups.h,a))for(var c=this.pathGroups.h[a],e=Object.keys(this.pathGroups.h),f=e.length,
g=0;g<f;){var d=e[g++];if(d!=a)for(var l=0;l<c.length;){var h=c[l];++l;if(-1<this.pathGroups.h[d].indexOf(h)){this.cachedAudioBuffers.h[d]=b;break}}}this.__assetLoaded(a)},loadAudioBuffer_onError:function(a,b){null!=b&&""!=b?va.warn('Could not load "'+a+'": '+E.string(b),{fileName:"lime/utils/AssetLibrary.hx",lineNumber:865,className:"lime.utils.AssetLibrary",methodName:"loadAudioBuffer_onError"}):va.warn('Could not load "'+a+'"',{fileName:"lime/utils/AssetLibrary.hx",lineNumber:869,className:"lime.utils.AssetLibrary",
methodName:"loadAudioBuffer_onError"});this.loadAudioBuffer_onComplete(a,new gb)},loadBytes_onComplete:function(a,b){this.cachedBytes.h[a]=b;this.__assetLoaded(a)},loadFont_onComplete:function(a,b){this.cachedFonts.h[a]=b;this.__assetLoaded(a)},loadImage_onComplete:function(a,b){this.cachedImages.h[a]=b;this.__assetLoaded(a)},loadText_onComplete:function(a,b){this.cachedText.h[a]=b;this.__assetLoaded(a)},load_onError:function(a,b){null!=b&&""!=b?this.promise.error('Error loading asset "'+a+'": '+
E.string(b)):this.promise.error('Error loading asset "'+a+'"')},load_onProgress:function(a,b,c){if(0<b){var e=this.sizes.h[a];0<c?(b/=c,1<b&&(b=1),b=Math.floor(b*e)):b>e&&(b=e);Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)?(e=this.bytesLoadedCache.h[a],b!=e&&(this.bytesLoaded+=b-e)):this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b;this.promise.progress(this.bytesLoaded,this.bytesTotal)}},__class__:Pb};var Ab=function(){this.assets=[];this.libraryArgs=[];this.version=2};d["lime.utils.AssetManifest"]=
Ab;Ab.__name__=!0;Ab.fromBytes=function(a,b){return null!=a?Ab.parse(a.getString(0,a.length),b):null};Ab.loadFromFile=function(a,b){a=Ab.__resolvePath(a);b=Ab.__resolveRootPath(b,a);return null==a?null:hc.loadFromFile(a).then(function(a){return Ia.withValue(Ab.fromBytes(a,b))})};Ab.parse=function(a,b){if(null==a||""==a)return null;a=JSON.parse(a);var c=new Ab;Object.prototype.hasOwnProperty.call(a,"name")&&(c.name=a.name);Object.prototype.hasOwnProperty.call(a,"libraryType")&&(c.libraryType=a.libraryType);
Object.prototype.hasOwnProperty.call(a,"libraryArgs")&&(c.libraryArgs=a.libraryArgs);if(Object.prototype.hasOwnProperty.call(a,"assets")){var e=a.assets;Object.prototype.hasOwnProperty.call(a,"version")&&2>=a.version?c.assets=Jb.run(e):c.assets=e}Object.prototype.hasOwnProperty.call(a,"rootPath")&&(c.rootPath=a.rootPath);null!=b&&""!=b&&(c.rootPath=null==c.rootPath||""==c.rootPath?b:b+"/"+c.rootPath);return c};Ab.__resolvePath=function(a){if(null==a)return null;var b=a.indexOf("?");var c=-1<b?K.substr(a,
0,b):a;for(c=za.replace(c,"\\","/");za.endsWith(c,"/");)c=K.substr(c,0,c.length-1);return za.endsWith(c,".bundle")?-1<b?c+"/library.json"+K.substr(a,b,null):c+"/library.json":a};Ab.__resolveRootPath=function(a,b){if(null!=a)return a;a=b.indexOf("?");a=-1<a?K.substr(b,0,a):b;for(a=za.replace(a,"\\","/");za.endsWith(a,"/");){if("/"==a)return a;a=K.substr(a,0,a.length-1)}return za.endsWith(a,".bundle")?a:jc.directory(a)};Ab.prototype={__class__:Ab};var Y=function(){};d["lime.utils.Assets"]=Y;Y.__name__=
!0;Y.getAsset=function(a,b,c){if(c&&Y.cache.enabled)switch(b){case "BINARY":case "TEXT":c=!1;break;case "FONT":var e=Y.cache.font.h[a];if(null!=e)return e;break;case "IMAGE":e=Y.cache.image.h[a];if(Y.isValidImage(e))return e;break;case "MUSIC":case "SOUND":e=Y.cache.audio.h[a];if(Y.isValidAudio(e))return e;break;case "TEMPLATE":throw y.thrown("Not sure how to get template: "+a);default:return null}var f=a.indexOf(":");e=a.substring(0,f);f=a.substring(f+1);var g=Y.getLibrary(e);if(null!=g)if(g.exists(f,
b)){if(g.isLocal(f,b))return e=g.getAsset(f,b),c&&Y.cache.enabled&&Y.cache.set(a,b,e),e;va.error(b+' asset "'+a+'" exists, but only asynchronously',{fileName:"lime/utils/Assets.hx",lineNumber:133,className:"lime.utils.Assets",methodName:"getAsset"})}else va.error("There is no "+b+' asset with an ID of "'+a+'"',{fileName:"lime/utils/Assets.hx",lineNumber:138,className:"lime.utils.Assets",methodName:"getAsset"});else va.error(Y.__libraryNotFound(e),{fileName:"lime/utils/Assets.hx",lineNumber:143,className:"lime.utils.Assets",
methodName:"getAsset"});return null};Y.getBytes=function(a){return Y.getAsset(a,"BINARY",!1)};Y.getLibrary=function(a){if(null==a||""==a)a="default";return Y.libraries.h[a]};Y.isLocal=function(a,b,c){null==c&&(c=!0);if(c&&Y.cache.enabled&&Y.cache.exists(a,b))return!0;var e=a.indexOf(":");c=a.substring(0,e);a=a.substring(e+1);c=Y.getLibrary(c);return null!=c?c.isLocal(a,b):!1};Y.isValidAudio=function(a){return null!=a};Y.isValidImage=function(a){return null!=a?null!=a.buffer:!1};Y.loadLibrary=function(a){var b=
new Db,c=Y.getLibrary(a);if(null!=c)return c.load();c=a;var e=null;if(Object.prototype.hasOwnProperty.call(Y.bundlePaths.h,a))bc.loadFromFile(Y.bundlePaths.h[a]).onComplete(function(c){null==c?b.error('Cannot load bundle for library "'+a+'"'):(c=Pb.fromBundle(c),null==c?b.error('Cannot open library "'+a+'"'):(Y.libraries.h[a]=c,c.onChange.add((m=Y.onChange,p(m,m.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+a+'"')});else Object.prototype.hasOwnProperty.call(Y.libraryPaths.h,
a)?(c=Y.libraryPaths.h[a],e=jc.directory(c)):(za.endsWith(c,".bundle")?(e=c,c+="/library.json"):e=jc.directory(c),c=Y.__cacheBreak(c)),Ab.loadFromFile(c,e).onComplete(function(c){null==c?b.error('Cannot parse asset manifest for library "'+a+'"'):(c=Pb.fromManifest(c),null==c?b.error('Cannot open library "'+a+'"'):(Y.libraries.h[a]=c,c.onChange.add((m=Y.onChange,p(m,m.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+a+'"')});return b.future};
Y.registerLibrary=function(a,b){if(Object.prototype.hasOwnProperty.call(Y.libraries.h,a)){if(Y.libraries.h[a]==b)return;Y.unloadLibrary(a)}null!=b&&b.onChange.add(Y.library_onChange);Y.libraries.h[a]=b};Y.unloadLibrary=function(a){if(null==a||""==a)a="default";var b=Y.libraries.h[a];null!=b&&(Y.cache.clear(a+":"),b.onChange.remove(Y.library_onChange),b.unload());b=Y.libraries;Object.prototype.hasOwnProperty.call(b.h,a)&&delete b.h[a]};Y.__cacheBreak=function(a){0<Y.cache.version&&(a=-1<a.indexOf("?")?
a+("&"+Y.cache.version):a+("?"+Y.cache.version));return a};Y.__libraryNotFound=function(a){if(null==a||""==a)a="default";return null==fa.current||null==fa.current.__preloader||fa.current.__preloader.complete?'There is no asset library named "'+a+'"':'There is no asset library named "'+a+'", or it is not yet preloaded'};Y.library_onChange=function(){Y.cache.clear();Y.onChange.dispatch()};var hc={_new:function(a,b){return new Oa(b)},decompress:function(a,b){switch(b._hx_index){case 0:return Qe.decompress(a);
case 1:return Re.decompress(a);case 2:return Se.decompress(a);case 3:return Te.decompress(a)}},fromBytes:function(a){return null==a?null:hc._new(a.length,a.b.bufferValue)},fromFile:function(a){return null},loadFromFile:function(a){return(new wd).load(a)},ofString:function(a){a=Oa.ofString(a);return hc._new(a.length,a.b.bufferValue)}},xd=w["lime.utils.CompressionAlgorithm"]={__ename__:!0,__constructs__:null,DEFLATE:{_hx_name:"DEFLATE",_hx_index:0,__enum__:"lime.utils.CompressionAlgorithm",toString:h},
GZIP:{_hx_name:"GZIP",_hx_index:1,__enum__:"lime.utils.CompressionAlgorithm",toString:h},LZMA:{_hx_name:"LZMA",_hx_index:2,__enum__:"lime.utils.CompressionAlgorithm",toString:h},ZLIB:{_hx_name:"ZLIB",_hx_index:3,__enum__:"lime.utils.CompressionAlgorithm",toString:h}};xd.__constructs__=[xd.DEFLATE,xd.GZIP,xd.LZMA,xd.ZLIB];var va=function(){};d["lime.utils.Log"]=va;va.__name__=!0;va.error=function(a,b){if(1<=va.level){a="["+b.className+"] ERROR: "+E.string(a);if(va.throwErrors)throw y.thrown(a);console.error(a)}};
va.verbose=function(a,b){5<=va.level&&(a="["+b.className+"] "+E.string(a),console.log(a))};va.warn=function(a,b){2<=va.level&&console.warn("["+b.className+"] WARNING: "+E.string(a))};var Ud=function(){this.bytesTotalCache=new S;this.bytesLoadedCache2=new S;this.bytesLoadedCache=new zb;this.onProgress=new Gd;this.onComplete=new Ra;this.bytesTotal=this.bytesLoaded=0;this.libraries=[];this.libraryNames=[];this.onProgress.add(p(this,this.update))};d["lime.utils.Preloader"]=Ud;Ud.__name__=!0;Ud.prototype=
{addLibrary:function(a){this.libraries.push(a)},addLibraryName:function(a){-1==this.libraryNames.indexOf(a)&&this.libraryNames.push(a)},load:function(){for(var a=this,b=0,c=this.libraries;b<c.length;){var e=c[b];++b;this.bytesTotal+=e.bytesTotal}this.loadedLibraries=-1;this.preloadStarted=!1;b=0;for(c=this.libraries;b<c.length;)e=[c[b]],++b,va.verbose("Preloading asset library",{fileName:"lime/utils/Preloader.hx",lineNumber:132,className:"lime.utils.Preloader",methodName:"load"}),e[0].load().onProgress(function(b){return function(c,
e){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+c:a.bytesLoaded+(c-a.bytesLoadedCache.h[b[0].__id__]);a.bytesLoadedCache.set(b[0],c);a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal)}}(e)).onComplete(function(b){return function(c){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+b[0].bytesTotal:a.bytesLoaded+(b[0].bytesTotal-a.bytesLoadedCache.h[b[0].__id__]);a.loadedAssetLibrary()}}(e)).onError(function(){return function(a){va.error(a,
{fileName:"lime/utils/Preloader.hx",lineNumber:168,className:"lime.utils.Preloader",methodName:"load"})}}());b=0;for(c=this.libraryNames;b<c.length;)++b,this.bytesTotal+=200;this.loadedLibraries++;this.preloadStarted=!0;this.updateProgress()},loadedAssetLibrary:function(a){this.loadedLibraries++;var b=this.loadedLibraries;this.preloadStarted||++b;var c=this.libraries.length+this.libraryNames.length;null!=a?va.verbose("Loaded asset library: "+a+" ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",
lineNumber:195,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"}):va.verbose("Loaded asset library ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",lineNumber:199,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"});this.updateProgress()},start:function(){this.complete||this.simulateProgress||!this.preloadComplete||(this.complete=!0,this.onComplete.dispatch())},update:function(a,b){},updateProgress:function(){var a=this;this.simulateProgress||this.onProgress.dispatch(this.bytesLoaded,
this.bytesTotal);if(this.loadedLibraries==this.libraries.length&&!this.initLibraryNames){this.initLibraryNames=!0;for(var b=0,c=this.libraryNames;b<c.length;){var e=[c[b]];++b;va.verbose("Preloading asset library: "+e[0],{fileName:"lime/utils/Preloader.hx",lineNumber:236,className:"lime.utils.Preloader",methodName:"updateProgress"});Y.loadLibrary(e[0]).onProgress(function(b){return function(c,e){0<e&&(Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])||(a.bytesTotalCache.h[b[0]]=e,a.bytesTotal+=
e-200),c>e&&(c=e),Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:a.bytesLoaded+=c,a.bytesLoadedCache2.h[b[0]]=c,a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal))}}(e)).onComplete(function(b){return function(c){c=200;Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])&&(c=a.bytesTotalCache.h[b[0]]);Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:
a.bytesLoaded+=c;a.loadedAssetLibrary(b[0])}}(e)).onError(function(){return function(a){va.error(a,{fileName:"lime/utils/Preloader.hx",lineNumber:290,className:"lime.utils.Preloader",methodName:"updateProgress"})}}())}}this.simulateProgress||this.loadedLibraries!=this.libraries.length+this.libraryNames.length||(this.preloadComplete||(this.preloadComplete=!0,va.verbose("Preload complete",{fileName:"lime/utils/Preloader.hx",lineNumber:301,className:"lime.utils.Preloader",methodName:"updateProgress"})),
this.start())},__class__:Ud};var fe=function(a,b){this.drawNeedsUpdate=!1;this.totalTicksPassed=this.elapsedMsSinceLastTick=0;this.isUpdating=!1;this.window=a;this.config=null!=b?b:{framesPerSecond:60,drawOnlyWhenRequested:!1};this.setTickDuration(Math.floor(1E3/this.config.framesPerSecond));this.loop=new yd;this.loop.onInit(this)};d["ob.gum.Gum"]=fe;fe.__name__=!0;fe.prototype={setTickDuration:function(a){this.tickDurationMs=a},toggleUpdate:function(a){this.isUpdating=null!=a?a:!this.isUpdating},
changeLoop:function(a){this.loop=a;this.loop.onInit(this)},onUpdate:function(a){this.isUpdating&&(this.loop.onUpdate(a),this.elapsedMsSinceLastTick+=a,this.elapsedMsSinceLastTick>=this.tickDurationMs&&(this.elapsedMsSinceLastTick=0,this.totalTicksPassed++,this.drawNeedsUpdate=this.loop.onTick(a)),!this.config.drawOnlyWhenRequested||this.drawNeedsUpdate)&&(this.loop.onDraw(a),this.drawNeedsUpdate=!1)},onKeyDown:function(a,b){this.loop.onKeyDown(a,b)},onKeyUp:function(a,b){this.loop.onKeyUp(a,b)},onMouseMove:function(a,
b){this.loop.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.loop.onMouseDown(a,b,c)},onMouseUp:function(a,b,c){this.loop.onMouseUp(a,b,c)},onMouseScroll:function(a,b,c){this.loop.onMouseScroll(a,b,c)},onWindowResize:function(a,b){this.loop.onWindowResize(a,b)},__class__:fe};var yd=function(){};d["ob.gum.LoadingLoop"]=yd;yd.__name__=!0;yd.__interfaces__=[ma];yd.prototype={onTick:function(a){return!1},onInit:function(a){this.gum=a;ja.trace("LoadingLoop onInit",{fileName:"ob/gum/Core.hx",lineNumber:136,
className:"ob.gum.LoadingLoop",methodName:"onInit"})},onUpdate:function(a){},onDraw:function(a){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){},__class__:yd};var tc=function(){};d["ob.gum.backends.PaletteExtensions"]=tc;tc.__name__=!0;tc.toRGBA=function(a){for(var b=[],c=0;c<a.length;){var e=a[c];++c;b.push(tc.RGBA(e))}return b};tc.RGBA=function(a,
b){null==b&&(b=255);return a<<8|b};tc.changeAlpha=function(a,b){return(a&-16777216)>>24<<24|(a&16711680)>>16<<16|(a&65280)>>8<<8|b};var he=function(a){this.imageCache=[];this.fontCache=[];this.paths=a};d["ob.gum.backends.Assets"]=he;he.__name__=!0;he.prototype={Preload:function(a){ja.trace("begin loading "+E.string(this.paths),{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:141,className:"ob.gum.backends.Assets",methodName:"Preload"});this.onReady=a;this.loadFonts()},loadFonts:function(a){null==
a&&(a=0);var b=this;if(a>this.paths.fonts.length-1)this.loadImages();else{var c=this.paths.fonts[a];ja.trace("loading font index "+a+" "+c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:153,className:"ob.gum.backends.Assets",methodName:"loadFonts"});(new He(c)).load(function(c){b.fontCache.push(c);a+=1;b.loadFonts(a)})}},loadImages:function(){var a,b=this;ja.trace("load images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:163,className:"ob.gum.backends.Assets",methodName:"loadImages"});
var c=!1;if(0>=this.paths.images.length)ja.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:166,className:"ob.gum.backends.Assets",methodName:"loadImages"}),this.onReady();else{ja.trace("loading "+this.paths.images.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:169,className:"ob.gum.backends.Assets",methodName:"loadImages"});var e=this.paths.images,f=c,g=function(a,c){ja.trace(c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:172,className:"ob.gum.backends.Assets",
methodName:"loadImages"});ja.trace("starting without images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:173,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()},d=function(a){b.imageCache=a;ja.trace("loaded "+b.imageCache.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:177,className:"ob.gum.backends.Assets",methodName:"loadImages"});ja.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:178,className:"ob.gum.backends.Assets",
methodName:"loadImages"});b.onReady()};null==f&&(f=!1);var l=[],h=e.length;var n=0;for(a=e.length;n<a;){var m=[n++];var r=[e[m[0]]];c=f;var C=null==g?null:function(a){return function(b){g(a[0],b)}}(m);m=null==d?null:function(a){return function(b){l[a[0]]=b;0==--h&&d(l)}}(m);null==c&&(c=!1);""!=eb.corsServer&&(new Ca("^https?://","")).match(r[0])&&(r[0]="//"+eb.corsServer+"/"+r[0]);var q=Ka.loadFromFile(r[0]);c&&(ja.trace('Start loading image "'+r[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",
methodName:"image"}),q.onProgress(function(a){return function(b,c){eb.onProgressDebug(b,c,a[0])}}(r)),q.onError(eb.onErrorDebug),q.onComplete(function(a){return function(b){eb.onCompleteDebug(a[0])}}(r)));if(null!=C)q.onError(C);if(null!=m)q.onComplete(m)}}},__class__:he};var Ie=function(){this.weight=.5;this.zIndex=this.tilt=0;this.width=this.height=16;this.bgColor=255;this.color=-855703297};d["ob.gum.backends.FontStyle"]=Ie;Ie.__name__=!0;Ie.prototype={__class__:Ie};var La=function(){};d["peote.text.BackgroundElement"]=
La;La.__name__=!0;var de=function(){};d["peote.text.FontConfig"]=de;de.__name__=!0;de.prototype={__class__:de};var rc=function(a){this.uniformFloats=[];this.hasFragmentInjection=this.ready=!1;this.fragmentFloatPrecision=null;this.formulaHasChanged=!1;this.formula=new S;this.colorFormula="";this.used_by_ColorFormula=this.usedID_by_ColorFormula=0;this.textureID_Defaults=[];this.customTextureIdentifiers=[];this.activeUnits=[];this.activeTextures=[];this.textureLayers=new Gb;this.textureListPicking=new Jd(new zb);
this.textureList=new Jd(new zb);this.glShaderConfig={isPICKING:!1,isES3:!1,isINSTANCED:!1,isUBO:!1,IN:"attribute",VARIN:"varying",VAROUT:"varying",hasTEXTURES:!1,hasTEXTURE_FUNCTIONS:!1,hasFRAGMENT_INJECTION:!1,FRAGMENT_PROGRAM_UNIFORMS:"",FRAGMENT_CALC_LAYER:"",TEXTURES:[],TEXTURE_DEFAULTS:[],isDISCARD:!0,DISCARD:"0.0",isPIXELSNAPPING:!1,PIXELDIVISOR:"1.0",VERTEX_FLOAT_PRECISION:null,VERTEX_INT_PRECISION:null,VERTEX_SAMPLER_PRECISION:null,FRAGMENT_FLOAT_PRECISION:null,FRAGMENT_INT_PRECISION:null,
FRAGMENT_SAMPLER_PRECISION:null,VERTEX_INJECTION:"",FRAGMENT_INJECTION:"",SIZE_FORMULA:null,POS_FORMULA:null,ROTZ_FORMULA:null,PIVOT_FORMULA:null,FORMULA_VARYINGS:{},FORMULA_CONSTANTS:{},FRAGMENT_EXTENSIONS:[]};this.gl=this.glProgram=this.glProgramPicking=this.glVertexShader=this.glFragmentShader=this.glVertexShaderPicking=this.glFragmentShaderPicking=null;this.displays=[];this.autoUpdateTextures=this.isVisible=!0;this.clearMask=!1;this.mask=0;this.colorEnabled=!0;this.buffer=a;this.alphaEnabled=
a.hasAlpha();this.zIndexEnabled=a.hasZindex();this.colorIdentifiers=a.getColorIdentifiers();this.customIdentifiers=a.getCustomIdentifiers();this.customVaryings=a.getCustomVaryings();this.textureIdentifiers=a.getTextureIdentifiers();this.defaultColorFormula=a.getDefaultColorFormula();this.defaultFormulaVars=a.getDefaultFormulaVars();var b=a.getFormulas().h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var f=b[e++],g=this.formula,d=a.getFormulas().h[f];g.h[f]=d}try{xc.resolveFormulaCyclic(a.getFormulas())}catch(l){throw oa.lastError=
l,a=y.caught(l).unwrap(),y.thrown('Error: cyclic reference of "'+E.string(a.errVar)+'" inside @formula "'+E.string(a.formula)+'" for "'+E.string(a.errKey)+'"');}xc.resolveFormulaVars(a.getFormulas(),a.getAttributes());this.parseColorFormula()};d["peote.view.Program"]=rc;rc.__name__=!0;rc.prototype={addToDisplay:function(a,b,c){null==c&&(c=!1);if(0>this.displays.indexOf(a)){this.displays.push(a);var e=a.gl;if(null!=e&&e!=this.gl){for(var f=0,g=this.displays;f<g.length;){var d=g[f];++f;if(null!=d.gl&&
d.gl!=e)throw y.thrown("Error, program can not used inside different gl-contexts");}null!=this.gl&&(this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)));this.gl=e;X.isES3&&(this.glShaderConfig.isES3=!0,this.glShaderConfig.IN="in",this.glShaderConfig.VARIN=
"in",this.glShaderConfig.VAROUT="out");X.isUBO&&(this.glShaderConfig.isUBO=!0);X.isINSTANCED&&(this.glShaderConfig.isINSTANCED=!0);this.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=this.gl.getExtension("OES_standard_derivatives")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=this.gl.getExtension("EXT_color_buffer_float")?this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):null!=this.gl.getExtension("OES_texture_float")&&
this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});this.buffer.setNewGLContext(this.gl);this.createProg();this.buffer.hasPicking()&&this.createProg(!0);f=0;for(g=this.activeTextures;f<g.length;){var l=g[f];++f;e=this.gl;if(null!=e&&e!=l.gl){d=0;for(var h=l.programs;d<h.length;){var n=h[d];++d;if(null!=n.gl&&n.gl!=e)throw y.thrown("Error, texture can not used inside different gl-contexts");}h=0;for(n=l.displays;h<n.length;)if(d=n[h],++h,null!=d.gl&&d.gl!=e)throw y.thrown("Error, texture can not used inside different gl-contexts");
null!=l.gl&&(l.gl.deleteTexture(l.glTexture),l.glTexture=null,0==l.displays.length&&null!=l.framebuffer&&(l.gl.deleteFramebuffer(l.framebuffer),l.framebuffer=null,null!=l.glDepthBuffer&&l.gl.deleteRenderbuffer(l.glDepthBuffer),l.glDepthBuffer=null));l.gl=e;if(l.width>l.gl.getParameter(l.gl.MAX_TEXTURE_SIZE)||l.height>l.gl.getParameter(l.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");l.glTexture=Fb.createEmptyTexture(l.gl,l.width,l.height,l.colorChannels,
l.createMipmaps,l.magFilter,l.minFilter,l.useFloat);if(0<l.displays.length&&null==l.framebuffer){l.glDepthBuffer=l.gl.createRenderbuffer();e=l.gl;d=l.glTexture;h=l.glDepthBuffer;n=l.width;var m=l.height,r=e.createFramebuffer();e.bindRenderbuffer(e.RENDERBUFFER,h);hb.clearGlErrorQueue(e);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT24,n,m);hb.getLastGlError(e)==e.INVALID_ENUM&&(ja.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",
methodName:"createFramebuffer"}),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n,m));e.bindFramebuffer(e.FRAMEBUFFER,r);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,h);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,d,0);if(e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");e.bindFramebuffer(e.FRAMEBUFFER,null);e.bindRenderbuffer(e.RENDERBUFFER,null);l.framebuffer=r;l.updated=
!0}for(e=l.images.keys();e.hasNext();)d=e.next(),l.bufferImage(d,l.images.h[d.__id__])}}}}a.programList.add(this,b,c)},createProg:function(a){null==a&&(a=!1);this.glShaderConfig.isPICKING=a;if(null!=this.fragmentFloatPrecision)this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=this.fragmentFloatPrecision;else if(this.buffer.needFragmentPrecision()&&23>ib.FragmentFloat.medium){var b=ib.FragmentFloat;this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.high?"highp":0<b.medium?"mediump":0<b.low?"lowp":null}else b=
ib.FragmentFloat,this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.medium?"mediump":0<b.low?"lowp":null;this.parseAndResolveFormulas();var c=this.gl,e=this.gl.VERTEX_SHADER,f=this.buffer.getVertexShader(),g=this.glShaderConfig;f=new Fa(f);var d=hb.rStartspaces,l=hb.rEmptylines;g=f.execute(g).replace(l.r,"\n").replace(d.r,"");f=c.createShader(e);c.shaderSource(f,g);c.compileShader(f);if(0==c.getShaderParameter(f,c.COMPILE_STATUS))throw y.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+
" shader\n"+E.string(c.getShaderInfoLog(f)));b=f;c=this.gl;e=this.gl.FRAGMENT_SHADER;f=this.buffer.getFragmentShader();g=this.glShaderConfig;f=new Fa(f);d=hb.rStartspaces;l=hb.rEmptylines;g=f.execute(g).replace(l.r,"\n").replace(d.r,"");f=c.createShader(e);c.shaderSource(f,g);c.compileShader(f);if(0==c.getShaderParameter(f,c.COMPILE_STATUS))throw y.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+E.string(c.getShaderInfoLog(f)));e=f;g=this.gl.createProgram();this.gl.attachShader(g,
b);this.gl.attachShader(g,e);this.buffer.bindAttribLocations(this.gl,g);c=this.gl;c.linkProgram(g);if(0==c.getProgramParameter(g,c.LINK_STATUS))throw y.thrown(E.string(c.getProgramInfoLog(g))+"VALIDATE_STATUS: "+E.string(c.getProgramParameter(g,c.VALIDATE_STATUS))+"ERROR: "+E.string(c.getError()));!a&&X.isUBO?(c=this.gl.getUniformBlockIndex(g,"uboView"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(g,c,0),c=this.gl.getUniformBlockIndex(g,"uboDisplay"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(g,
c,1)):a?(this.uRESOLUTION_PICK=this.gl.getUniformLocation(g,"uResolution"),this.uZOOM_PICK=this.gl.getUniformLocation(g,"uZoom"),this.uOFFSET_PICK=this.gl.getUniformLocation(g,"uOffset")):(this.uRESOLUTION=this.gl.getUniformLocation(g,"uResolution"),this.uZOOM=this.gl.getUniformLocation(g,"uZoom"),this.uOFFSET=this.gl.getUniformLocation(g,"uOffset"));if(a)for(this.uTIME_PICK=this.gl.getUniformLocation(g,"uTime"),this.uniformFloatPickLocations=[],c=0,f=this.uniformFloats;c<f.length;)d=f[c],++c,this.uniformFloatPickLocations.push(this.gl.getUniformLocation(g,
d.name));else for(this.uTIME=this.gl.getUniformLocation(g,"uTime"),this.uniformFloatLocations=[],c=0,f=this.uniformFloats;c<f.length;)d=f[c],++c,this.uniformFloatLocations.push(this.gl.getUniformLocation(g,d.name));if(a){this.textureListPicking.clear();c=0;for(f=this.activeTextures.length;c<f;)a=c++,this.textureListPicking.add(new Kd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(g,"uTexture"+a)),null,!1);this.glProgramPicking=g;this.glVertexShaderPicking=b;this.glFragmentShaderPicking=
e}else{this.textureList.clear();c=0;for(f=this.activeTextures.length;c<f;)a=c++,this.textureList.add(new Kd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(g,"uTexture"+a)),null,!1);this.glProgram=g;this.glVertexShader=b;this.glFragmentShader=e}this.ready=!0},parseColorFormula:function(){var a="";if(""!=this.colorFormula)a=this.colorFormula;else if(""!=this.defaultColorFormula)a=this.defaultColorFormula;else{for(var b=this.colorIdentifiers.slice(),c=[],e=0,f=this.textureIdentifiers.length;e<
f;){var g=e++;this.textureLayers.h.hasOwnProperty(g)&&c.push(this.textureIdentifiers[g])}e=0;for(f=this.customTextureIdentifiers.length;e<f;)g=e++,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+g)&&c.push(this.customTextureIdentifiers[g]);if(0==b.length+c.length){var d=-16776961;c=""+E.string((d>>24&255)/255);var l=""+E.string((d>>16&255)/255),h=""+E.string((d>>8&255)/255);d=""+E.string((d&255)/255);a="vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||
-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")}else{0<c.length&&(a=c.shift(),0<b.length&&(a=""+b.shift()+" * "+a));for(e=0;e<c.length;)l=c[e],++e,0<b.length&&(l=""+b.shift()+" * "+l+" "),a="mix( "+a+", "+l+", ("+l+").a )";for(;0<b.length;)a+=(""!=a?"*":"")+b.shift(),0<b.length&&(a="("+a+" + "+b.shift()+")")}}e=0;for(f=this.colorIdentifiers.length;e<f;)g=e++,b=new Ca("(^|.*?[^\\w.])"+this.colorIdentifiers[g]+
"\\b.*?","g"),b.match(a)&&(a=a.replace(b.r,"$1c"+g));e=0;for(f=this.customIdentifiers.length;e<f;)if(g=e++,b=new Ca("(^|.*?[^\\w.])"+this.customIdentifiers[g]+"\\b.*?","g"),b.match(a))if(null!=this.customVaryings[g])a=a.replace(b.r,"$1"+this.customVaryings[g]);else throw y.thrown("Error while parsing ColorFormula: custom identifier "+this.customIdentifiers[g]+" need @varying to access in fragmentshader");this.textureID_Defaults=[];e=this.usedID_by_ColorFormula=this.used_by_ColorFormula=0;for(f=this.textureIdentifiers.length;e<
f;)g=e++,b=new Ca("(^|.*?[^\\w.])"+this.textureIdentifiers[g]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(g)&&(a=a.replace(b.r,"$1t"+g)),this.used_by_ColorFormula|=1<<g),b=new Ca("(^|.*?[^\\w.])"+(this.textureIdentifiers[g]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+g),this.usedID_by_ColorFormula|=1<<g,this.textureLayers.h.hasOwnProperty(g)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[g]],c=""+E.string((d>>24&255)/255),l=""+E.string((d>>16&255)/255),h=""+E.string((d>>
8&255)/255),d=""+E.string((d&255)/255),this.textureID_Defaults.push({layer:g,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")})));e=0;for(f=this.customTextureIdentifiers.length;e<f;)g=e++,b=new Ca("(^|.*?[^\\w.])"+this.customTextureIdentifiers[g]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+
g)&&(a=a.replace(b.r,"$1t"+(this.textureIdentifiers.length+g))),this.used_by_ColorFormula|=1<<this.textureIdentifiers.length+g),b=new Ca("(^|.*?[^\\w.])"+(this.customTextureIdentifiers[g]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+(this.textureIdentifiers.length+g)),this.usedID_by_ColorFormula|=1<<this.textureIdentifiers.length+g,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+g)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[this.textureIdentifiers.length+g]],c=
""+E.string((d>>24&255)/255),l=""+E.string((d>>16&255)/255),h=""+E.string((d>>8&255)/255),d=""+E.string((d&255)/255),this.textureID_Defaults.push({layer:this.textureIdentifiers.length+g,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")})));e=Object.keys(this.defaultFormulaVars.h);f=e.length;for(g=0;g<f;)c=e[g++],
b=new Ca("(^|.*?[^\\w.])"+c+"\\b.*?","g"),b.match(a)&&(d=this.defaultFormulaVars.h[c],c=""+E.string((d>>24&255)/255),l=""+E.string((d>>16&255)/255),h=""+E.string((d>>8&255)/255),d=""+E.string((d&255)/255),a=a.replace(b.r,"$1vec4("+((-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0")+", "+((-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")"))));this.glShaderConfig.FRAGMENT_CALC_LAYER=a},
setColorFormula:function(a,b,c){null==a&&(a="");this.colorFormula=a;if(null!=b){a=Object.keys(b.h);for(var e=a.length,f=0;f<e;){var g=a[f++];if(!(new Ca("^([a-zA-z_]+\\d*)+$","g")).match(g))throw y.thrown('Error: "'+g+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');this.defaultFormulaVars.h[g]=b.h[g]}}null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},setFormula:function(a,b,c){var e=this.buffer.getFormulaNames().h[a];if(null!=
e)ja.trace("  set formula: "+e+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:514,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[e]=b;else{e=[];var f=this.buffer.getFormulaNames().h;f=Object.keys(f);for(var g=f.length,d=0;d<g;){var l=f[d++];e.push(this.buffer.getFormulaNames().h[l])}if(0<=e.indexOf(a))this.formula.h[a]=b;else if(0<=this.buffer.getFormulaVaryings().indexOf(a))ja.trace("  set formula for varying: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:522,
className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[a]=b;else if(0<=this.buffer.getFormulaConstants().indexOf(a))ja.trace("  set formula for constant: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:526,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[a]=b;else if(0<=this.buffer.getFormulaCustoms().indexOf(a))ja.trace("  set formula for custom: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:530,className:"peote.view.Program",methodName:"setFormula"}),
this.formula.h[a]=b;else throw y.thrown("Error: can not set Formula for "+a+" if there is no property defined for @"+a+" inside Element");}this.formulaHasChanged=!0;null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},parseAndResolveFormulas:function(){var a=this;if(this.formulaHasChanged){for(var b=new S,c=Object.keys(this.formula.h),e=c.length,f=0;f<e;){var g=c[f++];b.h[g]=this.formula.h[g]}var d=b;try{xc.resolveFormulaCyclic(d)}catch(l){throw oa.lastError=l,b=y.caught(l).unwrap(),
y.thrown('Error: cyclic reference of "'+E.string(b.errVar)+'" inside formula "'+E.string(b.formula)+'" for "'+E.string(b.errKey)+'"');}xc.resolveFormulaVars(d,this.buffer.getAttributes());b=function(b,c,e,f){var g=a.buffer.getFormulaNames().h[b];null==g&&(g="");var l=a.buffer.getFormulaNames().h[c];null==l&&(l="");var h=d.h[g],n=d.h[l];return h!=a.buffer.getFormulas().h[g]||n!=a.buffer.getFormulas().h[l]?(null==h&&(h=a.buffer.getAttributes().h[g]),null==h&&(h=e),null==n&&(n=a.buffer.getAttributes().h[l]),
null==n&&(n=f),"rotation"==b&&"0.0"!=h&&(h="("+h+")/180.0*"+Math.PI),"zIndex"==c&&"0.0"!=n&&(b=""+E.string(a.buffer.getMaxZindex()),n="clamp( "+n+"/"+(-1!=b.indexOf(".")||-1!=b.indexOf("e-")?b:b+".0")+", -1.0, 1.0)"),"vec2("+h+", "+n+")"):null};this.glShaderConfig.SIZE_FORMULA=b("sizeX","sizeY","100.0","100.0");this.glShaderConfig.POS_FORMULA=b("posX","posY","0.0","0.0");this.glShaderConfig.ROTZ_FORMULA=b("rotation","zIndex","0.0","0.0");this.glShaderConfig.PIVOT_FORMULA=b("pivotX","pivotY","0.0",
"0.0");b=0;for(c=this.buffer.getFormulaVaryings();b<c.length;)e=c[b],++b,f=d.h[e],f!=this.buffer.getFormulas().h[e]?(null==f&&(f=this.buffer.getAttributes().h[e]),this.glShaderConfig.FORMULA_VARYINGS[e]=f,ja.trace(" -- replacing Formula "+e+" => "+f,{fileName:"peote/view/Program.hx",lineNumber:591,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_VARYINGS[e]=null;b=0;for(c=this.buffer.getFormulaConstants();b<c.length;)e=c[b],++b,f=d.h[e],null!=f&&f!=
this.buffer.getAttributes().h[e]?(this.glShaderConfig.FORMULA_CONSTANTS[e]=f,ja.trace(" -- replacing Formula "+e+" => "+f,{fileName:"peote/view/Program.hx",lineNumber:601,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_CONSTANTS[e]=null}},getTextureIndexByIdentifier:function(a,b){null==b&&(b=!0);var c=this.textureIdentifiers.indexOf(a);if(0>c&&(c=this.customTextureIdentifiers.indexOf(a),0>c&&b)){if(!(new Ca("^([a-zA-z_]+\\d*)+$","g")).match(a))throw y.thrown('Error: "'+
a+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');c=this.textureIdentifiers.length+this.customTextureIdentifiers.length;this.customTextureIdentifiers.push(a)}return c},setTexture:function(a,b,c){b=this.getTextureIndexByIdentifier(b);this.textureLayers.h[b]=[a];null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},updateTextures:function(){for(var a=[],b=this.textureLayers.keys();b.hasNext();)for(var c=b.next(),e=0,f=this.textureLayers.h[c];e<
f.length;)c=f[e],++e,0>a.indexOf(c)&&a.push(c);for(var g=this.activeTextures.length;0<g--;)if(0>a.indexOf(this.activeTextures[g])){if(!K.remove(this.activeTextures[g].programs,this))throw y.thrown("Error, this texture is not used by program anymore");this.activeTextures.splice(g,1);this.activeUnits.splice(g,1)}for(e=0;e<a.length;)if(c=a[e],++e,0>this.activeTextures.indexOf(c)){this.activeTextures.push(c);for(f=0;0<=this.activeUnits.indexOf(f);)++f;this.activeUnits.push(f);if(0<=c.programs.indexOf(this))throw y.thrown("Error, texture is already used by program");
b=this.gl;if(null!=b&&b!=c.gl){f=0;for(g=c.programs;f<g.length;){var d=g[f];++f;if(null!=d.gl&&d.gl!=b)throw y.thrown("Error, texture can not used inside different gl-contexts");}f=0;for(g=c.displays;f<g.length;)if(d=g[f],++f,null!=d.gl&&d.gl!=b)throw y.thrown("Error, texture can not used inside different gl-contexts");null!=c.gl&&(c.gl.deleteTexture(c.glTexture),c.glTexture=null,0==c.displays.length&&null!=c.framebuffer&&(c.gl.deleteFramebuffer(c.framebuffer),c.framebuffer=null,null!=c.glDepthBuffer&&
c.gl.deleteRenderbuffer(c.glDepthBuffer),c.glDepthBuffer=null));c.gl=b;if(c.width>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE)||c.height>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");c.glTexture=Fb.createEmptyTexture(c.gl,c.width,c.height,c.colorChannels,c.createMipmaps,c.magFilter,c.minFilter,c.useFloat);if(0<c.displays.length&&null==c.framebuffer){c.glDepthBuffer=c.gl.createRenderbuffer();f=c.gl;b=c.glTexture;g=c.glDepthBuffer;d=c.width;
var l=c.height,h=f.createFramebuffer();f.bindRenderbuffer(f.RENDERBUFFER,g);hb.clearGlErrorQueue(f);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT24,d,l);hb.getLastGlError(f)==f.INVALID_ENUM&&(ja.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,d,l));f.bindFramebuffer(f.FRAMEBUFFER,h);f.framebufferRenderbuffer(f.FRAMEBUFFER,
f.DEPTH_ATTACHMENT,f.RENDERBUFFER,g);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,b,0);if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);c.framebuffer=h;c.updated=!0}for(f=c.images.keys();f.hasNext();)b=f.next(),c.bufferImage(b,c.images.h[b.__id__])}c.programs.push(this)}this.parseColorFormula();this.glShaderConfig.hasFRAGMENT_INJECTION=
this.hasFragmentInjection;this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS="";this.glShaderConfig.TEXTURES=[];if(0==this.activeTextures.length)this.glShaderConfig.hasTEXTURES=!1;else{this.glShaderConfig.hasTEXTURES=!0;e=0;for(f=this.activeTextures.length;e<f;)g=e++,this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS+="uniform sampler2D uTexture"+g+";";for(b=this.textureLayers.keys();b.hasNext();){c=b.next();a=[];d=this.textureLayers.h[c];e=0;for(f=d.length;e<f;){g=e++;l=""+E.string(d[g].slotWidth/d[g].width);
h=""+E.string(d[g].slotHeight/d[g].height);var n=""+E.string(d[g].slotsX*d[g].slotWidth/d[g].width),m=""+E.string(d[g].slotsY*d[g].slotHeight/d[g].height);a.push({UNIT_VALUE:g+1+".0",TEXTURE:"uTexture"+this.activeTextures.indexOf(d[g]),SLOTS_X:d[g].slotsX+".0",SLOTS_Y:d[g].slotsY+".0",SLOT_WIDTH:-1!=l.indexOf(".")||-1!=l.indexOf("e-")?l:l+".0",SLOT_HEIGHT:-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0",SLOTS_WIDTH:-1!=n.indexOf(".")||-1!=n.indexOf("e-")?n:n+".0",SLOTS_HEIGHT:-1!=m.indexOf(".")||
-1!=m.indexOf("e-")?m:m+".0",TILES_X:d[g].tilesX+".0",TILES_Y:d[g].tilesY+".0",TEXTURE_WIDTH:d[g].width+".0",TEXTURE_HEIGHT:d[g].height+".0",FIRST:0==g,LAST:g==d.length-1})}this.glShaderConfig.TEXTURES.push({LAYER:c,UNITS:a,USED:0<(this.used_by_ColorFormula&1<<c),USED_ID:0<(this.usedID_by_ColorFormula&1<<c)})}}this.glShaderConfig.TEXTURE_DEFAULTS=[];e=0;for(f=this.textureID_Defaults;e<f.length;)a=f[e],++e,this.glShaderConfig.TEXTURE_DEFAULTS.push({LAYER:a.layer,DEFAULT_VALUE:a.value});this.glShaderConfig.hasTEXTURE_FUNCTIONS=
0==this.usedID_by_ColorFormula&&0==this.textureID_Defaults.length?!1:!0;null!=this.gl&&(this.ready=!1,this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)),this.createProg(),this.buffer.hasPicking()&&this.createProg(!0))},__class__:rc};var Od=function(a,b,c,
e){null==e&&(e=!1);null==c&&(c=!1);this.isMasked=this.hasBackground=!1;this._buffer=new Ld(1024,1024,!0);rc.call(this,this._buffer);c&&(this.isMasked=!0,this.maskBuffer=new Md(16,16,!0),this.maskProgram=new rc(this.maskBuffer),this.maskProgram.mask=2,this.maskProgram.colorEnabled=!1,this.mask=1,this.hasBackground&&(this.backgroundProgram.mask=1));e&&(this.hasBackground=!0,this.backgroundBuffer=new Nd(16,16,!0),this.backgroundProgram=new rc(this.backgroundBuffer),this.isMasked&&(this.backgroundProgram.mask=
1));this.font=a;this.autoUpdateTextures=!1;this.setTexture(a.textureCache,"TEX");this.fontStyle=b;this.alphaEnabled=!0;this.font.config.distancefield?(a=""+E.string(.5),a=-1!=a.indexOf(".")||-1!=a.indexOf("e-")?a:a+".0",this.setColorFormula("mix(bgColor,color,smoothstep( weight - "+a+" * fwidth(TEX.r), weight + "+a+" * fwidth(TEX.r), TEX.r))")):this.setColorFormula("mix(bgColor,color,TEX.r)");this.setFormula("x","x + (1.0-aPosition.y)*width*tilt");this.updateTextures()};d["peote.text.FontProgram__ob_gum_backends_PeoteView_FontStyle"]=
Od;Od.__name__=!0;Od.__super__=rc;Od.prototype=u(rc.prototype,{addToDisplay:function(a,b,c){null==c&&(c=!1);rc.prototype.addToDisplay.call(this,a,b,c);this.isMasked&&this.maskProgram.addToDisplay(a,this,!0);this.hasBackground&&this.backgroundProgram.addToDisplay(a,this,!0)},__class__:Od});var He=function(a,b,c,e){null==e&&(e=16384);null==c&&(c=!0);this.rHexToDec=new Ca('("\\s*)?(0x[0-9a-f]+)(\\s*")?',"gi");this.rComments=new Ca("//.*?$","gm");this.rParsePathConfig=new Ca("^(.*?)([^/]+)$","");this.kerning=
!1;if(this.rParsePathConfig.match(a))this.path=this.rParsePathConfig.matched(1),this.jsonFilename=this.rParsePathConfig.matched(2);else throw y.thrown("Can't load font, error in path to jsonfile: \""+a+'"');this.ranges=b;this.kerning=c;this.maxTextureSize=e};d["peote.text.Font__ob_gum_backends_PeoteView_FontStyle"]=He;He.__name__=!0;He.prototype={createFontProgram:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);return new Od(this,a,b,c)},createFontStyle:function(){return new Ie},load:function(a,b,
c){null==c&&(c=!1);var e=this,f=c,g=function(f){f=f.replace(e.rComments.r,"");f=e.rHexToDec.map(f,function(a){return E.string(E.parseInt(a.matched(2)))});var g=new Va;e.config=g.fromJson(f,e.path+e.jsonFilename);f=0;for(g=g.errors;f<g.length;){var d=g[f];++f;switch(d._hx_index){case 0:var l=d.variable;var h=d.expected;l=d.pos;break;case 1:l=d.pos;break;case 2:l=d.pos;break;case 3:l=d.pos;break;case 4:l=d.pos;break;case 5:l=d.pos;break;case 6:l=d.pos}ja.trace(l.lines[0].number,{fileName:"peote/text/Font.hx",
lineNumber:246,className:"peote.text.Font__ob_gum_backends_PeoteView_FontStyle",methodName:"load"});null!=l&&ja.trace(Pe.convertError(d),{fileName:l.file,lineNumber:l.lines[0].number,className:"",methodName:""})}if(e.config.packed)throw f='Error, metadata of FontStyle class has to be "@packed" for "'+e.path+e.jsonFilename+'" and "packed":true',ja.trace(f,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),y.thrown(f);e.kerning&&null!=e.config.kerning&&(e.kerning=e.config.kerning);
if(null==e.ranges&&1<e.config.ranges.length)throw f='Error, set FontStyle to @multiSlot and/or @multiTexture or define a single range while Font creation or inside "'+e.path+e.jsonFilename+'"',ja.trace(f,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),y.thrown(f);d=[];f=0;for(g=e.config.ranges;f<g.length;){var n=g[f];++f;var m=n.range.min,C=n.range.max;if(null!=e.ranges)for(l=0,h=e.ranges;l<h.length;){var q=h[l];++l;if(q.min>=m&&q.min<=C||q.max>=m&&q.max<=C){d.push(n);break}}else d.push(n);
if(1==d.length)break}if(0==d.length)throw f='Error, can not found any ranges inside font-config "'+e.path+e.jsonFilename+'" that fit '+E.string(e.ranges),ja.trace(f,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),y.thrown(f);e.config.ranges=d;e.init(a,b,c)};null==f&&(f=!1);var d=this.path+this.jsonFilename,l=null==g?null:g,h=null==g?null:function(a){g(a.toString())};null==f&&(f=!1);""!=eb.corsServer&&(new Ca("^https?://","")).match(d)&&(d="//"+eb.corsServer+"/"+d);var n=
hc.loadFromFile(d);f&&(ja.trace('Start loading bytes "'+d+'"',{fileName:"utils/Loader.hx",lineNumber:81,className:"utils.Loader",methodName:"bytes"}),n.onProgress(function(a,b){eb.onProgressDebug(a,b,d)}),n.onError(eb.onErrorDebug),n.onComplete(function(a){eb.onCompleteDebug(d)}));if(null!=l)n.onError(l);if(null!=h)n.onComplete(h)},init:function(a,b,c){for(var e=0,f=0,g=0,d=this.config.ranges;g<d.length;){var l=d[g];++g;l.slot.width>e&&(e=l.slot.width);l.slot.height>f&&(f=l.slot.height)}this.textureCache=
new Je(e,f,this.config.ranges.length,4,!1,1,1,null,this.maxTextureSize);this.loadImages(null,a,b,c)},loadImages:function(a,b,c,e){var f=this,g=this.config.ranges;a=Array(g.length);for(var d=0,l=g.length;d<l;){var h=d++;a[h]=f.path+g[h].image}g=e;var n=function(a,b,e){null!=c&&c(b,e)},m=function(a,b){if(null!=f.config.ranges[a].tiles){var c=f.config.ranges[a].tiles.x;var e=f.config.ranges[a].tiles.y}else if(null!=f.config.tiles)c=f.config.tiles.x,e=f.config.tiles.y;else throw b='Error, can not found tiles inside font-config "'+
f.path+f.jsonFilename+'"',ja.trace(b,{fileName:f.path+f.jsonFilename,lineNumber:0,className:"",methodName:""}),y.thrown(b);if(null!=f.config.ranges[a].line){var g=f.config.ranges[a].line.height/b.height*e;var d=f.config.ranges[a].line.base/b.height*e}else null!=f.config.line?(g=f.config.line.height/b.height*e,d=f.config.line.base/b.height*e):d=g=1;a=f.config.ranges[a].range;f.textureCache.setImage(b,0,c,e);f.rangeMapping={min:a.min,max:a.max,height:g,base:d}},r=function(a){b(f)};null==g&&(g=!1);var C=
a.length;d=0;for(l=a.length;d<l;){h=[d++];var q=[a[h[0]]];e=g;var Q=null==n?null:function(a){return function(b,c){null!=n&&n(a[0],b,c)}}(h);h=null==r?null:function(a){return function(c){null!=m&&m(a[0],c);0==--C&&b(f)}}(h);null==e&&(e=!1);""!=eb.corsServer&&(new Ca("^https?://","")).match(q[0])&&(q[0]="//"+eb.corsServer+"/"+q[0]);var w=Ka.loadFromFile(q[0]);e&&(ja.trace('Start loading image "'+q[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),w.onProgress(function(a){return function(b,
c){eb.onProgressDebug(b,c,a[0])}}(q)),w.onError(eb.onErrorDebug),w.onComplete(function(a){return function(b){eb.onCompleteDebug(a[0])}}(q)));if(null!=Q)w.onProgress(Q);if(null!=h)w.onComplete(h)}},__class__:He};var af=function(){};d["peote.text.Gl3FontData"]=af;af.__name__=!0;var ia=function(){this.bytePos=-1;this.weight=this.tilt=this.zIndex=this.width=this.height=this.tile=0;this.bgColor=255;this.color=-1;this.x=this.y=0;this.char=-1};d["peote.text.Glyph__ob_gum_backends_PeoteView_FontStyle"]=ia;
ia.__name__=!0;ia.prototype={__class__:ia};var Ga=function(){};d["peote.text.MaskElement"]=Ga;Ga.__name__=!0;var ee=function(a,b){this.min=a;this.max=b};d["peote.text.Range"]=ee;ee.__name__=!0;ee.prototype={__class__:ee};var Ec=function(){};d["peote.view.BufferInterface"]=Ec;Ec.__name__=!0;Ec.__isInterface__=!0;Ec.prototype={__class__:Ec};var Nd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=
a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);X.isINSTANCED?(null==La.instanceBytes&&(La.instanceBytes=new xb(new ArrayBuffer(12)),La.instanceBytes.b[0]=1,La.instanceBytes.b[1]=1,La.instanceBytes.b[2]=1,La.instanceBytes.b[3]=1,La.instanceBytes.b[4]=0,La.instanceBytes.b[5]=1,La.instanceBytes.b[6]=1,La.instanceBytes.b[7]=0,La.instanceBytes.b[8]=0,La.instanceBytes.b[9]=
0,La.instanceBytes.b[10]=0,La.instanceBytes.b[11]=0),this._elemBuffSize=24):this._elemBuffSize=168;this._bytes=new xb(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_BackgroundElement"]=Nd;Nd.__name__=!0;Nd.__interfaces__=[Ec];Nd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),X.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),X.isVAO&&this._gl.deleteVertexArray(this._glVAO));
this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);X.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=La.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),
a.bindBuffer(a.ARRAY_BUFFER,null));X.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),X.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,24,0),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,
24,4),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,24,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,24,16),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,28,0),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,28,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,
!1,28,8),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,28,16),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,28,24)),this._gl.bindVertexArray(null))}},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( 0.0, aRotZ )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- rotZ.y,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color"]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return La.DEFAULT_FORMULA_VARS},getFormulas:function(){return La.FORMULAS},getAttributes:function(){return La.ATTRIBUTES},getFormulaNames:function(){return La.FORMULA_NAMES},getFormulaVaryings:function(){return""==La.FORMULA_VARYINGS?[]:La.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==La.FORMULA_CONSTANTS?[]:La.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==La.FORMULA_CUSTOMS?[]:La.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!0},hasPicking:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,4,"aColorStart0");a.bindAttribLocation(b,3,"aRotZ");a.bindAttribLocation(b,1,"aPos");
a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;X.isINSTANCED?(X.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,24,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(3),
b.vertexAttribPointer(3,1,b.FLOAT,!1,24,4),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,24,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,24,16),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(X.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,
!0,28,0),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,28,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,28,8),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,28,16),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,28,24)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));X.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(4),b.disableVertexAttribArray(3),
b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Nd};var Ld=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);X.isINSTANCED?(null==ia.instanceBytes&&
(ia.instanceBytes=new xb(new ArrayBuffer(12)),ia.instanceBytes.b[0]=1,ia.instanceBytes.b[1]=1,ia.instanceBytes.b[2]=1,ia.instanceBytes.b[3]=1,ia.instanceBytes.b[4]=0,ia.instanceBytes.b[5]=1,ia.instanceBytes.b[6]=1,ia.instanceBytes.b[7]=0,ia.instanceBytes.b[8]=0,ia.instanceBytes.b[9]=0,ia.instanceBytes.b[10]=0,ia.instanceBytes.b[11]=0),this._elemBuffSize=40):this._elemBuffSize=240;this._bytes=new xb(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};d["peote.view.Buffer_Glyph__ob_gum_backends_PeoteView_FontStyle"]=Ld;Ld.__name__=!0;Ld.__interfaces__=[Ec];Ld.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),X.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),X.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,
0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);X.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=ia.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));X.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),X.isINSTANCED?(a=this._gl,b=this._glBuffer,
a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,40,0),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,4),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,40,8),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),
a.vertexAttribPointer(1,2,a.FLOAT,!1,40,12),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,20),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,28),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,1,a.SHORT,!1,40,36),a.vertexAttribDivisor(7,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,
40,0),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,4),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,40,8),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,12),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,20),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,28),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,1,a.SHORT,!1,40,36),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,
2,a.UNSIGNED_BYTE,!1,40,38)),this._gl.bindVertexArray(null))}},update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(X.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.color;e.b_Int32[c.bytePos+4>>2]=c.bgColor;e.b_UFloat32[c.bytePos+8>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151));e.b_UFloat32[c.bytePos+12>>2]=c.x;e.b_UFloat32[c.bytePos+16>>2]=c.y;e.b_UFloat32[c.bytePos+20>>2]=c.width;e.b_UFloat32[c.bytePos+24>>2]=c.height;e.b_UFloat32[c.bytePos+28>>2]=c.weight;
e.b_UFloat32[c.bytePos+32>>2]=c.tilt;e.b_Uint16[c.bytePos+36>>1]=c.tile&65535}else c=this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.color,e.b_Int32[c.bytePos+4>>2]=c.bgColor,e.b_UFloat32[c.bytePos+8>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+12>>2]=c.x,e.b_UFloat32[c.bytePos+16>>2]=c.y,e.b_UFloat32[c.bytePos+20>>2]=c.width,e.b_UFloat32[c.bytePos+24>>2]=c.height,e.b_UFloat32[c.bytePos+28>>2]=c.weight,e.b_UFloat32[c.bytePos+32>>2]=c.tilt,e.b_Uint16[c.bytePos+36>>
1]=c.tile&65535,e.b[c.bytePos+38]=1,e.b[c.bytePos+39]=1,e.b_Int32[c.bytePos+40>>2]=c.color,e.b_Int32[c.bytePos+44>>2]=c.bgColor,e.b_UFloat32[c.bytePos+48>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+52>>2]=c.x,e.b_UFloat32[c.bytePos+56>>2]=c.y,e.b_UFloat32[c.bytePos+60>>2]=c.width,e.b_UFloat32[c.bytePos+64>>2]=c.height,e.b_UFloat32[c.bytePos+68>>2]=c.weight,e.b_UFloat32[c.bytePos+72>>2]=c.tilt,e.b_Uint16[c.bytePos+76>>1]=c.tile&65535,e.b[c.bytePos+78]=1,e.b[c.bytePos+79]=1,
e.b_Int32[c.bytePos+80>>2]=c.color,e.b_Int32[c.bytePos+84>>2]=c.bgColor,e.b_UFloat32[c.bytePos+88>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+92>>2]=c.x,e.b_UFloat32[c.bytePos+96>>2]=c.y,e.b_UFloat32[c.bytePos+100>>2]=c.width,e.b_UFloat32[c.bytePos+104>>2]=c.height,e.b_UFloat32[c.bytePos+108>>2]=c.weight,e.b_UFloat32[c.bytePos+112>>2]=c.tilt,e.b_Uint16[c.bytePos+116>>1]=c.tile&65535,e.b[c.bytePos+118]=0,e.b[c.bytePos+119]=1,e.b_Int32[c.bytePos+120>>2]=c.color,e.b_Int32[c.bytePos+
124>>2]=c.bgColor,e.b_UFloat32[c.bytePos+128>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+132>>2]=c.x,e.b_UFloat32[c.bytePos+136>>2]=c.y,e.b_UFloat32[c.bytePos+140>>2]=c.width,e.b_UFloat32[c.bytePos+144>>2]=c.height,e.b_UFloat32[c.bytePos+148>>2]=c.weight,e.b_UFloat32[c.bytePos+152>>2]=c.tilt,e.b_Uint16[c.bytePos+156>>1]=c.tile&65535,e.b[c.bytePos+158]=1,e.b[c.bytePos+159]=0,e.b_Int32[c.bytePos+160>>2]=c.color,e.b_Int32[c.bytePos+164>>2]=c.bgColor,e.b_UFloat32[c.bytePos+168>>
2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+172>>2]=c.x,e.b_UFloat32[c.bytePos+176>>2]=c.y,e.b_UFloat32[c.bytePos+180>>2]=c.width,e.b_UFloat32[c.bytePos+184>>2]=c.height,e.b_UFloat32[c.bytePos+188>>2]=c.weight,e.b_UFloat32[c.bytePos+192>>2]=c.tilt,e.b_Uint16[c.bytePos+196>>1]=c.tile&65535,e.b[c.bytePos+198]=0,e.b[c.bytePos+199]=0,e.b_Int32[c.bytePos+200>>2]=c.color,e.b_Int32[c.bytePos+204>>2]=c.bgColor,e.b_UFloat32[c.bytePos+208>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),
e.b_UFloat32[c.bytePos+212>>2]=c.x,e.b_UFloat32[c.bytePos+216>>2]=c.y,e.b_UFloat32[c.bytePos+220>>2]=c.width,e.b_UFloat32[c.bytePos+224>>2]=c.height,e.b_UFloat32[c.bytePos+228>>2]=c.weight,e.b_UFloat32[c.bytePos+232>>2]=c.tilt,e.b_Uint16[c.bytePos+236>>1]=c.tile&65535,e.b[c.bytePos+238]=0,e.b[c.bytePos+239]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null)},updateElement:function(a){if(X.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.color;b.b_Int32[a.bytePos+4>>2]=a.bgColor;b.b_UFloat32[a.bytePos+8>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151));b.b_UFloat32[a.bytePos+12>>2]=a.x;b.b_UFloat32[a.bytePos+16>>2]=a.y;b.b_UFloat32[a.bytePos+20>>2]=a.width;b.b_UFloat32[a.bytePos+24>>2]=a.height;b.b_UFloat32[a.bytePos+28>>2]=a.weight;b.b_UFloat32[a.bytePos+32>>2]=a.tilt;b.b_Uint16[a.bytePos+36>>1]=a.tile&65535}else b=this._bytes,b.b_Int32[a.bytePos>>
2]=a.color,b.b_Int32[a.bytePos+4>>2]=a.bgColor,b.b_UFloat32[a.bytePos+8>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+12>>2]=a.x,b.b_UFloat32[a.bytePos+16>>2]=a.y,b.b_UFloat32[a.bytePos+20>>2]=a.width,b.b_UFloat32[a.bytePos+24>>2]=a.height,b.b_UFloat32[a.bytePos+28>>2]=a.weight,b.b_UFloat32[a.bytePos+32>>2]=a.tilt,b.b_Uint16[a.bytePos+36>>1]=a.tile&65535,b.b[a.bytePos+38]=1,b.b[a.bytePos+39]=1,b.b_Int32[a.bytePos+40>>2]=a.color,b.b_Int32[a.bytePos+44>>2]=a.bgColor,b.b_UFloat32[a.bytePos+
48>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+52>>2]=a.x,b.b_UFloat32[a.bytePos+56>>2]=a.y,b.b_UFloat32[a.bytePos+60>>2]=a.width,b.b_UFloat32[a.bytePos+64>>2]=a.height,b.b_UFloat32[a.bytePos+68>>2]=a.weight,b.b_UFloat32[a.bytePos+72>>2]=a.tilt,b.b_Uint16[a.bytePos+76>>1]=a.tile&65535,b.b[a.bytePos+78]=1,b.b[a.bytePos+79]=1,b.b_Int32[a.bytePos+80>>2]=a.color,b.b_Int32[a.bytePos+84>>2]=a.bgColor,b.b_UFloat32[a.bytePos+88>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+
92>>2]=a.x,b.b_UFloat32[a.bytePos+96>>2]=a.y,b.b_UFloat32[a.bytePos+100>>2]=a.width,b.b_UFloat32[a.bytePos+104>>2]=a.height,b.b_UFloat32[a.bytePos+108>>2]=a.weight,b.b_UFloat32[a.bytePos+112>>2]=a.tilt,b.b_Uint16[a.bytePos+116>>1]=a.tile&65535,b.b[a.bytePos+118]=0,b.b[a.bytePos+119]=1,b.b_Int32[a.bytePos+120>>2]=a.color,b.b_Int32[a.bytePos+124>>2]=a.bgColor,b.b_UFloat32[a.bytePos+128>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+132>>2]=a.x,b.b_UFloat32[a.bytePos+136>>2]=a.y,
b.b_UFloat32[a.bytePos+140>>2]=a.width,b.b_UFloat32[a.bytePos+144>>2]=a.height,b.b_UFloat32[a.bytePos+148>>2]=a.weight,b.b_UFloat32[a.bytePos+152>>2]=a.tilt,b.b_Uint16[a.bytePos+156>>1]=a.tile&65535,b.b[a.bytePos+158]=1,b.b[a.bytePos+159]=0,b.b_Int32[a.bytePos+160>>2]=a.color,b.b_Int32[a.bytePos+164>>2]=a.bgColor,b.b_UFloat32[a.bytePos+168>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+172>>2]=a.x,b.b_UFloat32[a.bytePos+176>>2]=a.y,b.b_UFloat32[a.bytePos+180>>2]=a.width,b.b_UFloat32[a.bytePos+
184>>2]=a.height,b.b_UFloat32[a.bytePos+188>>2]=a.weight,b.b_UFloat32[a.bytePos+192>>2]=a.tilt,b.b_Uint16[a.bytePos+196>>1]=a.tile&65535,b.b[a.bytePos+198]=0,b.b[a.bytePos+199]=0,b.b_Int32[a.bytePos+200>>2]=a.color,b.b_Int32[a.bytePos+204>>2]=a.bgColor,b.b_UFloat32[a.bytePos+208>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+212>>2]=a.x,b.b_UFloat32[a.bytePos+216>>2]=a.y,b.b_UFloat32[a.bytePos+220>>2]=a.width,b.b_UFloat32[a.bytePos+224>>2]=a.height,b.b_UFloat32[a.bytePos+228>>
2]=a.weight,b.b_UFloat32[a.bytePos+232>>2]=a.tilt,b.b_Uint16[a.bytePos+236>>1]=a.tile&65535,b.b[a.bytePos+238]=0,b.b[a.bytePos+239]=0;if(-1==a.bytePos)throw y.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw y.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");
var b=this._maxElements+this._growSize,c=new xb(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var f=this._maxElements;c<f;){var g=c++,d=this._elements[g];e=this._bytes;var l=d.bytePos,h=this._elemBuffSize;null==h&&(h=0);null==l&&(l=0);e=0<h?new Uint8Array(e.b.bufferValue,l,h):new Uint8Array(e.b.bufferValue,l);d.bufferPointer=e;b[g]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),
this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),X.isVAO&&(this._gl.bindVertexArray(this._glVAO),X.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,
c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.vertexAttribDivisor(2,
1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.vertexAttribDivisor(7,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.enableVertexAttribArray(1),
b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,38)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;l=a.bytePos;h=this._elemBuffSize;null==h&&(h=0);null==l&&(l=0);
e=0<h?new Uint8Array(e.b.bufferValue,l,h):new Uint8Array(e.b.bufferValue,l);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw y.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t\n\t\n\t::IN:: vec4 aColorStart0;::IN:: vec4 aColorStart1;\n\t\n\t::IN:: vec2 aFloat0;::IN:: float aShort0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;::if isES3::flat ::end::::VAROUT:: vec4 vColor1;\n\t::if isES3::flat ::end::::VAROUT:: vec2 vSize; ::if isES3::flat ::end:: ::VAROUT:: float vPack0;\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VAROUT:: float vTexPack0;\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;vSize = size;\n\t\t\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( 0.0, aRotZ )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; vColor1 = aColorStart1.wzyx; \n\n\t\tvPack0 = ::if FORMULA_VARYINGS.weight::::FORMULA_VARYINGS.weight::::else::aFloat0.x::end::;\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\tvTexPack0 = ::if FORMULA_VARYINGS.tile::::FORMULA_VARYINGS.tile::::else::aShort0::end::;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- rotZ.y,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; ::if isES3::flat ::end::::VARIN:: vec4 vColor1; \n\t::if isES3::flat ::end::::VARIN:: vec2 vSize; ::if isES3::flat ::end:: ::VARIN:: float vPack0;\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VARIN:: float vTexPack0;\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; vec4 c1 = vColor1; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color","bgColor"]},getCustomIdentifiers:function(){return["weight","tilt"]},getCustomVaryings:function(){return["vPack0","null"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return ia.DEFAULT_FORMULA_VARS},getFormulas:function(){return ia.FORMULAS},getAttributes:function(){return ia.ATTRIBUTES},getFormulaNames:function(){return ia.FORMULA_NAMES},getFormulaVaryings:function(){return""==
ia.FORMULA_VARYINGS?[]:ia.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==ia.FORMULA_CONSTANTS?[]:ia.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==ia.FORMULA_CUSTOMS?[]:ia.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!0},hasPicking:function(){return!1},needFragmentPrecision:function(){return!0},bindAttribLocations:function(a,b){a.bindAttribLocation(b,4,"aColorStart0");a.bindAttribLocation(b,
5,"aColorStart1");a.bindAttribLocation(b,3,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,7,"aShort0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;X.isINSTANCED?(X.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,
c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.vertexAttribDivisor(2,
1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.vertexAttribDivisor(7,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(X.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,
4,b.UNSIGNED_BYTE,!0,40,4),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,38)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,
0,6*a));X.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(4),b.disableVertexAttribArray(5),b.disableVertexAttribArray(3),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),b.disableVertexAttribArray(6),b.disableVertexAttribArray(7));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Ld};var Md=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=
this._glVAO=null;if(0>=a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);X.isINSTANCED?(null==Ga.instanceBytes&&(Ga.instanceBytes=new xb(new ArrayBuffer(12)),Ga.instanceBytes.b[0]=1,Ga.instanceBytes.b[1]=1,Ga.instanceBytes.b[2]=1,Ga.instanceBytes.b[3]=1,Ga.instanceBytes.b[4]=0,Ga.instanceBytes.b[5]=1,Ga.instanceBytes.b[6]=1,Ga.instanceBytes.b[7]=0,Ga.instanceBytes.b[8]=
0,Ga.instanceBytes.b[9]=0,Ga.instanceBytes.b[10]=0,Ga.instanceBytes.b[11]=0),this._elemBuffSize=8):this._elemBuffSize=72;this._bytes=new xb(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_MaskElement"]=Md;Md.__name__=!0;Md.__interfaces__=[Ec];Md.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),X.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),
X.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);X.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=Ga.instanceBytes,b=new Uint8Array(b.b.bufferValue,
0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));X.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),X.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,8,0),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,8,4),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,12,0),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,12,4),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null))}},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\t\n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t\n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\t\n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return[]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return Ga.DEFAULT_FORMULA_VARS},getFormulas:function(){return Ga.FORMULAS},getAttributes:function(){return Ga.ATTRIBUTES},getFormulaNames:function(){return Ga.FORMULA_NAMES},getFormulaVaryings:function(){return""==Ga.FORMULA_VARYINGS?[]:Ga.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==Ga.FORMULA_CONSTANTS?[]:Ga.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==Ga.FORMULA_CUSTOMS?[]:Ga.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,0,"aPosition")},
render:function(a,b,c){a=this._maxElements;X.isINSTANCED?(X.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,
0,6,a)):(X.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));X.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));
this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Md};var Xd=function(a,b,c,e,f){null==f&&(f=0);this.renderFramebufferSkipFrames=this.renderFramebufferFrame=0;this._renderFramebufferEnabled=!1;this.framebufferTextureSlot=0;this.peoteView=this.gl=this.fbTexture=null;this.alpha=1;this.red=this.green=this.blue=0;this.backgroundAlpha=this.backgroundDepth=this.backgroundEnabled=!1;this.isVisible=!0;this.xz=this.yz=this.zoom=this.xZoom=this.yZoom=1;this.width=this.height=this.x=this.y=this.xOffset=
this.yOffset=0;if(X.isUBO){var g=this.uniformBuffer,d=this.gl;null!=d&&(g.uniformBytes.b_UFloat32[0]=a+this.xOffset,d.bindBuffer(d.UNIFORM_BUFFER,g.uniformBuffer),d.bufferSubData(d.UNIFORM_BUFFER,0,g.xOffestBufferPointer),d.bindBuffer(d.UNIFORM_BUFFER,null))}this.x=a;X.isUBO&&(g=this.uniformBuffer,d=this.gl,null!=d&&(g.uniformBytes.b_UFloat32[1]=b+this.yOffset,d.bindBuffer(d.UNIFORM_BUFFER,g.uniformBuffer),d.bufferSubData(d.UNIFORM_BUFFER,4,g.yOffestBufferPointer),d.bindBuffer(d.UNIFORM_BUFFER,null)));
this.y=b;this.width=c;this.height=e;this.red=(f>>24&255)/255;this.green=(f>>16&255)/255;this.blue=(f>>8&255)/255;this.alpha=(f&255)/255;this.backgroundEnabled=0<this.alpha;this.backgroundAlpha=1>this.alpha;this.programList=new Ke(new zb);X.isUBO&&(this.uniformBuffer=new Pd,this.uniformBufferFB=new Pd,this.uniformBufferViewFB=new Qd)};d["peote.view.Display"]=Xd;Xd.__name__=!0;Xd.prototype={addToPeoteView:function(a,b,c){null==c&&(c=!1);this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));
a.displayList.add(this,b,c)},setNewGLContext:function(a){if(null!=a&&a!=this.gl){null!=this.gl&&X.isUBO&&(this.uniformBuffer.deleteGLBuffer(this.gl),this.uniformBufferFB.deleteGLBuffer(this.gl),this.uniformBufferViewFB.deleteGLBuffer(this.gl));this.gl=a;X.isUBO&&(this.uniformBuffer.createGLBuffer(this.gl,this.x+this.xOffset,this.y+this.yOffset,this.xz,this.yz),this.uniformBufferFB.createGLBuffer(this.gl,this.xOffset,this.yOffset-this.height,this.xz,this.yz),this.uniformBufferViewFB.createGLBuffer(this.gl,
this.width,-this.height,0,0,1,1));for(var b=this.programList.first;null!=b;){var c=b.value;b=b.next;if(null!=a&&a!=c.gl){for(var e=0,f=c.displays;e<f.length;){var d=f[e];++e;if(null!=d.gl&&d.gl!=a)throw y.thrown("Error, program can not used inside different gl-contexts");}null!=c.gl&&(c.gl.deleteShader(c.glVertexShader),c.gl.deleteShader(c.glFragmentShader),c.gl.deleteProgram(c.glProgram),c.buffer.hasPicking()&&(c.gl.deleteShader(c.glVertexShaderPicking),c.gl.deleteShader(c.glFragmentShaderPicking),
c.gl.deleteProgram(c.glProgramPicking)));c.gl=a;X.isES3&&(c.glShaderConfig.isES3=!0,c.glShaderConfig.IN="in",c.glShaderConfig.VARIN="in",c.glShaderConfig.VAROUT="out");X.isUBO&&(c.glShaderConfig.isUBO=!0);X.isINSTANCED&&(c.glShaderConfig.isINSTANCED=!0);c.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=c.gl.getExtension("OES_standard_derivatives")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=c.gl.getExtension("EXT_color_buffer_float")?c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):
null!=c.gl.getExtension("OES_texture_float")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});c.buffer.setNewGLContext(c.gl);c.createProg();c.buffer.hasPicking()&&c.createProg(!0);e=0;for(f=c.activeTextures;e<f.length;){d=f[e];++e;var h=c.gl;if(null!=h&&h!=d.gl){for(var l=0,n=d.programs;l<n.length;){var m=n[l];++l;if(null!=m.gl&&m.gl!=h)throw y.thrown("Error, texture can not used inside different gl-contexts");}m=0;for(l=d.displays;m<l.length;)if(n=l[m],++m,null!=n.gl&&
n.gl!=h)throw y.thrown("Error, texture can not used inside different gl-contexts");null!=d.gl&&(d.gl.deleteTexture(d.glTexture),d.glTexture=null,0==d.displays.length&&null!=d.framebuffer&&(d.gl.deleteFramebuffer(d.framebuffer),d.framebuffer=null,null!=d.glDepthBuffer&&d.gl.deleteRenderbuffer(d.glDepthBuffer),d.glDepthBuffer=null));d.gl=h;if(d.width>d.gl.getParameter(d.gl.MAX_TEXTURE_SIZE)||d.height>d.gl.getParameter(d.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");
d.glTexture=Fb.createEmptyTexture(d.gl,d.width,d.height,d.colorChannels,d.createMipmaps,d.magFilter,d.minFilter,d.useFloat);if(0<d.displays.length&&null==d.framebuffer){d.glDepthBuffer=d.gl.createRenderbuffer();h=d.gl;m=d.glTexture;l=d.glDepthBuffer;n=d.width;var C=d.height,r=h.createFramebuffer();h.bindRenderbuffer(h.RENDERBUFFER,l);hb.clearGlErrorQueue(h);h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_COMPONENT24,n,C);hb.getLastGlError(h)==h.INVALID_ENUM&&(ja.trace("switching to DEPTH_COMPONENT16 for framebuffer",
{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_COMPONENT16,n,C));h.bindFramebuffer(h.FRAMEBUFFER,r);h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,l);h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,m,0);if(h.checkFramebufferStatus(h.FRAMEBUFFER)!=h.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");h.bindFramebuffer(h.FRAMEBUFFER,
null);h.bindRenderbuffer(h.RENDERBUFFER,null);d.framebuffer=r;d.updated=!0}for(h=d.images.keys();h.hasNext();)m=h.next(),d.bufferImage(m,d.images.h[m.__id__])}}}}if(null!=this.fbTexture&&(b=this.fbTexture,null!=a&&a!=b.gl)){e=0;for(f=b.programs;e<f.length;)if(m=f[e],++e,null!=m.gl&&m.gl!=a)throw y.thrown("Error, texture can not used inside different gl-contexts");e=0;for(f=b.displays;e<f.length;)if(d=f[e],++e,null!=d.gl&&d.gl!=a)throw y.thrown("Error, texture can not used inside different gl-contexts");
null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");b.glTexture=Fb.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,
b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();h=b.gl;m=b.glTexture;l=b.glDepthBuffer;n=b.width;C=b.height;r=h.createFramebuffer();h.bindRenderbuffer(h.RENDERBUFFER,l);hb.clearGlErrorQueue(h);h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_COMPONENT24,n,C);hb.getLastGlError(h)==h.INVALID_ENUM&&(ja.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",
methodName:"createFramebuffer"}),h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_COMPONENT16,n,C));h.bindFramebuffer(h.FRAMEBUFFER,r);h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,l);h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,m,0);if(h.checkFramebufferStatus(h.FRAMEBUFFER)!=h.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");h.bindFramebuffer(h.FRAMEBUFFER,null);h.bindRenderbuffer(h.RENDERBUFFER,null);b.framebuffer=r;b.updated=
!0}for(h=b.images.keys();h.hasNext();)m=h.next(),b.bufferImage(m,b.images.h[m.__id__])}}},addProgram:function(a,b,c){null==c&&(c=!1);a.addToDisplay(this,b,c)},__class__:Xd};var jf={fromRenderContext:function(a){if(null!=a.webgl2)return ja.trace("WEBGL2 detected.",{fileName:"peote/view/PeoteGL.hx",lineNumber:86,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),X.isUBO=!0,X.isINSTANCED=!0,X.isVAO=!0,X.isES3=!0,a.webgl2;if(null!=a.webgl)return ja.trace("WEBGL1 detected.",
{fileName:"peote/view/PeoteGL.hx",lineNumber:91,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),a.webgl;window.alert("Error: missing webgl context");return null}},X=function(){};d["peote.view.Version"]=X;X.__name__=!0;var ib=function(){};d["peote.view.Precision"]=ib;ib.__name__=!0;var Wd=function(a,b,c){null==c&&(c=!0);null==b&&(b=255);this.speed=1;this.startTime=this.stopTime=0;this.isRun=!1;this.xOffset=this.yOffset=0;this.xz=this.yz=1;this.maskState=0;this.glStateAlpha=
this.glStateDepth=!1;this.colorState=!0;this.alpha=1;this.red=this.green=this.blue=0;this.gl=jf.fromRenderContext(a.context);this.width=a.__width;this.height=a.__height;this.red=(b>>24&255)/255;this.green=(b>>16&255)/255;this.blue=(b>>8&255)/255;this.alpha=(b&255)/255;X.isUBO&&(this.uniformBuffer=new Qd,this.uniformBuffer.createGLBuffer(this.gl,this.width,this.height,this.xOffset,this.yOffset,this.xz,this.yz));this.maxTextureImageUnits=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS);this.glStateTexture=
b=Array(this.maxTextureImageUnits);b=this.gl;var e=b.VERTEX_SHADER,f=ib.VertexFloat,d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(f.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(f.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(f.low=d.precision);e=b.VERTEX_SHADER;f=ib.VertexInt;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(f.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(f.medium=d.precision);d=b.getShaderPrecisionFormat(e,
b.LOW_FLOAT);null!=d&&(f.low=d.precision);e=b.VERTEX_SHADER;f=ib.VertexSampler;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(f.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(f.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(f.low=d.precision);e=b.FRAGMENT_SHADER;f=ib.FragmentFloat;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(f.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(f.medium=d.precision);d=
b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(f.low=d.precision);e=b.FRAGMENT_SHADER;f=ib.FragmentInt;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(f.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(f.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(f.low=d.precision);e=b.FRAGMENT_SHADER;f=ib.FragmentSampler;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(f.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=
d&&(f.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(f.low=d.precision);X.isINSTANCED?(this.pickInt32=b=new Int32Array(4),this.pickTexture=Fb.createPickingTexture(this.gl,!0)):(this.pickUInt8=b=new Uint8Array(4),this.pickTexture=Fb.createPickingTexture(this.gl));this.pickDepthBuffer=this.gl.createRenderbuffer();b=this.gl;e=this.pickTexture;f=this.pickDepthBuffer;d=b.createFramebuffer();b.bindRenderbuffer(b.RENDERBUFFER,f);hb.clearGlErrorQueue(b);b.renderbufferStorage(b.RENDERBUFFER,
b.DEPTH_COMPONENT24,1,1);hb.getLastGlError(b)==b.INVALID_ENUM&&(ja.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,1,1));b.bindFramebuffer(b.FRAMEBUFFER,d);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,f);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,e,0);if(b.checkFramebufferStatus(b.FRAMEBUFFER)!=
b.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindRenderbuffer(b.RENDERBUFFER,null);this.pickFB=d;this.background=new Le(this.gl);this.displayList=new Rd(new zb);this.framebufferDisplayList=new Rd(new zb);c&&(a.onRender.add(p(this,this.render)),a.onResize.add(p(this,this.resize)))};d["peote.view.PeoteView"]=Wd;Wd.__name__=!0;Wd.prototype={isTextureStateChange:function(a,b){return b.updated?(b.updated=!1,this.glStateTexture=Array(this.maxTextureImageUnits),
this.glStateTexture[a]=b.glTexture,!0):this.glStateTexture[a]!=b.glTexture?(this.glStateTexture[a]=b.glTexture,!0):!1},start:function(){if(!this.isRun){var a=this.stopTime;this.startTime=this.stopTime=(new Date).getTime()/1E3-a;this.isRun=!0}},addDisplay:function(a,b,c){null==c&&(c=!1);a.addToPeoteView(this,b,c)},resize:function(a,b){this.width=a;this.height=b;if(X.isUBO){var c=this.uniformBuffer,e=this.gl;c.uniformBytes.b_UFloat32[0]=a;c.uniformBytes.b_UFloat32[1]=b;e.bindBuffer(e.UNIFORM_BUFFER,
c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,0,c.resolutionBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}},render:function(a){for(this.displayListItem=this.framebufferDisplayList.first;null!=this.displayListItem;){if(this.displayListItem.value._renderFramebufferEnabled)if(this.displayListItem.value.renderFramebufferFrame==this.displayListItem.value.renderFramebufferSkipFrames){var b=this.displayListItem.value;a=null;null==a&&(a=b.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,
b.fbTexture.framebuffer);this.gl.viewport(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.scissor(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);b.fbTexture.clearOnRenderInto?this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|
this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(b.backgroundEnabled){1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=b.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&
(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=0);this.background.render(b.red,b.green,b.blue,b.alpha)}for(b.programListItem=b.programList.first;null!=b.programListItem;){a=b.programListItem.value;a.gl.useProgram(a.glProgram);for(a.textureListItem=a.textureList.first;null!=a.textureListItem;)this.isTextureStateChange(a.textureListItem.value.unit,a.textureListItem.value.texture)&&(a.gl.activeTexture(a.gl.TEXTURE0+a.textureListItem.value.unit),a.gl.bindTexture(a.gl.TEXTURE_2D,
a.textureListItem.value.texture.glTexture)),a.gl.uniform1i(a.textureListItem.value.uniformLoc,a.textureListItem.value.unit),a.textureListItem=a.textureListItem.next;X.isUBO?(a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,0,b.uniformBufferViewFB.uniformBuffer),a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,1,b.uniformBufferFB.uniformBuffer)):(a.gl.uniform2f(a.uRESOLUTION,b.width,-b.height),a.gl.uniform2f(a.uZOOM,b.xz,b.yz),a.gl.uniform2f(a.uOFFSET,(b.xOffset+this.xOffset)/b.xz,(b.yOffset+this.yOffset-b.height)/
b.yz));a.gl.uniform1f(a.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(var e=a.uniformFloats.length;c<e;){var f=c++;a.gl.uniform1f(a.uniformFloatLocations[f],a.uniformFloats[f].value)}c=a.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=a.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=a.alphaEnabled)&&
!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=a.mask;e=a.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&
this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);a.buffer.render(this,b,a);a.gl.useProgram(null);b.programListItem=b.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);b.fbTexture.createMipmaps&&(this.gl.bindTexture(this.gl.TEXTURE_2D,b.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null),b.fbTexture.updated=!0);this.displayListItem.value.renderFramebufferFrame=
0}else this.displayListItem.value.renderFramebufferFrame++;this.displayListItem=this.displayListItem.next}b=this.width;c=this.height;this.gl.viewport(0,0,b,c);this.gl.scissor(0,0,b,c);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(this.red,this.green,this.blue,this.alpha);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);for(this.displayListItem=
this.displayList.first;null!=this.displayListItem;){a=this.displayListItem.value;if(a.isVisible){b=this.width;c=this.height;var d=this.xz,h=this.yz;e=Math.floor((a.x+this.xOffset)*d);f=Math.floor((a.y+this.yOffset)*h);d=Math.floor(a.width*d);h=Math.floor(a.height*h);0>e&&(d+=e);e=Math.max(0,Math.min(b,e))|0;d=Math.max(0,Math.min(b-e,d))|0;0>f&&(h+=f);f=Math.max(0,Math.min(c,f))|0;h=Math.max(0,Math.min(c-f,h))|0;this.gl.scissor(e,c-h-f,d,h);a.backgroundEnabled&&(1!=this.colorState&&(this.colorState=
!0,this.gl.colorMask(!0,!0,!0,!0)),(c=a.backgroundDepth)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST)),(c=a.backgroundAlpha)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND)),0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=0),this.background.render(a.red,
a.green,a.blue,a.alpha));for(a.programListItem=a.programList.first;null!=a.programListItem;){b=a.programListItem.value;if(b.isVisible){b.gl.useProgram(b.glProgram);for(b.textureListItem=b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),b.gl.uniform1i(b.textureListItem.value.uniformLoc,
b.textureListItem.value.unit),b.textureListItem=b.textureListItem.next;X.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,this.uniformBuffer.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,1,a.uniformBuffer.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,this.width,this.height),b.gl.uniform2f(b.uZOOM,this.xz*a.xz,this.yz*a.yz),b.gl.uniform2f(b.uOFFSET,(a.x+a.xOffset+this.xOffset)/a.xz,(a.y+a.yOffset+this.yOffset)/a.yz));b.gl.uniform1f(b.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:
this.stopTime)*this.speed);c=0;for(e=b.uniformFloats.length;c<e;)f=c++,b.gl.uniform1f(b.uniformFloatLocations[f],b.uniformFloats[f].value);c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&
(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),
this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);b.buffer.render(this,a,b);b.gl.useProgram(null)}a.programListItem=a.programListItem.next}}this.displayListItem=this.displayListItem.next}},__class__:Wd};var Kd=function(a,b,c){this.unit=a;this.texture=b;this.uniformLoc=c};d["peote.view.ActiveTexture"]=Kd;Kd.__name__=!0;Kd.prototype={__class__:Kd};var Je=function(a,b,c,e,f,d,h,l,n){null==n&&(n=16384);null==l&&(l=!1);null==h&&(h=0);null==d&&(d=0);null==f&&(f=!1);null==e&&(e=4);null==c&&(c=
1);this.displays=[];this.programs=[];this.useFloat=this.updated=!1;this.magFilter=this.minFilter=0;this.createMipmaps=!1;this.images=new zb;this.imageSlots=this.freeSlots=this.slotsX=this.slotsY=this.tilesX=this.tilesY=1;this.width=this.height=0;this.colorChannels=4;this.clearOnRenderInto=!0;this.gl=this.glTexture=this.framebuffer=this.glDepthBuffer=null;this.slotWidth=a;this.slotHeight=b;this.imageSlots=this.freeSlots=c;this.colorChannels=e;this.createMipmaps=f;this.magFilter=h;this.minFilter=d;
this.useFloat=l;a=Fb.optimalTextureSize(c,a,b,n);this.width=a.width;this.height=a.height;this.slotsX=a.slotsX;this.slotsY=a.slotsY};d["peote.view.Texture"]=Je;Je.__name__=!0;Je.prototype={setImage:function(a,b,c,e){null==b&&(b=0);if(null!=this.images.h.__keys__[a.__id__])throw y.thrown("Error, image is already inside texture inside slot "+this.images.h[a.__id__].imageSlot);null!=c&&(this.tilesX=c);null!=e&&(this.tilesY=e);this.images.set(a,{imageSlot:b});this.freeSlots--;if(null!=this.gl){if(null==
this.glTexture){if(this.width>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)||this.height>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");this.glTexture=Fb.createEmptyTexture(this.gl,this.width,this.height,this.colorChannels,this.createMipmaps,this.magFilter,this.minFilter,this.useFloat)}this.bufferImage(a,{imageSlot:b})}},bufferImage:function(a,b){var c=this.gl,e=b.imageSlot%this.slotsX*this.slotWidth;b=this.slotHeight*Math.floor(b.imageSlot/
this.slotsX);var f=a.width,d=a.height,h=this.createMipmaps,l=this.useFloat;null==l&&(l=!1);null==h&&(h=!1);c.bindTexture(c.TEXTURE_2D,this.glTexture);if(l){l=f*d*4;l=null!=l?new Float32Array(l):null;for(var n=0,m=f*d*4;n<m;){var C=n++;l[C]=Hb.toFloat(a.get_data()[C])/Hb.toFloat(255)}c.texSubImage2D(c.TEXTURE_2D,0,e,b,f,d,c.RGBA,c.FLOAT,l)}else c.texSubImage2D(c.TEXTURE_2D,0,e,b,f,d,c.RGBA,c.UNSIGNED_BYTE,a.get_data());h&&c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null);this.updated=
!0},__class__:Je};var Pd=function(){var a=this.uniformBytes=new xb(new ArrayBuffer(32)),b=0;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=4;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b)};d["peote.view.UniformBufferDisplay"]=
Pd;Pd.__name__=!0;Pd.prototype={createGLBuffer:function(a,b,c,e,f){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=f;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},__class__:Pd};
var Qd=function(){var a=this.uniformBytes=new xb(new ArrayBuffer(48)),b=0;null==b&&(b=0);this.resolutionBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=16;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=20;null==b&&(b=0);this.yZoomBufferPointer=
a=new Uint8Array(a.b.bufferValue,b)};d["peote.view.UniformBufferView"]=Qd;Qd.__name__=!0;Qd.prototype={createGLBuffer:function(a,b,c,e,f,d,h){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=f;this.uniformBytes.b_UFloat32[4]=d;this.uniformBytes.b_UFloat32[5]=h;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,
b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},__class__:Qd};var We=function(a,b){this.name=a;this.value=b};d["peote.view.UniformFloat"]=We;We.__name__=!0;We.prototype={__class__:We};var Le=function(a){this.gl=a;this.createBuffer();this.createProgram()};d["peote.view.utils.Background"]=Le;Le.__name__=!0;Le.prototype={createBuffer:function(){var a=new xb(new ArrayBuffer(32));a.b_UFloat32[0]=1;a.b_UFloat32[1]=1;a.b_UFloat32[2]=0;
a.b_UFloat32[3]=1;a.b_UFloat32[4]=1;a.b_UFloat32[5]=0;a.b_UFloat32[6]=0;a.b_UFloat32[7]=0;this.buffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);a=new Uint8Array(a.b.bufferValue,0);this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},createProgram:function(){var a="",b=ib.VertexFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=ib.VertexFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));
b=this.gl;var c=this.gl.VERTEX_SHADER,e=b.createShader(c);b.shaderSource(e,a+"\t\n\t\t\tattribute vec2 aPosition;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_Position = mat4 (\n\t\t\t\t\tvec4(2.0, 0.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, -2.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, 0.0, -1.0, 0.0),\n\t\t\t\t\tvec4(-1.0, 1.0, 0.0, 1.0)\n\t\t\t\t) * vec4 (aPosition, -1.0 ,1.0);\n\t\t\t}\n\t\t");b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw y.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?
"vertex":"fragment")+" shader\n"+E.string(b.getShaderInfoLog(e)));var f=e;b=ib.FragmentFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=ib.FragmentFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));b=this.gl;c=this.gl.FRAGMENT_SHADER;e=b.createShader(c);b.shaderSource(e,a+"\n\t\t\tuniform vec4 uRGBA;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_FragColor = uRGBA;\n\t\t\t\t\n\t\t\t\t// TODO: Fix for old FF\n\t\t\t\tgl_FragColor.w = clamp(uRGBA.w, 0.003, 1.0);\n\t\t\t}\n\t\t");
b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw y.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+E.string(b.getShaderInfoLog(e)));a=e;this.glProgram=this.gl.createProgram();this.gl.attachShader(this.glProgram,f);this.gl.attachShader(this.glProgram,a);this.gl.deleteShader(f);this.gl.deleteShader(a);this.gl.bindAttribLocation(this.glProgram,0,"aPosition");b=this.gl;f=this.glProgram;b.linkProgram(f);if(0==b.getProgramParameter(f,b.LINK_STATUS))throw y.thrown(E.string(b.getProgramInfoLog(f))+
"VALIDATE_STATUS: "+E.string(b.getProgramParameter(f,b.VALIDATE_STATUS))+"ERROR: "+E.string(b.getError()));this.uRGBA=this.gl.getUniformLocation(this.glProgram,"uRGBA")},render:function(a,b,c,e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);this.gl.enableVertexAttribArray(0);this.gl.vertexAttribPointer(0,2,this.gl.FLOAT,!1,8,0);this.gl.useProgram(this.glProgram);this.gl.uniform4f(this.uRGBA,a,b,c,e);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);this.gl.disableVertexAttribArray(0);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
null)},__class__:Le};var xb=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b;this.b_UFloat32=new Float32Array(a);this.b_Int32=new Int32Array(a);this.b_Uint16=new Uint16Array(a)};d["peote.view.utils.BufferBytes"]=xb;xb.__name__=!0;xb.prototype={blit:function(a,b,c,e){0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},fill:function(a,b,c){for(var e=0;e<b;)e++,this.b[a++]=c},__class__:xb};var hb=function(){};d["peote.view.utils.GLTool"]=
hb;hb.__name__=!0;hb.clearGlErrorQueue=function(a){for(;a.getError()!=a.NO_ERROR;);};hb.getLastGlError=function(a){var b=a.getError();b!=a.NO_ERROR&&(b==a.INVALID_ENUM?ja.trace("(GL-Error: INVALID_ENUM)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:22,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.INVALID_VALUE?ja.trace("(GL-Error: INVALID_VALUE)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:23,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==
a.INVALID_OPERATION?ja.trace("(GL-Error: INVALID_OPERATION)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:24,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.OUT_OF_MEMORY?ja.trace("(GL-Error: OUT_OF_MEMORY)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:25,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):ja.trace("GL-Error: "+b,{fileName:"peote/view/utils/GLTool.hx",lineNumber:26,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}));return b};
var sc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_ActiveTexture"]=sc;sc.__name__=!0;sc.prototype={__class__:sc};var yc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_Display"]=yc;yc.__name__=!0;yc.prototype={__class__:yc};var Fc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=
this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_Program"]=Fc;Fc.__name__=!0;Fc.prototype={__class__:Fc};var Jd=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_ActiveTexture"]=Jd;Jd.__name__=!0;Jd.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new sc(a,null,null);else if(null==b)b=this.first=new sc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new sc(a,c.prev,c),c==this.first&&(this.first=
b);else throw y.thrown("Error on add: "+E.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new sc(a,null,null);else if(null==b)b=this.last=new sc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new sc(a,c,c.next),c==this.last&&(this.last=b);else throw y.thrown("Error on add: "+E.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=
c.prev));this.itemMap.set(a,b)},clear:function(){for(;null!=this.first;){null!=this.last.value&&this.itemMap.remove(this.last.value);var a=this.last;a==this.first&&(this.first=a.next);a==this.last&&(this.last=a.prev);null!=a.prev&&(a.prev.next=a.next);null!=a.next&&(a.next.prev=a.prev)}},__class__:Jd};var Rd=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_Display"]=Rd;Rd.__name__=!0;Rd.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=
this.last=new yc(a,null,null);else if(null==b)b=this.first=new yc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new yc(a,c.prev,c),c==this.first&&(this.first=b);else throw y.thrown("Error on add: "+E.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new yc(a,null,null);else if(null==b)b=this.last=new yc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new yc(a,c,c.next),c==this.last&&(this.last=b);else throw y.thrown("Error on add: "+E.string(b)+" is not in list.");
c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},__class__:Rd};var Ke=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_Program"]=Ke;Ke.__name__=!0;Ke.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new Fc(a,null,null);else if(null==b)b=this.first=new Fc(a,null,this.first);else if(c=
this.itemMap.get(b),null!=c)b=new Fc(a,c.prev,c),c==this.first&&(this.first=b);else throw y.thrown("Error on add: "+E.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new Fc(a,null,null);else if(null==b)b=this.last=new Fc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new Fc(a,c,c.next),c==this.last&&(this.last=b);else throw y.thrown("Error on add: "+E.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&
(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},__class__:Ke};var Fb=function(){};d["peote.view.utils.TexUtils"]=Fb;Fb.__name__=!0;Fb.createEmptyTexture=function(a,b,c,e,f,d,h,l){null==l&&(l=!1);null==h&&(h=0);null==d&&(d=0);null==f&&(f=!1);e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e);hb.clearGlErrorQueue(a);if(l){l=a.TEXTURE_2D;var g=a.RGBA32F,n=a.RGBA,m=a.FLOAT,r=0;0==r?a.texImage2D(l,0,g,b,c,0,n,m,null):a.texImage2D(l,0,g,b,
c,0,n,m,r);hb.getLastGlError(a)==a.INVALID_VALUE&&(ja.trace("switching to RGBA16F for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:25,className:"peote.view.utils.TexUtils",methodName:"createEmptyTexture"}),l=a.TEXTURE_2D,g=a.RGBA16F,n=a.RGBA,m=a.FLOAT,r=0,0==r?a.texImage2D(l,0,g,b,c,0,n,m,null):a.texImage2D(l,0,g,b,c,0,n,m,r),hb.getLastGlError(a)==a.INVALID_VALUE&&(ja.trace("switching to RGBA for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",
lineNumber:28,className:"peote.view.utils.TexUtils",methodName:"createEmptyTexture"}),l=a.TEXTURE_2D,n=g=a.RGBA,m=a.FLOAT,r=0,0==r?a.texImage2D(l,0,g,b,c,0,n,m,null):a.texImage2D(l,0,g,b,c,0,n,m,r)))}else l=a.TEXTURE_2D,n=g=a.RGBA,m=a.UNSIGNED_BYTE,r=0,0==r?a.texImage2D(l,0,g,b,c,0,n,m,null):a.texImage2D(l,0,g,b,c,0,n,m,r);if(hb.getLastGlError(a)==a.OUT_OF_MEMORY)throw y.thrown("OUT OF GPU MEMORY while texture creation");1==d?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MAG_FILTER,a.NEAREST);if(f)switch(h){case 1:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR);break;case 2:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_NEAREST);break;case 3:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_LINEAR);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST)}else 1==h?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);f&&a.generateMipmap(a.TEXTURE_2D);a.bindTexture(a.TEXTURE_2D,null);return e};Fb.createPickingTexture=function(a,b){null==b&&(b=!1);var c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c);if(b){b=a.TEXTURE_2D;var e=a.RGBA32I,f=a.RGBA_INTEGER,d=a.INT,h=0}else b=a.TEXTURE_2D,f=e=a.RGBA,d=a.UNSIGNED_BYTE,h=0;0==h?a.texImage2D(b,0,e,1,1,0,f,d,null):a.texImage2D(b,0,e,1,
1,0,f,d,h);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null);return c};Fb.optimalTextureSize=function(a,b,c,e,f,d){null==f&&(f=!0);d=Math.ceil(Math.log(e)/Math.log(2));for(var g=Math.ceil(Math.log(a*b*c)/Math.log(2)),h,n=1,m=g-1,C=Math.floor(Math.abs(n-m)),r=(1<<d)*(1<<
d),q=!1,Q=Math.floor(Math.min(d,g)),w;1<<Q>=b;){for(w=Math.floor(Math.min(d,g-Q+1));1<<w>=c&&!(Math.floor((1<<Q)/b)*Math.floor((1<<w)/c)<a);){h=(1<<Q)*(1<<w)-a*b*c;if(0>h)break;h<=r&&(h==r?Math.abs(Q-w)<C&&(C=Math.floor(Math.abs(Q-w)),n=Q,m=w,q=!0):(n=Q,m=w,r=h,q=!0));--w}--Q}if(q)n=1<<n,m=1<<m;else{if(f)throw y.thrown("Error: max texture-size ("+e+") is to small for "+a+" images ("+b+" x "+c+")");if(b>e||c>e)throw y.thrown("Error: max texture-size ("+e+") is to small for image ("+b+" x "+c+")");
n=m=e}return{width:n,height:m,slotsX:n/b|0,slotsY:m/c|0,imageSlots:(n/b|0)*(m/c|0)}};var xc=function(){};d["peote.view.utils.Util"]=xc;xc.__name__=!0;xc.resolveFormulaCyclic=function(a){for(var b=[],c=a.h,e=Object.keys(c),f=e.length,d=0;d<f;)if(c=e[d++],c=xc.resolveFormulaKey(c,a,b),null!=c.errKey)throw y.thrown(c);c=a.h;b=Object.keys(c);e=b.length;for(f=0;f<e;)c=b[f++],d=a.h[c].replace(/___:::___/g,""),a.h[c]=d};xc.resolveFormulaKey=function(a,b,c,e){null==e&&(e=[a]);null==c&&(c=[]);var d=b.h[a];
if(0<=c.indexOf(a))return{formula:d,errKey:null,errVar:null};for(var g=Object.keys(b.h),h=g.length,l=0;l<h;){var n=g[l++];if(n!=a){var m=new Ca("(^|.*?[^\\w.])"+n+"\\b.*?","g");if(m.match(d)){if(0<=e.indexOf(n))return{formula:d,errKey:a,errVar:n};n=xc.resolveFormulaKey(n,b,c,e.concat([n]));if(null!=n.errKey)return n;d=d.replace(m.r,"$1(___:::___"+n.formula+"___:::___)")}}}b.h[a]=d;c.push(a);return{formula:d,errKey:null,errVar:null}};xc.resolveFormulaVars=function(a,b){for(var c=a.h,e=Object.keys(c),
d=e.length,g=0;g<d;){var h=e[g++],l=a.h[h];c=b.h;c=Object.keys(c);for(var n=c.length,m=0;m<n;){var C=c[m++],r=new Ca("(^|.*?[^\\w.])"+C+"\\b.*?","g");r.match(l)&&(l=l.replace(r.r,"$1("+b.h[C]+")"))}a.h[h]=l}};var dd=function(a,b,c,e,d){this.char=a;this.glyph=b;this.paletteIndexFg=c;this.paletteIndexBg=e;this.bgIntensity=d};d["tyke.GlyphModel"]=dd;dd.__name__=!0;dd.prototype={__class__:dd};var ge=function(a,b){this.numCellsWide=a;this.numCellsHigh=b};d["tyke.GlyphLoopConfig"]=ge;ge.__name__=!0;ge.prototype=
{__class__:ge};var Yd=function(a,b){null==b&&(b=-1);this.transparent=0;this.defaultBgIndex=b;this.colors=a};d["tyke.Palette"]=Yd;Yd.__name__=!0;Yd.prototype={colorOrDefault:function(a){return 0>a?this.transparent:this.colors[a]},__class__:Yd};var Hc=function(a,b){this.x=a;this.y=b};d["tyke.Point"]=Hc;Hc.__name__=!0;Hc.prototype={__class__:Hc};var Zd=function(a){this.sortOrder=[];this.bindings=new Gb;for(var b=0;b<a.length;){var c=a[b];++b;this._bind(c)}};d["tyke.KeyPresses_tyke_GlyphLoop"]=Zd;Zd.__name__=
!0;Zd.prototype={handle:function(a,b){this.lastHandled=a;this.bindings.exists(a)&&this.bindings.get(a).handle(b)},_bind:function(a){this.sortOrder.push(a.code);this.bindings.set(a.code,a)},__class__:Zd};var ae=function(a,b,c,e,d,g){this.numColumns=a;this.numRows=b;this.cellWidth=c;this.cellHeight=e;this.palette=d;this.cellInit=g};d["tyke.LayerConfig"]=ae;ae.__name__=!0;ae.prototype={__class__:ae};var Me=function(a,b,c){this.font=a;this.fontStyle=b;this.fontProgram=c};d["tyke.Text"]=Me;Me.__name__=
!0;Me.prototype={__class__:Me};var Oe=function(){};d["tyke.Glyphs"]=Oe;Oe.__name__=!0;Oe.initText=function(a,b){var c=b.createFontStyle();c.width=b.config.width;c.height=b.config.height;var e=b.createFontProgram(c);null!=a&&a.addProgram(e);return new Me(b,c,e)};var $d=function(){this.onMove=function(a,b){};this.onUp=function(a,b,c){ja.trace("mouse up "+a+" "+b+" "+c,{fileName:"tyke/Mouse.hx",lineNumber:11,className:"tyke.Mouse",methodName:"onUp"})};this.onDown=function(a,b,c){ja.trace("mouse down "+
a+" "+b+" "+c,{fileName:"tyke/Mouse.hx",lineNumber:7,className:"tyke.Mouse",methodName:"onDown"})}};d["tyke.Mouse"]=$d;$d.__name__=!0;$d.prototype={__class__:$d};var Ne=function(){};d["tyke.Sixteen"]=Ne;Ne.__name__=!0;var eb=function(){};d["utils.Loader"]=eb;eb.__name__=!0;eb.onProgressDebug=function(a,b,c){ja.trace("...loading "+a+"/"+b+' of "'+c+'"',{fileName:"utils/Loader.hx",lineNumber:11,className:"utils.Loader",methodName:"onProgressDebug"})};eb.onErrorDebug=function(a){ja.trace("Error - "+
a,{fileName:"utils/Loader.hx",lineNumber:15,className:"utils.Loader",methodName:"onErrorDebug"})};eb.onCompleteDebug=function(a){ja.trace('Loading complete "'+a+'"',{fileName:"utils/Loader.hx",lineNumber:19,className:"utils.Loader",methodName:"onCompleteDebug"})};var Tb=w["utils._MultipassTemplate.TemplateExpr"]={__ename__:!0,__constructs__:null,OpVar:(m=function(a){return{_hx_index:0,v:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:h}},m._hx_name="OpVar",m.__params__=["v"],m),OpExpr:(m=
function(a){return{_hx_index:1,expr:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:h}},m._hx_name="OpExpr",m.__params__=["expr"],m),OpIf:(m=function(a,b,c){return{_hx_index:2,expr:a,eif:b,eelse:c,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:h}},m._hx_name="OpIf",m.__params__=["expr","eif","eelse"],m),OpStr:(m=function(a){return{_hx_index:3,str:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:h}},m._hx_name="OpStr",m.__params__=["str"],m),OpBlock:(m=function(a){return{_hx_index:4,
l:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:h}},m._hx_name="OpBlock",m.__params__=["l"],m),OpForeach:(m=function(a,b){return{_hx_index:5,expr:a,loop:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:h}},m._hx_name="OpForeach",m.__params__=["expr","loop"],m),OpMacro:(m=function(a,b){return{_hx_index:6,name:a,params:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:h}},m._hx_name="OpMacro",m.__params__=["name","params"],m)};Tb.__constructs__=[Tb.OpVar,Tb.OpExpr,
Tb.OpIf,Tb.OpStr,Tb.OpBlock,Tb.OpForeach,Tb.OpMacro];var Fa=function(a){a=this.parseTokens(a);this.expr=this.parseBlock(a);if(!a.isEmpty())throw y.thrown("Unexpected '"+E.string(a.first().s)+"'");};d["utils.MultipassTemplate"]=Fa;Fa.__name__=!0;Fa.prototype={execute:function(a,b){this.macros=null==b?{}:b;this.context=a;this.stack=new wb;this.buf=new kb;this.run(this.expr);return this.buf.b},resolve:function(a){if("__current__"==a)return this.context;var b=R.getProperty(this.context,a);if(null!=b||
Object.prototype.hasOwnProperty.call(this.context,a))return b;for(var c=this.stack.h;null!=c;){b=c.item;c=c.next;var e=b;b=R.getProperty(e,a);if(null!=b||Object.prototype.hasOwnProperty.call(e,a))return b}if(!Object.prototype.hasOwnProperty.call(Fa.globals,a))throw y.thrown(a);return R.field(Fa.globals,a)},parseTokens:function(a){for(var b=new wb;Fa.splitter.match(a);){var c=Fa.splitter.matchedPos();0<c.pos&&b.add({p:K.substr(a,0,c.pos),s:!0,l:null});if(58==K.cca(a,c.pos))b.add({p:K.substr(a,c.pos+
2,c.len-4),s:!1,l:null}),a=Fa.splitter.matchedRight();else{c=c.pos+c.len;for(var e=1,d=[],g="";;){var h=K.cca(a,c);++c;if(40==h)++e;else if(41==h){if(--e,0>=e)break}else if(null==h)throw y.thrown("Unclosed macro parenthesis");44==h&&1==e?(d.push(g),g=""):g+=String.fromCodePoint(h)}d.push(g);b.add({p:Fa.splitter.matched(2),s:!1,l:d});a=K.substr(a,c,a.length-c)}}0<a.length&&b.add({p:a,s:!0,l:null});return b},parseBlock:function(a){for(var b=new wb;;){var c=a.first();if(null==c)break;if(!c.s&&("end"==
c.p||"else"==c.p||"elseif "==K.substr(c.p,0,7)))break;b.add(this.parse(a))}return 1==b.length?b.first():Tb.OpBlock(b)},parse:function(a){var b=a.pop(),c=b.p;if(b.s)return Tb.OpStr(c);if(null!=b.l){a=new wb;var e=0;for(b=b.l;e<b.length;){var d=b[e];++e;a.add(this.parseBlock(this.parseTokens(d)))}return Tb.OpMacro(c,a)}if("if "==K.substr(c,0,3)){c=K.substr(c,3,c.length-3);e=null;try{e=this.parseExpr(c)}catch(g){oa.lastError=g;b=y.caught(g).unwrap();if("string"==typeof b)throw ja.trace(b,{fileName:"utils/MultipassTemplate.hx",
lineNumber:211,className:"utils.MultipassTemplate",methodName:"parse"}),y.thrown(b);throw g;}c=this.parseBlock(a);b=a.first();if(null==b)throw y.thrown("Unclosed 'if'");if("end"==b.p)a.pop(),d=null;else if("else"==b.p){if(a.pop(),d=this.parseBlock(a),b=a.pop(),null==b||"end"!=b.p)throw y.thrown("Unclosed 'else'");}else b.p=K.substr(b.p,4,b.p.length-4),d=this.parse(a);return Tb.OpIf(e,c,d)}if("foreach "==K.substr(c,0,8)){c=K.substr(c,8,c.length-8);e=this.parseExpr(c);c=this.parseBlock(a);b=a.pop();
if(null==b||"end"!=b.p)throw y.thrown("Unclosed 'foreach'");return Tb.OpForeach(e,c)}return Fa.expr_splitter.match(c)?Tb.OpExpr(this.parseExpr(c)):Tb.OpVar(c)},parseExpr:function(a){for(var b=new wb,c=a;Fa.expr_splitter.match(a);){var e=Fa.expr_splitter.matchedPos();0!=e.pos&&b.add({p:K.substr(a,0,e.pos),s:!0});a=Fa.expr_splitter.matched(0);b.add({p:a,s:0<=a.indexOf('"')});a=Fa.expr_splitter.matchedRight()}0!=a.length&&b.add({p:a,s:!0});try{var d=this.makeExpr(b);if(!b.isEmpty())throw y.thrown(b.first().p);
}catch(g){oa.lastError=g;b=y.caught(g).unwrap();if("string"==typeof b)throw y.thrown("Unexpected '"+b+"' in "+c);throw g;}return function(){try{return d()}catch(x){oa.lastError=x;var a=y.caught(x).unwrap();throw y.thrown({v:a,expr:c});}}},makeConst:function(a){Fa.expr_trim.match(a);a=Fa.expr_trim.matched(1);if(34==K.cca(a,0)){var b=K.substr(a,1,a.length-2);return function(){return b}}if(Fa.expr_int.match(a)){var c=E.parseInt(a);return function(){return c}}if(Fa.expr_float.match(a)){var e=parseFloat(a);
return function(){return e}}var d=this;return function(){return d.resolve(a)}},makePath:function(a,b){var c=b.first();if(null==c||"."!=c.p)return a;b.pop();c=b.pop();if(null==c||!c.s)throw y.thrown(c.p);var e=c.p;Fa.expr_trim.match(e);e=Fa.expr_trim.matched(1);return this.makePath(function(){return R.field(a(),e)},b)},makeExpr:function(a){return this.makePath(this.makeExpr2(a),a)},makeExpr2:function(a){var b=a.pop();if(null==b)throw y.thrown("<eof>");if(b.s)return this.makeConst(b.p);switch(b.p){case "!":var c=
this.makeExpr(a);return function(){var a=c();return null!=a?0==a:!0};case "(":var e=this.makeExpr(a);b=a.pop();if(null==b||b.s)throw y.thrown(b);if(")"==b.p)return e;var d=this.makeExpr(a);a=a.pop();if(null==a||")"!=a.p)throw y.thrown(a);switch(b.p){case "!=":return function(){return e()!=d()};case "&&":return function(){return e()&&d()};case "*":return function(){return e()*d()};case "+":return function(){return e()+d()};case "-":return function(){return e()-d()};case "/":return function(){return e()/
d()};case "<":return function(){return e()<d()};case "<=":return function(){return e()<=d()};case "==":return function(){return e()==d()};case ">":return function(){return e()>d()};case ">=":return function(){return e()>=d()};case "||":return function(){return e()||d()};default:throw y.thrown("Unknown operation "+b.p);}case "-":var g=this.makeExpr(a);return function(){return-g()}}throw y.thrown(b.p);},run:function(a){switch(a._hx_index){case 0:var b=a.v;try{var c=this.buf,e=E.string(this.resolve(b));
c.b+=E.string(e)}catch(la){oa.lastError=la,this.buf.b+=E.string("::"+b+"::")}break;case 1:var d=a.expr;try{c=this.buf,e=E.string(d()),c.b+=E.string(e)}catch(la){oa.lastError=la,b=y.caught(la).unwrap(),this.buf.b+=E.string("::("+E.string(b.expr)+")::")}break;case 2:d=a.expr;e=a.eif;c=a.eelse;try{b=d(),null==b||0==b?null!=c&&this.run(c):this.run(e)}catch(la){oa.lastError=la,b=y.caught(la).unwrap(),this.buf.b+=E.string("::if "+E.string(b.expr)+"::"),this.run(e),null!=c&&(this.buf.b+="::else::",this.run(c)),
this.buf.b+="::end::"}break;case 3:b=a.str;this.buf.b+=null==b?"null":""+b;break;case 4:for(a=a.l.h;null!=a;){var g=a.item;a=a.next;d=g;this.run(d)}break;case 5:d=a.expr;c=a.loop;try{b=d();try{e=B(b);if(null==e.hasNext)throw y.thrown(null);b=e}catch(la){oa.lastError=la;try{if(null==b.hasNext)throw y.thrown(null);}catch(A){throw y.thrown("Cannot iter on "+E.string(b));}}for(this.stack.push(this.context);b.hasNext();)this.context=b.next(),this.run(c);this.context=this.stack.pop()}catch(la){oa.lastError=
la,b=y.caught(la).unwrap(),this.buf.b+=E.string("::foreach "+E.string(b.v)+"::"),this.run(c),this.buf.b+="::end::"}break;case 6:d=a.name;a=a.params;b=R.field(this.macros,d);var h=[],l=this.buf;h.push(p(this,this.resolve));for(a=a.h;null!=a;)g=a.item,a=a.next,0==g._hx_index?(g=g.v,h.push(this.resolve(g))):(this.buf=new kb,this.run(g),h.push(this.buf.b));this.buf=l;try{c=this.buf,e=E.string(b.apply(this.macros,h)),c.b+=E.string(e)}catch(la){oa.lastError=la;a=y.caught(la).unwrap();try{var n=h.join(",")}catch(A){n=
"???"}b="Macro call "+d+"("+n+") failed ("+E.string(a)+")";throw y.thrown(b);}}},__class__:Fa};v.$haxeUID|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(K.now=performance.now.bind(performance));d.Math=Math;null==String.fromCodePoint&&(String.fromCodePoint=function(a){return 65536>a?String.fromCharCode(a):String.fromCharCode((a>>10)+55232)+String.fromCharCode((a&1023)+56320)});String.prototype.__class__=d.String=String;String.__name__=!0;d.Array=Array;Array.__name__=!0;Date.prototype.__class__=
d.Date=Date;Date.__name__="Date";var ef={},cf={},df=Number,bf=Boolean,ff={},gf={};zb.count=0;xa.__toStr={}.toString;var Ze=new Uint32Array(256);Sb.__alpha16=Ze;for(var zc=0;256>zc;){var cd=zc++;Sb.__alpha16[cd]=Math.ceil(257.00392156862745*cd)}Ze=new Uint8Array(511);Sb.__clamp=Ze;for(zc=0;255>zc;)cd=zc++,Sb.__clamp[cd]=cd;for(zc=255;511>zc;)cd=zc++,Sb.__clamp[cd]=255;va.level=3;"undefined"==typeof console&&(console={});null==console.log&&(console.log=function(){});cb.default_mass=-1;cb.minimum_mass=
1E-4;cb.ids=0;Ea.qr=[];Ea.sqr=[];sa.cached_listeners=new Pc;sa.cached_collisions=[];sa.cached_body=new cb({mass:1});Ib.pool=new hd(Ib);cc.global=new cc(null,null,null,null,null);dc.pool=new Ad(dc);uc.pool=new Kc(uc);Qb.pool=new id(Qb);Wb.pool=new Rc(Wb);Bb.pool=new Lc(Bb);Xa.pool=new jd(Xa);tb.pool=new Bd(tb);ab.pool=new Cd(ab);Pa.pool=new Dd(Pa);Ba.norm=new O(0,0);Ba.closest=new O(0,0);Jb.DEFAULT_RESOLVER=new md;Jb.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";nb.LEN_EXTRA_BITS_TBL=
[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1];nb.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];nb.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1];nb.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];nb.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];U.activeRequests=0;U.requestLimit=
17;U.requestQueue=new wb;sd.windowID=0;nc.DICTIONARY="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");nc.EXTENDED_DICTIONARY=function(a){a=[];for(var b=0,c=nc.DICTIONARY;b<c.length;){var e=c[b];++b;for(var d=0,g=nc.DICTIONARY;d<g.length;){var h=g[d];++d;a.push(e+h)}}return a}(this);pc.sensorByID=new Gb;pc.sensors=[];bb.devices=new Gb;bb.onConnect=new Ce;$a.devices=new Gb;$a.onConnect=new De;Lb.onCancel=new qc;Lb.onEnd=new qc;Lb.onMove=new qc;Lb.onStart=new qc;Y.cache=new Ge;
Y.onChange=new Ra;Y.bundlePaths=new S;Y.libraries=new S;Y.libraryPaths=new S;va.throwErrors=!0;La.FORMULAS=new S;La.ATTRIBUTES=function(a){a=new S;a.h.zStart="aRotZ";a.h.zEnd="aRotZ";a.h.z="aRotZ";a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);La.FORMULA_NAMES=function(a){a=new S;a.h.sizeX="w";a.h.sizeY="h";a.h.posX=
"x";a.h.posY="y";a.h.zIndex="z";return a}(this);La.FORMULA_VARYINGS="";La.FORMULA_CONSTANTS="";La.FORMULA_CUSTOMS="";La.DEFAULT_FORMULA_VARS=new S;ia.__meta__={fields:{x:{posX:null},y:{posY:null},color:{color:null},bgColor:{color:null},weight:{custom:null,varying:null},tilt:{custom:null},zIndex:{zIndex:null},width:{sizeX:null,varying:null},height:{sizeY:null},tile:{texTile:null}}};ia.FORMULAS=new S;ia.ATTRIBUTES=function(a){a=new S;a.h.zIndexStart="aRotZ";a.h.zIndexEnd="aRotZ";a.h.zIndex="aRotZ";
a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.widthStart="aSize.x";a.h.widthEnd="aSize.x";a.h.width="aSize.x";a.h.weightStart="aFloat0.x";a.h.weightEnd="aFloat0.x";a.h.weight="aFloat0.x";a.h.tiltStart="aFloat0.y";a.h.tiltEnd="aFloat0.y";a.h.tilt="aFloat0.y";a.h.tileStart="aShort0";a.h.tileEnd="aShort0";a.h.tile="aShort0";a.h.heightStart="aSize.y";a.h.heightEnd="aSize.y";a.h.height="aSize.y";return a}(this);ia.FORMULA_NAMES=function(a){a=
new S;a.h.sizeX="width";a.h.sizeY="height";a.h.posX="x";a.h.posY="y";a.h.zIndex="zIndex";return a}(this);ia.FORMULA_VARYINGS="weight,tile";ia.FORMULA_CONSTANTS="";ia.FORMULA_CUSTOMS="tilt";ia.DEFAULT_FORMULA_VARS=new S;Ga.FORMULAS=new S;Ga.ATTRIBUTES=function(a){a=new S;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);
Ga.FORMULA_NAMES=function(a){a=new S;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";return a}(this);Ga.FORMULA_VARYINGS="";Ga.FORMULA_CONSTANTS="";Ga.FORMULA_CUSTOMS="";Ga.DEFAULT_FORMULA_VARS=new S;X.isES3=!1;X.isUBO=!1;X.isINSTANCED=!1;X.isVAO=!1;ib.VertexFloat={high:0,medium:0,low:0};ib.VertexInt={high:0,medium:0,low:0};ib.VertexSampler={high:0,medium:0,low:0};ib.FragmentFloat={high:0,medium:0,low:0};ib.FragmentInt={high:0,medium:0,low:0};ib.FragmentSampler={high:0,medium:0,low:0};hb.rEmptylines=
new Ca("([ \t]*\r?\n)+","g");hb.rStartspaces=new Ca("^([ \t]*\r?\n)+","g");Ne.Versitle=[789263,11485010,6240601,3025207,9460890,14126402,9656635,9278124,13926320,14540112,7714118,4877746,15977364,15724777,10999514,5677512];eb.corsServer="";Fa.splitter=new Ca('(::[A-Za-z0-9_ ()&|!+=/><*."-]+::|\\$\\$([A-Za-z0-9_-]+)\\()',"");Fa.expr_splitter=new Ca('(\\(|\\)|[ \r\n\t]*"[^"]*"[ \r\n\t]*|[!+=/><*.&|-]+)',"");Fa.expr_trim=new Ca("^[ ]*([^ ]+)[ ]*$","");Fa.expr_int=new Ca("^[0-9]+$","");Fa.expr_float=
new Ca("^([+-]?)(?=\\d|,\\d)\\d*(,\\d*)?([Ee]([+-]?\\d+))?$","");Fa.globals={};z.main()})("undefined"!=typeof k?k:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:this)};H.lime.embed=function(v){var t={},B=H.lime.$scripts[v];if(!B)throw Error('Cannot find project name "'+v+'"');B(t,k);for(var z in t)H[z]=H[z]||t[z];(B=t.lime||window.lime)&&B.embed&&this!=B.embed&&B.embed.apply(B,arguments);
return t};"function"==typeof define&&define.amd&&(define([],function(){return H.lime}),define.__amd=define.amd,define.amd=null)})("undefined"!=typeof exports?exports:"function"==typeof define&&define.amd?{}:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
!function(){var H=function(){this.init()};H.prototype={init:function(){var d=this||k;return d._counter=1E3,d._html5AudioPool=[],d.html5PoolSize=10,d._codecs={},d._howls=[],d._muted=!1,d._volume=1,d._canPlayEvent="canplaythrough",d._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,d.masterGain=null,d.noAudio=!1,d.usingWebAudio=!0,d.autoSuspend=!0,d.ctx=null,d.autoUnlock=!0,d._setup(),d},volume:function(d){var h=this||k;if(d=parseFloat(d),h.ctx||p(),void 0!==d&&0<=d&&1>=
d){if(h._volume=d,h._muted)return h;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(d,k.ctx.currentTime);for(var w=0;w<h._howls.length;w++)if(!h._howls[w]._webAudio)for(var m=h._howls[w]._getSoundIds(),t=0;t<m.length;t++){var L=h._howls[w]._soundById(m[t]);L&&L._node&&(L._node.volume=L._volume*d)}return h}return h._volume},mute:function(d){var h=this||k;h.ctx||p();h._muted=d;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(d?0:h._volume,k.ctx.currentTime);for(var w=0;w<h._howls.length;w++)if(!h._howls[w]._webAudio)for(var m=
h._howls[w]._getSoundIds(),t=0;t<m.length;t++){var L=h._howls[w]._soundById(m[t]);L&&L._node&&(L._node.muted=!!d||L._muted)}return h},unload:function(){for(var d=this||k,h=d._howls.length-1;0<=h;h--)d._howls[h].unload();return d.usingWebAudio&&d.ctx&&void 0!==d.ctx.close&&(d.ctx.close(),d.ctx=null,p()),d},codecs:function(d){return(this||k)._codecs[d.replace(/^x-/,"")]},_setup:function(){var d=this||k;if(d.state=d.ctx?d.ctx.state||"suspended":"suspended",d._autoSuspend(),!d.usingWebAudio)if("undefined"!=
typeof Audio)try{var h=new Audio;void 0===h.oncanplaythrough&&(d._canPlayEvent="canplay")}catch(w){d.noAudio=!0}else d.noAudio=!0;try{h=new Audio,h.muted&&(d.noAudio=!0)}catch(w){}return d.noAudio||d._setupCodecs(),d},_setupCodecs:function(){var d=this||k,h=null;try{h="undefined"!=typeof Audio?new Audio:null}catch(ea){return d}if(!h||"function"!=typeof h.canPlayType)return d;var w=h.canPlayType("audio/mpeg;").replace(/^no$/,""),m=d._navigator&&d._navigator.userAgent.match(/OPR\/([0-6].)/g);m=m&&33>
parseInt(m[0].split("/")[1],10);return d._codecs={mp3:!(m||!w&&!h.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!w,opus:!!h.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!h.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!h.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!h.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(h.canPlayType("audio/x-m4a;")||
h.canPlayType("audio/m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(h.canPlayType("audio/x-mp4;")||h.canPlayType("audio/mp4;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!h.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(h.canPlayType("audio/x-flac;")||h.canPlayType("audio/flac;")).replace(/^no$/,"")},d},_unlockAudio:function(){var d=
this||k,h=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome|Safari/i.test(d._navigator&&d._navigator.userAgent);if(!d._audioUnlocked&&d.ctx&&h){d._audioUnlocked=!1;d.autoUnlock=!1;d._mobileUnloaded||44100===d.ctx.sampleRate||(d._mobileUnloaded=!0,d.unload());d._scratchBuffer=d.ctx.createBuffer(1,1,22050);var w=function(h){for(h=0;h<d.html5PoolSize;h++){var m=new Audio;m._unlocked=!0;d._releaseHtml5Audio(m)}for(h=0;h<d._howls.length;h++)if(!d._howls[h]._webAudio){m=d._howls[h]._getSoundIds();
for(var k=0;k<m.length;k++){var p=d._howls[h]._soundById(m[k]);p&&p._node&&!p._node._unlocked&&(p._node._unlocked=!0,p._node.load())}}d._autoResume();var t=d.ctx.createBufferSource();t.buffer=d._scratchBuffer;t.connect(d.ctx.destination);void 0===t.start?t.noteOn(0):t.start(0);"function"==typeof d.ctx.resume&&d.ctx.resume();t.onended=function(){t.disconnect(0);d._audioUnlocked=!0;document.removeEventListener("touchstart",w,!0);document.removeEventListener("touchend",w,!0);document.removeEventListener("click",
w,!0);for(var h=0;h<d._howls.length;h++)d._howls[h]._emit("unlock")}};return document.addEventListener("touchstart",w,!0),document.addEventListener("touchend",w,!0),document.addEventListener("click",w,!0),d}},_obtainHtml5Audio:function(){var d=this||k;if(d._html5AudioPool.length)return d._html5AudioPool.pop();d=(new Audio).play();return d&&"undefined"!=typeof Promise&&(d instanceof Promise||"function"==typeof d.then)&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),
new Audio},_releaseHtml5Audio:function(d){var h=this||k;return d._unlocked&&h._html5AudioPool.push(d),h},_autoSuspend:function(){var d=this;if(d.autoSuspend&&d.ctx&&void 0!==d.ctx.suspend&&k.usingWebAudio){for(var h=0;h<d._howls.length;h++)if(d._howls[h]._webAudio)for(var w=0;w<d._howls[h]._sounds.length;w++)if(!d._howls[h]._sounds[w]._paused)return d;return d._suspendTimer&&clearTimeout(d._suspendTimer),d._suspendTimer=setTimeout(function(){d.autoSuspend&&(d._suspendTimer=null,d.state="suspending",
d.ctx.suspend().then(function(){d.state="suspended";d._resumeAfterSuspend&&(delete d._resumeAfterSuspend,d._autoResume())}))},3E4),d}},_autoResume:function(){var d=this;if(d.ctx&&void 0!==d.ctx.resume&&k.usingWebAudio)return"running"===d.state&&d._suspendTimer?(clearTimeout(d._suspendTimer),d._suspendTimer=null):"suspended"===d.state?(d.ctx.resume().then(function(){d.state="running";for(var h=0;h<d._howls.length;h++)d._howls[h]._emit("resume")}),d._suspendTimer&&(clearTimeout(d._suspendTimer),d._suspendTimer=
null)):"suspending"===d.state&&(d._resumeAfterSuspend=!0),d}};var k=new H,v=function(d){if(!d.src||0===d.src.length)return void console.error("An array of source files must be passed with any new Howl.");this.init(d)};v.prototype={init:function(d){var h=this;return k.ctx||p(),h._autoplay=d.autoplay||!1,h._format="string"!=typeof d.format?d.format:[d.format],h._html5=d.html5||!1,h._muted=d.mute||!1,h._loop=d.loop||!1,h._pool=d.pool||5,h._preload="boolean"!=typeof d.preload||d.preload,h._rate=d.rate||
1,h._sprite=d.sprite||{},h._src="string"!=typeof d.src?d.src:[d.src],h._volume=void 0!==d.volume?d.volume:1,h._xhrWithCredentials=d.xhrWithCredentials||!1,h._duration=0,h._state="unloaded",h._sounds=[],h._endTimers={},h._queue=[],h._playLock=!1,h._onend=d.onend?[{fn:d.onend}]:[],h._onfade=d.onfade?[{fn:d.onfade}]:[],h._onload=d.onload?[{fn:d.onload}]:[],h._onloaderror=d.onloaderror?[{fn:d.onloaderror}]:[],h._onplayerror=d.onplayerror?[{fn:d.onplayerror}]:[],h._onpause=d.onpause?[{fn:d.onpause}]:[],
h._onplay=d.onplay?[{fn:d.onplay}]:[],h._onstop=d.onstop?[{fn:d.onstop}]:[],h._onmute=d.onmute?[{fn:d.onmute}]:[],h._onvolume=d.onvolume?[{fn:d.onvolume}]:[],h._onrate=d.onrate?[{fn:d.onrate}]:[],h._onseek=d.onseek?[{fn:d.onseek}]:[],h._onunlock=d.onunlock?[{fn:d.onunlock}]:[],h._onresume=[],h._webAudio=k.usingWebAudio&&!h._html5,void 0!==k.ctx&&k.ctx&&k.autoUnlock&&k._unlockAudio(),k._howls.push(h),h._autoplay&&h._queue.push({event:"play",action:function(){h.play()}}),h._preload&&h.load(),h},load:function(){var d=
null;if(k.noAudio)return void this._emit("loaderror",null,"No audio support.");"string"==typeof this._src&&(this._src=[this._src]);for(var h=0;h<this._src.length;h++){var w;if(this._format&&this._format[h])var m=this._format[h];else{if("string"!=typeof(w=this._src[h])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(m=/^data:audio\/([^;,]+);/i.exec(w))||(m=/\.([^.]+)$/.exec(w.split("?",1)[0]));m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),
m&&k.codecs(m)){d=this._src[h];break}}return d?(this._src=d,this._state="loading","https:"===window.location.protocol&&"http:"===d.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new t(this),this._webAudio&&z(this),this):void this._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(d,h){var w=this,m=null;if("number"==typeof d)m=d,d=null;else{if("string"==typeof d&&"loaded"===w._state&&!w._sprite[d])return null;if(void 0===d&&(d="__default",!w._playLock)){for(var p=
0,t=0;t<w._sounds.length;t++)w._sounds[t]._paused&&!w._sounds[t]._ended&&(p++,m=w._sounds[t]._id);1===p?d=null:m=null}}var u=m?w._soundById(m):w._inactiveSound();if(!u)return null;if(m&&!d&&(d=u._sprite||"__default"),"loaded"!==w._state){u._sprite=d;u._ended=!1;var B=u._id;return w._queue.push({event:"play",action:function(){w.play(B)}}),B}if(m&&!u._paused)return h||w._loadQueue("play"),u._id;w._webAudio&&k._autoResume();var v=Math.max(0,0<u._seek?u._seek:w._sprite[d][0]/1E3),G=Math.max(0,(w._sprite[d][0]+
w._sprite[d][1])/1E3-v),z=1E3*G/Math.abs(u._rate),H=w._sprite[d][0]/1E3,J=(w._sprite[d][0]+w._sprite[d][1])/1E3,na=!(!u._loop&&!w._sprite[d][2]);u._sprite=d;u._ended=!1;var M=function(){u._paused=!1;u._seek=v;u._start=H;u._stop=J;u._loop=na};if(v>=J)return void w._ended(u);var da=u._node;if(w._webAudio)m=function(){w._playLock=!1;M();w._refreshBuffer(u);da.gain.setValueAtTime(u._muted||w._muted?0:u._volume,k.ctx.currentTime);u._playStart=k.ctx.currentTime;void 0===da.bufferSource.start?u._loop?da.bufferSource.noteGrainOn(0,
v,86400):da.bufferSource.noteGrainOn(0,v,G):u._loop?da.bufferSource.start(0,v,86400):da.bufferSource.start(0,v,G);z!==1/0&&(w._endTimers[u._id]=setTimeout(w._ended.bind(w,u),z));h||setTimeout(function(){w._emit("play",u._id);w._loadQueue()},0)},"running"===k.state?m():(w._playLock=!0,w.once("resume",m),w._clearTimer(u._id));else{var qa=function(){da.currentTime=v;da.muted=u._muted||w._muted||k._muted||da.muted;da.volume=u._volume*k.volume();da.playbackRate=u._rate;try{var m=da.play();if(m&&"undefined"!=
typeof Promise&&(m instanceof Promise||"function"==typeof m.then)?(w._playLock=!0,M(),m.then(function(){w._playLock=!1;da._unlocked=!0;h||(w._emit("play",u._id),w._loadQueue())}).catch(function(){w._playLock=!1;w._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");u._ended=!0;u._paused=!0})):h||(w._playLock=!1,M(),w._emit("play",u._id),w._loadQueue()),da.playbackRate=u._rate,da.paused)return void w._emit("playerror",
u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==d||u._loop?w._endTimers[u._id]=setTimeout(w._ended.bind(w,u),z):(w._endTimers[u._id]=function(){w._ended(u);da.removeEventListener("ended",w._endTimers[u._id],!1)},da.addEventListener("ended",w._endTimers[u._id],!1))}catch(Sa){w._emit("playerror",u._id,Sa)}};m=window&&window.ejecta||!da.readyState&&k._navigator.isCocoonJS;if(3<=da.readyState||
m)qa();else{w._playLock=!0;var P=function(){qa();da.removeEventListener(k._canPlayEvent,P,!1)};da.addEventListener(k._canPlayEvent,P,!1);w._clearTimer(u._id)}}return u._id},pause:function(d,h){var w=this;if("loaded"!==w._state||w._playLock)return w._queue.push({event:"pause",action:function(){w.pause(d)}}),w;for(var m=w._getSoundIds(d),k=0;k<m.length;k++){w._clearTimer(m[k]);var p=w._soundById(m[k]);if(p&&!p._paused&&(p._seek=w.seek(m[k]),p._rateSeek=0,p._paused=!0,w._stopFade(m[k]),p._node))if(w._webAudio){if(!p._node.bufferSource)continue;
void 0===p._node.bufferSource.stop?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0);w._cleanBuffer(p._node)}else isNaN(p._node.duration)&&p._node.duration!==1/0||p._node.pause();h||w._emit("pause",p?p._id:null)}return w},stop:function(d,h){var w=this;if("loaded"!==w._state||w._playLock)return w._queue.push({event:"stop",action:function(){w.stop(d)}}),w;for(var m=w._getSoundIds(d),k=0;k<m.length;k++){w._clearTimer(m[k]);var p=w._soundById(m[k]);p&&(p._seek=p._start||0,p._rateSeek=0,p._paused=
!0,p._ended=!0,w._stopFade(m[k]),p._node&&(w._webAudio?p._node.bufferSource&&(void 0===p._node.bufferSource.stop?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),w._cleanBuffer(p._node)):isNaN(p._node.duration)&&p._node.duration!==1/0||(p._node.currentTime=p._start||0,p._node.pause())),h||w._emit("stop",p._id))}return w},mute:function(d,h){var w=this;if("loaded"!==w._state||w._playLock)return w._queue.push({event:"mute",action:function(){w.mute(d,h)}}),w;if(void 0===h){if("boolean"!=typeof d)return w._muted;
w._muted=d}for(var m=w._getSoundIds(h),p=0;p<m.length;p++){var t=w._soundById(m[p]);t&&(t._muted=d,t._interval&&w._stopFade(t._id),w._webAudio&&t._node?t._node.gain.setValueAtTime(d?0:t._volume,k.ctx.currentTime):t._node&&(t._node.muted=!!k._muted||d),w._emit("mute",t._id))}return w},volume:function(){var d,h,w=this,m=arguments;if(0===m.length)return w._volume;1===m.length||2===m.length&&void 0===m[1]?0<=w._getSoundIds().indexOf(m[0])?h=parseInt(m[0],10):d=parseFloat(m[0]):2<=m.length&&(d=parseFloat(m[0]),
h=parseInt(m[1],10));var p;if(!(void 0!==d&&0<=d&&1>=d))return p=h?w._soundById(h):w._sounds[0],p?p._volume:0;if("loaded"!==w._state||w._playLock)return w._queue.push({event:"volume",action:function(){w.volume.apply(w,m)}}),w;void 0===h&&(w._volume=d);h=w._getSoundIds(h);for(var t=0;t<h.length;t++)(p=w._soundById(h[t]))&&(p._volume=d,m[2]||w._stopFade(h[t]),w._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(d,k.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=d*k.volume()),w._emit("volume",
p._id));return w},fade:function(d,h,w,m){var p=this;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"fade",action:function(){p.fade(d,h,w,m)}}),p;d=parseFloat(d);h=parseFloat(h);w=parseFloat(w);p.volume(d,m);for(var t=p._getSoundIds(m),u=0;u<t.length;u++){var v=p._soundById(t[u]);if(v){if(m||p._stopFade(t[u]),p._webAudio&&!v._muted){var B=k.ctx.currentTime,G=B+w/1E3;v._volume=d;v._node.gain.setValueAtTime(d,B);v._node.gain.linearRampToValueAtTime(h,G)}p._startFadeInterval(v,d,h,w,
t[u],void 0===m)}}return p},_startFadeInterval:function(d,h,w,m,p,k){var t=this,u=h,v=w-h;p=Math.abs(v/.01);p=Math.max(4,0<p?m/p:m);var B=Date.now();d._fadeTo=w;d._interval=setInterval(function(){var p=(Date.now()-B)/m;B=Date.now();u+=v*p;u=Math.max(0,u);u=Math.min(1,u);u=Math.round(100*u)/100;t._webAudio?d._volume=u:t.volume(u,d._id,!0);k&&(t._volume=u);(w<h&&u<=w||w>h&&u>=w)&&(clearInterval(d._interval),d._interval=null,d._fadeTo=null,t.volume(w,d._id),t._emit("fade",d._id))},p)},_stopFade:function(d){var h=
this._soundById(d);return h&&h._interval&&(this._webAudio&&h._node.gain.cancelScheduledValues(k.ctx.currentTime),clearInterval(h._interval),h._interval=null,this.volume(h._fadeTo,d),h._fadeTo=null,this._emit("fade",d)),this},loop:function(){var d,h,p,m=arguments;if(0===m.length)return this._loop;if(1===m.length){if("boolean"!=typeof m[0])return!!(p=this._soundById(parseInt(m[0],10)))&&p._loop;this._loop=d=m[0]}else 2===m.length&&(d=m[0],h=parseInt(m[1],10));h=this._getSoundIds(h);for(m=0;m<h.length;m++)(p=
this._soundById(h[m]))&&(p._loop=d,this._webAudio&&p._node&&p._node.bufferSource&&(p._node.bufferSource.loop=d,d&&(p._node.bufferSource.loopStart=p._start||0,p._node.bufferSource.loopEnd=p._stop)));return this},rate:function(){var d,h,p=this,m=arguments;0===m.length?h=p._sounds[0]._id:1===m.length?0<=p._getSoundIds().indexOf(m[0])?h=parseInt(m[0],10):d=parseFloat(m[0]):2===m.length&&(d=parseFloat(m[0]),h=parseInt(m[1],10));var t;if("number"!=typeof d)return t=p._soundById(h),t?t._rate:p._rate;if("loaded"!==
p._state||p._playLock)return p._queue.push({event:"rate",action:function(){p.rate.apply(p,m)}}),p;void 0===h&&(p._rate=d);h=p._getSoundIds(h);for(var u=0;u<h.length;u++)if(t=p._soundById(h[u])){p.playing(h[u])&&(t._rateSeek=p.seek(h[u]),t._playStart=p._webAudio?k.ctx.currentTime:t._playStart);t._rate=d;p._webAudio&&t._node&&t._node.bufferSource?t._node.bufferSource.playbackRate.setValueAtTime(d,k.ctx.currentTime):t._node&&(t._node.playbackRate=d);var v=p.seek(h[u]);v=1E3*((p._sprite[t._sprite][0]+
p._sprite[t._sprite][1])/1E3-v)/Math.abs(t._rate);!p._endTimers[h[u]]&&t._paused||(p._clearTimer(h[u]),p._endTimers[h[u]]=setTimeout(p._ended.bind(p,t),v));p._emit("rate",t._id)}return p},seek:function(){var d,h,p=this,m=arguments;0===m.length?h=p._sounds[0]._id:1===m.length?0<=p._getSoundIds().indexOf(m[0])?h=parseInt(m[0],10):p._sounds.length&&(h=p._sounds[0]._id,d=parseFloat(m[0])):2===m.length&&(d=parseFloat(m[0]),h=parseInt(m[1],10));if(void 0===h)return p;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"seek",
action:function(){p.seek.apply(p,m)}}),p;var t=p._soundById(h);if(t){if(!("number"==typeof d&&0<=d))return p._webAudio?(d=p.playing(h)?k.ctx.currentTime-t._playStart:0,t._seek+((t._rateSeek?t._rateSeek-t._seek:0)+d*Math.abs(t._rate))):t._node.currentTime;var u=p.playing(h);u&&p.pause(h,!0);t._seek=d;t._ended=!1;p._clearTimer(h);p._webAudio||!t._node||isNaN(t._node.duration)||(t._node.currentTime=d);var v=function(){p._emit("seek",h);u&&p.play(h,!0)};if(u&&!p._webAudio){var B=function(){p._playLock?
setTimeout(B,0):v()};setTimeout(B,0)}else v()}return p},playing:function(d){if("number"==typeof d)return d=this._soundById(d),!!d&&!d._paused;for(d=0;d<this._sounds.length;d++)if(!this._sounds[d]._paused)return!0;return!1},duration:function(d){var h=this._duration;d=this._soundById(d);return d&&(h=this._sprite[d._sprite][1]/1E3),h},state:function(){return this._state},unload:function(){for(var d=this._sounds,h=0;h<d.length;h++)(d[h]._paused||this.stop(d[h]._id),this._webAudio)||(/MSIE |Trident\//.test(k._navigator&&
k._navigator.userAgent)||(d[h]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),d[h]._node.removeEventListener("error",d[h]._errorFn,!1),d[h]._node.removeEventListener(k._canPlayEvent,d[h]._loadFn,!1),k._releaseHtml5Audio(d[h]._node)),delete d[h]._node,this._clearTimer(d[h]._id);h=k._howls.indexOf(this);0<=h&&k._howls.splice(h,1);d=!0;for(h=0;h<k._howls.length;h++)if(k._howls[h]._src===this._src||0<=this._src.indexOf(k._howls[h]._src)){d=!1;break}return B&&
d&&delete B[this._src],k.noAudio=!1,this._state="unloaded",this._sounds=[],null},on:function(d,h,p,m){d=this["_on"+d];return"function"==typeof h&&d.push(m?{id:p,fn:h,once:m}:{id:p,fn:h}),this},off:function(d,h,p){var m=this["_on"+d];if("number"==typeof h&&(p=h,h=null),h||p)for(d=0;d<m.length;d++){var k=p===m[d].id;if(h===m[d].fn&&k||!h&&k){m.splice(d,1);break}}else if(d)this["_on"+d]=[];else for(h=Object.keys(this),d=0;d<h.length;d++)0===h[d].indexOf("_on")&&Array.isArray(this[h[d]])&&(this[h[d]]=
[]);return this},once:function(d,h,p){return this.on(d,h,p,1),this},_emit:function(d,h,p){for(var m=this["_on"+d],k=m.length-1;0<=k;k--)m[k].id&&m[k].id!==h&&"load"!==d||(setTimeout(function(d){d.call(this,h,p)}.bind(this,m[k].fn),0),m[k].once&&this.off(d,m[k].fn,m[k].id));return this._loadQueue(d),this},_loadQueue:function(d){if(0<this._queue.length){var h=this._queue[0];h.event===d&&(this._queue.shift(),this._loadQueue());d||h.action()}return this},_ended:function(d){var h=d._sprite;if(!this._webAudio&&
d._node&&!d._node.paused&&!d._node.ended&&d._node.currentTime<d._stop)return setTimeout(this._ended.bind(this,d),100),this;h=!(!d._loop&&!this._sprite[h][2]);if(this._emit("end",d._id),!this._webAudio&&h&&this.stop(d._id,!0).play(d._id),this._webAudio&&h){this._emit("play",d._id);d._seek=d._start||0;d._rateSeek=0;d._playStart=k.ctx.currentTime;var p=1E3*(d._stop-d._start)/Math.abs(d._rate);this._endTimers[d._id]=setTimeout(this._ended.bind(this,d),p)}return this._webAudio&&!h&&(d._paused=!0,d._ended=
!0,d._seek=d._start||0,d._rateSeek=0,this._clearTimer(d._id),this._cleanBuffer(d._node),k._autoSuspend()),this._webAudio||h||this.stop(d._id,!0),this},_clearTimer:function(d){if(this._endTimers[d]){if("function"!=typeof this._endTimers[d])clearTimeout(this._endTimers[d]);else{var h=this._soundById(d);h&&h._node&&h._node.removeEventListener("ended",this._endTimers[d],!1)}delete this._endTimers[d]}return this},_soundById:function(d){for(var h=0;h<this._sounds.length;h++)if(d===this._sounds[h]._id)return this._sounds[h];
return null},_inactiveSound:function(){this._drain();for(var d=0;d<this._sounds.length;d++)if(this._sounds[d]._ended)return this._sounds[d].reset();return new t(this)},_drain:function(){var d=this._pool,h=0,p;if(!(this._sounds.length<d)){for(p=0;p<this._sounds.length;p++)this._sounds[p]._ended&&h++;for(p=this._sounds.length-1;0<=p&&!(h<=d);p--)this._sounds[p]._ended&&(this._webAudio&&this._sounds[p]._node&&this._sounds[p]._node.disconnect(0),this._sounds.splice(p,1),h--)}},_getSoundIds:function(d){if(void 0===
d){d=[];for(var h=0;h<this._sounds.length;h++)d.push(this._sounds[h]._id);return d}return[d]},_refreshBuffer:function(d){return d._node.bufferSource=k.ctx.createBufferSource(),d._node.bufferSource.buffer=B[this._src],d._panner?d._node.bufferSource.connect(d._panner):d._node.bufferSource.connect(d._node),d._node.bufferSource.loop=d._loop,d._loop&&(d._node.bufferSource.loopStart=d._start||0,d._node.bufferSource.loopEnd=d._stop||0),d._node.bufferSource.playbackRate.setValueAtTime(d._rate,k.ctx.currentTime),
this},_cleanBuffer:function(d){var h=k._navigator&&0<=k._navigator.vendor.indexOf("Apple");if(k._scratchBuffer&&d.bufferSource&&(d.bufferSource.onended=null,d.bufferSource.disconnect(0),h))try{d.bufferSource.buffer=k._scratchBuffer}catch(w){}return d.bufferSource=null,this}};var t=function(d){this._parent=d;this.init()};t.prototype={init:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._paused=!0,this._ended=!0,
this._sprite="__default",this._id=++k._counter,d._sounds.push(this),this.create(),this},create:function(){var d=this._parent,h=k._muted||this._muted||this._parent._muted?0:this._volume;return d._webAudio?(this._node=void 0===k.ctx.createGain?k.ctx.createGainNode():k.ctx.createGain(),this._node.gain.setValueAtTime(h,k.ctx.currentTime),this._node.paused=!0,this._node.connect(k.masterGain)):(this._node=k._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",
this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(k._canPlayEvent,this._loadFn,!1),this._node.src=d._src,this._node.preload="auto",this._node.volume=h*k.volume(),this._node.load()),this},reset:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++k._counter,this},_errorListener:function(){this._parent._emit("loaderror",
this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var d=this._parent;d._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue());this._node.removeEventListener(k._canPlayEvent,this._loadFn,!1)}};var B={},z=function(d){var h=d._src;if(B[h])return d._duration=B[h].duration,void G(d);
if(/^data:[^;]+;base64,/.test(h)){for(var p=atob(h.split(",")[1]),m=new Uint8Array(p.length),k=0;k<p.length;++k)m[k]=p.charCodeAt(k);J(m.buffer,d)}else{var t=new XMLHttpRequest;t.open("GET",h,!0);t.withCredentials=d._xhrWithCredentials;t.responseType="arraybuffer";t.onload=function(){var h=(t.status+"")[0];if("0"!==h&&"2"!==h&&"3"!==h)return void d._emit("loaderror",null,"Failed loading audio file with status: "+t.status+".");J(t.response,d)};t.onerror=function(){d._webAudio&&(d._html5=!0,d._webAudio=
!1,d._sounds=[],delete B[h],d.load())};u(t)}},u=function(d){try{d.send()}catch(h){d.onerror()}},J=function(d,h){var p=function(){h._emit("loaderror",null,"Decoding audio data failed.")},m=function(d){d&&0<h._sounds.length?(B[h._src]=d,G(h,d)):p()};"undefined"!=typeof Promise&&1===k.ctx.decodeAudioData.length?k.ctx.decodeAudioData(d).then(m).catch(p):k.ctx.decodeAudioData(d,m,p)},G=function(d,h){h&&!d._duration&&(d._duration=h.duration);0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*
d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue())},p=function(){if(k.usingWebAudio){try{"undefined"!=typeof AudioContext?k.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?k.ctx=new webkitAudioContext:k.usingWebAudio=!1}catch(w){k.usingWebAudio=!1}k.ctx||(k.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(k._navigator&&k._navigator.platform),h=k._navigator&&k._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);h=h?parseInt(h[1],10):null;d&&h&&9>h&&(d=
/safari/.test(k._navigator&&k._navigator.userAgent.toLowerCase()),(k._navigator&&k._navigator.standalone&&!d||k._navigator&&!k._navigator.standalone&&!d)&&(k.usingWebAudio=!1));k.usingWebAudio&&(k.masterGain=void 0===k.ctx.createGain?k.ctx.createGainNode():k.ctx.createGain(),k.masterGain.gain.setValueAtTime(k._muted?0:1,k.ctx.currentTime),k.masterGain.connect(k.ctx.destination));k._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:k,Howl:v}});"undefined"!=typeof exports&&
(exports.Howler=k,exports.Howl=v);"undefined"!=typeof window?(window.HowlerGlobal=H,window.Howler=k,window.Howl=v,window.Sound=t):"undefined"!=typeof global&&(global.HowlerGlobal=H,global.Howler=k,global.Howl=v,global.Sound=t)}();
!function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(k){if(!this.ctx||!this.ctx.listener)return this;for(var v=this._howls.length-1;0<=v;v--)this._howls[v].stereo(k);return this};HowlerGlobal.prototype.pos=function(k,v,t){return this.ctx&&this.ctx.listener?(v="number"!=typeof v?this._pos[1]:v,t="number"!=typeof t?this._pos[2]:t,"number"!=typeof k?this._pos:(this._pos=[k,v,t],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],
Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this};HowlerGlobal.prototype.orientation=function(k,v,t,B,z,u){if(!this.ctx||!this.ctx.listener)return this;var H=this._orientation;return v="number"!=typeof v?H[1]:v,t="number"!=typeof t?H[2]:t,B="number"!=typeof B?H[3]:B,z="number"!=
typeof z?H[4]:z,u="number"!=typeof u?H[5]:u,"number"!=typeof k?H:(this._orientation=[k,v,t,B,z,u],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(k,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(v,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(k,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(v,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(t,
Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(k,v,t,B,z,u),this)};Howl.prototype.init=function(k){return function(v){return this._orientation=v.orientation||[1,0,0],this._stereo=v.stereo||null,this._pos=v.pos||null,this._pannerAttr={coneInnerAngle:void 0!==v.coneInnerAngle?v.coneInnerAngle:360,coneOuterAngle:void 0!==v.coneOuterAngle?v.coneOuterAngle:360,coneOuterGain:void 0!==v.coneOuterGain?v.coneOuterGain:0,distanceModel:void 0!==v.distanceModel?v.distanceModel:"inverse",maxDistance:void 0!==
v.maxDistance?v.maxDistance:1E4,panningModel:void 0!==v.panningModel?v.panningModel:"HRTF",refDistance:void 0!==v.refDistance?v.refDistance:1,rolloffFactor:void 0!==v.rolloffFactor?v.rolloffFactor:1},this._onstereo=v.onstereo?[{fn:v.onstereo}]:[],this._onpos=v.onpos?[{fn:v.onpos}]:[],this._onorientation=v.onorientation?[{fn:v.onorientation}]:[],k.call(this,v)}}(Howl.prototype.init);Howl.prototype.stereo=function(k,v){var t=this;if(!t._webAudio)return t;if("loaded"!==t._state)return t._queue.push({event:"stereo",
action:function(){t.stereo(k,v)}}),t;var B=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===v){if("number"!=typeof k)return t._stereo;t._stereo=k;t._pos=[k,0,0]}for(var z=t._getSoundIds(v),u=0;u<z.length;u++){var J=t._soundById(z[u]);if(J){if("number"!=typeof k)return J._stereo;J._stereo=k;J._pos=[k,0,0];J._node&&(J._pannerAttr.panningModel="equalpower",J._panner&&J._panner.pan||H(J,B),"spatial"===B?void 0!==J._panner.positionX?(J._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),
J._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),J._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):J._panner.setPosition(k,0,0):J._panner.pan.setValueAtTime(k,Howler.ctx.currentTime));t._emit("stereo",J._id)}}return t};Howl.prototype.pos=function(k,v,t,B){var z=this;if(!z._webAudio)return z;if("loaded"!==z._state)return z._queue.push({event:"pos",action:function(){z.pos(k,v,t,B)}}),z;if(v="number"!=typeof v?0:v,t="number"!=typeof t?-.5:t,void 0===B){if("number"!=typeof k)return z._pos;
z._pos=[k,v,t]}for(var u=z._getSoundIds(B),J=0;J<u.length;J++){var G=z._soundById(u[J]);if(G){if("number"!=typeof k)return G._pos;G._pos=[k,v,t];G._node&&(G._panner&&!G._panner.pan||H(G,"spatial"),void 0!==G._panner.positionX?(G._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),G._panner.positionY.setValueAtTime(v,Howler.ctx.currentTime),G._panner.positionZ.setValueAtTime(t,Howler.ctx.currentTime)):G._panner.setPosition(k,v,t));z._emit("pos",G._id)}}return z};Howl.prototype.orientation=function(k,
v,t,B){var z=this;if(!z._webAudio)return z;if("loaded"!==z._state)return z._queue.push({event:"orientation",action:function(){z.orientation(k,v,t,B)}}),z;if(v="number"!=typeof v?z._orientation[1]:v,t="number"!=typeof t?z._orientation[2]:t,void 0===B){if("number"!=typeof k)return z._orientation;z._orientation=[k,v,t]}for(var u=z._getSoundIds(B),J=0;J<u.length;J++){var G=z._soundById(u[J]);if(G){if("number"!=typeof k)return G._orientation;G._orientation=[k,v,t];G._node&&(G._panner||(G._pos||(G._pos=
z._pos||[0,0,-.5]),H(G,"spatial")),void 0!==G._panner.orientationX?(G._panner.orientationX.setValueAtTime(k,Howler.ctx.currentTime),G._panner.orientationY.setValueAtTime(v,Howler.ctx.currentTime),G._panner.orientationZ.setValueAtTime(t,Howler.ctx.currentTime)):G._panner.setOrientation(k,v,t));z._emit("orientation",G._id)}}return z};Howl.prototype.pannerAttr=function(){var k,v,t=arguments;if(!this._webAudio)return this;if(0===t.length)return this._pannerAttr;if(1===t.length){if("object"!=typeof t[0])return v=
this._soundById(parseInt(t[0],10)),v?v._pannerAttr:this._pannerAttr;var B=t[0];void 0===k&&(B.pannerAttr||(B.pannerAttr={coneInnerAngle:B.coneInnerAngle,coneOuterAngle:B.coneOuterAngle,coneOuterGain:B.coneOuterGain,distanceModel:B.distanceModel,maxDistance:B.maxDistance,refDistance:B.refDistance,rolloffFactor:B.rolloffFactor,panningModel:B.panningModel}),this._pannerAttr={coneInnerAngle:void 0!==B.pannerAttr.coneInnerAngle?B.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:void 0!==B.pannerAttr.coneOuterAngle?
B.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:void 0!==B.pannerAttr.coneOuterGain?B.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:void 0!==B.pannerAttr.distanceModel?B.pannerAttr.distanceModel:this._distanceModel,maxDistance:void 0!==B.pannerAttr.maxDistance?B.pannerAttr.maxDistance:this._maxDistance,refDistance:void 0!==B.pannerAttr.refDistance?B.pannerAttr.refDistance:this._refDistance,rolloffFactor:void 0!==B.pannerAttr.rolloffFactor?B.pannerAttr.rolloffFactor:this._rolloffFactor,
panningModel:void 0!==B.pannerAttr.panningModel?B.pannerAttr.panningModel:this._panningModel})}else 2===t.length&&(B=t[0],k=parseInt(t[1],10));k=this._getSoundIds(k);for(t=0;t<k.length;t++)if(v=this._soundById(k[t])){var z=v._pannerAttr;z={coneInnerAngle:void 0!==B.coneInnerAngle?B.coneInnerAngle:z.coneInnerAngle,coneOuterAngle:void 0!==B.coneOuterAngle?B.coneOuterAngle:z.coneOuterAngle,coneOuterGain:void 0!==B.coneOuterGain?B.coneOuterGain:z.coneOuterGain,distanceModel:void 0!==B.distanceModel?B.distanceModel:
z.distanceModel,maxDistance:void 0!==B.maxDistance?B.maxDistance:z.maxDistance,refDistance:void 0!==B.refDistance?B.refDistance:z.refDistance,rolloffFactor:void 0!==B.rolloffFactor?B.rolloffFactor:z.rolloffFactor,panningModel:void 0!==B.panningModel?B.panningModel:z.panningModel};var u=v._panner;u?(u.coneInnerAngle=z.coneInnerAngle,u.coneOuterAngle=z.coneOuterAngle,u.coneOuterGain=z.coneOuterGain,u.distanceModel=z.distanceModel,u.maxDistance=z.maxDistance,u.refDistance=z.refDistance,u.rolloffFactor=
z.rolloffFactor,u.panningModel=z.panningModel):(v._pos||(v._pos=this._pos||[0,0,-.5]),H(v,"spatial"))}return this};Sound.prototype.init=function(k){return function(){var v=this._parent;this._orientation=v._orientation;this._stereo=v._stereo;this._pos=v._pos;this._pannerAttr=v._pannerAttr;k.call(this);this._stereo?v.stereo(this._stereo):this._pos&&v.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init);Sound.prototype.reset=function(k){return function(){var v=this._parent;return this._orientation=
v._orientation,this._stereo=v._stereo,this._pos=v._pos,this._pannerAttr=v._pannerAttr,this._stereo?v.stereo(this._stereo):this._pos?v.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,v._refreshBuffer(this)),k.call(this)}}(Sound.prototype.reset);var H=function(k,v){"spatial"===(v||"spatial")?(k._panner=Howler.ctx.createPanner(),k._panner.coneInnerAngle=k._pannerAttr.coneInnerAngle,k._panner.coneOuterAngle=k._pannerAttr.coneOuterAngle,
k._panner.coneOuterGain=k._pannerAttr.coneOuterGain,k._panner.distanceModel=k._pannerAttr.distanceModel,k._panner.maxDistance=k._pannerAttr.maxDistance,k._panner.refDistance=k._pannerAttr.refDistance,k._panner.rolloffFactor=k._pannerAttr.rolloffFactor,k._panner.panningModel=k._pannerAttr.panningModel,void 0!==k._panner.positionX?(k._panner.positionX.setValueAtTime(k._pos[0],Howler.ctx.currentTime),k._panner.positionY.setValueAtTime(k._pos[1],Howler.ctx.currentTime),k._panner.positionZ.setValueAtTime(k._pos[2],
Howler.ctx.currentTime)):k._panner.setPosition(k._pos[0],k._pos[1],k._pos[2]),void 0!==k._panner.orientationX?(k._panner.orientationX.setValueAtTime(k._orientation[0],Howler.ctx.currentTime),k._panner.orientationY.setValueAtTime(k._orientation[1],Howler.ctx.currentTime),k._panner.orientationZ.setValueAtTime(k._orientation[2],Howler.ctx.currentTime)):k._panner.setOrientation(k._orientation[0],k._orientation[1],k._orientation[2])):(k._panner=Howler.ctx.createStereoPanner(),k._panner.pan.setValueAtTime(k._stereo,
Howler.ctx.currentTime));k._panner.connect(k._node);k._paused||k._parent.pause(k._id,!0).play(k._id,!0)}}();
!function(H){"object"==typeof exports&&"undefined"!=typeof module?module.exports=H():"function"==typeof define&&define.amd?define([],H):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=H()}(function(){return function B(k,v,t){function z(G,p){if(!v[G]){if(!k[G]){var d="function"==typeof require&&require;if(!p&&d)return d(G,!0);if(u)return u(G,!0);p=Error("Cannot find module '"+G+"'");throw p.code="MODULE_NOT_FOUND",p;}p=v[G]={exports:{}};
k[G][0].call(p.exports,function(d){var h=k[G][1][d];return z(h?h:d)},p,p.exports,B,k,v,t)}return v[G].exports}for(var u="function"==typeof require&&require,J=0;J<t.length;J++)z(t[J]);return z}({1:[function(k,v,t){function B(k){if(!(this instanceof B))return new B(k);k=this.options=J.assign({level:m,method:L,chunkSize:16384,windowBits:15,memLevel:8,strategy:ea,to:""},k||{});k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&16>k.windowBits&&(k.windowBits+=16);this.err=0;this.msg=
"";this.ended=!1;this.chunks=[];this.strm=new d;this.strm.avail_out=0;var t=u.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(t!==w)throw Error(p[t]);if(k.header&&u.deflateSetHeader(this.strm,k.header),k.dictionary){var v;if(v="string"==typeof k.dictionary?G.string2buf(k.dictionary):"[object ArrayBuffer]"===h.call(k.dictionary)?new Uint8Array(k.dictionary):k.dictionary,t=u.deflateSetDictionary(this.strm,v),t!==w)throw Error(p[t]);this._dict_set=!0}}function z(d,h){h=
new B(h);if(h.push(d,!0),h.err)throw h.msg;return h.result}var u=k("./zlib/deflate"),J=k("./utils/common"),G=k("./utils/strings"),p=k("./zlib/messages"),d=k("./zlib/zstream"),h=Object.prototype.toString,w=0,m=-1,ea=0,L=8;B.prototype.push=function(d,m){var p,k=this.strm,t=this.options.chunkSize;if(this.ended)return!1;m=m===~~m?m:!0===m?4:0;"string"==typeof d?k.input=G.string2buf(d):"[object ArrayBuffer]"===h.call(d)?k.input=new Uint8Array(d):k.input=d;k.next_in=0;k.avail_in=k.input.length;do{if(0===
k.avail_out&&(k.output=new J.Buf8(t),k.next_out=0,k.avail_out=t),p=u.deflate(k,m),1!==p&&p!==w)return this.onEnd(p),this.ended=!0,!1;0!==k.avail_out&&(0!==k.avail_in||4!==m&&2!==m)||("string"===this.options.to?this.onData(G.buf2binstring(J.shrinkBuf(k.output,k.next_out))):this.onData(J.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||0===k.avail_out)&&1!==p);return 4===m?(p=u.deflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===w):2!==m||(this.onEnd(w),k.avail_out=0,!0)};B.prototype.onData=
function(d){this.chunks.push(d)};B.prototype.onEnd=function(d){d===w&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=J.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};t.Deflate=B;t.deflate=z;t.deflateRaw=function(d,h){return h=h||{},h.raw=!0,z(d,h)};t.gzip=function(d,h){return h=h||{},h.gzip=!0,z(d,h)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(k,v,t){function B(m){if(!(this instanceof
B))return new B(m);var k=this.options=J.assign({chunkSize:16384,windowBits:0,to:""},m||{});k.raw&&0<=k.windowBits&&16>k.windowBits&&(k.windowBits=-k.windowBits,0===k.windowBits&&(k.windowBits=-15));!(0<=k.windowBits&&16>k.windowBits)||m&&m.windowBits||(k.windowBits+=32);15<k.windowBits&&48>k.windowBits&&0===(15&k.windowBits)&&(k.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new h;this.strm.avail_out=0;m=u.inflateInit2(this.strm,k.windowBits);if(m!==p.Z_OK)throw Error(d[m]);
this.header=new w;u.inflateGetHeader(this.strm,this.header)}function z(d,h){h=new B(h);if(h.push(d,!0),h.err)throw h.msg;return h.result}var u=k("./zlib/inflate"),J=k("./utils/common"),G=k("./utils/strings"),p=k("./zlib/constants"),d=k("./zlib/messages"),h=k("./zlib/zstream"),w=k("./zlib/gzheader"),m=Object.prototype.toString;B.prototype.push=function(d,h){var k,t,w,v,B,z=this.strm,L=this.options.chunkSize,ea=this.options.dictionary,M=!1;if(this.ended)return!1;h=h===~~h?h:!0===h?p.Z_FINISH:p.Z_NO_FLUSH;
"string"==typeof d?z.input=G.binstring2buf(d):"[object ArrayBuffer]"===m.call(d)?z.input=new Uint8Array(d):z.input=d;z.next_in=0;z.avail_in=z.input.length;do{if(0===z.avail_out&&(z.output=new J.Buf8(L),z.next_out=0,z.avail_out=L),k=u.inflate(z,p.Z_NO_FLUSH),k===p.Z_NEED_DICT&&ea&&(B="string"==typeof ea?G.string2buf(ea):"[object ArrayBuffer]"===m.call(ea)?new Uint8Array(ea):ea,k=u.inflateSetDictionary(this.strm,B)),k===p.Z_BUF_ERROR&&!0===M&&(k=p.Z_OK,M=!1),k!==p.Z_STREAM_END&&k!==p.Z_OK)return this.onEnd(k),
this.ended=!0,!1;z.next_out&&(0!==z.avail_out&&k!==p.Z_STREAM_END&&(0!==z.avail_in||h!==p.Z_FINISH&&h!==p.Z_SYNC_FLUSH)||("string"===this.options.to?(t=G.utf8border(z.output,z.next_out),w=z.next_out-t,v=G.buf2string(z.output,t),z.next_out=w,z.avail_out=L-w,w&&J.arraySet(z.output,z.output,t,w,0),this.onData(v)):this.onData(J.shrinkBuf(z.output,z.next_out))));0===z.avail_in&&0===z.avail_out&&(M=!0)}while((0<z.avail_in||0===z.avail_out)&&k!==p.Z_STREAM_END);return k===p.Z_STREAM_END&&(h=p.Z_FINISH),
h===p.Z_FINISH?(k=u.inflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===p.Z_OK):h!==p.Z_SYNC_FLUSH||(this.onEnd(p.Z_OK),z.avail_out=0,!0)};B.prototype.onData=function(d){this.chunks.push(d)};B.prototype.onEnd=function(d){d===p.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=J.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};t.Inflate=B;t.inflate=z;t.inflateRaw=function(d,h){return h=h||{},h.raw=!0,z(d,h)};t.ungzip=z},{"./utils/common":3,
"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(k,v,t){k="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(k){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var u=t.shift();if(u){if("object"!=typeof u)throw new TypeError(u+"must be non-object");for(var p in u)u.hasOwnProperty(p)&&(k[p]=u[p])}}return k};t.shrinkBuf=function(k,t){return k.length===
t?k:k.subarray?k.subarray(0,t):(k.length=t,k)};var B={arraySet:function(k,t,v,p,d){if(t.subarray&&k.subarray)return void k.set(t.subarray(v,v+p),d);for(var h=0;h<p;h++)k[d+h]=t[v+h]},flattenChunks:function(k){var t,u;var p=u=0;for(t=k.length;p<t;p++)u+=k[p].length;var d=new Uint8Array(u);p=u=0;for(t=k.length;p<t;p++){var h=k[p];d.set(h,u);u+=h.length}return d}},z={arraySet:function(k,t,v,p,d){for(var h=0;h<p;h++)k[d+h]=t[v+h]},flattenChunks:function(k){return[].concat.apply([],k)}};t.setTyped=function(k){k?
(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,B)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,z))};t.setTyped(k)},{}],4:[function(k,v,t){function B(p,d){if(65537>d&&(p.subarray&&J||!p.subarray&&u))return String.fromCharCode.apply(null,z.shrinkBuf(p,d));for(var h="",k=0;k<d;k++)h+=String.fromCharCode(p[k]);return h}var z=k("./common"),u=!0,J=!0;try{String.fromCharCode.apply(null,[0])}catch(p){u=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(p){J=!1}var G=
new z.Buf8(256);for(k=0;256>k;k++)G[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;G[254]=G[254]=1;t.string2buf=function(p){var d,h,k,m=p.length,t=0;for(h=0;h<m;h++){var u=p.charCodeAt(h);55296===(64512&u)&&h+1<m&&(d=p.charCodeAt(h+1),56320===(64512&d)&&(u=65536+(u-55296<<10)+(d-56320),h++));t+=128>u?1:2048>u?2:65536>u?3:4}var v=new z.Buf8(t);for(h=k=0;k<t;h++)u=p.charCodeAt(h),55296===(64512&u)&&h+1<m&&(d=p.charCodeAt(h+1),56320===(64512&d)&&(u=65536+(u-55296<<10)+(d-56320),h++)),128>u?v[k++]=
u:2048>u?(v[k++]=192|u>>>6,v[k++]=128|63&u):65536>u?(v[k++]=224|u>>>12,v[k++]=128|u>>>6&63,v[k++]=128|63&u):(v[k++]=240|u>>>18,v[k++]=128|u>>>12&63,v[k++]=128|u>>>6&63,v[k++]=128|63&u);return v};t.buf2binstring=function(p){return B(p,p.length)};t.binstring2buf=function(p){for(var d=new z.Buf8(p.length),h=0,k=d.length;h<k;h++)d[h]=p.charCodeAt(h);return d};t.buf2string=function(p,d){var h,k,m,t=d||p.length,u=Array(2*t);for(d=h=0;d<t;)if(k=p[d++],128>k)u[h++]=k;else if(m=G[k],4<m)u[h++]=65533,d+=m-
1;else{for(k&=2===m?31:3===m?15:7;1<m&&d<t;)k=k<<6|63&p[d++],m--;1<m?u[h++]=65533:65536>k?u[h++]=k:(k-=65536,u[h++]=55296|k>>10&1023,u[h++]=56320|1023&k)}return B(u,h)};t.utf8border=function(k,d){var h;d=d||k.length;d>k.length&&(d=k.length);for(h=d-1;0<=h&&128===(192&k[h]);)h--;return 0>h?d:0===h?d:h+G[k[h]]>d?h:d}},{"./common":3}],5:[function(k,v,t){v.exports=function(k,t,u,v){var B=65535&k|0;k=k>>>16&65535|0;for(var p;0!==u;){p=2E3<u?2E3:u;u-=p;do B=B+t[v++]|0,k=k+B|0;while(--p);B%=65521;k%=65521}return B|
k<<16|0}},{}],6:[function(k,v,t){v.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(k,v,t){var B=function(){for(var k,t=[],v=0;256>v;v++){k=v;
for(var B=0;8>B;B++)k=1&k?3988292384^k>>>1:k>>>1;t[v]=k}return t}();v.exports=function(k,t,v,G){v=G+v;for(k^=-1;G<v;G++)k=k>>>8^B[255&(k^t[G])];return k^-1}},{}],8:[function(k,v,t){function B(d,h){return d.msg=na[h],h}function z(d){for(var h=d.length;0<=--h;)d[h]=0}function u(d){var h=d.state,n=h.pending;n>d.avail_out&&(n=d.avail_out);0!==n&&(pa.arraySet(d.output,h.pending_buf,h.pending_out,n,d.next_out),d.next_out+=n,h.pending_out+=n,d.total_out+=n,d.avail_out-=n,h.pending-=n,0===h.pending&&(h.pending_out=
0))}function J(d,h){ma._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,h);d.block_start=d.strstart;u(d.strm)}function G(d,h){d.pending_buf[d.pending++]=h}function p(d,h){d.pending_buf[d.pending++]=h>>>8&255;d.pending_buf[d.pending++]=255&h}function d(d,h){var n,m,k=d.max_chain_length,p=d.strstart,q=d.prev_length,t=d.nice_match,w=d.strstart>d.w_size-ba?d.strstart-(d.w_size-ba):0,u=d.window,v=d.w_mask,M=d.prev,B=d.strstart+aa,D=u[p+q-1],z=u[p+q];d.prev_length>=d.good_match&&
(k>>=2);t>d.lookahead&&(t=d.lookahead);do if(n=h,u[n+q]===z&&u[n+q-1]===D&&u[n]===u[p]&&u[++n]===u[p+1]){p+=2;for(n++;u[++p]===u[++n]&&u[++p]===u[++n]&&u[++p]===u[++n]&&u[++p]===u[++n]&&u[++p]===u[++n]&&u[++p]===u[++n]&&u[++p]===u[++n]&&u[++p]===u[++n]&&p<B;);if(m=aa-(B-p),p=B-aa,m>q){if(d.match_start=h,q=m,m>=t)break;D=u[p+q-1];z=u[p+q]}}while((h=M[h&v])>w&&0!==--k);return q<=d.lookahead?q:d.lookahead}function h(d){var h,n,m=d.w_size;do{if(n=d.window_size-d.lookahead-d.strstart,d.strstart>=m+(m-
ba)){pa.arraySet(d.window,d.window,m,m,0);d.match_start-=m;d.strstart-=m;d.block_start-=m;var k=h=d.hash_size;do{var p=d.head[--k];d.head[k]=p>=m?p-m:0}while(--h);k=h=m;do p=d.prev[--k],d.prev[k]=p>=m?p-m:0;while(--h);n+=m}if(0===d.strm.avail_in)break;k=d.strm;p=d.window;var q=d.strstart+d.lookahead,t=k.avail_in;if(h=(t>n&&(t=n),0===t?0:(k.avail_in-=t,pa.arraySet(p,k.input,k.next_in,t,q),1===k.state.wrap?k.adler=V(k.adler,p,t,q):2===k.state.wrap&&(k.adler=ca(k.adler,p,t,q)),k.next_in+=t,k.total_in+=
t,t)),d.lookahead+=h,d.lookahead+d.insert>=Z)for(n=d.strstart-d.insert,d.ins_h=d.window[n],d.ins_h=(d.ins_h<<d.hash_shift^d.window[n+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[n+Z-1])&d.hash_mask,d.prev[n&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=n,n++,d.insert--,!(d.lookahead+d.insert<Z)););}while(d.lookahead<ba&&0!==d.strm.avail_in)}function w(n,m){for(var k,p;;){if(n.lookahead<ba){if(h(n),n.lookahead<ba&&m===M)return D;if(0===n.lookahead)break}if(k=0,n.lookahead>=Z&&(n.ins_h=
(n.ins_h<<n.hash_shift^n.window[n.strstart+Z-1])&n.hash_mask,k=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),0!==k&&n.strstart-k<=n.w_size-ba&&(n.match_length=d(n,k)),n.match_length>=Z)if(p=ma._tr_tally(n,n.strstart-n.match_start,n.match_length-Z),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=Z){n.match_length--;do n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Z-1])&n.hash_mask,k=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=
n.strstart;while(0!==--n.match_length);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else p=ma._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(p&&(J(n,!1),0===n.strm.avail_out))return D}return n.insert=n.strstart<Z-1?n.strstart:Z-1,m===da?(J(n,!0),0===n.strm.avail_out?ka:Aa):n.last_lit&&(J(n,!1),0===n.strm.avail_out)?D:fb}function m(n,m){for(var k,p,q;;){if(n.lookahead<
ba){if(h(n),n.lookahead<ba&&m===M)return D;if(0===n.lookahead)break}if(k=0,n.lookahead>=Z&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Z-1])&n.hash_mask,k=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=Z-1,0!==k&&n.prev_length<n.max_lazy_match&&n.strstart-k<=n.w_size-ba&&(n.match_length=d(n,k),5>=n.match_length&&(n.strategy===Sa||n.match_length===Z&&4096<n.strstart-n.match_start)&&(n.match_length=
Z-1)),n.prev_length>=Z&&n.match_length<=n.prev_length){q=n.strstart+n.lookahead-Z;p=ma._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-Z);n.lookahead-=n.prev_length-1;n.prev_length-=2;do++n.strstart<=q&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Z-1])&n.hash_mask,k=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(0!==--n.prev_length);if(n.match_available=0,n.match_length=Z-1,n.strstart++,p&&(J(n,!1),0===n.strm.avail_out))return D}else if(n.match_available){if(p=
ma._tr_tally(n,0,n.window[n.strstart-1]),p&&J(n,!1),n.strstart++,n.lookahead--,0===n.strm.avail_out)return D}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(ma._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<Z-1?n.strstart:Z-1,m===da?(J(n,!0),0===n.strm.avail_out?ka:Aa):n.last_lit&&(J(n,!1),0===n.strm.avail_out)?D:fb}function ea(d,h,m,k,p){this.good_length=d;this.max_lazy=h;this.nice_length=m;this.max_chain=k;this.func=p}function L(){this.strm=
null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=K;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=
this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new pa.Buf16(2*Wa);this.dyn_dtree=new pa.Buf16(2*(2*ob+1));this.bl_tree=new pa.Buf16(2*(2*q+1));z(this.dyn_ltree);z(this.dyn_dtree);z(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new pa.Buf16(jb+1);this.heap=new pa.Buf16(2*Va+1);z(this.heap);this.heap_max=this.heap_len=0;this.depth=new pa.Buf16(2*Va+1);z(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=
this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function wa(d){var h;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=Ca,h=d.state,h.pending=0,h.pending_out=0,0>h.wrap&&(h.wrap=-h.wrap),h.status=h.wrap?N:F,d.adler=2===h.wrap?0:1,h.last_flush=M,ma._tr_init(h),qa):B(d,P)}function fa(d){var h=wa(d);h===qa&&(d=d.state,d.window_size=2*d.w_size,z(d.head),d.max_lazy_match=ra[d.level].max_lazy,d.good_match=ra[d.level].good_length,d.nice_match=ra[d.level].nice_length,d.max_chain_length=ra[d.level].max_chain,
d.strstart=0,d.block_start=0,d.lookahead=0,d.insert=0,d.match_length=d.prev_length=Z-1,d.match_available=0,d.ins_h=0);return h}function ta(d,h,m,k,p,q){if(!d)return P;var n=1;if(h===T&&(h=6),0>k?(n=0,k=-k):15<k&&(n=2,k-=16),1>p||p>I||m!==K||8>k||15<k||0>h||9<h||0>q||q>Ya)return B(d,P);8===k&&(k=9);var C=new L;return d.state=C,C.strm=d,C.wrap=n,C.gzhead=null,C.w_bits=k,C.w_size=1<<C.w_bits,C.w_mask=C.w_size-1,C.hash_bits=p+7,C.hash_size=1<<C.hash_bits,C.hash_mask=C.hash_size-1,C.hash_shift=~~((C.hash_bits+
Z-1)/Z),C.window=new pa.Buf8(2*C.w_size),C.head=new pa.Buf16(C.hash_size),C.prev=new pa.Buf16(C.w_size),C.lit_bufsize=1<<p+6,C.pending_buf_size=4*C.lit_bufsize,C.pending_buf=new pa.Buf8(C.pending_buf_size),C.d_buf=1*C.lit_bufsize,C.l_buf=3*C.lit_bufsize,C.level=h,C.strategy=q,C.method=m,fa(d)}var pa=k("../utils/common"),ma=k("./trees"),V=k("./adler32"),ca=k("./crc32"),na=k("./messages"),M=0,da=4,qa=0,P=-2,T=-1,Sa=1,Ya=4,Ca=2,K=8,I=9,Va=286,ob=30,q=19,Wa=2*Va+1,jb=15,Z=3,aa=258,ba=aa+Z+1,N=42,F=113,
D=1,fb=2,ka=3,Aa=4;var ra=[new ea(0,0,0,0,function(d,m){var n=65535;for(n>d.pending_buf_size-5&&(n=d.pending_buf_size-5);;){if(1>=d.lookahead){if(h(d),0===d.lookahead&&m===M)return D;if(0===d.lookahead)break}d.strstart+=d.lookahead;d.lookahead=0;var k=d.block_start+n;if((0===d.strstart||d.strstart>=k)&&(d.lookahead=d.strstart-k,d.strstart=k,J(d,!1),0===d.strm.avail_out)||d.strstart-d.block_start>=d.w_size-ba&&(J(d,!1),0===d.strm.avail_out))return D}return d.insert=0,m===da?(J(d,!0),0===d.strm.avail_out?
ka:Aa):(d.strstart>d.block_start&&J(d,!1),D)}),new ea(4,4,8,4,w),new ea(4,5,16,8,w),new ea(4,6,32,32,w),new ea(4,4,16,16,m),new ea(8,16,32,32,m),new ea(8,16,128,128,m),new ea(8,32,128,256,m),new ea(32,128,258,1024,m),new ea(32,258,258,4096,m)];t.deflateInit=function(d,h){return ta(d,h,K,15,8,0)};t.deflateInit2=ta;t.deflateReset=fa;t.deflateResetKeep=wa;t.deflateSetHeader=function(d,h){return d&&d.state?2!==d.state.wrap?P:(d.state.gzhead=h,qa):P};t.deflate=function(d,m){var n,k;if(!d||!d.state||5<
m||0>m)return d?B(d,P):P;if(k=d.state,!d.output||!d.input&&0!==d.avail_in||666===k.status&&m!==da)return B(d,0===d.avail_out?-5:P);if(k.strm=d,n=k.last_flush,k.last_flush=m,k.status===N)if(2===k.wrap)d.adler=0,G(k,31),G(k,139),G(k,8),k.gzhead?(G(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),G(k,255&k.gzhead.time),G(k,k.gzhead.time>>8&255),G(k,k.gzhead.time>>16&255),G(k,k.gzhead.time>>24&255),G(k,9===k.level?2:2<=k.strategy||2>k.level?4:
0),G(k,255&k.gzhead.os),k.gzhead.extra&&k.gzhead.extra.length&&(G(k,255&k.gzhead.extra.length),G(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(d.adler=ca(d.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=69):(G(k,0),G(k,0),G(k,0),G(k,0),G(k,0),G(k,9===k.level?2:2<=k.strategy||2>k.level?4:0),G(k,3),k.status=F);else{var q=K+(k.w_bits-8<<4)<<8;q|=(2<=k.strategy||2>k.level?0:6>k.level?1:6===k.level?2:3)<<6;0!==k.strstart&&(q|=32);k.status=F;p(k,q+(31-q%31));0!==k.strstart&&(p(k,d.adler>>>16),
p(k,65535&d.adler));d.adler=1}if(69===k.status)if(k.gzhead.extra){for(q=k.pending;k.gzindex<(65535&k.gzhead.extra.length)&&(k.pending!==k.pending_buf_size||(k.gzhead.hcrc&&k.pending>q&&(d.adler=ca(d.adler,k.pending_buf,k.pending-q,q)),u(d),q=k.pending,k.pending!==k.pending_buf_size));)G(k,255&k.gzhead.extra[k.gzindex]),k.gzindex++;k.gzhead.hcrc&&k.pending>q&&(d.adler=ca(d.adler,k.pending_buf,k.pending-q,q));k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=73)}else k.status=73;if(73===k.status)if(k.gzhead.name){q=
k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>q&&(d.adler=ca(d.adler,k.pending_buf,k.pending-q,q)),u(d),q=k.pending,k.pending===k.pending_buf_size)){var t=1;break}t=k.gzindex<k.gzhead.name.length?255&k.gzhead.name.charCodeAt(k.gzindex++):0;G(k,t)}while(0!==t);k.gzhead.hcrc&&k.pending>q&&(d.adler=ca(d.adler,k.pending_buf,k.pending-q,q));0===t&&(k.gzindex=0,k.status=91)}else k.status=91;if(91===k.status)if(k.gzhead.comment){q=k.pending;do{if(k.pending===k.pending_buf_size&&
(k.gzhead.hcrc&&k.pending>q&&(d.adler=ca(d.adler,k.pending_buf,k.pending-q,q)),u(d),q=k.pending,k.pending===k.pending_buf_size)){t=1;break}t=k.gzindex<k.gzhead.comment.length?255&k.gzhead.comment.charCodeAt(k.gzindex++):0;G(k,t)}while(0!==t);k.gzhead.hcrc&&k.pending>q&&(d.adler=ca(d.adler,k.pending_buf,k.pending-q,q));0===t&&(k.status=103)}else k.status=103;if(103===k.status&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&u(d),k.pending+2<=k.pending_buf_size&&(G(k,255&d.adler),G(k,d.adler>>8&255),
d.adler=0,k.status=F)):k.status=F),0!==k.pending){if(u(d),0===d.avail_out)return k.last_flush=-1,qa}else if(0===d.avail_in&&(m<<1)-(4<m?9:0)<=(n<<1)-(4<n?9:0)&&m!==da)return B(d,-5);if(666===k.status&&0!==d.avail_in)return B(d,-5);if(0!==d.avail_in||0!==k.lookahead||m!==M&&666!==k.status){if(2===k.strategy)a:{for(var w;;){if(0===k.lookahead&&(h(k),0===k.lookahead)){if(m===M){var v=D;break a}break}if(k.match_length=0,w=ma._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++,w&&(J(k,!1),0===
k.strm.avail_out)){v=D;break a}}v=(k.insert=0,m===da?(J(k,!0),0===k.strm.avail_out?ka:Aa):k.last_lit&&(J(k,!1),0===k.strm.avail_out)?D:fb)}else if(3===k.strategy)a:{var I,T;for(w=k.window;;){if(k.lookahead<=aa){if(h(k),k.lookahead<=aa&&m===M){v=D;break a}if(0===k.lookahead)break}if(k.match_length=0,k.lookahead>=Z&&0<k.strstart&&(T=k.strstart-1,I=w[T],I===w[++T]&&I===w[++T]&&I===w[++T])){for(n=k.strstart+aa;I===w[++T]&&I===w[++T]&&I===w[++T]&&I===w[++T]&&I===w[++T]&&I===w[++T]&&I===w[++T]&&I===w[++T]&&
T<n;);k.match_length=aa-(n-T);k.match_length>k.lookahead&&(k.match_length=k.lookahead)}if(k.match_length>=Z?(v=ma._tr_tally(k,1,k.match_length-Z),k.lookahead-=k.match_length,k.strstart+=k.match_length,k.match_length=0):(v=ma._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++),v&&(J(k,!1),0===k.strm.avail_out)){v=D;break a}}v=(k.insert=0,m===da?(J(k,!0),0===k.strm.avail_out?ka:Aa):k.last_lit&&(J(k,!1),0===k.strm.avail_out)?D:fb)}else v=ra[k.level].func(k,m);if(v!==ka&&v!==Aa||(k.status=
666),v===D||v===ka)return 0===d.avail_out&&(k.last_flush=-1),qa;if(v===fb&&(1===m?ma._tr_align(k):5!==m&&(ma._tr_stored_block(k,0,0,!1),3===m&&(z(k.head),0===k.lookahead&&(k.strstart=0,k.block_start=0,k.insert=0))),u(d),0===d.avail_out))return k.last_flush=-1,qa}return m!==da?qa:0>=k.wrap?1:(2===k.wrap?(G(k,255&d.adler),G(k,d.adler>>8&255),G(k,d.adler>>16&255),G(k,d.adler>>24&255),G(k,255&d.total_in),G(k,d.total_in>>8&255),G(k,d.total_in>>16&255),G(k,d.total_in>>24&255)):(p(k,d.adler>>>16),p(k,65535&
d.adler)),u(d),0<k.wrap&&(k.wrap=-k.wrap),0!==k.pending?qa:1)};t.deflateEnd=function(d){var h;return d&&d.state?(h=d.state.status,h!==N&&69!==h&&73!==h&&91!==h&&103!==h&&h!==F&&666!==h?B(d,P):(d.state=null,h===F?B(d,-3):qa)):P};t.deflateSetDictionary=function(d,k){var m,n,p;var q=k.length;if(!d||!d.state||(m=d.state,n=m.wrap,2===n||1===n&&m.status!==N||m.lookahead))return P;1===n&&(d.adler=V(d.adler,k,q,0));m.wrap=0;q>=m.w_size&&(0===n&&(z(m.head),m.strstart=0,m.block_start=0,m.insert=0),p=new pa.Buf8(m.w_size),
pa.arraySet(p,k,q-m.w_size,m.w_size,0),k=p,q=m.w_size);p=d.avail_in;var t=d.next_in;var u=d.input;d.avail_in=q;d.next_in=0;d.input=k;for(h(m);m.lookahead>=Z;){k=m.strstart;q=m.lookahead-(Z-1);do m.ins_h=(m.ins_h<<m.hash_shift^m.window[k+Z-1])&m.hash_mask,m.prev[k&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=k,k++;while(--q);m.strstart=k;m.lookahead=Z-1;h(m)}return m.strstart+=m.lookahead,m.block_start=m.strstart,m.insert=m.lookahead,m.lookahead=0,m.match_length=m.prev_length=Z-1,m.match_available=0,
d.next_in=t,d.input=u,d.avail_in=p,m.wrap=n,qa};t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(k,v,t){v.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],10:[function(k,v,t){v.exports=function(k,t){var u,v,B;var p=k.state;var d=k.next_in;var h=k.input;var w=d+(k.avail_in-5);var m=k.next_out;var z=k.output;
t=m-(t-k.avail_out);var L=m+(k.avail_out-257);var wa=p.dmax;var fa=p.wsize;var ta=p.whave;var pa=p.wnext;var ma=p.window;var V=p.hold;var ca=p.bits;var na=p.lencode;var M=p.distcode;var da=(1<<p.lenbits)-1;var qa=(1<<p.distbits)-1;a:do{15>ca&&(V+=h[d++]<<ca,ca+=8,V+=h[d++]<<ca,ca+=8);var P=na[V&da];b:for(;;){if(u=P>>>24,V>>>=u,ca-=u,u=P>>>16&255,0===u)z[m++]=65535&P;else{if(!(16&u)){if(0===(64&u)){P=na[(65535&P)+(V&(1<<u)-1)];continue b}if(32&u){p.mode=12;break a}k.msg="invalid literal/length code";
p.mode=30;break a}var T=65535&P;(u&=15)&&(ca<u&&(V+=h[d++]<<ca,ca+=8),T+=V&(1<<u)-1,V>>>=u,ca-=u);15>ca&&(V+=h[d++]<<ca,ca+=8,V+=h[d++]<<ca,ca+=8);P=M[V&qa];c:for(;;){if(u=P>>>24,V>>>=u,ca-=u,u=P>>>16&255,!(16&u)){if(0===(64&u)){P=M[(65535&P)+(V&(1<<u)-1)];continue c}k.msg="invalid distance code";p.mode=30;break a}if(v=65535&P,u&=15,ca<u&&(V+=h[d++]<<ca,ca+=8,ca<u&&(V+=h[d++]<<ca,ca+=8)),v+=V&(1<<u)-1,v>wa){k.msg="invalid distance too far back";p.mode=30;break a}if(V>>>=u,ca-=u,u=m-t,v>u){if(u=v-
u,u>ta&&p.sane){k.msg="invalid distance too far back";p.mode=30;break a}if(P=0,B=ma,0===pa){if(P+=fa-u,u<T){T-=u;do z[m++]=ma[P++];while(--u);P=m-v;B=z}}else if(pa<u){if(P+=fa+pa-u,u-=pa,u<T){T-=u;do z[m++]=ma[P++];while(--u);if(P=0,pa<T){u=pa;T-=u;do z[m++]=ma[P++];while(--u);P=m-v;B=z}}}else if(P+=pa-u,u<T){T-=u;do z[m++]=ma[P++];while(--u);P=m-v;B=z}for(;2<T;)z[m++]=B[P++],z[m++]=B[P++],z[m++]=B[P++],T-=3;T&&(z[m++]=B[P++],1<T&&(z[m++]=B[P++]))}else{P=m-v;do z[m++]=z[P++],z[m++]=z[P++],z[m++]=
z[P++],T-=3;while(2<T);T&&(z[m++]=z[P++],1<T&&(z[m++]=z[P++]))}break}}break}}while(d<w&&m<L);T=ca>>3;d-=T;ca-=T<<3;k.next_in=d;k.next_out=m;k.avail_in=d<w?5+(w-d):5-(d-w);k.avail_out=m<L?257+(L-m):257-(m-L);p.hold=V&(1<<ca)-1;p.bits=ca}},{}],11:[function(k,v,t){function B(d){return(d>>>24&255)+(d>>>8&65280)+((65280&d)<<8)+((255&d)<<24)}function z(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=
0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new m.Buf16(320);this.work=new m.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function u(d){var h;return d&&d.state?(h=d.state,d.total_in=d.total_out=h.total=0,d.msg="",h.wrap&&(d.adler=1&h.wrap),h.mode=ma,h.last=0,h.havedict=0,h.dmax=32768,h.head=null,h.hold=0,h.bits=0,
h.lencode=h.lendyn=new m.Buf32(V),h.distcode=h.distdyn=new m.Buf32(ca),h.sane=1,h.back=-1,ta):pa}function J(d){var h;return d&&d.state?(h=d.state,h.wsize=0,h.whave=0,h.wnext=0,u(d)):pa}function G(d,h){var k,m;return d&&d.state?(m=d.state,0>h?(k=0,h=-h):(k=(h>>4)+1,48>h&&(h&=15)),h&&(8>h||15<h)?pa:(null!==m.window&&m.wbits!==h&&(m.window=null),m.wrap=k,m.wbits=h,J(d))):pa}function p(d,h){var k,m;return d?(m=new z,d.state=m,m.window=null,k=G(d,h),k!==ta&&(d.state=null),k):pa}function d(d,h,k,p){var t;
d=d.state;return null===d.window&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new m.Buf8(d.wsize)),p>=d.wsize?(m.arraySet(d.window,h,k-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(t=d.wsize-d.wnext,t>p&&(t=p),m.arraySet(d.window,h,k-p,t,d.wnext),p-=t,p?(m.arraySet(d.window,h,k-p,p,0),d.wnext=p,d.whave=d.wsize):(d.wnext+=t,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=t))),0}var h,w,m=k("../utils/common"),ea=k("./adler32"),L=k("./crc32"),wa=k("./inffast"),fa=k("./inftrees"),ta=0,
pa=-2,ma=1,V=852,ca=592,na=!0;t.inflateReset=J;t.inflateReset2=G;t.inflateResetKeep=u;t.inflateInit=function(d){return p(d,15)};t.inflateInit2=p;t.inflate=function(k,p){var t,u,v,z,G,J,K,I=0,M=new m.Buf8(4),da=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&0!==k.avail_in)return pa;var q=k.state;12===q.mode&&(q.mode=13);var V=k.next_out;var ca=k.output;var Z=k.avail_out;var aa=k.next_in;var ba=k.input;var N=k.avail_in;var F=q.hold;var D=q.bits;var fb=N;var ka=
Z;var Aa=ta;a:for(;;)switch(q.mode){case ma:if(0===q.wrap){q.mode=13;break}for(;16>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}if(2&q.wrap&&35615===F){q.check=0;M[0]=255&F;M[1]=F>>>8&255;q.check=L(q.check,M,2,0);D=F=0;q.mode=2;break}if(q.flags=0,q.head&&(q.head.done=!1),!(1&q.wrap)||(((255&F)<<8)+(F>>8))%31){k.msg="incorrect header check";q.mode=30;break}if(8!==(15&F)){k.msg="unknown compression method";q.mode=30;break}if(F>>>=4,D-=4,J=(15&F)+8,0===q.wbits)q.wbits=J;else if(J>q.wbits){k.msg="invalid window size";
q.mode=30;break}q.dmax=1<<J;k.adler=q.check=1;q.mode=512&F?10:12;D=F=0;break;case 2:for(;16>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}if(q.flags=F,8!==(255&q.flags)){k.msg="unknown compression method";q.mode=30;break}if(57344&q.flags){k.msg="unknown header flags set";q.mode=30;break}q.head&&(q.head.text=F>>8&1);512&q.flags&&(M[0]=255&F,M[1]=F>>>8&255,q.check=L(q.check,M,2,0));D=F=0;q.mode=3;case 3:for(;32>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}q.head&&(q.head.time=F);512&q.flags&&(M[0]=255&
F,M[1]=F>>>8&255,M[2]=F>>>16&255,M[3]=F>>>24&255,q.check=L(q.check,M,4,0));D=F=0;q.mode=4;case 4:for(;16>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}q.head&&(q.head.xflags=255&F,q.head.os=F>>8);512&q.flags&&(M[0]=255&F,M[1]=F>>>8&255,q.check=L(q.check,M,2,0));D=F=0;q.mode=5;case 5:if(1024&q.flags){for(;16>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}q.length=F;q.head&&(q.head.extra_len=F);512&q.flags&&(M[0]=255&F,M[1]=F>>>8&255,q.check=L(q.check,M,2,0));D=F=0}else q.head&&(q.head.extra=null);q.mode=
6;case 6:if(1024&q.flags&&(t=q.length,t>N&&(t=N),t&&(q.head&&(J=q.head.extra_len-q.length,q.head.extra||(q.head.extra=Array(q.head.extra_len)),m.arraySet(q.head.extra,ba,aa,t,J)),512&q.flags&&(q.check=L(q.check,ba,t,aa)),N-=t,aa+=t,q.length-=t),q.length))break a;q.length=0;q.mode=7;case 7:if(2048&q.flags){if(0===N)break a;t=0;do J=ba[aa+t++],q.head&&J&&65536>q.length&&(q.head.name+=String.fromCharCode(J));while(J&&t<N);if(512&q.flags&&(q.check=L(q.check,ba,t,aa)),N-=t,aa+=t,J)break a}else q.head&&
(q.head.name=null);q.length=0;q.mode=8;case 8:if(4096&q.flags){if(0===N)break a;t=0;do J=ba[aa+t++],q.head&&J&&65536>q.length&&(q.head.comment+=String.fromCharCode(J));while(J&&t<N);if(512&q.flags&&(q.check=L(q.check,ba,t,aa)),N-=t,aa+=t,J)break a}else q.head&&(q.head.comment=null);q.mode=9;case 9:if(512&q.flags){for(;16>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}if(F!==(65535&q.check)){k.msg="header crc mismatch";q.mode=30;break}D=F=0}q.head&&(q.head.hcrc=q.flags>>9&1,q.head.done=!0);k.adler=q.check=
0;q.mode=12;break;case 10:for(;32>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}k.adler=q.check=B(F);D=F=0;q.mode=11;case 11:if(0===q.havedict)return k.next_out=V,k.avail_out=Z,k.next_in=aa,k.avail_in=N,q.hold=F,q.bits=D,2;k.adler=q.check=1;q.mode=12;case 12:if(5===p||6===p)break a;case 13:if(q.last){F>>>=7&D;D-=7&D;q.mode=27;break}for(;3>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}switch(q.last=1&F,F>>>=1,--D,3&F){case 0:q.mode=14;break;case 1:var ra=q;if(na){h=new m.Buf32(512);w=new m.Buf32(32);
for(v=0;144>v;)ra.lens[v++]=8;for(;256>v;)ra.lens[v++]=9;for(;280>v;)ra.lens[v++]=7;for(;288>v;)ra.lens[v++]=8;fa(1,ra.lens,0,288,h,0,ra.work,{bits:9});for(v=0;32>v;)ra.lens[v++]=5;fa(2,ra.lens,0,32,w,0,ra.work,{bits:5});na=!1}ra.lencode=h;ra.lenbits=9;ra.distcode=w;ra.distbits=5;if(q.mode=20,6===p){F>>>=2;D-=2;break a}break;case 2:q.mode=17;break;case 3:k.msg="invalid block type",q.mode=30}F>>>=2;D-=2;break;case 14:F>>>=7&D;for(D-=7&D;32>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}if((65535&F)!==
(F>>>16^65535)){k.msg="invalid stored block lengths";q.mode=30;break}if(q.length=65535&F,F=0,D=0,q.mode=15,6===p)break a;case 15:q.mode=16;case 16:if(t=q.length){if(t>N&&(t=N),t>Z&&(t=Z),0===t)break a;m.arraySet(ca,ba,aa,t,V);N-=t;aa+=t;Z-=t;V+=t;q.length-=t;break}q.mode=12;break;case 17:for(;14>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}if(q.nlen=(31&F)+257,F>>>=5,D-=5,q.ndist=(31&F)+1,F>>>=5,D-=5,q.ncode=(15&F)+4,F>>>=4,D-=4,286<q.nlen||30<q.ndist){k.msg="too many length or distance symbols";
q.mode=30;break}q.have=0;q.mode=18;case 18:for(;q.have<q.ncode;){for(;3>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}q.lens[da[q.have++]]=7&F;F>>>=3;D-=3}for(;19>q.have;)q.lens[da[q.have++]]=0;if(q.lencode=q.lendyn,q.lenbits=7,K={bits:q.lenbits},Aa=fa(0,q.lens,0,19,q.lencode,0,q.work,K),q.lenbits=K.bits,Aa){k.msg="invalid code lengths set";q.mode=30;break}q.have=0;q.mode=19;case 19:for(;q.have<q.nlen+q.ndist;){for(;I=q.lencode[F&(1<<q.lenbits)-1],z=I>>>24,ra=65535&I,!(z<=D);){if(0===N)break a;N--;
F+=ba[aa++]<<D;D+=8}if(16>ra)F>>>=z,D-=z,q.lens[q.have++]=ra;else{if(16===ra){for(v=z+2;D<v;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}if(F>>>=z,D-=z,0===q.have){k.msg="invalid bit length repeat";q.mode=30;break}J=q.lens[q.have-1];t=3+(3&F);F>>>=2;D-=2}else if(17===ra){for(v=z+3;D<v;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}F>>>=z;D-=z;J=0;t=3+(7&F);F>>>=3;D-=3}else{for(v=z+7;D<v;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}F>>>=z;D-=z;J=0;t=11+(127&F);F>>>=7;D-=7}if(q.have+t>q.nlen+q.ndist){k.msg=
"invalid bit length repeat";q.mode=30;break}for(;t--;)q.lens[q.have++]=J}}if(30===q.mode)break;if(0===q.lens[256]){k.msg="invalid code -- missing end-of-block";q.mode=30;break}if(q.lenbits=9,K={bits:q.lenbits},Aa=fa(1,q.lens,0,q.nlen,q.lencode,0,q.work,K),q.lenbits=K.bits,Aa){k.msg="invalid literal/lengths set";q.mode=30;break}if(q.distbits=6,q.distcode=q.distdyn,K={bits:q.distbits},Aa=fa(2,q.lens,q.nlen,q.ndist,q.distcode,0,q.work,K),q.distbits=K.bits,Aa){k.msg="invalid distances set";q.mode=30;
break}if(q.mode=20,6===p)break a;case 20:q.mode=21;case 21:if(6<=N&&258<=Z){k.next_out=V;k.avail_out=Z;k.next_in=aa;k.avail_in=N;q.hold=F;q.bits=D;wa(k,ka);V=k.next_out;ca=k.output;Z=k.avail_out;aa=k.next_in;ba=k.input;N=k.avail_in;F=q.hold;D=q.bits;12===q.mode&&(q.back=-1);break}for(q.back=0;I=q.lencode[F&(1<<q.lenbits)-1],z=I>>>24,v=I>>>16&255,ra=65535&I,!(z<=D);){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}if(v&&0===(240&v)){var n=z;var ha=v;for(G=ra;I=q.lencode[G+((F&(1<<n+ha)-1)>>n)],z=I>>>24,v=
I>>>16&255,ra=65535&I,!(n+z<=D);){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}F>>>=n;D-=n;q.back+=n}if(F>>>=z,D-=z,q.back+=z,q.length=ra,0===v){q.mode=26;break}if(32&v){q.back=-1;q.mode=12;break}if(64&v){k.msg="invalid literal/length code";q.mode=30;break}q.extra=15&v;q.mode=22;case 22:if(q.extra){for(v=q.extra;D<v;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}q.length+=F&(1<<q.extra)-1;F>>>=q.extra;D-=q.extra;q.back+=q.extra}q.was=q.length;q.mode=23;case 23:for(;I=q.distcode[F&(1<<q.distbits)-1],z=I>>>
24,v=I>>>16&255,ra=65535&I,!(z<=D);){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}if(0===(240&v)){n=z;ha=v;for(G=ra;I=q.distcode[G+((F&(1<<n+ha)-1)>>n)],z=I>>>24,v=I>>>16&255,ra=65535&I,!(n+z<=D);){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}F>>>=n;D-=n;q.back+=n}if(F>>>=z,D-=z,q.back+=z,64&v){k.msg="invalid distance code";q.mode=30;break}q.offset=ra;q.extra=15&v;q.mode=24;case 24:if(q.extra){for(v=q.extra;D<v;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}q.offset+=F&(1<<q.extra)-1;F>>>=q.extra;D-=q.extra;
q.back+=q.extra}if(q.offset>q.dmax){k.msg="invalid distance too far back";q.mode=30;break}q.mode=25;case 25:if(0===Z)break a;if(t=ka-Z,q.offset>t){if(t=q.offset-t,t>q.whave&&q.sane){k.msg="invalid distance too far back";q.mode=30;break}t>q.wnext?(t-=q.wnext,u=q.wsize-t):u=q.wnext-t;t>q.length&&(t=q.length);v=q.window}else v=ca,u=V-q.offset,t=q.length;t>Z&&(t=Z);Z-=t;q.length-=t;do ca[V++]=v[u++];while(--t);0===q.length&&(q.mode=21);break;case 26:if(0===Z)break a;ca[V++]=q.length;Z--;q.mode=21;break;
case 27:if(q.wrap){for(;32>D;){if(0===N)break a;N--;F|=ba[aa++]<<D;D+=8}if(ka-=Z,k.total_out+=ka,q.total+=ka,ka&&(k.adler=q.check=q.flags?L(q.check,ca,ka,V-ka):ea(q.check,ca,ka,V-ka)),ka=Z,(q.flags?F:B(F))!==q.check){k.msg="incorrect data check";q.mode=30;break}D=F=0}q.mode=28;case 28:if(q.wrap&&q.flags){for(;32>D;){if(0===N)break a;N--;F+=ba[aa++]<<D;D+=8}if(F!==(4294967295&q.total)){k.msg="incorrect length check";q.mode=30;break}D=F=0}q.mode=29;case 29:Aa=1;break a;case 30:Aa=-3;break a;case 31:return-4;
default:return pa}return k.next_out=V,k.avail_out=Z,k.next_in=aa,k.avail_in=N,q.hold=F,q.bits=D,(q.wsize||ka!==k.avail_out&&30>q.mode&&(27>q.mode||4!==p))&&d(k,k.output,k.next_out,ka-k.avail_out)?(q.mode=31,-4):(fb-=k.avail_in,ka-=k.avail_out,k.total_in+=fb,k.total_out+=ka,q.total+=ka,q.wrap&&ka&&(k.adler=q.check=q.flags?L(q.check,ca,ka,k.next_out-ka):ea(q.check,ca,ka,k.next_out-ka)),k.data_type=q.bits+(q.last?64:0)+(12===q.mode?128:0)+(20===q.mode||15===q.mode?256:0),(0===fb&&0===ka||4===p)&&Aa===
ta&&(Aa=-5),Aa)};t.inflateEnd=function(d){if(!d||!d.state)return pa;var h=d.state;return h.window&&(h.window=null),d.state=null,ta};t.inflateGetHeader=function(d,h){var k;return d&&d.state?(k=d.state,0===(2&k.wrap)?pa:(k.head=h,h.done=!1,ta)):pa};t.inflateSetDictionary=function(h,k){var m,p,t=k.length;return h&&h.state?(m=h.state,0!==m.wrap&&11!==m.mode?pa:11===m.mode&&(p=1,p=ea(p,k,t,0),p!==m.check)?-3:d(h,k,t,t)?(m.mode=31,-4):(m.havedict=1,ta)):pa};t.inflateInfo="pako inflate (from Nodeca project)"},
{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(k,v,t){var B=k("../utils/common"),z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],G=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,
25,25,26,26,27,27,28,28,29,29,64,64];v.exports=function(k,d,h,t,m,v,L,wa){var p,w,ea,ma,V,ca,na=wa.bits,M,da,qa,P,T,Sa=0,Ya,Ca=null,K=0,I=new B.Buf16(16);var Va=new B.Buf16(16);var ob=null,q=0;for(M=0;15>=M;M++)I[M]=0;for(da=0;da<t;da++)I[d[h+da]]++;var Wa=na;for(qa=15;1<=qa&&0===I[qa];qa--);if(Wa>qa&&(Wa=qa),0===qa)return m[v++]=20971520,m[v++]=20971520,wa.bits=1,0;for(na=1;na<qa&&0===I[na];na++);Wa<na&&(Wa=na);for(M=p=1;15>=M;M++)if(p<<=1,p-=I[M],0>p)return-1;if(0<p&&(0===k||1!==qa))return-1;Va[1]=
0;for(M=1;15>M;M++)Va[M+1]=Va[M]+I[M];for(da=0;da<t;da++)0!==d[h+da]&&(L[Va[d[h+da]]++]=da);if(0===k?(Ca=ob=L,ma=19):1===k?(Ca=z,K-=257,ob=u,q-=257,ma=256):(Ca=J,ob=G,ma=-1),Ya=0,da=0,M=na,Va=v,P=Wa,T=0,ea=-1,Sa=1<<Wa,t=Sa-1,1===k&&852<Sa||2===k&&592<Sa)return 1;for(var jb=0;;){jb++;var Z=M-T;L[da]<ma?(V=0,ca=L[da]):L[da]>ma?(V=ob[q+L[da]],ca=Ca[K+L[da]]):(V=96,ca=0);p=1<<M-T;na=w=1<<P;do w-=p,m[Va+(Ya>>T)+w]=Z<<24|V<<16|ca|0;while(0!==w);for(p=1<<M-1;Ya&p;)p>>=1;if(0!==p?(Ya&=p-1,Ya+=p):Ya=0,da++,
0===--I[M]){if(M===qa)break;M=d[h+L[da]]}if(M>Wa&&(Ya&t)!==ea){0===T&&(T=Wa);Va+=na;P=M-T;for(p=1<<P;P+T<qa&&(p-=I[P+T],!(0>=p));)P++,p<<=1;if(Sa+=1<<P,1===k&&852<Sa||2===k&&592<Sa)return 1;ea=Ya&t;m[ea]=Wa<<24|P<<16|Va-v|0}}return 0!==Ya&&(m[Va+Ya]=M-T<<24|4194304),wa.bits=Wa,0}},{"../utils/common":3}],13:[function(k,v,t){v.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},
{}],14:[function(k,v,t){function B(d){for(var h=d.length;0<=--h;)d[h]=0}function z(d,h,k,m,n){this.static_tree=d;this.extra_bits=h;this.extra_base=k;this.elems=m;this.max_length=n;this.has_stree=d&&d.length}function u(d,h){this.dyn_tree=d;this.max_code=0;this.stat_desc=h}function J(d,h){d.pending_buf[d.pending++]=255&h;d.pending_buf[d.pending++]=h>>>8&255}function G(d,h,k){d.bi_valid>K-k?(d.bi_buf|=h<<d.bi_valid&65535,J(d,d.bi_buf),d.bi_buf=h>>K-d.bi_valid,d.bi_valid+=k-K):(d.bi_buf|=h<<d.bi_valid&
65535,d.bi_valid+=k)}function p(d,h,k){G(d,k[2*h],k[2*h+1])}function d(d,h){var k=0;do k|=1&d,d>>>=1,k<<=1;while(0<--h);return k>>>1}function h(h,k,m){var n,p=Array(Ca+1),q=0;for(n=1;n<=Ca;n++)p[n]=q=q+m[n-1]<<1;for(m=0;m<=k;m++)n=h[2*m+1],0!==n&&(h[2*m]=d(p[n]++,n))}function w(d){var h;for(h=0;h<P;h++)d.dyn_ltree[2*h]=0;for(h=0;h<T;h++)d.dyn_dtree[2*h]=0;for(h=0;h<Sa;h++)d.bl_tree[2*h]=0;d.dyn_ltree[2*I]=1;d.opt_len=d.static_len=0;d.last_lit=d.matches=0}function m(d){8<d.bi_valid?J(d,d.bi_buf):0<
d.bi_valid&&(d.pending_buf[d.pending++]=d.bi_buf);d.bi_buf=0;d.bi_valid=0}function ea(d,h,k,m){var n=2*h,p=2*k;return d[n]<d[p]||d[n]===d[p]&&m[h]<=m[k]}function L(d,h,k){for(var m=d.heap[k],n=k<<1;n<=d.heap_len&&(n<d.heap_len&&ea(h,d.heap[n+1],d.heap[n],d.depth)&&n++,!ea(h,m,d.heap[n],d.depth));)d.heap[k]=d.heap[n],k=n,n<<=1;d.heap[k]=m}function wa(d,h,k){var m,n,q=0;if(0!==d.last_lit){do{var t=d.pending_buf[d.d_buf+2*q]<<8|d.pending_buf[d.d_buf+2*q+1];var u=d.pending_buf[d.l_buf+q];q++;0===t?p(d,
u,h):(m=D[u],p(d,m+qa+1,h),n=Wa[m],0!==n&&(u-=fb[m],G(d,u,n)),t--,m=256>t?F[t]:F[256+(t>>>7)],p(d,m,k),n=jb[m],0!==n&&(t-=ka[m],G(d,t,n)))}while(q<d.last_lit)}p(d,I,h)}function fa(d,k){var m,n=k.dyn_tree;var p=k.stat_desc.static_tree;var q=k.stat_desc.has_stree,t=k.stat_desc.elems,u=-1;d.heap_len=0;d.heap_max=Ya;for(m=0;m<t;m++)0!==n[2*m]?(d.heap[++d.heap_len]=u=m,d.depth[m]=0):n[2*m+1]=0;for(;2>d.heap_len;){var w=d.heap[++d.heap_len]=2>u?++u:0;n[2*w]=1;d.depth[w]=0;d.opt_len--;q&&(d.static_len-=
p[2*w+1])}k.max_code=u;for(m=d.heap_len>>1;1<=m;m--)L(d,n,m);w=t;do m=d.heap[1],d.heap[1]=d.heap[d.heap_len--],L(d,n,1),p=d.heap[1],d.heap[--d.heap_max]=m,d.heap[--d.heap_max]=p,n[2*w]=n[2*m]+n[2*p],d.depth[w]=(d.depth[m]>=d.depth[p]?d.depth[m]:d.depth[p])+1,n[2*m+1]=n[2*p+1]=w,d.heap[1]=w++,L(d,n,1);while(2<=d.heap_len);d.heap[--d.heap_max]=d.heap[1];var v,C;m=k.dyn_tree;w=k.max_code;t=k.stat_desc.static_tree;var z=k.stat_desc.has_stree,B=k.stat_desc.extra_bits,D=k.stat_desc.extra_base,Q=k.stat_desc.max_length,
F=0;for(q=0;q<=Ca;q++)d.bl_count[q]=0;m[2*d.heap[d.heap_max]+1]=0;for(k=d.heap_max+1;k<Ya;k++)p=d.heap[k],q=m[2*m[2*p+1]+1]+1,q>Q&&(q=Q,F++),m[2*p+1]=q,p>w||(d.bl_count[q]++,v=0,p>=D&&(v=B[p-D]),C=m[2*p],d.opt_len+=C*(q+v),z&&(d.static_len+=C*(t[2*p+1]+v)));if(0!==F){do{for(q=Q-1;0===d.bl_count[q];)q--;d.bl_count[q]--;d.bl_count[q+1]+=2;d.bl_count[Q]--;F-=2}while(0<F);for(q=Q;0!==q;q--)for(p=d.bl_count[q];0!==p;)v=d.heap[--k],v>w||(m[2*v+1]!==q&&(d.opt_len+=(q-m[2*v+1])*m[2*v],m[2*v+1]=q),p--)}h(n,
u,d.bl_count)}function ta(d,h,k){var m,n=-1,p=h[1],t=0,u=7,w=4;0===p&&(u=138,w=3);h[2*(k+1)+1]=65535;for(m=0;m<=k;m++){var v=p;p=h[2*(m+1)+1];++t<u&&v===p||(t<w?d.bl_tree[2*v]+=t:0!==v?(v!==n&&d.bl_tree[2*v]++,d.bl_tree[2*Va]++):10>=t?d.bl_tree[2*ob]++:d.bl_tree[2*q]++,t=0,n=v,0===p?(u=138,w=3):v===p?(u=6,w=3):(u=7,w=4))}}function pa(d,h,k){var m,n,t=-1,u=h[1],v=0,w=7,C=4;0===u&&(w=138,C=3);for(m=0;m<=k;m++)if(n=u,u=h[2*(m+1)+1],!(++v<w&&n===u)){if(v<C){do p(d,n,d.bl_tree);while(0!==--v)}else 0!==
n?(n!==t&&(p(d,n,d.bl_tree),v--),p(d,Va,d.bl_tree),G(d,v-3,2)):10>=v?(p(d,ob,d.bl_tree),G(d,v-3,3)):(p(d,q,d.bl_tree),G(d,v-11,7));v=0;t=n;0===u?(w=138,C=3):n===u?(w=6,C=3):(w=7,C=4)}}function ma(d){var h,k=4093624447;for(h=0;31>=h;h++,k>>>=1)if(1&k&&0!==d.dyn_ltree[2*h])return na;if(0!==d.dyn_ltree[18]||0!==d.dyn_ltree[20]||0!==d.dyn_ltree[26])return M;for(h=32;h<qa;h++)if(0!==d.dyn_ltree[2*h])return M;return na}function V(d,h,k,n){G(d,(da<<1)+(n?1:0),3);m(d);J(d,k);J(d,~k);ca.arraySet(d.pending_buf,
d.window,h,k,d.pending);d.pending+=k}var ca=k("../utils/common"),na=0,M=1,da=0,qa=256,P=qa+1+29,T=30,Sa=19,Ya=2*P+1,Ca=15,K=16,I=256,Va=16,ob=17,q=18,Wa=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],jb=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],aa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ba=Array(2*(P+2));B(ba);var N=Array(2*T);B(N);var F=Array(512);B(F);var D=Array(256);B(D);var fb=Array(29);B(fb);var ka=Array(T);
B(ka);var Aa,ra,n,ha=!1;t._tr_init=function(k){if(!ha){var m,p,q,t=Array(Ca+1);for(q=p=0;28>q;q++)for(fb[q]=p,m=0;m<1<<Wa[q];m++)D[p++]=q;D[p-1]=q;for(q=p=0;16>q;q++)for(ka[q]=p,m=0;m<1<<jb[q];m++)F[p++]=q;for(p>>=7;q<T;q++)for(ka[q]=p<<7,m=0;m<1<<jb[q]-7;m++)F[256+p++]=q;for(m=0;m<=Ca;m++)t[m]=0;for(m=0;143>=m;)ba[2*m+1]=8,m++,t[8]++;for(;255>=m;)ba[2*m+1]=9,m++,t[9]++;for(;279>=m;)ba[2*m+1]=7,m++,t[7]++;for(;287>=m;)ba[2*m+1]=8,m++,t[8]++;h(ba,P+1,t);for(m=0;m<T;m++)N[2*m+1]=5,N[2*m]=d(m,5);Aa=
new z(ba,Wa,qa+1,P,Ca);ra=new z(N,jb,0,T,Ca);n=new z([],Z,0,Sa,7);ha=!0}k.l_desc=new u(k.dyn_ltree,Aa);k.d_desc=new u(k.dyn_dtree,ra);k.bl_desc=new u(k.bl_tree,n);k.bi_buf=0;k.bi_valid=0;w(k)};t._tr_stored_block=V;t._tr_flush_block=function(d,h,k,n){var p=0;if(0<d.level){2===d.strm.data_type&&(d.strm.data_type=ma(d));fa(d,d.l_desc);fa(d,d.d_desc);ta(d,d.dyn_ltree,d.l_desc.max_code);ta(d,d.dyn_dtree,d.d_desc.max_code);fa(d,d.bl_desc);for(p=Sa-1;3<=p&&0===d.bl_tree[2*aa[p]+1];p--);p=(d.opt_len+=3*(p+
1)+14,p);var q=d.opt_len+3+7>>>3;var t=d.static_len+3+7>>>3;t<=q&&(q=t)}else q=t=k+5;if(k+4<=q&&-1!==h)V(d,h,k,n);else if(4===d.strategy||t===q)G(d,2+(n?1:0),3),wa(d,ba,N);else{G(d,4+(n?1:0),3);h=d.l_desc.max_code+1;k=d.d_desc.max_code+1;p+=1;G(d,h-257,5);G(d,k-1,5);G(d,p-4,4);for(q=0;q<p;q++)G(d,d.bl_tree[2*aa[q]+1],3);pa(d,d.dyn_ltree,h-1);pa(d,d.dyn_dtree,k-1);wa(d,d.dyn_ltree,d.dyn_dtree)}w(d);n&&m(d)};t._tr_tally=function(d,h,k){return d.pending_buf[d.d_buf+2*d.last_lit]=h>>>8&255,d.pending_buf[d.d_buf+
2*d.last_lit+1]=255&h,d.pending_buf[d.l_buf+d.last_lit]=255&k,d.last_lit++,0===h?d.dyn_ltree[2*k]++:(d.matches++,h--,d.dyn_ltree[2*(D[k]+qa+1)]++,d.dyn_dtree[2*(256>h?F[h]:F[256+(h>>>7)])]++),d.last_lit===d.lit_bufsize-1};t._tr_align=function(d){G(d,2,3);p(d,I,ba);16===d.bi_valid?(J(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}},{"../utils/common":3}],15:[function(k,v,t){v.exports=function(){this.input=null;this.total_in=
this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],"/":[function(k,v,t){t=k("./lib/utils/common").assign;var B=k("./lib/deflate"),z=k("./lib/inflate");k=k("./lib/zlib/constants");var u={};t(u,B,z,k);v.exports=u},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});
var saveAs=saveAs||function(H){if(!("undefined"===typeof H||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var k=H.document.createElementNS("http://www.w3.org/1999/xhtml","a"),v="download"in k,t=/constructor/i.test(H.HTMLElement)||H.safari,B=/CriOS\/[\d]+/.test(navigator.userAgent),z=function(d){(H.setImmediate||H.setTimeout)(function(){throw d;},0)},u=function(d){setTimeout(function(){"string"===typeof d?(H.URL||H.webkitURL||H).revokeObjectURL(d):d.remove()},4E4)},J=function(d){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?
new Blob([String.fromCharCode(65279),d],{type:d.type}):d},G=function(d,h,p){p||(d=J(d));var m=this,w="application/octet-stream"===d.type,G=function(){var d=["writestart","progress","write","writeend"];d=[].concat(d);for(var h=d.length;h--;){var k=m["on"+d[h]];if("function"===typeof k)try{k.call(m,m)}catch(ma){z(ma)}}};m.readyState=m.INIT;if(v){var wa=(H.URL||H.webkitURL||H).createObjectURL(d);setTimeout(function(){k.href=wa;k.download=h;var d=new MouseEvent("click");k.dispatchEvent(d);G();u(wa);m.readyState=
m.DONE})}else(function(){if((B||w&&t)&&H.FileReader){var h=new FileReader;h.onloadend=function(){var d=B?h.result:h.result.replace(/^data:[^;]*;/,"data:attachment/file;");H.open(d,"_blank")||(H.location.href=d);m.readyState=m.DONE;G()};h.readAsDataURL(d);m.readyState=m.INIT}else wa||(wa=(H.URL||H.webkitURL||H).createObjectURL(d)),w?H.location.href=wa:H.open(wa,"_blank")||(H.location.href=wa),m.readyState=m.DONE,G(),u(wa)})()},p=G.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(d,
h,k){h=h||d.name||"download";k||(d=J(d));return navigator.msSaveOrOpenBlob(d,h)};p.abort=function(){};p.readyState=p.INIT=0;p.WRITING=1;p.DONE=2;p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null;return function(d,h,k){return new G(d,h||d.name||"download",k)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
"undefined"!==typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!==typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs});"function"==typeof define&&define.__amd&&(define.amd=define.__amd,delete define.__amd);
