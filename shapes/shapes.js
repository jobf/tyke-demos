/*
 howler.js v2.1.1 | (c) 2013-2018, James Simpson of GoldFire Studios | MIT License | howlerjs.com  Spatial Plugin  @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(H){var k=0;return function(){return k<H.length?{done:!1,value:H[k++]}:{done:!0}}};$jscomp.arrayIterator=function(H){return{next:$jscomp.arrayIteratorImpl(H)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(H,k,v){H!=Array.prototype&&H!=Object.prototype&&(H[k]=v.value)};$jscomp.getGlobal=function(H){H=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,H];for(var k=0;k<H.length;++k){var v=H[k];if(v&&v.Math==Math)return v}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(H,k){this.$jscomp$symbol$id_=H;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:k})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function H(v){if(this instanceof H)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(v||"")+"_"+k++,v)}var k=0;return H}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var H=$jscomp.global.Symbol.iterator;H||(H=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[H]&&$jscomp.defineProperty(Array.prototype,H,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var H=$jscomp.global.Symbol.asyncIterator;H||(H=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(H){$jscomp.initSymbolIterator();H={next:H};H[$jscomp.global.Symbol.iterator]=function(){return this};return H};
$jscomp.iteratorFromArray=function(H,k){$jscomp.initSymbolIterator();H instanceof String&&(H+="");var v=0,u={next:function(){if(v<H.length){var t=v++;return{value:k(t,H[t]),done:!1}}u.next=function(){return{done:!0,value:void 0}};return u.next()}};u[Symbol.iterator]=function(){return u};return u};
$jscomp.polyfill=function(H,k,v,u){if(k){v=$jscomp.global;H=H.split(".");for(u=0;u<H.length-1;u++){var t=H[u];t in v||(v[t]={});v=v[t]}H=H[H.length-1];u=v[H];k=k(u);k!=u&&null!=k&&$jscomp.defineProperty(v,H,{configurable:!0,writable:!0,value:k})}};$jscomp.polyfill("Array.prototype.values",function(H){return H?H:function(){return $jscomp.iteratorFromArray(this,function(k,v){return v})}},"es8","es3");
$jscomp.checkStringArgs=function(H,k,v){if(null==H)throw new TypeError("The 'this' value for String.prototype."+v+" must not be null or undefined");if(k instanceof RegExp)throw new TypeError("First argument to String.prototype."+v+" must not be a regular expression");return H+""};
$jscomp.polyfill("String.prototype.startsWith",function(H){return H?H:function(k,v){var u=$jscomp.checkStringArgs(this,k,"startsWith");k+="";var t=u.length,F=k.length;v=Math.max(0,Math.min(v|0,u.length));for(var B=0;B<F&&v<t;)if(u[v++]!=k[B++])return!1;return B>=F}},"es6","es3");$jscomp.polyfill("Array.prototype.keys",function(H){return H?H:function(){return $jscomp.iteratorFromArray(this,function(k){return k})}},"es6","es3");
$jscomp.polyfill("String.fromCodePoint",function(H){return H?H:function(k){for(var v="",u=0;u<arguments.length;u++){var t=Number(arguments[u]);if(0>t||1114111<t||t!==Math.floor(t))throw new RangeError("invalid_code_point "+t);65535>=t?v+=String.fromCharCode(t):(t-=65536,v+=String.fromCharCode(t>>>10&1023|55296),v+=String.fromCharCode(t&1023|56320))}return v}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(H){return H?H:function(k,v){var u=$jscomp.checkStringArgs(this,k,"endsWith");k+="";void 0===v&&(v=u.length);v=Math.max(0,Math.min(v|0,u.length));for(var t=k.length;0<t&&0<v;)if(u[--v]!=k[--t])return!1;return 0>=t}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(H){return H?H:function(k,v,u){var t=this.length||0;0>v&&(v=Math.max(0,t+v));if(null==u||u>t)u=t;u=Number(u);0>u&&(u=Math.max(0,t+u));for(v=Number(v||0);v<u;v++)this[v]=k;return this}},"es6","es3");
(function(H,k){H.lime=H.lime||{};H.lime.$scripts=H.lime.$scripts||{};H.lime.$scripts.shapes=function(k,u){(function(k,v){function B(a,b){a=Object.create(a);for(var c in b)a[c]=b[c];b.toString!==Object.prototype.toString&&(a.toString=b.toString);return a}function u(a,b){null==b&&(b=1);null==a&&(a=0);return a+Math.random()*(b-a)}function t(a){null==a&&(a=50);return Math.random()<a/100}function I(a){return a instanceof Array?new Cc(a):a.iterator()}function f(a,b){if(null==b)return null;null==b.__id__&&
(b.__id__=v.$haxeUID++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=b.bind(a),a.hx__closures__[b.__id__]=c);return c}k.echo=k.echo||{};k.lime=k.lime||{};var d={},n=function(){return ua.__string_rec(this,"")},y=y||{},h,J=function(){};d["lime.app.IModule"]=J;J.__name__=!0;J.__isInterface__=!0;var ma=function(){this.onExit=new ec};d["lime.app.Module"]=ma;ma.__name__=!0;ma.__interfaces__=[J];ma.prototype={__class__:ma};var ha=function(a){this.gameDeviceCache=
new Kb;this.parent=a;this.nextUpdate=this.lastUpdate=this.currentUpdate=0;this.framePeriod=-1;ic.init();this.accelerometer=jc.registerSensor(Re.ACCELEROMETER,0)};d["lime._internal.backend.html5.HTML5Application"]=ha;ha.__name__=!0;ha.prototype={convertKeyCode:function(a){if(65<=a&&90>=a)return a+32;switch(a){case 12:return 1073741980;case 16:return 1073742049;case 17:return 1073742048;case 18:return 1073742050;case 19:return 1073741896;case 20:return 1073741881;case 33:return 1073741899;case 34:return 1073741902;
case 35:return 1073741901;case 36:return 1073741898;case 37:return 1073741904;case 38:return 1073741906;case 39:return 1073741903;case 40:return 1073741905;case 41:return 1073741943;case 43:return 1073741940;case 44:return 1073741894;case 45:return 1073741897;case 46:return 127;case 91:return 1073742051;case 92:return 1073742055;case 93:return 1073742055;case 95:return 1073742106;case 96:return 1073741922;case 97:return 1073741913;case 98:return 1073741914;case 99:return 1073741915;case 100:return 1073741916;
case 101:return 1073741917;case 102:return 1073741918;case 103:return 1073741919;case 104:return 1073741920;case 105:return 1073741921;case 106:return 1073741909;case 107:return 1073741911;case 108:return 1073741923;case 109:return 1073741910;case 110:return 1073741923;case 111:return 1073741908;case 112:return 1073741882;case 113:return 1073741883;case 114:return 1073741884;case 115:return 1073741885;case 116:return 1073741886;case 117:return 1073741887;case 118:return 1073741888;case 119:return 1073741889;
case 120:return 1073741890;case 121:return 1073741891;case 122:return 1073741892;case 123:return 1073741893;case 124:return 1073741928;case 125:return 1073741929;case 126:return 1073741930;case 127:return 1073741931;case 128:return 1073741932;case 129:return 1073741933;case 130:return 1073741934;case 131:return 1073741935;case 132:return 1073741936;case 133:return 1073741937;case 134:return 1073741938;case 135:return 1073741939;case 144:return 1073741907;case 145:return 1073741895;case 160:return 94;
case 161:return 33;case 163:return 35;case 164:return 36;case 166:return 1073742094;case 167:return 1073742095;case 168:return 1073742097;case 169:return 41;case 170:return 42;case 171:return 96;case 172:return 1073741898;case 173:return 45;case 174:return 1073741953;case 175:return 1073741952;case 176:return 1073742082;case 177:return 1073742083;case 178:return 1073742084;case 179:return 1073742085;case 180:return 1073742089;case 181:return 1073742086;case 182:return 1073741953;case 183:return 1073741952;
case 186:return 59;case 187:return 61;case 188:return 44;case 189:return 45;case 190:return 46;case 191:return 47;case 192:return 96;case 193:return 63;case 194:return 1073741923;case 219:return 91;case 220:return 92;case 221:return 93;case 222:return 39;case 223:return 96;case 224:return 1073742051;case 226:return 92}return a},exec:function(){window.addEventListener("keydown",f(this,this.handleKeyEvent),!1);window.addEventListener("keyup",f(this,this.handleKeyEvent),!1);window.addEventListener("focus",
f(this,this.handleWindowEvent),!1);window.addEventListener("blur",f(this,this.handleWindowEvent),!1);window.addEventListener("resize",f(this,this.handleWindowEvent),!1);window.addEventListener("beforeunload",f(this,this.handleWindowEvent),!1);window.addEventListener("devicemotion",f(this,this.handleSensorEvent),!1);CanvasRenderingContext2D.prototype.isPointInStroke||(CanvasRenderingContext2D.prototype.isPointInStroke=function(a,b,c){return!1});CanvasRenderingContext2D.prototype.isPointInPath||(CanvasRenderingContext2D.prototype.isPointInPath=
function(a,b,c){return!1});0=="performance"in window&&(window.performance={});if(0=="now"in window.performance){var a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart);window.performance.now=function(){return Date.now()-a}}for(var b=0,c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"]||window[c[e]+
"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a,c){var e=(new Date).getTime(),g=Math.max(0,16-(e-b));c=window.setTimeout(function(){a(e+g)},g);b=e+g;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});window.requestAnimFrame=window.requestAnimationFrame;this.lastUpdate=(new Date).getTime();this.handleApplicationEvent();return 0},exit:function(){},handleApplicationEvent:function(a){a=0;for(var b=this.parent.__windows;a<
b.length;){var c=b[a];++a;c.__backend.updateSize()}this.updateGameDevices();this.currentUpdate=(new Date).getTime();if(this.currentUpdate>=this.nextUpdate){this.deltaTime=this.currentUpdate-this.lastUpdate;a=0;for(b=this.parent.__windows;a<b.length;)c=b[a],++a,this.parent.onUpdate.dispatch(this.deltaTime|0),null!=c.context&&c.onRender.dispatch(c.context);this.nextUpdate=0>this.framePeriod?this.currentUpdate:this.currentUpdate-this.currentUpdate%this.framePeriod+this.framePeriod;this.lastUpdate=this.currentUpdate}window.requestAnimationFrame(f(this,
this.handleApplicationEvent))},handleKeyEvent:function(a){if(null!=this.parent.__window){var b=this.convertKeyCode(null!=a.keyCode?a.keyCode:a.which),c=(a.shiftKey?3:0)|(a.ctrlKey?192:0)|(a.altKey?768:0)|(a.metaKey?3072:0);"keydown"==a.type?(this.parent.__window.onKeyDown.dispatch(b,c),this.parent.__window.onKeyDown.canceled&&a.cancelable&&a.preventDefault()):(this.parent.__window.onKeyUp.dispatch(b,c),this.parent.__window.onKeyUp.canceled&&a.cancelable&&a.preventDefault())}},handleSensorEvent:function(a){this.accelerometer.onUpdate.dispatch(a.accelerationIncludingGravity.x,
a.accelerationIncludingGravity.y,a.accelerationIncludingGravity.z)},handleWindowEvent:function(a){if(null!=this.parent.__window)switch(a.type){case "blur":this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0);break;case "focus":this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1);break;case "resize":this.parent.__window.__backend.handleResizeEvent(a);break;case "visibilitychange":window.document.hidden?
this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0):this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1)}},updateGameDevices:function(){var a=fb.__getDeviceData();if(null!=a)for(var b,c,e,g,l,x=0,m=a.length;x<m;)if(b=x++,g=a[b],null!=g){if(!this.gameDeviceCache.h.hasOwnProperty(b)){l=new Sd;l.id=b;l.connected=g.connected;c=0;for(e=g.buttons.length;c<e;){var ia=c++;l.buttons.push(g.buttons[ia].value)}c=
0;for(e=g.axes.length;c<e;)ia=c++,l.axes.push(g.axes[ia]);"standard"==g.mapping&&(l.isGamepad=!0);this.gameDeviceCache.h[b]=l;g.connected&&(fb.__connect(b),l.isGamepad&&Ta.__connect(b))}l=this.gameDeviceCache.h[b];e=fb.devices.h[b];c=Ta.devices.h[b];if(g.connected){for(var f=0,d=g.buttons.length;f<d;){var r=f++;ia=g.buttons[r].value;if(ia!=l.buttons[r]){if(6==r)e.onAxisMove.dispatch(g.axes.length,ia),null!=c&&c.onAxisMove.dispatch(4,ia);else if(7==r)e.onAxisMove.dispatch(g.axes.length+1,ia),null!=
c&&c.onAxisMove.dispatch(5,ia);else if(0<ia?e.onButtonDown.dispatch(r):e.onButtonUp.dispatch(r),null!=c){switch(r){case 0:b=0;break;case 1:b=1;break;case 2:b=2;break;case 3:b=3;break;case 4:b=9;break;case 5:b=10;break;case 8:b=4;break;case 9:b=6;break;case 10:b=7;break;case 11:b=8;break;case 12:b=11;break;case 13:b=12;break;case 14:b=13;break;case 15:b=14;break;case 16:b=5;break;default:continue}0<ia?c.onButtonDown.dispatch(b):c.onButtonUp.dispatch(b)}l.buttons[r]=ia}}b=0;for(ia=g.axes.length;b<ia;)f=
b++,g.axes[f]!=l.axes[f]&&(e.onAxisMove.dispatch(f,g.axes[f]),null!=c&&c.onAxisMove.dispatch(f,g.axes[f]),l.axes[f]=g.axes[f])}else l.connected&&(l.connected=!1,fb.__disconnect(b),Ta.__disconnect(b))}},__class__:ha};var F=function(){this.onCreateWindow=new Td;this.onUpdate=new ec;this.onExit=new ec;null==F.current&&(F.current=this);this.meta=new T;this.modules=[];this.__windowByID=new Kb;this.__windows=[];this.__backend=new ha(this);this.__registerLimeModule(this);this.__preloader=new Ud;this.__preloader.onProgress.add(f(this,
this.onPreloadProgress));this.__preloader.onComplete.add(f(this,this.onPreloadComplete))};d["lime.app.Application"]=F;F.__name__=!0;F.__super__=ma;F.prototype=B(ma.prototype,{createWindow:function(a){a=this.__createWindow(a);this.__addWindow(a);return a},exec:function(){F.current=this;return this.__backend.exec()},onGamepadAxisMove:function(a,b,c){},onGamepadButtonDown:function(a,b){},onGamepadButtonUp:function(a,b){},onGamepadConnect:function(a){},onGamepadDisconnect:function(a){},onJoystickAxisMove:function(a,
b,c){},onJoystickButtonDown:function(a,b){},onJoystickButtonUp:function(a,b){},onJoystickConnect:function(a){},onJoystickDisconnect:function(a){},onJoystickHatMove:function(a,b,c){},onJoystickTrackballMove:function(a,b,c,e){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onModuleExit:function(a){},onMouseDown:function(a,b,c){},onMouseMove:function(a,b){},onMouseMoveRelative:function(a,b){},onMouseUp:function(a,b,c){},onMouseWheel:function(a,b,c){},onPreloadComplete:function(){},onPreloadProgress:function(a,
b){},onRenderContextLost:function(){},onRenderContextRestored:function(a){},onTextEdit:function(a,b,c){},onTextInput:function(a){},onTouchCancel:function(a){},onTouchEnd:function(a){},onTouchMove:function(a){},onTouchStart:function(a){},onWindowActivate:function(){},onWindowClose:function(){},onWindowCreate:function(){},onWindowDeactivate:function(){},onWindowDropFile:function(a){},onWindowEnter:function(){},onWindowExpose:function(){},onWindowFocusIn:function(){},onWindowFocusOut:function(){},onWindowFullscreen:function(){},
onWindowLeave:function(){},onWindowMove:function(a,b){},onWindowMinimize:function(){},onWindowResize:function(a,b){},onWindowRestore:function(){},render:function(a){},update:function(a){},__addWindow:function(a){if(null!=a){this.__windows.push(a);this.__windowByID.h[a.id]=a;var b=f(this,this.__onWindowClose);a.onClose.add(function(){b(a)},!1,-1E4);null==this.__window&&(this.__window=a,a.onActivate.add(f(this,this.onWindowActivate)),a.onRenderContextLost.add(f(this,this.onRenderContextLost)),a.onRenderContextRestored.add(f(this,
this.onRenderContextRestored)),a.onDeactivate.add(f(this,this.onWindowDeactivate)),a.onDropFile.add(f(this,this.onWindowDropFile)),a.onEnter.add(f(this,this.onWindowEnter)),a.onExpose.add(f(this,this.onWindowExpose)),a.onFocusIn.add(f(this,this.onWindowFocusIn)),a.onFocusOut.add(f(this,this.onWindowFocusOut)),a.onFullscreen.add(f(this,this.onWindowFullscreen)),a.onKeyDown.add(f(this,this.onKeyDown)),a.onKeyUp.add(f(this,this.onKeyUp)),a.onLeave.add(f(this,this.onWindowLeave)),a.onMinimize.add(f(this,
this.onWindowMinimize)),a.onMouseDown.add(f(this,this.onMouseDown)),a.onMouseMove.add(f(this,this.onMouseMove)),a.onMouseMoveRelative.add(f(this,this.onMouseMoveRelative)),a.onMouseUp.add(f(this,this.onMouseUp)),a.onMouseWheel.add(f(this,this.onMouseWheel)),a.onMove.add(f(this,this.onWindowMove)),a.onRender.add(f(this,this.render)),a.onResize.add(f(this,this.onWindowResize)),a.onRestore.add(f(this,this.onWindowRestore)),a.onTextEdit.add(f(this,this.onTextEdit)),a.onTextInput.add(f(this,this.onTextInput)),
this.onWindowCreate());this.onCreateWindow.dispatch(a)}},__createWindow:function(a){a=new Vd(this,a);return-1==a.id?null:a},__registerLimeModule:function(a){a.onUpdate.add(f(this,this.update));a.onExit.add(f(this,this.onModuleExit),!1,0);a.onExit.add(f(this,this.__onModuleExit),!1,0);for(a=Ta.devices.iterator();a.hasNext();){var b=a.next();this.__onGamepadConnect(b)}Ta.onConnect.add(f(this,this.__onGamepadConnect));for(a=fb.devices.iterator();a.hasNext();)b=a.next(),this.__onJoystickConnect(b);fb.onConnect.add(f(this,
this.__onJoystickConnect));Bb.onCancel.add(f(this,this.onTouchCancel));Bb.onStart.add(f(this,this.onTouchStart));Bb.onMove.add(f(this,this.onTouchMove));Bb.onEnd.add(f(this,this.onTouchEnd))},__removeWindow:function(a){null!=a&&this.__windowByID.h.hasOwnProperty(a.id)&&(this.__window==a&&(this.__window=null),K.remove(this.__windows,a),this.__windowByID.remove(a.id),a.close(),0==this.__windows.length&&Eb.exit(0))},__onGamepadConnect:function(a){this.onGamepadConnect(a);var b=f(this,this.onGamepadAxisMove),
c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=f(this,this.onGamepadButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);var g=f(this,this.onGamepadButtonUp);c=function(b){g(a,b)};a.onButtonUp.add(c);var l=f(this,this.onGamepadDisconnect);a.onDisconnect.add(function(){l(a)})},__onJoystickConnect:function(a){this.onJoystickConnect(a);var b=f(this,this.onJoystickAxisMove),c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=f(this,this.onJoystickButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);
var g=f(this,this.onJoystickButtonUp);c=function(b){g(a,b)};a.onButtonUp.add(c);var l=f(this,this.onJoystickDisconnect);a.onDisconnect.add(function(){l(a)});var x=f(this,this.onJoystickHatMove);c=function(b,c){x(a,b,c)};a.onHatMove.add(c);var m=f(this,this.onJoystickTrackballMove);c=function(b,c,e){m(a,b,c,e)};a.onTrackballMove.add(c)},__onModuleExit:function(a){this.__backend.exit()},__onWindowClose:function(a){if(this.__window==a)this.onWindowClose();this.__removeWindow(a)},__class__:F});var H=
function(){};d.ApplicationMain=H;H.__name__=!0;H.main=function(){Eb.__registerEntryPoint("shapes",H.create)};H.create=function(a){L.init(a);var b=new ca;b.meta.h.build="1";b.meta.h.company="ob";b.meta.h.file="shapes";b.meta.h.name="tyke";b.meta.h.packageName="tyke";b.meta.h.version="0.0.1";var c={allowHighDPI:!1,alwaysOnTop:!1,borderless:!1,element:null,frameRate:60,height:600,hidden:!1,maximized:!1,minimized:!1,parameters:{},resizable:!0,title:"tyke",width:800,x:null,y:null,context:{antialiasing:0,
background:16777215,colorDepth:32,depth:!0,hardware:!0,stencil:!1,type:null,vsync:!0}};if(null==b.__window&&null!=a)for(var e=0,g=C.fields(a);e<g.length;){var l=g[e];++e;Object.prototype.hasOwnProperty.call(c,l)?c[l]=C.field(a,l):Object.prototype.hasOwnProperty.call(c.context,l)&&(c.context[l]=C.field(a,l))}b.createWindow(c);e=0;for(g=L.preloadLibraries;e<g.length;)a=g[e],++e,b.__preloader.addLibrary(a);e=0;for(g=L.preloadLibraryNames;e<g.length;)a=g[e],++e,b.__preloader.addLibraryName(a);b.__preloader.load();
H.start(b)};H.start=function(a){a.exec()};var Z=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};d.EReg=Z;Z.__name__=!0;Z.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw z.thrown("EReg::matched");},matchedRight:function(){if(null==this.r.m)throw z.thrown("No string matched");var a=this.r.m.index+this.r.m[0].length;return K.substr(this.r.s,
a,this.r.s.length-a)},matchedPos:function(){if(null==this.r.m)throw z.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(a,b,c){null==c&&(c=-1);if(this.r.global){if(this.r.lastIndex=b,this.r.m=this.r.exec(0>c?a:K.substr(a,0,b+c)),c=null!=this.r.m)this.r.s=a}else if(c=this.match(0>c?K.substr(a,b,null):K.substr(a,b,c)))this.r.s=a,this.r.m.index+=b;return c},map:function(a,b){for(var c=0,e="";!(c>=a.length);){if(!this.matchSub(a,c)){e+=p.string(K.substr(a,
c,null));break}var g=this.matchedPos();e+=p.string(K.substr(a,c,g.pos-c));e+=p.string(b(this));0==g.len?(e+=p.string(K.substr(a,g.pos,1)),c=g.pos+1):c=g.pos+g.len;if(!this.r.global)break}!this.r.global&&0<c&&c<a.length&&(e+=p.string(K.substr(a,c,null)));return e},__class__:Z};var K=function(){};d.HxOverrides=K;K.__name__=!0;K.strDate=function(a){switch(a.length){case 8:a=a.split(":");var b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:return a=
a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);case 19:return a=a.split(" "),b=a[0].split("-"),a=a[1].split(":"),new Date(b[0],b[1]-1,b[2],a[0],a[1],a[2]);default:throw z.thrown("Invalid date format : "+a);}};K.cca=function(a,b){a=a.charCodeAt(b);if(a==a)return a};K.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};K.remove=function(a,b){b=a.indexOf(b);if(-1==b)return!1;a.splice(b,1);return!0};K.now=function(){return Date.now()};var E=
function(a,b,c){this.errors=a;this.putils=b;this.errorType=c};d["json2object.reader.BaseParser"]=E;E.__name__=!0;E.prototype={fromJson:function(a,b){null==b&&(b="");this.putils=new Wd(a);this.errors=[];try{var c=(new Xd(a,b)).doParse();this.loadJson(c)}catch(e){if(ja.lastError=e,a=z.caught(e).unwrap(),a instanceof Wb)this.errors.push(Aa.ParserError(a.message,this.putils.convertPosition(a.pos)));else throw e;}return this.value},loadJson:function(a,b){null==b&&(b="");var c=this.putils.convertPosition(a.pos);
a=a.value;switch(a._hx_index){case 0:this.loadJsonString(a.s,c,b);break;case 1:this.loadJsonNumber(a.s,c,b);break;case 2:this.loadJsonObject(a.fields,c,b);break;case 3:this.loadJsonArray(a.values,c,b);break;case 4:this.loadJsonBool(a.b,c,b);break;case 5:this.loadJsonNull(c,b)}return this.value},loadJsonNull:function(a,b){this.onIncorrectType(a,b)},loadJsonString:function(a,b,c){this.onIncorrectType(b,c)},loadJsonNumber:function(a,b,c){this.onIncorrectType(b,c)},loadJsonUInt:function(a,b,c,e){var g=
0;a=q.trim(a);"-"==a.charAt(0)&&(a=K.substr(a,1,null));var l=q.startsWith(a,"0x");l&&(a=K.substr(a,2,null));for(var x=l?16:10,m=1,ia=a.length-1;0<=ia;){var f=l?p.parseInt("0x"+a.charAt(ia)):p.parseInt(a.charAt(ia));if(null==f)return this.onIncorrectType(b,c),e;g+=m*f;m*=x;--ia}return g},loadJsonInt:function(a,b,c,e){if(null!=p.parseInt(a)&&p.parseInt(a)==parseFloat(a))return p.parseInt(a);this.onIncorrectType(b,c);return e},loadJsonFloat:function(a,b,c,e){if(null!=p.parseInt(a))return parseFloat(a);
this.onIncorrectType(b,c);return e},loadJsonBool:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArray:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArrayValue:function(a,b,c){for(var e=[],g=0;g<a.length;){var l=a[g];++g;try{var x=b(l,c)}catch(m){if(ja.lastError=m,l=z.caught(m).unwrap(),ua.__instanceof(l,Hb)){if(l!=Hb.ParsingThrow)throw z.thrown(l);continue}else throw m;}e.push(x)}return e},loadJsonObject:function(a,b,c){this.onIncorrectType(b,c)},loadObjectField:function(a,b,c,e,g,l){try{var x=
a(b.value,b.name);this.mapSet(e,c,!0);return x}catch(m){if(ja.lastError=m,a=z.caught(m).unwrap(),ua.__instanceof(a,Hb)){if(a!=Hb.ParsingThrow)throw z.thrown(a);}else this.errors.push(Aa.CustomFunctionException(a,l))}return g},objectSetupAssign:function(a,b,c){for(var e=0,g=b.length;e<g;){var l=e++;this.mapSet(a,b[l],c[l])}},objectErrors:function(a,b){b=this.putils.convertPosition(new aa(b.file,b.max-1,b.max-1));for(var c=Object.keys(a.h),e=c.length,g=0;g<e;){var l=c[g++];a.h[l]||this.errors.push(Aa.UninitializedVariable(l,
b))}},onIncorrectType:function(a,b){this.parsingThrow()},parsingThrow:function(){if(0!=this.errorType)throw z.thrown(Hb.ParsingThrow);},mapSet:function(a,b,c){a.h[b]=c},__class__:E};var Da=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_0=Da;Da.__name__=!0;Da.__super__=E;Da.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"peote.text.FontConfig",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,
b,c){c=new T;this.objectSetupAssign(c,"packed distancefield kerning width height color bgColor line tiles rangeSplitSize ranges".split(" "),[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "bgColor":this.value.bgColor=this.loadObjectField((h=new w(this.errors,this.putils,1),f(h,h.loadJson)),g,"bgColor",c,this.value.bgColor,b);break;case "color":this.value.color=this.loadObjectField((h=new w(this.errors,this.putils,1),f(h,h.loadJson)),
g,"color",c,this.value.color,b);break;case "distancefield":this.value.distancefield=this.loadObjectField((h=new Ia(this.errors,this.putils,1),f(h,h.loadJson)),g,"distancefield",c,this.value.distancefield,b);break;case "height":this.value.height=this.loadObjectField((h=new xa(this.errors,this.putils,1),f(h,h.loadJson)),g,"height",c,this.value.height,b);break;case "kerning":this.value.kerning=this.loadObjectField((h=new Ba(this.errors,this.putils,1),f(h,h.loadJson)),g,"kerning",c,this.value.kerning,
b);break;case "line":this.value.line=this.loadObjectField((h=new na(this.errors,this.putils,1),f(h,h.loadJson)),g,"line",c,this.value.line,b);break;case "packed":this.value.packed=this.loadObjectField((h=new Ia(this.errors,this.putils,1),f(h,h.loadJson)),g,"packed",c,this.value.packed,b);break;case "rangeSplitSize":this.value.rangeSplitSize=this.loadObjectField((h=new P(this.errors,this.putils,1),f(h,h.loadJson)),g,"rangeSplitSize",c,this.value.rangeSplitSize,b);break;case "ranges":this.value.ranges=
this.loadObjectField((h=new N(this.errors,this.putils,1),f(h,h.loadJson)),g,"ranges",c,this.value.ranges,b);break;case "tiles":this.value.tiles=this.loadObjectField((h=new Ra(this.errors,this.putils,1),f(h,h.loadJson)),g,"tiles",c,this.value.tiles,b);break;case "width":this.value.width=this.loadObjectField((h=new xa(this.errors,this.putils,1),f(h,h.loadJson)),g,"width",c,this.value.width,b);break;default:this.errors.push(Aa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,
b)},getAuto:function(){var a=Object.create(Yd.prototype);a.packed=!1;a.distancefield=!1;a.kerning=null;a.width=16;a.height=16;a.color=-1;a.bgColor=0;a.line=null;a.tiles=null;a.rangeSplitSize=4096;a.ranges=(new N([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1)));return a},__class__:Da});var N=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_1=N;N.__name__=!0;N.__super__=E;N.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"Array<{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }>",
a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonArray:function(a,b,c){this.value=this.loadJsonArrayValue(a,(h=new S(this.errors,this.putils,2),f(h,h.loadJson)),c)},__class__:N});var qa=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c);this.value=0};d.JsonParser_10=qa;qa.__name__=!0;qa.__super__=E;qa.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"UInt",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,
b,c){this.value=this.loadJsonUInt(a,b,c,this.value)},__class__:qa});var S=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_11=S;S.__name__=!0;S.__super__=E;S.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }",a));E.prototype.onIncorrectType.call(this,a,b)},
loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new T;this.objectSetupAssign(c,"data image line range slot tiles".split(" "),[!0,!1,!0,!1,!1,!0]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "data":this.value.data=this.loadObjectField((h=new Q(this.errors,this.putils,1),f(h,h.loadJson)),g,"data",c,this.value.data,b);break;case "image":this.value.image=this.loadObjectField((h=new da(this.errors,this.putils,1),f(h,h.loadJson)),g,
"image",c,this.value.image,b);break;case "line":this.value.line=this.loadObjectField((h=new Ja(this.errors,this.putils,1),f(h,h.loadJson)),g,"line",c,this.value.line,b);break;case "range":this.value.range=this.loadObjectField((h=new Na(this.errors,this.putils,1),f(h,h.loadJson)),g,"range",c,this.value.range,b);break;case "slot":this.value.slot=this.loadObjectField((h=new Ua(this.errors,this.putils,1),f(h,h.loadJson)),g,"slot",c,this.value.slot,b);break;case "tiles":this.value.tiles=this.loadObjectField((h=
new Xa(this.errors,this.putils,1),f(h,h.loadJson)),g,"tiles",c,this.value.tiles,b);break;default:this.errors.push(Aa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{data:(new Q([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1))),image:(new da([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1))),line:(new Ja([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1))),range:(new Na([],this.putils,0)).loadJson(new wa(ya.JNull,
new aa("",0,1))),slot:(new Ua([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1))),tiles:(new Xa([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1)))}},__class__:S});var Q=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_13=Q;Q.__name__=!0;Q.__super__=E;Q.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"String",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,
b,c){this.value=a},__class__:Q});var da=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_14=da;da.__name__=!0;da.__super__=E;da.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"String",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,b,c){this.value=a},__class__:da});var Ja=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_16=Ja;Ja.__name__=!0;Ja.__super__=E;
Ja.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"{ height : Float, base : Float }",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new T;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "base":this.value.base=this.loadObjectField((h=new xa(this.errors,this.putils,1),f(h,h.loadJson)),g,"base",
c,this.value.base,b);break;case "height":this.value.height=this.loadObjectField((h=new xa(this.errors,this.putils,1),f(h,h.loadJson)),g,"height",c,this.value.height,b);break;default:this.errors.push(Aa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new xa([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1))),height:(new xa([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1)))}},__class__:Ja});var Na=function(a,
b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_17=Na;Na.__name__=!0;Na.__super__=E;Na.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"peote.text.Range",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new T;this.objectSetupAssign(c,["min","max"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "max":this.value.max=this.loadObjectField((h=
new P(this.errors,this.putils,1),f(h,h.loadJson)),g,"max",c,this.value.max,b);break;case "min":this.value.min=this.loadObjectField((h=new P(this.errors,this.putils,1),f(h,h.loadJson)),g,"min",c,this.value.min,b);break;default:this.errors.push(Aa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(Zd.prototype);a.min=(new P([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1)));a.max=(new P([],this.putils,0)).loadJson(new wa(ya.JNull,
new aa("",0,1)));return a},__class__:Na});var Ua=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_18=Ua;Ua.__name__=!0;Ua.__super__=E;Ua.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"{ width : Int, height : Int }",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new T;this.objectSetupAssign(c,["height","width"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=
a[e];++e;switch(g.name){case "height":this.value.height=this.loadObjectField((h=new P(this.errors,this.putils,1),f(h,h.loadJson)),g,"height",c,this.value.height,b);break;case "width":this.value.width=this.loadObjectField((h=new P(this.errors,this.putils,1),f(h,h.loadJson)),g,"width",c,this.value.width,b);break;default:this.errors.push(Aa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{height:(new P([],this.putils,0)).loadJson(new wa(ya.JNull,
new aa("",0,1))),width:(new P([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1)))}},__class__:Ua});var Ia=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c);this.value=!1};d.JsonParser_2=Ia;Ia.__name__=!0;Ia.__super__=E;Ia.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"Bool",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonBool:function(a,b,c){this.value=a},__class__:Ia});var Xa=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_20=
Xa;Xa.__name__=!0;Xa.__super__=E;Xa.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"{ y : Int, x : Int }",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new T;this.objectSetupAssign(c,["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "x":this.value.x=this.loadObjectField((h=new P(this.errors,this.putils,1),f(h,h.loadJson)),
g,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((h=new P(this.errors,this.putils,1),f(h,h.loadJson)),g,"y",c,this.value.y,b);break;default:this.errors.push(Aa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new P([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1))),y:(new P([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1)))}},__class__:Xa});var Ba=function(a,b,c){null==c&&(c=0);E.call(this,
a,b,c)};d.JsonParser_4=Ba;Ba.__name__=!0;Ba.__super__=E;Ba.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"Bool",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonBool:function(a,b,c){this.value=a},__class__:Ba});var xa=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c);this.value=0};d.JsonParser_5=xa;xa.__name__=!0;xa.__super__=E;xa.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,
"Float",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonFloat(a,b,c,this.value)},__class__:xa});var w=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_6=w;w.__name__=!0;w.__super__=E;w.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"peote.view.Color",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=(new qa(this.errors,this.putils,0)).loadJson(new wa(ya.JNumber(a),
new aa(b.file,b.min-1,b.max-1)),c)},__class__:w});var na=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_7=na;na.__name__=!0;na.__super__=E;na.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"{ height : Float, base : Float }",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new T;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=
0;e<a.length;){var g=a[e];++e;switch(g.name){case "base":this.value.base=this.loadObjectField((h=new xa(this.errors,this.putils,1),f(h,h.loadJson)),g,"base",c,this.value.base,b);break;case "height":this.value.height=this.loadObjectField((h=new xa(this.errors,this.putils,1),f(h,h.loadJson)),g,"height",c,this.value.height,b);break;default:this.errors.push(Aa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new xa([],this.putils,
0)).loadJson(new wa(ya.JNull,new aa("",0,1))),height:(new xa([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1)))}},__class__:na});var Ra=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c)};d.JsonParser_8=Ra;Ra.__name__=!0;Ra.__super__=E;Ra.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"{ y : Int, x : Int }",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new T;this.objectSetupAssign(c,
["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "x":this.value.x=this.loadObjectField((h=new P(this.errors,this.putils,1),f(h,h.loadJson)),g,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((h=new P(this.errors,this.putils,1),f(h,h.loadJson)),g,"y",c,this.value.y,b);break;default:this.errors.push(Aa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new P([],
this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1))),y:(new P([],this.putils,0)).loadJson(new wa(ya.JNull,new aa("",0,1)))}},__class__:Ra});var P=function(a,b,c){null==c&&(c=0);E.call(this,a,b,c);this.value=0};d.JsonParser_9=P;P.__name__=!0;P.__super__=E;P.prototype=B(E.prototype,{onIncorrectType:function(a,b){this.errors.push(Aa.IncorrectType(b,"Int",a));E.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonInt(a,b,c,this.value)},__class__:P});var V=
function(){this.isReadyForUpdate=!1;F.call(this)};d["ob.gum.backends.App"]=V;V.__name__=!0;V.__super__=F;V.prototype=B(F.prototype,{init:function(a,b){this.gum=new $d(a,b);this.isReadyForUpdate=!0},onWindowCreate:function(){la.trace("App onWindowCreate",{fileName:"ob/gum/backends/Lime.hx",lineNumber:22,className:"ob.gum.backends.App",methodName:"onWindowCreate"});switch(this.__window.context.type){case "opengl":case "opengles":case "webgl":try{this.init(this.__window)}catch(b){var a=z.caught(b);la.trace(xc.toString(xc.exceptionStack()),
{fileName:"ob/gum/backends/Lime.hx",lineNumber:28,className:"ob.gum.backends.App",methodName:"onWindowCreate",customParams:[a]})}break;default:throw z.thrown("Sorry, only works with OpenGL.");}},update:function(a){if(this.isReadyForUpdate)this.gum.onUpdate(a)},onKeyDown:function(a,b){this.gum.onKeyDown(a,b)},onKeyUp:function(a,b){this.gum.onKeyUp(a,b)},onMouseMove:function(a,b){this.gum.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.gum.onMouseDown(a,b,c)},onMouseUp:function(a,b,c){this.gum.onMouseUp(a,
b,c)},onMouseWheel:function(a,b,c){this.gum.onMouseScroll(a,b,c)},onWindowResize:function(a,b){F.prototype.onWindowResize.call(this,a,b);this.gum.onWindowResize(a,b)},__class__:V});var ca=function(){V.call(this)};d.Main=ca;ca.__name__=!0;ca.__super__=V;ca.prototype=B(V.prototype,{init:function(a,b){V.prototype.init.call(this,a,{framesPerSecond:30,drawOnlyWhenRequested:!0,displayWidth:800,displayHeight:600,displayIsScaled:!0});a=new ae({fonts:[],images:[]});this.gum.changeLoop(new za(a))},__class__:ca});
var L=function(){};d.ManifestResources=L;L.__name__=!0;L.init=function(a){L.preloadLibraries=[];L.preloadLibraryNames=[];L.rootPath=null;null!=a&&Object.prototype.hasOwnProperty.call(a,"rootPath")&&(L.rootPath=C.field(a,"rootPath"));null==L.rootPath&&(L.rootPath="./");a=rb.parse('{"name":null,"assets":"ah","rootPath":null,"version":2,"libraryArgs":[],"libraryType":null}',L.rootPath);a=$b.fromManifest(a);ba.registerLibrary("default",a);a=ba.getLibrary("default");null!=a?L.preloadLibraries.push(a):
L.preloadLibraryNames.push("default")};Math.__name__=!0;var C=function(){};d.Reflect=C;C.__name__=!0;C.field=function(a,b){try{return a[b]}catch(c){return ja.lastError=c,null}};C.getProperty=function(a,b){var c;if(null==a)return null;var e=a.__properties__?c=a.__properties__["get_"+b]:!1;return e?a[c]():a[b]};C.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,e;for(e in a)"__id__"!=e&&"hx__closures__"!=e&&c.call(a,e)&&b.push(e)}return b};C.isFunction=function(a){return"function"==
typeof a?!(a.__name__||a.__ename__):!1};C.compareMethods=function(a,b){return a==b?!0:C.isFunction(a)&&C.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};C.copy=function(a){if(null==a)return null;for(var b={},c=0,e=C.fields(a);c<e.length;){var g=e[c];++c;b[g]=C.field(a,g)}return b};var D=function(){};d["ob.gum.ILoop"]=D;D.__name__=!0;D.__isInterface__=!0;D.prototype={__class__:D};var $a=function(){};d["ob.gum.backends.PeoteViewLoop"]=$a;$a.__name__=!0;$a.__interfaces__=[D];
$a.prototype={onInit:function(a){this.gum=a;this.peoteView=new be(a.window);this.w=null==a.config.displayWidth?a.window.__width:a.config.displayWidth;this.h=null==a.config.displayHeight?a.window.__height:a.config.displayHeight;this.ratio=this.w/this.h;this.display=new Wc(0,0,a.window.__width,a.window.__height,255);this.peoteView.addDisplay(this.display);this.peoteView.start();this.setZoom()},setZoom:function(){var a=this.display,b=this.gum.window.__width/this.w|0;a.xz=a.zoom*b;if(W.isUBO){var c=a.uniformBuffer,
e=a.gl;c.uniformBytes.b_UFloat32[2]=a.xz;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,8,c.xZoomBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null);c=a.uniformBufferFB;e=a.gl;c.uniformBytes.b_UFloat32[2]=a.xz;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,8,c.xZoomBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}a.xZoom=b;a=this.display;b=this.gum.window.__height/this.h|0;a.yz=a.zoom*b;W.isUBO&&(c=a.uniformBuffer,e=a.gl,c.uniformBytes.b_UFloat32[3]=
a.yz,e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer),e.bufferSubData(e.UNIFORM_BUFFER,12,c.yZoomBufferPointer),e.bindBuffer(e.UNIFORM_BUFFER,null),c=a.uniformBufferFB,e=a.gl,c.uniformBytes.b_UFloat32[3]=a.yz,e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer),e.bufferSubData(e.UNIFORM_BUFFER,12,c.yZoomBufferPointer),e.bindBuffer(e.UNIFORM_BUFFER,null));a.yZoom=b;this.display.width=this.gum.window.__width;this.display.height=this.gum.window.__height},onUpdate:function(a){},onTick:function(a){return!1},onDraw:function(a){},
onKeyDown:function(a,b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){this.peoteView.resize(a,b);this.setZoom()},getFrameBufferDisplay:function(a,b,c,e,g){a=new Wc(a,b,c,e);this.peoteView.addDisplay(a);this.peoteView.renderToTexture(a,0);this.peoteView.addFramebufferDisplay(a);c=new Xc(c,e);c.clearOnRenderInto=!g;a.setFramebuffer(c);this.peoteView.removeDisplay(a);return new ce(c,
a)},__class__:$a};var ka=function(a){this.alwaysDraw=!1;this.onInitComplete=function(){throw z.thrown("You must set onInitComplete function!");};this.assets=a;this.keyboard=new de([])};d["tyke.PhysicalStageLoop"]=ka;ka.__name__=!0;ka.__super__=$a;ka.prototype=B($a.prototype,{onInit:function(a){var b=this;$a.prototype.onInit.call(this,a);this.assets.Preload(function(){b.initWorldAndStage();b.onInitComplete()})},initWorldAndStage:function(){this.stage=new ee(this.display,this);this.world=Y.start({width:this.display.width,
height:this.display.height,gravity_y:100,iterations:2})},onTick:function(a){return this.alwaysDraw?!0:!1},onUpdate:function(a){Y.step(this.world,a/1E3)},onDraw:function(a){this.stage.updateGraphicsBuffers()},onKeyDown:function(a,b){this.keyboard.handle(a,this)},__class__:ka});var za=function(a){var b=this;ka.call(this,a);this.onInitComplete=function(){b.initWorldAndStage();b.begin()}};d.Shapes=za;za.__name__=!0;za.__super__=ka;za.prototype=B(ka.prototype,{begin:function(){this.shapes=new pa(this.world,
this.stage);this.debug=new Dc(this.stage.createRectangleRenderLayer("rectangles"));Y.listen(this.world);this.alwaysDraw=!0;this.gum.toggleUpdate(!0)},onTick:function(a){this.shapes.onTick(a);return ka.prototype.onTick.call(this,a)},onDraw:function(a){ka.prototype.onDraw.call(this,a);this.debug.draw(this.world)},onMouseMove:function(a,b){ka.prototype.onMouseMove.call(this,a,b);if(null!=this.shapes)this.shapes.onMouseMove(a,b)},__class__:za});var pa=function(a,b){this.polygonSides=[3,3,3,3,5,7,11];
this.timer=0;this.body_count=16;this.elapsedTicks=0;this.world=a;this.stage=b;this.shapesLayer=this.stage.createShapeRenderLayer("shapes");this.mouseBody=new mc(null,{x:.5*b.get_width(),y:.5*b.get_height(),kinematic:!0,rotational_velocity:10,shape:{type:2,sides:3,radius:100,width:200,height:200,solid:!0}},this.world,this.shapesLayer,1157579946);new mc(null,{mass:0,elasticity:.3,x:.5*b.get_width(),y:.5*b.get_height(),shape:{type:0,width:.3*b.get_width(),height:.03*b.get_height()}},this.world,this.shapesLayer,
-48043);Y.listen(a,null,null,{enter:function(a,b,g){}})};d.ShapeShaker=pa;pa.__name__=!0;pa.prototype={onTick:function(a){this.elapsedTicks++;this.timer+=a;if(360<this.timer){a=u(68,102);var b=t();if(this.world.members.length<this.body_count){var c=t()?0:t()?2:1,e=b?-103:1145372569;2!=c||b||(e=-13369447);var g=1;1!=c&&(g=2==c?this.polygonSides[Math.ceil((this.polygonSides.length-1)*Math.random())]:4);new mc(null,{x:u(0,this.world.width),y:100,velocity_y:20,mass:4,elasticity:.3,rotational_velocity:u(-30,
30),shape:{type:c,radius:.5*a,width:a,height:a,solid:b,sides:g}},this.world,this.shapesLayer,e)}this.timer=0}a=0;for(b=this.world.members;a<b.length;)c=b[a],++a,this.isOutOfBounds(c)&&(e=c.velocity,e.x=0,e.y=0,c.set_position(u(0,this.world.width),0))},onMouseMove:function(a,b){this.mouseBody.body.set_position(a,b)},isOutOfBounds:function(a){a=a.bounds();var b=a.min_y>this.world.height||0>a.max_x||a.min_x>this.world.width;a.put();return b},__class__:pa};var p=function(){};d.Std=p;p.__name__=!0;p.string=
function(a){return ua.__string_rec(a,"")};p.parseInt=function(a){if(null!=a)for(var b=0,c=a.length;b<c;){var e=b++,g=a.charCodeAt(e);if(8>=g||14<=g&&32!=g&&45!=g)if(b=a.charCodeAt(e+1),a=parseInt(a,120==b||88==b?16:10),isNaN(a))break;else return a}return null};var hb=function(){};d["_String.String_Impl_"]=hb;hb.__name__=!0;hb.fromCharCode=function(a){return String.fromCodePoint(a)};var A=function(){this.b=""};d.StringBuf=A;A.__name__=!0;A.prototype={__class__:A};var q=function(){};d.StringTools=q;
q.__name__=!0;q.startsWith=function(a,b){return a.length>=b.length?0==a.lastIndexOf(b,0):!1};q.endsWith=function(a,b){var c=b.length,e=a.length;return e>=c?a.indexOf(b,e-c)==e-c:!1};q.isSpace=function(a,b){a=K.cca(a,b);return 8<a&&14>a?!0:32==a};q.ltrim=function(a){for(var b=a.length,c=0;c<b&&q.isSpace(a,c);)++c;return 0<c?K.substr(a,c,b-c):a};q.rtrim=function(a){for(var b=a.length,c=0;c<b&&q.isSpace(a,b-c-1);)++c;return 0<c?K.substr(a,0,b-c):a};q.trim=function(a){return q.ltrim(q.rtrim(a))};q.replace=
function(a,b,c){return a.split(b).join(c)};var ea=function(){};d.Type=ea;ea.__name__=!0;ea.createInstance=function(a,b){return new (Function.prototype.bind.apply(a,[null].concat(b)))};ea.createEnum=function(a,b,c){var e=C.field(a,b);if(null==e)throw z.thrown("No such constructor "+b);if(C.isFunction(e)){if(null==c)throw z.thrown("Constructor "+b+" need parameters");return e.apply(a,c)}if(null!=c&&0!=c.length)throw z.thrown("Constructor "+b+" does not need parameters");return e};var Va={toFloat:function(a){return 0>
a?4294967296+a:a+0}},sb=function(){};d["echo.util.Disposable"]=sb;sb.__name__=!0;sb.__isInterface__=!0;var U=function(a){this.transform=new rc;this.layer_mask=Ue._new();this.layers=Ue._new();var b=new O(0,0);this.drag=b;this.max_velocity=b=new O(0,0);this.torque=0;this.acceleration=b=new O(0,0);this.velocity=b=new O(0,0);this.material=ac.global;this.id=++U.ids;this.active=!0;this.shapes=[];this.data={};this.disposed=!1;this.transform.on_dirty=f(this,this.on_dirty);this.load_options(a)};d["echo.Body"]=
U;U.__name__=!0;U.__interfaces__=[sb];U.__properties__={get_defaults:"get_defaults"};U.get_defaults=function(){return{kinematic:!1,mass:U.default_mass,x:0,y:0,rotation:0,scale_x:1,scale_y:1,velocity_x:0,velocity_y:0,rotational_velocity:0,max_velocity_x:0,max_velocity_y:0,max_velocity_length:0,max_rotational_velocity:1E4,drag_x:0,drag_y:0,drag_length:0,rotational_drag:0}};U.prototype={load_options:function(a){a=cd.copy_fields(a,U.get_defaults());for(var b=0,c=this.shapes;b<c.length;){var e=c[b];++b;
e.put()}this.shapes.length=0;c=a.x;b=this.transform;b.dirty||b.set_dirty();b.local_x=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);c=a.y;b=this.transform;b.dirty||b.set_dirty();b.local_y=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);b=this.transform;c=Math.PI/180*a.rotation;b.dirty||b.set_dirty();b.local_radians=c;if(null!=this.on_rotate)this.on_rotate(180/Math.PI*this.transform.local_radians);c=a.scale_x;b=this.transform;
b.dirty||b.set_dirty();b.local_scale_x=c;c=a.scale_y;b=this.transform;b.dirty||b.set_dirty();b.local_scale_y=c;this.kinematic=a.kinematic;this.material=null!=a.material?a.material:null!=a.gravity_scale||null!=a.elasticity?new ac(a.elasticity,null,null,null,a.gravity_scale):ac.global;c=this.velocity;c.x=a.velocity_x;c.y=a.velocity_y;this.rotational_velocity=a.rotational_velocity;c=this.max_velocity;c.x=a.max_velocity_x;c.y=a.max_velocity_y;this.max_velocity_length=a.max_velocity_length;this.max_rotational_velocity=
a.max_rotational_velocity;c=this.drag;c.x=a.drag_x;c.y=a.drag_y;this.drag_length=a.drag_length;this.rotational_drag=a.rotational_drag;this.last_rotation=this.last_y=this.last_x=NaN;this.dirty=!0;if(null!=a.shape){e=Sa.get(a.shape);var g=-1;null==g&&(g=-1);-1==this.shapes.indexOf(e)&&(-1<g?this.shapes[g]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)))}if(null!=a.shapes)for(b=
0,c=a.shapes;b<c.length;)e=c[b],++b,e=Sa.get(e),g=-1,null==g&&(g=-1),-1==this.shapes.indexOf(e)&&(-1<g?this.shapes[g]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));null!=a.shape_instance&&(e=a.shape_instance,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))));
if(null!=a.shape_instances)for(b=0,c=a.shape_instances;b<c.length;)e=c[b],++b,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));b=a.mass;if(null==b)c=a.mass,c<U.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&
null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);else switch(b){case -1:b=a=0;for(c=this.shapes;b<c.length;)e=c[b],++b,a+=e.volume()*this.material.density;a<U.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=a,this.inverse_mass=
1/this.mass);break;case 0:c=0;c<U.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);break;default:c=a.mass,c<U.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):
(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass)}},set_position:function(a,b){null==b&&(b=0);null==a&&(a=0);var c=this.transform;null==b&&(b=0);null==a&&(a=0);c.dirty||c.set_dirty();c.local_x=a;c.dirty||c.set_dirty();c.local_y=b},bounds:function(a){if(0==this.shapes.length){var b=this.transform.local_x,c=this.transform.local_y,e=1,g=1;null==g&&(g=1);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);a=eb.pool.get();var l=b;
null==g&&(g=1);null==e&&(e=1);null==c&&(c=0);null==l&&(l=0);e*=.5;g*=.5;a.min_x=l-e;a.min_y=c-g;a.max_x=l+e;a.max_y=c+g;a.pooled=!1;return a}l=this.shapes[0].bounds();if(1<this.shapes.length)for(g=1,e=this.shapes.length;g<e;)c=g++,c=this.shapes[c].bounds(),l.min_x>c.min_x&&(l.min_x=c.min_x),l.min_y>c.min_y&&(l.min_y=c.min_y),l.max_x<c.max_x&&(l.max_x=c.max_x),l.max_y<c.max_y&&(l.max_y=c.max_y),c.put();null==a&&(a=eb.pool.get(),c=b=0,g=e=1,null==g&&(g=1),null==e&&(e=1),null==c&&(c=0),null==b&&(b=0),
e*=.5,g*=.5,a.min_x=b-e,a.min_y=c-g,a.max_x=b+e,a.max_y=c+g,a.pooled=!1);a.min_x=l.min_x;a.max_x=l.max_x;a.min_y=l.min_y;a.max_y=l.max_y;l.put();return a},on_dirty:function(a){this.dirty=!0;0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))},__class__:U};var fa=function(){};d["echo.Collisions"]=fa;fa.__name__=!0;fa.update_quadtree=function(a){for(var b=0,c=a.members;b<c.length;){var e=c[b];++b;if(!e.disposed){e.collided=!1;
for(var g=0,l=e.shapes;g<l.length;){var x=l[g];++g;x.collided=!1}e.active&&0<e.mass&&e.dirty&&0<e.shapes.length&&(null==e.quadtree_data.bounds?e.quadtree_data.bounds=e.bounds():e.bounds(e.quadtree_data.bounds),a.quadtree.update(e.quadtree_data,!1),e.dirty=!1)}}a.quadtree.shake()};fa.query=function(a,b){fa.update_quadtree(a);b=null==b?a.listeners.members:b.members;for(var c=0;c<b.length;){var e=b[c];++c;e.quadtree_results.length=0;var g=e.a;switch(g._hx_index){case 0:g=g.v;var l=e.b;switch(l._hx_index){case 0:g=
fa.overlap_body_and_body_bounds(g,l.v);null!=g&&e.quadtree_results.push(g);break;case 1:fa.overlap_body_and_bodies_bounds(g,l.v,a,e.quadtree_results)}break;case 1:switch(g=g.v,l=e.b,l._hx_index){case 0:fa.overlap_body_and_bodies_bounds(l.v,g,a,e.quadtree_results);break;case 1:l=l.v,fa.overlap_bodies_and_bodies_bounds(g,l,a,e.quadtree_results),g!=l&&fa.overlap_bodies_and_bodies_bounds(l,g,a,e.quadtree_results)}}g=0;for(l=e.last_collisions;g<l.length;){var x=l[g];++g;x.put()}e.last_collisions.length=
e.collisions.length;g=0;for(l=e.collisions.length;g<l;)x=g++,e.last_collisions[x]=e.collisions[x];g=e.collisions.length=0;for(l=e.quadtree_results;g<l.length;)if(x=l[g],++g,x.a.disposed||x.b.disposed)x.put();else if(x.a.id==x.b.id)x.put();else{for(var m=!1,ia=0,f=e.collisions;ia<f.length;){var d=f[ia];++ia;if(d.a.id==x.a.id&&d.b.id==x.b.id||d.b.id==x.a.id&&d.a.id==x.b.id){m=!0;break}}if(m)x.put();else{if(1==x.a.shapes.length&&1==x.b.shapes.length)m=x.a.shapes[0].collides(x.b.shapes[0]),null!=m&&x.data.push(m);
else for(m=x.a.shapes,ia=0,f=m.length;ia<f;){d=ia++;for(var r=x.b.shapes,p=m[d].bounds(),h=0,q=r.length;h<q;){var n=h++,A=r[n].bounds();p.min_x<A.max_x&&p.max_x>=A.min_x&&p.min_y<A.max_y&&p.max_y>=A.min_y&&(n=m[d].collides(r[n]),null!=n&&x.data.push(n));A.put()}p.put()}if(0==x.data.length)x.put();else if(null==e.condition||e.condition(x.a,x.b,x.data)&&!x.a.disposed&&!x.b.disposed){m=0;for(ia=x.data;m<ia.length;)f=ia[m],++m,f.sa.collided=f.sb.collided=!0;x.a.collided=x.b.collided=!0;e.collisions.push(x)}else x.put()}}}};
fa.notify=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(null!=c.enter||null!=c.stay)for(var e=0,g=c.collisions;e<g.length;){var l=g[e];++e;if(!l.a.disposed&&!l.b.disposed){if(null!=c.enter){var x=!1;for(var m=0,ia=c.last_collisions;m<ia.length;){var f=ia[m];++m;if(f.a==l.a&&f.b==l.b||f.a==l.b&&f.b==l.a){x=!0;break}}x=!x}else x=!1;x?c.enter(l.a,l.b,l.data):null!=c.stay&&c.stay(l.a,l.b,l.data)}}if(null!=c.exit)for(e=0,g=c.last_collisions;e<g.length;){l=
g[e];++e;if(l.a.disposed||l.b.disposed)x=!1;else{x=!1;m=0;for(ia=c.collisions;m<ia.length;)if(f=ia[m],++m,f.a==l.a&&f.b==l.b||f.a==l.b&&f.b==l.a){x=!0;break}x=!x}x&&c.exit(l.a,l.b)}}};fa.overlap_bodies_and_bodies_bounds=function(a,b,c,e){if(0!=a.length&&0!=b.length)for(var g=0;g<a.length;){var l=a[g];++g;fa.overlap_body_and_bodies_bounds(l,b,c,e)}};fa.overlap_body_and_bodies_bounds=function(a,b,c,e){if(!(a.disposed||0==a.shapes.length||!a.active||0>=a.mass)){var g=a.bounds();fa.qr.length=0;fa.sqr.length=
0;c.quadtree.query(g,fa.qr);c.static_quadtree.query(g,fa.sqr);for(c=0;c<b.length;){var l=b[c];++c;if(!l.disposed&&0!=l.shapes.length&&l.active&&(0==a.layer_mask||0==l.layer_mask||0!=(a.layer_mask&l.layers)&&0!=(l.layer_mask&a.layers)))for(var x=0,m=0<l.mass?fa.qr:fa.sqr;x<m.length;){var ia=m[x];++x;ia.id==l.id&&(ia=yc.pool.get(),ia.a=a,ia.b=l,ia.data.length=0,ia.pooled=!1,e.push(ia))}}g.put()}};fa.overlap_body_and_body_bounds=function(a,b){if(a.disposed||b.disposed||0==a.shapes.length||0==b.shapes.length||
!a.active||!b.active||a==b||0!=a.layer_mask&&0!=b.layer_mask&&(0==(a.layer_mask&b.layers)||0==(b.layer_mask&a.layers))||0>=a.mass&&0>=b.mass)return null;var c=a.bounds(),e=b.bounds(),g=c.min_x<e.max_x&&c.max_x>=e.min_x&&c.min_y<e.max_y&&c.max_y>=e.min_y;c.put();e.put();return g?(c=yc.pool.get(),c.a=a,c.b=b,c.data.length=0,c.pooled=!1,c):null};var Fb=function(a){this.members=null==a?[]:a};d["echo.Listeners"]=Fb;Fb.__name__=!0;Fb.__interfaces__=[sb];Fb.prototype={add:function(a,b,c){c=cd.copy_fields(c,
fc.get_defaults());a=new fc(a,b,c.separate,[],[],null,null,null,null,[],c.percent_correction,c.correction_threshold);null!=c.enter&&(a.enter=c.enter);null!=c.stay&&(a.stay=c.stay);null!=c.exit&&(a.exit=c.exit);null!=c.condition&&(a.condition=c.condition);this.members.push(a);return a},clear:function(){this.members.length=0},__class__:Fb};var Y=k.echo.Echo=function(){};d["echo.Echo"]=Y;Y.__name__=!0;Y.start=function(a){return new dd(a)};Y.make=function(a,b){return a.add(new U(b))};Y.listen=function(a,
b,c,e){return null==b?null==c?a.listeners.add(Nc.Right(a.members),Nc.Right(a.members),e):a.listeners.add(c,c,e):null==c?a.listeners.add(b,b,e):a.listeners.add(b,c,e)};Y.check=function(a,b,c,e){Y.cached_listeners.clear();null==b&&null==c?Y.cached_listeners.add(Nc.Right(a.members),Nc.Right(a.members),e):null==b?Y.cached_listeners.add(c,c,e):null==c?Y.cached_listeners.add(b,b,e):Y.cached_listeners.add(b,c,e);fa.query(a,Y.cached_listeners);zc.separate(a,Y.cached_listeners);fa.notify(a,Y.cached_listeners)};
Y.step=function(a,b){if(null!=a.history){for(var c=a.history,e=[],g=0,l=a.members;g<l.length;){var x=l[g];++g;e.push(new fe(x.id,x.transform.local_x,x.transform.local_y,180/Math.PI*x.transform.local_radians,x.velocity.x,x.velocity.y,x.acceleration.x,x.acceleration.y,x.rotational_velocity))}c.add(e)}b/=a.iterations;e=0;for(g=a.iterations;e<g;)e++,zc.step(a,b),fa.query(a),zc.separate(a),fa.notify(a)};Y.linecast_floats=function(a,b,c,e,g,l,x){null==x&&(x=!0);null==e&&(e=1);null==c&&(c=1);null==b&&(b=
0);null==a&&(a=0);var m=Mb.pool.get();null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var ia=m.start;ia.x=a;ia.y=b;ia=m.end;ia.x=c;ia.y=e;m.pooled=!1;g=Y.linecast(m,g,l,x);m.pooled||(m.pooled=!0,Mb.pool.put_unsafe(m));return g};Y.linecast_vector=function(a,b,c,e,g,l){null==l&&(l=!0);var x=Mb.pool.get();x.set_from_vector(a,b,c);x.pooled=!1;a=Y.linecast(x,e,g,l);x.pooled||(x.pooled=!0,Mb.pool.put_unsafe(x));return a};Y.linecast_vectors=function(a,b,c,e,g){g=a.x;var l=a.y;a=b.x;var x=b.y;
null==x&&(x=1);null==a&&(a=1);null==l&&(l=0);null==g&&(g=0);b=Mb.pool.get();null==x&&(x=1);null==a&&(a=1);null==l&&(l=0);null==g&&(g=0);var m=b.start;m.x=g;m.y=l;m=b.end;m.x=a;m.y=x;b.pooled=!1;c=Y.linecast(b,c,e);b.pooled||(b.pooled=!0,Mb.pool.put_unsafe(b));return c};Y.linecast=function(a,b,c,e){null==e&&(e=!0);var g=null,l=Math.min(a.start.x,a.end.x),x=Math.min(a.start.y,a.end.y),m=Math.max(a.start.x,a.end.x),ia=Math.max(a.start.y,a.end.y),f=eb.pool.get();f.min_x=l;f.max_x=m;f.min_y=x;f.max_y=
ia;f.pooled=!1;var d=b;switch(d._hx_index){case 0:var r=d.v;if(!r.disposed&&r.active){var p=r.bounds();if(f.min_x<p.max_x&&f.max_x>=p.min_x&&f.min_y<p.max_y&&f.max_y>=p.min_y){var h=0;for(e=r.shapes.length;h<e;)x=h++,l=r.shapes[x].intersect(a),null!=l&&(null==g&&(x=Qb.pool.get(),x.line=a,x.body=r,x.data.length=0,x.pooled=!1,g=x),g.data.push(l))}p.put()}break;case 1:if(b=d.v,null==c)for(d=0;d<b.length;){if(r=b[d],++d,null!=r&&!r.disposed&&r.active){p=r.bounds();x=Qb.pool.get();x.line=a;x.body=r;x.data.length=
0;x.pooled=!1;c=x;if(f.min_x<p.max_x&&f.max_x>=p.min_x&&f.min_y<p.max_y&&f.max_y>=p.min_y)for(h=0,e=r.shapes.length;h<e;)x=h++,l=r.shapes[x].intersect(a),null!=l&&c.data.push(l);p.put();if(0<c.data.length)if(null!=g){if(0==g.data.length)l=null;else if(1==g.data.length)l=g.data[0];else{p=g.data[0];r=1;for(l=g.data.length;r<l;)x=r++,null!=g.data[x]&&g.data[x].distance<p.distance&&(p=g.data[x]);l=p}p=l.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];e=1;for(l=
c.data.length;e<l;)x=e++,null!=c.data[x]&&c.data[x].distance<r.distance&&(r=c.data[x]);e=r}l=p>e.distance}else l=!0;else l=!1;l?(null!=g&&g.put(),g=c):c.put()}}else{d=0;for(h=Y.cached_collisions;d<h.length;)p=h[d],++d,p.put();Y.cached_collisions.length=0;p=Y.cached_body;l=f.min_x;x=f.min_y;m=f.max_x;ia=f.max_y;r=Ib.pool.get();d=.5*(l+m);h=.5*(x+ia);l=m-l;ia-=x;null==ia&&(ia=0);null==l&&(l=1);null==h&&(h=0);null==d&&(d=0);m=r.transform;m.dirty||m.set_dirty();m.local_x=d;m=r.transform;m.dirty||m.set_dirty();
m.local_y=h;d=.5*l;m=r.transform;null==m.parent?h=m.local_scale_x:(m.sync(),h=m._scale_x);r.local_ex=d/h;if(null!=r.transformed_rect){m=r.transformed_rect;m.count=4;d=0;for(h=m.count;d<h;)if(x=d++,null==m.local_vertices[x]){var q=m.local_vertices,n=new O(0,0);q[x]=n}d=m.local_vertices[0];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=-(r.local_ey*r.transform.local_scale_y);d=m.local_vertices[1];d.x=r.local_ex*r.transform.local_scale_x;d.y=-(r.local_ey*r.transform.local_scale_y);d=m.local_vertices[2];
d.x=r.local_ex*r.transform.local_scale_x;d.y=r.local_ey*r.transform.local_scale_y;d=m.local_vertices[3];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=r.local_ey*r.transform.local_scale_y;d=r.transform.local_x;q=m.transform;q.dirty||q.set_dirty();q.local_x=d;d=r.transform.local_y;q=m.transform;q.dirty||q.set_dirty();q.local_y=d;q=m.transform;d=Math.PI/180*(180/Math.PI)*r.transform.local_radians;q.dirty||q.set_dirty();q.local_radians=d;d=r.transform.local_scale_x;q=m.transform;q.dirty||q.set_dirty();
q.local_scale_x=d;d=r.transform.local_scale_y;q=m.transform;q.dirty||q.set_dirty();q.local_scale_y=d;m.dirty_vertices=!0;m.dirty_bounds=!0}d=.5*(0>=ia?l:ia);m=r.transform;null==m.parent?h=m.local_scale_y:(m.sync(),h=m._scale_y);r.local_ey=d/h;if(null!=r.transformed_rect){m=r.transformed_rect;m.count=4;d=0;for(h=m.count;d<h;)x=d++,null==m.local_vertices[x]&&(q=m.local_vertices,n=new O(0,0),q[x]=n);d=m.local_vertices[0];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=-(r.local_ey*r.transform.local_scale_y);
d=m.local_vertices[1];d.x=r.local_ex*r.transform.local_scale_x;d.y=-(r.local_ey*r.transform.local_scale_y);d=m.local_vertices[2];d.x=r.local_ex*r.transform.local_scale_x;d.y=r.local_ey*r.transform.local_scale_y;d=m.local_vertices[3];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=r.local_ey*r.transform.local_scale_y;d=r.transform.local_x;q=m.transform;q.dirty||q.set_dirty();q.local_x=d;d=r.transform.local_y;q=m.transform;q.dirty||q.set_dirty();q.local_y=d;q=m.transform;d=Math.PI/180*(180/Math.PI)*
r.transform.local_radians;q.dirty||q.set_dirty();q.local_radians=d;d=r.transform.local_scale_x;q=m.transform;q.dirty||q.set_dirty();q.local_scale_x=d;d=r.transform.local_scale_y;q=m.transform;q.dirty||q.set_dirty();q.local_scale_y=d;m.dirty_vertices=!0;m.dirty_bounds=!0}m=r.transform;d=Math.PI/180*0;m.dirty||m.set_dirty();m.local_radians=d;m=r.transform;m.dirty||m.set_dirty();m.local_scale_x=1;m=r.transform;m.dirty||m.set_dirty();m.local_scale_y=1;null==r.transformed_rect?(m=r.transform,null==m.parent?
l=180/Math.PI*m.local_radians:(m.sync(),l=180/Math.PI*m._radians),l=0!=l):l=!1;if(l){l=Qa.pool.get();l.count=4;d=0;for(h=l.count;d<h;)x=d++,null==l.local_vertices[x]&&(ia=l.local_vertices,n=new O(0,0),ia[x]=n);d=l.local_vertices[0];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=-(r.local_ey*r.transform.local_scale_y);d=l.local_vertices[1];d.x=r.local_ex*r.transform.local_scale_x;d.y=-(r.local_ey*r.transform.local_scale_y);d=l.local_vertices[2];d.x=r.local_ex*r.transform.local_scale_x;d.y=r.local_ey*
r.transform.local_scale_y;d=l.local_vertices[3];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=r.local_ey*r.transform.local_scale_y;d=r.transform.local_x;m=l.transform;m.dirty||m.set_dirty();m.local_x=d;d=r.transform.local_y;m=l.transform;m.dirty||m.set_dirty();m.local_y=d;m=l.transform;d=Math.PI/180*(180/Math.PI)*r.transform.local_radians;m.dirty||m.set_dirty();m.local_radians=d;d=r.transform.local_scale_x;m=l.transform;m.dirty||m.set_dirty();m.local_scale_x=d;d=r.transform.local_scale_y;m=l.transform;
m.dirty||m.set_dirty();m.local_scale_y=d;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;r.transformed_rect=l;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(d=r.transform.local_x,m=r.transformed_rect.transform,m.dirty||m.set_dirty(),m.local_x=d,d=r.transform.local_y,m=r.transformed_rect.transform,m.dirty||m.set_dirty(),m.local_y=d,m=r.transformed_rect.transform,d=Math.PI/180*(180/Math.PI)*r.transform.local_radians,m.dirty||m.set_dirty(),m.local_radians=d,d=r.transform.local_scale_x,
m=r.transformed_rect.transform,m.dirty||m.set_dirty(),m.local_scale_x=d,d=r.transform.local_scale_y,m=r.transformed_rect.transform,m.dirty||m.set_dirty(),m.local_scale_y=d);r.pooled=!1;null!=p.shapes[0]&&p.shapes[0].put();p.shapes[0]=r;p.shapes[0].set_parent(p);p.dirty=!0;0>=p.mass&&null!=p.world&&(p.bounds(p.quadtree_data.bounds),p.world.static_quadtree.update(p.quadtree_data));e&&fa.update_quadtree(c);fa.overlap_body_and_bodies_bounds(Y.cached_body,b,c,Y.cached_collisions);d=0;for(h=Y.cached_collisions;d<
h.length;){p=h[d];++d;r=p.b;x=Qb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;e=0;for(r=p.b.shapes.length;e<r;)x=e++,l=p.b.shapes[x].intersect(a),null!=l&&c.data.push(l);if(0<c.data.length)if(null!=g){if(0==g.data.length)l=null;else if(1==g.data.length)l=g.data[0];else{p=g.data[0];l=1;for(e=g.data.length;l<e;)x=l++,null!=g.data[x]&&g.data[x].distance<p.distance&&(p=g.data[x]);l=p}p=l.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];l=1;for(b=
c.data.length;l<b;)x=l++,null!=c.data[x]&&c.data[x].distance<r.distance&&(r=c.data[x]);e=r}l=p>e.distance}else l=!0;else l=!1;l?(null!=g&&g.put(),g=c):c.put()}Y.cached_body.shapes[0].put()}}f.put();return g};Y.linecast_all=function(a,b,c,e){null==e&&(e=!0);var g=[],l=Math.min(a.start.x,a.end.x),x=Math.min(a.start.y,a.end.y),m=Math.max(a.start.x,a.end.x),ia=Math.max(a.start.y,a.end.y),f=eb.pool.get();f.min_x=l;f.max_x=m;f.min_y=x;f.max_y=ia;f.pooled=!1;var d=b;switch(d._hx_index){case 0:var r=d.v;
x=Qb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;var p=r.bounds();if(f.min_x<p.max_x&&f.max_x>=p.min_x&&f.min_y<p.max_y&&f.max_y>=p.min_y){var q=0;for(e=r.shapes.length;q<e;)x=q++,x=r.shapes[x].intersect(a),null!=x&&c.data.push(x)}p.put();0<c.data.length?g.push(c):c.put();break;case 1:if(b=d.v,null==c)for(d=0;d<b.length;){if(r=b[d],++d,null!=r){p=r.bounds();x=Qb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;if(f.min_x<p.max_x&&f.max_x>=p.min_x&&f.min_y<p.max_y&&f.max_y>=
p.min_y)for(q=0,e=r.shapes.length;q<e;)x=q++,x=r.shapes[x].intersect(a),null!=x&&c.data.push(x);p.put();0<c.data.length?g.push(c):c.put()}}else{d=0;for(q=Y.cached_collisions;d<q.length;)p=q[d],++d,p.put();Y.cached_collisions.length=0;p=Y.cached_body;l=f.min_x;x=f.min_y;m=f.max_x;ia=f.max_y;r=Ib.pool.get();d=.5*(l+m);q=.5*(x+ia);l=m-l;ia-=x;null==ia&&(ia=0);null==l&&(l=1);null==q&&(q=0);null==d&&(d=0);m=r.transform;m.dirty||m.set_dirty();m.local_x=d;m=r.transform;m.dirty||m.set_dirty();m.local_y=q;
d=.5*l;m=r.transform;null==m.parent?q=m.local_scale_x:(m.sync(),q=m._scale_x);r.local_ex=d/q;if(null!=r.transformed_rect){m=r.transformed_rect;m.count=4;d=0;for(q=m.count;d<q;)if(x=d++,null==m.local_vertices[x]){var h=m.local_vertices,n=new O(0,0);h[x]=n}d=m.local_vertices[0];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=-(r.local_ey*r.transform.local_scale_y);d=m.local_vertices[1];d.x=r.local_ex*r.transform.local_scale_x;d.y=-(r.local_ey*r.transform.local_scale_y);d=m.local_vertices[2];d.x=r.local_ex*
r.transform.local_scale_x;d.y=r.local_ey*r.transform.local_scale_y;d=m.local_vertices[3];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=r.local_ey*r.transform.local_scale_y;d=r.transform.local_x;h=m.transform;h.dirty||h.set_dirty();h.local_x=d;d=r.transform.local_y;h=m.transform;h.dirty||h.set_dirty();h.local_y=d;h=m.transform;d=Math.PI/180*(180/Math.PI)*r.transform.local_radians;h.dirty||h.set_dirty();h.local_radians=d;d=r.transform.local_scale_x;h=m.transform;h.dirty||h.set_dirty();h.local_scale_x=
d;d=r.transform.local_scale_y;h=m.transform;h.dirty||h.set_dirty();h.local_scale_y=d;m.dirty_vertices=!0;m.dirty_bounds=!0}d=.5*(0>=ia?l:ia);m=r.transform;null==m.parent?q=m.local_scale_y:(m.sync(),q=m._scale_y);r.local_ey=d/q;if(null!=r.transformed_rect){m=r.transformed_rect;m.count=4;d=0;for(q=m.count;d<q;)x=d++,null==m.local_vertices[x]&&(h=m.local_vertices,n=new O(0,0),h[x]=n);d=m.local_vertices[0];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=-(r.local_ey*r.transform.local_scale_y);d=m.local_vertices[1];
d.x=r.local_ex*r.transform.local_scale_x;d.y=-(r.local_ey*r.transform.local_scale_y);d=m.local_vertices[2];d.x=r.local_ex*r.transform.local_scale_x;d.y=r.local_ey*r.transform.local_scale_y;d=m.local_vertices[3];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=r.local_ey*r.transform.local_scale_y;d=r.transform.local_x;h=m.transform;h.dirty||h.set_dirty();h.local_x=d;d=r.transform.local_y;h=m.transform;h.dirty||h.set_dirty();h.local_y=d;h=m.transform;d=Math.PI/180*(180/Math.PI)*r.transform.local_radians;
h.dirty||h.set_dirty();h.local_radians=d;d=r.transform.local_scale_x;h=m.transform;h.dirty||h.set_dirty();h.local_scale_x=d;d=r.transform.local_scale_y;h=m.transform;h.dirty||h.set_dirty();h.local_scale_y=d;m.dirty_vertices=!0;m.dirty_bounds=!0}m=r.transform;d=Math.PI/180*0;m.dirty||m.set_dirty();m.local_radians=d;m=r.transform;m.dirty||m.set_dirty();m.local_scale_x=1;m=r.transform;m.dirty||m.set_dirty();m.local_scale_y=1;null==r.transformed_rect?(m=r.transform,null==m.parent?d=180/Math.PI*m.local_radians:
(m.sync(),d=180/Math.PI*m._radians),d=0!=d):d=!1;if(d){l=Qa.pool.get();l.count=4;d=0;for(q=l.count;d<q;)x=d++,null==l.local_vertices[x]&&(ia=l.local_vertices,n=new O(0,0),ia[x]=n);d=l.local_vertices[0];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=-(r.local_ey*r.transform.local_scale_y);d=l.local_vertices[1];d.x=r.local_ex*r.transform.local_scale_x;d.y=-(r.local_ey*r.transform.local_scale_y);d=l.local_vertices[2];d.x=r.local_ex*r.transform.local_scale_x;d.y=r.local_ey*r.transform.local_scale_y;
d=l.local_vertices[3];d.x=-(r.local_ex*r.transform.local_scale_x);d.y=r.local_ey*r.transform.local_scale_y;d=r.transform.local_x;m=l.transform;m.dirty||m.set_dirty();m.local_x=d;d=r.transform.local_y;m=l.transform;m.dirty||m.set_dirty();m.local_y=d;m=l.transform;d=Math.PI/180*(180/Math.PI)*r.transform.local_radians;m.dirty||m.set_dirty();m.local_radians=d;d=r.transform.local_scale_x;m=l.transform;m.dirty||m.set_dirty();m.local_scale_x=d;d=r.transform.local_scale_y;m=l.transform;m.dirty||m.set_dirty();
m.local_scale_y=d;l.dirty_vertices=!0;l.dirty_bounds=!0;l.pooled=!1;r.transformed_rect=l;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(d=r.transform.local_x,m=r.transformed_rect.transform,m.dirty||m.set_dirty(),m.local_x=d,d=r.transform.local_y,m=r.transformed_rect.transform,m.dirty||m.set_dirty(),m.local_y=d,m=r.transformed_rect.transform,d=Math.PI/180*(180/Math.PI)*r.transform.local_radians,m.dirty||m.set_dirty(),m.local_radians=d,d=r.transform.local_scale_x,m=r.transformed_rect.transform,
m.dirty||m.set_dirty(),m.local_scale_x=d,d=r.transform.local_scale_y,m=r.transformed_rect.transform,m.dirty||m.set_dirty(),m.local_scale_y=d);r.pooled=!1;null!=p.shapes[0]&&p.shapes[0].put();p.shapes[0]=r;p.shapes[0].set_parent(p);p.dirty=!0;0>=p.mass&&null!=p.world&&(p.bounds(p.quadtree_data.bounds),p.world.static_quadtree.update(p.quadtree_data));e&&fa.update_quadtree(c);fa.overlap_body_and_bodies_bounds(Y.cached_body,b,c,Y.cached_collisions);d=0;for(q=Y.cached_collisions;d<q.length;){p=q[d];++d;
r=p.b;x=Qb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;e=0;for(b=p.b.shapes.length;e<b;)x=e++,x=p.b.shapes[x].intersect(a),null!=x&&c.data.push(x);0<c.data.length?g.push(c):c.put()}Y.cached_body.shapes[0].put()}}f.put();return g};Y.undo=function(a){if(null!=a.history){var b=a.history.undo();if(null!=b){for(var c=0;c<b.length;){var e=b[c];++c;for(var g=0,l=a.members;g<l.length;){var x=l[g];++g;if(e.id==x.id){var m=e.x,d=x.transform;d.dirty||d.set_dirty();d.local_x=m;if(null!=x.on_move)x.on_move(x.transform.local_x,
x.transform.local_y);m=e.y;d=x.transform;d.dirty||d.set_dirty();d.local_y=m;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);m=x.transform;d=Math.PI/180*e.rotation;m.dirty||m.set_dirty();m.local_radians=d;if(null!=x.on_rotate)x.on_rotate(180/Math.PI*x.transform.local_radians);m=x.velocity;m.x=e.velocity_x;m.y=e.velocity_y;m=x.acceleration;m.x=e.acceleration_x;m.y=e.acceleration_y;x.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}}return a};Y.redo=function(a){if(null!=
a.history){var b=a.history.redo();if(null!=b)for(var c=0;c<b.length;){var e=b[c];++c;for(var g=0,l=a.members;g<l.length;){var x=l[g];++g;if(e.id==x.id){var m=e.x,d=x.transform;d.dirty||d.set_dirty();d.local_x=m;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);m=e.y;d=x.transform;d.dirty||d.set_dirty();d.local_y=m;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);m=x.transform;d=Math.PI/180*e.rotation;m.dirty||m.set_dirty();m.local_radians=d;if(null!=x.on_rotate)x.on_rotate(180/
Math.PI*x.transform.local_radians);m=x.velocity;m.x=e.velocity_x;m.y=e.velocity_y;m=x.acceleration;m.x=e.acceleration_x;m.y=e.acceleration_y;x.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}return a};var ib=function(){};d["echo.util.Poolable"]=ib;ib.__name__=!0;ib.__isInterface__=!0;var Ya=function(){};d["echo.util.Pool"]=Ya;Ya.__name__=!0;Ya.__isInterface__=!0;var Oc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_Line"]=Oc;Oc.__name__=!0;Oc.__interfaces__=
[Ya];Oc.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Oc};var Mb=function(a,b,c,e){null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this.pooled=!1;this.start=a=new O(a,b);this.end=a=new O(c,e)};d["echo.Line"]=Mb;Mb.__name__=!0;Mb.__interfaces__=[ib];Mb.prototype={set_from_vector:function(a,b,c){var e=Math.PI/180*b;b=a.x;var g=a.y,l=a.x+c*Math.cos(e);a=a.y+
c*Math.sin(e);null==a&&(a=1);null==l&&(l=1);null==g&&(g=0);null==b&&(b=0);c=this.start;c.x=b;c.y=g;c=this.end;c.x=l;c.y=a;return this},get_x:function(){return this.start.x},get_y:function(){return this.start.y},get_dx:function(){return this.end.x},get_dy:function(){return this.end.y},__class__:Mb,__properties__:{get_dy:"get_dy",get_dx:"get_dx",get_y:"get_y",get_x:"get_x"}};var fc=function(a,b,c,e,g,l,x,m,d,f,p,r){this.a=a;this.b=b;this.separate=c;this.collisions=e;this.last_collisions=g;this.enter=
l;this.stay=x;this.exit=m;this.condition=d;this.quadtree_results=f;this.percent_correction=p;this.correction_threshold=r};d["echo.Listener"]=fc;fc.__name__=!0;fc.__properties__={get_defaults:"get_defaults"};fc.get_defaults=function(){return{separate:!0,percent_correction:.9,correction_threshold:.013}};fc.prototype={__class__:fc};var ac=function(a,b,c,e,g){this.gravity_scale=1;this.friction=this.static_friction=0;this.density=1;this.elasticity=0;null!=a&&(this.elasticity=a);null!=b&&(this.density=
b);null!=c&&(this.friction=c);null!=e&&(this.static_friction=e);null!=g&&(this.gravity_scale=g)};d["echo.Material"]=ac;ac.__name__=!0;ac.prototype={__class__:ac};var zc=function(){};d["echo.Physics"]=zc;zc.__name__=!0;zc.step=function(a,b){for(var c=0,e=a.members;c<e.length;){var g=e[c];++c;if(0<g.mass&&!g.disposed&&g.active){g.last_x=g.transform.local_x;g.last_y=g.transform.local_y;g.last_rotation=180/Math.PI*g.transform.local_radians;var l=g.acceleration.x*g.inverse_mass,x=g.acceleration.y*g.inverse_mass;
g.kinematic||(l+=a.gravity.x*g.material.gravity_scale,x+=a.gravity.y*g.material.gravity_scale);var m=g.velocity.x,d=g.drag.x,f=g.max_velocity.x;1E-5>=Math.abs(l)?1E-5>=Math.abs(d)||(d*=b,m=0<m-d?m-d:0>m+d?m+d:0):m+=l*b;1E-5>=Math.abs(f)||(l=-f,m<l?m=l:m>f&&(m=f));g.velocity.x=m;m=g.velocity.y;l=g.drag.y;f=g.max_velocity.y;1E-5>=Math.abs(x)?1E-5>=Math.abs(l)||(l*=b,m=0<m-l?m-l:0>m+l?m+l:0):m+=x*b;1E-5>=Math.abs(f)||(x=-f,m<x?m=x:m>f&&(m=f));g.velocity.y=m;0<g.drag_length?(x=g.acceleration,x=0==x.x&&
0==x.y):x=!1;x?(x=g.velocity,x=!(0==x.x&&0==x.y)):x=!1;x&&(x=f=g.velocity,x=Math.sqrt(x.x*x.x+x.y*x.y)-g.drag_length*b,l=m=f,l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),d=f.y/l*x,m.x=f.x/l*x,m.y=d);0<g.max_velocity_length?(x=g.velocity,x=Math.sqrt(x.x*x.x+x.y*x.y)>g.max_velocity_length):x=!1;x&&(f=g.velocity,x=g.max_velocity_length,l=m=f,l=l.x*l.x+l.y*l.y,l=0==l?1:Math.sqrt(l),d=f.y/l*x,m.x=f.x/l*x,m.y=d);x=g.transform.local_x+g.velocity.x*b;m=g.transform;m.dirty||m.set_dirty();m.local_x=x;if(null!=g.on_move)g.on_move(g.transform.local_x,
g.transform.local_y);x=g.transform.local_y+g.velocity.y*b;m=g.transform;m.dirty||m.set_dirty();m.local_y=x;if(null!=g.on_move)g.on_move(g.transform.local_x,g.transform.local_y);x=g.rotational_velocity;f=g.rotational_drag;l=g.torque*g.inverse_mass;m=g.max_rotational_velocity;1E-5>=Math.abs(f)?1E-5>=Math.abs(l)||(l*=b,x=0<x-l?x-l:0>x+l?x+l:0):x+=f*b;1E-5>=Math.abs(m)||(f=-m,x<f?x=f:x>m&&(x=m));g.rotational_velocity=x;x=g.transform;m=Math.PI/180*(180/Math.PI*g.transform.local_radians+g.rotational_velocity*
b);x.dirty||x.set_dirty();x.local_radians=m;if(null!=g.on_rotate)g.on_rotate(180/Math.PI*g.transform.local_radians)}}};zc.separate=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(c.separate)for(var e=0,g=c.collisions;e<g.length;){var l=g[e];++e;for(var x=0,m=l.data.length;x<m;){var d=x++,f=l.a,p=l.b;d=l.data[d];var r=c.correction_threshold,h=c.percent_correction;null==h&&(h=.9);null==r&&(r=.013);if(d.sa.solid&&d.sb.solid&&f.active&&p.active&&!f.disposed&&
!p.disposed&&!(0>=f.mass&&0>=p.mass)){var q=(f.velocity.x-p.velocity.x)*d.normal.x+(f.velocity.y-p.velocity.y)*d.normal.y,n=f.inverse_mass+p.inverse_mass;if(0<q){var A=-(1+.5*(f.material.elasticity+p.material.elasticity))*q/n;q=-A*d.normal.x;A=-A*d.normal.y;f.kinematic||(f.velocity.x-=q*f.inverse_mass,f.velocity.y-=A*f.inverse_mass);p.kinematic||(p.velocity.x+=q*p.inverse_mass,p.velocity.y+=A*p.inverse_mass)}h*=Math.max(d.overlap-r,0)/n;r=h*d.normal.x;d=h*d.normal.y;if(!f.kinematic){h=f.transform.local_x-
f.inverse_mass*r;n=f.transform;n.dirty||n.set_dirty();n.local_x=h;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y);h=f.transform.local_y-f.inverse_mass*d;n=f.transform;n.dirty||n.set_dirty();n.local_y=h;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y)}if(!p.kinematic){f=p.transform.local_x+p.inverse_mass*r;r=p.transform;r.dirty||r.set_dirty();r.local_x=f;if(null!=p.on_move)p.on_move(p.transform.local_x,p.transform.local_y);f=p.transform.local_y+p.inverse_mass*
d;d=p.transform;d.dirty||d.set_dirty();d.local_y=f;if(null!=p.on_move)p.on_move(p.transform.local_x,p.transform.local_y)}}}}}};var Sa=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.solid=!0;var e=this.transform=new rc;e.dirty||e.set_dirty();e.local_x=a;e=this.transform;e.dirty||e.set_dirty();e.local_y=b;e=this.transform;a=Math.PI/180*c;e.dirty||e.set_dirty();e.local_radians=a};d["echo.Shape"]=Sa;Sa.__name__=!0;Sa.__properties__={get_defaults:"get_defaults"};Sa.get=function(a){a=
cd.copy_fields(a,Sa.get_defaults());switch(a.type){case 0:var b=a.offset_x,c=a.offset_y,e=a.width,g=a.height,l=a.rotation,x=a.scale_x,m=a.scale_y;null==m&&(m=1);null==x&&(x=1);null==l&&(l=0);null==g&&(g=0);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);var d=Ib.pool.get();var f=b,p=c;b=g;null==m&&(m=1);null==x&&(x=1);null==l&&(l=0);null==b&&(b=0);null==e&&(e=1);null==p&&(p=0);null==f&&(f=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=f;c=d.transform;c.dirty||c.set_dirty();c.local_y=p;f=.5*e;c=d.transform;
null==c.parent?p=c.local_scale_x:(c.sync(),p=c._scale_x);d.local_ex=f/p;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;f=0;for(p=c.count;f<p;)if(g=f++,null==c.local_vertices[g]){var r=c.local_vertices,h=new O(0,0);r[g]=h}f=c.local_vertices[0];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[1];f.x=d.local_ex*d.transform.local_scale_x;f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[2];f.x=d.local_ex*d.transform.local_scale_x;
f.y=d.local_ey*d.transform.local_scale_y;f=c.local_vertices[3];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=d.local_ey*d.transform.local_scale_y;f=d.transform.local_x;r=c.transform;r.dirty||r.set_dirty();r.local_x=f;f=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=f;r=c.transform;f=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=f;f=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=f;f=d.transform.local_scale_y;
r=c.transform;r.dirty||r.set_dirty();r.local_scale_y=f;c.dirty_vertices=!0;c.dirty_bounds=!0}f=.5*(0>=b?e:b);c=d.transform;null==c.parent?p=c.local_scale_y:(c.sync(),p=c._scale_y);d.local_ey=f/p;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;f=0;for(p=c.count;f<p;)g=f++,null==c.local_vertices[g]&&(r=c.local_vertices,h=new O(0,0),r[g]=h);f=c.local_vertices[0];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[1];f.x=d.local_ex*d.transform.local_scale_x;
f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[2];f.x=d.local_ex*d.transform.local_scale_x;f.y=d.local_ey*d.transform.local_scale_y;f=c.local_vertices[3];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=d.local_ey*d.transform.local_scale_y;f=d.transform.local_x;r=c.transform;r.dirty||r.set_dirty();r.local_x=f;f=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=f;r=c.transform;f=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=
f;f=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=f;f=d.transform.local_scale_y;r=c.transform;r.dirty||r.set_dirty();r.local_scale_y=f;c.dirty_vertices=!0;c.dirty_bounds=!0}c=d.transform;f=Math.PI/180*l;c.dirty||c.set_dirty();c.local_radians=f;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=x;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=m;null==d.transformed_rect?(c=d.transform,null==c.parent?m=180/Math.PI*c.local_radians:(c.sync(),m=180/Math.PI*c._radians),
m=0!=m):m=!1;if(m){e=Qa.pool.get();e.count=4;f=0;for(p=e.count;f<p;)g=f++,null==e.local_vertices[g]&&(m=e.local_vertices,h=new O(0,0),m[g]=h);f=e.local_vertices[0];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=-(d.local_ey*d.transform.local_scale_y);f=e.local_vertices[1];f.x=d.local_ex*d.transform.local_scale_x;f.y=-(d.local_ey*d.transform.local_scale_y);f=e.local_vertices[2];f.x=d.local_ex*d.transform.local_scale_x;f.y=d.local_ey*d.transform.local_scale_y;f=e.local_vertices[3];f.x=-(d.local_ex*
d.transform.local_scale_x);f.y=d.local_ey*d.transform.local_scale_y;f=d.transform.local_x;c=e.transform;c.dirty||c.set_dirty();c.local_x=f;f=d.transform.local_y;c=e.transform;c.dirty||c.set_dirty();c.local_y=f;c=e.transform;f=Math.PI/180*(180/Math.PI)*d.transform.local_radians;c.dirty||c.set_dirty();c.local_radians=f;f=d.transform.local_scale_x;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=f;f=d.transform.local_scale_y;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=f;e.dirty_vertices=
!0;e.dirty_bounds=!0;e.pooled=!1;d.transformed_rect=e;d.transformed_rect.set_parent(d.parent)}else null!=d.transformed_rect&&(f=d.transform.local_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_x=f,f=d.transform.local_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_y=f,c=d.transformed_rect.transform,f=Math.PI/180*(180/Math.PI)*d.transform.local_radians,c.dirty||c.set_dirty(),c.local_radians=f,f=d.transform.local_scale_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),
c.local_scale_x=f,f=d.transform.local_scale_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_scale_y=f);d.pooled=!1;break;case 1:b=a.offset_x;c=a.offset_y;r=a.radius;l=a.rotation;x=a.scale_x;m=a.scale_y;null==m&&(m=1);null==x&&(x=1);null==l&&(l=0);null==r&&(r=1);null==c&&(c=0);null==b&&(b=0);d=Lb.pool.get();f=b;p=c;e=r;null==m&&(m=1);null==x&&(x=1);null==l&&(l=0);null==e&&(e=1);null==p&&(p=0);null==f&&(f=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=f;c=d.transform;c.dirty||c.set_dirty();
c.local_y=p;c=d.transform;f=Math.PI/180*l;c.dirty||c.set_dirty();c.local_radians=f;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=x;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=m;c=d.transform;null==c.parent?m=c.local_scale_x:(c.sync(),m=c._scale_x);d.local_radius=e/m;d.pooled=!1;break;case 2:if(null!=a.vertices)b=a.offset_x,c=a.offset_y,l=a.rotation,d=a.vertices,x=a.scale_x,m=a.scale_y,null==m&&(m=1),null==x&&(x=1),null==l&&(l=0),null==c&&(c=0),null==b&&(b=0),e=Qa.pool.get(),f=b,p=
c,null==m&&(m=1),null==x&&(x=1),null==l&&(l=0),null==p&&(p=0),null==f&&(f=0),c=e.transform,c.dirty||c.set_dirty(),c.local_x=f,c=e.transform,c.dirty||c.set_dirty(),c.local_y=p,c=e.transform,f=Math.PI/180*l,c.dirty||c.set_dirty(),c.local_radians=f,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_x=x,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_y=m,m=null,e.local_vertices=null==d?[]:d;else{b=a.offset_x;c=a.offset_y;p=a.sides;r=a.radius;l=a.rotation;x=a.scale_x;m=a.scale_y;null==m&&(m=1);null==
x&&(x=1);null==l&&(l=0);null==r&&(r=1);null==p&&(p=3);null==c&&(c=0);null==b&&(b=0);if(3>p)throw z.thrown("Polygons require 3 sides as a minimum");e=Qa.pool.get();var q=2*Math.PI/p;d=[];for(f=0;f<p;)g=f++,g=g*q+.5*(Math.PI-q),h=new O(Math.cos(g)*r,Math.sin(g)*r),d.push(h);f=b;p=c;null==m&&(m=1);null==x&&(x=1);null==l&&(l=0);null==p&&(p=0);null==f&&(f=0);c=e.transform;c.dirty||c.set_dirty();c.local_x=f;c=e.transform;c.dirty||c.set_dirty();c.local_y=p;c=e.transform;f=Math.PI/180*l;c.dirty||c.set_dirty();
c.local_radians=f;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=x;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=m;m=null;e.local_vertices=null==d?[]:d}e.count=null!=m&&0<=m?m:e.local_vertices.length;if(m>e.local_vertices.length)for(f=e.local_vertices.length,p=m;f<p;)g=f++,m=e.local_vertices,h=new O(0,0),m[g]=h;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;d=e}d.solid=a.solid;return d};Sa.get_defaults=function(){return{type:0,radius:1,width:1,height:0,sides:3,rotation:0,scale_x:1,
scale_y:1,offset_x:0,offset_y:0,solid:!0}};Sa.prototype={put:function(){this.transform.set_parent(null);this.parent=null;this.collided=!1},set_parent:function(a){this.parent!=a&&(this.parent=a,this.transform.set_parent(null==a?null:a.transform))},bounds:function(a){if(null==a){var b=this.transform;if(null==b.parent)var c=b.local_x;else b.sync(),c=b._x;b=this.transform;if(null==b.parent)var e=b.local_y;else b.sync(),e=b._y;var g=0;b=0;null==b&&(b=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);a=eb.pool.get();
null==b&&(b=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);g*=.5;b*=.5;a.min_x=c-g;a.min_y=e-b;a.max_x=c+g;a.max_y=e+b;a.pooled=!1;return a}b=this.transform;null==b.parent?c=b.local_x:(b.sync(),c=b._x);b=this.transform;null==b.parent?e=b.local_y:(b.sync(),e=b._y);b=g=0;null==b&&(b=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);g*=.5;b*=.5;a.min_x=c-g;a.min_y=e-b;a.max_x=c+g;a.max_y=e+b;return a},volume:function(){return 0},intersect:function(a){return null},collides:function(a){return null},collide_rect:function(a){return null},
collide_circle:function(a){return null},collide_polygon:function(a){return null},__class__:Sa};var dd=function(a){this.members=null==a.members?[]:a.members;this.init=!1;var b;if(1>a.width)throw z.thrown("World must have a width of at least 1");this.width=b=a.width;this.init&&this.reset_quadtrees();if(1>a.height)throw z.thrown("World must have a width of at least 1");this.height=b=a.height;this.init&&this.reset_quadtrees();this.x=null==a.x?0:a.x;this.init&&this.reset_quadtrees();this.y=null==a.y?0:
a.y;this.init&&this.reset_quadtrees();this.gravity=new O(null==a.gravity_x?0:a.gravity_x,null==a.gravity_y?0:a.gravity_y);this.reset_quadtrees();this.listeners=new Fb(a.listeners);this.iterations=null==a.iterations?5:a.iterations;null!=a.history&&(this.history=new ge(a.history))};d["echo.World"]=dd;dd.__name__=!0;dd.__interfaces__=[sb];dd.prototype={add:function(a){if(a.world==this)return a;null!=a.world&&(null!=a.world&&a.world.remove(a),null!=a.quadtree_data&&null!=a.quadtree_data.bounds&&a.quadtree_data.bounds.put());
a.world=this;a.dirty=!0;this.members.push(a);a.quadtree_data=new he(a.id,a.bounds(),!1);0>=a.mass?this.static_quadtree.insert(a.quadtree_data):this.quadtree.insert(a.quadtree_data);return a},remove:function(a){this.quadtree.remove(a.quadtree_data);this.static_quadtree.remove(a.quadtree_data);K.remove(this.members,a);a.world=null;return a},reset_quadtrees:function(){this.init=!0;if(null!=this.quadtree){var a=this.quadtree;if(!a.pooled){a.pooled=!0;for(var b=0,c=a.children.length;b<c;){var e=b++;if(null!=
a.children[e]){for(var g=a.children[e],l=0,x=g.children.length;l<x;){var m=l++;if(null!=g.children[m]){g.children[m].clear_children();var d=g.children[m];if(!d.pooled){d.pooled=!0;for(var f=0,p=d.children.length;f<p;){var r=f++;null!=d.children[r]&&(d.children[r].clear_children(),d.children[r].put(),d.children[r]=null)}d.contents.length=0;d.contents_count=0;d.nodes_list.length=0;La.pool.put_unsafe(d)}g.children[m]=null}}g=a.children[e];if(!g.pooled){g.pooled=!0;l=0;for(x=g.children.length;l<x;)if(m=
l++,null!=g.children[m]){var h=g.children[m];f=0;for(p=h.children.length;f<p;)r=f++,null!=h.children[r]&&(h.children[r].clear_children(),h.children[r].put(),h.children[r]=null);g.children[m].put();g.children[m]=null}g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;La.pool.put_unsafe(g)}a.children[e]=null}}a.contents.length=0;a.contents_count=0;a.nodes_list.length=0;La.pool.put_unsafe(a)}}h=La.pool.get();c=b=0;d=l=1;null==d&&(d=1);null==l&&(l=1);null==c&&(c=0);null==b&&(b=0);l*=.5;d*=.5;
h.min_x=b-l;h.min_y=c-d;h.max_x=b+l;h.max_y=c+d;b=0;for(c=h.children.length;b<c;)if(e=b++,null!=h.children[e]){a=h.children[e];l=0;for(x=a.children.length;l<x;)if(m=l++,null!=a.children[m]){a.children[m].clear_children();g=a.children[m];if(!g.pooled){g.pooled=!0;f=0;for(p=g.children.length;f<p;)r=f++,null!=g.children[r]&&(g.children[r].clear_children(),g.children[r].put(),g.children[r]=null);g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;La.pool.put_unsafe(g)}a.children[m]=null}d=h.children[e];
if(!d.pooled){d.pooled=!0;l=0;for(x=d.children.length;l<x;)if(m=l++,null!=d.children[m]){g=d.children[m];f=0;for(p=g.children.length;f<p;)r=f++,null!=g.children[r]&&(g.children[r].clear_children(),g.children[r].put(),g.children[r]=null);d.children[m].put();d.children[m]=null}d.contents.length=0;d.contents_count=0;d.nodes_list.length=0;La.pool.put_unsafe(d)}h.children[e]=null}h.contents.length=0;h.contents_count=0;h.pooled=!1;this.quadtree=h;if(null!=this.static_quadtree&&(a=this.static_quadtree,!a.pooled)){a.pooled=
!0;b=0;for(c=a.children.length;b<c;)if(e=b++,null!=a.children[e]){g=a.children[e];l=0;for(x=g.children.length;l<x;)if(m=l++,null!=g.children[m]){g.children[m].clear_children();d=g.children[m];if(!d.pooled){d.pooled=!0;f=0;for(p=d.children.length;f<p;)r=f++,null!=d.children[r]&&(d.children[r].clear_children(),d.children[r].put(),d.children[r]=null);d.contents.length=0;d.contents_count=0;d.nodes_list.length=0;La.pool.put_unsafe(d)}g.children[m]=null}g=a.children[e];if(!g.pooled){g.pooled=!0;l=0;for(x=
g.children.length;l<x;)if(m=l++,null!=g.children[m]){h=g.children[m];f=0;for(p=h.children.length;f<p;)r=f++,null!=h.children[r]&&(h.children[r].clear_children(),h.children[r].put(),h.children[r]=null);g.children[m].put();g.children[m]=null}g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;La.pool.put_unsafe(g)}a.children[e]=null}a.contents.length=0;a.contents_count=0;a.nodes_list.length=0;La.pool.put_unsafe(a)}h=La.pool.get();c=b=0;d=l=1;null==d&&(d=1);null==l&&(l=1);null==c&&(c=0);null==
b&&(b=0);l*=.5;d*=.5;h.min_x=b-l;h.min_y=c-d;h.max_x=b+l;h.max_y=c+d;b=0;for(c=h.children.length;b<c;)if(e=b++,null!=h.children[e]){a=h.children[e];l=0;for(x=a.children.length;l<x;)if(m=l++,null!=a.children[m]){a.children[m].clear_children();g=a.children[m];if(!g.pooled){g.pooled=!0;f=0;for(p=g.children.length;f<p;)r=f++,null!=g.children[r]&&(g.children[r].clear_children(),g.children[r].put(),g.children[r]=null);g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;La.pool.put_unsafe(g)}a.children[m]=
null}d=h.children[e];if(!d.pooled){d.pooled=!0;l=0;for(x=d.children.length;l<x;)if(m=l++,null!=d.children[m]){g=d.children[m];f=0;for(p=g.children.length;f<p;)r=f++,null!=g.children[r]&&(g.children[r].clear_children(),g.children[r].put(),g.children[r]=null);d.children[m].put();d.children[m]=null}d.contents.length=0;d.contents_count=0;d.nodes_list.length=0;La.pool.put_unsafe(d)}h.children[e]=null}h.contents.length=0;h.contents_count=0;h.pooled=!1;this.static_quadtree=h;h=null;if(null!=h){b=this.x+
.5*this.width;c=this.y+.5*this.height;l=this.width;d=this.height;null==d&&(d=0);null==l&&(l=1);null==c&&(c=0);null==b&&(b=0);a=h.transform;a.dirty||a.set_dirty();a.local_x=b;a=h.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*l;a=h.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);h.local_ex=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,p=new O(0,0),g[e]=p);b=a.local_vertices[0];b.x=-(h.local_ex*
h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||
g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*(0>=d?l:d);a=h.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);h.local_ey=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;
b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,p=new O(0,0),g[e]=p);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;
b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=h.transform;b=Math.PI/180*0;a.dirty||a.set_dirty();
a.local_radians=b;a=h.transform;a.dirty||a.set_dirty();a.local_scale_x=1;a=h.transform;a.dirty||a.set_dirty();a.local_scale_y=1;null==h.transformed_rect?(a=h.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){g=Qa.pool.get();g.count=4;b=0;for(c=g.count;b<c;)e=b++,null==g.local_vertices[e]&&(a=g.local_vertices,p=new O(0,0),a[e]=p);b=g.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);
b=g.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=g.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=g.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;a=g.transform;a.dirty||a.set_dirty();a.local_x=b;b=h.transform.local_y;a=g.transform;a.dirty||a.set_dirty();a.local_y=b;a=g.transform;b=Math.PI/180*(180/Math.PI)*
h.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=h.transform.local_scale_x;a=g.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=h.transform.local_scale_y;a=g.transform;a.dirty||a.set_dirty();a.local_scale_y=b;g.dirty_vertices=!0;g.dirty_bounds=!0;g.pooled=!1;h.transformed_rect=g;h.transformed_rect.set_parent(h.parent)}else null!=h.transformed_rect&&(b=h.transform.local_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=h.transform.local_y,a=h.transformed_rect.transform,
a.dirty||a.set_dirty(),a.local_y=b,a=h.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*h.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=h.transform.local_scale_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=h.transform.local_scale_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_y=b)}else{b=this.x+.5*this.width;c=this.y+.5*this.height;l=this.width;d=this.height;null==d&&(d=0);null==l&&(l=1);null==c&&(c=0);null==b&&(b=0);
h=Ib.pool.get();x=0;f=m=1;null==f&&(f=1);null==m&&(m=1);null==x&&(x=0);null==d&&(d=0);null==l&&(l=1);null==c&&(c=0);null==b&&(b=0);a=h.transform;a.dirty||a.set_dirty();a.local_x=b;a=h.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*l;a=h.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);h.local_ex=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,p=new O(0,0),g[e]=p);b=a.local_vertices[0];
b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=
a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*(0>=d?l:d);a=h.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);h.local_ey=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;
a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,p=new O(0,0),g[e]=p);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*
h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=h.transform;b=Math.PI/
180*x;a.dirty||a.set_dirty();a.local_radians=b;a=h.transform;a.dirty||a.set_dirty();a.local_scale_x=m;a=h.transform;a.dirty||a.set_dirty();a.local_scale_y=f;null==h.transformed_rect?(a=h.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){g=Qa.pool.get();g.count=4;b=0;for(c=g.count;b<c;)e=b++,null==g.local_vertices[e]&&(a=g.local_vertices,p=new O(0,0),a[e]=p);b=g.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*
h.transform.local_scale_y);b=g.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=g.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=g.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;a=g.transform;a.dirty||a.set_dirty();a.local_x=b;b=h.transform.local_y;a=g.transform;a.dirty||a.set_dirty();a.local_y=b;a=g.transform;
b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=b;b=h.transform.local_scale_x;a=g.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=h.transform.local_scale_y;a=g.transform;a.dirty||a.set_dirty();a.local_scale_y=b;g.dirty_vertices=!0;g.dirty_bounds=!0;g.pooled=!1;h.transformed_rect=g;h.transformed_rect.set_parent(h.parent)}else null!=h.transformed_rect&&(b=h.transform.local_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=h.transform.local_y,
a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=h.transformed_rect.transform,b=Math.PI/180*(180/Math.PI)*h.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=h.transform.local_scale_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=h.transform.local_scale_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_y=b);h.pooled=!1}b=h.to_aabb(!0);a=this.quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;
a=this.static_quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;b=0;for(c=this.members;b<c.length;)a=c[b],++b,0<a.mass?a.dirty=!0:(a.bounds(a.quadtree_data.bounds),this.static_quadtree.update(a.quadtree_data))},__class__:dd};var fe=function(a,b,c,e,g,l,x,m,d){this.id=a;this.x=b;this.y=c;this.rotation=e;this.velocity_x=g;this.velocity_y=l;this.acceleration_x=x;this.acceleration_y=m;this.rotational_velocity=d};d["echo.data.BodyState"]=fe;fe.__name__=!0;fe.prototype={__class__:fe};
var Ad=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_Collision"]=Ad;Ad.__name__=!0;Ad.__interfaces__=[Ya];Ad.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Ad};var yc=function(){this.pooled=!1;this.data=[]};d["echo.data.Collision"]=yc;yc.__name__=!0;yc.__interfaces__=[ib];yc.prototype={put:function(){if(!this.pooled){for(var a=
0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;yc.pool.put_unsafe(this)}},__class__:yc};var ed=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_CollisionData"]=ed;ed.__name__=!0;ed.__interfaces__=[Ya];ed.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:ed};var sc=function(){this.pooled=!1;var a=new O(0,0);this.normal=
a;a=new O(0,0);var b=new O(0,0);this.contacts=[a,b].slice(0);this.overlap=this.contact_count=0};d["echo.data.CollisionData"]=sc;sc.__name__=!0;sc.__interfaces__=[ib];sc.prototype={put:function(){this.pooled||(this.pooled=!0,sc.pool.put_unsafe(this))},__class__:sc};var fd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_Intersection"]=fd;fd.__name__=!0;fd.__interfaces__=[Ya];fd.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},
put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:fd};var Qb=function(){this.pooled=!1;this.data=[]};d["echo.data.Intersection"]=Qb;Qb.__name__=!0;Qb.__interfaces__=[ib];Qb.prototype={put:function(){if(!this.pooled){for(var a=0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;Qb.pool.put_unsafe(this)}},__class__:Qb};var Bd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_IntersectionData"]=Bd;Bd.__name__=!0;Bd.__interfaces__=
[Ya];Bd.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Bd};var ob=function(){this.inverse_normal=this.pooled=!1;var a=new O(0,0);this.normal=a;this.distance=this.overlap=0;this.hit=a=new O(0,0);this.hit=a=new O(0,0);this.normal=a=new O(0,0)};d["echo.data.IntersectionData"]=ob;ob.__name__=!0;ob.__interfaces__=[ib];ob.prototype={put:function(){this.pooled||(this.pooled=
!0,ob.pool.put_unsafe(this))},__class__:ob};var he=function(a,b,c){this.flag=!1;this.bounds=null;this.id=a;null!=b&&(this.bounds=b);null!=c&&(this.flag=c)};d["echo.data.QuadTreeData"]=he;he.__name__=!0;he.prototype={__class__:he};var ie=function(a,b,c,e,g,l,x,m,d){this.m00=a;this.m10=b;this.m20=c;this.m01=e;this.m11=g;this.m21=l;this.m02=x;this.m12=m;this.m22=d};d["echo.math.Matrix3Default"]=ie;ie.__name__=!0;ie.prototype={__class__:ie};var O=function(a,b){this.x=a;this.y=b};d["echo.math.Vector2Default"]=
O;O.__name__=!0;O.prototype={__class__:O};var Ec=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Circle"]=Ec;Ec.__name__=!0;Ec.__interfaces__=[Ya];Ec.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Ec};var Lb=function(){this.pooled=!1;Sa.call(this);this.type=1;var a=this.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=
a._scale_x);this.local_radius=0/a};d["echo.shape.Circle"]=Lb;Lb.__name__=!0;Lb.__interfaces__=[ib];Lb.get=function(a,b,c,e,g,l){null==l&&(l=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var x=Lb.pool.get();null==l&&(l=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var m=x.transform;m.dirty||m.set_dirty();m.local_x=a;m=x.transform;m.dirty||m.set_dirty();m.local_y=b;m=x.transform;a=Math.PI/180*e;m.dirty||m.set_dirty();m.local_radians=a;
m=x.transform;m.dirty||m.set_dirty();m.local_scale_x=g;m=x.transform;m.dirty||m.set_dirty();m.local_scale_y=l;m=x.transform;null==m.parent?a=m.local_scale_x:(m.sync(),a=m._scale_x);x.local_radius=c/a;x.pooled=!1;return x};Lb.__super__=Sa;Lb.prototype=B(Sa.prototype,{put:function(){Sa.prototype.put.call(this);this.pooled||(this.pooled=!0,Lb.pool.put_unsafe(this))},bounds:function(a){var b=this.local_radius,c=this.transform;null==c.parent?c=c.local_scale_x:(c.sync(),c=c._scale_x);b=b*c*2;if(null==a){c=
this.transform;if(null==c.parent)var e=c.local_x;else c.sync(),e=c._x;c=this.transform;if(null==c.parent)var g=c.local_y;else c.sync(),g=c._y;c=b;null==b&&(b=1);null==c&&(c=1);null==g&&(g=0);null==e&&(e=0);a=eb.pool.get();null==b&&(b=1);null==c&&(c=1);null==g&&(g=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=g-b;a.max_x=e+c;a.max_y=g+b;a.pooled=!1;return a}c=this.transform;null==c.parent?e=c.local_x:(c.sync(),e=c._x);c=this.transform;null==c.parent?g=c.local_y:(c.sync(),g=c._y);c=b;null==b&&(b=
1);null==c&&(c=1);null==g&&(g=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=g-b;a.max_x=e+c;a.max_y=g+b;return a},volume:function(){var a=this.local_radius,b=this.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);a*=b;return Math.PI*a*a},intersect:function(a){return ta.line_intersects_circle(a,this)},collides:function(a){return a.collide_circle(this)},collide_rect:function(a){return ta.rect_and_circle(a,this,!0)},collide_circle:function(a){return ta.circle_and_circle(a,this)},
collide_polygon:function(a){return ta.circle_and_polygon(this,a,!0)},__class__:Lb});var gd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Polygon"]=gd;gd.__name__=!0;gd.__interfaces__=[Ya];gd.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:gd};var Qa=function(a){this.pooled=!1;Sa.call(this);this.type=2;this._vertices=[];this._normals=
[];var b=eb.pool.get(),c=0,e=0,g=1,l=1;null==l&&(l=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);g*=.5;l*=.5;b.min_x=c-g;b.min_y=e-l;b.max_x=c+g;b.max_y=e+l;b.pooled=!1;this._bounds=b;this.transform.on_dirty=f(this,this.on_dirty);this.local_vertices=null==a?[]:a;this.count=this.local_vertices.length;if(null>this.local_vertices.length)for(a=this.local_vertices.length;null>a;)b=a++,c=this.local_vertices,e=new O(0,0),c[b]=e;this.dirty_bounds=this.dirty_vertices=!0};d["echo.shape.Polygon"]=Qa;Qa.__name__=
!0;Qa.__interfaces__=[ib];Qa.get=function(a,b,c,e,g,l,x){null==x&&(x=1);null==l&&(l=1);null==g&&(g=0);null==e&&(e=1);null==c&&(c=3);null==b&&(b=0);null==a&&(a=0);if(3>c)throw z.thrown("Polygons require 3 sides as a minimum");for(var m=Qa.pool.get(),d=2*Math.PI/c,f,h=[],p=0;p<c;){f=p++;f=f*d+.5*(Math.PI-d);var q=new O(Math.cos(f)*e,Math.sin(f)*e);h.push(q)}p=a;null==x&&(x=1);null==l&&(l=1);null==g&&(g=0);null==b&&(b=0);null==p&&(p=0);a=m.transform;a.dirty||a.set_dirty();a.local_x=p;a=m.transform;a.dirty||
a.set_dirty();a.local_y=b;a=m.transform;g*=Math.PI/180;a.dirty||a.set_dirty();a.local_radians=g;a=m.transform;a.dirty||a.set_dirty();a.local_scale_x=l;a=m.transform;a.dirty||a.set_dirty();a.local_scale_y=x;m.local_vertices=null==h?[]:h;m.count=m.local_vertices.length;if(null>m.local_vertices.length)for(p=m.local_vertices.length,c=null;p<c;)f=p++,h=m.local_vertices,q=new O(0,0),h[f]=q;m.dirty_vertices=!0;m.dirty_bounds=!0;m.pooled=!1;return m};Qa.__super__=Sa;Qa.prototype=B(Sa.prototype,{put:function(){Sa.prototype.put.call(this);
this.pooled||(this.pooled=!0,Qa.pool.put_unsafe(this))},bounds:function(a){if(this.dirty_bounds){this.dirty_bounds=!1;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var g=this._vertices,l=new O(0,0);g[e]=l}var x=this.local_vertices[e].x,m=this.local_vertices[e].y;null==m&&(m=0);null==x&&(x=0);g=this.transform.get_local_to_world_matrix();l=
x;x=g.m01*l+g.m11*m+1*g.m21;var d=this._vertices[e];d.x=g.m00*l+g.m10*m+1*g.m20;d.y=x}}b=0;for(c=this.count;b<c;)e=b++,d=this._vertices[(e+1)%this.count],l=d.x,m=d.y,g=this._vertices[e],m-=g.y,l-=g.x,x=-m,m=l,l=x,null==this._normals[e]?(g=this._normals,l=new O(l,m),g[e]=l):(g=this._normals[e],g.x=l,g.y=m),m=e=l=this._normals[e],m=m.x*m.x+m.y*m.y,m=0==m?1:Math.sqrt(m),g=l.y/m,e.x=l.x/m,e.y=g}d=this._vertices;l=d[0].x;m=d[0].y;g=d[0].x;x=d[0].y;b=1;for(c=this.count;b<c;)e=b++,d[e].x<l&&(l=d[e].x),d[e].y<
m&&(m=d[e].y),d[e].x>g&&(g=d[e].x),d[e].y>x&&(x=d[e].y);b=this._bounds;b.min_x=l;b.max_x=g;b.min_y=m;b.max_y=x}if(null==a)return b=this._bounds,a=b.min_x,c=b.min_y,e=b.max_x,l=b.max_y,b=eb.pool.get(),b.min_x=a,b.max_x=e,b.min_y=c,b.max_y=l,b.pooled=!1,b;b=this._bounds;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;return a},volume:function(){var a=0;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<
c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var g=this._vertices,l=new O(0,0);g[e]=l}var d=this.local_vertices[e].x,m=this.local_vertices[e].y;null==m&&(m=0);null==d&&(d=0);g=this.transform.get_local_to_world_matrix();l=d;var f=g.m01*l+g.m11*m+1*g.m21;d=this._vertices[e];d.x=g.m00*l+g.m10*m+1*g.m20;d.y=f}}b=0;for(c=this.count;b<c;)e=b++,d=this._vertices[(e+1)%this.count],l=d.x,m=d.y,g=this._vertices[e],m-=g.y,l-=g.x,d=-m,m=l,l=d,null==this._normals[e]?(g=this._normals,
l=new O(l,m),g[e]=l):(g=this._normals[e],g.x=l,g.y=m),m=e=l=this._normals[e],m=m.x*m.x+m.y*m.y,m=0==m?1:Math.sqrt(m),g=l.y/m,e.x=l.x/m,e.y=g}l=this._vertices;d=l[l.length-1];b=0;for(c=this.count;b<c;)e=b++,e=l[e],a+=e.x*d.y-d.x*e.y,d=e;return.5*Math.abs(a)},intersect:function(a){return ta.line_intersects_polygon(a,this)},collides:function(a){return a.collide_polygon(this)},collide_rect:function(a){return ta.rect_and_polygon(a,this,!0)},collide_circle:function(a){return ta.circle_and_polygon(a,this)},
collide_polygon:function(a){return ta.polygon_and_polygon(a,this,!0)},on_dirty:function(a){this.dirty_bounds=this.dirty_vertices=!0},__class__:Qa});var Pc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Rect"]=Pc;Pc.__name__=!0;Pc.__interfaces__=[Ya];Pc.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Pc};var Ib=function(){this.pooled=
!1;Sa.call(this);this.local_ex=0;if(null!=this.transformed_rect){var a=this.transformed_rect;a.count=4;for(var b=0,c=a.count;b<c;){var e=b++;if(null==a.local_vertices[e]){var g=a.local_vertices,l=new O(0,0);g[e]=l}}b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;
b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=this.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=this.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=
b;b=this.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.local_ey=0;if(null!=this.transformed_rect){a=this.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,l=new O(0,0),g[e]=l);b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*
this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=this.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;g.dirty||g.set_dirty();
g.local_radians=b;b=this.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=this.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.type=0;this.transform.on_dirty=f(this,this.on_dirty)};d["echo.shape.Rect"]=Ib;Ib.__name__=!0;Ib.__interfaces__=[ib];Ib.get=function(a,b,c,e,g,l,d){null==d&&(d=1);null==l&&(l=1);null==g&&(g=0);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var m=Ib.pool.get(),
x=b;null==d&&(d=1);null==l&&(l=1);null==g&&(g=0);null==e&&(e=0);null==c&&(c=1);null==x&&(x=0);null==a&&(a=0);b=m.transform;b.dirty||b.set_dirty();b.local_x=a;b=m.transform;b.dirty||b.set_dirty();b.local_y=x;a=.5*c;b=m.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);m.local_ex=a/b;if(null!=m.transformed_rect){b=m.transformed_rect;b.count=4;a=0;for(x=b.count;a<x;){var f=a++;if(null==b.local_vertices[f]){var h=b.local_vertices,p=new O(0,0);h[f]=p}}a=b.local_vertices[0];a.x=-(m.local_ex*
m.transform.local_scale_x);a.y=-(m.local_ey*m.transform.local_scale_y);a=b.local_vertices[1];a.x=m.local_ex*m.transform.local_scale_x;a.y=-(m.local_ey*m.transform.local_scale_y);a=b.local_vertices[2];a.x=m.local_ex*m.transform.local_scale_x;a.y=m.local_ey*m.transform.local_scale_y;a=b.local_vertices[3];a.x=-(m.local_ex*m.transform.local_scale_x);a.y=m.local_ey*m.transform.local_scale_y;a=m.transform.local_x;h=b.transform;h.dirty||h.set_dirty();h.local_x=a;a=m.transform.local_y;h=b.transform;h.dirty||
h.set_dirty();h.local_y=a;h=b.transform;a=Math.PI/180*(180/Math.PI)*m.transform.local_radians;h.dirty||h.set_dirty();h.local_radians=a;a=m.transform.local_scale_x;h=b.transform;h.dirty||h.set_dirty();h.local_scale_x=a;a=m.transform.local_scale_y;h=b.transform;h.dirty||h.set_dirty();h.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}a=.5*(0>=e?c:e);b=m.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);m.local_ey=a/b;if(null!=m.transformed_rect){b=m.transformed_rect;b.count=4;
a=0;for(x=b.count;a<x;)f=a++,null==b.local_vertices[f]&&(h=b.local_vertices,p=new O(0,0),h[f]=p);a=b.local_vertices[0];a.x=-(m.local_ex*m.transform.local_scale_x);a.y=-(m.local_ey*m.transform.local_scale_y);a=b.local_vertices[1];a.x=m.local_ex*m.transform.local_scale_x;a.y=-(m.local_ey*m.transform.local_scale_y);a=b.local_vertices[2];a.x=m.local_ex*m.transform.local_scale_x;a.y=m.local_ey*m.transform.local_scale_y;a=b.local_vertices[3];a.x=-(m.local_ex*m.transform.local_scale_x);a.y=m.local_ey*m.transform.local_scale_y;
a=m.transform.local_x;h=b.transform;h.dirty||h.set_dirty();h.local_x=a;a=m.transform.local_y;h=b.transform;h.dirty||h.set_dirty();h.local_y=a;h=b.transform;a=Math.PI/180*(180/Math.PI)*m.transform.local_radians;h.dirty||h.set_dirty();h.local_radians=a;a=m.transform.local_scale_x;h=b.transform;h.dirty||h.set_dirty();h.local_scale_x=a;a=m.transform.local_scale_y;h=b.transform;h.dirty||h.set_dirty();h.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}b=m.transform;a=Math.PI/180*g;b.dirty||b.set_dirty();
b.local_radians=a;b=m.transform;b.dirty||b.set_dirty();b.local_scale_x=l;b=m.transform;b.dirty||b.set_dirty();b.local_scale_y=d;null==m.transformed_rect?(b=m.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*b._radians),c=0!=c):c=!1;if(c){c=Qa.pool.get();c.count=4;a=0;for(x=c.count;a<x;)f=a++,null==c.local_vertices[f]&&(e=c.local_vertices,p=new O(0,0),e[f]=p);a=c.local_vertices[0];a.x=-(m.local_ex*m.transform.local_scale_x);a.y=-(m.local_ey*m.transform.local_scale_y);
a=c.local_vertices[1];a.x=m.local_ex*m.transform.local_scale_x;a.y=-(m.local_ey*m.transform.local_scale_y);a=c.local_vertices[2];a.x=m.local_ex*m.transform.local_scale_x;a.y=m.local_ey*m.transform.local_scale_y;a=c.local_vertices[3];a.x=-(m.local_ex*m.transform.local_scale_x);a.y=m.local_ey*m.transform.local_scale_y;a=m.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=a;a=m.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=a;b=c.transform;a=Math.PI/180*(180/Math.PI)*
m.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=a;a=m.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=a;a=m.transform.local_scale_y;b=c.transform;b.dirty||b.set_dirty();b.local_scale_y=a;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;m.transformed_rect=c;m.transformed_rect.set_parent(m.parent)}else null!=m.transformed_rect&&(a=m.transform.local_x,b=m.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=a,a=m.transform.local_y,b=m.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_y=a,b=m.transformed_rect.transform,a=Math.PI/180*(180/Math.PI)*m.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=a,a=m.transform.local_scale_x,b=m.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=a,a=m.transform.local_scale_y,b=m.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=a);m.pooled=!1;return m};Ib.__super__=Sa;Ib.prototype=B(Sa.prototype,{put:function(){Sa.prototype.put.call(this);null!=this.transformed_rect&&
(this.transformed_rect.put(),this.transformed_rect=null);this.pooled||(this.pooled=!0,Ib.pool.put_unsafe(this))},to_aabb:function(a){null==a&&(a=!1);if(a){a=null;if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;b=0!=c}else b=!1;if(b)a=this.transformed_rect.bounds(a);else if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),
c=b._y);var g=2*this.local_ex;b=this.transform;if(null==b.parent)var l=b.local_scale_x;else b.sync(),l=b._scale_x;g*=l;l=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);l*=b;null==l&&(l=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);b=eb.pool.get();null==l&&(l=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;l*=.5;b.min_x=e-g;b.min_y=c-l;b.max_x=e+g;b.max_y=c+l;b.pooled=!1;a=b}else b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,
null==b.parent?c=b.local_y:(b.sync(),c=b._y),g=2*this.local_ex,b=this.transform,null==b.parent?l=b.local_scale_x:(b.sync(),l=b._scale_x),g*=l,l=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),l*=b,null==l&&(l=1),null==g&&(g=1),null==c&&(c=0),null==e&&(e=0),g*=.5,l*=.5,a.min_x=e-g,a.min_y=c-l,a.max_x=e+g,a.max_y=c+l;this.put();return a}a=null;null!=this.transformed_rect?(b=this.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*
b._radians),c=0!=c):c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a)return b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,null==b.parent?c=b.local_y:(b.sync(),c=b._y),g=2*this.local_ex,b=this.transform,null==b.parent?l=b.local_scale_x:(b.sync(),l=b._scale_x),g*=l,l=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),l*=b,null==l&&(l=1),null==g&&(g=1),null==c&&(c=0),null==e&&(e=0),a=eb.pool.get(),null==l&&(l=1),null==
g&&(g=1),null==c&&(c=0),null==e&&(e=0),g*=.5,l*=.5,a.min_x=e-g,a.min_y=c-l,a.max_x=e+g,a.max_y=c+l,a.pooled=!1,a;b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);g=2*this.local_ex;b=this.transform;null==b.parent?l=b.local_scale_x:(b.sync(),l=b._scale_x);g*=l;l=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);l*=b;null==l&&(l=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;l*=.5;
a.min_x=e-g;a.min_y=c-l;a.max_x=e+g;a.max_y=c+l;return a},bounds:function(a){if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;c=0!=c}else c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);var g=2*this.local_ex;b=this.transform;if(null==b.parent)var l=b.local_scale_x;
else b.sync(),l=b._scale_x;g*=l;l=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);l*=b;null==l&&(l=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);a=eb.pool.get();null==l&&(l=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;l*=.5;a.min_x=e-g;a.min_y=c-l;a.max_x=e+g;a.max_y=c+l;a.pooled=!1;return a}b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);g=2*this.local_ex;b=this.transform;
null==b.parent?l=b.local_scale_x:(b.sync(),l=b._scale_x);g*=l;l=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);l*=b;null==l&&(l=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;l*=.5;a.min_x=e-g;a.min_y=c-l;a.max_x=e+g;a.max_y=c+l;return a},volume:function(){var a=2*this.local_ex,b=this.transform;if(null==b.parent)var c=b.local_scale_x;else b.sync(),c=b._scale_x;var e=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);
return a*c*e*b},intersect:function(a){return ta.line_intersects_rect(a,this)},collides:function(a){return a.collide_rect(this)},collide_rect:function(a){return ta.rect_and_rect(a,this)},collide_circle:function(a){return ta.rect_and_circle(this,a)},collide_polygon:function(a){return ta.rect_and_polygon(this,a)},set_parent:function(a){Sa.prototype.set_parent.call(this,a);if(null==this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*
b._radians;c=0!=c}else c=!1;if(c){c=Qa.pool.get();c.count=4;b=0;for(var e=c.count;b<e;){var g=b++;if(null==c.local_vertices[g]){var l=c.local_vertices,d=new O(0,0);l[g]=d}}e=c.local_vertices[0];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[1];e.x=this.local_ex*this.transform.local_scale_x;e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[2];e.x=this.local_ex*this.transform.local_scale_x;e.y=this.local_ey*this.transform.local_scale_y;
e=c.local_vertices[3];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=this.local_ey*this.transform.local_scale_y;e=this.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=e;e=this.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=e;b=c.transform;e=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=e;e=this.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=e;e=this.transform.local_scale_y;b=c.transform;
b.dirty||b.set_dirty();b.local_scale_y=e;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;this.transformed_rect=c;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(e=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=e,e=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=e,b=this.transformed_rect.transform,e=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=
e,e=this.transform.local_scale_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=e,e=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=e);null!=this.transformed_rect&&this.transformed_rect.set_parent(a)},on_dirty:function(a){if(null==this.transformed_rect){var b=this.transform;null==b.parent?a=180/Math.PI*b.local_radians:(b.sync(),a=180/Math.PI*b._radians);a=0!=a}else a=!1;if(a){a=Qa.pool.get();a.count=4;b=0;for(var c=a.count;b<
c;){var e=b++;if(null==a.local_vertices[e]){var g=a.local_vertices,l=new O(0,0);g[e]=l}}c=a.local_vertices[0];c.x=-(this.local_ex*this.transform.local_scale_x);c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[1];c.x=this.local_ex*this.transform.local_scale_x;c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[2];c.x=this.local_ex*this.transform.local_scale_x;c.y=this.local_ey*this.transform.local_scale_y;c=a.local_vertices[3];c.x=-(this.local_ex*this.transform.local_scale_x);
c.y=this.local_ey*this.transform.local_scale_y;c=this.transform.local_x;b=a.transform;b.dirty||b.set_dirty();b.local_x=c;c=this.transform.local_y;b=a.transform;b.dirty||b.set_dirty();b.local_y=c;b=a.transform;c=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=c;c=this.transform.local_scale_x;b=a.transform;b.dirty||b.set_dirty();b.local_scale_x=c;c=this.transform.local_scale_y;b=a.transform;b.dirty||b.set_dirty();b.local_scale_y=c;a.dirty_vertices=!0;a.dirty_bounds=
!0;a.pooled=!1;this.transformed_rect=a;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(c=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=c,c=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=c,b=this.transformed_rect.transform,c=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=c,c=this.transform.local_scale_x,b=this.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_scale_x=c,c=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=c)},__class__:Ib});var Fc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_util_AABB"]=Fc;Fc.__name__=!0;Fc.__interfaces__=[Ya];Fc.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Fc};var eb=
function(){this.pooled=!1;this.min_x=0;this.max_x=1;this.min_y=0;this.max_y=1};d["echo.util.AABB"]=eb;eb.__name__=!0;eb.__interfaces__=[ib];eb.prototype={put:function(){this.pooled||(this.pooled=!0,eb.pool.put_unsafe(this))},__class__:eb};var Ue={_new:function(a){null==a&&(a=0);return a}},Gc=function(){this.shape_fill_alpha=0;this.draw_quadtree=!0;this.draw_body_centers=this.draw_bounds=this.draw_shape_bounds=!1;this.draw_bodies=!0};d["echo.util.Debug"]=Gc;Gc.__name__=!0;Gc.prototype={draw_line:function(a,
b,c,e,g,l){},draw_rect:function(a,b,c,e,g,l,d){},draw_circle:function(a,b,c,e,g,l){},clear:function(){},draw:function(a,b){null==b&&(b=!0);b&&this.clear();this.draw_quadtree&&(this.draw_qd(a.static_quadtree),this.draw_qd(a.quadtree));if(this.draw_bodies)for(b=0,a=a.members;b<a.length;){var c=a[b];++b;a:if(0!=c.shapes.length){if(null!=this.camera){var e=c.bounds(),g=this.camera;g=e.min_x<g.max_x&&e.max_x>=g.min_x&&e.min_y<g.max_y&&e.max_y>=g.min_y;e.put();if(!g)break a}this.draw_body_centers&&this.draw_rect(c.transform.local_x-
1,c.transform.local_y-1,1,1,this.quadtree_color);e=0;for(g=c.shapes;e<g.length;){var l=g[e];++e;this.draw_shape(l)}this.draw_bounds&&(c=c.bounds(),this.draw_rect(c.min_x,c.min_y,c.max_x-c.min_x,c.max_y-c.min_y,this.shape_fill_color,this.shape_color,0),c.put())}}},draw_shape:function(a){var b=a.transform;b.sync();var c=b._x,e=b._y;switch(a.type){case 0:if(null!=a.transformed_rect){b=a.transform;if(null==b.parent)var g=180/Math.PI*b.local_radians;else b.sync(),g=180/Math.PI*b._radians;var l=0!=g}else l=
!1;if(l){l=a.transformed_rect.count;b=a.transformed_rect;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();c=0;for(e=b.count;c<e;)if(g=c++,null!=b.local_vertices[g]){if(null==b._vertices[g]){var d=b._vertices,m=new O(0,0);d[g]=m}d=b.local_vertices[g].x;var f=b.local_vertices[g].y;null==f&&(f=0);null==d&&(d=0);var h=b.transform.get_local_to_world_matrix();m=d;var p=1;d=h.m00*m+h.m10*f+h.m20*p;f=h.m01*m+h.m11*f+h.m21*p;m=d;d=f;f=b._vertices[g];f.x=m;f.y=d}c=
0;for(e=b.count;c<e;)g=c++,f=b._vertices[(g+1)%b.count],m=f.x,f=f.y,d=b._vertices[g],m-=d.x,f-=d.y,d=-f,f=m,m=d,null==b._normals[g]?(d=b._normals,m=new O(m,f),d[g]=m):(h=b._normals[g],h.x=m,h.y=f),f=g=m=b._normals[g],f=f.x*f.x+f.y*f.y,d=0==f?1:Math.sqrt(f),f=m.x/d,m=m.y/d,g.x=f,g.y=m}this.draw_polygon(l,b._vertices,this.shape_fill_color,a.collided?this.shape_collided_color:this.shape_color,this.shape_fill_alpha);this.draw_shape_bounds&&(d=a.transformed_rect.bounds(),this.draw_rect(d.min_x,d.min_y,
d.max_x-d.min_x,d.max_y-d.min_y,this.shape_fill_color,a.collided?this.shape_collided_color:this.shape_color,0),d.put())}else l=2*a.local_ex,b=a.transform,null==b.parent?g=b.local_scale_x:(b.sync(),g=b._scale_x),m=2*a.local_ey,b=a.transform,null==b.parent?f=b.local_scale_y:(b.sync(),f=b._scale_y),d=2*a.local_ex,b=a.transform,null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x),p=2*a.local_ey,b=a.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),this.draw_rect(c-l*g*.5,e-m*f*.5,
d*h,p*b,this.shape_fill_color,a.collided?this.shape_collided_color:this.shape_color,0);break;case 1:g=a.local_radius;b=a.transform;null==b.parent?l=b.local_scale_x:(b.sync(),l=b._scale_x);this.draw_circle(c,e,g*l,this.shape_fill_color,a.collided?this.shape_collided_color:this.shape_color,this.shape_fill_alpha);this.draw_shape_bounds&&(g=a.local_radius,b=a.transform,null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x),e=g*b*2,b=a.transform,null==b.parent?d=b.local_x:(b.sync(),d=b._x),b=a.transform,
null==b.parent?f=b.local_y:(b.sync(),f=b._y),c=e,null==e&&(e=1),null==c&&(c=1),null==f&&(f=0),null==d&&(d=0),b=eb.pool.get(),l=d,g=f,null==e&&(e=1),null==c&&(c=1),null==g&&(g=0),null==l&&(l=0),c*=.5,e*=.5,b.min_x=l-c,b.min_y=g-e,b.max_x=l+c,b.max_y=g+e,b.pooled=!1,d=b,this.draw_rect(d.min_x,d.min_y,d.max_x-d.min_x,d.max_y-d.min_y,this.shape_fill_color,a.collided?this.shape_collided_color:this.shape_color,0),d.put());break;case 2:b=a.count;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>
a.count;)a._vertices.pop();c=0;for(e=a.count;c<e;)g=c++,null!=a.local_vertices[g]&&(null==a._vertices[g]&&(l=a._vertices,m=new O(0,0),l[g]=m),d=a.local_vertices[g].x,f=a.local_vertices[g].y,null==f&&(f=0),null==d&&(d=0),h=a.transform.get_local_to_world_matrix(),m=d,p=1,d=h.m00*m+h.m10*f+h.m20*p,f=h.m01*m+h.m11*f+h.m21*p,m=d,d=f,f=a._vertices[g],f.x=m,f.y=d);c=0;for(e=a.count;c<e;)g=c++,f=a._vertices[(g+1)%a.count],m=f.x,f=f.y,d=a._vertices[g],m-=d.x,f-=d.y,d=-f,f=m,m=d,null==a._normals[g]?(l=a._normals,
m=new O(m,f),l[g]=m):(h=a._normals[g],h.x=m,h.y=f),f=g=m=a._normals[g],f=f.x*f.x+f.y*f.y,d=0==f?1:Math.sqrt(f),f=m.x/d,m=m.y/d,g.x=f,g.y=m}this.draw_polygon(b,a._vertices,this.shape_fill_color,a.collided?this.shape_collided_color:this.shape_color,this.shape_fill_alpha);this.draw_shape_bounds&&(d=a.bounds(),this.draw_rect(d.min_x,d.min_y,d.max_x-d.min_x,d.max_y-d.min_y,this.shape_fill_color,a.collided?this.shape_collided_color:this.shape_color,0),d.put())}},draw_polygon:function(a,b,c,e,g){if(!(2>
a)){for(c=1;c<a;)g=c++,this.draw_line(b[g-1].x,b[g-1].y,b[g].x,b[g].y,e,1);--a;this.draw_line(b[a].x,b[a].y,b[0].x,b[0].y,e,1)}},draw_qd:function(a){var b=0;for(a=a.children;b<a.length;){var c=a[b];++b;null!=c&&(this.draw_rect(c.min_x,c.min_y,c.max_x-c.min_x,c.max_y-c.min_y,this.quadtree_fill_color,this.quadtree_color,.1),this.draw_qd(c))}},__class__:Gc};var hd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_util_QuadTree"]=hd;hd.__name__=!0;hd.__interfaces__=[Ya];
hd.prototype={get:function(){return 0==this.count?ea.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:hd};var ge=function(a){this.re=new Cd(a);this.un=new Cd(a)};d["echo.util.History_Array_echo_data_BodyState"]=ge;ge.__name__=!0;ge.prototype={redo:function(){var a=this.re.pop();null!=a&&this.un.push(a);return a},undo:function(){var a=this.un.pop();null!=a&&this.re.push(a);return a},add:function(a){this.un.push(a);this.re.reset()},
__class__:ge};var cd=function(){};d["echo.util.JSON"]=cd;cd.__name__=!0;cd.copy_fields=function(a,b){if(null==a)return b;if(null==b)b=C.copy(a);else for(var c=0,e=C.fields(a);c<e.length;){var g=e[c];++c;b[g]=C.field(a,g)}return b};var La=function(a,b){null==b&&(b=0);this.nodes_list=[];this.max_contents=10;this.max_depth=5;eb.call(this);null!=a&&(this.min_x=a.min_x,this.max_x=a.max_x,this.min_y=a.min_y,this.max_y=a.max_y);this.depth=b;this.children=Array(4);this.contents=[];this.contents_count=0};
d["echo.util.QuadTree"]=La;La.__name__=!0;La.__super__=eb;La.prototype=B(eb.prototype,{put:function(){if(!this.pooled){this.pooled=!0;for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){for(var e=this.children[c],g=0,l=e.children.length;g<l;){var d=g++;null!=e.children[d]&&(e.children[d].clear_children(),e.children[d].put(),e.children[d]=null)}this.children[c].put();this.children[c]=null}}this.contents_count=this.contents.length=0;this.nodes_list.length=0;La.pool.put_unsafe(this)}},
insert:function(a){if(null!=a.bounds){var b=a.bounds;if(b.min_x<this.max_x&&b.max_x>=this.min_x&&b.min_y<this.max_y&&b.max_y>=this.min_y)if(null==this.children[0]&&this.contents_count+1>this.max_contents&&this.split(),null==this.children[0])b=this.get_first_null(this.contents),-1==b?this.contents.push(a):this.contents[b]=a,this.contents_count++;else{b=0;for(var c=this.children;b<c.length;){var e=c[b];++b;e.insert(a)}}}},remove:function(a,b){null==b&&(b=!0);if(null==this.children[0]){for(b=0;b<this.contents.length;){if(null!=
this.contents[b]&&this.contents[b].id==a.id)return this.contents[b]=null,this.contents_count--,!0;++b}return!1}for(var c=!1,e=0,g=this.children;e<g.length;){var l=g[e];++e;null!=l&&l.remove(a)&&(c=!0)}b&&c&&this.shake();return c},update:function(a,b){null==b&&(b=!0);this.remove(a,b);this.insert(a)},query:function(a,b){if(this.min_x<a.max_x&&this.max_x>=a.min_x&&this.min_y<a.max_y&&this.max_y>=a.min_y)if(null==this.children[0])for(var c=0,e=this.contents;c<e.length;){var g=e[c];++c;if(null!=g){var l=
g.bounds;l=l.min_x<a.max_x&&l.max_x>=a.min_x&&l.min_y<a.max_y&&l.max_y>=a.min_y}else l=!1;l&&b.push(g)}else for(c=0,e=this.children;c<e.length;)g=e[c],++c,g.query(a,b)},shake:function(){if(null==this.children[0])return!1;var a=this.get_count();if(0==a){a=0;for(var b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){for(var e=this.children[c],g=0,l=e.children.length;g<l;){var d=g++;if(null!=e.children[d]){e.children[d].clear_children();var m=e.children[d];if(!m.pooled){m.pooled=!0;for(var f=
0,h=m.children.length;f<h;){var p=f++;if(null!=m.children[p]){for(var r=m.children[p],q=0,n=r.children.length;q<n;){var A=q++;null!=r.children[A]&&(r.children[A].clear_children(),r.children[A].put(),r.children[A]=null)}m.children[p].put();m.children[p]=null}}m.contents.length=0;m.contents_count=0;m.nodes_list.length=0;La.pool.put_unsafe(m)}e.children[d]=null}}g=this.children[c];if(!g.pooled){g.pooled=!0;l=0;for(e=g.children.length;l<e;)if(d=l++,null!=g.children[d]){m=g.children[d];f=0;for(h=m.children.length;f<
h;)if(p=f++,null!=m.children[p]){r=m.children[p];q=0;for(n=r.children.length;q<n;)A=q++,null!=r.children[A]&&(r.children[A].clear_children(),r.children[A].put(),r.children[A]=null);m.children[p].put();m.children[p]=null}g.children[d].put();g.children[d]=null}g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;La.pool.put_unsafe(g)}this.children[c]=null}}}else if(a<this.max_contents){this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;)if(b=this.nodes_list.shift(),
b!=this&&null==b.children[0])for(a=0,b=b.contents;a<b.length;)c=b[a],++a,-1==this.contents.indexOf(c)&&(g=this.get_first_null(this.contents),-1==g?this.contents.push(c):this.contents[g]=c,this.contents_count++);else for(g=0,l=b.children;g<l.length;)a=l[g],++g,this.nodes_list.push(a);a=0;for(b=this.children.length;a<b;)if(c=a++,null!=this.children[c]){e=this.children[c];g=0;for(l=e.children.length;g<l;)if(d=g++,null!=e.children[d]){e.children[d].clear_children();m=e.children[d];if(!m.pooled){m.pooled=
!0;f=0;for(h=m.children.length;f<h;)if(p=f++,null!=m.children[p]){r=m.children[p];q=0;for(n=r.children.length;q<n;)A=q++,null!=r.children[A]&&(r.children[A].clear_children(),r.children[A].put(),r.children[A]=null);m.children[p].put();m.children[p]=null}m.contents.length=0;m.contents_count=0;m.nodes_list.length=0;La.pool.put_unsafe(m)}e.children[d]=null}g=this.children[c];if(!g.pooled){g.pooled=!0;l=0;for(e=g.children.length;l<e;)if(d=l++,null!=g.children[d]){m=g.children[d];f=0;for(h=m.children.length;f<
h;)if(p=f++,null!=m.children[p]){r=m.children[p];q=0;for(n=r.children.length;q<n;)A=q++,null!=r.children[A]&&(r.children[A].clear_children(),r.children[A].put(),r.children[A]=null);m.children[p].put();m.children[p]=null}g.children[d].put();g.children[d]=null}g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;La.pool.put_unsafe(g)}this.children[c]=null}return!0}return!1},split:function(){if(!(this.depth+1>=this.max_depth)){for(var a=.5*(this.max_x-this.min_x),b=.5*(this.max_y-this.min_y),
c=0;4>c;){var e=c++,g=La.pool.get(),l=0,d=0,m=1,f=1;null==f&&(f=1);null==m&&(m=1);null==d&&(d=0);null==l&&(l=0);m*=.5;f*=.5;g.min_x=l-m;g.min_y=d-f;g.max_x=l+m;g.max_y=d+f;l=0;for(d=g.children.length;l<d;)if(m=l++,null!=g.children[m]){f=g.children[m];for(var h=0,p=f.children.length;h<p;){var r=h++;if(null!=f.children[r]){f.children[r].clear_children();var q=f.children[r];if(!q.pooled){q.pooled=!0;for(var n=0,A=q.children.length;n<A;){var k=n++;if(null!=q.children[k]){for(var w=q.children[k],y=0,J=
w.children.length;y<J;){var z=y++;null!=w.children[z]&&(w.children[z].clear_children(),w.children[z].put(),w.children[z]=null)}q.children[k].put();q.children[k]=null}}q.contents.length=0;q.contents_count=0;q.nodes_list.length=0;La.pool.put_unsafe(q)}f.children[r]=null}}f=g.children[m];if(!f.pooled){f.pooled=!0;h=0;for(p=f.children.length;h<p;)if(r=h++,null!=f.children[r]){q=f.children[r];n=0;for(A=q.children.length;n<A;)if(k=n++,null!=q.children[k]){w=q.children[k];y=0;for(J=w.children.length;y<J;)z=
y++,null!=w.children[z]&&(w.children[z].clear_children(),w.children[z].put(),w.children[z]=null);q.children[k].put();q.children[k]=null}f.children[r].put();f.children[r]=null}f.contents.length=0;f.contents_count=0;f.nodes_list.length=0;La.pool.put_unsafe(f)}g.children[m]=null}g.contents.length=0;g.contents_count=0;g.pooled=!1;switch(e){case 0:l=this.min_x+a;d=this.min_y+b;g.min_x=this.min_x;g.max_x=l;g.min_y=this.min_y;g.max_y=d;break;case 1:l=this.min_y+b;g.min_x=this.min_x+a;g.max_x=this.max_x;
g.min_y=this.min_y;g.max_y=l;break;case 2:l=this.min_x+a;g.min_x=this.min_x;g.max_x=l;g.min_y=this.min_y+b;g.max_y=this.max_y;break;case 3:g.min_x=this.min_x+a,g.max_x=this.max_x,g.min_y=this.min_y+b,g.max_y=this.max_y}g.depth=this.depth+1;l=this.max_depth;d=0;for(m=g.children.length;d<m;)if(f=d++,null!=g.children[f]){f=g.children[f];h=0;for(p=f.children.length;h<p;)r=h++,null!=f.children[r]&&f.children[r].set_max_depth(l);f.max_depth=l}g.max_depth=l;l=this.max_contents;d=0;for(m=g.children.length;d<
m;)if(f=d++,null!=g.children[f]){f=g.children[f];h=0;for(p=f.children.length;h<p;)if(r=h++,null!=f.children[r]){r=f.children[r];q=0;for(n=r.children.length;q<n;)A=q++,null!=r.children[A]&&r.children[A].set_max_depth(l);r.max_depth=l}f.max_depth=l}g.max_contents=l;g.shake();l=0;for(d=this.contents.length;l<d;)m=l++,null!=this.contents[m]&&g.insert(this.contents[m]);this.children[e]=g}this.contents_count=this.contents.length=0}},clear_children:function(){for(var a=0,b=this.children.length;a<b;){var c=
a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];if(!e.pooled){e.pooled=!0;for(var g=0,l=e.children.length;g<l;){var d=g++;if(null!=e.children[d]){for(var m=e.children[d],f=0,h=m.children.length;f<h;){var p=f++;null!=m.children[p]&&(m.children[p].clear_children(),m.children[p].put(),m.children[p]=null)}e.children[d].put();e.children[d]=null}}e.contents.length=0;e.contents_count=0;e.nodes_list.length=0;La.pool.put_unsafe(e)}this.children[c]=null}}},reset_data_flags:function(){for(var a=
0,b=this.contents.length;a<b;){var c=a++;null!=this.contents[c]&&(this.contents[c].flag=!1)}a=0;for(b=this.children.length;a<b;)c=a++,null!=this.children[c]&&this.children[c].reset_data_flags()},get_count:function(){this.reset_data_flags();for(var a=0,b=0,c=this.contents.length;b<c;){var e=b++;null!=this.contents[e]&&(this.contents[e].flag=!0,++a)}this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;){var g=this.nodes_list.shift();if(null==g.children[0])for(b=0,c=g.contents.length;b<
c;)e=b++,null==g.contents[e]||g.contents[e].flag||(++a,g.contents[e].flag=!0);else for(b=0,c=g.children.length;b<c;)e=b++,this.nodes_list.push(g.children[e])}return a},get_first_null:function(a){for(var b=0,c=a.length;b<c;){var e=b++;if(null==a[e])return e}return-1},set_max_depth:function(a){for(var b=0,c=this.children.length;b<c;){var e=b++;null!=this.children[e]&&this.children[e].set_max_depth(a)}return this.max_depth=a},__class__:La,__properties__:{get_count:"get_count",set_max_depth:"set_max_depth"}});
var Cd=function(a){this.a=Array(a);this.reset()};d["echo.util.Ring_Array_echo_data_BodyState"]=Cd;Cd.__name__=!0;Cd.prototype={pop:function(){if(0>=this.i+this.left-this.start)return null;0==this.i&&(this.i=this.a.length,this.left=0);return this.a[--this.i]},push:function(a){this.i==this.a.length&&(0<this.left&&this.start==this.i&&(this.start=0),this.i=0,this.left=this.a.length);this.i+this.left-this.start==this.a.length&&this.start++;this.a[this.i++]=a},reset:function(){this.left=this.start=this.i=
0},__class__:Cd};var ta=function(){};d["echo.util.SAT"]=ta;ta.__name__=!0;ta.line_intersects_rect=function(a,b){if(null!=b.transformed_rect){var c=b.transform;if(null==c.parent)var e=180/Math.PI*c.local_radians;else c.sync(),e=180/Math.PI*c._radians;var g=0!=e}else g=!1;if(g)return b.transformed_rect.intersect(a);var l=null;if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var d=180/Math.PI*c.local_radians;else c.sync(),d=180/Math.PI*c._radians;var m=0==d}else m=!0;if(m){c=b.transform;
null==c.parent?m=c.local_x:(c.sync(),m=c._x);var f=m-b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var h=0,p=c.count;h<p;){var r=h++;if(null!=c.local_vertices[r]){if(null==c._vertices[r]){var q=c._vertices,n=new O(0,0);q[r]=n}var A=c.local_vertices[r].x,w=c.local_vertices[r].y;null==w&&(w=0);null==A&&(A=0);var k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*
y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[r];u.x=B;u.y=ea}}h=0;for(p=c.count;h<p;){r=h++;u=c._vertices[(r+1)%c.count];y=u.x;J=u.y;var t=c._vertices[r],ma=y-t.x,C=J-t.y;y=ma;J=C;A=-J;J=y;y=A;null==c._normals[r]?(q=c._normals,n=new O(y,J),q[r]=n):(k=c._normals[r],k.x=y,k.y=J);var G=c._normals[r],I=G,D=G,U=D,F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E;I.x=M;I.y=ha}}m=null==c._vertices[0]}else m=!0;if(m)q=c.transform,null==q.parent?f=q.local_x:(q.sync(),
f=q._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();h=0;for(p=c.count;h<p;)r=h++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(q=c._vertices,n=new O(0,0),q[r]=n),A=c.local_vertices[r].x,w=c.local_vertices[r].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[r],u.x=B,u.y=ea);h=0;for(p=c.count;h<p;)r=h++,u=c._vertices[(r+1)%c.count],
y=u.x,J=u.y,t=c._vertices[r],ma=y-t.x,C=J-t.y,y=ma,J=C,A=-J,J=y,y=A,null==c._normals[r]?(q=c._normals,n=new O(y,J),q[r]=n):(k=c._normals[r],k.x=y,k.y=J),U=D=I=G=c._normals[r],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}m=c._vertices[0].x;h=1;for(p=c.count;h<p;){r=h++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var H=0,hb=c.count;H<hb;){var S=H++;null!=c.local_vertices[S]&&(null==c._vertices[S]&&(q=c._vertices,n=
new O(0,0),q[S]=n),A=c.local_vertices[S].x,w=c.local_vertices[S].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[S],u.x=B,u.y=ea)}for(var qa=0,sb=c.count;qa<sb;){var da=qa++;G=c._vertices[(da+1)%c.count];var Q=G.x,L=G.y;t=c._vertices[da];ma=Q-t.x;C=L-t.y;Q=ma;L=C;var P=-L;L=Q;Q=P;if(null==c._normals[da]){var ra=c._normals,R=new O(Q,L);ra[da]=R}else{var fa=c._normals[da];fa.x=Q;fa.y=L}var Fb=
c._normals[da];U=D=I=Fb;F=U.x*U.x+U.y*U.y;K=0==F?1:Math.sqrt(F);Va=D.x/K;E=D.y/K;M=Va;ha=E;I.x=M;I.y=ha}}if(c._vertices[r].x<m){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var Z=0,W=c.count;Z<W;){var Y=Z++;if(null!=c.local_vertices[Y]){if(null==c._vertices[Y]){var ba=c._vertices,gb=new O(0,0);ba[Y]=gb}var ca=c.local_vertices[Y].x,V=c.local_vertices[Y].y;null==V&&(V=0);null==ca&&(ca=0);var T=c.transform.get_local_to_world_matrix(),Ja=ca,ja=V,la=1,
ka=T.m00*Ja+T.m10*ja+T.m20*la,Ua=T.m01*Ja+T.m11*ja+T.m21*la,Xa=ka,Ba=Ua,pa=c._vertices[Y];pa.x=Xa;pa.y=Ba}}for(var ib=0,va=c.count;ib<va;){var tb=ib++,ua=c._vertices[(tb+1)%c.count],aa=ua.x,ub=ua.y,Da=c._vertices[tb],Aa=aa-Da.x,na=ub-Da.y;aa=Aa;ub=na;var oa=-ub;ub=aa;aa=oa;if(null==c._normals[tb]){var sa=c._normals,ya=new O(aa,ub);sa[tb]=ya}else{var wa=c._normals[tb];wa.x=aa;wa.y=ub}var Ga=c._normals[tb],Ia=Ga,Ca=Ga,xa=Ca,Na=xa.x*xa.x+xa.y*xa.y,za=0==Na?1:Math.sqrt(Na),La=Ca.x/za,Oa=Ca.y/za,Ha=La,
Ma=Oa;Ia.x=Ha;Ia.y=Ma}}m=c._vertices[r].x}}f=m}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var Ra=180/Math.PI*c.local_radians;else c.sync(),Ra=180/Math.PI*c._radians;var Fa=0==Ra}else Fa=!0;if(Fa){c=b.transform;null==c.parent?Fa=c.local_x:(c.sync(),Fa=c._x);var Pa=Fa+b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();h=0;for(p=c.count;h<p;)r=h++,null!=c.local_vertices[r]&&
(null==c._vertices[r]&&(q=c._vertices,n=new O(0,0),q[r]=n),A=c.local_vertices[r].x,w=c.local_vertices[r].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[r],u.x=B,u.y=ea);h=0;for(p=c.count;h<p;)r=h++,u=c._vertices[(r+1)%c.count],y=u.x,J=u.y,t=c._vertices[r],ma=y-t.x,C=J-t.y,y=ma,J=C,A=-J,J=y,y=A,null==c._normals[r]?(q=c._normals,n=new O(y,J),q[r]=n):(k=c._normals[r],k.x=y,k.y=J),U=D=I=G=
c._normals[r],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}Fa=null==c._vertices[0]}else Fa=!0;if(Fa)q=c.transform,null==q.parent?Pa=q.local_x:(q.sync(),Pa=q._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();h=0;for(p=c.count;h<p;)r=h++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(q=c._vertices,n=new O(0,0),q[r]=n),A=c.local_vertices[r].x,w=c.local_vertices[r].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),
y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[r],u.x=B,u.y=ea);h=0;for(p=c.count;h<p;)r=h++,u=c._vertices[(r+1)%c.count],y=u.x,J=u.y,t=c._vertices[r],ma=y-t.x,C=J-t.y,y=ma,J=C,A=-J,J=y,y=A,null==c._normals[r]?(q=c._normals,n=new O(y,J),q[r]=n):(k=c._normals[r],k.x=y,k.y=J),U=D=I=G=c._normals[r],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}Fa=c._vertices[0].x;h=1;for(p=c.count;h<p;){r=h++;if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();H=0;for(hb=c.count;H<hb;)S=H++,null!=c.local_vertices[S]&&(null==c._vertices[S]&&(q=c._vertices,n=new O(0,0),q[S]=n),A=c.local_vertices[S].x,w=c.local_vertices[S].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[S],u.x=B,u.y=ea);qa=0;for(sb=c.count;qa<sb;)da=qa++,G=c._vertices[(da+1)%c.count],Q=G.x,L=G.y,t=c._vertices[da],ma=Q-t.x,C=L-t.y,
Q=ma,L=C,P=-L,L=Q,Q=P,null==c._normals[da]?(ra=c._normals,R=new O(Q,L),ra[da]=R):(fa=c._normals[da],fa.x=Q,fa.y=L),U=D=I=Fb=c._normals[da],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}if(c._vertices[r].x>Fa){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();Z=0;for(W=c.count;Z<W;)Y=Z++,null!=c.local_vertices[Y]&&(null==c._vertices[Y]&&(ba=c._vertices,gb=new O(0,0),ba[Y]=gb),ca=c.local_vertices[Y].x,V=c.local_vertices[Y].y,
null==V&&(V=0),null==ca&&(ca=0),T=c.transform.get_local_to_world_matrix(),Ja=ca,ja=V,la=1,ka=T.m00*Ja+T.m10*ja+T.m20*la,Ua=T.m01*Ja+T.m11*ja+T.m21*la,Xa=ka,Ba=Ua,pa=c._vertices[Y],pa.x=Xa,pa.y=Ba);ib=0;for(va=c.count;ib<va;)tb=ib++,ua=c._vertices[(tb+1)%c.count],aa=ua.x,ub=ua.y,Da=c._vertices[tb],Aa=aa-Da.x,na=ub-Da.y,aa=Aa,ub=na,oa=-ub,ub=aa,aa=oa,null==c._normals[tb]?(sa=c._normals,ya=new O(aa,ub),sa[tb]=ya):(wa=c._normals[tb],wa.x=aa,wa.y=ub),xa=Ca=Ia=Ga=c._normals[tb],Na=xa.x*xa.x+xa.y*xa.y,za=
0==Na?1:Math.sqrt(Na),La=Ca.x/za,Oa=Ca.y/za,Ha=La,Ma=Oa,Ia.x=Ha,Ia.y=Ma}Fa=c._vertices[r].x}}Pa=Fa}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var fb=180/Math.PI*c.local_radians;else c.sync(),fb=180/Math.PI*c._radians;var Qc=0==fb}else Qc=!0;if(Qc){c=b.transform;null==c.parent?Qc=c.local_y:(c.sync(),Qc=c._y);var Sa=Qc-b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();
h=0;for(p=c.count;h<p;)r=h++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(q=c._vertices,n=new O(0,0),q[r]=n),A=c.local_vertices[r].x,w=c.local_vertices[r].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[r],u.x=B,u.y=ea);h=0;for(p=c.count;h<p;)r=h++,u=c._vertices[(r+1)%c.count],y=u.x,J=u.y,t=c._vertices[r],ma=y-t.x,C=J-t.y,y=ma,J=C,A=-J,J=y,y=A,null==c._normals[r]?(q=c._normals,n=
new O(y,J),q[r]=n):(k=c._normals[r],k.x=y,k.y=J),U=D=I=G=c._normals[r],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}Qc=null==c._vertices[0]}else Qc=!0;if(Qc)q=c.transform,null==q.parent?Sa=q.local_y:(q.sync(),Sa=q._y);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();h=0;for(p=c.count;h<p;)r=h++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(q=c._vertices,n=new O(0,0),q[r]=n),A=c.local_vertices[r].x,w=c.local_vertices[r].y,
null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[r],u.x=B,u.y=ea);h=0;for(p=c.count;h<p;)r=h++,u=c._vertices[(r+1)%c.count],y=u.x,J=u.y,t=c._vertices[r],ma=y-t.x,C=J-t.y,y=ma,J=C,A=-J,J=y,y=A,null==c._normals[r]?(q=c._normals,n=new O(y,J),q[r]=n):(k=c._normals[r],k.x=y,k.y=J),U=D=I=G=c._normals[r],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}Qc=c._vertices[0].y;
h=1;for(p=c.count;h<p;){r=h++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();H=0;for(hb=c.count;H<hb;)S=H++,null!=c.local_vertices[S]&&(null==c._vertices[S]&&(q=c._vertices,n=new O(0,0),q[S]=n),A=c.local_vertices[S].x,w=c.local_vertices[S].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[S],u.x=B,u.y=ea);qa=0;for(sb=c.count;qa<sb;)da=qa++,G=c._vertices[(da+
1)%c.count],Q=G.x,L=G.y,t=c._vertices[da],ma=Q-t.x,C=L-t.y,Q=ma,L=C,P=-L,L=Q,Q=P,null==c._normals[da]?(ra=c._normals,R=new O(Q,L),ra[da]=R):(fa=c._normals[da],fa.x=Q,fa.y=L),U=D=I=Fb=c._normals[da],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}if(c._vertices[r].y<Qc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();Z=0;for(W=c.count;Z<W;)Y=Z++,null!=c.local_vertices[Y]&&(null==c._vertices[Y]&&(ba=c._vertices,gb=new O(0,0),
ba[Y]=gb),ca=c.local_vertices[Y].x,V=c.local_vertices[Y].y,null==V&&(V=0),null==ca&&(ca=0),T=c.transform.get_local_to_world_matrix(),Ja=ca,ja=V,la=1,ka=T.m00*Ja+T.m10*ja+T.m20*la,Ua=T.m01*Ja+T.m11*ja+T.m21*la,Xa=ka,Ba=Ua,pa=c._vertices[Y],pa.x=Xa,pa.y=Ba);ib=0;for(va=c.count;ib<va;)tb=ib++,ua=c._vertices[(tb+1)%c.count],aa=ua.x,ub=ua.y,Da=c._vertices[tb],Aa=aa-Da.x,na=ub-Da.y,aa=Aa,ub=na,oa=-ub,ub=aa,aa=oa,null==c._normals[tb]?(sa=c._normals,ya=new O(aa,ub),sa[tb]=ya):(wa=c._normals[tb],wa.x=aa,wa.y=
ub),xa=Ca=Ia=Ga=c._normals[tb],Na=xa.x*xa.x+xa.y*xa.y,za=0==Na?1:Math.sqrt(Na),La=Ca.x/za,Oa=Ca.y/za,Ha=La,Ma=Oa,Ia.x=Ha,Ia.y=Ma}Qc=c._vertices[r].y}}Sa=Qc}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var eb=180/Math.PI*c.local_radians;else c.sync(),eb=180/Math.PI*c._radians;var Rc=0==eb}else Rc=!0;if(Rc){c=b.transform;null==c.parent?Rc=c.local_y:(c.sync(),Rc=c._y);var $a=Rc+b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();h=0;for(p=c.count;h<p;)r=h++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(q=c._vertices,n=new O(0,0),q[r]=n),A=c.local_vertices[r].x,w=c.local_vertices[r].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[r],u.x=B,u.y=ea);h=0;for(p=c.count;h<p;)r=h++,u=c._vertices[(r+1)%c.count],y=u.x,J=u.y,t=c._vertices[r],ma=y-t.x,C=J-t.y,y=ma,J=C,
A=-J,J=y,y=A,null==c._normals[r]?(q=c._normals,n=new O(y,J),q[r]=n):(k=c._normals[r],k.x=y,k.y=J),U=D=I=G=c._normals[r],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}Rc=null==c._vertices[0]}else Rc=!0;if(Rc)q=c.transform,null==q.parent?$a=q.local_y:(q.sync(),$a=q._y);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();h=0;for(p=c.count;h<p;)r=h++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(q=c._vertices,n=new O(0,
0),q[r]=n),A=c.local_vertices[r].x,w=c.local_vertices[r].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[r],u.x=B,u.y=ea);h=0;for(p=c.count;h<p;)r=h++,u=c._vertices[(r+1)%c.count],y=u.x,J=u.y,t=c._vertices[r],ma=y-t.x,C=J-t.y,y=ma,J=C,A=-J,J=y,y=A,null==c._normals[r]?(q=c._normals,n=new O(y,J),q[r]=n):(k=c._normals[r],k.x=y,k.y=J),U=D=I=G=c._normals[r],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),
Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}Rc=c._vertices[0].y;h=1;for(p=c.count;h<p;){r=h++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();H=0;for(hb=c.count;H<hb;)S=H++,null!=c.local_vertices[S]&&(null==c._vertices[S]&&(q=c._vertices,n=new O(0,0),q[S]=n),A=c.local_vertices[S].x,w=c.local_vertices[S].y,null==w&&(w=0),null==A&&(A=0),k=c.transform.get_local_to_world_matrix(),y=A,J=w,z=1,N=k.m00*y+k.m10*J+k.m20*z,v=k.m01*y+k.m11*J+k.m21*z,B=N,ea=v,u=c._vertices[S],
u.x=B,u.y=ea);qa=0;for(sb=c.count;qa<sb;)da=qa++,G=c._vertices[(da+1)%c.count],Q=G.x,L=G.y,t=c._vertices[da],ma=Q-t.x,C=L-t.y,Q=ma,L=C,P=-L,L=Q,Q=P,null==c._normals[da]?(ra=c._normals,R=new O(Q,L),ra[da]=R):(fa=c._normals[da],fa.x=Q,fa.y=L),U=D=I=Fb=c._normals[da],F=U.x*U.x+U.y*U.y,K=0==F?1:Math.sqrt(F),Va=D.x/K,E=D.y/K,M=Va,ha=E,I.x=M,I.y=ha}if(c._vertices[r].y>Rc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();Z=0;for(W=c.count;Z<W;)Y=Z++,null!=c.local_vertices[Y]&&
(null==c._vertices[Y]&&(ba=c._vertices,gb=new O(0,0),ba[Y]=gb),ca=c.local_vertices[Y].x,V=c.local_vertices[Y].y,null==V&&(V=0),null==ca&&(ca=0),T=c.transform.get_local_to_world_matrix(),Ja=ca,ja=V,la=1,ka=T.m00*Ja+T.m10*ja+T.m20*la,Ua=T.m01*Ja+T.m11*ja+T.m21*la,Xa=ka,Ba=Ua,pa=c._vertices[Y],pa.x=Xa,pa.y=Ba);ib=0;for(va=c.count;ib<va;)tb=ib++,ua=c._vertices[(tb+1)%c.count],aa=ua.x,ub=ua.y,Da=c._vertices[tb],Aa=aa-Da.x,na=ub-Da.y,aa=Aa,ub=na,oa=-ub,ub=aa,aa=oa,null==c._normals[tb]?(sa=c._normals,ya=
new O(aa,ub),sa[tb]=ya):(wa=c._normals[tb],wa.x=aa,wa.y=ub),xa=Ca=Ia=Ga=c._normals[tb],Na=xa.x*xa.x+xa.y*xa.y,za=0==Na?1:Math.sqrt(Na),La=Ca.x/za,Oa=Ca.y/za,Ha=La,Ma=Oa,Ia.x=Ha,Ia.y=Ma}Rc=c._vertices[r].y}}$a=Rc}}A=f;w=Sa;var kb=Pa,tc=Sa;null==tc&&(tc=1);null==kb&&(kb=1);null==w&&(w=0);null==A&&(A=0);var X=Mb.pool.get();P=A;V=w;var Qa=kb,Za=tc;null==Za&&(Za=1);null==Qa&&(Qa=1);null==V&&(V=0);null==P&&(P=0);u=X.start;u.x=P;u.y=V;u=X.end;u.x=Qa;u.y=Za;X.pooled=!1;var bb=(X.get_dy()-X.get_y())*(a.get_dx()-
a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(bb))var jb=null;else{var vb=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/bb,bc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/bb;if(0>vb||1<vb||0>bc||1<bc)jb=null;else{k=a.start;var Ea=vb;fa=a.end;t=a.start;var Nb=fa.x-t.x,Ta=fa.y-t.y;ma=Nb*Ea;C=Ta*Ea;var Ya=k.x+ma,Xb=k.y+C;k=a.start;var Ka=Ya-k.x,Wa=Xb-k.y,pb=Math.sqrt(Ka*Ka+Wa*Wa);
k=a.start;t=a.end;Ka=t.x-k.x;Wa=t.y-k.y;var ab=Math.sqrt(Ka*Ka+Wa*Wa)-pb,lb=0<=bb;k=X.start;t=X.end;Ka=t.x-k.x;Wa=t.y-k.y;var wb=Math.sqrt(Ka*Ka+Wa*Wa)*(lb?-1:1);u=ta.norm;A=(X.get_dy()-X.get_y())/wb;w=-(X.get_dx()-X.get_x())/wb;u.x=A;u.y=w;var cb=ta.norm.x,db=ta.norm.y,cc=lb;null==cc&&(cc=!1);r=ob.pool.get();r.line=null;r.shape=null;r.line2=null;var Cb=cc;null==Cb&&(Cb=!1);r.distance=pb;r.overlap=ab;r.inverse_normal=Cb;u=r.hit;u.x=Ya;u.y=Xb;u=r.normal;u.x=cb;u.y=db;r.pooled=!1;var dc=r;dc.line=a;
dc.line2=X;jb=dc}}null!=jb&&(l=jb);A=Pa;w=Sa;kb=Pa;tc=$a;null==tc&&(tc=1);null==kb&&(kb=1);null==w&&(w=0);null==A&&(A=0);u=X.start;u.x=A;u.y=w;u=X.end;u.x=kb;u.y=tc;bb=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(bb)?jb=null:(vb=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/bb,bc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/bb,0>vb||1<vb||0>bc||
1<bc?jb=null:(k=a.start,Ea=vb,fa=a.end,t=a.start,Nb=fa.x-t.x,Ta=fa.y-t.y,ma=Nb*Ea,C=Ta*Ea,Ya=k.x+ma,Xb=k.y+C,k=a.start,Ka=Ya-k.x,Wa=Xb-k.y,pb=Math.sqrt(Ka*Ka+Wa*Wa),k=a.start,t=a.end,Ka=t.x-k.x,Wa=t.y-k.y,ab=Math.sqrt(Ka*Ka+Wa*Wa)-pb,lb=0<=bb,k=X.start,t=X.end,Ka=t.x-k.x,Wa=t.y-k.y,wb=Math.sqrt(Ka*Ka+Wa*Wa)*(lb?-1:1),u=ta.norm,A=(X.get_dy()-X.get_y())/wb,w=-(X.get_dx()-X.get_x())/wb,u.x=A,u.y=w,cb=ta.norm.x,db=ta.norm.y,cc=lb,null==cc&&(cc=!1),r=ob.pool.get(),r.line=null,r.shape=null,r.line2=null,
Cb=cc,null==Cb&&(Cb=!1),r.distance=pb,r.overlap=ab,r.inverse_normal=Cb,u=r.hit,u.x=Ya,u.y=Xb,u=r.normal,u.x=cb,u.y=db,r.pooled=!1,dc=r,dc.line=a,dc.line2=X,jb=dc));null!=jb&&(null==l||l.distance>jb.distance)&&(l=jb);A=Pa;w=$a;kb=f;tc=$a;null==tc&&(tc=1);null==kb&&(kb=1);null==w&&(w=0);null==A&&(A=0);u=X.start;u.x=A;u.y=w;u=X.end;u.x=kb;u.y=tc;bb=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(bb)?jb=null:(vb=((X.get_dx()-X.get_x())*(a.get_y()-
X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/bb,bc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/bb,0>vb||1<vb||0>bc||1<bc?jb=null:(k=a.start,Ea=vb,fa=a.end,t=a.start,Nb=fa.x-t.x,Ta=fa.y-t.y,ma=Nb*Ea,C=Ta*Ea,Ya=k.x+ma,Xb=k.y+C,k=a.start,Ka=Ya-k.x,Wa=Xb-k.y,pb=Math.sqrt(Ka*Ka+Wa*Wa),k=a.start,t=a.end,Ka=t.x-k.x,Wa=t.y-k.y,ab=Math.sqrt(Ka*Ka+Wa*Wa)-pb,lb=0<=bb,k=X.start,t=X.end,Ka=t.x-k.x,Wa=t.y-k.y,wb=Math.sqrt(Ka*Ka+Wa*Wa)*(lb?-1:1),u=ta.norm,
A=(X.get_dy()-X.get_y())/wb,w=-(X.get_dx()-X.get_x())/wb,u.x=A,u.y=w,cb=ta.norm.x,db=ta.norm.y,cc=lb,null==cc&&(cc=!1),r=ob.pool.get(),r.line=null,r.shape=null,r.line2=null,Cb=cc,null==Cb&&(Cb=!1),r.distance=pb,r.overlap=ab,r.inverse_normal=Cb,u=r.hit,u.x=Ya,u.y=Xb,u=r.normal,u.x=cb,u.y=db,r.pooled=!1,dc=r,dc.line=a,dc.line2=X,jb=dc));null!=jb&&(null==l||l.distance>jb.distance)&&(l=jb);A=f;w=$a;kb=f;tc=Sa;null==tc&&(tc=1);null==kb&&(kb=1);null==w&&(w=0);null==A&&(A=0);u=X.start;u.x=A;u.y=w;u=X.end;
u.x=kb;u.y=tc;bb=(X.get_dy()-X.get_y())*(a.get_dx()-a.get_x())-(X.get_dx()-X.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(bb)?jb=null:(vb=((X.get_dx()-X.get_x())*(a.get_y()-X.get_y())-(X.get_dy()-X.get_y())*(a.get_x()-X.get_x()))/bb,bc=((a.get_dx()-a.get_x())*(a.get_y()-X.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-X.get_x()))/bb,0>vb||1<vb||0>bc||1<bc?jb=null:(k=a.start,Ea=vb,fa=a.end,t=a.start,Nb=fa.x-t.x,Ta=fa.y-t.y,ma=Nb*Ea,C=Ta*Ea,Ya=k.x+ma,Xb=k.y+C,k=a.start,Ka=Ya-k.x,Wa=Xb-k.y,pb=Math.sqrt(Ka*
Ka+Wa*Wa),k=a.start,t=a.end,Ka=t.x-k.x,Wa=t.y-k.y,ab=Math.sqrt(Ka*Ka+Wa*Wa)-pb,lb=0<=bb,k=X.start,t=X.end,Ka=t.x-k.x,Wa=t.y-k.y,wb=Math.sqrt(Ka*Ka+Wa*Wa)*(lb?-1:1),u=ta.norm,A=(X.get_dy()-X.get_y())/wb,w=-(X.get_dx()-X.get_x())/wb,u.x=A,u.y=w,cb=ta.norm.x,db=ta.norm.y,cc=lb,null==cc&&(cc=!1),r=ob.pool.get(),r.line=null,r.shape=null,r.line2=null,Cb=cc,null==Cb&&(Cb=!1),r.distance=pb,r.overlap=ab,r.inverse_normal=Cb,u=r.hit,u.x=Ya,u.y=Xb,u=r.normal,u.x=cb,u.y=db,r.pooled=!1,dc=r,dc.line=a,dc.line2=
X,jb=dc));null!=jb&&(null==l||l.distance>jb.distance)&&(l=jb);null!=l&&(l.line=a,l.shape=b);return l};ta.line_intersects_circle=function(a,b){var c=a.end,e=a.start,g=c.x-e.x,l=c.y-e.y;c=a.start;var d=b.transform;d.sync();var m=d._x,f=d._y,h=c.x-m;m=c.y-f;f=b.local_radius;d=b.transform;null==d.parent?c=d.local_scale_x:(d.sync(),c=d._scale_x);f*=c;c=g*g+l*l;e=2*(h*g+m*l);l=e*e-4*c*(h*h+m*m-f*f);if(0>l)return null;l=Math.sqrt(l);g=(-e-l)/(2*c);l=(-e+l)/(2*c);return 0<=g&&1>=g?(c=a.start,l=g,d=a.end,
e=a.start,g=d.x-e.x,h=d.y-e.y,g=c.x+g*l,l=c.y+h*l,c=a.start,d=g-c.x,c=l-c.y,h=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-h,c=ta.norm,d=b.transform,null==d.parent?m=d.local_x:(d.sync(),m=d._x),d=b.transform,null==d.parent?d=d.local_y:(d.sync(),d=d._y),c.x=g-m,c.y=l-d,c=ta.norm,m=c.x/f,f=c.y/f,c.x=m,c.y=f,f=ta.norm.x,d=ta.norm.y,m=ob.pool.get(),m.line=null,m.shape=null,m.line2=null,c=!1,null==c&&(c=!1),m.distance=h,m.overlap=e,m.inverse_normal=c,c=m.hit,c.x=g,c.y=
l,c=m.normal,c.x=f,c.y=d,m.pooled=!1,f=m,f.line=a,f.shape=b,f):0<=l&&1>=l?(c=a.start,d=a.end,e=a.start,g=d.x-e.x,h=d.y-e.y,g=c.x+g*l,l=c.y+h*l,c=a.start,d=g-c.x,c=l-c.y,h=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-h,c=ta.norm,d=b.transform,null==d.parent?m=d.local_x:(d.sync(),m=d._x),d=b.transform,null==d.parent?d=d.local_y:(d.sync(),d=d._y),c.x=g-m,c.y=l-d,d=c=ta.norm,m=-d.y,c.x=-d.x/f,c.y=m/f,f=ta.norm.x,d=ta.norm.y,c=!0,null==c&&(c=!1),m=ob.pool.get(),m.line=
null,m.shape=null,m.line2=null,null==c&&(c=!1),m.distance=h,m.overlap=e,m.inverse_normal=c,c=m.hit,c.x=g,c.y=l,c=m.normal,c.x=f,c.y=d,m.pooled=!1,f=m,f.line=a,f.shape=b,f):null};ta.line_intersects_polygon=function(a,b){var c=null,e=Mb.pool.get(),g=0,l=0,d=1,f=1;null==f&&(f=1);null==d&&(d=1);null==l&&(l=0);null==g&&(g=0);var h=e.start;h.x=g;h.y=l;h=e.end;h.x=d;h.y=f;e.pooled=!1;for(var p=0,q=b.count;p<q;){var r=p++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();
for(var A=0,n=b.count;A<n;){var k=A++;if(null!=b.local_vertices[k]){if(null==b._vertices[k]){var w=b._vertices,y=new O(0,0);w[k]=y}g=b.local_vertices[k].x;l=b.local_vertices[k].y;null==l&&(l=0);null==g&&(g=0);var J=b.transform.get_local_to_world_matrix(),u=g,t=l,z=J.m00*u+J.m10*t+1*J.m20,N=J.m01*u+J.m11*t+1*J.m21;h=b._vertices[k];h.x=z;h.y=N}}for(var v=0,B=b.count;v<B;){var ea=v++,ma=b._vertices[(ea+1)%b.count],C=ma.x,U=ma.y,I=b._vertices[ea],D=U-I.y;C-=I.x;U=D;var G=-U;U=C;C=G;if(null==b._normals[ea]){var F=
b._normals,K=new O(C,U);F[ea]=K}else{var Va=b._normals[ea];Va.x=C;Va.y=U}var E=b._normals[ea],M=E,ha=E,S=ha,H=S.x*S.x+S.y*S.y,da=0==H?1:Math.sqrt(H),Q=ha.y/da;M.x=ha.x/da;M.y=Q}}var qa=b._vertices[r];if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var hb=0,sb=b.count;hb<sb;){var L=hb++;if(null!=b.local_vertices[L]){if(null==b._vertices[L]){var Y=b._vertices,fa=new O(0,0);Y[L]=fa}var P=b.local_vertices[L].x,ra=b.local_vertices[L].y;null==ra&&(ra=0);null==
P&&(P=0);var R=b.transform.get_local_to_world_matrix(),T=P,Z=ra,Fb=R.m01*T+R.m11*Z+1*R.m21,W=b._vertices[L];W.x=R.m00*T+R.m10*Z+1*R.m20;W.y=Fb}}for(var V=0,ca=b.count;V<ca;){var ba=V++,gb=b._vertices[(ba+1)%b.count],aa=gb.x,Ja=gb.y,ja=b._vertices[ba],la=Ja-ja.y;aa-=ja.x;Ja=la;var ka=-Ja;Ja=aa;aa=ka;if(null==b._normals[ba]){var pa=b._normals,ib=new O(aa,Ja);pa[ba]=ib}else{var Ua=b._normals[ba];Ua.x=aa;Ua.y=Ja}var Xa=b._normals[ba],ua=Xa,Da=Xa,Ba=Da,xa=Ba.x*Ba.x+Ba.y*Ba.y,va=0==xa?1:Math.sqrt(xa),Aa=
Da.y/va;ua.x=Da.x/va;ua.y=Aa}}var na=b._vertices[(r+1)%b.count],wa=qa.x,oa=qa.y;d=na.x;f=na.y;null==f&&(f=1);null==d&&(d=1);null==oa&&(oa=0);null==wa&&(wa=0);var sa=e.start;sa.x=wa;sa.y=oa;var ya=e.end;ya.x=d;ya.y=f;var Ca=(e.get_dy()-e.get_y())*(a.get_dx()-a.get_x())-(e.get_dx()-e.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(Ca))var Ia=null;else{var Na=((e.get_dx()-e.get_x())*(a.get_y()-e.get_y())-(e.get_dy()-e.get_y())*(a.get_x()-e.get_x()))/Ca,za=((a.get_dx()-a.get_x())*(a.get_y()-e.get_y())-
(a.get_dy()-a.get_y())*(a.get_x()-e.get_x()))/Ca;if(0>Na||1<Na||0>za||1<za)Ia=null;else{var Fa=a.start,La=Na,Oa=a.end,Ga=a.start,Ha=Fa.x+(Oa.x-Ga.x)*La,Ma=Fa.y+(Oa.y-Ga.y)*La,Ea=a.start,Ya=Ha-Ea.x,Pa=Ma-Ea.y,Sa=Math.sqrt(Ya*Ya+Pa*Pa),$a=a.start,Ta=a.end,ab=Ta.x-$a.x,cb=Ta.y-$a.y,Ra=Math.sqrt(ab*ab+cb*cb)-Sa,db=0<=Ca,fb=e.start,kb=e.end,eb=kb.x-fb.x,X=kb.y-fb.y,Qa=Math.sqrt(eb*eb+X*X)*(db?-1:1),Za=ta.norm,bb=(e.get_dy()-e.get_y())/Qa,jb=-(e.get_dx()-e.get_x())/Qa;Za.x=bb;Za.y=jb;var vb=ta.norm.x,bc=
ta.norm.y,mb=db;null==mb&&(mb=!1);var Nb=ob.pool.get();Nb.line=null;Nb.shape=null;Nb.line2=null;var nb=mb;null==nb&&(nb=!1);Nb.distance=Sa;Nb.overlap=Ra;Nb.inverse_normal=nb;var Bb=Nb.hit;Bb.x=Ha;Bb.y=Ma;var Xb=Nb.normal;Xb.x=vb;Xb.y=bc;Nb.pooled=!1;var Ka=Nb;Ka.line=a;Ka.line2=e;Ia=Ka}}null!=Ia&&(null==c||c.distance>Ia.distance)&&(c=Ia)}null!=c&&(c.line=a,c.shape=b);return c};ta.rect_and_rect=function(a,b,c){null==c&&(c=!1);var e=null,g=a.transform;if(null==g.parent)var l=180/Math.PI*g.local_radians;
else g.sync(),l=180/Math.PI*g._radians;0==l?(g=b.transform,null==g.parent?l=180/Math.PI*g.local_radians:(g.sync(),l=180/Math.PI*g._radians),l=0!=l):l=!0;if(l){if(null!=a.transformed_rect){e=ta.rect_and_polygon(b,a.transformed_rect,c);if(null==e)return null;c?e.sa=a:e.sb=a;return e}if(null!=b.transformed_rect){e=ta.rect_and_polygon(a,b.transformed_rect,!c);if(null==e)return null;c?e.sa=b:e.sb=b;return e}}l=c?b:a;a=c?a:b;g=a.transform;null==g.parent?b=g.local_x:(g.sync(),b=g._x);g=l.transform;null==
g.parent?g=g.local_x:(g.sync(),g=g._x);b-=g;g=a.transform;null==g.parent?c=g.local_y:(g.sync(),c=g._y);g=l.transform;null==g.parent?g=g.local_y:(g.sync(),g=g._y);g=c-g;c=l.local_ex*l.transform.local_scale_x+a.local_ex*a.transform.local_scale_x-Math.abs(b);if(0<c){var d=l.local_ey*l.transform.local_scale_y+a.local_ey*a.transform.local_scale_y-Math.abs(g);if(0<d){if(c<d){e=sc.pool.get();e.sa=null;e.sb=null;for(var f=e.contact_count=0,h=e.contacts;f<h.length;){var p=h[f];++f;p.x=0;p.y=0}e.overlap=c;
c=e.normal;c.x=0>b?-1:1;c.y=0}else{e=sc.pool.get();e.sa=null;e.sb=null;f=e.contact_count=0;for(h=e.contacts;f<h.length;)p=h[f],++f,p.x=0,p.y=0;e.overlap=d;c=e.normal;c.x=0;c.y=0>g?-1:1}e.pooled=!1;e.sa=l;e.sb=a}}return e};ta.circle_and_circle=function(a,b,c){null==c&&(c=!1);var e=c?b:a;a=c?a:b;var g=a.transform;null==g.parent?b=g.local_x:(g.sync(),b=g._x);g=e.transform;null==g.parent?c=g.local_x:(g.sync(),c=g._x);b-=c;g=a.transform;null==g.parent?c=g.local_y:(g.sync(),c=g._y);g=e.transform;null==
g.parent?g=g.local_y:(g.sync(),g=g._y);c-=g;var l=e.local_radius;g=e.transform;if(null==g.parent)var d=g.local_scale_x;else g.sync(),d=g._scale_x;var f=a.local_radius;g=a.transform;null==g.parent?g=g.local_scale_x:(g.sync(),g=g._scale_x);l=l*d+f*g;d=b*b+c*c;g=null;if(d>=l*l)return g;if(1E-5>=Math.abs(d)){l=e.local_radius;g=e.transform;null==g.parent?b=g.local_scale_x:(g.sync(),b=g._scale_x);b*=l;g=sc.pool.get();g.sa=null;g.sb=null;f=g.contact_count=0;for(var h=g.contacts;f<h.length;){var p=h[f];++f;
p.x=0;p.y=0}g.overlap=b;l=g.normal;l.x=1;l.y=0}else{d=Math.sqrt(d);b/=d;c/=d;g=sc.pool.get();g.sa=null;g.sb=null;f=g.contact_count=0;for(h=g.contacts;f<h.length;)p=h[f],++f,p.x=0,p.y=0;g.overlap=l-d;l=g.normal;l.x=b;l.y=c}g.pooled=!1;g.sa=e;g.sb=a;return g};ta.polygon_and_polygon=function(a,b,c){null==c&&(c=!1);var e=ta.check_polygons(a,b,c);if(null==e)return null;a=ta.check_polygons(b,a,!c);if(null==a)return null;0>e.overlap&&(e.overlap=Math.abs(e.overlap));0>a.overlap&&(a.overlap=Math.abs(a.overlap));
if(e.overlap<a.overlap)return a.put(),e;e.put();return a};ta.rect_and_circle=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect){var e=a.transform;if(null==e.parent)var g=180/Math.PI*e.local_radians;else e.sync(),g=180/Math.PI*e._radians;g=0!=g}else g=!1;if(g){g=ta.circle_and_polygon(b,a.transformed_rect,c);if(null==g)return null;c?g.sa=a:g.sb=a;return g}c?(e=b.transform,null==e.parent?g=e.local_x:(e.sync(),g=e._x),e=a.transform):(e=a.transform,null==e.parent?g=e.local_x:(e.sync(),g=e._x),
e=b.transform);if(null==e.parent)var l=e.local_x;else e.sync(),l=e._x;g-=l;c?(e=b.transform,null==e.parent?l=e.local_y:(e.sync(),l=e._y),e=a.transform):(e=a.transform,null==e.parent?l=e.local_y:(e.sync(),l=e._y),e=b.transform);if(null==e.parent)var d=e.local_y;else e.sync(),d=e._y;l-=d;var f=g,h=l;d=-(a.local_ex*a.transform.local_scale_x);var p=a.local_ex*a.transform.local_scale_x;f<d?f=d:f>p&&(f=p);d=-(a.local_ey*a.transform.local_scale_y);p=a.local_ey*a.transform.local_scale_y;h<d?h=d:h>p&&(h=p);
p=!1;d=b.local_radius;e=b.transform;null==e.parent?e=e.local_scale_x:(e.sync(),e=e._scale_x);d*=e;1E-5>=Math.abs(g-f)&&1E-5>=Math.abs(l-h)&&(p=!0,Math.abs(g)>Math.abs(l)?f=0<f?a.local_ex*a.transform.local_scale_x+d+.1:-(a.local_ex*a.transform.local_scale_x)-d-.1:h=0<h?a.local_ey*a.transform.local_scale_y+d+.1:-(a.local_ey*a.transform.local_scale_y)-d-.1);g-=f;l-=h;f=g*g+l*l;if(f>d*d&&!p)return null;f=Math.sqrt(f);g/=f;l/=f;p&&(g*=-1,l*=-1);f=Math.abs(d-f);d=sc.pool.get();d.sa=null;d.sb=null;h=d.contact_count=
0;for(p=d.contacts;h<p.length;)e=p[h],++h,e.x=0,e.y=0;d.overlap=f;f=d.normal;f.x=g;f.y=l;d.pooled=!1;g=d;g.sa=c?b:a;g.sb=c?a:b;return g};ta.rect_and_polygon=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect)b=ta.polygon_and_polygon(a.transformed_rect,b,c);else{var e=Qa.pool.get();e.count=4;for(var g=0,l=e.count;g<l;){var d=g++;if(null==e.local_vertices[d]){var f=e.local_vertices,h=new O(0,0);f[d]=h}}g=e.local_vertices[0];g.x=-(a.local_ex*a.transform.local_scale_x);g.y=-(a.local_ey*a.transform.local_scale_y);
g=e.local_vertices[1];g.x=a.local_ex*a.transform.local_scale_x;g.y=-(a.local_ey*a.transform.local_scale_y);g=e.local_vertices[2];g.x=a.local_ex*a.transform.local_scale_x;g.y=a.local_ey*a.transform.local_scale_y;g=e.local_vertices[3];g.x=-(a.local_ex*a.transform.local_scale_x);g.y=a.local_ey*a.transform.local_scale_y;g=a.transform.local_x;l=e.transform;l.dirty||l.set_dirty();l.local_x=g;g=a.transform.local_y;l=e.transform;l.dirty||l.set_dirty();l.local_y=g;l=e.transform;g=Math.PI/180*(180/Math.PI)*
a.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=g;g=a.transform.local_scale_x;l=e.transform;l.dirty||l.set_dirty();l.local_scale_x=g;g=a.transform.local_scale_y;l=e.transform;l.dirty||l.set_dirty();l.local_scale_y=g;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;e.set_parent(a.parent);b=ta.polygon_and_polygon(e,b,c);e.put()}if(null==b)return null;c?b.sb=a:b.sa=a;return b};ta.circle_and_polygon=function(a,b,c){null==c&&(c=!1);var e=0,g=1073741823,l=a.transform;l.sync();var d=l._x,
f=l._y,h=a.local_radius;l=a.transform;if(null==l.parent)var p=l.local_scale_x;else l.sync(),p=l._scale_x;for(var q=h*p,r=0,A=b.count;r<A;){var n=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var k=0,w=b.count;k<w;){var y=k++;if(null!=b.local_vertices[y]){if(null==b._vertices[y]){var J=b._vertices,u=new O(0,0);J[y]=u}var t=b.local_vertices[y].x,z=b.local_vertices[y].y;null==z&&(z=0);null==t&&(t=0);var N=b.transform.get_local_to_world_matrix(),v=
t,ea=z,B=1,ma=N.m00*v+N.m10*ea+N.m20*B,C=N.m01*v+N.m11*ea+N.m21*B,U=ma,I=C,D=b._vertices[y];D.x=U;D.y=I}}for(var G=0,F=b.count;G<F;){var K=G++,Va=b._vertices[(K+1)%b.count],S=Va.x,ha=Va.y,E=b._vertices[K],M=S-E.x,H=ha-E.y;S=M;ha=H;var da=-ha;ha=S;S=da;if(null==b._normals[K]){var Q=b._normals,qa=new O(S,ha);Q[K]=qa}else{var hb=b._normals[K];hb.x=S;hb.y=ha}var sb=b._normals[K],L=sb,Y=sb,fa=Y,P=fa.x*fa.x+fa.y*fa.y,R=0==P?1:Math.sqrt(P),ra=Y.x/R,T=Y.y/R,Z=ra,W=T;L.x=Z;L.y=W}}var Fb=b._vertices[n],V=d-
Fb.x,ba=f-Fb.y;e=V*V+ba*ba;if(e<g){g=e;var ca=ta.closest;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var gb=0,Ja=b.count;gb<Ja;){var aa=gb++;if(null!=b.local_vertices[aa]){if(null==b._vertices[aa]){var ja=b._vertices,la=new O(0,0);ja[aa]=la}var ka=b.local_vertices[aa].x,pa=b.local_vertices[aa].y;null==pa&&(pa=0);null==ka&&(ka=0);var Ba=b.transform.get_local_to_world_matrix(),Ua=ka,ib=pa,Da=1,Xa=Ba.m00*Ua+Ba.m10*ib+Ba.m20*Da,ua=Ba.m01*Ua+Ba.m11*ib+
Ba.m21*Da,xa=Xa,va=ua,Ia=b._vertices[aa];Ia.x=xa;Ia.y=va}}for(var wa=0,Ca=b.count;wa<Ca;){var oa=wa++,Aa=b._vertices[(oa+1)%b.count],na=Aa.x,sa=Aa.y,ya=b._vertices[oa],Na=na-ya.x,za=sa-ya.y;na=Na;sa=za;var Fa=-sa;sa=na;na=Fa;if(null==b._normals[oa]){var La=b._normals,Oa=new O(na,sa);La[oa]=Oa}else{var Ga=b._normals[oa];Ga.x=na;Ga.y=sa}var Ha=b._normals[oa],Ma=Ha,Ea=Ha,Ya=Ea,Pa=Ya.x*Ya.x+Ya.y*Ya.y,Sa=0==Pa?1:Math.sqrt(Pa),$a=Ea.x/Sa,Ta=Ea.y/Sa,ab=$a,cb=Ta;Ma.x=ab;Ma.y=cb}}var db=b._vertices[n].x;if(b.dirty_vertices){for(b.dirty_vertices=
!1;b._vertices.length>b.count;)b._vertices.pop();for(var Ra=0,fb=b.count;Ra<fb;){var kb=Ra++;if(null!=b.local_vertices[kb]){if(null==b._vertices[kb]){var eb=b._vertices,X=new O(0,0);eb[kb]=X}var Qa=b.local_vertices[kb].x,Za=b.local_vertices[kb].y;null==Za&&(Za=0);null==Qa&&(Qa=0);var bb=b.transform.get_local_to_world_matrix(),jb=Qa,vb=Za,bc=1,mb=bb.m00*jb+bb.m10*vb+bb.m20*bc,Nb=bb.m01*jb+bb.m11*vb+bb.m21*bc,nb=mb,Bb=Nb,Xb=b._vertices[kb];Xb.x=nb;Xb.y=Bb}}for(var Ka=0,Wa=b.count;Ka<Wa;){var pb=Ka++,
Mb=b._vertices[(pb+1)%b.count],lb=Mb.x,wb=Mb.y,rb=b._vertices[pb],Jb=lb-rb.x,cc=wb-rb.y;lb=Jb;wb=cc;var Cb=-wb;wb=lb;lb=Cb;if(null==b._normals[pb]){var dc=b._normals,zb=new O(lb,wb);dc[pb]=zb}else{var Ab=b._normals[pb];Ab.x=lb;Ab.y=wb}var Kb=b._normals[pb],Hb=Kb,ac=Kb,id=ac,Ib=id.x*id.x+id.y*id.y,ob=0==Ib?1:Math.sqrt(Ib),Sb=ac.x/ob,Tb=ac.y/ob,Vb=Sb,Qb=Tb;Hb.x=Vb;Hb.y=Qb}}var xb=b._vertices[n].y;ca.x=db;ca.y=xb}}N=ta.closest;V=N.x-d;ba=N.y-f;P=V*V+ba*ba;R=0==P?1:Math.sqrt(P);var yb=V/R,Db=ba/R,qb=
0;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();r=0;for(A=b.count;r<A;)n=r++,null!=b.local_vertices[n]&&(null==b._vertices[n]&&(J=b._vertices,u=new O(0,0),J[n]=u),t=b.local_vertices[n].x,z=b.local_vertices[n].y,null==z&&(z=0),null==t&&(t=0),N=b.transform.get_local_to_world_matrix(),v=t,ea=z,B=1,ma=N.m00*v+N.m10*ea+N.m20*B,C=N.m01*v+N.m11*ea+N.m21*B,U=ma,I=C,D=b._vertices[n],D.x=U,D.y=I);r=0;for(A=b.count;r<A;)n=r++,D=b._vertices[(n+1)%b.count],v=D.x,ea=
D.y,E=b._vertices[n],M=v-E.x,H=ea-E.y,v=M,ea=H,t=-ea,ea=v,v=t,null==b._normals[n]?(J=b._normals,u=new O(v,ea),J[n]=u):(N=b._normals[n],N.x=v,N.y=ea),fa=Y=L=Va=b._normals[n],P=fa.x*fa.x+fa.y*fa.y,R=0==P?1:Math.sqrt(P),ra=Y.x/R,T=Y.y/R,Z=ra,W=T,L.x=Z,L.y=W}E=b._vertices[0];var Sc=yb*E.x+Db*E.y,Eb=Sc;r=1;for(A=b.count;r<A;){var Yb=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();k=0;for(w=b.count;k<w;)n=k++,null!=b.local_vertices[n]&&(null==b._vertices[n]&&
(J=b._vertices,u=new O(0,0),J[n]=u),t=b.local_vertices[n].x,z=b.local_vertices[n].y,null==z&&(z=0),null==t&&(t=0),N=b.transform.get_local_to_world_matrix(),v=t,ea=z,B=1,ma=N.m00*v+N.m10*ea+N.m20*B,C=N.m01*v+N.m11*ea+N.m21*B,U=ma,I=C,D=b._vertices[n],D.x=U,D.y=I);G=0;for(F=b.count;G<F;)y=G++,Va=b._vertices[(y+1)%b.count],S=Va.x,ha=Va.y,E=b._vertices[y],M=S-E.x,H=ha-E.y,S=M,ha=H,da=-ha,ha=S,S=da,null==b._normals[y]?(Q=b._normals,qa=new O(S,ha),Q[y]=qa):(hb=b._normals[y],hb.x=S,hb.y=ha),fa=Y=L=sb=b._normals[y],
P=fa.x*fa.x+fa.y*fa.y,R=0==P?1:Math.sqrt(P),ra=Y.x/R,T=Y.y/R,Z=ra,W=T,L.x=Z,L.y=W}Fb=b._vertices[Yb];qb=yb*Fb.x+Db*Fb.y;qb<Sc&&(Sc=qb);qb>Eb&&(Eb=qb)}var Ob=q,Rb=-q;M=-d;H=-f;var Ub=yb*M+Db*H;Sc+=Ub;Eb+=Ub;var $b=Sc-Ob,zc=Rb-Eb;if(0<$b||0<zc)return null;var Lb=-(Ob-Sc);c&&(Lb*=-1);t=yb;z=Db;h=sc.pool.get();h.sa=null;h.sb=null;r=h.contact_count=0;for(A=h.contacts;r<A.length;){var hc=A[r];++r;hc.x=0;hc.y=0}h.overlap=Lb;D=h.normal;D.x=t;D.y=z;h.pooled=!1;var Gb=h,jc=Math.abs(Lb);r=0;for(A=b.count;r<
A;){n=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();k=0;for(w=b.count;k<w;)y=k++,null!=b.local_vertices[y]&&(null==b._vertices[y]&&(J=b._vertices,u=new O(0,0),J[y]=u),t=b.local_vertices[y].x,z=b.local_vertices[y].y,null==z&&(z=0),null==t&&(t=0),N=b.transform.get_local_to_world_matrix(),v=t,ea=z,B=1,ma=N.m00*v+N.m10*ea+N.m20*B,C=N.m01*v+N.m11*ea+N.m21*B,U=ma,I=C,D=b._vertices[y],D.x=U,D.y=I);G=0;for(F=b.count;G<F;)K=G++,Va=b._vertices[(K+1)%b.count],
S=Va.x,ha=Va.y,E=b._vertices[K],M=S-E.x,H=ha-E.y,S=M,ha=H,da=-ha,ha=S,S=da,null==b._normals[K]?(Q=b._normals,qa=new O(S,ha),Q[K]=qa):(hb=b._normals[K],hb.x=S,hb.y=ha),fa=Y=L=sb=b._normals[K],P=fa.x*fa.x+fa.y*fa.y,R=0==P?1:Math.sqrt(P),ra=Y.x/R,T=Y.y/R,Z=ra,W=T,L.x=Z,L.y=W}ka=b._normals[n].x;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();gb=0;for(Ja=b.count;gb<Ja;)aa=gb++,null!=b.local_vertices[aa]&&(null==b._vertices[aa]&&(ja=b._vertices,la=new O(0,0),ja[aa]=
la),Fa=b.local_vertices[aa].x,pa=b.local_vertices[aa].y,null==pa&&(pa=0),null==Fa&&(Fa=0),Ba=b.transform.get_local_to_world_matrix(),Ua=Fa,ib=pa,Da=1,Xa=Ba.m00*Ua+Ba.m10*ib+Ba.m20*Da,ua=Ba.m01*Ua+Ba.m11*ib+Ba.m21*Da,xa=Xa,va=ua,ca=b._vertices[aa],ca.x=xa,ca.y=va);wa=0;for(Ca=b.count;wa<Ca;)oa=wa++,Ia=b._vertices[(oa+1)%b.count],na=Ia.x,sa=Ia.y,Fb=b._vertices[oa],Na=na-Fb.x,za=sa-Fb.y,na=Na,sa=za,db=-sa,sa=na,na=db,null==b._normals[oa]?(La=b._normals,Oa=new O(na,sa),La[oa]=Oa):(Ga=b._normals[oa],Ga.x=
na,Ga.y=sa),Ya=Ea=Ma=Aa=b._normals[oa],Pa=Ya.x*Ya.x+Ya.y*Ya.y,Sa=0==Pa?1:Math.sqrt(Pa),$a=Ea.x/Sa,Ta=Ea.y/Sa,ab=$a,cb=Ta,Ma.x=ab,Ma.y=cb}yb=ka;Db=b._normals[n].y;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();Ra=0;for(fb=b.count;Ra<fb;)kb=Ra++,null!=b.local_vertices[kb]&&(null==b._vertices[kb]&&(eb=b._vertices,X=new O(0,0),eb[kb]=X),Qa=b.local_vertices[kb].x,Za=b.local_vertices[kb].y,null==Za&&(Za=0),null==Qa&&(Qa=0),bb=b.transform.get_local_to_world_matrix(),
jb=Qa,vb=Za,bc=1,mb=bb.m00*jb+bb.m10*vb+bb.m20*bc,Nb=bb.m01*jb+bb.m11*vb+bb.m21*bc,nb=mb,Bb=Nb,Ha=b._vertices[kb],Ha.x=nb,Ha.y=Bb);Ka=0;for(Wa=b.count;Ka<Wa;)pb=Ka++,Xb=b._vertices[(pb+1)%b.count],lb=Xb.x,wb=Xb.y,ya=b._vertices[pb],Jb=lb-ya.x,cc=wb-ya.y,lb=Jb,wb=cc,Cb=-wb,wb=lb,lb=Cb,null==b._normals[pb]?(dc=b._normals,zb=new O(lb,wb),dc[pb]=zb):(Ab=b._normals[pb],Ab.x=lb,Ab.y=wb),id=ac=Hb=Mb=b._normals[pb],Ib=id.x*id.x+id.y*id.y,ob=0==Ib?1:Math.sqrt(Ib),Sb=ac.x/ob,Tb=ac.y/ob,Vb=Sb,Qb=Tb,Hb.x=Vb,
Hb.y=Qb}rb=b._vertices[0];Eb=Sc=yb*rb.x+Db*rb.y;for(var fc=1,Oc=b.count;fc<Oc;){Yb=fc++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var nc=0,lc=b.count;nc<lc;){var Wb=nc++;if(null!=b.local_vertices[Wb]){if(null==b._vertices[Wb]){var yc=b._vertices,wc=new O(0,0);yc[Wb]=wc}var oc=b.local_vertices[Wb].x;xb=b.local_vertices[Wb].y;null==xb&&(xb=0);null==oc&&(oc=0);var Pb=b.transform.get_local_to_world_matrix(),Zb=oc,pc=xb,ec=Pb.m00*Zb+Pb.m10*pc+1*Pb.m20,
gc=Pb.m01*Zb+Pb.m11*pc+1*Pb.m21;Kb=b._vertices[Wb];Kb.x=ec;Kb.y=gc}}for(var vc=0,Bc=b.count;vc<Bc;){var ic=vc++,xc=b._vertices[(ic+1)%b.count],mc=xc.x,Kd=xc.y,kc=b._vertices[ic],Hc=Kd-kc.y;mc-=kc.x;Kd=Hc;var Ic=-Kd;Kd=mc;mc=Ic;if(null==b._normals[ic]){var uc=b._normals,Jc=new O(mc,Kd);uc[ic]=Jc}else{var Kc=b._normals[ic];Kc.x=mc;Kc.y=Kd}var Lc=b._normals[ic],Mc=Lc,Cc=Lc,rc=Cc,Nc=rc.x*rc.x+rc.y*rc.y,Gc=0==Nc?1:Math.sqrt(Nc),Tc=Cc.y/Gc;Mc.x=Cc.x/Gc;Mc.y=Tc}}var jd=b._vertices[Yb];qb=yb*jd.x+Db*jd.y;
qb<Sc&&(Sc=qb);qb>Eb&&(Eb=qb)}Ob=q;Rb=-q;Ub=yb*-d+Db*-f;Sc+=Ub;Eb+=Ub;$b=Sc-Ob;zc=Rb-Eb;if(0<$b||0<zc)return Gb.put(),null;Lb=-(Ob-Sc);c&&(Lb*=-1);if(Math.abs(Lb)<jc){var Ac=Gb.normal;Ac.x=yb;Ac.y=Db;Gb.overlap=Lb;jc=Math.abs(Lb)}}Gb.sa=c?b:a;Gb.sb=c?a:b;Gb.overlap=Math.abs(Gb.overlap);c&&(D=Gb.normal,D.x=-D.x,D.y=-D.y);return Gb};ta.check_polygons=function(a,b,c){null==c&&(c=!1);for(var e=0,g=0,l=0,d=0,f=0,h=0,p=0,q=1073741823,r=null,n=0,A=0,k=0,w=a.count;k<w;){var y=k++;if(a.dirty_vertices){for(a.dirty_vertices=
!1;a._vertices.length>a.count;)a._vertices.pop();for(var J=0,u=a.count;J<u;){var t=J++;if(null!=a.local_vertices[t]){if(null==a._vertices[t]){var z=a._vertices,N=new O(0,0);z[t]=N}var v=a.local_vertices[t].x,ea=a.local_vertices[t].y;null==ea&&(ea=0);null==v&&(v=0);var B=a.transform.get_local_to_world_matrix(),ma=v,C=ea,U=B.m01*ma+B.m11*C+1*B.m21,D=a._vertices[t];D.x=B.m00*ma+B.m10*C+1*B.m20;D.y=U}}for(var I=0,G=a.count;I<G;){var F=I++,K=a._vertices[(F+1)%a.count],S=K.x,ha=K.y,E=a._vertices[F],Va=
ha-E.y;S-=E.x;ha=Va;var M=-ha;ha=S;S=M;if(null==a._normals[F]){var H=a._normals,da=new O(S,ha);H[F]=da}else{var hb=a._normals[F];hb.x=S;hb.y=ha}var Q=a._normals[F],qa=Q,L=Q,sb=L,fa=sb.x*sb.x+sb.y*sb.y,Y=0==fa?1:Math.sqrt(fa),P=L.y/Y;qa.x=L.x/Y;qa.y=P}}var R=a._normals[y].x;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var ra=0,T=a.count;ra<T;){var Z=ra++;if(null!=a.local_vertices[Z]){if(null==a._vertices[Z]){var Fb=a._vertices,W=new O(0,0);Fb[Z]=W}var V=
a.local_vertices[Z].x,ba=a.local_vertices[Z].y;null==ba&&(ba=0);null==V&&(V=0);var aa=a.transform.get_local_to_world_matrix(),ca=V,gb=ba,Ja=aa.m01*ca+aa.m11*gb+1*aa.m21,Ba=a._vertices[Z];Ba.x=aa.m00*ca+aa.m10*gb+1*aa.m20;Ba.y=Ja}}for(var ja=0,la=a.count;ja<la;){var ka=ja++,pa=a._vertices[(ka+1)%a.count],oa=pa.x,na=pa.y,Ua=a._vertices[ka],ib=na-Ua.y;oa-=Ua.x;na=ib;var sa=-na;na=oa;oa=sa;if(null==a._normals[ka]){var Da=a._normals,ta=new O(oa,na);Da[ka]=ta}else{var Xa=a._normals[ka];Xa.x=oa;Xa.y=na}var ua=
a._normals[ka],xa=ua,va=ua,Ia=va,wa=Ia.x*Ia.x+Ia.y*Ia.y,ya=0==wa?1:Math.sqrt(wa),Ca=va.y/ya;xa.x=va.x/ya;xa.y=Ca}}n=R;A=a._normals[y].y;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var Aa=0,Na=a.count;Aa<Na;){var za=Aa++;if(null!=a.local_vertices[za]){if(null==a._vertices[za]){var Fa=a._vertices,Ya=new O(0,0);Fa[za]=Ya}var Ga=a.local_vertices[za].x,Ha=a.local_vertices[za].y;null==Ha&&(Ha=0);null==Ga&&(Ga=0);var Ea=a.transform.get_local_to_world_matrix(),
La=Ga,Ma=Ha,Oa=Ea.m01*La+Ea.m11*Ma+1*Ea.m21,Pa=a._vertices[za];Pa.x=Ea.m00*La+Ea.m10*Ma+1*Ea.m20;Pa.y=Oa}}for(var Sa=0,$a=a.count;Sa<$a;){var Qa=Sa++,Za=a._vertices[(Qa+1)%a.count],Ta=Za.x,Ra=Za.y,ab=a._vertices[Qa],cb=Ra-ab.y;Ta-=ab.x;Ra=cb;var db=-Ra;Ra=Ta;Ta=db;if(null==a._normals[Qa]){var X=a._normals,fb=new O(Ta,Ra);X[Qa]=fb}else{var eb=a._normals[Qa];eb.x=Ta;eb.y=Ra}var bb=a._normals[Qa],jb=bb,vb=bb,mb=vb,nb=mb.x*mb.x+mb.y*mb.y,qb=0==nb?1:Math.sqrt(nb),Bb=vb.y/qb;jb.x=vb.x/qb;jb.y=Bb}}var Mb=
a._vertices[0];f=d=n*Mb.x+A*Mb.y;for(var yb=1,Ka=a.count;yb<Ka;){var Wa=yb++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var pb=0,Db=a.count;pb<Db;){var lb=pb++;if(null!=a.local_vertices[lb]){if(null==a._vertices[lb]){var wb=a._vertices,Eb=new O(0,0);wb[lb]=Eb}var rb=a.local_vertices[lb].x,Ab=a.local_vertices[lb].y;null==Ab&&(Ab=0);null==rb&&(rb=0);var Cb=a.transform.get_local_to_world_matrix(),ac=rb,Gb=Ab,Kb=Cb.m01*ac+Cb.m11*Gb+1*Cb.m21,Hb=a._vertices[lb];
Hb.x=Cb.m00*ac+Cb.m10*Gb+1*Cb.m20;Hb.y=Kb}}for(var Ib=0,Lb=a.count;Ib<Lb;){var ob=Ib++,Jb=a._vertices[(ob+1)%a.count],zb=Jb.x,xb=Jb.y,Ob=a._vertices[ob],Sb=xb-Ob.y;zb-=Ob.x;xb=Sb;var Tb=-xb;xb=zb;zb=Tb;if(null==a._normals[ob]){var Ub=a._normals,Vb=new O(zb,xb);Ub[ob]=Vb}else{var Qb=a._normals[ob];Qb.x=zb;Qb.y=xb}var Wb=a._normals[ob],Yb=Wb,Rb=Wb,Pb=Rb,$b=Pb.x*Pb.x+Pb.y*Pb.y,zc=0==$b?1:Math.sqrt($b),ic=Rb.y/zc;Yb.x=Rb.x/zc;Yb.y=ic}}var hc=a._vertices[Wa];l=n*hc.x+A*hc.y;l<d&&(d=l);l>f&&(f=l)}if(b.dirty_vertices){for(b.dirty_vertices=
!1;b._vertices.length>b.count;)b._vertices.pop();for(var jc=0,mc=b.count;jc<mc;){var fc=jc++;if(null!=b.local_vertices[fc]){if(null==b._vertices[fc]){var nc=b._vertices,oc=new O(0,0);nc[fc]=oc}var Oc=b.local_vertices[fc].x,lc=b.local_vertices[fc].y;null==lc&&(lc=0);null==Oc&&(Oc=0);var Zb=b.transform.get_local_to_world_matrix(),pc=Oc,rc=lc,yc=Zb.m01*pc+Zb.m11*rc+1*Zb.m21,vc=b._vertices[fc];vc.x=Zb.m00*pc+Zb.m10*rc+1*Zb.m20;vc.y=yc}}for(var wc=0,Cc=b.count;wc<Cc;){var ec=wc++,xc=b._vertices[(ec+1)%
b.count],kc=xc.x,gc=xc.y,Bc=b._vertices[ec],Kc=gc-Bc.y;kc-=Bc.x;gc=Kc;var Lc=-gc;gc=kc;kc=Lc;if(null==b._normals[ec]){var Mc=b._normals,Nc=new O(kc,gc);Mc[ec]=Nc}else{var Gc=b._normals[ec];Gc.x=kc;Gc.y=gc}var Hc=b._normals[ec],Ic=Hc,Ac=Hc,uc=Ac,Jc=uc.x*uc.x+uc.y*uc.y,Tc=0==Jc?1:Math.sqrt(Jc),nd=Ac.y/Tc;Ic.x=Ac.x/Tc;Ic.y=nd}}var Yc=b._vertices[0];p=h=n*Yc.x+A*Yc.y;for(var $c=1,rd=b.count;$c<rd;){var sd=$c++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();
for(var bd=0,xd=b.count;bd<xd;){var jd=bd++;if(null!=b.local_vertices[jd]){if(null==b._vertices[jd]){var yd=b._vertices,zd=new O(0,0);yd[jd]=zd}var Wc=b.local_vertices[jd].x,Xc=b.local_vertices[jd].y;null==Xc&&(Xc=0);null==Wc&&(Wc=0);var Dc=b.transform.get_local_to_world_matrix(),cd=Wc,dd=Xc,Ad=Dc.m01*cd+Dc.m11*dd+1*Dc.m21,ed=b._vertices[jd];ed.x=Dc.m00*cd+Dc.m10*dd+1*Dc.m20;ed.y=Ad}}for(var fd=0,Bd=b.count;fd<Bd;){var Ec=fd++,gd=b._vertices[(Ec+1)%b.count],Pc=gd.x,Fc=gd.y,hd=b._vertices[Ec],Cd=Fc-
hd.y;Pc-=hd.x;Fc=Cd;var Ed=-Fc;Fc=Pc;Pc=Ed;if(null==b._normals[Ec]){var Fd=b._normals,Gd=new O(Pc,Fc);Fd[Ec]=Gd}else{var kd=b._normals[Ec];kd.x=Pc;kd.y=Fc}var ld=b._normals[Ec],md=ld,Zc=ld,Vc=Zc,od=Vc.x*Vc.x+Vc.y*Vc.y,pd=0==od?1:Math.sqrt(od),Hd=Zc.y/pd;md.x=Zc.x/pd;md.y=Hd}}var qd=b._vertices[sd];l=n*qd.x+A*qd.y;l<h&&(h=l);l>p&&(p=l)}e=d-p;g=h-f;if(0<e||0<g)return null;var Uc=-(p-d);c&&(Uc*=-1);if(Math.abs(Uc)<q){if(null==r){var Id=n,Jd=A,Dd=sc.pool.get();Dd.sa=null;Dd.sb=null;for(var ad=Dd.contact_count=
0,td=Dd.contacts;ad<td.length;){var ud=td[ad];++ad;ud.x=0;ud.y=0}Dd.overlap=Uc;var vd=Dd.normal;vd.x=Id;vd.y=Jd;Dd.pooled=!1;r=Dd}else{r.overlap=Uc;var wd=r.normal;wd.x=n;wd.y=A}q=Math.abs(Uc)}}if(null==r)return null;r.sa=c?b:a;r.sb=c?a:b;c&&(D=r.normal,D.x=-D.x,D.y=-D.y);return r};var rc=function(a,b,c,e,g){null==g&&(g=1);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.dirty=this.inverse_dirty=this.coordinates_dirty=!1;this.local_to_world_matrix=new ie(1,0,0,0,1,0,0,0,1);this.children=
[];this._scale_x=this._scale_y=1;this._x=this._y=this._radians=0;this.on_dirty=null;this.dirty||this.set_dirty();this.local_x=a;this.dirty||this.set_dirty();this.local_y=b;a=Math.PI/180*c;this.dirty||this.set_dirty();this.local_radians=a;this.dirty||this.set_dirty();this.local_scale_x=e;this.dirty||this.set_dirty();this.local_scale_y=g};d["echo.util.Transform"]=rc;rc.__name__=!0;rc.__interfaces__=[sb];rc.prototype={set_parent:function(a,b){null!=this.parent&&K.remove(this.parent.children,this);this.parent=
a;null!=a&&this.parent.children.push(this);this.set_dirty()},get_local_to_world_matrix:function(){if(this.dirty){if(null==this.parent){var a=this.local_to_world_matrix,b=Math.sin(this.local_radians),c=Math.cos(this.local_radians),e=c*this.local_scale_x,g=-b*this.local_scale_y,l=this.local_x;b*=this.local_scale_x;var d=c*this.local_scale_y,f=this.local_y;a.m00=e;a.m10=g;a.m20=l;a.m01=b;a.m11=d;a.m21=f;a.m02=0;a.m12=0;a.m22=1}else{a=this.local_to_world_matrix;var h=this.parent.get_local_to_world_matrix();
b=Math.sin(this.local_radians);c=Math.cos(this.local_radians);e=c*this.local_scale_x;g=-b*this.local_scale_y;l=this.local_x;b*=this.local_scale_x;d=c*this.local_scale_y;f=this.local_y;c=h.m00*g+h.m10*d+0*h.m20;var p=h.m00*l+h.m10*f+1*h.m20,q=h.m01*e+h.m11*b+0*h.m21,r=h.m01*g+h.m11*d+0*h.m21,n=h.m01*l+h.m11*f+1*h.m21,A=h.m02*e+h.m12*b+0*h.m22;g=h.m02*g+h.m12*d+0*h.m22;l=h.m02*l+h.m12*f+1*h.m22;a.m00=h.m00*e+h.m10*b+0*h.m20;a.m10=c;a.m20=p;a.m01=q;a.m11=r;a.m21=n;a.m02=A;a.m12=g;a.m22=l}this.dirty=
!1}return this.local_to_world_matrix},sync:function(){if(this.coordinates_dirty){var a=this.get_local_to_world_matrix();if(null==this.parent)this._x=this.local_x,this._y=this.local_y,this._scale_x=this.local_scale_x,this._scale_y=this.local_scale_y,this._radians=this.local_radians;else{var b=a.m00,c=a.m01,e=a.m10,g=a.m11;this._x=a.m20;this._y=a.m21;this._scale_x=Math.sqrt(b*b+c*c);this._scale_y=Math.sqrt(e*e+g*g);this._radians=180/Math.PI*Math.atan2(-e/this._scale_y,b/this._scale_x)}this.coordinates_dirty=
!1}},set_dirty:function(){this.dirty=this.inverse_dirty=this.coordinates_dirty=!0;for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.set_dirty()}if(null!=this.on_dirty)this.on_dirty(this)},__class__:rc};var Yb=y["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:n},Module:(h=function(a){return{_hx_index:1,m:a,__enum__:"haxe.StackItem",toString:n}},h._hx_name="Module",h.__params__=["m"],h),FilePos:(h=function(a,
b,c,e){return{_hx_index:2,s:a,file:b,line:c,column:e,__enum__:"haxe.StackItem",toString:n}},h._hx_name="FilePos",h.__params__=["s","file","line","column"],h),Method:(h=function(a,b){return{_hx_index:3,classname:a,method:b,__enum__:"haxe.StackItem",toString:n}},h._hx_name="Method",h.__params__=["classname","method"],h),LocalFunction:(h=function(a){return{_hx_index:4,v:a,__enum__:"haxe.StackItem",toString:n}},h._hx_name="LocalFunction",h.__params__=["v"],h)};Yb.__constructs__=[Yb.CFunction,Yb.Module,
Yb.FilePos,Yb.Method,Yb.LocalFunction];var xc={callStack:function(){return ja.toHaxe(ja.callStack())},exceptionStack:function(a){null==a&&(a=!1);var b=ja.toHaxe(ja.exceptionStack());return a?b:xc.subtract(b,xc.callStack())},toString:function(a){for(var b=new A,c=0;c<a.length;){var e=a[c];++c;b.b+="\nCalled from ";xc.itemToString(b,e)}return b.b},subtract:function(a,b){for(var c=-1,e=-1;++e<a.length;){for(var g=0,l=b.length;g<l;){var d=g++;if(xc.equalItems(a[e],b[d])){if(0>c&&(c=e),++e,e>=a.length)break}else c=
-1}if(0<=c)break}return 0<=c?a.slice(0,c):a},equalItems:function(a,b){if(null==a)return null==b?!0:!1;switch(a._hx_index){case 0:return null==b?!1:0==b._hx_index?!0:!1;case 1:return null==b?!1:1==b._hx_index?a.m==b.m:!1;case 2:if(null==b)return!1;if(2==b._hx_index){var c=b.s,e=b.line,g=b.column,l=a.column,d=a.line,f=a.s;return a.file==b.file&&d==e&&l==g?xc.equalItems(f,c):!1}return!1;case 3:return null==b?!1:3==b._hx_index?(c=b.method,e=a.method,a.classname==b.classname?e==c:!1):!1;case 4:return null==
b?!1:4==b._hx_index?a.v==b.v:!1}},itemToString:function(a,b){switch(b._hx_index){case 0:a.b+="a C function";break;case 1:b=b.m;a.b+="module ";a.b+=null==b?"null":""+b;break;case 2:var c=b.s,e=b.file,g=b.line;b=b.column;null!=c&&(xc.itemToString(a,c),a.b+=" (");a.b+=null==e?"null":""+e;a.b+=" line ";a.b+=null==g?"null":""+g;null!=b&&(a.b+=" column ",a.b+=null==b?"null":""+b);null!=c&&(a.b+=")");break;case 3:c=b.classname;b=b.method;a.b+=p.string(null==c?"<unknown>":c);a.b+=".";a.b+=null==b?"null":
""+b;break;case 4:b=b.v,a.b+="local function #",a.b+=null==b?"null":""+b}}},kc=function(){};d["haxe.IMap"]=kc;kc.__name__=!0;kc.__isInterface__=!0;kc.prototype={__class__:kc};var z=function(a,b,c){Error.call(this,a);this.message=a;this.__previousException=b;this.__nativeException=null!=c?c:this;this.__skipStack=0;a=Error.prepareStackTrace;Error.prepareStackTrace=function(a){return a.stack};if(c instanceof Error)this.stack=c.stack;else{c=null;if(Error.captureStackTrace)Error.captureStackTrace(this,
z),c=this;else if(c=Error(),"undefined"==typeof c.stack){try{throw c;}catch(e){}this.__skipStack++}this.stack=c.stack}Error.prepareStackTrace=a};d["haxe.Exception"]=z;z.__name__=!0;z.caught=function(a){return a instanceof z?a:a instanceof Error?new z(a.message,null,a):new Tc(a,null,a)};z.thrown=function(a){if(a instanceof z)return a.get_native();if(a instanceof Error)return a;a=new Tc(a);a.__skipStack++;return a};z.__super__=Error;z.prototype=B(Error.prototype,{unwrap:function(){return this.__nativeException},
toString:function(){return this.get_message()},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_native:function(){return this.__nativeException},get_stack:function(){var a=this.__exceptionStack;null==a&&(a=ja.toHaxe(ja.normalize(this.stack),this.__skipStack),this.setProperty("__exceptionStack",a));return a},setProperty:function(a,b){try{Object.defineProperty(this,a,{value:b})}catch(c){this[a]=b}},__class__:z,__properties__:{get_native:"get_native",get_stack:"get_stack",
get_message:"get_message"}});var la=function(){};d["haxe.Log"]=la;la.__name__=!0;la.formatOutput=function(a,b){var c=p.string(a);if(null==b)return c;var e=b.fileName+":"+b.lineNumber;if(null!=b.customParams){var g=0;for(b=b.customParams;g<b.length;)a=b[g],++g,c+=", "+p.string(a)}return e+": "+c};la.trace=function(a,b){a=la.formatOutput(a,b);"undefined"!=typeof console&&null!=console.log&&console.log(a)};var ja=function(){};d["haxe.NativeStackTrace"]=ja;ja.__name__=!0;ja.saveStack=function(a){ja.lastError=
a};ja.callStack=function(){var a=Error(""),b=ja.tryHaxeStack(a);if("undefined"==typeof b){try{throw a;}catch(c){}b=a.stack}return ja.normalize(b,2)};ja.exceptionStack=function(){return ja.normalize(ja.tryHaxeStack(ja.lastError))};ja.toHaxe=function(a,b){null==b&&(b=0);if(null==a)return[];if("string"==typeof a){a=a.split("\n");"Error"==a[0]&&a.shift();for(var c=[],e=0,g=a.length;e<g;){var l=e++;if(!(b>l)){var d=a[l];l=d.match(/^    at ([A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=l){d=
l[1].split(".");"$hxClasses"==d[0]&&d.shift();var f=d.pop(),h=l[2],n=p.parseInt(l[3]);l=p.parseInt(l[4]);c.push(Yb.FilePos("Anonymous function"==f?Yb.LocalFunction():"Global code"==f?null:Yb.Method(d.join("."),f),h,n,l))}else c.push(Yb.Module(q.trim(d)))}}return c}return 0<b&&Array.isArray(a)?a.slice(b):a};ja.tryHaxeStack=function(a){if(null==a)return[];var b=Error.prepareStackTrace;Error.prepareStackTrace=ja.prepareHxStackTrace;a=a.stack;Error.prepareStackTrace=b;return a};ja.prepareHxStackTrace=
function(a,b){a=[];for(var c=0;c<b.length;){var e=b[c];++c;null!=ja.wrapCallSite&&(e=ja.wrapCallSite(e));var g=null,l=e.getFunctionName();if(null!=l){var d=l.lastIndexOf(".");0<=d?(g=l.substring(0,d),l=l.substring(d+1),g=Yb.Method(g,l)):g=Yb.Method(null,l)}l=e.getFileName();d=null==l?-1:l.indexOf("file:");null!=ja.wrapCallSite&&0<d&&(l=l.substring(d+6));a.push(Yb.FilePos(g,l,e.getLineNumber(),e.getColumnNumber()))}return a};ja.normalize=function(a,b){null==b&&(b=0);if(Array.isArray(a)&&0<b)return a.slice(b);
if("string"==typeof a){switch(a.substring(0,6)){case "Error\n":case "Error:":++b}return ja.skipLines(a,b)}return a};ja.skipLines=function(a,b,c){null==c&&(c=0);return 0<b?(c=a.indexOf("\n",c),0>c?"":ja.skipLines(a,--b,c+1)):a.substring(c)};var Ed=function(){};d["haxe._Unserializer.DefaultResolver"]=Ed;Ed.__name__=!0;Ed.prototype={resolveClass:function(a){return d[a]},resolveEnum:function(a){return y[a]},__class__:Ed};var Jb=function(a){this.buf=a;this.length=this.buf.length;this.pos=0;this.scache=
[];this.cache=[];a=Jb.DEFAULT_RESOLVER;null==a&&(a=new Ed,Jb.DEFAULT_RESOLVER=a);this.resolver=a};d["haxe.Unserializer"]=Jb;Jb.__name__=!0;Jb.initCodes=function(){for(var a=[],b=0,c=Jb.BASE64.length;b<c;){var e=b++;a[Jb.BASE64.charCodeAt(e)]=e}return a};Jb.run=function(a){return(new Jb(a)).unserialize()};Jb.prototype={readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(45==e){if(this.pos!=c)break;b=!0}else{if(48>e||57<e)break;a=10*a+(e-48)}this.pos++}b&&
(a*=-1);return a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(b!=b)break;if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return parseFloat(K.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw z.thrown("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw z.thrown("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,
b){if(58!=this.buf.charCodeAt(this.pos++))throw z.thrown("Invalid enum format");var c=this.readDigits();if(0==c)return ea.createEnum(a,b);for(var e=[];0<c--;)e.push(this.unserialize());return ea.createEnum(a,b,e)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var a=this.unserialize(),b=this.resolver.resolveClass(a);if(null==b)throw z.thrown("Class not found "+a);return b;case 66:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw z.thrown("Enum not found "+
a);return b;case 67:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw z.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);b.hxUnserialize(this);if(103!=this.buf.charCodeAt(this.pos++))throw z.thrown("Invalid custom data");return b;case 77:a=new xb;this.cache.push(a);for(var c;104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),a.set(b,this.unserialize());this.pos++;return a;case 82:a=this.readDigits();if(0>a||a>=this.scache.length)throw z.thrown("Invalid string reference");
return this.scache[a];case 97:b=[];for(this.cache.push(b);;){c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}117==c?(this.pos++,a=this.readDigits(),b[b.length+a-1]=null):b.push(this.unserialize())}return b;case 98:a=new T;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),c=this.unserialize(),a.h[b]=c;this.pos++;return a;case 99:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw z.thrown("Class not found "+a);b=Object.create(b.prototype);
this.cache.push(b);this.unserializeObject(b);return b;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw z.thrown("Enum not found "+a);this.pos++;for(var e=this.readDigits(),g=c.__constructs__,l=Array(g.length),d=0,f=g.length;d<f;)b=d++,l[b]=g[b]._hx_name;b=l[e];if(null==b)throw z.thrown("Unknown enum index "+a+"@"+e);b=this.unserializeEnum(c,b);this.cache.push(b);return b;case 107:return NaN;
case 108:b=new yb;for(this.cache.push(b);104!=this.buf.charCodeAt(this.pos);)b.add(this.unserialize());this.pos++;return b;case 109:return-Infinity;case 110:return null;case 111:return b={},this.cache.push(b),this.unserializeObject(b),b;case 112:return Infinity;case 113:a=new Kb;this.cache.push(a);for(c=this.buf.charCodeAt(this.pos++);58==c;)b=this.readDigits(),c=this.unserialize(),a.h[b]=c,c=this.buf.charCodeAt(this.pos++);if(104!=c)throw z.thrown("Invalid IntMap format");return a;case 114:a=this.readDigits();
if(0>a||a>=this.cache.length)throw z.thrown("Invalid reference");return this.cache[a];case 115:a=this.readDigits();c=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw z.thrown("Invalid bytes length");e=Jb.CODES;null==e&&(e=Jb.initCodes(),Jb.CODES=e);b=this.pos;g=a&3;l=b+(a-g);d=new Ma(new ArrayBuffer(3*(a>>2)+(2<=g?g-1:0)));for(f=0;b<l;){var h=e[c.charCodeAt(b++)],p=e[c.charCodeAt(b++)];d.b[f++]=(h<<2|p>>4)&255;h=e[c.charCodeAt(b++)];d.b[f++]=(p<<4|h>>2)&255;p=e[c.charCodeAt(b++)];
d.b[f++]=(h<<6|p)&255}2<=g&&(h=e[c.charCodeAt(b++)],p=e[c.charCodeAt(b++)],d.b[f++]=(h<<2|p>>4)&255,3==g&&(h=e[c.charCodeAt(b++)],d.b[f++]=(p<<4|h>>2)&255));this.pos+=a;this.cache.push(d);return d;case 116:return!0;case 118:return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&48<=this.buf.charCodeAt(this.pos+1)&&57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+
3)&&45==this.buf.charCodeAt(this.pos+4)?(b=K.strDate(K.substr(this.buf,this.pos,19)),this.pos+=19):b=new Date(this.readFloat()),this.cache.push(b),b;case 119:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw z.thrown("Enum not found "+a);b=this.unserializeEnum(c,this.unserialize());this.cache.push(b);return b;case 120:throw z.thrown(this.unserialize());case 121:a=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw z.thrown("Invalid string length");
b=K.substr(this.buf,this.pos,a);this.pos+=a;b=decodeURIComponent(b.split("+").join(" "));this.scache.push(b);return b;case 122:return 0}this.pos--;throw z.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos);},__class__:Jb};var Tc=function(a,b,c){z.call(this,String(a),b,c);this.value=a;this.__skipStack++};d["haxe.ValueException"]=Tc;Tc.__name__=!0;Tc.__super__=z;Tc.prototype=B(z.prototype,{unwrap:function(){return this.value},__class__:Tc});var Hc=function(){this.a1=1;this.a2=
0};d["haxe.crypto.Adler32"]=Hc;Hc.__name__=!0;Hc.read=function(a){var b=new Hc,c=a.readByte(),e=a.readByte(),g=a.readByte();a=a.readByte();b.a1=g<<8|a;b.a2=c<<8|e;return b};Hc.prototype={update:function(a,b,c){var e=this.a1,g=this.a2,l=b;for(b+=c;l<b;)c=l++,e=(e+a.b[c])%65521,g=(g+e)%65521;this.a1=e;this.a2=g},equals:function(a){return a.a1==this.a1?a.a2==this.a2:!1},__class__:Hc};var Ma=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};
d["haxe.io.Bytes"]=Ma;Ma.__name__=!0;Ma.ofString=function(a,b){b=[];for(var c=0;c<a.length;){var e=a.charCodeAt(c++);55296<=e&&56319>=e&&(e=e-55232<<10|a.charCodeAt(c++)&1023);127>=e?b.push(e):(2047>=e?b.push(192|e>>6):(65535>=e?b.push(224|e>>12):(b.push(240|e>>18),b.push(128|e>>12&63)),b.push(128|e>>6&63)),b.push(128|e&63))}return new Ma((new Uint8Array(b)).buffer)};Ma.ofData=function(a){var b=a.hxBytes;return null!=b?b:new Ma(a)};Ma.prototype={blit:function(a,b,c,e){if(0>a||0>c||0>e||a+e>this.length||
c+e>b.length)throw z.thrown(Ob.OutsideBounds);0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},getString:function(a,b,c){if(0>a||0>b||a+b>this.length)throw z.thrown(Ob.OutsideBounds);c="";var e=this.b,g=hb.fromCharCode,l=a;for(a+=b;l<a;)if(b=e[l++],128>b){if(0==b)break;c+=g(b)}else if(224>b)c+=g((b&63)<<6|e[l++]&127);else if(240>b){var d=e[l++];c+=g((b&31)<<12|(d&127)<<6|e[l++]&127)}else{d=e[l++];var f=e[l++];b=(b&15)<<18|(d&127)<<12|(f&127)<<6|e[l++]&127;c+=g((b>>10)+
55232);c+=g(b&1023|56320)}return c},toString:function(){return this.getString(0,this.length)},__class__:Ma};var Nc=y["haxe.ds.Either"]={__ename__:!0,__constructs__:null,Left:(h=function(a){return{_hx_index:0,v:a,__enum__:"haxe.ds.Either",toString:n}},h._hx_name="Left",h.__params__=["v"],h),Right:(h=function(a){return{_hx_index:1,v:a,__enum__:"haxe.ds.Either",toString:n}},h._hx_name="Right",h.__params__=["v"],h)};Nc.__constructs__=[Nc.Left,Nc.Right];var Kb=function(){this.h={}};d["haxe.ds.IntMap"]=
Kb;Kb.__name__=!0;Kb.__interfaces__=[kc];Kb.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(+b);return new Cc(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref[a]}}},
toString:function(){var a="{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=null==c?"null":""+c;a+=" => ";a+=p.string(p.string(this.h[c]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:Kb};var yb=function(){this.length=0};d["haxe.ds.List"]=yb;yb.__name__=!0;yb.prototype={add:function(a){a=new Fd(a,null);null==this.h?this.h=a:this.q.next=a;this.q=a;this.length++},push:function(a){this.h=a=new Fd(a,this.h);null==this.q&&(this.q=a);this.length++},first:function(){return null==this.h?null:this.h.item},
pop:function(){if(null==this.h)return null;var a=this.h.item;this.h=this.h.next;null==this.h&&(this.q=null);this.length--;return a},isEmpty:function(){return null==this.h},toString:function(){var a,b=!0,c=this.h;for(a="{";null!=c;)b?b=!1:a+=", ",a+=p.string(p.string(c.item)),c=c.next;return a+"}"},__class__:yb};var Fd=function(a,b){this.item=a;this.next=b};d["haxe.ds._List.ListNode"]=Fd;Fd.__name__=!0;Fd.prototype={__class__:Fd};var xb=function(){this.h={__keys__:{}}};d["haxe.ds.ObjectMap"]=xb;xb.__name__=
!0;xb.__interfaces__=[kc];xb.prototype={set:function(a,b){var c=a.__id__;null==c&&(c=a.__id__=v.$haxeUID++);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},exists:function(a){return null!=this.h.__keys__[a.__id__]},remove:function(a){a=a.__id__;if(null==this.h.__keys__[a])return!1;delete this.h[a];delete this.h.__keys__[a];return!0},keys:function(){var a=[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return new Cc(a)},toString:function(){var a=
"{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=p.string(p.string(c));a+=" => ";a+=p.string(p.string(this.h[c.__id__]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:xb};var T=function(){this.h=Object.create(null)};d["haxe.ds.StringMap"]=T;T.__name__=!0;T.__interfaces__=[kc];T.stringify=function(a){var b="{",c=!0,e;for(e in a)c?c=!1:b+=",",b+=e+" => "+p.string(a[e]);return b+"}"};T.prototype={exists:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)},get:function(a){return this.h[a]},
set:function(a,b){this.h[a]=b},remove:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)?(delete this.h[a],!0):!1},toString:function(){return T.stringify(this.h)},__class__:T};var Ic=function(a,b,c){z.call(this,a,b);this.posInfos=null==c?{fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:c;this.__skipStack++};d["haxe.exceptions.PosException"]=Ic;Ic.__name__=!0;Ic.__super__=z;Ic.prototype=B(z.prototype,{toString:function(){return""+z.prototype.toString.call(this)+
" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber},__class__:Ic});var Gd=function(a,b,c){null==a&&(a="Not implemented");Ic.call(this,a,b,c);this.__skipStack++};d["haxe.exceptions.NotImplementedException"]=Gd;Gd.__name__=!0;Gd.__super__=Ic;Gd.prototype=B(Ic.prototype,{__class__:Gd});var kd=function(){this.size=this.pos=0};d["haxe.io.BytesBuffer"]=kd;kd.__name__=!0;kd.prototype={addByte:function(a){this.pos==this.size&&this.grow(1);
this.view.setUint8(this.pos++,a)},add:function(a){this.pos+a.length>this.size&&this.grow(a.length);if(0!=this.size){var b=new Uint8Array(a.b.buffer,a.b.byteOffset,a.length);this.u8.set(b,this.pos);this.pos+=a.length}},addBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw z.thrown(Ob.OutsideBounds);this.pos+c>this.size&&this.grow(c);0!=this.size&&(a=new Uint8Array(a.b.buffer,a.b.byteOffset+b,c),this.u8.set(a,this.pos),this.pos+=c)},grow:function(a){var b=this.pos+a;for(a=0==this.size?16:this.size;a<
b;)a=3*a>>1;b=new ArrayBuffer(a);var c=new Uint8Array(b);0<this.size&&c.set(this.u8);this.size=a;this.buffer=b;this.u8=c;this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new Ma(new ArrayBuffer(0));var a=new Ma(this.buffer);a.length=this.pos;return a},__class__:kd};var ld=function(){};d["haxe.io.Input"]=ld;ld.__name__=!0;ld.prototype={readByte:function(){throw new Gd(null,null,{fileName:"haxe/io/Input.hx",lineNumber:53,className:"haxe.io.Input",methodName:"readByte"});
},readBytes:function(a,b,c){var e=c,g=a.b;if(0>b||0>c||b+c>a.length)throw z.thrown(Ob.OutsideBounds);try{for(;0<e;)g[b]=this.readByte(),++b,--e}catch(l){if(ja.lastError=l,!(z.caught(l).unwrap()instanceof Ac))throw l;}return c-e},readFullBytes:function(a,b,c){for(;0<c;){var e=this.readBytes(a,b,c);if(0==e)throw z.thrown(Ob.Blocked);b+=e;c-=e}},read:function(a){for(var b=new Ma(new ArrayBuffer(a)),c=0;0<a;){var e=this.readBytes(b,c,a);if(0==e)throw z.thrown(Ob.Blocked);c+=e;a-=e}return b},readInt16:function(){var a=
this.readByte(),b=this.readByte();a=this.bigEndian?b|a<<8:a|b<<8;return 0!=(a&32768)?a-65536:a},readUInt16:function(){var a=this.readByte(),b=this.readByte();return this.bigEndian?b|a<<8:a|b<<8},readInt32:function(){var a=this.readByte(),b=this.readByte(),c=this.readByte(),e=this.readByte();return this.bigEndian?e|c<<8|b<<16|a<<24:a|b<<8|c<<16|e<<24},readString:function(a,b){var c=new Ma(new ArrayBuffer(a));this.readFullBytes(c,0,a);return c.getString(0,a,b)},__class__:ld};var md=function(a,b,c){null==
b&&(b=0);null==c&&(c=a.length-b);if(0>b||0>c||b+c>a.length)throw z.thrown(Ob.OutsideBounds);this.b=a.b;this.pos=b;this.totlen=this.len=c};d["haxe.io.BytesInput"]=md;md.__name__=!0;md.__super__=ld;md.prototype=B(ld.prototype,{readByte:function(){if(0==this.len)throw z.thrown(new Ac);this.len--;return this.b[this.pos++]},readBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw z.thrown(Ob.OutsideBounds);if(0==this.len&&0<c)throw z.thrown(new Ac);this.len<c&&(c=this.len);var e=this.b;a=a.b;for(var g=
0,l=c;g<l;){var d=g++;a[b+d]=e[this.pos+d]}this.pos+=c;this.len-=c;return c},__class__:md});var Se=y["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}};Se.__constructs__=[Se.UTF8,Se.RawNative];var Ac=function(){};d["haxe.io.Eof"]=Ac;Ac.__name__=!0;Ac.prototype={toString:function(){return"Eof"},__class__:Ac};var Ob=y["haxe.io.Error"]={__ename__:!0,
__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(h=function(a){return{_hx_index:3,e:a,__enum__:"haxe.io.Error",toString:n}},h._hx_name="Custom",h.__params__=["e"],h)};Ob.__constructs__=[Ob.Blocked,Ob.Overflow,Ob.OutsideBounds,Ob.Custom];var gc=function(a){switch(a){case ".":case "..":this.dir=
a;this.file="";return}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this.dir=K.substr(a,0,c),a=K.substr(a,c+1,null),this.backslash=!0):c<b?(this.dir=K.substr(a,0,b),a=K.substr(a,b+1,null)):this.dir=null;b=a.lastIndexOf(".");-1!=b?(this.ext=K.substr(a,b+1,null),this.file=K.substr(a,0,b)):(this.ext=null,this.file=a)};d["haxe.io.Path"]=gc;gc.__name__=!0;gc.directory=function(a){a=new gc(a);return null==a.dir?"":a.dir};gc.prototype={__class__:gc};var Cc=function(a){this.current=0;this.array=a};
d["haxe.iterators.ArrayIterator"]=Cc;Cc.__name__=!0;Cc.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Cc};var uc=y["haxe.zip.ExtraField"]={__ename__:!0,__constructs__:null,FUnknown:(h=function(a,b){return{_hx_index:0,tag:a,bytes:b,__enum__:"haxe.zip.ExtraField",toString:n}},h._hx_name="FUnknown",h.__params__=["tag","bytes"],h),FInfoZipUnicodePath:(h=function(a,b){return{_hx_index:1,name:a,crc:b,__enum__:"haxe.zip.ExtraField",
toString:n}},h._hx_name="FInfoZipUnicodePath",h.__params__=["name","crc"],h),FUtf8:{_hx_name:"FUtf8",_hx_index:2,__enum__:"haxe.zip.ExtraField",toString:n}};uc.__constructs__=[uc.FUnknown,uc.FInfoZipUnicodePath,uc.FUtf8];var Rb=y["haxe.zip.Huffman"]={__ename__:!0,__constructs__:null,Found:(h=function(a){return{_hx_index:0,i:a,__enum__:"haxe.zip.Huffman",toString:n}},h._hx_name="Found",h.__params__=["i"],h),NeedBit:(h=function(a,b){return{_hx_index:1,left:a,right:b,__enum__:"haxe.zip.Huffman",toString:n}},
h._hx_name="NeedBit",h.__params__=["left","right"],h),NeedBits:(h=function(a,b){return{_hx_index:2,n:a,table:b,__enum__:"haxe.zip.Huffman",toString:n}},h._hx_name="NeedBits",h.__params__=["n","table"],h)};Rb.__constructs__=[Rb.Found,Rb.NeedBit,Rb.NeedBits];var je=function(){};d["haxe.zip.HuffTools"]=je;je.__name__=!0;je.prototype={treeDepth:function(a){switch(a._hx_index){case 0:return 0;case 1:var b=a.right;a=this.treeDepth(a.left);b=this.treeDepth(b);return 1+(a<b?a:b);case 2:throw z.thrown("assert");
}},treeCompress:function(a){var b=this.treeDepth(a);if(0==b)return a;if(1==b){if(1==a._hx_index)return b=a.right,Rb.NeedBit(this.treeCompress(a.left),this.treeCompress(b));throw z.thrown("assert");}for(var c=[],e=0,g=1<<b;e<g;)e++,c.push(Rb.Found(-1));this.treeWalk(c,0,0,b,a);return Rb.NeedBits(b,c)},treeWalk:function(a,b,c,e,g){if(1==g._hx_index){var l=g.left,d=g.right;0<e?(this.treeWalk(a,b,c+1,e-1,l),this.treeWalk(a,b|1<<c,c+1,e-1,d)):a[b]=this.treeCompress(g)}else a[b]=this.treeCompress(g)},treeMake:function(a,
b,c,e){if(e>b)throw z.thrown("Invalid huffman");var g=c<<5|e;if(a.h.hasOwnProperty(g))return Rb.Found(a.h[g]);c<<=1;++e;return Rb.NeedBit(this.treeMake(a,b,c,e),this.treeMake(a,b,c|1,e))},make:function(a,b,c,e){if(1==c)return Rb.NeedBit(Rb.Found(0),Rb.Found(0));var g=[],l=[];if(32<e)throw z.thrown("Invalid huffman");for(var d=0,f=e;d<f;)d++,g.push(0),l.push(0);d=0;for(f=c;d<f;){var h=d++;h=a[h+b];if(h>=e)throw z.thrown("Invalid huffman");g[h]++}var p=0;d=1;for(f=e-1;d<f;)h=d++,p=p+g[h]<<1,l[h]=p;
g=new Kb;d=0;for(f=c;d<f;)h=d++,c=a[h+b],0!=c&&(p=l[c-1],l[c-1]=p+1,g.h[p<<5|c]=h);return this.treeCompress(Rb.NeedBit(this.treeMake(g,e,0,1),this.treeMake(g,e,1,1)))},__class__:je};var ke=function(a){this.buffer=new Ma(new ArrayBuffer(65536));this.pos=0;a&&(this.crc=new Hc)};d["haxe.zip._InflateImpl.Window"]=ke;ke.__name__=!0;ke.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,0,32768);var a=new Ma(new ArrayBuffer(65536));this.pos-=32768;a.blit(0,this.buffer,32768,this.pos);
this.buffer=a},addBytes:function(a,b,c){65536<this.pos+c&&this.slide();this.buffer.blit(this.pos,a,b,c);this.pos+=c},addByte:function(a){65536==this.pos&&this.slide();this.buffer.b[this.pos]=a&255;this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){null!=this.crc&&this.crc.update(this.buffer,0,this.pos);return this.crc},__class__:ke};var Fa=y["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:null,Head:{_hx_name:"Head",
_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:n},Block:{_hx_name:"Block",_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:n},CData:{_hx_name:"CData",_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",toString:n},Flat:{_hx_name:"Flat",_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:n},Crc:{_hx_name:"Crc",_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:n},Dist:{_hx_name:"Dist",_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:n},DistOne:{_hx_name:"DistOne",
_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:n},Done:{_hx_name:"Done",_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:n}};Fa.__constructs__=[Fa.Head,Fa.Block,Fa.CData,Fa.Flat,Fa.Crc,Fa.Dist,Fa.DistOne,Fa.Done];var db=function(a,b,c){null==c&&(c=!0);null==b&&(b=!0);this.isFinal=!1;this.htools=new je;this.huffman=this.buildFixedHuffman();this.huffdist=null;this.dist=this.len=0;this.state=b?Fa.Head:Fa.Block;this.input=a;this.needed=this.nbits=this.bits=0;this.output=null;this.outpos=
0;this.lengths=[];this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.window=new ke(c)};d["haxe.zip.InflateImpl"]=db;db.__name__=!0;
db.prototype={buildFixedHuffman:function(){if(null!=db.FIXED_HUFFMAN)return db.FIXED_HUFFMAN;for(var a=[],b=0;288>b;){var c=b++;a.push(143>=c?8:255>=c?9:279>=c?7:8)}db.FIXED_HUFFMAN=this.htools.make(a,0,288,10);return db.FIXED_HUFFMAN},readBytes:function(a,b,c){this.needed=c;this.outpos=b;this.output=a;if(0<c)for(;this.inflateLoop(););return c-this.needed},getBits:function(a){for(;this.nbits<a;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var b=this.bits&(1<<a)-1;this.nbits-=a;this.bits>>=
a;return b},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var a=1==(this.bits&1);this.nbits--;this.bits>>=1;return a},getRevBits:function(a){return 0==a?0:this.getBit()?1<<a-1|this.getRevBits(a-1):this.getRevBits(a-1)},resetBits:function(){this.nbits=this.bits=0},addBytes:function(a,b,c){this.window.addBytes(a,b,c);this.output.blit(this.outpos,a,b,c);this.needed-=c;this.outpos+=c},addByte:function(a){this.window.addByte(a);this.output.b[this.outpos]=a&255;this.needed--;
this.outpos++},addDistOne:function(a){for(var b=this.window.getLastChar(),c=0;c<a;)c++,this.addByte(b)},addDist:function(a,b){this.addBytes(this.window.buffer,this.window.pos-a,b)},applyHuffman:function(a){switch(a._hx_index){case 0:var b=a.i;return b;case 1:return b=a.left,a=a.right,this.applyHuffman(this.getBit()?a:b);case 2:return b=a.n,this.applyHuffman(a.table[this.getBits(b)])}},inflateLengths:function(a,b){for(var c=0,e=0;c<b;){var g=this.applyHuffman(this.huffman);switch(g){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:e=
g;a[c]=g;++c;break;case 16:g=c+3+this.getBits(2);if(g>b)throw z.thrown("Invalid data");for(;c<g;)a[c]=e,++c;break;case 17:c+=3+this.getBits(3);if(c>b)throw z.thrown("Invalid data");break;case 18:c+=11+this.getBits(7);if(c>b)throw z.thrown("Invalid data");break;default:throw z.thrown("Invalid data");}}},inflateLoop:function(){switch(this.state._hx_index){case 0:var a=this.input.readByte();if(8!=(a&15))throw z.thrown("Invalid data");var b=this.input.readByte(),c=0!=(b&32);if(0!=((a<<8)+b)%31)throw z.thrown("Invalid data");
if(c)throw z.thrown("Unsupported dictionary");this.state=Fa.Block;return!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:this.len=this.input.readUInt16();if(this.input.readUInt16()!=65535-this.len)throw z.thrown("Invalid data");this.state=Fa.Flat;a=this.inflateLoop();this.resetBits();return a;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=Fa.CData,!0;case 2:a=this.getBits(5)+257;b=this.getBits(5)+1;var e=this.getBits(4)+4;c=0;for(var g=e;c<g;){var l=
c++;this.lengths[db.CODE_LENGTHS_POS[l]]=this.getBits(3)}c=e;for(g=19;c<g;)l=c++,this.lengths[db.CODE_LENGTHS_POS[l]]=0;this.huffman=this.htools.make(this.lengths,0,19,8);e=[];c=0;for(g=a+b;c<g;)c++,e.push(0);this.inflateLengths(e,a+b);this.huffdist=this.htools.make(e,a,b,16);this.huffman=this.htools.make(e,0,a,16);this.state=Fa.CData;return!0;default:throw z.thrown("Invalid data");}case 2:b=this.applyHuffman(this.huffman);if(256>b)return this.addByte(b),0<this.needed;if(256==b)this.state=this.isFinal?
Fa.Crc:Fa.Block;else{b-=257;a=db.LEN_EXTRA_BITS_TBL[b];if(-1==a)throw z.thrown("Invalid data");this.len=db.LEN_BASE_VAL_TBL[b]+this.getBits(a);b=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);a=db.DIST_EXTRA_BITS_TBL[b];if(-1==a)throw z.thrown("Invalid data");this.dist=db.DIST_BASE_VAL_TBL[b]+this.getBits(a);if(this.dist>this.window.available())throw z.thrown("Invalid data");this.state=1==this.dist?Fa.DistOne:Fa.Dist}return!0;case 3:return a=this.len<this.needed?this.len:
this.needed,b=this.input.read(a),this.len-=a,this.addBytes(b,0,a),0==this.len&&(this.state=this.isFinal?Fa.Crc:Fa.Block),0<this.needed;case 4:a=this.window.checksum();if(null==a)return this.state=Fa.Done,!0;b=Hc.read(this.input);if(!a.equals(b))throw z.thrown("Invalid CRC");this.state=Fa.Done;return!0;case 5:for(;0<this.len&&0<this.needed;)a=this.len<this.dist?this.len:this.dist,a=this.needed<a?this.needed:a,this.addDist(this.dist,a),this.len-=a;0==this.len&&(this.state=Fa.CData);return 0<this.needed;
case 6:return a=this.len<this.needed?this.len:this.needed,this.addDistOne(a),this.len-=a,0==this.len&&(this.state=Fa.CData),0<this.needed;case 7:return!1}},__class__:db};var nd=function(a){this.i=a};d["haxe.zip.Reader"]=nd;nd.__name__=!0;nd.readZip=function(a){return(new nd(a)).read()};nd.prototype={readZipDate:function(){var a=this.i.readUInt16(),b=a>>11&31,c=a>>5&63;a&=31;var e=this.i.readUInt16();return new Date((e>>9)+1980,(e>>5&15)-1,e&31,b,c,a<<1)},readExtraFields:function(a){for(var b=new yb;0<
a;){if(4>a)throw z.thrown("Invalid extra fields data");var c=this.i.readUInt16(),e=this.i.readUInt16();if(a<e)throw z.thrown("Invalid extra fields data");if(28789==c){var g=this.i.readByte();if(1!=g){var l=new kd;l.addByte(g);l.add(this.i.read(e-1));b.add(uc.FUnknown(c,l.getBytes()))}else c=this.i.readInt32(),g=this.i.read(e-5).toString(),b.add(uc.FInfoZipUnicodePath(g,c))}else b.add(uc.FUnknown(c,this.i.read(e)));a-=4+e}return b},readEntryHeader:function(){var a=this.i,b=a.readInt32();if(33639248==
b||101010256==b)return null;if(67324752!=b)throw z.thrown("Invalid Zip Data");a.readUInt16();b=a.readUInt16();var c=0!=(b&2048),e=a.readUInt16(),g=0!=e;if(g&&8!=e)throw z.thrown("Unsupported compression "+e);e=this.readZipDate();var l=a.readInt32(),d=a.readInt32(),f=a.readInt32(),h=a.readInt16(),p=a.readInt16();a=a.readString(h);p=this.readExtraFields(p);c&&p.push(uc.FUtf8);0!=(b&8)&&(d=-1);return{fileName:a,fileSize:f,fileTime:e,compressed:g,dataSize:d,data:null,crc32:l,extraFields:p}},read:function(){for(var a=
new yb,b=null;;){var c=this.readEntryHeader();if(null==c)break;if(0>c.dataSize){null==b&&(b=new Ma(new ArrayBuffer(65536)));for(var e=new kd,g=new db(this.i,!1,!1);;){var l=g.readBytes(b,0,65536);e.addBytes(b,0,l);if(65536>l)break}c.data=e.getBytes();c.crc32=this.i.readInt32();134695760==c.crc32&&(c.crc32=this.i.readInt32());c.dataSize=this.i.readInt32();c.fileSize=this.i.readInt32();c.dataSize=c.fileSize;c.compressed=!1}else c.data=this.i.read(c.dataSize);a.add(c)}return a},__class__:nd};var Wb=
function(a,b){this.message=a;this.pos=b};d["hxjsonast.Error"]=Wb;Wb.__name__=!0;Wb.prototype={__class__:Wb};var wa=function(a,b){this.value=a;this.pos=b};d["hxjsonast.Json"]=wa;wa.__name__=!0;wa.prototype={__class__:wa};var ya=y["hxjsonast.JsonValue"]={__ename__:!0,__constructs__:null,JString:(h=function(a){return{_hx_index:0,s:a,__enum__:"hxjsonast.JsonValue",toString:n}},h._hx_name="JString",h.__params__=["s"],h),JNumber:(h=function(a){return{_hx_index:1,s:a,__enum__:"hxjsonast.JsonValue",toString:n}},
h._hx_name="JNumber",h.__params__=["s"],h),JObject:(h=function(a){return{_hx_index:2,fields:a,__enum__:"hxjsonast.JsonValue",toString:n}},h._hx_name="JObject",h.__params__=["fields"],h),JArray:(h=function(a){return{_hx_index:3,values:a,__enum__:"hxjsonast.JsonValue",toString:n}},h._hx_name="JArray",h.__params__=["values"],h),JBool:(h=function(a){return{_hx_index:4,b:a,__enum__:"hxjsonast.JsonValue",toString:n}},h._hx_name="JBool",h.__params__=["b"],h),JNull:{_hx_name:"JNull",_hx_index:5,__enum__:"hxjsonast.JsonValue",
toString:n}};ya.__constructs__=[ya.JString,ya.JNumber,ya.JObject,ya.JArray,ya.JBool,ya.JNull];var le=function(a,b,c){this.name=a;this.namePos=b;this.value=c};d["hxjsonast.JObjectField"]=le;le.__name__=!0;le.prototype={__class__:le};var Xd=function(a,b){this.source=a;this.filename=b;this.pos=0};d["hxjsonast.Parser"]=Xd;Xd.__name__=!0;Xd.prototype={doParse:function(){for(var a=this.parseRec(),b;;){var c=b=this.source.charCodeAt(this.pos++);if(c!=c)break;switch(b){case 9:case 10:case 13:case 32:break;
default:this.invalidChar()}}return a},parseRec:function(){for(;;){var a=this.source.charCodeAt(this.pos++);switch(a){case 9:case 10:case 13:case 32:break;case 34:var b=this.pos,c=this.parseString();return new wa(ya.JString(c),new aa(this.filename,b-1,this.pos));case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:b=this.pos-1;c=45==a;var e=!c;a=48==a;for(var g=!1,l=!1,d=!1,f=!1;;){switch(this.source.charCodeAt(this.pos++)){case 43:case 45:l&&!d||this.invalidNumber(b);
e=!1;d=!0;break;case 46:(c||g||l)&&this.invalidNumber(b);e=!1;g=!0;break;case 48:a&&!g&&this.invalidNumber(b);c&&(c=!1,a=!0);e=!0;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:a&&!g&&this.invalidNumber(b);c&&(c=!1);e=!0;a=!1;break;case 69:case 101:(c||a||l)&&this.invalidNumber(b);e=!1;l=!0;break;default:e||this.invalidNumber(b),this.pos--,f=!0}if(f)break}c=K.substr(this.source,b,this.pos-b);return new wa(ya.JNumber(c),new aa(this.filename,b,this.pos));case 91:for(b=
[],c=null,e=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 44:c?c=!1:this.invalidChar();break;case 93:return 0==c&&this.invalidChar(),new wa(ya.JArray(b),new aa(this.filename,e,this.pos));default:c&&this.invalidChar(),this.pos--,b.push(this.parseRec()),c=!0}case 102:b=this.pos;if(97!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||115!=this.source.charCodeAt(this.pos++)||101!=this.source.charCodeAt(this.pos++))this.pos=
b,this.invalidChar();return new wa(ya.JBool(!1),new aa(this.filename,b-1,this.pos));case 110:b=this.pos;if(117!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new wa(ya.JNull,new aa(this.filename,b-1,this.pos));case 116:b=this.pos;if(114!=this.source.charCodeAt(this.pos++)||117!=this.source.charCodeAt(this.pos++)||101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new wa(ya.JBool(!0),
new aa(this.filename,b-1,this.pos));case 123:for(b=[],c=Object.create(null),a=l=e=null,g=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 34:(null!=e||a)&&this.invalidChar();l=this.pos-1;e=this.parseString();l=new aa(this.filename,l,this.pos);if(Object.prototype.hasOwnProperty.call(c,e))throw z.thrown(new Wb('Duplicate field name "'+e+'"',l));c[e]=!0;break;case 44:a?a=!1:this.invalidChar();break;case 58:null==e&&this.invalidChar();b.push(new le(e,l,
this.parseRec()));l=e=null;a=!0;break;case 125:return null==e&&0!=a||this.invalidChar(),new wa(ya.JObject(b),new aa(this.filename,g,this.pos));default:this.invalidChar()}default:this.invalidChar()}}},parseString:function(){for(var a=this.pos,b=null;;){var c=this.source.charCodeAt(this.pos++);if(34==c)break;if(92==c){null==b&&(b=new A);c=this.source;var e=this.pos-a-1;b.b+=null==e?K.substr(c,a,null):K.substr(c,a,e);c=this.source.charCodeAt(this.pos++);switch(c){case 34:case 47:case 92:b.b+=String.fromCodePoint(c);
break;case 98:b.b+=String.fromCodePoint(8);break;case 102:b.b+=String.fromCodePoint(12);break;case 110:b.b+=String.fromCodePoint(10);break;case 114:b.b+=String.fromCodePoint(13);break;case 116:b.b+=String.fromCodePoint(9);break;case 117:a=p.parseInt("0x"+K.substr(this.source,this.pos,4));this.pos+=4;b.b+=String.fromCodePoint(a);break;default:throw z.thrown(new Wb("Invalid escape sequence \\"+String.fromCodePoint(c),new aa(this.filename,this.pos-2,this.pos)));}a=this.pos}else if(c!=c)throw this.pos--,
z.thrown(new Wb("Unclosed string",new aa(this.filename,a-1,this.pos)));}if(null==b)return K.substr(this.source,a,this.pos-a-1);c=this.source;e=this.pos-a-1;b.b+=null==e?K.substr(c,a,null):K.substr(c,a,e);return b.b},invalidChar:function(){this.pos--;throw z.thrown(new Wb("Invalid character: "+this.source.charAt(this.pos),new aa(this.filename,this.pos,this.pos+1)));},invalidNumber:function(a){throw z.thrown(new Wb("Invalid number: "+this.source.substring(a,this.pos),new aa(this.filename,a,this.pos)));
},__class__:Xd};var aa=function(a,b,c){this.file=a;this.min=b;this.max=c};d["hxjsonast.Position"]=aa;aa.__name__=!0;aa.prototype={__class__:aa};var ua=function(){};d["js.Boot"]=ua;ua.__name__=!0;ua.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;var b=a.__class__;if(null!=b)return b;a=ua.__nativeClassName(a);return null!=a?ua.__resolveNativeClass(a):null};ua.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&
(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a.__enum__){var e=y[a.__enum__].__constructs__[a._hx_index];c=e._hx_name;if(e.__params__){b+="\t";var g=[],l=0;for(e=e.__params__;l<e.length;){var d=e[l];l+=1;g.push(ua.__string_rec(a[d],b))}return c+"("+g.join(",")+")"}return c}if(a instanceof Array){c="[";b+="\t";g=0;for(l=a.length;g<l;)e=g++,c+=(0<e?",":"")+ua.__string_rec(a[e],b);return c+"]"}try{g=a.toString}catch(m){return ja.lastError=m,"???"}if(null!=
g&&g!=Object.toString&&"function"==typeof g&&(c=a.toString(),"[object Object]"!=c))return c;c="{\n";b+="\t";g=null!=a.hasOwnProperty;l=null;for(l in a)g&&!a.hasOwnProperty(l)||"prototype"==l||"__class__"==l||"__super__"==l||"__interfaces__"==l||"__properties__"==l||(2!=c.length&&(c+=", \n"),c+=b+l+" : "+ua.__string_rec(a[l],b));b=b.substring(1);return c+("\n"+b+"}");case "string":return a;default:return String(a)}};ua.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;
if(null!=c)for(var e=0,g=c.length;e<g;){var l=e++;l=c[l];if(l==b||ua.__interfLoop(l,b))return!0}return ua.__interfLoop(a.__super__,b)};ua.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array;case Xe:return"boolean"==typeof a;case Ye:return null!=a;case Ze:return"number"==typeof a;case $e:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==typeof b){if(ua.__downcastCheck(a,b))return!0}else{if("object"==
typeof b&&ua.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==af&&null!=a.__name__||b==bf&&null!=a.__ename__?!0:null!=a.__enum__?y[a.__enum__]==b:!1}};ua.__downcastCheck=function(a,b){return a instanceof b?!0:b.__isInterface__?ua.__interfLoop(ua.getClass(a),b):!1};ua.__cast=function(a,b){if(null==a||ua.__instanceof(a,b))return a;throw z.thrown("Cannot cast "+p.string(a)+" to "+p.string(b));};ua.__nativeClassName=function(a){a=ua.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==
a||"Math"==a||"JSON"==a?null:a};ua.__isNativeObj=function(a){return null!=ua.__nativeClassName(a)};ua.__resolveNativeClass=function(a){return v[a]};var Aa=y["json2object.Error"]={__ename__:!0,__constructs__:null,IncorrectType:(h=function(a,b,c){return{_hx_index:0,variable:a,expected:b,pos:c,__enum__:"json2object.Error",toString:n}},h._hx_name="IncorrectType",h.__params__=["variable","expected","pos"],h),IncorrectEnumValue:(h=function(a,b,c){return{_hx_index:1,value:a,expected:b,pos:c,__enum__:"json2object.Error",
toString:n}},h._hx_name="IncorrectEnumValue",h.__params__=["value","expected","pos"],h),InvalidEnumConstructor:(h=function(a,b,c){return{_hx_index:2,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:n}},h._hx_name="InvalidEnumConstructor",h.__params__=["value","expected","pos"],h),UninitializedVariable:(h=function(a,b){return{_hx_index:3,variable:a,pos:b,__enum__:"json2object.Error",toString:n}},h._hx_name="UninitializedVariable",h.__params__=["variable","pos"],h),UnknownVariable:(h=
function(a,b){return{_hx_index:4,variable:a,pos:b,__enum__:"json2object.Error",toString:n}},h._hx_name="UnknownVariable",h.__params__=["variable","pos"],h),ParserError:(h=function(a,b){return{_hx_index:5,message:a,pos:b,__enum__:"json2object.Error",toString:n}},h._hx_name="ParserError",h.__params__=["message","pos"],h),CustomFunctionException:(h=function(a,b){return{_hx_index:6,e:a,pos:b,__enum__:"json2object.Error",toString:n}},h._hx_name="CustomFunctionException",h.__params__=["e","pos"],h)};Aa.__constructs__=
[Aa.IncorrectType,Aa.IncorrectEnumValue,Aa.InvalidEnumConstructor,Aa.UninitializedVariable,Aa.UnknownVariable,Aa.ParserError,Aa.CustomFunctionException];var Hb=y["json2object.InternalError"]={__ename__:!0,__constructs__:null,AbstractNoJsonRepresentation:(h=function(a){return{_hx_index:0,name:a,__enum__:"json2object.InternalError",toString:n}},h._hx_name="AbstractNoJsonRepresentation",h.__params__=["name"],h),CannotGenerateSchema:(h=function(a){return{_hx_index:1,name:a,__enum__:"json2object.InternalError",
toString:n}},h._hx_name="CannotGenerateSchema",h.__params__=["name"],h),HandleExpr:{_hx_name:"HandleExpr",_hx_index:2,__enum__:"json2object.InternalError",toString:n},ParsingThrow:{_hx_name:"ParsingThrow",_hx_index:3,__enum__:"json2object.InternalError",toString:n},UnsupportedAbstractEnumType:(h=function(a){return{_hx_index:4,name:a,__enum__:"json2object.InternalError",toString:n}},h._hx_name="UnsupportedAbstractEnumType",h.__params__=["name"],h),UnsupportedEnumAbstractValue:(h=function(a){return{_hx_index:5,
name:a,__enum__:"json2object.InternalError",toString:n}},h._hx_name="UnsupportedEnumAbstractValue",h.__params__=["name"],h),UnsupportedMapKeyType:(h=function(a){return{_hx_index:6,name:a,__enum__:"json2object.InternalError",toString:n}},h._hx_name="UnsupportedMapKeyType",h.__params__=["name"],h),UnsupportedSchemaObjectType:(h=function(a){return{_hx_index:7,name:a,__enum__:"json2object.InternalError",toString:n}},h._hx_name="UnsupportedSchemaObjectType",h.__params__=["name"],h),UnsupportedSchemaType:(h=
function(a){return{_hx_index:8,type:a,__enum__:"json2object.InternalError",toString:n}},h._hx_name="UnsupportedSchemaType",h.__params__=["type"],h)};Hb.__constructs__=[Hb.AbstractNoJsonRepresentation,Hb.CannotGenerateSchema,Hb.HandleExpr,Hb.ParsingThrow,Hb.UnsupportedAbstractEnumType,Hb.UnsupportedEnumAbstractValue,Hb.UnsupportedMapKeyType,Hb.UnsupportedSchemaObjectType,Hb.UnsupportedSchemaType];var Ie=function(){};d["json2object.ErrorUtils"]=Ie;Ie.__name__=!0;Ie.convertError=function(a){switch(a._hx_index){case 0:var b=
a.pos;var c=b;break;case 1:c=b=a.pos;break;case 2:c=b=a.pos;break;case 3:c=b=a.pos;break;case 4:c=b=a.pos;break;case 5:c=b=a.pos;break;case 6:c=b=a.pos}b="";if(null!=c){var e=""==c.file?"line":""+c.file+":";1==c.lines.length?b=""+e+c.lines[0].number+": characters "+c.lines[0].start+"-"+c.lines[0].end+" : ":1<c.lines.length&&(b=""+e+c.lines[0].number+": lines "+c.lines[0].number+"-"+c.lines[c.lines.length-1].number+" : ")}switch(a._hx_index){case 0:return c=a.variable,a=a.expected,b+("Variable '"+
c+"' should be of type '"+a+"'");case 1:return c=a.value,a=a.expected,b+("Identifier '"+c+"' isn't part of '"+a+"'");case 2:return c=a.value,a=a.expected,b+("Enum argument '"+c+"' should be of type '"+a+"'");case 3:return c=a.variable,b+("Variable '"+c+"' should be in the json");case 4:return c=a.variable,b+("Variable '"+c+"' isn't part of the schema");case 5:return b+("Parser error: "+a.message);case 6:return a=a.e,b+("Custom function exception: "+(null==a?"null":p.string(a)))}};var Wd=function(a){this.linesInfo=
[];for(var b=0,c,e=0,g=0;e<a.length;)switch(a.charAt(e)){case "\n":c=e;this.linesInfo.push({number:g,start:b,end:c});++g;++e;b=e;break;case "\r":c=e;"\n"==a.charAt(e+1)&&++c;this.linesInfo.push({number:g,start:b,end:c});++g;b=e=c+1;break;default:++e}this.linesInfo.push({number:g,start:b,end:e})};d["json2object.PositionUtils"]=Wd;Wd.__name__=!0;Wd.prototype={convertPosition:function(a){var b=a.min,c=a.max;a={file:a.file,min:b+1,max:c+1,lines:[]};var e=0,g=this.linesInfo.length-1;if(b>this.linesInfo[0].end)for(;g>
e;){var l=(e+g)/2|0,d=this.linesInfo[l];d.start==b&&(g=e=l);d.end<b&&(e=l+1);if(d.start>b||d.end>=b&&d.start<b)g=l}for(g=this.linesInfo.length;e<g;){l=e++;d=this.linesInfo[l];if(d.start<=b&&d.end>=c){a.lines.push({number:d.number+1,start:b-d.start+1,end:c-d.start+1});break}d.start<=b&&b<=d.end&&a.lines.push({number:d.number+1,start:b-d.start+1,end:d.end+1});d.start<=c&&c<=d.end&&a.lines.push({number:d.number+1,start:d.start+1,end:c-d.start+1});if(d.start>=c||d.end>=c)break}return a},__class__:Wd};
var Sd=function(){this.connected=!0;this.buttons=[];this.axes=[]};d["lime._internal.backend.html5.GameDeviceData"]=Sd;Sd.__name__=!0;Sd.prototype={__class__:Sd};var R=function(){this.validStatus0=(new Z("Tizen","gi")).match(window.navigator.userAgent)};d["lime._internal.backend.html5.HTML5HTTPRequest"]=R;R.__name__=!0;R.loadImage=function(a){var b=new zb;R.activeRequests<R.requestLimit?(R.activeRequests++,R.__loadImage(a,b,0)):R.requestQueue.add({instance:null,uri:a,promise:b,type:"IMAGE",options:0});
return b.future};R.loadImageFromBytes=function(a,b){var c=URL.createObjectURL(new Blob([a.b.bufferValue],{type:b}));return null!=c?(a=new zb,R.activeRequests<R.requestLimit?(R.activeRequests++,R.__loadImage(c,a,1)):R.requestQueue.add({instance:null,uri:c,promise:a,type:"IMAGE",options:1}),a.future):R.loadImage("data:"+b+";base64,"+hc.encode(a))};R.processQueue=function(){if(R.activeRequests<R.requestLimit&&0<R.requestQueue.length){R.activeRequests++;var a=R.requestQueue.pop();switch(a.type){case "BINARY":a.instance.__loadData(a.uri,
a.promise);break;case "IMAGE":R.__loadImage(a.uri,a.promise,a.options);break;case "TEXT":a.instance.__loadText(a.uri,a.promise);break;default:R.activeRequests--}}};R.__fixHostname=function(a){return null==a?"":a};R.__fixPort=function(a,b){if(null==a||""==a)switch(b){case "ftp:":return"21";case "gopher:":return"70";case "http:":return"80";case "https:":return"443";case "ws:":return"80";case "wss:":return"443";default:return""}return a};R.__fixProtocol=function(a){return null==a||""==a?"http:":a};R.__isInMemoryURI=
function(a){return q.startsWith(a,"data:")?!0:q.startsWith(a,"blob:")};R.__isSameOrigin=function(a){if(null==a||""==a||R.__isInMemoryURI(a))return!0;null==R.originElement&&(R.originElement=window.document.createElement("a"),R.originHostname=R.__fixHostname(v.location.hostname),R.originProtocol=R.__fixProtocol(v.location.protocol),R.originPort=R.__fixPort(v.location.port,R.originProtocol));var b=R.originElement;b.href=a;""==b.hostname&&(b.href=b.href);var c=R.__fixHostname(b.hostname);a=R.__fixProtocol(b.protocol);
b=R.__fixPort(b.port,a);c=""==c||c==R.originHostname;b=""==b||b==R.originPort;return"file:"!=a&&c?b:!1};R.__loadImage=function(a,b,c){var e=new Image;R.__isSameOrigin(a)||(e.crossOrigin="Anonymous");null==R.supportsImageProgress&&(R.supportsImageProgress="onprogress"in e);if(R.supportsImageProgress||R.__isInMemoryURI(a))e.addEventListener("load",function(g){R.__revokeBlobURI(a,c);g=new vc(null,e.width,e.height);g.__srcImage=e;R.activeRequests--;R.processQueue();b.complete(new Oa(g))},!1),e.addEventListener("progress",
function(a){b.progress(a.loaded,a.total)},!1),e.addEventListener("error",function(e){R.__revokeBlobURI(a,c);R.activeRequests--;R.processQueue();b.error(e.detail)},!1),e.src=a;else{var g=new XMLHttpRequest;g.onload=function(a){R.activeRequests--;R.processQueue();(new Oa).__fromBytes(Ma.ofData(g.response),function(a){b.complete(a)})};g.onerror=function(a){b.error(a.message)};g.onprogress=function(a){a.lengthComputable&&b.progress(a.loaded,a.total)};g.open("GET",a,!0);g.responseType="arraybuffer";g.overrideMimeType("text/plain; charset=x-user-defined");
g.send(null)}};R.__revokeBlobURI=function(a,b){0!=(b&1)&&URL.revokeObjectURL(a)};R.prototype={init:function(a){this.parent=a},load:function(a,b,c){this.request=new XMLHttpRequest;"POST"==this.parent.method?this.request.upload.addEventListener("progress",b,!1):this.request.addEventListener("progress",b,!1);this.request.onreadystatechange=c;b="";if(null==this.parent.data){c=Object.keys(this.parent.formData.h);for(var e=c.length,g=0;g<e;){var l=c[g++];0<b.length&&(b+="&");var d=this.parent.formData.h[l];
if(-1<l.indexOf("[]")&&d instanceof Array){var f=[];for(d=I(d);d.hasNext();){var h=d.next();f.push(encodeURIComponent(h))}f=f.join("&amp;"+l+"=");b+=encodeURIComponent(l)+"="+f}else f=encodeURIComponent(l)+"=",l=p.string(d),b+=f+encodeURIComponent(l)}"GET"==this.parent.method&&""!=b&&(a=-1<a.indexOf("?")?a+("&"+b):a+("?"+b),b="")}this.request.open(p.string(this.parent.method),a,!0);0<this.parent.timeout&&(this.request.timeout=this.parent.timeout);this.binary&&(this.request.responseType="arraybuffer");
a=null;f=0;for(c=this.parent.headers;f<c.length;)e=c[f],++f,"Content-Type"==e.name?a=e.value:this.request.setRequestHeader(e.name,e.value);null!=this.parent.contentType&&(a=this.parent.contentType);null==a&&(null!=this.parent.data?a="application/octet-stream":""!=b&&(a="application/x-www-form-urlencoded"));null!=a&&this.request.setRequestHeader("Content-Type",a);this.parent.withCredentials&&(this.request.withCredentials=!0);null!=this.parent.data?this.request.send(this.parent.data.b.bufferValue):
this.request.send(b)},loadData:function(a){var b=new zb;R.activeRequests<R.requestLimit?(R.activeRequests++,this.__loadData(a,b)):R.requestQueue.add({instance:this,uri:a,promise:b,type:"BINARY",options:0});return b.future},loadText:function(a){var b=new zb;R.activeRequests<R.requestLimit?(R.activeRequests++,this.__loadText(a,b)):R.requestQueue.add({instance:this,uri:a,promise:b,type:"TEXT",options:0});return b.future},processResponse:function(){if(this.parent.enableResponseHeaders){this.parent.responseHeaders=
[];for(var a,b,c=0,e=this.request.getAllResponseHeaders().split("\n");c<e.length;)b=e[c],++c,a=q.trim(K.substr(b,0,b.indexOf(":"))),b=q.trim(K.substr(b,b.indexOf(":")+1,null)),""!=a&&this.parent.responseHeaders.push(new me(a,b))}this.parent.responseStatus=this.request.status},__loadData:function(a,b){var c=this;this.binary=!0;this.load(a,function(a){b.progress(a.loaded,a.total)},function(a){4==c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>c.request.status||c.validStatus0&&
0==c.request.status)?(a=null,""==c.request.responseType?null!=c.request.responseText&&(a=Ma.ofString(c.request.responseText)):null!=c.request.response&&(a=Ma.ofData(c.request.response)),c.processResponse(),b.complete(a)):(c.processResponse(),b.error(c.request.status)),c.request=null,R.activeRequests--,R.processQueue())})},__loadText:function(a,b){var c=this;this.binary=!1;this.load(a,function(a){b.progress(a.loaded,a.total)},function(a){4==c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&
400>=c.request.status||c.validStatus0&&0==c.request.status)?(c.processResponse(),b.complete(c.request.responseText)):(c.processResponse(),b.error(c.request.status)),c.request=null,R.activeRequests--,R.processQueue())})},__class__:R};var Yc=function(a){this.unusedTouchesPool=new yb;this.scale=1;this.currentTouches=new Kb;this.parent=a;this.cursor=Sb.DEFAULT;this.cacheMouseY=this.cacheMouseX=0;var b=a.__attributes;Object.prototype.hasOwnProperty.call(b,"context")||(b.context={});this.renderType=b.context.type;
Object.prototype.hasOwnProperty.call(b,"element")&&(a.element=b.element);var c=a.element;Object.prototype.hasOwnProperty.call(b,"allowHighDPI")&&b.allowHighDPI&&"dom"!=this.renderType&&(this.scale=window.devicePixelRatio);a.__scale=this.scale;this.setWidth=Object.prototype.hasOwnProperty.call(b,"width")?b.width:0;this.setHeight=Object.prototype.hasOwnProperty.call(b,"height")?b.height:0;a.__width=this.setWidth;a.__height=this.setHeight;a.id=Yc.windowID++;c instanceof HTMLCanvasElement?this.canvas=
c:"dom"==this.renderType?this.div=window.document.createElement("div"):this.canvas=window.document.createElement("canvas");if(null!=this.canvas){var e=this.canvas.style;e.setProperty("-webkit-transform","translateZ(0)",null);e.setProperty("transform","translateZ(0)",null)}else null!=this.div&&(e=this.div.style,e.setProperty("-webkit-transform","translate3D(0,0,0)",null),e.setProperty("transform","translate3D(0,0,0)",null),e.position="relative",e.overflow="hidden",e.setProperty("-webkit-user-select",
"none",null),e.setProperty("-moz-user-select","none",null),e.setProperty("-ms-user-select","none",null),e.setProperty("-o-user-select","none",null));0==a.__width&&0==a.__height&&(null!=c?(a.__width=c.clientWidth,a.__height=c.clientHeight):(a.__width=window.innerWidth,a.__height=window.innerHeight),this.cacheElementWidth=a.__width,this.cacheElementHeight=a.__height,this.resizeElement=!0);null!=this.canvas?(this.canvas.width=Math.round(a.__width*this.scale),this.canvas.height=Math.round(a.__height*
this.scale),this.canvas.style.width=a.__width+"px",this.canvas.style.height=a.__height+"px"):(this.div.style.width=a.__width+"px",this.div.style.height=a.__height+"px");if(Object.prototype.hasOwnProperty.call(b,"resizable")&&b.resizable||!Object.prototype.hasOwnProperty.call(b,"width")&&0==this.setWidth&&0==this.setHeight)a.__resizable=!0;this.updateSize();if(null!=c){null!=this.canvas?c!=this.canvas&&c.appendChild(this.canvas):c.appendChild(this.div);b="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" ");
for(e=0;e<b.length;){var g=b[e];++e;c.addEventListener(g,f(this,this.handleMouseEvent),!0)}c.addEventListener("contextmenu",f(this,this.handleContextMenuEvent),!0);c.addEventListener("dragstart",f(this,this.handleDragEvent),!0);c.addEventListener("dragover",f(this,this.handleDragEvent),!0);c.addEventListener("drop",f(this,this.handleDragEvent),!0);c.addEventListener("touchstart",f(this,this.handleTouchEvent),!0);c.addEventListener("touchmove",f(this,this.handleTouchEvent),!0);c.addEventListener("touchend",
f(this,this.handleTouchEvent),!0);c.addEventListener("touchcancel",f(this,this.handleTouchEvent),!0);c.addEventListener("gamepadconnected",f(this,this.handleGamepadEvent),!0);c.addEventListener("gamepaddisconnected",f(this,this.handleGamepadEvent),!0)}this.createContext();"webgl"==a.context.type&&(this.canvas.addEventListener("webglcontextlost",f(this,this.handleContextEvent),!1),this.canvas.addEventListener("webglcontextrestored",f(this,this.handleContextEvent),!1))};d["lime._internal.backend.html5.HTML5Window"]=
Yc;Yc.__name__=!0;Yc.prototype={close:function(){this.parent.application.__removeWindow(this.parent)},createContext:function(){var a=new ne,b=this.parent.__attributes.context;a.window=this.parent;a.attributes=b;if(null!=this.div)a.dom=this.div,a.type="dom",a.version="";else if(null!=this.canvas){var c=null,e="canvas"==this.renderType,g="opengl"==this.renderType||"opengles"==this.renderType||"webgl"==this.renderType,l=!Object.prototype.hasOwnProperty.call(b,"version")||"1"!=b.version,d=!1;if(g||!e&&
(!Object.prototype.hasOwnProperty.call(b,"hardware")||b.hardware)){e=Object.prototype.hasOwnProperty.call(b,"background")&&null==b.background;g=Object.prototype.hasOwnProperty.call(b,"colorDepth")?b.colorDepth:16;var f=Object.prototype.hasOwnProperty.call(b,"antialiasing")&&0<b.antialiasing,h=Object.prototype.hasOwnProperty.call(b,"depth")?b.depth:!0;b=Object.prototype.hasOwnProperty.call(b,"stencil")&&b.stencil;b={alpha:e||16<g,antialias:f,depth:h,premultipliedAlpha:!0,stencil:b,preserveDrawingBuffer:!1,
failIfMajorPerformanceCaveat:!1};e=["webgl","experimental-webgl"];l&&e.unshift("webgl2");for(l=0;l<e.length&&(g=e[l],++l,c=this.canvas.getContext(g,b),null!=c&&"webgl2"==g&&(d=!0),null==c););}null==c?(a.canvas2D=this.canvas.getContext("2d"),a.type="canvas",a.version=""):(a.webgl=cf.fromWebGL2RenderContext(c),d&&(a.webgl2=c),null==Zc.context&&(Zc.context=c,Zc.type="webgl",Zc.version=d?2:1),a.type="webgl",a.version=d?"2":"1")}this.parent.context=a},handleContextEvent:function(a){switch(a.type){case "webglcontextlost":a.cancelable&&
a.preventDefault();this.parent.context=null;this.parent.onRenderContextLost.dispatch();break;case "webglcontextrestored":this.createContext(),this.parent.onRenderContextRestored.dispatch(this.parent.context)}},handleContextMenuEvent:function(a){(this.parent.onMouseUp.canceled||this.parent.onMouseDown.canceled)&&a.cancelable&&a.preventDefault()},handleDragEvent:function(a){switch(a.type){case "dragover":return a.preventDefault(),!1;case "dragstart":if("img"==ua.__cast(a.target,HTMLElement).nodeName.toLowerCase()&&
a.cancelable)return a.preventDefault(),!1;break;case "drop":if(null!=a.dataTransfer&&0<a.dataTransfer.files.length)return this.parent.onDropFile.dispatch(a.dataTransfer.files),a.preventDefault(),!1}return!0},handleGamepadEvent:function(a){switch(a.type){case "gamepadconnected":fb.__connect(a.gamepad.index);"standard"==a.gamepad.mapping&&Ta.__connect(a.gamepad.index);break;case "gamepaddisconnected":fb.__disconnect(a.gamepad.index),Ta.__disconnect(a.gamepad.index)}},handleMouseEvent:function(a){if("wheel"!=
a.type){if(null!=this.parent.element)if(null!=this.canvas){var b=this.canvas.getBoundingClientRect();var c=this.parent.__width/b.width*(a.clientX-b.left);b=this.parent.__height/b.height*(a.clientY-b.top)}else null!=this.div?(b=this.div.getBoundingClientRect(),c=a.clientX-b.left,b=a.clientY-b.top):(b=this.parent.element.getBoundingClientRect(),c=this.parent.__width/b.width*(a.clientX-b.left),b=this.parent.__height/b.height*(a.clientY-b.top));else c=a.clientX,b=a.clientY;switch(a.type){case "mousedown":a.currentTarget==
this.parent.element&&window.addEventListener("mouseup",f(this,this.handleMouseEvent));this.parent.onMouseDown.dispatch(c,b,a.button);this.parent.onMouseDown.canceled&&a.cancelable&&a.preventDefault();break;case "mouseenter":a.target==this.parent.element&&(this.parent.onEnter.dispatch(),this.parent.onEnter.canceled&&a.cancelable&&a.preventDefault());break;case "mouseleave":a.target==this.parent.element&&(this.parent.onLeave.dispatch(),this.parent.onLeave.canceled&&a.cancelable&&a.preventDefault());
break;case "mousemove":if(c!=this.cacheMouseX||b!=this.cacheMouseY)this.parent.onMouseMove.dispatch(c,b),this.parent.onMouseMoveRelative.dispatch(c-this.cacheMouseX,b-this.cacheMouseY),(this.parent.onMouseMove.canceled||this.parent.onMouseMoveRelative.canceled)&&a.cancelable&&a.preventDefault();break;case "mouseup":window.removeEventListener("mouseup",f(this,this.handleMouseEvent)),a.currentTarget==this.parent.element&&a.stopPropagation(),this.parent.onMouseUp.dispatch(c,b,a.button),this.parent.onMouseUp.canceled&&
a.cancelable&&a.preventDefault()}this.cacheMouseX=c;this.cacheMouseY=b}else{switch(a.deltaMode){case 0:c=Bc.PIXELS;break;case 1:c=Bc.LINES;break;case 2:c=Bc.PAGES;break;default:c=Bc.UNKNOWN}this.parent.onMouseWheel.dispatch(a.deltaX,-a.deltaY,c);this.parent.onMouseWheel.canceled&&a.cancelable&&a.preventDefault()}},handleResizeEvent:function(a){this.primaryTouch=null;this.updateSize()},handleTouchEvent:function(a){a.cancelable&&a.preventDefault();var b=null;null!=this.parent.element&&(b=null!=this.canvas?
this.canvas.getBoundingClientRect():null!=this.div?this.div.getBoundingClientRect():this.parent.element.getBoundingClientRect());var c=this.setWidth,e=this.setHeight;if(0==c||0==e)null!=b?(c=b.width,e=b.height):e=c=1;for(var g,l,d,f,h,p=0,q=a.changedTouches;p<q.length;){var r=q[p];++p;null!=b?(l=c/b.width*(r.clientX-b.left),d=e/b.height*(r.clientY-b.top)):(l=r.clientX,d=r.clientY);if("touchstart"==a.type)g=this.unusedTouchesPool.pop(),null==g?g=new Bb(l/c,d/e,r.identifier,0,0,r.force,this.parent.id):
(g.x=l/c,g.y=d/e,g.id=r.identifier,g.dx=0,g.dy=0,g.pressure=r.force,g.device=this.parent.id),this.currentTouches.h[r.identifier]=g,Bb.onStart.dispatch(g),null==this.primaryTouch&&(this.primaryTouch=g),g==this.primaryTouch&&this.parent.onMouseDown.dispatch(l,d,0);else if(g=this.currentTouches.h[r.identifier],null!=g)switch(f=g.x,h=g.y,g.x=l/c,g.y=d/e,g.dx=g.x-f,g.dy=g.y-h,g.pressure=r.force,a.type){case "touchcancel":Bb.onCancel.dispatch(g);this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(g);
g==this.primaryTouch&&(this.primaryTouch=null);break;case "touchend":Bb.onEnd.dispatch(g);this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(g);g==this.primaryTouch&&(this.parent.onMouseUp.dispatch(l,d,0),this.primaryTouch=null);break;case "touchmove":Bb.onMove.dispatch(g),g==this.primaryTouch&&this.parent.onMouseMove.dispatch(l,d)}}},updateSize:function(){if(this.parent.__resizable){if(null!=this.parent.element){var a=this.parent.element.clientWidth;var b=this.parent.element.clientHeight}else a=
window.innerWidth,b=window.innerHeight;if(a!=this.cacheElementWidth||b!=this.cacheElementHeight){this.cacheElementWidth=a;this.cacheElementHeight=b;var c=this.resizeElement||0==this.setWidth&&0==this.setHeight;if(null!=this.parent.element&&(null==this.div||null!=this.div&&c))if(c){if(this.parent.__width!=a||this.parent.__height!=b)this.parent.__width=a,this.parent.__height=b,null!=this.canvas?this.parent.element!=this.canvas&&(this.canvas.width=Math.round(a*this.scale),this.canvas.height=Math.round(b*
this.scale),this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"):(this.div.style.width=a+"px",this.div.style.height=b+"px"),this.parent.onResize.dispatch(a,b)}else{c=0!=this.setWidth?a/this.setWidth:1;var e=0!=this.setHeight?b/this.setHeight:1,g=a,d=b,f=0,h=0;c<e?(d=Math.floor(this.setHeight*c),h=Math.floor((b-d)/2)):(g=Math.floor(this.setWidth*e),f=Math.floor((a-g)/2));null!=this.canvas?this.parent.element!=this.canvas&&(this.canvas.style.width=g+"px",this.canvas.style.height=d+"px",this.canvas.style.marginLeft=
f+"px",this.canvas.style.marginTop=h+"px"):(this.div.style.width=g+"px",this.div.style.height=d+"px",this.div.style.marginLeft=f+"px",this.div.style.marginTop=h+"px")}}}},__class__:Yc};var hc=function(){};d["lime._internal.format.Base64"]=hc;hc.__name__=!0;hc.encode=function(a){var b=[],c=hc.DICTIONARY,e=hc.EXTENDED_DICTIONARY,g=a.length,d=Math.floor(g/3),f=2*d;b.length=2*Math.ceil(g/3);for(var h=0,p=0,q;p<f;)q=a.b[h]<<16|a.b[h+1]<<8|a.b[h+2],b[p]=e[q>>12&4095],b[p+1]=e[q&4095],h+=3,p+=2;switch(g-
3*d){case 1:q=a.b[h]<<16;b[p]=e[q>>12&4095];b[p+1]="==";break;case 2:q=a.b[h]<<16|a.b[h+1]<<8,b[p]=e[q>>12&4095],b[p+1]=c[q>>6&63]+"="}return b.join("")};var Je=function(){};d["lime._internal.format.Deflate"]=Je;Je.__name__=!0;Je.decompress=function(a){a=pako.inflateRaw(a.b.bufferValue);return Ma.ofData(a)};var Ke=function(){};d["lime._internal.format.GZip"]=Ke;Ke.__name__=!0;Ke.decompress=function(a){a=pako.ungzip(a.b.bufferValue);return Ma.ofData(a)};var Le=function(){};d["lime._internal.format.LZMA"]=
Le;Le.__name__=!0;Le.decompress=function(a){return null};var Me=function(){};d["lime._internal.format.Zlib"]=Me;Me.__name__=!0;Me.decompress=function(a){a=pako.inflate(a.b.bufferValue);return Ma.ofData(a)};var mb=function(){};d["lime._internal.graphics.ImageCanvasUtil"]=mb;mb.__name__=!0;mb.convertToCanvas=function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage?(null==c.__srcCanvas&&(mb.createCanvas(a,c.__srcImage.width,c.__srcImage.height),c.__srcContext.drawImage(c.__srcImage,0,0)),c.__srcImage=
null):null==c.__srcCanvas&&null!=c.data?(a.set_transparent(!0),mb.createCanvas(a,c.width,c.height),mb.createImageData(a),c.__srcContext.putImageData(c.__srcImageData,0,0)):a.type==nc.DATA&&null!=c.__srcImageData&&a.dirty&&(c.__srcContext.putImageData(c.__srcImageData,0,0),a.dirty=!1);b?(c.data=null,c.__srcImageData=null):null==c.data&&null!=c.__srcImageData&&(c.data=c.__srcImageData.data);a.type=nc.CANVAS};mb.convertToData=function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage&&mb.convertToCanvas(a);
if(null!=c.__srcCanvas&&null==c.data)mb.createImageData(a),a.type==nc.CANVAS&&(a.dirty=!1);else if(a.type==nc.CANVAS&&null!=c.__srcCanvas&&a.dirty){if(null==c.__srcImageData)mb.createImageData(a);else{c.__srcImageData=c.__srcContext.getImageData(0,0,c.width,c.height);var e=c.__srcImageData.data.buffer;e=null!=e?new Uint8Array(e):null;c.data=e}a.dirty=!1}b&&(a.buffer.__srcCanvas=null,a.buffer.__srcContext=null);a.type=nc.DATA};mb.createCanvas=function(a,b,c){var e=a.buffer;null==e.__srcCanvas&&(e.__srcCanvas=
window.document.createElement("canvas"),e.__srcCanvas.width=b,e.__srcCanvas.height=c,a.get_transparent()?e.__srcContext=e.__srcCanvas.getContext("2d"):(a.get_transparent()||e.__srcCanvas.setAttribute("moz-opaque","true"),e.__srcContext=e.__srcCanvas.getContext("2d",{alpha:!1})))};mb.createImageData=function(a){a=a.buffer;if(null==a.__srcImageData){null==a.data?a.__srcImageData=a.__srcContext.getImageData(0,0,a.width,a.height):(a.__srcImageData=a.__srcContext.createImageData(a.width,a.height),a.__srcImageData.data.set(a.data));
var b=a.__srcImageData.data.buffer;b=null!=b?new Uint8Array(b):null;a.data=b}};mb.fillRect=function(a,b,c,e){mb.convertToCanvas(a);if(1==e){e=c>>16&255;var g=c>>8&255;var d=c&255;c=a.get_transparent()?c>>24&255:255}else e=c>>24&255,g=c>>16&255,d=c>>8&255,c=a.get_transparent()?c&255:255;0==b.x&&0==b.y&&b.width==a.width&&b.height==a.height&&a.get_transparent()&&0==c?a.buffer.__srcCanvas.width=a.buffer.width:(255>c&&a.buffer.__srcContext.clearRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+
a.offsetY),0<c&&(a.buffer.__srcContext.fillStyle="rgba("+e+", "+g+", "+d+", "+c/255+")",a.buffer.__srcContext.fillRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY)),a.dirty=!0,a.version++)};var Ne=function(){};d["lime._internal.graphics.ImageDataUtil"]=Ne;Ne.__name__=!0;Ne.fillRect=function(a,b,c,e){switch(e){case 1:c=(c>>>16&255)<<24|(c>>>8&255)<<16|(c&255)<<8|c>>>24&255;break;case 2:c=(c>>>8&255)<<24|(c>>>16&255)<<16|(c>>>24&255)<<8|c&255}a.get_transparent()||(c=(c>>>24&255)<<
24|(c>>>16&255)<<16|(c>>>8&255)<<8|255);var g=a.buffer.data;if(null!=g){e=a.buffer.format;var d=a.buffer.premultiplied;d&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Tb.a16=Tb.__alpha16[c&255],c=((c>>>24&255)*Tb.a16>>16&255)<<24|((c>>>16&255)*Tb.a16>>16&255)<<16|((c>>>8&255)*Tb.a16>>16&255)<<8|c&255));b=new oe(a,b);for(var f,h=0,p=b.height;h<p;){d=h++;f=b.byteOffset+b.stride*d;for(var q=0,n=b.width;q<n;){d=q++;var r=f+4*d,A=e;d=!1;null==d&&(d=!1);null==A&&(A=0);d&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&
(Tb.a16=Tb.__alpha16[c&255],c=((c>>>24&255)*Tb.a16>>16&255)<<24|((c>>>16&255)*Tb.a16>>16&255)<<16|((c>>>8&255)*Tb.a16>>16&255)<<8|c&255));switch(A){case 0:g[r]=c>>>24&255;g[r+1]=c>>>16&255;g[r+2]=c>>>8&255;g[r+3]=c&255;break;case 1:g[r]=c&255;g[r+1]=c>>>24&255;g[r+2]=c>>>16&255;g[r+3]=c>>>8&255;break;case 2:g[r]=c>>>8&255,g[r+1]=c>>>16&255,g[r+2]=c>>>24&255,g[r+3]=c&255}}}a.dirty=!0;a.version++}};var oe=function(a,b){this.image=a;null==b?this.rect=a.get_rect():(0>b.x&&(b.x=0),0>b.y&&(b.y=0),b.x+b.width>
a.width&&(b.width=a.width-b.x),b.y+b.height>a.height&&(b.height=a.height-b.y),0>b.width&&(b.width=0),0>b.height&&(b.height=0),this.rect=b);this.stride=a.buffer.get_stride();this.__update()};d["lime._internal.graphics._ImageDataUtil.ImageDataView"]=oe;oe.__name__=!0;oe.prototype={__update:function(){this.x=Math.ceil(this.rect.x);this.y=Math.ceil(this.rect.y);this.width=Math.floor(this.rect.width);this.height=Math.floor(this.rect.height);this.byteOffset=this.stride*(this.y+this.image.offsetY)+4*(this.x+
this.image.offsetX)},__class__:oe};var Pa=function(a,b){null==b&&(b=!1);if(null!=a)if(b)b=new zb,b.future=this,nb.queue({promise:b,work:a});else try{this.value=a(),this.isComplete=!0}catch(c){ja.lastError=c,this.error=z.caught(c).unwrap(),this.isError=!0}};d["lime.app.Future"]=Pa;Pa.__name__=!0;Pa.withValue=function(a){var b=new Pa;b.isComplete=!0;b.value=a;return b};Pa.prototype={onComplete:function(a){null!=a&&(this.isComplete?a(this.value):this.isError||(null==this.__completeListeners&&(this.__completeListeners=
[]),this.__completeListeners.push(a)));return this},onError:function(a){null!=a&&(this.isError?a(this.error):this.isComplete||(null==this.__errorListeners&&(this.__errorListeners=[]),this.__errorListeners.push(a)));return this},onProgress:function(a){null!=a&&(null==this.__progressListeners&&(this.__progressListeners=[]),this.__progressListeners.push(a));return this},then:function(a){if(this.isComplete)return a(this.value);if(this.isError){var b=new Pa;b.isError=!0;b.error=this.error;return b}var c=
new zb;this.onError(f(c,c.error));this.onProgress(f(c,c.progress));this.onComplete(function(b){b=a(b);b.onError(f(c,c.error));b.onComplete(f(c,c.complete))});return c.future},__class__:Pa};var nb=function(){};d["lime.app._Future.FutureWork"]=nb;nb.__name__=!0;nb.queue=function(a){null==nb.threadPool&&(nb.threadPool=new pe,nb.threadPool.doWork.add(nb.threadPool_doWork),nb.threadPool.onComplete.add(nb.threadPool_onComplete),nb.threadPool.onError.add(nb.threadPool_onError));nb.threadPool.queue(a)};nb.threadPool_doWork=
function(a){try{var b=a.work();nb.threadPool.sendComplete({promise:a.promise,result:b})}catch(c){ja.lastError=c,b=z.caught(c).unwrap(),nb.threadPool.sendError({promise:a.promise,error:b})}};nb.threadPool_onComplete=function(a){a.promise.complete(a.result)};nb.threadPool_onError=function(a){a.promise.error(a.error)};var zb=function(){this.future=new Pa};d["lime.app.Promise"]=zb;zb.__name__=!0;zb.prototype={complete:function(a){if(!this.future.isError&&(this.future.isComplete=!0,this.future.value=a,
null!=this.future.__completeListeners)){for(var b=0,c=this.future.__completeListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__completeListeners=null}return this},completeWith:function(a){a.onComplete(f(this,this.complete));a.onError(f(this,this.error));a.onProgress(f(this,this.progress));return this},error:function(a){if(!this.future.isComplete&&(this.future.isError=!0,this.future.error=a,null!=this.future.__errorListeners)){for(var b=0,c=this.future.__errorListeners;b<c.length;){var e=c[b];
++b;e(a)}this.future.__errorListeners=null}return this},progress:function(a,b){if(!this.future.isError&&!this.future.isComplete&&null!=this.future.__progressListeners)for(var c=0,e=this.future.__progressListeners;c<e.length;){var g=e[c];++c;g(a,b)}return this},__class__:zb};var Jc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Dynamic_Void"]=Jc;Jc.__name__=!0;Jc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<
g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&
(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Jc};var qe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Float_Void"]=qe;qe.__name__=!0;qe.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=
this.__repeat,d=0;d<e.length&&(e[d](a,b,c),g[d]?++d:this.remove(e[d]),!this.canceled););},__class__:qe};var re=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Int_Void"]=re;re.__name__=!0;re.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=this.__repeat,d=0;d<e.length&&(e[d](a,b,c),g[d]?++d:this.remove(e[d]),!this.canceled););},__class__:re};var $c=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=
[]};d["lime.app._Event_Float_Float_Void"]=$c;$c.__name__=!0;$c.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:$c};var se=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_lime_ui_MouseButton_Void"]=se;se.__name__=!0;se.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<
g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=this.__repeat,d=0;d<e.length&&
(e[d](a,b,c),g[d]?++d:this.remove(e[d]),!this.canceled););},__class__:se};var te=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_lime_ui_MouseWheelMode_Void"]=te;te.__name__=!0;te.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=this.__repeat,d=0;d<e.length&&(e[d](a,b,c),g[d]?++d:this.remove(e[d]),!this.canceled););},__class__:te};var ue=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=
[]};d["lime.app._Event_Int_Float_Float_Void"]=ue;ue.__name__=!0;ue.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:ue};var ve=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Float_Void"]=
ve;ve.__name__=!0;ve.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),
this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:ve};var Vc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Int_Void"]=Vc;Vc.__name__=!0;Vc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,
0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:Vc};
var ec=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Void"]=ec;ec.__name__=!0;ec.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=
--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:ec};var we=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_lime_ui_JoystickHatPosition_Void"]=we;we.__name__=!0;we.prototype={add:function(a,b,
c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:we};var xe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_String_Int_Int_Void"]=xe;xe.__name__=!0;xe.prototype={add:function(a,b,c){null==c&&
(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:xe};var od=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_String_Void"]=od;od.__name__=!0;od.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);
for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,
c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:od};var ab=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Void_Void"]=ab;ab.__name__=!0;ab.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(){this.canceled=!1;for(var a=this.__listeners,b=this.__repeat,c=0;c<a.length&&(a[c](),b[c]?++c:this.remove(a[c]),!this.canceled););},__class__:ab};var pd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_graphics_RenderContext_Void"]=
pd;pd.__name__=!0;pd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),
this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:pd};var ye=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_GamepadAxis_Float_Void"]=ye;ye.__name__=!0;ye.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,
0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:ye};
var Hd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_GamepadButton_Void"]=Hd;Hd.__name__=!0;Hd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=
this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Hd};var ze=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Gamepad_Void"]=ze;ze.__name__=!0;ze.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:ze};var Ae=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Joystick_Void"]=Ae;Ae.__name__=!0;Ae.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Ae};var qd=function(){this.canceled=!1;this.__listeners=[];
this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_KeyCode_lime_ui_KeyModifier_Void"]=qd;qd.__name__=!0;qd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:qd};var Kc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Touch_Void"]=Kc;Kc.__name__=!0;Kc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<
g;){var d=e++;if(c>this.__priorities[d]){this.__listeners.splice(d,0,a);this.__priorities.splice(d,0,c);this.__repeat.splice(d,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&
(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Kc};var Td=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Window_Void"]=Td;Td.__name__=!0;Td.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)C.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,
e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Td};var Oa=function(a,b,c,e,g,d,f){null==g&&(g=-1);null==e&&(e=-1);null==c&&(c=0);null==b&&(b=0);this.offsetX=b;this.offsetY=c;this.width=e;this.height=g;this.version=0;null==f&&(f=nc.CANVAS);this.type=f;if(null==a){if(0<e&&0<g)switch(this.type._hx_index){case 0:this.buffer=new vc(null,e,g);mb.createCanvas(this,e,g);null!=d&&0!=d&&this.fillRect(new rd(0,0,e,g),d);break;case 1:a=e*g*4,a=null!=a?new Uint8Array(a):null,
this.buffer=new vc(a,e,g),null!=d&&0!=d&&this.fillRect(new rd(0,0,e,g),d)}}else this.__fromImageBuffer(a)};d["lime.graphics.Image"]=Oa;Oa.__name__=!0;Oa.fromFile=function(a){if(null==a)return null;var b=new Oa;return b.__fromFile(a)?b:null};Oa.loadFromBytes=function(a){if(null==a)return Pa.withValue(null);if(Oa.__isPNG(a))var b="image/png";else if(Oa.__isJPG(a))b="image/jpeg";else if(Oa.__isGIF(a))b="image/gif";else if(Oa.__isWebP(a))b="image/webp";else return Pa.withValue(null);return R.loadImageFromBytes(a,
b)};Oa.loadFromFile=function(a){return null==a?Pa.withValue(null):R.loadImage(a)};Oa.__isGIF=function(a){if(null==a||6>a.length)return!1;a=a.getString(0,6);return"GIF87a"!=a?"GIF89a"==a:!0};Oa.__isJPG=function(a){return null==a||4>a.length?!1:255==a.b[0]&&216==a.b[1]&&255==a.b[a.length-2]?217==a.b[a.length-1]:!1};Oa.__isPNG=function(a){return null==a||8>a.length?!1:137==a.b[0]&&80==a.b[1]&&78==a.b[2]&&71==a.b[3]&&13==a.b[4]&&10==a.b[5]&&26==a.b[6]?10==a.b[7]:!1};Oa.__isWebP=function(a){return null==
a||16>a.length?!1:"RIFF"==a.getString(0,4)?"WEBP"==a.getString(8,4):!1};Oa.prototype={fillRect:function(a,b,c){a=this.__clipRect(a);if(null!=this.buffer&&null!=a)switch(this.type._hx_index){case 0:mb.fillRect(this,a,b,c);break;case 1:mb.convertToData(this);if(0==this.buffer.data.length)break;Ne.fillRect(this,a,b,c);break;case 2:a.offset(this.offsetX,this.offsetY);if(null==c)b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255;else switch(c){case 1:break;case 2:b=(b&255)<<24|(b>>>8&255)<<16|(b>>>
16&255)<<8|b>>>24&255;break;default:b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255}this.buffer.__srcBitmapData.fillRect(a.__toFlashRectangle(),b)}},__clipRect:function(a){return null==a||0>a.x&&(a.width-=-a.x,a.x=0,0>=a.x+a.width)||0>a.y&&(a.height-=-a.y,a.y=0,0>=a.y+a.height)||a.x+a.width>=this.width&&(a.width-=a.x+a.width-this.width,0>=a.width)||a.y+a.height>=this.height&&(a.height-=a.y+a.height-this.height,0>=a.height)?null:a},__fromBase64:function(a,b,c){var e=this,g=new Image;g.addEventListener("load",
function(a){e.buffer=new vc(null,g.width,g.height);e.buffer.__srcImage=g;e.offsetX=0;e.offsetY=0;e.width=e.buffer.width;e.height=e.buffer.height;null!=c&&c(e)},!1);g.src="data:"+b+";base64,"+a},__fromBytes:function(a,b){if(Oa.__isPNG(a))var c="image/png";else if(Oa.__isJPG(a))c="image/jpeg";else if(Oa.__isGIF(a))c="image/gif";else return!1;this.__fromBase64(hc.encode(a),c,b);return!0},__fromFile:function(a,b,c){var e=this,g=new Image;R.__isSameOrigin(a)||(g.crossOrigin="Anonymous");g.onload=function(a){e.buffer=
new vc(null,g.width,g.height);e.buffer.__srcImage=g;e.width=g.width;e.height=g.height;null!=b&&b(e)};g.onerror=function(a){null!=c&&c()};g.src=a;return!0},__fromImageBuffer:function(a){this.buffer=a;null!=a&&(-1==this.width&&(this.width=a.width),-1==this.height&&(this.height=a.height))},get_data:function(){null==this.buffer.data&&0<this.buffer.width&&0<this.buffer.height&&mb.convertToData(this);return this.buffer.data},get_rect:function(){return new rd(0,0,this.width,this.height)},get_transparent:function(){return null==
this.buffer?!1:this.buffer.transparent},set_transparent:function(a){return null==this.buffer?!1:this.buffer.transparent=a},__class__:Oa,__properties__:{set_transparent:"set_transparent",get_transparent:"get_transparent",get_rect:"get_rect",get_data:"get_data"}};var vc=function(a,b,c,e,g){null==e&&(e=32);null==c&&(c=0);null==b&&(b=0);this.data=a;this.width=b;this.height=c;this.bitsPerPixel=e;this.format=null==g?0:g;this.premultiplied=!1;this.transparent=!0};d["lime.graphics.ImageBuffer"]=vc;vc.__name__=
!0;vc.prototype={get_stride:function(){return this.width*(this.bitsPerPixel/8|0)},__class__:vc,__properties__:{get_stride:"get_stride"}};var nc=y["lime.graphics.ImageType"]={__ename__:!0,__constructs__:null,CANVAS:{_hx_name:"CANVAS",_hx_index:0,__enum__:"lime.graphics.ImageType",toString:n},DATA:{_hx_name:"DATA",_hx_index:1,__enum__:"lime.graphics.ImageType",toString:n},FLASH:{_hx_name:"FLASH",_hx_index:2,__enum__:"lime.graphics.ImageType",toString:n},CUSTOM:{_hx_name:"CUSTOM",_hx_index:3,__enum__:"lime.graphics.ImageType",
toString:n}};nc.__constructs__=[nc.CANVAS,nc.DATA,nc.FLASH,nc.CUSTOM];var ne=function(){};d["lime.graphics.RenderContext"]=ne;ne.__name__=!0;ne.prototype={__class__:ne};var cf={fromWebGL2RenderContext:function(a){return a}},Zc=function(){};d["lime.graphics.opengl.GL"]=Zc;Zc.__name__=!0;var Tb={},rd=function(a,b,c,e){null==e&&(e=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.width=c;this.height=e};d["lime.math.Rectangle"]=rd;rd.__name__=!0;rd.prototype={offset:function(a,b){this.x+=
a;this.y+=b},__toFlashRectangle:function(){return null},__class__:rd};var Za=function(){};d["lime.media.AudioBuffer"]=Za;Za.__name__=!0;Za.fromBytes=function(a){if(null==a)return null;var b=new Za;b.set_src(new Howl({src:["data:"+Za.__getCodec(a)+";base64,"+hc.encode(a)],html5:!0,preload:!1}));return b};Za.fromFile=function(a){if(null==a)return null;var b=new Za;b.__srcHowl=new Howl({src:[a],preload:!1});return b};Za.fromFiles=function(a){var b=new Za;b.__srcHowl=new Howl({src:a,preload:!1});return b};
Za.loadFromFile=function(a){var b=new zb,c=Za.fromFile(a);null!=c?null!=c&&(c.__srcHowl.on("load",function(){b.complete(c)}),c.__srcHowl.on("loaderror",function(a,c){b.error(c)}),c.__srcHowl.load()):b.error(null);return b.future};Za.loadFromFiles=function(a){var b=new zb,c=Za.fromFiles(a);null!=c?(c.__srcHowl.on("load",function(){b.complete(c)}),c.__srcHowl.on("loaderror",function(){b.error(null)}),c.__srcHowl.load()):b.error(null);return b.future};Za.__getCodec=function(a){switch(a.getString(0,4)){case "OggS":return"audio/ogg";
case "RIFF":if("WAVE"==a.getString(8,4))return"audio/wav";var b=a.b[1],c=a.b[2];switch(a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}break;case "fLaC":return"audio/flac";default:switch(b=a.b[1],c=a.b[2],a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}}Ga.error("Unsupported sound format",{fileName:"lime/media/AudioBuffer.hx",lineNumber:362,className:"lime.media.AudioBuffer",
methodName:"__getCodec"});return null};Za.prototype={set_src:function(a){return this.__srcHowl=a},__class__:Za,__properties__:{set_src:"set_src"}};var Ce=function(a){if("custom"!=a){if(null==a||"web"==a)try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.web=new window.AudioContext,this.type="web"}catch(b){ja.lastError=b}null==this.web&&"web"!=a&&(this.html5=new Be,this.type="html5")}else this.type="custom"};d["lime.media.AudioContext"]=Ce;Ce.__name__=!0;Ce.prototype={__class__:Ce};
var ic=function(){};d["lime.media.AudioManager"]=ic;ic.__name__=!0;ic.init=function(a){if(null==ic.context){if(null==a&&(ic.context=new Ce,a=ic.context,"openal"==a.type)){var b=a.openal,c=b.openDevice();c=b.createContext(c);b.makeContextCurrent(c);b.processContext(c)}ic.context=a}};var Be=function(){};d["lime.media.HTML5AudioContext"]=Be;Be.__name__=!0;Be.prototype={__class__:Be};var Oe=function(){};d["lime.media.OpenALAudioContext"]=Oe;Oe.__name__=!0;Oe.prototype={createContext:function(a,b){return wc.createContext(a,
b)},makeContextCurrent:function(a){return wc.makeContextCurrent(a)},openDevice:function(a){return wc.openDevice(a)},processContext:function(a){wc.processContext(a)},__class__:Oe};var wc=function(){};d["lime.media.openal.ALC"]=wc;wc.__name__=!0;wc.createContext=function(a,b){return null};wc.makeContextCurrent=function(a){return!1};wc.openDevice=function(a){return null};wc.processContext=function(a){};var Uc=function(){};d["lime.net._IHTTPRequest"]=Uc;Uc.__name__=!0;Uc.__isInterface__=!0;Uc.prototype=
{__class__:Uc};var Gb=function(a){this.uri=a;this.contentType="application/x-www-form-urlencoded";this.followRedirects=!0;this.enableResponseHeaders=!1;this.formData=new T;this.headers=[];this.method="GET";this.timeout=3E4;this.withCredentials=!1;this.__backend=new R;this.__backend.init(this)};d["lime.net._HTTPRequest.AbstractHTTPRequest"]=Gb;Gb.__name__=!0;Gb.__interfaces__=[Uc];Gb.prototype={__class__:Gb};var sd=function(a){Gb.call(this,a)};d["lime.net._HTTPRequest_Bytes"]=sd;sd.__name__=!0;sd.__super__=
Gb;sd.prototype=B(Gb.prototype,{fromBytes:function(a){return a},load:function(a){var b=this;null!=a&&(this.uri=a);var c=new zb;a=this.__backend.loadData(this.uri);a.onProgress(f(c,c.progress));a.onError(f(c,c.error));a.onComplete(function(a){b.responseData=b.fromBytes(a);c.complete(b.responseData)});return c.future},__class__:sd});var Id=function(a){Gb.call(this,a)};d["lime.net._HTTPRequest_String"]=Id;Id.__name__=!0;Id.__super__=Gb;Id.prototype=B(Gb.prototype,{load:function(a){var b=this;null!=a&&
(this.uri=a);var c=new zb;a=this.__backend.loadText(this.uri);a.onProgress(f(c,c.progress));a.onError(f(c,c.error));a.onComplete(function(a){b.responseData=a;c.complete(b.responseData)});return c.future},__class__:Id});var me=function(a,b){null==b&&(b="");this.name=a;this.value=b};d["lime.net.HTTPRequestHeader"]=me;me.__name__=!0;me.prototype={__class__:me};var Jd=function(a){Gb.call(this,a)};d["lime.net._HTTPRequest_lime_utils_Bytes"]=Jd;Jd.__name__=!0;Jd.__super__=sd;Jd.prototype=B(sd.prototype,
{fromBytes:function(a){return oc.fromBytes(a)},__class__:Jd});var jc=function(a,b){this.onUpdate=new qe;this.type=a;this.id=b};d["lime.system.Sensor"]=jc;jc.__name__=!0;jc.registerSensor=function(a,b){a=new jc(a,b);jc.sensors.push(a);return jc.sensorByID.h[b]=a};jc.prototype={__class__:jc};var Re=y["lime.system.SensorType"]={__ename__:!0,__constructs__:null,ACCELEROMETER:{_hx_name:"ACCELEROMETER",_hx_index:0,__enum__:"lime.system.SensorType",toString:n}};Re.__constructs__=[Re.ACCELEROMETER];var Eb=
function(){};d["lime.system.System"]=Eb;Eb.__name__=!0;Eb.embed=k.lime.embed=function(a,b,c,e,g){if(null!=Eb.__applicationEntryPoint&&Object.prototype.hasOwnProperty.call(Eb.__applicationEntryPoint.h,a)){var d="string"==typeof b?window.document.getElementById(b):null==b?window.document.createElement("div"):b;null==d?window.console.log("[lime.embed] ERROR: Cannot find target element: "+p.string(b)):(null==c&&(c=0),null==e&&(e=0),null==g&&(g={}),Object.prototype.hasOwnProperty.call(g,"background")&&
"string"==typeof g.background&&(b=q.replace(p.string(g.background),"#",""),-1<b.indexOf("0x")?g.background=p.parseInt(b):g.background=p.parseInt("0x"+b)),g.element=d,g.width=c,g.height=e,Eb.__applicationEntryPoint.h[a](g))}};Eb.exit=function(a){};Eb.__registerEntryPoint=function(a,b){null==Eb.__applicationEntryPoint&&(Eb.__applicationEntryPoint=new T);Eb.__applicationEntryPoint.h[a]=b};var pe=function(a,b){null==b&&(b=1);null==a&&(a=0);this.onRun=new Jc;this.onError=new Jc;this.onComplete=new Jc;
this.doWork=new Jc;this.minThreads=a;this.maxThreads=b;this.currentThreads=0};d["lime.system.ThreadPool"]=pe;pe.__name__=!0;pe.prototype={queue:function(a){this.runWork(a)},sendComplete:function(a){this.onComplete.dispatch(a)},sendError:function(a){this.onError.dispatch(a)},runWork:function(a){this.onRun.dispatch(a);this.doWork.dispatch(a)},__class__:pe};var Db=function(a){null!=a&&(this.name=a);this.__init||(void 0==this.ascender&&(this.ascender=0),void 0==this.descender&&(this.descender=0),void 0==
this.height&&(this.height=0),void 0==this.numGlyphs&&(this.numGlyphs=0),void 0==this.underlinePosition&&(this.underlinePosition=0),void 0==this.underlineThickness&&(this.underlineThickness=0),void 0==this.unitsPerEM&&(this.unitsPerEM=0),null!=this.__fontID?ba.isLocal(this.__fontID)&&this.__fromBytes(ba.getBytes(this.__fontID)):null!=this.__fontPath&&this.__fromFile(this.__fontPath))};d["lime.text.Font"]=Db;Db.__name__=!0;Db.fromFile=function(a){if(null==a)return null;var b=new Db;b.__fromFile(a);
return b};Db.loadFromName=function(a){return(new Db).__loadFromName(a)};Db.__measureFontNode=function(a){var b=window.document.createElement("span");b.setAttribute("aria-hidden","true");var c=window.document.createTextNode("BESbswy");b.appendChild(c);c=b.style;c.display="block";c.position="absolute";c.top="-9999px";c.left="-9999px";c.fontSize="300px";c.width="auto";c.height="auto";c.lineHeight="normal";c.margin="0";c.padding="0";c.fontVariant="normal";c.whiteSpace="nowrap";c.fontFamily=a;window.document.body.appendChild(b);
return b};Db.prototype={__fromBytes:function(a){this.__fontPath=null},__fromFile:function(a){this.__fontPath=a},__loadFromName:function(a){var b=this,c=new zb;this.name=a;var e=v.navigator.userAgent.toLowerCase(),g=0<=e.indexOf(" safari/")&&0>e.indexOf(" chrome/");e=(new Z("(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)","i")).match(e);if(!g&&!e&&window.document.fonts&&(h=window.document.fonts,f(h,h.load)))window.document.fonts.load("1em '"+a+"'").then(function(a){c.complete(b)},function(e){Ga.warn('Could not load web font "'+
a+'"',{fileName:"lime/text/Font.hx",lineNumber:513,className:"lime.text.Font",methodName:"__loadFromName"});c.complete(b)});else{var d=Db.__measureFontNode("'"+a+"', sans-serif"),p=Db.__measureFontNode("'"+a+"', serif"),m=d.offsetWidth,q=p.offsetWidth,n=-1,A=0,r,k;n=window.setInterval(function(){A+=1;r=d.offsetWidth!=m||p.offsetWidth!=q;k=3E3<=50*A;if(r||k)window.clearInterval(n),d.parentNode.removeChild(d),p.parentNode.removeChild(p),p=d=null,k&&Ga.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",
lineNumber:548,className:"lime.text.Font",methodName:"__loadFromName"}),c.complete(b)},50)}return c.future},__class__:Db};var Ta=function(a){this.onDisconnect=new ab;this.onButtonUp=new Hd;this.onButtonDown=new Hd;this.onAxisMove=new ye;this.id=a;this.connected=!0};d["lime.ui.Gamepad"]=Ta;Ta.__name__=!0;Ta.__connect=function(a){if(!Ta.devices.h.hasOwnProperty(a)){var b=new Ta(a);Ta.devices.h[a]=b;Ta.onConnect.dispatch(b)}};Ta.__disconnect=function(a){var b=Ta.devices.h[a];null!=b&&(b.connected=!1);
Ta.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};Ta.prototype={__class__:Ta};var fb=function(a){this.onTrackballMove=new ue;this.onHatMove=new we;this.onDisconnect=new ab;this.onButtonUp=new ec;this.onButtonDown=new ec;this.onAxisMove=new ve;this.id=a;this.connected=!0};d["lime.ui.Joystick"]=fb;fb.__name__=!0;fb.__connect=function(a){if(!fb.devices.h.hasOwnProperty(a)){var b=new fb(a);fb.devices.h[a]=b;fb.onConnect.dispatch(b)}};fb.__disconnect=function(a){var b=fb.devices.h[a];null!=b&&(b.connected=
!1);fb.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};fb.__getDeviceData=function(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():null};fb.prototype={__class__:fb};var Sb=y["lime.ui.MouseCursor"]={__ename__:!0,__constructs__:null,ARROW:{_hx_name:"ARROW",_hx_index:0,__enum__:"lime.ui.MouseCursor",toString:n},CROSSHAIR:{_hx_name:"CROSSHAIR",_hx_index:1,__enum__:"lime.ui.MouseCursor",toString:n},DEFAULT:{_hx_name:"DEFAULT",_hx_index:2,
__enum__:"lime.ui.MouseCursor",toString:n},MOVE:{_hx_name:"MOVE",_hx_index:3,__enum__:"lime.ui.MouseCursor",toString:n},POINTER:{_hx_name:"POINTER",_hx_index:4,__enum__:"lime.ui.MouseCursor",toString:n},RESIZE_NESW:{_hx_name:"RESIZE_NESW",_hx_index:5,__enum__:"lime.ui.MouseCursor",toString:n},RESIZE_NS:{_hx_name:"RESIZE_NS",_hx_index:6,__enum__:"lime.ui.MouseCursor",toString:n},RESIZE_NWSE:{_hx_name:"RESIZE_NWSE",_hx_index:7,__enum__:"lime.ui.MouseCursor",toString:n},RESIZE_WE:{_hx_name:"RESIZE_WE",
_hx_index:8,__enum__:"lime.ui.MouseCursor",toString:n},TEXT:{_hx_name:"TEXT",_hx_index:9,__enum__:"lime.ui.MouseCursor",toString:n},WAIT:{_hx_name:"WAIT",_hx_index:10,__enum__:"lime.ui.MouseCursor",toString:n},WAIT_ARROW:{_hx_name:"WAIT_ARROW",_hx_index:11,__enum__:"lime.ui.MouseCursor",toString:n},CUSTOM:{_hx_name:"CUSTOM",_hx_index:12,__enum__:"lime.ui.MouseCursor",toString:n}};Sb.__constructs__=[Sb.ARROW,Sb.CROSSHAIR,Sb.DEFAULT,Sb.MOVE,Sb.POINTER,Sb.RESIZE_NESW,Sb.RESIZE_NS,Sb.RESIZE_NWSE,Sb.RESIZE_WE,
Sb.TEXT,Sb.WAIT,Sb.WAIT_ARROW,Sb.CUSTOM];var Bc=y["lime.ui.MouseWheelMode"]={__ename__:!0,__constructs__:null,PIXELS:{_hx_name:"PIXELS",_hx_index:0,__enum__:"lime.ui.MouseWheelMode",toString:n},LINES:{_hx_name:"LINES",_hx_index:1,__enum__:"lime.ui.MouseWheelMode",toString:n},PAGES:{_hx_name:"PAGES",_hx_index:2,__enum__:"lime.ui.MouseWheelMode",toString:n},UNKNOWN:{_hx_name:"UNKNOWN",_hx_index:3,__enum__:"lime.ui.MouseWheelMode",toString:n}};Bc.__constructs__=[Bc.PIXELS,Bc.LINES,Bc.PAGES,Bc.UNKNOWN];
var Bb=function(a,b,c,e,g,d,f){this.x=a;this.y=b;this.id=c;this.dx=e;this.dy=g;this.pressure=d;this.device=f};d["lime.ui.Touch"]=Bb;Bb.__name__=!0;Bb.prototype={__class__:Bb};var Vd=function(a,b){this.onTextInput=new od;this.onTextEdit=new xe;this.onRestore=new ab;this.onResize=new Vc;this.onRenderContextRestored=new pd;this.onRenderContextLost=new ab;this.onRender=new pd;this.onMove=new $c;this.onMouseWheel=new te;this.onMouseUp=new re;this.onMouseMoveRelative=new $c;this.onMouseMove=new $c;this.onMouseDown=
new se;this.onMinimize=new ab;this.onLeave=new ab;this.onKeyUp=new qd;this.onKeyDown=new qd;this.onFullscreen=new ab;this.onFocusOut=new ab;this.onFocusIn=new ab;this.onExpose=new ab;this.onEnter=new ab;this.onDropFile=new od;this.onDeactivate=new ab;this.onClose=new ab;this.onActivate=new ab;this.application=a;this.__attributes=null!=b?b:{};Object.prototype.hasOwnProperty.call(this.__attributes,"parameters")&&(this.parameters=this.__attributes.parameters);this.__height=this.__width=0;this.__fullscreen=
!1;this.__scale=1;this.__y=this.__x=0;this.__title="";this.id=-1;this.__backend=new Yc(this)};d["lime.ui.Window"]=Vd;Vd.__name__=!0;Vd.prototype={close:function(){this.__backend.close()},__class__:Vd};var Ub=function(){this.data=new T;this.paths=[]};d["lime.utils.AssetBundle"]=Ub;Ub.__name__=!0;Ub.fromBytes=function(a){a=new md(a);return Ub.__extractBundle(a)};Ub.loadFromBytes=function(a){return Pa.withValue(Ub.fromBytes(a))};Ub.loadFromFile=function(a){return oc.loadFromFile(a).then(Ub.loadFromBytes)};
Ub.__extractBundle=function(a){var b=nd.readZip(a);a=new Ub;for(b=b.h;null!=b;){var c=b.item;b=b.next;if(c.compressed){var e=a.data,g=c.fileName,d=oc.decompress(c.data,ad.DEFLATE);e.h[g]=d}else a.data.h[c.fileName]=c.data;a.paths.push(c.fileName)}return a};Ub.prototype={__class__:Ub};var De=function(){this.enabled=!0;this.audio=new T;this.font=new T;this.image=new T;this.version=740863};d["lime.utils.AssetCache"]=De;De.__name__=!0;De.prototype={exists:function(a,b){return("IMAGE"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.image.h,
a)||("FONT"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.font.h,a)||("SOUND"==b||"MUSIC"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.audio.h,a)?!0:!1},set:function(a,b,c){switch(b){case "FONT":this.font.h[a]=c;break;case "IMAGE":if(!(c instanceof Oa))throw z.thrown("Cannot cache non-Image asset: "+p.string(c)+" as Image");this.image.h[a]=c;break;case "MUSIC":case "SOUND":if(!(c instanceof Za))throw z.thrown("Cannot cache non-AudioBuffer asset: "+p.string(c)+" as AudioBuffer");
this.audio.h[a]=c;break;default:throw z.thrown(b+" assets are not cachable");}},clear:function(a){if(null==a)this.audio=new T,this.font=new T,this.image=new T;else{var b=this.audio.h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var g=b[e++];if(q.startsWith(g,a)){var d=this.audio;Object.prototype.hasOwnProperty.call(d.h,g)&&delete d.h[g]}}b=this.font.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)g=b[e++],q.startsWith(g,a)&&(d=this.font,Object.prototype.hasOwnProperty.call(d.h,g)&&delete d.h[g]);b=this.image.h;
b=Object.keys(b);c=b.length;for(e=0;e<c;)g=b[e++],q.startsWith(g,a)&&(d=this.image,Object.prototype.hasOwnProperty.call(d.h,g)&&delete d.h[g])}},__class__:De};var $b=function(){this.types=new T;this.sizes=new T;this.preload=new T;this.paths=new T;this.pathGroups=new T;this.classTypes=new T;this.cachedText=new T;this.cachedImages=new T;this.cachedFonts=new T;this.cachedBytes=new T;this.cachedAudioBuffers=new T;this.onChange=new ab;this.bytesTotal=this.bytesLoaded=0};d["lime.utils.AssetLibrary"]=$b;
$b.__name__=!0;$b.fromBundle=function(a){if(Object.prototype.hasOwnProperty.call(a.data.h,"library.json")){var b=rb.fromBytes(a.data.h["library.json"]);if(null!=b){if(null==b.libraryType)var c=new $b;else if(c=d[b.libraryType],null!=c)c=ea.createInstance(c,b.libraryArgs);else return Ga.warn("Could not find library type: "+b.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:122,className:"lime.utils.AssetLibrary",methodName:"fromBundle"}),null;c.__fromBundle(a,b);return c}}else return c=
new $b,c.__fromBundle(a),c;return null};$b.fromManifest=function(a){if(null==a)return null;if(null==a.libraryType)var b=new $b;else if(b=d[a.libraryType],null!=b)b=ea.createInstance(b,a.libraryArgs);else return Ga.warn("Could not find library type: "+a.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:160,className:"lime.utils.AssetLibrary",methodName:"fromManifest"}),null;b.__fromManifest(a);return b};$b.prototype={exists:function(a,b){b=null!=b?ua.__cast(b,String):null;a=this.types.h[a];
return null==a||a!=b&&("SOUND"!=b&&"MUSIC"!=b||"MUSIC"!=a&&"SOUND"!=a)&&"BINARY"!=b&&null!=b&&("BINARY"!=a||"TEXT"!=b)?!1:!0},getAsset:function(a,b){switch(b){case "BINARY":return this.getBytes(a);case "FONT":return this.getFont(a);case "IMAGE":return this.getImage(a);case "MUSIC":case "SOUND":return this.getAudioBuffer(a);case "TEMPLATE":throw z.thrown("Not sure how to get template: "+a);case "TEXT":return this.getText(a);default:throw z.thrown("Unknown asset type: "+b);}},getAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,
a)?this.cachedAudioBuffers.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Za.fromBytes(ua.__cast(ea.createInstance(this.classTypes.h[a],[]),Ma)):Za.fromFile(this.paths.h[a])},getBytes:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a))return this.cachedBytes.h[a];if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a)){var b=oc.ofString(this.cachedText.h[a]);return this.cachedBytes.h[a]=b}return Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?
ua.__cast(ea.createInstance(this.classTypes.h[a],[]),Ma):oc.fromFile(this.paths.h[a])},getFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?this.cachedFonts.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?ua.__cast(ea.createInstance(this.classTypes.h[a],[]),Db):Db.fromFile(this.paths.h[a])},getImage:function(a){return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a)?this.cachedImages.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,
a)?ua.__cast(ea.createInstance(this.classTypes.h[a],[]),Oa):Oa.fromFile(this.paths.h[a])},getText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return this.cachedText.h[a];a=this.getBytes(a);return null==a?null:a.getString(0,a.length)},isLocal:function(a,b){if(Object.prototype.hasOwnProperty.call(this.classTypes.h,a))return!0;b=null!=b?ua.__cast(b,String):null;if(null==b)return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,
a);switch(b){case "FONT":return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a);case "IMAGE":return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a);case "MUSIC":case "SOUND":return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a);default:return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a)}},load:function(){if(this.loaded)return Pa.withValue(this);if(null==this.promise){this.promise=new zb;
this.bytesLoadedCache=new T;this.assetsLoaded=0;this.assetsTotal=1;for(var a=Object.keys(this.preload.h),b=a.length,c=0;c<b;){var e=a[c++];if(this.preload.h[e]){Ga.verbose("Preloading asset: "+e+" ["+this.types.h[e]+"]",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:405,className:"lime.utils.AssetLibrary",methodName:"load"});var g=this.types.h[e];if(null!=g)switch(g){case "BINARY":this.assetsTotal++;g=this.loadBytes(e);g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[f(this,
this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[f(this,this.load_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[f(this,this.loadBytes_onComplete)]));break;case "FONT":this.assetsTotal++;g=this.loadFont(e);g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[f(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[f(this,this.load_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],
c)}}([e],[f(this,this.loadFont_onComplete)]));break;case "IMAGE":this.assetsTotal++;g=this.loadImage(e);g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[f(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[f(this,this.load_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[f(this,this.loadImage_onComplete)]));break;case "MUSIC":case "SOUND":this.assetsTotal++;g=this.loadAudioBuffer(e);g.onProgress(function(a,
b){return function(c,e){b[0](a[0],c,e)}}([e],[f(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[f(this,this.loadAudioBuffer_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[f(this,this.loadAudioBuffer_onComplete)]));break;case "TEXT":this.assetsTotal++,g=this.loadText(e),g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[f(this,this.load_onProgress)])),g.onError(function(a,b){return function(c){b[0](a[0],
c)}}([e],[f(this,this.load_onError)])),g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[f(this,this.loadText_onComplete)]))}}}this.__assetLoaded(null)}return this.promise.future},loadAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?Pa.withValue(this.cachedAudioBuffers.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Pa.withValue(ea.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.pathGroups.h,
a)?Za.loadFromFiles(this.pathGroups.h[a]):Za.loadFromFile(this.paths.h[a])},loadBytes:function(a){return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Pa.withValue(this.cachedBytes.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Pa.withValue(ea.createInstance(this.classTypes.h[a],[])):oc.loadFromFile(this.paths.h[a])},loadFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?Pa.withValue(this.cachedFonts.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,
a)?(a=ea.createInstance(this.classTypes.h[a],[]),a.__loadFromName(a.name)):Db.loadFromName(this.paths.h[a])},loadImage:function(a){var b=this;return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a)?Pa.withValue(this.cachedImages.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Pa.withValue(ea.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Oa.loadFromBytes(this.cachedBytes.h[a]).then(function(c){var e=b.cachedBytes;Object.prototype.hasOwnProperty.call(e.h,
a)&&delete e.h[a];b.cachedImages.h[a]=c;return Pa.withValue(c)}):Oa.loadFromFile(this.paths.h[a])},loadText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return Pa.withValue(this.cachedText.h[a]);if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)||Object.prototype.hasOwnProperty.call(this.classTypes.h,a)){var b=this.getBytes(a);if(null==b)return Pa.withValue(null);b=b.getString(0,b.length);this.cachedText.h[a]=b;return Pa.withValue(b)}return(new Id).load(this.paths.h[a])},
unload:function(){},__assetLoaded:function(a){this.assetsLoaded++;null!=a&&Ga.verbose("Loaded asset: "+a+" ["+this.types.h[a]+"] ("+(this.assetsLoaded-1)+"/"+(this.assetsTotal-1)+")",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:619,className:"lime.utils.AssetLibrary",methodName:"__assetLoaded"});if(null!=a){var b=Object.prototype.hasOwnProperty.call(this.sizes.h,a)?this.sizes.h[a]:0;if(Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)){var c=this.bytesLoadedCache.h[a];c<b&&(this.bytesLoaded+=
b-c)}else this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b}this.assetsLoaded<this.assetsTotal?this.promise.progress(this.bytesLoaded,this.bytesTotal):(this.loaded=!0,this.promise.progress(this.bytesTotal,this.bytesTotal),this.promise.complete(this))},__cacheBreak:function(a){return ba.__cacheBreak(a)},__fromBundle:function(a,b){if(null!=b){var c=0;for(b=b.assets;c<b.length;){var e=b[c];++c;var g=Object.prototype.hasOwnProperty.call(e,"id")?e.id:e.path;var d=a.data.h[e.path];if(Object.prototype.hasOwnProperty.call(e,
"type")){var f=e.type;"TEXT"==f?this.cachedText.h[g]=null!=d?p.string(d):null:this.cachedBytes.h[g]=d;this.types.h[g]=e.type}else this.cachedBytes.h[g]=d,this.types.h[g]="BINARY"}}else for(c=0,b=a.paths;c<b.length;)g=b[c],++c,this.cachedBytes.h[g]=a.data.h[g],this.types.h[g]="BINARY"},__fromManifest:function(a){var b=2<=a.version,c=a.rootPath;null==c&&(c="");""!=c&&(c+="/");for(var e=0,g=a.assets;e<g.length;){var f=g[e];++e;var h=b&&Object.prototype.hasOwnProperty.call(f,"size")?f.size:100;var m=
Object.prototype.hasOwnProperty.call(f,"id")?f.id:f.path;if(Object.prototype.hasOwnProperty.call(f,"path")){var q=this.paths;var n=this.__cacheBreak(this.__resolvePath(c+p.string(C.field(f,"path"))));q.h[m]=n}if(Object.prototype.hasOwnProperty.call(f,"pathGroup")){q=C.field(f,"pathGroup");n=0;for(var A=q.length;n<A;){var r=n++;q[r]=this.__cacheBreak(this.__resolvePath(c+q[r]))}this.pathGroups.h[m]=q}this.sizes.h[m]=h;this.types.h[m]=f.type;Object.prototype.hasOwnProperty.call(f,"preload")&&(this.preload.h[m]=
C.field(f,"preload"));Object.prototype.hasOwnProperty.call(f,"className")&&(h=C.field(f,"className"),h=d[h],this.classTypes.h[m]=h)}e=this.bytesTotal=0;for(g=a.assets;e<g.length;)f=g[e],++e,m=Object.prototype.hasOwnProperty.call(f,"id")?f.id:f.path,Object.prototype.hasOwnProperty.call(this.preload.h,m)&&this.preload.h[m]&&Object.prototype.hasOwnProperty.call(this.sizes.h,m)&&(this.bytesTotal+=this.sizes.h[m])},__resolvePath:function(a){a=q.replace(a,"\\","/");var b=a.indexOf(":");q.startsWith(a,"http")&&
0<b?(b+=3,a=K.substr(a,0,b)+q.replace(K.substr(a,b,null),"//","/")):a=q.replace(a,"//","/");if(-1<a.indexOf("./")){a=a.split("/");b=[];for(var c=0,e=a.length;c<e;){var g=c++;".."==a[g]?0==g||".."==b[g-1]?b.push(".."):b.pop():"."==a[g]?0==g&&b.push("."):b.push(a[g])}a=b.join("/")}return a},loadAudioBuffer_onComplete:function(a,b){this.cachedAudioBuffers.h[a]=b;if(Object.prototype.hasOwnProperty.call(this.pathGroups.h,a))for(var c=this.pathGroups.h[a],e=Object.keys(this.pathGroups.h),g=e.length,d=0;d<
g;){var f=e[d++];if(f!=a)for(var h=0;h<c.length;){var p=c[h];++h;if(-1<this.pathGroups.h[f].indexOf(p)){this.cachedAudioBuffers.h[f]=b;break}}}this.__assetLoaded(a)},loadAudioBuffer_onError:function(a,b){null!=b&&""!=b?Ga.warn('Could not load "'+a+'": '+p.string(b),{fileName:"lime/utils/AssetLibrary.hx",lineNumber:865,className:"lime.utils.AssetLibrary",methodName:"loadAudioBuffer_onError"}):Ga.warn('Could not load "'+a+'"',{fileName:"lime/utils/AssetLibrary.hx",lineNumber:869,className:"lime.utils.AssetLibrary",
methodName:"loadAudioBuffer_onError"});this.loadAudioBuffer_onComplete(a,new Za)},loadBytes_onComplete:function(a,b){this.cachedBytes.h[a]=b;this.__assetLoaded(a)},loadFont_onComplete:function(a,b){this.cachedFonts.h[a]=b;this.__assetLoaded(a)},loadImage_onComplete:function(a,b){this.cachedImages.h[a]=b;this.__assetLoaded(a)},loadText_onComplete:function(a,b){this.cachedText.h[a]=b;this.__assetLoaded(a)},load_onError:function(a,b){null!=b&&""!=b?this.promise.error('Error loading asset "'+a+'": '+
p.string(b)):this.promise.error('Error loading asset "'+a+'"')},load_onProgress:function(a,b,c){if(0<b){var e=this.sizes.h[a];0<c?(b/=c,1<b&&(b=1),b=Math.floor(b*e)):b>e&&(b=e);Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)?(e=this.bytesLoadedCache.h[a],b!=e&&(this.bytesLoaded+=b-e)):this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b;this.promise.progress(this.bytesLoaded,this.bytesTotal)}},__class__:$b};var rb=function(){this.assets=[];this.libraryArgs=[];this.version=2};d["lime.utils.AssetManifest"]=
rb;rb.__name__=!0;rb.fromBytes=function(a,b){return null!=a?rb.parse(a.getString(0,a.length),b):null};rb.loadFromFile=function(a,b){a=rb.__resolvePath(a);b=rb.__resolveRootPath(b,a);return null==a?null:oc.loadFromFile(a).then(function(a){return Pa.withValue(rb.fromBytes(a,b))})};rb.parse=function(a,b){if(null==a||""==a)return null;a=JSON.parse(a);var c=new rb;Object.prototype.hasOwnProperty.call(a,"name")&&(c.name=a.name);Object.prototype.hasOwnProperty.call(a,"libraryType")&&(c.libraryType=a.libraryType);
Object.prototype.hasOwnProperty.call(a,"libraryArgs")&&(c.libraryArgs=a.libraryArgs);if(Object.prototype.hasOwnProperty.call(a,"assets")){var e=a.assets;Object.prototype.hasOwnProperty.call(a,"version")&&2>=a.version?c.assets=Jb.run(e):c.assets=e}Object.prototype.hasOwnProperty.call(a,"rootPath")&&(c.rootPath=a.rootPath);null!=b&&""!=b&&(c.rootPath=null==c.rootPath||""==c.rootPath?b:b+"/"+c.rootPath);return c};rb.__resolvePath=function(a){if(null==a)return null;var b=a.indexOf("?");var c=-1<b?K.substr(a,
0,b):a;for(c=q.replace(c,"\\","/");q.endsWith(c,"/");)c=K.substr(c,0,c.length-1);return q.endsWith(c,".bundle")?-1<b?c+"/library.json"+K.substr(a,b,null):c+"/library.json":a};rb.__resolveRootPath=function(a,b){if(null!=a)return a;a=b.indexOf("?");a=-1<a?K.substr(b,0,a):b;for(a=q.replace(a,"\\","/");q.endsWith(a,"/");){if("/"==a)return a;a=K.substr(a,0,a.length-1)}return q.endsWith(a,".bundle")?a:gc.directory(a)};rb.prototype={__class__:rb};var ba=function(){};d["lime.utils.Assets"]=ba;ba.__name__=
!0;ba.getAsset=function(a,b,c){if(c&&ba.cache.enabled)switch(b){case "BINARY":case "TEXT":c=!1;break;case "FONT":var e=ba.cache.font.h[a];if(null!=e)return e;break;case "IMAGE":e=ba.cache.image.h[a];if(ba.isValidImage(e))return e;break;case "MUSIC":case "SOUND":e=ba.cache.audio.h[a];if(ba.isValidAudio(e))return e;break;case "TEMPLATE":throw z.thrown("Not sure how to get template: "+a);default:return null}var g=a.indexOf(":");e=a.substring(0,g);g=a.substring(g+1);var d=ba.getLibrary(e);if(null!=d)if(d.exists(g,
b)){if(d.isLocal(g,b))return e=d.getAsset(g,b),c&&ba.cache.enabled&&ba.cache.set(a,b,e),e;Ga.error(b+' asset "'+a+'" exists, but only asynchronously',{fileName:"lime/utils/Assets.hx",lineNumber:133,className:"lime.utils.Assets",methodName:"getAsset"})}else Ga.error("There is no "+b+' asset with an ID of "'+a+'"',{fileName:"lime/utils/Assets.hx",lineNumber:138,className:"lime.utils.Assets",methodName:"getAsset"});else Ga.error(ba.__libraryNotFound(e),{fileName:"lime/utils/Assets.hx",lineNumber:143,
className:"lime.utils.Assets",methodName:"getAsset"});return null};ba.getBytes=function(a){return ba.getAsset(a,"BINARY",!1)};ba.getLibrary=function(a){if(null==a||""==a)a="default";return ba.libraries.h[a]};ba.isLocal=function(a,b,c){null==c&&(c=!0);if(c&&ba.cache.enabled&&ba.cache.exists(a,b))return!0;var e=a.indexOf(":");c=a.substring(0,e);a=a.substring(e+1);c=ba.getLibrary(c);return null!=c?c.isLocal(a,b):!1};ba.isValidAudio=function(a){return null!=a};ba.isValidImage=function(a){return null!=
a?null!=a.buffer:!1};ba.loadLibrary=function(a){var b=new zb,c=ba.getLibrary(a);if(null!=c)return c.load();c=a;var e=null;if(Object.prototype.hasOwnProperty.call(ba.bundlePaths.h,a))Ub.loadFromFile(ba.bundlePaths.h[a]).onComplete(function(c){null==c?b.error('Cannot load bundle for library "'+a+'"'):(c=$b.fromBundle(c),null==c?b.error('Cannot open library "'+a+'"'):(ba.libraries.h[a]=c,c.onChange.add((h=ba.onChange,f(h,h.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+
a+'"')});else Object.prototype.hasOwnProperty.call(ba.libraryPaths.h,a)?(c=ba.libraryPaths.h[a],e=gc.directory(c)):(q.endsWith(c,".bundle")?(e=c,c+="/library.json"):e=gc.directory(c),c=ba.__cacheBreak(c)),rb.loadFromFile(c,e).onComplete(function(c){null==c?b.error('Cannot parse asset manifest for library "'+a+'"'):(c=$b.fromManifest(c),null==c?b.error('Cannot open library "'+a+'"'):(ba.libraries.h[a]=c,c.onChange.add((h=ba.onChange,f(h,h.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+
a+'"')});return b.future};ba.registerLibrary=function(a,b){if(Object.prototype.hasOwnProperty.call(ba.libraries.h,a)){if(ba.libraries.h[a]==b)return;ba.unloadLibrary(a)}null!=b&&b.onChange.add(ba.library_onChange);ba.libraries.h[a]=b};ba.unloadLibrary=function(a){if(null==a||""==a)a="default";var b=ba.libraries.h[a];null!=b&&(ba.cache.clear(a+":"),b.onChange.remove(ba.library_onChange),b.unload());b=ba.libraries;Object.prototype.hasOwnProperty.call(b.h,a)&&delete b.h[a]};ba.__cacheBreak=function(a){0<
ba.cache.version&&(a=-1<a.indexOf("?")?a+("&"+ba.cache.version):a+("?"+ba.cache.version));return a};ba.__libraryNotFound=function(a){if(null==a||""==a)a="default";return null==F.current||null==F.current.__preloader||F.current.__preloader.complete?'There is no asset library named "'+a+'"':'There is no asset library named "'+a+'", or it is not yet preloaded'};ba.library_onChange=function(){ba.cache.clear();ba.onChange.dispatch()};var oc={_new:function(a,b){return new Ma(b)},decompress:function(a,b){switch(b._hx_index){case 0:return Je.decompress(a);
case 1:return Ke.decompress(a);case 2:return Le.decompress(a);case 3:return Me.decompress(a)}},fromBytes:function(a){return null==a?null:oc._new(a.length,a.b.bufferValue)},fromFile:function(a){return null},loadFromFile:function(a){return(new Jd).load(a)},ofString:function(a){a=Ma.ofString(a);return oc._new(a.length,a.b.bufferValue)}},ad=y["lime.utils.CompressionAlgorithm"]={__ename__:!0,__constructs__:null,DEFLATE:{_hx_name:"DEFLATE",_hx_index:0,__enum__:"lime.utils.CompressionAlgorithm",toString:n},
GZIP:{_hx_name:"GZIP",_hx_index:1,__enum__:"lime.utils.CompressionAlgorithm",toString:n},LZMA:{_hx_name:"LZMA",_hx_index:2,__enum__:"lime.utils.CompressionAlgorithm",toString:n},ZLIB:{_hx_name:"ZLIB",_hx_index:3,__enum__:"lime.utils.CompressionAlgorithm",toString:n}};ad.__constructs__=[ad.DEFLATE,ad.GZIP,ad.LZMA,ad.ZLIB];var Ga=function(){};d["lime.utils.Log"]=Ga;Ga.__name__=!0;Ga.error=function(a,b){if(1<=Ga.level){a="["+b.className+"] ERROR: "+p.string(a);if(Ga.throwErrors)throw z.thrown(a);console.error(a)}};
Ga.verbose=function(a,b){5<=Ga.level&&(a="["+b.className+"] "+p.string(a),console.log(a))};Ga.warn=function(a,b){2<=Ga.level&&console.warn("["+b.className+"] WARNING: "+p.string(a))};var Ud=function(){this.bytesTotalCache=new T;this.bytesLoadedCache2=new T;this.bytesLoadedCache=new xb;this.onProgress=new Vc;this.onComplete=new ab;this.bytesTotal=this.bytesLoaded=0;this.libraries=[];this.libraryNames=[];this.onProgress.add(f(this,this.update))};d["lime.utils.Preloader"]=Ud;Ud.__name__=!0;Ud.prototype=
{addLibrary:function(a){this.libraries.push(a)},addLibraryName:function(a){-1==this.libraryNames.indexOf(a)&&this.libraryNames.push(a)},load:function(){for(var a=this,b=0,c=this.libraries;b<c.length;){var e=c[b];++b;this.bytesTotal+=e.bytesTotal}this.loadedLibraries=-1;this.preloadStarted=!1;b=0;for(c=this.libraries;b<c.length;)e=[c[b]],++b,Ga.verbose("Preloading asset library",{fileName:"lime/utils/Preloader.hx",lineNumber:132,className:"lime.utils.Preloader",methodName:"load"}),e[0].load().onProgress(function(b){return function(c,
e){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+c:a.bytesLoaded+(c-a.bytesLoadedCache.h[b[0].__id__]);a.bytesLoadedCache.set(b[0],c);a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal)}}(e)).onComplete(function(b){return function(c){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+b[0].bytesTotal:a.bytesLoaded+(b[0].bytesTotal-a.bytesLoadedCache.h[b[0].__id__]);a.loadedAssetLibrary()}}(e)).onError(function(){return function(a){Ga.error(a,
{fileName:"lime/utils/Preloader.hx",lineNumber:168,className:"lime.utils.Preloader",methodName:"load"})}}());b=0;for(c=this.libraryNames;b<c.length;)++b,this.bytesTotal+=200;this.loadedLibraries++;this.preloadStarted=!0;this.updateProgress()},loadedAssetLibrary:function(a){this.loadedLibraries++;var b=this.loadedLibraries;this.preloadStarted||++b;var c=this.libraries.length+this.libraryNames.length;null!=a?Ga.verbose("Loaded asset library: "+a+" ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",
lineNumber:195,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"}):Ga.verbose("Loaded asset library ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",lineNumber:199,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"});this.updateProgress()},start:function(){this.complete||this.simulateProgress||!this.preloadComplete||(this.complete=!0,this.onComplete.dispatch())},update:function(a,b){},updateProgress:function(){var a=this;this.simulateProgress||this.onProgress.dispatch(this.bytesLoaded,
this.bytesTotal);if(this.loadedLibraries==this.libraries.length&&!this.initLibraryNames){this.initLibraryNames=!0;for(var b=0,c=this.libraryNames;b<c.length;){var e=[c[b]];++b;Ga.verbose("Preloading asset library: "+e[0],{fileName:"lime/utils/Preloader.hx",lineNumber:236,className:"lime.utils.Preloader",methodName:"updateProgress"});ba.loadLibrary(e[0]).onProgress(function(b){return function(c,e){0<e&&(Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])||(a.bytesTotalCache.h[b[0]]=e,a.bytesTotal+=
e-200),c>e&&(c=e),Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:a.bytesLoaded+=c,a.bytesLoadedCache2.h[b[0]]=c,a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal))}}(e)).onComplete(function(b){return function(c){c=200;Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])&&(c=a.bytesTotalCache.h[b[0]]);Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:
a.bytesLoaded+=c;a.loadedAssetLibrary(b[0])}}(e)).onError(function(){return function(a){Ga.error(a,{fileName:"lime/utils/Preloader.hx",lineNumber:290,className:"lime.utils.Preloader",methodName:"updateProgress"})}}())}}this.simulateProgress||this.loadedLibraries!=this.libraries.length+this.libraryNames.length||(this.preloadComplete||(this.preloadComplete=!0,Ga.verbose("Preload complete",{fileName:"lime/utils/Preloader.hx",lineNumber:301,className:"lime.utils.Preloader",methodName:"updateProgress"})),
this.start())},__class__:Ud};var $d=function(a,b){this.drawNeedsUpdate=!1;this.totalTicksPassed=this.elapsedMsSinceLastTick=0;this.isUpdating=!1;this.window=a;this.config=null!=b?b:{framesPerSecond:60,drawOnlyWhenRequested:!1};this.setTickDuration(Math.floor(1E3/this.config.framesPerSecond));this.loop=new td;this.loop.onInit(this)};d["ob.gum.Gum"]=$d;$d.__name__=!0;$d.prototype={setTickDuration:function(a){this.tickDurationMs=a},toggleUpdate:function(a){this.isUpdating=null!=a?a:!this.isUpdating},
changeLoop:function(a){this.loop=a;this.loop.onInit(this)},onUpdate:function(a){this.isUpdating&&(this.loop.onUpdate(a),this.elapsedMsSinceLastTick+=a,this.elapsedMsSinceLastTick>=this.tickDurationMs&&(this.elapsedMsSinceLastTick=0,this.totalTicksPassed++,this.drawNeedsUpdate=this.loop.onTick(a)),!this.config.drawOnlyWhenRequested||this.drawNeedsUpdate)&&(this.loop.onDraw(a),this.drawNeedsUpdate=!1)},onKeyDown:function(a,b){this.loop.onKeyDown(a,b)},onKeyUp:function(a,b){this.loop.onKeyUp(a,b)},onMouseMove:function(a,
b){this.loop.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.loop.onMouseDown(a,b,c)},onMouseUp:function(a,b,c){this.loop.onMouseUp(a,b,c)},onMouseScroll:function(a,b,c){this.loop.onMouseScroll(a,b,c)},onWindowResize:function(a,b){this.loop.onWindowResize(a,b)},__class__:$d};var td=function(){};d["ob.gum.LoadingLoop"]=td;td.__name__=!0;td.__interfaces__=[D];td.prototype={onTick:function(a){return!1},onInit:function(a){this.gum=a;la.trace("LoadingLoop onInit",{fileName:"ob/gum/Core.hx",lineNumber:136,
className:"ob.gum.LoadingLoop",methodName:"onInit"})},onUpdate:function(a){},onDraw:function(a){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){},__class__:td};var ce=function(a,b){this.texture=a;this.display=b};d["ob.gum.backends.FrameBuffer"]=ce;ce.__name__=!0;ce.prototype={__class__:ce};var ae=function(a){this.imageCache=[];this.fontCache=[];this.paths=
a};d["ob.gum.backends.Assets"]=ae;ae.__name__=!0;ae.prototype={Preload:function(a){la.trace("begin loading "+p.string(this.paths),{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:141,className:"ob.gum.backends.Assets",methodName:"Preload"});this.onReady=a;this.loadFonts()},loadFonts:function(a){null==a&&(a=0);var b=this;if(a>this.paths.fonts.length-1)this.loadImages();else{var c=this.paths.fonts[a];la.trace("loading font index "+a+" "+c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:153,className:"ob.gum.backends.Assets",
methodName:"loadFonts"});(new Ee(c)).load(function(c){b.fontCache.push(c);a+=1;b.loadFonts(a)})}},loadImages:function(){var a,b=this;la.trace("load images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:163,className:"ob.gum.backends.Assets",methodName:"loadImages"});var c=!1;if(0>=this.paths.images.length)la.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:166,className:"ob.gum.backends.Assets",methodName:"loadImages"}),this.onReady();else{la.trace("loading "+
this.paths.images.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:169,className:"ob.gum.backends.Assets",methodName:"loadImages"});var e=this.paths.images,g=c,d=function(a,c){la.trace(c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:172,className:"ob.gum.backends.Assets",methodName:"loadImages"});la.trace("starting without images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:173,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()},f=function(a){b.imageCache=
a;la.trace("loaded "+b.imageCache.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:177,className:"ob.gum.backends.Assets",methodName:"loadImages"});la.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:178,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()};null==g&&(g=!1);var h=[],p=e.length;var q=0;for(a=e.length;q<a;){var n=[q++];var r=[e[n[0]]];c=g;var A=null==d?null:function(a){return function(b){d(a[0],b)}}(n);n=null==
f?null:function(a){return function(b){h[a[0]]=b;0==--p&&f(h)}}(n);null==c&&(c=!1);""!=cb.corsServer&&(new Z("^https?://","")).match(r[0])&&(r[0]="//"+cb.corsServer+"/"+r[0]);var k=Oa.loadFromFile(r[0]);c&&(la.trace('Start loading image "'+r[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),k.onProgress(function(a){return function(b,c){cb.onProgressDebug(b,c,a[0])}}(r)),k.onError(cb.onErrorDebug),k.onComplete(function(a){return function(b){cb.onCompleteDebug(a[0])}}(r)));
if(null!=A)k.onError(A);if(null!=n)k.onComplete(n)}}},__class__:ae};var Yd=function(){};d["peote.text.FontConfig"]=Yd;Yd.__name__=!0;Yd.prototype={__class__:Yd};var bd=function(a){this.uniformFloats=[];this.uniformFloatsVertex=this.uniformFloatsFragment=null;this.hasFragmentInjection=this.ready=!1;this.fragmentFloatPrecision=null;this.formulaHasChanged=!1;this.formula=new T;this.colorFormula="";this.used_by_ColorFormula=this.usedID_by_ColorFormula=0;this.textureID_Defaults=[];this.customTextureIdentifiers=
[];this.activeUnits=[];this.activeTextures=[];this.textureLayers=new Kb;this.textureListPicking=new ud(new xb);this.textureList=new ud(new xb);this.glShaderConfig={isPICKING:!1,isES3:!1,isINSTANCED:!1,isUBO:!1,IN:"attribute",VARIN:"varying",VAROUT:"varying",hasTEXTURES:!1,hasTEXTURE_FUNCTIONS:!1,hasFRAGMENT_INJECTION:!1,FRAGMENT_PROGRAM_UNIFORMS:"",FRAGMENT_CALC_LAYER:"",TEXTURES:[],TEXTURE_DEFAULTS:[],isDISCARD:!0,DISCARD:"0.0",isPIXELSNAPPING:!1,PIXELDIVISOR:"1.0",VERTEX_FLOAT_PRECISION:null,VERTEX_INT_PRECISION:null,
VERTEX_SAMPLER_PRECISION:null,FRAGMENT_FLOAT_PRECISION:null,FRAGMENT_INT_PRECISION:null,FRAGMENT_SAMPLER_PRECISION:null,VERTEX_INJECTION:"",FRAGMENT_INJECTION:"",SIZE_FORMULA:null,POS_FORMULA:null,ROTZ_FORMULA:null,PIVOT_FORMULA:null,FORMULA_VARYINGS:{},FORMULA_CONSTANTS:{},FRAGMENT_EXTENSIONS:[]};this.gl=this.glProgram=this.glProgramPicking=this.glVertexShader=this.glFragmentShader=this.glVertexShaderPicking=this.glFragmentShaderPicking=null;this.displays=[];this.autoUpdateTextures=this.isVisible=
!0;this.clearMask=!1;this.mask=0;this.colorEnabled=!0;this.buffer=a;this.alphaEnabled=a.hasAlpha();this.zIndexEnabled=a.hasZindex();this.colorIdentifiers=a.getColorIdentifiers();this.customIdentifiers=a.getCustomIdentifiers();this.customVaryings=a.getCustomVaryings();this.textureIdentifiers=a.getTextureIdentifiers();this.defaultColorFormula=a.getDefaultColorFormula();this.defaultFormulaVars=a.getDefaultFormulaVars();var b=a.getFormulas().h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var g=b[e++],
d=this.formula,f=a.getFormulas().h[g];d.h[g]=f}try{lc.resolveFormulaCyclic(a.getFormulas())}catch(m){throw ja.lastError=m,a=z.caught(m).unwrap(),z.thrown('Error: cyclic reference of "'+p.string(a.errVar)+'" inside @formula "'+p.string(a.formula)+'" for "'+p.string(a.errKey)+'"');}lc.resolveFormulaVars(a.getFormulas(),a.getAttributes());this.parseColorFormula()};d["peote.view.Program"]=bd;bd.__name__=!0;bd.prototype={addToDisplay:function(a,b,c){null==c&&(c=!1);if(0>this.displays.indexOf(a)){this.displays.push(a);
var e=a.gl;if(null!=e&&e!=this.gl){for(var g=0,d=this.displays;g<d.length;){var f=d[g];++g;if(null!=f.gl&&f.gl!=e)throw z.thrown("Error, program can not used inside different gl-contexts");}null!=this.gl&&(this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)));
this.gl=e;W.isES3&&(this.glShaderConfig.isES3=!0,this.glShaderConfig.IN="in",this.glShaderConfig.VARIN="in",this.glShaderConfig.VAROUT="out");W.isUBO&&(this.glShaderConfig.isUBO=!0);W.isINSTANCED&&(this.glShaderConfig.isINSTANCED=!0);this.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=this.gl.getExtension("OES_standard_derivatives")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=this.gl.getExtension("EXT_color_buffer_float")?this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):
null!=this.gl.getExtension("OES_texture_float")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});this.buffer.setNewGLContext(this.gl);this.createProg();this.buffer.hasPicking()&&this.createProg(!0);g=0;for(d=this.activeTextures;g<d.length;){var h=d[g];++g;e=this.gl;if(null!=e&&e!=h.gl){f=0;for(var p=h.programs;f<p.length;){var q=p[f];++f;if(null!=q.gl&&q.gl!=e)throw z.thrown("Error, texture can not used inside different gl-contexts");}p=0;for(q=h.displays;p<q.length;)if(f=
q[p],++p,null!=f.gl&&f.gl!=e)throw z.thrown("Error, texture can not used inside different gl-contexts");null!=h.gl&&(h.gl.deleteTexture(h.glTexture),h.glTexture=null,0==h.displays.length&&null!=h.framebuffer&&(h.gl.deleteFramebuffer(h.framebuffer),h.framebuffer=null,null!=h.glDepthBuffer&&h.gl.deleteRenderbuffer(h.glDepthBuffer),h.glDepthBuffer=null));h.gl=e;if(h.width>h.gl.getParameter(h.gl.MAX_TEXTURE_SIZE)||h.height>h.gl.getParameter(h.gl.MAX_TEXTURE_SIZE))throw z.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");
h.glTexture=qb.createEmptyTexture(h.gl,h.width,h.height,h.colorChannels,h.createMipmaps,h.magFilter,h.minFilter,h.useFloat);if(0<h.displays.length&&null==h.framebuffer){h.glDepthBuffer=h.gl.createRenderbuffer();e=h.gl;f=h.glTexture;p=h.glDepthBuffer;q=h.width;var n=h.height,r=e.createFramebuffer();e.bindRenderbuffer(e.RENDERBUFFER,p);Ha.clearGlErrorQueue(e);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT24,q,n);Ha.getLastGlError(e)==e.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",
{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,q,n));e.bindFramebuffer(e.FRAMEBUFFER,r);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,p);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,f,0);if(e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE)throw z.thrown("Error: Framebuffer not complete!");e.bindFramebuffer(e.FRAMEBUFFER,
null);e.bindRenderbuffer(e.RENDERBUFFER,null);h.framebuffer=r;h.updated=!0}for(e=h.images.keys();e.hasNext();)f=e.next(),h.bufferImage(f,h.images.h[f.__id__])}}}}a.programList.add(this,b,c)},createProg:function(a){null==a&&(a=!1);this.glShaderConfig.isPICKING=a;if(null!=this.fragmentFloatPrecision)this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=this.fragmentFloatPrecision;else if(this.buffer.needFragmentPrecision()&&23>Ea.FragmentFloat.medium){var b=Ea.FragmentFloat;this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=
0<b.high?"highp":0<b.medium?"mediump":0<b.low?"lowp":null}else b=Ea.FragmentFloat,this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.medium?"mediump":0<b.low?"lowp":null;this.parseAndResolveFormulas();var c=this.gl,e=this.gl.VERTEX_SHADER,g=this.buffer.getVertexShader(),d=this.glShaderConfig;g=new Ca(g);var f=Ha.rStartspaces,h=Ha.rEmptylines;d=g.execute(d).replace(h.r,"\n").replace(f.r,"");g=c.createShader(e);c.shaderSource(g,d);c.compileShader(g);if(0==c.getShaderParameter(g,c.COMPILE_STATUS))throw z.thrown("ERROR compiling "+
(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+p.string(c.getShaderInfoLog(g)));b=g;c=this.gl;e=this.gl.FRAGMENT_SHADER;g=this.buffer.getFragmentShader();d=this.glShaderConfig;g=new Ca(g);f=Ha.rStartspaces;h=Ha.rEmptylines;d=g.execute(d).replace(h.r,"\n").replace(f.r,"");g=c.createShader(e);c.shaderSource(g,d);c.compileShader(g);if(0==c.getShaderParameter(g,c.COMPILE_STATUS))throw z.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+p.string(c.getShaderInfoLog(g)));
e=g;d=this.gl.createProgram();this.gl.attachShader(d,b);this.gl.attachShader(d,e);this.buffer.bindAttribLocations(this.gl,d);c=this.gl;c.linkProgram(d);if(0==c.getProgramParameter(d,c.LINK_STATUS))throw z.thrown(p.string(c.getProgramInfoLog(d))+"VALIDATE_STATUS: "+p.string(c.getProgramParameter(d,c.VALIDATE_STATUS))+"ERROR: "+p.string(c.getError()));!a&&W.isUBO?(c=this.gl.getUniformBlockIndex(d,"uboView"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(d,c,0),c=this.gl.getUniformBlockIndex(d,
"uboDisplay"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(d,c,1)):a?(this.uRESOLUTION_PICK=this.gl.getUniformLocation(d,"uResolution"),this.uZOOM_PICK=this.gl.getUniformLocation(d,"uZoom"),this.uOFFSET_PICK=this.gl.getUniformLocation(d,"uOffset")):(this.uRESOLUTION=this.gl.getUniformLocation(d,"uResolution"),this.uZOOM=this.gl.getUniformLocation(d,"uZoom"),this.uOFFSET=this.gl.getUniformLocation(d,"uOffset"));if(a)for(this.uTIME_PICK=this.gl.getUniformLocation(d,"uTime"),this.uniformFloatPickLocations=
[],c=0,g=this.uniformFloats;c<g.length;)f=g[c],++c,this.uniformFloatPickLocations.push(this.gl.getUniformLocation(d,f.name));else for(this.uTIME=this.gl.getUniformLocation(d,"uTime"),this.uniformFloatLocations=[],c=0,g=this.uniformFloats;c<g.length;)f=g[c],++c,this.uniformFloatLocations.push(this.gl.getUniformLocation(d,f.name));if(a){this.textureListPicking.clear();c=0;for(g=this.activeTextures.length;c<g;)a=c++,this.textureListPicking.add(new vd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(d,
"uTexture"+a)),null,!1);this.glProgramPicking=d;this.glVertexShaderPicking=b;this.glFragmentShaderPicking=e}else{this.textureList.clear();c=0;for(g=this.activeTextures.length;c<g;)a=c++,this.textureList.add(new vd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(d,"uTexture"+a)),null,!1);this.glProgram=d;this.glVertexShader=b;this.glFragmentShader=e}this.ready=!0},parseColorFormula:function(){var a="";if(""!=this.colorFormula)a=this.colorFormula;else if(""!=this.defaultColorFormula)a=
this.defaultColorFormula;else{for(var b=this.colorIdentifiers.slice(),c=[],e=0,g=this.textureIdentifiers.length;e<g;){var d=e++;this.textureLayers.h.hasOwnProperty(d)&&c.push(this.textureIdentifiers[d])}e=0;for(g=this.customTextureIdentifiers.length;e<g;)d=e++,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+d)&&c.push(this.customTextureIdentifiers[d]);if(0==b.length+c.length){var f=-16776961;c=""+p.string((f>>24&255)/255);var h=""+p.string((f>>16&255)/255),q=""+p.string((f>>8&255)/
255);f=""+p.string((f&255)/255);a="vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+((-1!=q.indexOf(".")||-1!=q.indexOf("e-")?q:q+".0")+", "+(-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+")")}else{0<c.length&&(a=c.shift(),0<b.length&&(a=""+b.shift()+" * "+a));for(e=0;e<c.length;)h=c[e],++e,0<b.length&&(h=""+b.shift()+" * "+h+" "),a="mix( "+a+", "+h+", ("+h+").a )";for(;0<b.length;)a+=(""!=a?"*":"")+b.shift(),0<b.length&&(a=
"("+a+" + "+b.shift()+")")}}e=0;for(g=this.colorIdentifiers.length;e<g;)d=e++,b=new Z("(^|.*?[^\\w.])"+this.colorIdentifiers[d]+"\\b.*?","g"),b.match(a)&&(a=a.replace(b.r,"$1c"+d));e=0;for(g=this.customIdentifiers.length;e<g;)if(d=e++,b=new Z("(^|.*?[^\\w.])"+this.customIdentifiers[d]+"\\b.*?","g"),b.match(a))if(null!=this.customVaryings[d])a=a.replace(b.r,"$1"+this.customVaryings[d]);else throw z.thrown("Error while parsing ColorFormula: custom identifier "+this.customIdentifiers[d]+" need @varying to access in fragmentshader");
this.textureID_Defaults=[];e=this.usedID_by_ColorFormula=this.used_by_ColorFormula=0;for(g=this.textureIdentifiers.length;e<g;)d=e++,b=new Z("(^|.*?[^\\w.])"+this.textureIdentifiers[d]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(d)&&(a=a.replace(b.r,"$1t"+d)),this.used_by_ColorFormula|=1<<d),b=new Z("(^|.*?[^\\w.])"+(this.textureIdentifiers[d]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+d),this.usedID_by_ColorFormula|=1<<d,this.textureLayers.h.hasOwnProperty(d)||(f=this.defaultFormulaVars.h[this.textureIdentifiers[d]],
c=""+p.string((f>>24&255)/255),h=""+p.string((f>>16&255)/255),q=""+p.string((f>>8&255)/255),f=""+p.string((f&255)/255),this.textureID_Defaults.push({layer:d,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+((-1!=q.indexOf(".")||-1!=q.indexOf("e-")?q:q+".0")+", "+(-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+")")})));e=0;for(g=this.customTextureIdentifiers.length;e<g;)d=e++,b=new Z("(^|.*?[^\\w.])"+this.customTextureIdentifiers[d]+
"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+d)&&(a=a.replace(b.r,"$1t"+(this.textureIdentifiers.length+d))),this.used_by_ColorFormula|=1<<this.textureIdentifiers.length+d),b=new Z("(^|.*?[^\\w.])"+(this.customTextureIdentifiers[d]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+(this.textureIdentifiers.length+d)),this.usedID_by_ColorFormula|=1<<this.textureIdentifiers.length+d,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+
d)||(f=this.defaultFormulaVars.h[this.textureIdentifiers[this.textureIdentifiers.length+d]],c=""+p.string((f>>24&255)/255),h=""+p.string((f>>16&255)/255),q=""+p.string((f>>8&255)/255),f=""+p.string((f&255)/255),this.textureID_Defaults.push({layer:this.textureIdentifiers.length+d,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+((-1!=q.indexOf(".")||-1!=q.indexOf("e-")?q:q+".0")+", "+(-1!=f.indexOf(".")||-1!=f.indexOf("e-")?
f:f+".0")+")")})));e=Object.keys(this.defaultFormulaVars.h);g=e.length;for(d=0;d<g;)c=e[d++],b=new Z("(^|.*?[^\\w.])"+c+"\\b.*?","g"),b.match(a)&&(f=this.defaultFormulaVars.h[c],c=""+p.string((f>>24&255)/255),h=""+p.string((f>>16&255)/255),q=""+p.string((f>>8&255)/255),f=""+p.string((f&255)/255),a=a.replace(b.r,"$1vec4("+((-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0")+", "+((-1!=q.indexOf(".")||-1!=q.indexOf("e-")?q:q+".0")+", "+(-1!=f.indexOf(".")||
-1!=f.indexOf("e-")?f:f+".0")+")"))));this.glShaderConfig.FRAGMENT_CALC_LAYER=a},setColorFormula:function(a,b,c){null==a&&(a="");this.colorFormula=a;if(null!=b){a=Object.keys(b.h);for(var e=a.length,g=0;g<e;){var d=a[g++];if(!(new Z("^([a-zA-z_]+\\d*)+$","g")).match(d))throw z.thrown('Error: "'+d+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');this.defaultFormulaVars.h[d]=b.h[d]}}null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},
injectIntoFragmentShader:function(a,b,c,e){null==b&&(b=!1);null==a&&(a="");this.hasFragmentInjection=""==a?!1:!0;this.uniformFloatsFragment=c;b=(b?"uniform float uTime;":"")+this.generateUniformFloatsGLSL(c);this.glShaderConfig.FRAGMENT_INJECTION=b+a;this.accumulateUniformsFloat();null!=e?e&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},generateUniformFloatsGLSL:function(a){var b="";if(null!=a)for(var c=0;c<a.length;){var e=a[c];++c;b+="uniform float "+e.name+";"}return b},
accumulateUniformsFloat:function(){if(null==this.uniformFloatsVertex)null!=this.uniformFloatsFragment&&(this.uniformFloats=this.uniformFloatsFragment);else if(null==this.uniformFloatsFragment)this.uniformFloats=this.uniformFloatsVertex;else{this.uniformFloats=this.uniformFloatsVertex;for(var a=0,b=this.uniformFloatsFragment;a<b.length;){var c=b[a];++a;0>this.uniformFloats.indexOf(c)&&this.uniformFloats.push(c)}}},parseAndResolveFormulas:function(){var a=this;if(this.formulaHasChanged){for(var b=new T,
c=Object.keys(this.formula.h),e=c.length,g=0;g<e;){var d=c[g++];b.h[d]=this.formula.h[d]}var f=b;try{lc.resolveFormulaCyclic(f)}catch(m){throw ja.lastError=m,b=z.caught(m).unwrap(),z.thrown('Error: cyclic reference of "'+p.string(b.errVar)+'" inside formula "'+p.string(b.formula)+'" for "'+p.string(b.errKey)+'"');}lc.resolveFormulaVars(f,this.buffer.getAttributes());b=function(b,c,e,g){var d=a.buffer.getFormulaNames().h[b];null==d&&(d="");var h=a.buffer.getFormulaNames().h[c];null==h&&(h="");var l=
f.h[d],m=f.h[h];return l!=a.buffer.getFormulas().h[d]||m!=a.buffer.getFormulas().h[h]?(null==l&&(l=a.buffer.getAttributes().h[d]),null==l&&(l=e),null==m&&(m=a.buffer.getAttributes().h[h]),null==m&&(m=g),"rotation"==b&&"0.0"!=l&&(l="("+l+")/180.0*"+Math.PI),"zIndex"==c&&"0.0"!=m&&(b=""+p.string(a.buffer.getMaxZindex()),m="clamp( "+m+"/"+(-1!=b.indexOf(".")||-1!=b.indexOf("e-")?b:b+".0")+", -1.0, 1.0)"),"vec2("+l+", "+m+")"):null};this.glShaderConfig.SIZE_FORMULA=b("sizeX","sizeY","100.0","100.0");
this.glShaderConfig.POS_FORMULA=b("posX","posY","0.0","0.0");this.glShaderConfig.ROTZ_FORMULA=b("rotation","zIndex","0.0","0.0");this.glShaderConfig.PIVOT_FORMULA=b("pivotX","pivotY","0.0","0.0");b=0;for(c=this.buffer.getFormulaVaryings();b<c.length;)e=c[b],++b,g=f.h[e],g!=this.buffer.getFormulas().h[e]?(null==g&&(g=this.buffer.getAttributes().h[e]),this.glShaderConfig.FORMULA_VARYINGS[e]=g,la.trace(" -- replacing Formula "+e+" => "+g,{fileName:"peote/view/Program.hx",lineNumber:591,className:"peote.view.Program",
methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_VARYINGS[e]=null;b=0;for(c=this.buffer.getFormulaConstants();b<c.length;)e=c[b],++b,g=f.h[e],null!=g&&g!=this.buffer.getAttributes().h[e]?(this.glShaderConfig.FORMULA_CONSTANTS[e]=g,la.trace(" -- replacing Formula "+e+" => "+g,{fileName:"peote/view/Program.hx",lineNumber:601,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_CONSTANTS[e]=null}},getTextureIndexByIdentifier:function(a,
b){null==b&&(b=!0);var c=this.textureIdentifiers.indexOf(a);if(0>c&&(c=this.customTextureIdentifiers.indexOf(a),0>c&&b)){if(!(new Z("^([a-zA-z_]+\\d*)+$","g")).match(a))throw z.thrown('Error: "'+a+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');c=this.textureIdentifiers.length+this.customTextureIdentifiers.length;this.customTextureIdentifiers.push(a)}return c},validatePrecision:function(a){if(null!=a)if(0>["low","medium","high"].indexOf(a.toLowerCase())){if(0>
["lowp","mediump","highp"].indexOf(a.toLowerCase()))throw z.thrown("Error, no valid precision format. Use 'low', 'medium' or 'high' (or leave it null for default)");}else a+="p";return a},setFragmentFloatPrecision:function(a,b){a=this.validatePrecision(a);var c=Ea.FragmentFloat;this.fragmentFloatPrecision=null==a?null:0<c.high&&"highp"==a?"highp":0<c.medium&&("highp"==a||"mediump"==a)?"mediump":0<c.low?"lowp":null;null!=b?b&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},discardAtAlpha:function(a,
b){null==a?this.glShaderConfig.isDISCARD=!1:(this.glShaderConfig.isDISCARD=!0,a=""+p.string(a),this.glShaderConfig.DISCARD=-1!=a.indexOf(".")||-1!=a.indexOf("e-")?a:a+".0");null!=b?b&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},addTexture:function(a,b,c){b=this.getTextureIndexByIdentifier(b);if(null==a)throw z.thrown("Error, texture is null.");var e=this.textureLayers.h[b];if(null!=e){if(0<=e.indexOf(a))throw z.thrown("Error, textureLayer already contains this texture.");
e.push(a);this.textureLayers.h[b]=e}else this.textureLayers.h[b]=[a];null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},updateTextures:function(){for(var a=[],b=this.textureLayers.keys();b.hasNext();)for(var c=b.next(),e=0,g=this.textureLayers.h[c];e<g.length;)c=g[e],++e,0>a.indexOf(c)&&a.push(c);for(var d=this.activeTextures.length;0<d--;)if(0>a.indexOf(this.activeTextures[d])){if(!K.remove(this.activeTextures[d].programs,this))throw z.thrown("Error, this texture is not used by program anymore");
this.activeTextures.splice(d,1);this.activeUnits.splice(d,1)}for(e=0;e<a.length;)if(c=a[e],++e,0>this.activeTextures.indexOf(c)){this.activeTextures.push(c);for(g=0;0<=this.activeUnits.indexOf(g);)++g;this.activeUnits.push(g);if(0<=c.programs.indexOf(this))throw z.thrown("Error, texture is already used by program");b=this.gl;if(null!=b&&b!=c.gl){g=0;for(d=c.programs;g<d.length;){var f=d[g];++g;if(null!=f.gl&&f.gl!=b)throw z.thrown("Error, texture can not used inside different gl-contexts");}g=0;for(d=
c.displays;g<d.length;)if(f=d[g],++g,null!=f.gl&&f.gl!=b)throw z.thrown("Error, texture can not used inside different gl-contexts");null!=c.gl&&(c.gl.deleteTexture(c.glTexture),c.glTexture=null,0==c.displays.length&&null!=c.framebuffer&&(c.gl.deleteFramebuffer(c.framebuffer),c.framebuffer=null,null!=c.glDepthBuffer&&c.gl.deleteRenderbuffer(c.glDepthBuffer),c.glDepthBuffer=null));c.gl=b;if(c.width>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE)||c.height>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE))throw z.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");
c.glTexture=qb.createEmptyTexture(c.gl,c.width,c.height,c.colorChannels,c.createMipmaps,c.magFilter,c.minFilter,c.useFloat);if(0<c.displays.length&&null==c.framebuffer){c.glDepthBuffer=c.gl.createRenderbuffer();g=c.gl;b=c.glTexture;d=c.glDepthBuffer;f=c.width;var h=c.height,q=g.createFramebuffer();g.bindRenderbuffer(g.RENDERBUFFER,d);Ha.clearGlErrorQueue(g);g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_COMPONENT24,f,h);Ha.getLastGlError(g)==g.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",
{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_COMPONENT16,f,h));g.bindFramebuffer(g.FRAMEBUFFER,q);g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,d);g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,b,0);if(g.checkFramebufferStatus(g.FRAMEBUFFER)!=g.FRAMEBUFFER_COMPLETE)throw z.thrown("Error: Framebuffer not complete!");g.bindFramebuffer(g.FRAMEBUFFER,
null);g.bindRenderbuffer(g.RENDERBUFFER,null);c.framebuffer=q;c.updated=!0}for(g=c.images.keys();g.hasNext();)b=g.next(),c.bufferImage(b,c.images.h[b.__id__])}c.programs.push(this)}this.parseColorFormula();this.glShaderConfig.hasFRAGMENT_INJECTION=this.hasFragmentInjection;this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS="";this.glShaderConfig.TEXTURES=[];if(0==this.activeTextures.length)this.glShaderConfig.hasTEXTURES=!1;else{this.glShaderConfig.hasTEXTURES=!0;e=0;for(g=this.activeTextures.length;e<
g;)d=e++,this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS+="uniform sampler2D uTexture"+d+";";for(b=this.textureLayers.keys();b.hasNext();){c=b.next();a=[];f=this.textureLayers.h[c];e=0;for(g=f.length;e<g;){d=e++;h=""+p.string(f[d].slotWidth/f[d].width);q=""+p.string(f[d].slotHeight/f[d].height);var n=""+p.string(f[d].slotsX*f[d].slotWidth/f[d].width),A=""+p.string(f[d].slotsY*f[d].slotHeight/f[d].height);a.push({UNIT_VALUE:d+1+".0",TEXTURE:"uTexture"+this.activeTextures.indexOf(f[d]),SLOTS_X:f[d].slotsX+
".0",SLOTS_Y:f[d].slotsY+".0",SLOT_WIDTH:-1!=h.indexOf(".")||-1!=h.indexOf("e-")?h:h+".0",SLOT_HEIGHT:-1!=q.indexOf(".")||-1!=q.indexOf("e-")?q:q+".0",SLOTS_WIDTH:-1!=n.indexOf(".")||-1!=n.indexOf("e-")?n:n+".0",SLOTS_HEIGHT:-1!=A.indexOf(".")||-1!=A.indexOf("e-")?A:A+".0",TILES_X:f[d].tilesX+".0",TILES_Y:f[d].tilesY+".0",TEXTURE_WIDTH:f[d].width+".0",TEXTURE_HEIGHT:f[d].height+".0",FIRST:0==d,LAST:d==f.length-1})}this.glShaderConfig.TEXTURES.push({LAYER:c,UNITS:a,USED:0<(this.used_by_ColorFormula&
1<<c),USED_ID:0<(this.usedID_by_ColorFormula&1<<c)})}}this.glShaderConfig.TEXTURE_DEFAULTS=[];e=0;for(g=this.textureID_Defaults;e<g.length;)a=g[e],++e,this.glShaderConfig.TEXTURE_DEFAULTS.push({LAYER:a.layer,DEFAULT_VALUE:a.value});this.glShaderConfig.hasTEXTURE_FUNCTIONS=0==this.usedID_by_ColorFormula&&0==this.textureID_Defaults.length?!1:!0;null!=this.gl&&(this.ready=!1,this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&
(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)),this.createProg(),this.buffer.hasPicking()&&this.createProg(!0))},__class__:bd};var Ee=function(a,b,c,e){null==e&&(e=16384);null==c&&(c=!0);this.rHexToDec=new Z('("\\s*)?(0x[0-9a-f]+)(\\s*")?',"gi");this.rComments=new Z("//.*?$","gm");this.rParsePathConfig=new Z("^(.*?)([^/]+)$","");this.kerning=!1;if(this.rParsePathConfig.match(a))this.path=this.rParsePathConfig.matched(1),
this.jsonFilename=this.rParsePathConfig.matched(2);else throw z.thrown("Can't load font, error in path to jsonfile: \""+a+'"');this.ranges=b;this.kerning=c;this.maxTextureSize=e};d["peote.text.Font__ob_gum_backends_PeoteView_FontStyle"]=Ee;Ee.__name__=!0;Ee.prototype={load:function(a,b,c){null==c&&(c=!1);var e=this,g=c,d=function(g){g=g.replace(e.rComments.r,"");g=e.rHexToDec.map(g,function(a){return p.string(p.parseInt(a.matched(2)))});var d=new Da;e.config=d.fromJson(g,e.path+e.jsonFilename);g=
0;for(d=d.errors;g<d.length;){var f=d[g];++g;switch(f._hx_index){case 0:var h=f.variable;var l=f.expected;h=f.pos;break;case 1:h=f.pos;break;case 2:h=f.pos;break;case 3:h=f.pos;break;case 4:h=f.pos;break;case 5:h=f.pos;break;case 6:h=f.pos}la.trace(h.lines[0].number,{fileName:"peote/text/Font.hx",lineNumber:246,className:"peote.text.Font__ob_gum_backends_PeoteView_FontStyle",methodName:"load"});null!=h&&la.trace(Ie.convertError(f),{fileName:h.file,lineNumber:h.lines[0].number,className:"",methodName:""})}if(e.config.packed)throw g=
'Error, metadata of FontStyle class has to be "@packed" for "'+e.path+e.jsonFilename+'" and "packed":true',la.trace(g,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),z.thrown(g);e.kerning&&null!=e.config.kerning&&(e.kerning=e.config.kerning);if(null==e.ranges&&1<e.config.ranges.length)throw g='Error, set FontStyle to @multiSlot and/or @multiTexture or define a single range while Font creation or inside "'+e.path+e.jsonFilename+'"',la.trace(g,{fileName:e.path+e.jsonFilename,
lineNumber:0,className:"",methodName:""}),z.thrown(g);f=[];g=0;for(d=e.config.ranges;g<d.length;){var m=d[g];++g;var q=m.range.min,n=m.range.max;if(null!=e.ranges)for(h=0,l=e.ranges;h<l.length;){var x=l[h];++h;if(x.min>=q&&x.min<=n||x.max>=q&&x.max<=n){f.push(m);break}}else f.push(m);if(1==f.length)break}if(0==f.length)throw g='Error, can not found any ranges inside font-config "'+e.path+e.jsonFilename+'" that fit '+p.string(e.ranges),la.trace(g,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",
methodName:""}),z.thrown(g);e.config.ranges=f;e.init(a,b,c)};null==g&&(g=!1);var f=this.path+this.jsonFilename,h=null==d?null:d,q=null==d?null:function(a){d(a.toString())};null==g&&(g=!1);""!=cb.corsServer&&(new Z("^https?://","")).match(f)&&(f="//"+cb.corsServer+"/"+f);var n=oc.loadFromFile(f);g&&(la.trace('Start loading bytes "'+f+'"',{fileName:"utils/Loader.hx",lineNumber:81,className:"utils.Loader",methodName:"bytes"}),n.onProgress(function(a,b){cb.onProgressDebug(a,b,f)}),n.onError(cb.onErrorDebug),
n.onComplete(function(a){cb.onCompleteDebug(f)}));if(null!=h)n.onError(h);if(null!=q)n.onComplete(q)},init:function(a,b,c){for(var e=0,g=0,d=0,f=this.config.ranges;d<f.length;){var h=f[d];++d;h.slot.width>e&&(e=h.slot.width);h.slot.height>g&&(g=h.slot.height)}this.textureCache=new Xc(e,g,this.config.ranges.length,4,!1,1,1,null,this.maxTextureSize);this.loadImages(null,a,b,c)},loadImages:function(a,b,c,e){var g=this,d=this.config.ranges;a=Array(d.length);for(var f=0,h=d.length;f<h;){var p=f++;a[p]=
g.path+d[p].image}d=e;var q=function(a,b,e){null!=c&&c(b,e)},n=function(a,b){if(null!=g.config.ranges[a].tiles){var c=g.config.ranges[a].tiles.x;var e=g.config.ranges[a].tiles.y}else if(null!=g.config.tiles)c=g.config.tiles.x,e=g.config.tiles.y;else throw b='Error, can not found tiles inside font-config "'+g.path+g.jsonFilename+'"',la.trace(b,{fileName:g.path+g.jsonFilename,lineNumber:0,className:"",methodName:""}),z.thrown(b);if(null!=g.config.ranges[a].line){var d=g.config.ranges[a].line.height/
b.height*e;var f=g.config.ranges[a].line.base/b.height*e}else null!=g.config.line?(d=g.config.line.height/b.height*e,f=g.config.line.base/b.height*e):f=d=1;a=g.config.ranges[a].range;g.textureCache.setImage(b,0,c,e);g.rangeMapping={min:a.min,max:a.max,height:d,base:f}},r=function(a){b(g)};null==d&&(d=!1);var A=a.length;f=0;for(h=a.length;f<h;){p=[f++];var k=[a[p[0]]];e=d;var w=null==q?null:function(a){return function(b,c){null!=q&&q(a[0],b,c)}}(p);p=null==r?null:function(a){return function(c){null!=
n&&n(a[0],c);0==--A&&b(g)}}(p);null==e&&(e=!1);""!=cb.corsServer&&(new Z("^https?://","")).match(k[0])&&(k[0]="//"+cb.corsServer+"/"+k[0]);var y=Oa.loadFromFile(k[0]);e&&(la.trace('Start loading image "'+k[0]+'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),y.onProgress(function(a){return function(b,c){cb.onProgressDebug(b,c,a[0])}}(k)),y.onError(cb.onErrorDebug),y.onComplete(function(a){return function(b){cb.onCompleteDebug(a[0])}}(k)));if(null!=w)y.onProgress(w);
if(null!=p)y.onComplete(p)}},__class__:Ee};var Ve=function(){};d["peote.text.Gl3FontData"]=Ve;Ve.__name__=!0;var Zd=function(a,b){this.min=a;this.max=b};d["peote.text.Range"]=Zd;Zd.__name__=!0;Zd.prototype={__class__:Zd};var Lc=function(){};d["peote.view.BufferInterface"]=Lc;Lc.__name__=!0;Lc.__isInterface__=!0;Lc.prototype={__class__:Lc};var wd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=
a)throw z.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);W.isINSTANCED?(null==oa.instanceBytes&&(oa.instanceBytes=new Ab(new ArrayBuffer(12)),oa.instanceBytes.b[0]=1,oa.instanceBytes.b[1]=1,oa.instanceBytes.b[2]=1,oa.instanceBytes.b[3]=1,oa.instanceBytes.b[4]=0,oa.instanceBytes.b[5]=1,oa.instanceBytes.b[6]=1,oa.instanceBytes.b[7]=0,oa.instanceBytes.b[8]=0,oa.instanceBytes.b[9]=
0,oa.instanceBytes.b[10]=0,oa.instanceBytes.b[11]=0),this._elemBuffSize=40):this._elemBuffSize=264;this._bytes=new Ab(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_Rectangle"]=wd;wd.__name__=!0;wd.__interfaces__=[Lc];wd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),W.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),W.isVAO&&this._gl.deleteVertexArray(this._glVAO));
this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);W.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=oa.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),
a.bindBuffer(a.ARRAY_BUFFER,null));W.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,0),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,
40,4),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,16),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,40,24),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,32),a.vertexAttribDivisor(6,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(5),
a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,44,0),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,44,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,44,8),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,44,16),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,44,24),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,44,32),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,44,40)),this._gl.bindVertexArray(null))}},
update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(W.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.color;e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI;e.b_UFloat32[c.bytePos+8>>2]=c.x;e.b_UFloat32[c.bytePos+12>>2]=c.y;e.b_UFloat32[c.bytePos+16>>2]=c.w;e.b_UFloat32[c.bytePos+20>>2]=c.h;e.b_UFloat32[c.bytePos+24>>2]=c.px_offset;e.b_UFloat32[c.bytePos+28>>2]=c.py_offset;e.b_UFloat32[c.bytePos+32>>2]=c.sides;e.b_UFloat32[c.bytePos+36>>2]=c.shape}else c=
this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.color,e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+8>>2]=c.x,e.b_UFloat32[c.bytePos+12>>2]=c.y,e.b_UFloat32[c.bytePos+16>>2]=c.w,e.b_UFloat32[c.bytePos+20>>2]=c.h,e.b_UFloat32[c.bytePos+24>>2]=c.px_offset,e.b_UFloat32[c.bytePos+28>>2]=c.py_offset,e.b_UFloat32[c.bytePos+32>>2]=c.sides,e.b_UFloat32[c.bytePos+36>>2]=c.shape,e.b[c.bytePos+40]=1,e.b[c.bytePos+41]=1,e.b_Int32[c.bytePos+44>>2]=c.color,e.b_UFloat32[c.bytePos+
48>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+52>>2]=c.x,e.b_UFloat32[c.bytePos+56>>2]=c.y,e.b_UFloat32[c.bytePos+60>>2]=c.w,e.b_UFloat32[c.bytePos+64>>2]=c.h,e.b_UFloat32[c.bytePos+68>>2]=c.px_offset,e.b_UFloat32[c.bytePos+72>>2]=c.py_offset,e.b_UFloat32[c.bytePos+76>>2]=c.sides,e.b_UFloat32[c.bytePos+80>>2]=c.shape,e.b[c.bytePos+84]=1,e.b[c.bytePos+85]=1,e.b_Int32[c.bytePos+88>>2]=c.color,e.b_UFloat32[c.bytePos+92>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+96>>2]=c.x,e.b_UFloat32[c.bytePos+
100>>2]=c.y,e.b_UFloat32[c.bytePos+104>>2]=c.w,e.b_UFloat32[c.bytePos+108>>2]=c.h,e.b_UFloat32[c.bytePos+112>>2]=c.px_offset,e.b_UFloat32[c.bytePos+116>>2]=c.py_offset,e.b_UFloat32[c.bytePos+120>>2]=c.sides,e.b_UFloat32[c.bytePos+124>>2]=c.shape,e.b[c.bytePos+128]=0,e.b[c.bytePos+129]=1,e.b_Int32[c.bytePos+132>>2]=c.color,e.b_UFloat32[c.bytePos+136>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+140>>2]=c.x,e.b_UFloat32[c.bytePos+144>>2]=c.y,e.b_UFloat32[c.bytePos+148>>2]=c.w,e.b_UFloat32[c.bytePos+
152>>2]=c.h,e.b_UFloat32[c.bytePos+156>>2]=c.px_offset,e.b_UFloat32[c.bytePos+160>>2]=c.py_offset,e.b_UFloat32[c.bytePos+164>>2]=c.sides,e.b_UFloat32[c.bytePos+168>>2]=c.shape,e.b[c.bytePos+172]=1,e.b[c.bytePos+173]=0,e.b_Int32[c.bytePos+176>>2]=c.color,e.b_UFloat32[c.bytePos+180>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+184>>2]=c.x,e.b_UFloat32[c.bytePos+188>>2]=c.y,e.b_UFloat32[c.bytePos+192>>2]=c.w,e.b_UFloat32[c.bytePos+196>>2]=c.h,e.b_UFloat32[c.bytePos+200>>2]=c.px_offset,e.b_UFloat32[c.bytePos+
204>>2]=c.py_offset,e.b_UFloat32[c.bytePos+208>>2]=c.sides,e.b_UFloat32[c.bytePos+212>>2]=c.shape,e.b[c.bytePos+216]=0,e.b[c.bytePos+217]=0,e.b_Int32[c.bytePos+220>>2]=c.color,e.b_UFloat32[c.bytePos+224>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+228>>2]=c.x,e.b_UFloat32[c.bytePos+232>>2]=c.y,e.b_UFloat32[c.bytePos+236>>2]=c.w,e.b_UFloat32[c.bytePos+240>>2]=c.h,e.b_UFloat32[c.bytePos+244>>2]=c.px_offset,e.b_UFloat32[c.bytePos+248>>2]=c.py_offset,e.b_UFloat32[c.bytePos+252>>2]=c.sides,e.b_UFloat32[c.bytePos+
256>>2]=c.shape,e.b[c.bytePos+260]=0,e.b[c.bytePos+261]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},updateElement:function(a){if(W.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.color;b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI;b.b_UFloat32[a.bytePos+8>>2]=a.x;b.b_UFloat32[a.bytePos+12>>2]=a.y;b.b_UFloat32[a.bytePos+
16>>2]=a.w;b.b_UFloat32[a.bytePos+20>>2]=a.h;b.b_UFloat32[a.bytePos+24>>2]=a.px_offset;b.b_UFloat32[a.bytePos+28>>2]=a.py_offset;b.b_UFloat32[a.bytePos+32>>2]=a.sides;b.b_UFloat32[a.bytePos+36>>2]=a.shape}else b=this._bytes,b.b_Int32[a.bytePos>>2]=a.color,b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+8>>2]=a.x,b.b_UFloat32[a.bytePos+12>>2]=a.y,b.b_UFloat32[a.bytePos+16>>2]=a.w,b.b_UFloat32[a.bytePos+20>>2]=a.h,b.b_UFloat32[a.bytePos+24>>2]=a.px_offset,b.b_UFloat32[a.bytePos+
28>>2]=a.py_offset,b.b_UFloat32[a.bytePos+32>>2]=a.sides,b.b_UFloat32[a.bytePos+36>>2]=a.shape,b.b[a.bytePos+40]=1,b.b[a.bytePos+41]=1,b.b_Int32[a.bytePos+44>>2]=a.color,b.b_UFloat32[a.bytePos+48>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+52>>2]=a.x,b.b_UFloat32[a.bytePos+56>>2]=a.y,b.b_UFloat32[a.bytePos+60>>2]=a.w,b.b_UFloat32[a.bytePos+64>>2]=a.h,b.b_UFloat32[a.bytePos+68>>2]=a.px_offset,b.b_UFloat32[a.bytePos+72>>2]=a.py_offset,b.b_UFloat32[a.bytePos+76>>2]=a.sides,b.b_UFloat32[a.bytePos+
80>>2]=a.shape,b.b[a.bytePos+84]=1,b.b[a.bytePos+85]=1,b.b_Int32[a.bytePos+88>>2]=a.color,b.b_UFloat32[a.bytePos+92>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+96>>2]=a.x,b.b_UFloat32[a.bytePos+100>>2]=a.y,b.b_UFloat32[a.bytePos+104>>2]=a.w,b.b_UFloat32[a.bytePos+108>>2]=a.h,b.b_UFloat32[a.bytePos+112>>2]=a.px_offset,b.b_UFloat32[a.bytePos+116>>2]=a.py_offset,b.b_UFloat32[a.bytePos+120>>2]=a.sides,b.b_UFloat32[a.bytePos+124>>2]=a.shape,b.b[a.bytePos+128]=0,b.b[a.bytePos+129]=1,b.b_Int32[a.bytePos+
132>>2]=a.color,b.b_UFloat32[a.bytePos+136>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+140>>2]=a.x,b.b_UFloat32[a.bytePos+144>>2]=a.y,b.b_UFloat32[a.bytePos+148>>2]=a.w,b.b_UFloat32[a.bytePos+152>>2]=a.h,b.b_UFloat32[a.bytePos+156>>2]=a.px_offset,b.b_UFloat32[a.bytePos+160>>2]=a.py_offset,b.b_UFloat32[a.bytePos+164>>2]=a.sides,b.b_UFloat32[a.bytePos+168>>2]=a.shape,b.b[a.bytePos+172]=1,b.b[a.bytePos+173]=0,b.b_Int32[a.bytePos+176>>2]=a.color,b.b_UFloat32[a.bytePos+180>>2]=a.rotation/180*Math.PI,
b.b_UFloat32[a.bytePos+184>>2]=a.x,b.b_UFloat32[a.bytePos+188>>2]=a.y,b.b_UFloat32[a.bytePos+192>>2]=a.w,b.b_UFloat32[a.bytePos+196>>2]=a.h,b.b_UFloat32[a.bytePos+200>>2]=a.px_offset,b.b_UFloat32[a.bytePos+204>>2]=a.py_offset,b.b_UFloat32[a.bytePos+208>>2]=a.sides,b.b_UFloat32[a.bytePos+212>>2]=a.shape,b.b[a.bytePos+216]=0,b.b[a.bytePos+217]=0,b.b_Int32[a.bytePos+220>>2]=a.color,b.b_UFloat32[a.bytePos+224>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+228>>2]=a.x,b.b_UFloat32[a.bytePos+232>>2]=
a.y,b.b_UFloat32[a.bytePos+236>>2]=a.w,b.b_UFloat32[a.bytePos+240>>2]=a.h,b.b_UFloat32[a.bytePos+244>>2]=a.px_offset,b.b_UFloat32[a.bytePos+248>>2]=a.py_offset,b.b_UFloat32[a.bytePos+252>>2]=a.sides,b.b_UFloat32[a.bytePos+256>>2]=a.shape,b.b[a.bytePos+260]=0,b.b[a.bytePos+261]=0;if(-1==a.bytePos)throw z.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,
null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw z.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=new Ab(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var d=c++,f=this._elements[d];e=this._bytes;var h=f.bytePos,
p=this._elemBuffSize;null==p&&(p=0);null==h&&(h=0);e=0<p?new Uint8Array(e.b.bufferValue,h,p):new Uint8Array(e.b.bufferValue,h);f.bufferPointer=e;b[d]=f}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),W.isVAO&&(this._gl.bindVertexArray(this._glVAO),
W.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.vertexAttribDivisor(1,
1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,16),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,40,24),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,32),b.vertexAttribDivisor(6,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,44,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,
!1,44,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,44,8),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,44,16),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,44,24),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,44,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,44,40)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;h=a.bytePos;p=this._elemBuffSize;
null==p&&(p=0);null==h&&(h=0);e=0<p?new Uint8Array(e.b.bufferValue,h,p):new Uint8Array(e.b.bufferValue,h);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw z.thrown("Error: Element is already inside a Buffer");},removeElement:function(a){if(-1!=a.bytePos){if(1<this._maxElements&&a.bytePos<(this._maxElements-1)*this._elemBuffSize){var b=this._elements[--this._maxElements];b.bytePos=a.bytePos;var c=this._bytes,e=a.bytePos,g=this._elemBuffSize;null==g&&(g=0);null==
e&&(e=0);c=0<g?new Uint8Array(c.b.bufferValue,e,g):new Uint8Array(c.b.bufferValue,e);b.bufferPointer=c;this.updateElement(b);this._elements[a.bytePos/this._elemBuffSize|0]=b}else this._maxElements--;a.bytePos=-1;if(0<this._shrinkAtSize&&this._elements.length-this._growSize>=this._minSize&&this._maxElements<=this._elements.length-this._shrinkAtSize){a=this._elements.length-this._growSize;c=new Ab(new ArrayBuffer(this._elemBuffSize*a));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=
c;b=c=Array(a);for(var d=0,f=this._maxElements;d<f;){var h=d++;a=this._elements[h];c=this._bytes;e=a.bytePos;g=this._elemBuffSize;null==g&&(g=0);null==e&&(e=0);c=0<g?new Uint8Array(c.b.bufferValue,e,g):new Uint8Array(c.b.bufferValue,e);a.bufferPointer=c;b[h]=a}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),c=this._bytes,c=new Uint8Array(c.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,
c,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),W.isVAO&&(this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(a=this._gl,c=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,c),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,0),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,40,
4),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,16),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,40,24),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,32),a.vertexAttribDivisor(6,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(5),
a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,44,0),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,44,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,44,8),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,44,16),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,44,24),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,44,32),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,44,40)),this._gl.bindVertexArray(null)))}}else throw z.thrown("Error: Element is not inside a Buffer");
},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t::IN:: vec2 aPivot;\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t::IN:: vec2 aFloat0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t::if isES3::flat ::end::::VAROUT:: vec2 vSize; ::if isES3::flat ::end:: ::VAROUT:: vec2 vPack0;\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;vSize = size;\n\t\tvec2 pivot = ::if PIVOT_FORMULA::::PIVOT_FORMULA::::else::aPivot::end::;\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( aRotZ, 0.0 )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + (aPosition * size - pivot) * mat2( vec2(cos(rotZ.x), -sin(rotZ.x)), vec2(sin(rotZ.x), cos(rotZ.x)) );\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\tvPack0.x = ::if FORMULA_VARYINGS.sides::::FORMULA_VARYINGS.sides::::else::aFloat0.x::end::;vPack0.y = ::if FORMULA_VARYINGS.shape::::FORMULA_VARYINGS.shape::::else::aFloat0.y::end::;\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t::if isES3::flat ::end::::VARIN:: vec2 vSize; ::if isES3::flat ::end:: ::VARIN:: vec2 vPack0;\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color"]},getCustomIdentifiers:function(){return["sides","shape"]},getCustomVaryings:function(){return["vPack0.x","vPack0.y"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return oa.DEFAULT_FORMULA_VARS},getFormulas:function(){return oa.FORMULAS},getAttributes:function(){return oa.ATTRIBUTES},getFormulaNames:function(){return oa.FORMULA_NAMES},getFormulaVaryings:function(){return""==oa.FORMULA_VARYINGS?
[]:oa.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==oa.FORMULA_CONSTANTS?[]:oa.FORMULA_CONSTANTS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!0},hasZindex:function(){return!1},hasPicking:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,5,"aColorStart0");a.bindAttribLocation(b,4,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,
3,"aPivot");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;W.isINSTANCED?(W.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),
b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,16),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,40,24),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,32),b.vertexAttribDivisor(6,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,
0,6,a)):(W.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,44,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,44,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,44,8),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,44,16),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,44,24),b.enableVertexAttribArray(6),
b.vertexAttribPointer(6,2,b.FLOAT,!1,44,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,44,40)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));W.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(5),b.disableVertexAttribArray(4),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),b.disableVertexAttribArray(3),b.disableVertexAttribArray(6));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:wd};
var Ld=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw z.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);W.isINSTANCED?(null==va.instanceBytes&&(va.instanceBytes=new Ab(new ArrayBuffer(12)),va.instanceBytes.b[0]=1,va.instanceBytes.b[1]=1,va.instanceBytes.b[2]=
1,va.instanceBytes.b[3]=1,va.instanceBytes.b[4]=0,va.instanceBytes.b[5]=1,va.instanceBytes.b[6]=1,va.instanceBytes.b[7]=0,va.instanceBytes.b[8]=0,va.instanceBytes.b[9]=0,va.instanceBytes.b[10]=0,va.instanceBytes.b[11]=0),this._elemBuffSize=36):this._elemBuffSize=240;this._bytes=new Ab(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_Shape"]=Ld;Ld.__name__=!0;Ld.__interfaces__=[Lc];Ld.prototype={setNewGLContext:function(a){if(null!=
a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),W.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),W.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);W.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),
a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=va.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));W.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(5),
a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,36,0),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,36,4),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,36,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,36,16),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,36,24),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,36,32),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,0),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,40,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,8),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,40,16),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,24),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,40,32),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,40,36)),this._gl.bindVertexArray(null))}},update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(W.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.color;e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI;e.b_UFloat32[c.bytePos+8>>2]=c.x;e.b_UFloat32[c.bytePos+12>>2]=c.y;e.b_UFloat32[c.bytePos+16>>2]=c.px_offset;e.b_UFloat32[c.bytePos+20>>
2]=c.py_offset;e.b_UFloat32[c.bytePos+24>>2]=c.sides;e.b_UFloat32[c.bytePos+28>>2]=c.shape;e.b_Uint16[c.bytePos+32>>1]=c.w&65535;e.b_Uint16[c.bytePos+34>>1]=c.h&65535}else c=this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.color,e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+8>>2]=c.x,e.b_UFloat32[c.bytePos+12>>2]=c.y,e.b_UFloat32[c.bytePos+16>>2]=c.px_offset,e.b_UFloat32[c.bytePos+20>>2]=c.py_offset,e.b_UFloat32[c.bytePos+24>>2]=c.sides,e.b_UFloat32[c.bytePos+
28>>2]=c.shape,e.b_Uint16[c.bytePos+32>>1]=c.w&65535,e.b_Uint16[c.bytePos+34>>1]=c.h&65535,e.b[c.bytePos+36]=1,e.b[c.bytePos+37]=1,e.b_Int32[c.bytePos+40>>2]=c.color,e.b_UFloat32[c.bytePos+44>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+48>>2]=c.x,e.b_UFloat32[c.bytePos+52>>2]=c.y,e.b_UFloat32[c.bytePos+56>>2]=c.px_offset,e.b_UFloat32[c.bytePos+60>>2]=c.py_offset,e.b_UFloat32[c.bytePos+64>>2]=c.sides,e.b_UFloat32[c.bytePos+68>>2]=c.shape,e.b_Uint16[c.bytePos+72>>1]=c.w&65535,e.b_Uint16[c.bytePos+
74>>1]=c.h&65535,e.b[c.bytePos+76]=1,e.b[c.bytePos+77]=1,e.b_Int32[c.bytePos+80>>2]=c.color,e.b_UFloat32[c.bytePos+84>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+88>>2]=c.x,e.b_UFloat32[c.bytePos+92>>2]=c.y,e.b_UFloat32[c.bytePos+96>>2]=c.px_offset,e.b_UFloat32[c.bytePos+100>>2]=c.py_offset,e.b_UFloat32[c.bytePos+104>>2]=c.sides,e.b_UFloat32[c.bytePos+108>>2]=c.shape,e.b_Uint16[c.bytePos+112>>1]=c.w&65535,e.b_Uint16[c.bytePos+114>>1]=c.h&65535,e.b[c.bytePos+116]=0,e.b[c.bytePos+117]=1,e.b_Int32[c.bytePos+
120>>2]=c.color,e.b_UFloat32[c.bytePos+124>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+128>>2]=c.x,e.b_UFloat32[c.bytePos+132>>2]=c.y,e.b_UFloat32[c.bytePos+136>>2]=c.px_offset,e.b_UFloat32[c.bytePos+140>>2]=c.py_offset,e.b_UFloat32[c.bytePos+144>>2]=c.sides,e.b_UFloat32[c.bytePos+148>>2]=c.shape,e.b_Uint16[c.bytePos+152>>1]=c.w&65535,e.b_Uint16[c.bytePos+154>>1]=c.h&65535,e.b[c.bytePos+156]=1,e.b[c.bytePos+157]=0,e.b_Int32[c.bytePos+160>>2]=c.color,e.b_UFloat32[c.bytePos+164>>2]=c.rotation/
180*Math.PI,e.b_UFloat32[c.bytePos+168>>2]=c.x,e.b_UFloat32[c.bytePos+172>>2]=c.y,e.b_UFloat32[c.bytePos+176>>2]=c.px_offset,e.b_UFloat32[c.bytePos+180>>2]=c.py_offset,e.b_UFloat32[c.bytePos+184>>2]=c.sides,e.b_UFloat32[c.bytePos+188>>2]=c.shape,e.b_Uint16[c.bytePos+192>>1]=c.w&65535,e.b_Uint16[c.bytePos+194>>1]=c.h&65535,e.b[c.bytePos+196]=0,e.b[c.bytePos+197]=0,e.b_Int32[c.bytePos+200>>2]=c.color,e.b_UFloat32[c.bytePos+204>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+208>>2]=c.x,e.b_UFloat32[c.bytePos+
212>>2]=c.y,e.b_UFloat32[c.bytePos+216>>2]=c.px_offset,e.b_UFloat32[c.bytePos+220>>2]=c.py_offset,e.b_UFloat32[c.bytePos+224>>2]=c.sides,e.b_UFloat32[c.bytePos+228>>2]=c.shape,e.b_Uint16[c.bytePos+232>>1]=c.w&65535,e.b_Uint16[c.bytePos+234>>1]=c.h&65535,e.b[c.bytePos+236]=0,e.b[c.bytePos+237]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},
updateElement:function(a){if(W.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.color;b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI;b.b_UFloat32[a.bytePos+8>>2]=a.x;b.b_UFloat32[a.bytePos+12>>2]=a.y;b.b_UFloat32[a.bytePos+16>>2]=a.px_offset;b.b_UFloat32[a.bytePos+20>>2]=a.py_offset;b.b_UFloat32[a.bytePos+24>>2]=a.sides;b.b_UFloat32[a.bytePos+28>>2]=a.shape;b.b_Uint16[a.bytePos+32>>1]=a.w&65535;b.b_Uint16[a.bytePos+34>>1]=a.h&65535}else b=this._bytes,b.b_Int32[a.bytePos>>2]=a.color,b.b_UFloat32[a.bytePos+
4>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+8>>2]=a.x,b.b_UFloat32[a.bytePos+12>>2]=a.y,b.b_UFloat32[a.bytePos+16>>2]=a.px_offset,b.b_UFloat32[a.bytePos+20>>2]=a.py_offset,b.b_UFloat32[a.bytePos+24>>2]=a.sides,b.b_UFloat32[a.bytePos+28>>2]=a.shape,b.b_Uint16[a.bytePos+32>>1]=a.w&65535,b.b_Uint16[a.bytePos+34>>1]=a.h&65535,b.b[a.bytePos+36]=1,b.b[a.bytePos+37]=1,b.b_Int32[a.bytePos+40>>2]=a.color,b.b_UFloat32[a.bytePos+44>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+48>>2]=a.x,b.b_UFloat32[a.bytePos+
52>>2]=a.y,b.b_UFloat32[a.bytePos+56>>2]=a.px_offset,b.b_UFloat32[a.bytePos+60>>2]=a.py_offset,b.b_UFloat32[a.bytePos+64>>2]=a.sides,b.b_UFloat32[a.bytePos+68>>2]=a.shape,b.b_Uint16[a.bytePos+72>>1]=a.w&65535,b.b_Uint16[a.bytePos+74>>1]=a.h&65535,b.b[a.bytePos+76]=1,b.b[a.bytePos+77]=1,b.b_Int32[a.bytePos+80>>2]=a.color,b.b_UFloat32[a.bytePos+84>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+88>>2]=a.x,b.b_UFloat32[a.bytePos+92>>2]=a.y,b.b_UFloat32[a.bytePos+96>>2]=a.px_offset,b.b_UFloat32[a.bytePos+
100>>2]=a.py_offset,b.b_UFloat32[a.bytePos+104>>2]=a.sides,b.b_UFloat32[a.bytePos+108>>2]=a.shape,b.b_Uint16[a.bytePos+112>>1]=a.w&65535,b.b_Uint16[a.bytePos+114>>1]=a.h&65535,b.b[a.bytePos+116]=0,b.b[a.bytePos+117]=1,b.b_Int32[a.bytePos+120>>2]=a.color,b.b_UFloat32[a.bytePos+124>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+128>>2]=a.x,b.b_UFloat32[a.bytePos+132>>2]=a.y,b.b_UFloat32[a.bytePos+136>>2]=a.px_offset,b.b_UFloat32[a.bytePos+140>>2]=a.py_offset,b.b_UFloat32[a.bytePos+144>>2]=a.sides,
b.b_UFloat32[a.bytePos+148>>2]=a.shape,b.b_Uint16[a.bytePos+152>>1]=a.w&65535,b.b_Uint16[a.bytePos+154>>1]=a.h&65535,b.b[a.bytePos+156]=1,b.b[a.bytePos+157]=0,b.b_Int32[a.bytePos+160>>2]=a.color,b.b_UFloat32[a.bytePos+164>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+168>>2]=a.x,b.b_UFloat32[a.bytePos+172>>2]=a.y,b.b_UFloat32[a.bytePos+176>>2]=a.px_offset,b.b_UFloat32[a.bytePos+180>>2]=a.py_offset,b.b_UFloat32[a.bytePos+184>>2]=a.sides,b.b_UFloat32[a.bytePos+188>>2]=a.shape,b.b_Uint16[a.bytePos+
192>>1]=a.w&65535,b.b_Uint16[a.bytePos+194>>1]=a.h&65535,b.b[a.bytePos+196]=0,b.b[a.bytePos+197]=0,b.b_Int32[a.bytePos+200>>2]=a.color,b.b_UFloat32[a.bytePos+204>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+208>>2]=a.x,b.b_UFloat32[a.bytePos+212>>2]=a.y,b.b_UFloat32[a.bytePos+216>>2]=a.px_offset,b.b_UFloat32[a.bytePos+220>>2]=a.py_offset,b.b_UFloat32[a.bytePos+224>>2]=a.sides,b.b_UFloat32[a.bytePos+228>>2]=a.shape,b.b_Uint16[a.bytePos+232>>1]=a.w&65535,b.b_Uint16[a.bytePos+234>>1]=a.h&65535,
b.b[a.bytePos+236]=0,b.b[a.bytePos+237]=0;if(-1==a.bytePos)throw z.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw z.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=
this._maxElements+this._growSize,c=new Ab(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var d=c++,f=this._elements[d];e=this._bytes;var h=f.bytePos,p=this._elemBuffSize;null==p&&(p=0);null==h&&(h=0);e=0<p?new Uint8Array(e.b.bufferValue,h,p):new Uint8Array(e.b.bufferValue,h);f.bufferPointer=e;b[d]=f}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=
this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),W.isVAO&&(this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),
b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,36,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,36,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,36,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,36,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,36,24),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(2),
b.vertexAttribPointer(2,2,b.SHORT,!1,36,32),b.vertexAttribDivisor(2,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,40,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,24),b.enableVertexAttribArray(2),
b.vertexAttribPointer(2,2,b.SHORT,!1,40,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,36)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;h=a.bytePos;p=this._elemBuffSize;null==p&&(p=0);null==h&&(h=0);e=0<p?new Uint8Array(e.b.bufferValue,h,p):new Uint8Array(e.b.bufferValue,h);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw z.thrown("Error: Element is already inside a Buffer");
},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t::IN:: vec2 aPivot;\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t::IN:: vec2 aFloat0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t::if isES3::flat ::end::::VAROUT:: vec2 vSize; ::if isES3::flat ::end:: ::VAROUT:: vec2 vPack0;\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;vSize = size;\n\t\tvec2 pivot = ::if PIVOT_FORMULA::::PIVOT_FORMULA::::else::vec2((aSize.x) * 0.5 + (aPivot.x), (aSize.y) * 0.5 + (aPivot.y))::end::;\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( aRotZ, 0.0 )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + (aPosition * size - pivot) * mat2( vec2(cos(rotZ.x), -sin(rotZ.x)), vec2(sin(rotZ.x), cos(rotZ.x)) );\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\tvPack0.x = ::if FORMULA_VARYINGS.sides::::FORMULA_VARYINGS.sides::::else::aFloat0.x::end::;vPack0.y = ::if FORMULA_VARYINGS.shape::::FORMULA_VARYINGS.shape::::else::aFloat0.y::end::;\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t::if isES3::flat ::end::::VARIN:: vec2 vSize; ::if isES3::flat ::end:: ::VARIN:: vec2 vPack0;\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color"]},getCustomIdentifiers:function(){return["sides","shape"]},getCustomVaryings:function(){return["vPack0.x","vPack0.y"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return va.DEFAULT_FORMULA_VARS},getFormulas:function(){return va.FORMULAS},getAttributes:function(){return va.ATTRIBUTES},getFormulaNames:function(){return va.FORMULA_NAMES},getFormulaVaryings:function(){return""==va.FORMULA_VARYINGS?
[]:va.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==va.FORMULA_CONSTANTS?[]:va.FORMULA_CONSTANTS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!0},hasZindex:function(){return!1},hasPicking:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,5,"aColorStart0");a.bindAttribLocation(b,4,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,
3,"aPivot");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;W.isINSTANCED?(W.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,36,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),
b.vertexAttribPointer(4,1,b.FLOAT,!1,36,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,36,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,36,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,36,24),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,36,32),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,
0,6,a)):(W.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,40,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,24),b.enableVertexAttribArray(2),
b.vertexAttribPointer(2,2,b.SHORT,!1,40,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,36)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));W.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(5),b.disableVertexAttribArray(4),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),b.disableVertexAttribArray(3),b.disableVertexAttribArray(6));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Ld};
var Md=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw z.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);W.isINSTANCED?(null==sa.instanceBytes&&(sa.instanceBytes=new Ab(new ArrayBuffer(12)),sa.instanceBytes.b[0]=1,sa.instanceBytes.b[1]=1,sa.instanceBytes.b[2]=
1,sa.instanceBytes.b[3]=1,sa.instanceBytes.b[4]=0,sa.instanceBytes.b[5]=1,sa.instanceBytes.b[6]=1,sa.instanceBytes.b[7]=0,sa.instanceBytes.b[8]=0,sa.instanceBytes.b[9]=0,sa.instanceBytes.b[10]=0,sa.instanceBytes.b[11]=0),this._elemBuffSize=8):this._elemBuffSize=72;this._bytes=new Ab(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_ViewElement"]=Md;Md.__name__=!0;Md.__interfaces__=[Lc];Md.prototype={setNewGLContext:function(a){if(null!=
a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),W.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),W.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);W.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),
a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=sa.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));W.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(1),
a.vertexAttribPointer(1,2,a.SHORT,!1,8,0),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,8,4),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,12,0),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,12,4),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null))}},updateElement:function(a){if(W.isINSTANCED){var b=
this._bytes;b.b_Uint16[a.bytePos>>1]=a.x&65535;b.b_Uint16[a.bytePos+2>>1]=a.y&65535;b.b_Uint16[a.bytePos+4>>1]=a.w&65535;b.b_Uint16[a.bytePos+6>>1]=a.h&65535}else b=this._bytes,b.b_Uint16[a.bytePos>>1]=a.x&65535,b.b_Uint16[a.bytePos+2>>1]=a.y&65535,b.b_Uint16[a.bytePos+4>>1]=a.w&65535,b.b_Uint16[a.bytePos+6>>1]=a.h&65535,b.b[a.bytePos+8]=1,b.b[a.bytePos+9]=1,b.b_Uint16[a.bytePos+12>>1]=a.x&65535,b.b_Uint16[a.bytePos+14>>1]=a.y&65535,b.b_Uint16[a.bytePos+16>>1]=a.w&65535,b.b_Uint16[a.bytePos+18>>1]=
a.h&65535,b.b[a.bytePos+20]=1,b.b[a.bytePos+21]=1,b.b_Uint16[a.bytePos+24>>1]=a.x&65535,b.b_Uint16[a.bytePos+26>>1]=a.y&65535,b.b_Uint16[a.bytePos+28>>1]=a.w&65535,b.b_Uint16[a.bytePos+30>>1]=a.h&65535,b.b[a.bytePos+32]=0,b.b[a.bytePos+33]=1,b.b_Uint16[a.bytePos+36>>1]=a.x&65535,b.b_Uint16[a.bytePos+38>>1]=a.y&65535,b.b_Uint16[a.bytePos+40>>1]=a.w&65535,b.b_Uint16[a.bytePos+42>>1]=a.h&65535,b.b[a.bytePos+44]=1,b.b[a.bytePos+45]=0,b.b_Uint16[a.bytePos+48>>1]=a.x&65535,b.b_Uint16[a.bytePos+50>>1]=a.y&
65535,b.b_Uint16[a.bytePos+52>>1]=a.w&65535,b.b_Uint16[a.bytePos+54>>1]=a.h&65535,b.b[a.bytePos+56]=0,b.b[a.bytePos+57]=0,b.b_Uint16[a.bytePos+60>>1]=a.x&65535,b.b_Uint16[a.bytePos+62>>1]=a.y&65535,b.b_Uint16[a.bytePos+64>>1]=a.w&65535,b.b_Uint16[a.bytePos+66>>1]=a.h&65535,b.b[a.bytePos+68]=0,b.b[a.bytePos+69]=0;if(-1==a.bytePos)throw z.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),
b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw z.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=new Ab(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var d=c++,f=this._elements[d];
e=this._bytes;var h=f.bytePos,p=this._elemBuffSize;null==p&&(p=0);null==h&&(h=0);e=0<p?new Uint8Array(e.b.bufferValue,h,p):new Uint8Array(e.b.bufferValue,h);f.bufferPointer=e;b[d]=f}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null),W.isVAO&&(this._gl.bindVertexArray(this._glVAO),W.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),
b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;h=a.bytePos;p=this._elemBuffSize;null==p&&(p=0);null==h&&(h=0);e=0<p?new Uint8Array(e.b.bufferValue,h,p):new Uint8Array(e.b.bufferValue,h);a.bufferPointer=e;this._elements[this._maxElements++]=
a;this.updateElement(a)}else throw z.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\t\n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t\n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\t\n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return[]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return sa.DEFAULT_FORMULA_VARS},getFormulas:function(){return sa.FORMULAS},getAttributes:function(){return sa.ATTRIBUTES},getFormulaNames:function(){return sa.FORMULA_NAMES},getFormulaVaryings:function(){return""==sa.FORMULA_VARYINGS?[]:sa.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==sa.FORMULA_CONSTANTS?[]:sa.FORMULA_CONSTANTS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;W.isINSTANCED?(W.isVAO?this._gl.bindVertexArray(this._glVAO):
(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(W.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,
b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));W.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null)},__class__:Md};var Wc=function(a,b,c,e,g){null==g&&(g=0);this.renderFramebufferSkipFrames=this.renderFramebufferFrame=0;this._renderFramebufferEnabled=!1;this.renderFramebufferEnabled=!0;this.framebufferTextureSlot=0;this.peoteView=this.gl=this.fbTexture=null;this.alpha=1;this.red=this.green=this.blue=0;this.backgroundAlpha=this.backgroundDepth=this.backgroundEnabled=!1;this.isVisible=!0;this.xz=this.yz=this.zoom=this.xZoom=this.yZoom=1;this.width=this.height=this.x=this.y=this.xOffset=this.yOffset=
0;if(W.isUBO){var d=this.uniformBuffer,f=this.gl;null!=f&&(d.uniformBytes.b_UFloat32[0]=a+this.xOffset,f.bindBuffer(f.UNIFORM_BUFFER,d.uniformBuffer),f.bufferSubData(f.UNIFORM_BUFFER,0,d.xOffestBufferPointer),f.bindBuffer(f.UNIFORM_BUFFER,null))}this.x=a;W.isUBO&&(d=this.uniformBuffer,f=this.gl,null!=f&&(d.uniformBytes.b_UFloat32[1]=b+this.yOffset,f.bindBuffer(f.UNIFORM_BUFFER,d.uniformBuffer),f.bufferSubData(f.UNIFORM_BUFFER,4,d.yOffestBufferPointer),f.bindBuffer(f.UNIFORM_BUFFER,null)));this.y=
b;this.width=c;this.height=e;this.red=(g>>24&255)/255;this.green=(g>>16&255)/255;this.blue=(g>>8&255)/255;this.alpha=(g&255)/255;this.backgroundEnabled=0<this.alpha;this.backgroundAlpha=1>this.alpha;this.programList=new Fe(new xb);W.isUBO&&(this.uniformBuffer=new Nd,this.uniformBufferFB=new Nd,this.uniformBufferViewFB=new Od)};d["peote.view.Display"]=Wc;Wc.__name__=!0;Wc.prototype={addToPeoteView:function(a,b,c){null==c&&(c=!1);this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));a.displayList.add(this,
b,c)},removeFromPeoteView:function(a){if(this.peoteView!=a)throw z.thrown("Error, display is not inside peoteView");a.framebufferDisplayList.has(this)||(this.peoteView=null);a.displayList.remove(this)},addToPeoteViewFramebuffer:function(a,b,c){null==c&&(c=!1);this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));a.framebufferDisplayList.add(this,b,c)},setNewGLContext:function(a){if(null!=a&&a!=this.gl){null!=this.gl&&W.isUBO&&(this.uniformBuffer.deleteGLBuffer(this.gl),this.uniformBufferFB.deleteGLBuffer(this.gl),
this.uniformBufferViewFB.deleteGLBuffer(this.gl));this.gl=a;W.isUBO&&(this.uniformBuffer.createGLBuffer(this.gl,this.x+this.xOffset,this.y+this.yOffset,this.xz,this.yz),this.uniformBufferFB.createGLBuffer(this.gl,this.xOffset,this.yOffset-this.height,this.xz,this.yz),this.uniformBufferViewFB.createGLBuffer(this.gl,this.width,-this.height,0,0,1,1));for(var b=this.programList.first;null!=b;){var c=b.value;b=b.next;if(null!=a&&a!=c.gl){for(var e=0,g=c.displays;e<g.length;){var d=g[e];++e;if(null!=d.gl&&
d.gl!=a)throw z.thrown("Error, program can not used inside different gl-contexts");}null!=c.gl&&(c.gl.deleteShader(c.glVertexShader),c.gl.deleteShader(c.glFragmentShader),c.gl.deleteProgram(c.glProgram),c.buffer.hasPicking()&&(c.gl.deleteShader(c.glVertexShaderPicking),c.gl.deleteShader(c.glFragmentShaderPicking),c.gl.deleteProgram(c.glProgramPicking)));c.gl=a;W.isES3&&(c.glShaderConfig.isES3=!0,c.glShaderConfig.IN="in",c.glShaderConfig.VARIN="in",c.glShaderConfig.VAROUT="out");W.isUBO&&(c.glShaderConfig.isUBO=
!0);W.isINSTANCED&&(c.glShaderConfig.isINSTANCED=!0);c.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=c.gl.getExtension("OES_standard_derivatives")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=c.gl.getExtension("EXT_color_buffer_float")?c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):null!=c.gl.getExtension("OES_texture_float")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});c.buffer.setNewGLContext(c.gl);
c.createProg();c.buffer.hasPicking()&&c.createProg(!0);e=0;for(g=c.activeTextures;e<g.length;){d=g[e];++e;var f=c.gl;if(null!=f&&f!=d.gl){for(var h=0,p=d.programs;h<p.length;){var q=p[h];++h;if(null!=q.gl&&q.gl!=f)throw z.thrown("Error, texture can not used inside different gl-contexts");}q=0;for(h=d.displays;q<h.length;)if(p=h[q],++q,null!=p.gl&&p.gl!=f)throw z.thrown("Error, texture can not used inside different gl-contexts");null!=d.gl&&(d.gl.deleteTexture(d.glTexture),d.glTexture=null,0==d.displays.length&&
null!=d.framebuffer&&(d.gl.deleteFramebuffer(d.framebuffer),d.framebuffer=null,null!=d.glDepthBuffer&&d.gl.deleteRenderbuffer(d.glDepthBuffer),d.glDepthBuffer=null));d.gl=f;if(d.width>d.gl.getParameter(d.gl.MAX_TEXTURE_SIZE)||d.height>d.gl.getParameter(d.gl.MAX_TEXTURE_SIZE))throw z.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");d.glTexture=qb.createEmptyTexture(d.gl,d.width,d.height,d.colorChannels,d.createMipmaps,d.magFilter,d.minFilter,d.useFloat);if(0<d.displays.length&&null==
d.framebuffer){d.glDepthBuffer=d.gl.createRenderbuffer();f=d.gl;q=d.glTexture;h=d.glDepthBuffer;p=d.width;var n=d.height,r=f.createFramebuffer();f.bindRenderbuffer(f.RENDERBUFFER,h);Ha.clearGlErrorQueue(f);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT24,p,n);Ha.getLastGlError(f)==f.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),f.renderbufferStorage(f.RENDERBUFFER,
f.DEPTH_COMPONENT16,p,n));f.bindFramebuffer(f.FRAMEBUFFER,r);f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,h);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,q,0);if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)throw z.thrown("Error: Framebuffer not complete!");f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);d.framebuffer=r;d.updated=!0}for(f=d.images.keys();f.hasNext();)q=f.next(),d.bufferImage(q,d.images.h[q.__id__])}}}}if(null!=
this.fbTexture&&(b=this.fbTexture,null!=a&&a!=b.gl)){e=0;for(g=b.programs;e<g.length;)if(q=g[e],++e,null!=q.gl&&q.gl!=a)throw z.thrown("Error, texture can not used inside different gl-contexts");e=0;for(g=b.displays;e<g.length;)if(d=g[e],++e,null!=d.gl&&d.gl!=a)throw z.thrown("Error, texture can not used inside different gl-contexts");null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=
b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw z.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");b.glTexture=qb.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();f=b.gl;q=b.glTexture;h=b.glDepthBuffer;
p=b.width;n=b.height;r=f.createFramebuffer();f.bindRenderbuffer(f.RENDERBUFFER,h);Ha.clearGlErrorQueue(f);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT24,p,n);Ha.getLastGlError(f)==f.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,p,n));f.bindFramebuffer(f.FRAMEBUFFER,r);f.framebufferRenderbuffer(f.FRAMEBUFFER,
f.DEPTH_ATTACHMENT,f.RENDERBUFFER,h);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,q,0);if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)throw z.thrown("Error: Framebuffer not complete!");f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);b.framebuffer=r;b.updated=!0}for(f=b.images.keys();f.hasNext();)q=f.next(),b.bufferImage(q,b.images.h[q.__id__])}}},addProgram:function(a,b,c){null==c&&(c=!1);a.addToDisplay(this,b,c)},setFramebuffer:function(a,
b,c){if(this.fbTexture==a)throw z.thrown("Error, texture is already in use as Framebuffer for Display");if(b>=a.imageSlots)throw z.thrown("Error, maximum texture slot of framebufferTexture is"+(a.imageSlots-1));if(null==c){if(null==this.gl)throw z.thrown("Error, if the display is not added it needs the gl-context of a peoteView to set a framebuffer texture");}else this.peoteView!=c&&(this.peoteView=c,this.setNewGLContext(c.gl));null!=b&&(this.framebufferTextureSlot=b);if(null!=this.fbTexture){b=this.fbTexture;
if(!K.remove(b.displays,this))throw z.thrown("Error, this texture (Framebuffer) is not used by display anymore");0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null)}b=this.fbTexture=a;if(0<=b.displays.indexOf(this))throw z.thrown("Error, texture is already used by display");a=this.gl;if(null!=a&&a!=b.gl){c=0;for(var e=b.programs;c<e.length;){var g=e[c];++c;if(null!=
g.gl&&g.gl!=a)throw z.thrown("Error, texture can not used inside different gl-contexts");}c=0;for(e=b.displays;c<e.length;)if(g=e[c],++c,null!=g.gl&&g.gl!=a)throw z.thrown("Error, texture can not used inside different gl-contexts");null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||
b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw z.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");b.glTexture=qb.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();c=b.gl;a=b.glTexture;e=b.glDepthBuffer;g=b.width;var d=b.height,f=c.createFramebuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);Ha.clearGlErrorQueue(c);c.renderbufferStorage(c.RENDERBUFFER,
c.DEPTH_COMPONENT24,g,d);Ha.getLastGlError(c)==c.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,g,d));c.bindFramebuffer(c.FRAMEBUFFER,f);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a,0);if(c.checkFramebufferStatus(c.FRAMEBUFFER)!=
c.FRAMEBUFFER_COMPLETE)throw z.thrown("Error: Framebuffer not complete!");c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindRenderbuffer(c.RENDERBUFFER,null);b.framebuffer=f;b.updated=!0}for(a=b.images.keys();a.hasNext();)c=a.next(),b.bufferImage(c,b.images.h[c.__id__])}b.displays.push(this);if(null!=b.gl&&0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();c=b.gl;a=b.glTexture;e=b.glDepthBuffer;g=b.width;d=b.height;f=c.createFramebuffer();c.bindRenderbuffer(c.RENDERBUFFER,
e);Ha.clearGlErrorQueue(c);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT24,g,d);Ha.getLastGlError(c)==c.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,g,d));c.bindFramebuffer(c.FRAMEBUFFER,f);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.framebufferTexture2D(c.FRAMEBUFFER,
c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a,0);if(c.checkFramebufferStatus(c.FRAMEBUFFER)!=c.FRAMEBUFFER_COMPLETE)throw z.thrown("Error: Framebuffer not complete!");c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindRenderbuffer(c.RENDERBUFFER,null);b.framebuffer=f;b.updated=!0}this.renderFramebufferEnabled&&(this._renderFramebufferEnabled=!0)},__class__:Wc};var df={fromRenderContext:function(a){if(null!=a.webgl2)return la.trace("WEBGL2 detected.",{fileName:"peote/view/PeoteGL.hx",lineNumber:86,className:"peote.view._PeoteGL.PeoteGL_Impl_",
methodName:"fromRenderContext"}),W.isUBO=!0,W.isINSTANCED=!0,W.isVAO=!0,W.isES3=!0,a.webgl2;if(null!=a.webgl)return la.trace("WEBGL1 detected.",{fileName:"peote/view/PeoteGL.hx",lineNumber:91,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),a.webgl;window.alert("Error: missing webgl context");return null}},W=function(){};d["peote.view.Version"]=W;W.__name__=!0;var Ea=function(){};d["peote.view.Precision"]=Ea;Ea.__name__=!0;var be=function(a,b,c){null==c&&(c=!0);null==
b&&(b=255);this.speed=1;this.startTime=this.stopTime=0;this.isRun=!1;this.xOffset=this.yOffset=0;this.xz=this.yz=1;this.maskState=0;this.glStateAlpha=this.glStateDepth=!1;this.colorState=!0;this.alpha=1;this.red=this.green=this.blue=0;this.gl=df.fromRenderContext(a.context);this.width=a.__width;this.height=a.__height;this.red=(b>>24&255)/255;this.green=(b>>16&255)/255;this.blue=(b>>8&255)/255;this.alpha=(b&255)/255;W.isUBO&&(this.uniformBuffer=new Od,this.uniformBuffer.createGLBuffer(this.gl,this.width,
this.height,this.xOffset,this.yOffset,this.xz,this.yz));this.maxTextureImageUnits=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS);this.glStateTexture=b=Array(this.maxTextureImageUnits);b=this.gl;var e=b.VERTEX_SHADER,d=Ea.VertexFloat,h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(d.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(d.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(d.low=h.precision);e=b.VERTEX_SHADER;d=Ea.VertexInt;h=
b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(d.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(d.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(d.low=h.precision);e=b.VERTEX_SHADER;d=Ea.VertexSampler;h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(d.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(d.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(d.low=h.precision);e=b.FRAGMENT_SHADER;
d=Ea.FragmentFloat;h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(d.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(d.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(d.low=h.precision);e=b.FRAGMENT_SHADER;d=Ea.FragmentInt;h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(d.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(d.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(d.low=h.precision);
e=b.FRAGMENT_SHADER;d=Ea.FragmentSampler;h=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=h&&(d.high=h.precision);h=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=h&&(d.medium=h.precision);h=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=h&&(d.low=h.precision);W.isINSTANCED?(this.pickInt32=b=new Int32Array(4),this.pickTexture=qb.createPickingTexture(this.gl,!0)):(this.pickUInt8=b=new Uint8Array(4),this.pickTexture=qb.createPickingTexture(this.gl));this.pickDepthBuffer=this.gl.createRenderbuffer();
b=this.gl;e=this.pickTexture;d=this.pickDepthBuffer;h=b.createFramebuffer();b.bindRenderbuffer(b.RENDERBUFFER,d);Ha.clearGlErrorQueue(b);b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT24,1,1);Ha.getLastGlError(b)==b.INVALID_ENUM&&(la.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,1,1));b.bindFramebuffer(b.FRAMEBUFFER,
h);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,d);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,e,0);if(b.checkFramebufferStatus(b.FRAMEBUFFER)!=b.FRAMEBUFFER_COMPLETE)throw z.thrown("Error: Framebuffer not complete!");b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindRenderbuffer(b.RENDERBUFFER,null);this.pickFB=h;this.background=new Ge(this.gl);this.displayList=new Pd(new xb);this.framebufferDisplayList=new Pd(new xb);c&&(a.onRender.add(f(this,this.render)),
a.onResize.add(f(this,this.resize)))};d["peote.view.PeoteView"]=be;be.__name__=!0;be.prototype={isTextureStateChange:function(a,b){return b.updated?(b.updated=!1,this.glStateTexture=Array(this.maxTextureImageUnits),this.glStateTexture[a]=b.glTexture,!0):this.glStateTexture[a]!=b.glTexture?(this.glStateTexture[a]=b.glTexture,!0):!1},start:function(){if(!this.isRun){var a=this.stopTime;this.startTime=this.stopTime=(new Date).getTime()/1E3-a;this.isRun=!0}},addDisplay:function(a,b,c){null==c&&(c=!1);
a.addToPeoteView(this,b,c)},removeDisplay:function(a){a.removeFromPeoteView(this)},addFramebufferDisplay:function(a,b,c){null==c&&(c=!1);a.addToPeoteViewFramebuffer(this,b,c)},resize:function(a,b){this.width=a;this.height=b;if(W.isUBO){var c=this.uniformBuffer,e=this.gl;c.uniformBytes.b_UFloat32[0]=a;c.uniformBytes.b_UFloat32[1]=b;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,0,c.resolutionBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}},renderToTexture:function(a,
b){if(null!=a.fbTexture){b=null!=b?b:a.framebufferTextureSlot;null==b&&(b=a.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.fbTexture.framebuffer);this.gl.viewport(b%a.fbTexture.slotsX*a.fbTexture.slotWidth,a.fbTexture.slotHeight*Math.floor(b/a.fbTexture.slotsX),a.fbTexture.slotWidth,a.fbTexture.slotHeight);this.gl.scissor(b%a.fbTexture.slotsX*a.fbTexture.slotWidth,a.fbTexture.slotHeight*Math.floor(b/a.fbTexture.slotsX),a.fbTexture.slotWidth,a.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);
this.gl.clearColor(0,0,0,0);a.fbTexture.clearOnRenderInto?this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(a.backgroundEnabled){1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=a.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=
!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=0);this.background.render(a.red,a.green,a.blue,a.alpha)}for(a.programListItem=a.programList.first;null!=a.programListItem;){b=a.programListItem.value;b.gl.useProgram(b.glProgram);for(b.textureListItem=b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&
(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),b.gl.uniform1i(b.textureListItem.value.uniformLoc,b.textureListItem.value.unit),b.textureListItem=b.textureListItem.next;W.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,a.uniformBufferViewFB.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,1,a.uniformBufferFB.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,a.width,-a.height),b.gl.uniform2f(b.uZOOM,a.xz,
a.yz),b.gl.uniform2f(b.uOFFSET,(a.xOffset+this.xOffset)/a.xz,(a.yOffset+this.yOffset-a.height)/a.yz));b.gl.uniform1f(b.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(var e=b.uniformFloats.length;c<e;){var d=c++;b.gl.uniform1f(b.uniformFloatLocations[d],b.uniformFloats[d].value)}c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):
!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),
this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);b.buffer.render(this,a,b);b.gl.useProgram(null);a.programListItem=a.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);a.fbTexture.createMipmaps&&(this.gl.bindTexture(this.gl.TEXTURE_2D,a.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),
this.gl.bindTexture(this.gl.TEXTURE_2D,null),a.fbTexture.updated=!0)}},render:function(a){for(this.displayListItem=this.framebufferDisplayList.first;null!=this.displayListItem;){if(this.displayListItem.value._renderFramebufferEnabled)if(this.displayListItem.value.renderFramebufferFrame==this.displayListItem.value.renderFramebufferSkipFrames){var b=this.displayListItem.value;a=null;null==a&&(a=b.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b.fbTexture.framebuffer);this.gl.viewport(a%
b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.scissor(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);b.fbTexture.clearOnRenderInto?this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|
this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(b.backgroundEnabled){1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=b.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=
0);this.background.render(b.red,b.green,b.blue,b.alpha)}for(b.programListItem=b.programList.first;null!=b.programListItem;){a=b.programListItem.value;a.gl.useProgram(a.glProgram);for(a.textureListItem=a.textureList.first;null!=a.textureListItem;)this.isTextureStateChange(a.textureListItem.value.unit,a.textureListItem.value.texture)&&(a.gl.activeTexture(a.gl.TEXTURE0+a.textureListItem.value.unit),a.gl.bindTexture(a.gl.TEXTURE_2D,a.textureListItem.value.texture.glTexture)),a.gl.uniform1i(a.textureListItem.value.uniformLoc,
a.textureListItem.value.unit),a.textureListItem=a.textureListItem.next;W.isUBO?(a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,0,b.uniformBufferViewFB.uniformBuffer),a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,1,b.uniformBufferFB.uniformBuffer)):(a.gl.uniform2f(a.uRESOLUTION,b.width,-b.height),a.gl.uniform2f(a.uZOOM,b.xz,b.yz),a.gl.uniform2f(a.uOFFSET,(b.xOffset+this.xOffset)/b.xz,(b.yOffset+this.yOffset-b.height)/b.yz));a.gl.uniform1f(a.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*
this.speed);c=0;for(var e=a.uniformFloats.length;c<e;){var d=c++;a.gl.uniform1f(a.uniformFloatLocations[d],a.uniformFloats[d].value)}c=a.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=a.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=a.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&
(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=a.mask;e=a.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),
this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);a.buffer.render(this,b,a);a.gl.useProgram(null);b.programListItem=b.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);b.fbTexture.createMipmaps&&(this.gl.bindTexture(this.gl.TEXTURE_2D,b.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null),b.fbTexture.updated=!0);this.displayListItem.value.renderFramebufferFrame=0}else this.displayListItem.value.renderFramebufferFrame++;
this.displayListItem=this.displayListItem.next}b=this.width;c=this.height;this.gl.viewport(0,0,b,c);this.gl.scissor(0,0,b,c);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(this.red,this.green,this.blue,this.alpha);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);for(this.displayListItem=this.displayList.first;null!=this.displayListItem;){a=
this.displayListItem.value;if(a.isVisible){b=this.width;c=this.height;var f=this.xz,h=this.yz;e=Math.floor((a.x+this.xOffset)*f);d=Math.floor((a.y+this.yOffset)*h);f=Math.floor(a.width*f);h=Math.floor(a.height*h);0>e&&(f+=e);e=Math.max(0,Math.min(b,e))|0;f=Math.max(0,Math.min(b-e,f))|0;0>d&&(h+=d);d=Math.max(0,Math.min(c,d))|0;h=Math.max(0,Math.min(c-d,h))|0;this.gl.scissor(e,c-h-d,f,h);a.backgroundEnabled&&(1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0)),(c=a.backgroundDepth)&&
!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST)),(c=a.backgroundAlpha)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND)),0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=0),this.background.render(a.red,a.green,a.blue,a.alpha));for(a.programListItem=a.programList.first;null!=
a.programListItem;){b=a.programListItem.value;if(b.isVisible){b.gl.useProgram(b.glProgram);for(b.textureListItem=b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),b.gl.uniform1i(b.textureListItem.value.uniformLoc,b.textureListItem.value.unit),b.textureListItem=b.textureListItem.next;
W.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,this.uniformBuffer.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,1,a.uniformBuffer.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,this.width,this.height),b.gl.uniform2f(b.uZOOM,this.xz*a.xz,this.yz*a.yz),b.gl.uniform2f(b.uOFFSET,(a.x+a.xOffset+this.xOffset)/a.xz,(a.y+a.yOffset+this.yOffset)/a.yz));b.gl.uniform1f(b.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(e=b.uniformFloats.length;c<e;)d=c++,
b.gl.uniform1f(b.uniformFloatLocations[d],b.uniformFloats[d].value);c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));
c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=
c);b.buffer.render(this,a,b);b.gl.useProgram(null)}a.programListItem=a.programListItem.next}}this.displayListItem=this.displayListItem.next}},__class__:be};var vd=function(a,b,c){this.unit=a;this.texture=b;this.uniformLoc=c};d["peote.view.ActiveTexture"]=vd;vd.__name__=!0;vd.prototype={__class__:vd};var Xc=function(a,b,c,e,d,f,h,p,q){null==q&&(q=16384);null==p&&(p=!1);null==h&&(h=0);null==f&&(f=0);null==d&&(d=!1);null==e&&(e=4);null==c&&(c=1);this.displays=[];this.programs=[];this.useFloat=this.updated=
!1;this.magFilter=this.minFilter=0;this.createMipmaps=!1;this.images=new xb;this.imageSlots=this.freeSlots=this.slotsX=this.slotsY=this.tilesX=this.tilesY=1;this.width=this.height=0;this.colorChannels=4;this.clearOnRenderInto=!0;this.gl=this.glTexture=this.framebuffer=this.glDepthBuffer=null;this.slotWidth=a;this.slotHeight=b;this.imageSlots=this.freeSlots=c;this.colorChannels=e;this.createMipmaps=d;this.magFilter=h;this.minFilter=f;this.useFloat=p;a=qb.optimalTextureSize(c,a,b,q);this.width=a.width;
this.height=a.height;this.slotsX=a.slotsX;this.slotsY=a.slotsY};d["peote.view.Texture"]=Xc;Xc.__name__=!0;Xc.prototype={setImage:function(a,b,c,e){null==b&&(b=0);if(null!=this.images.h.__keys__[a.__id__])throw z.thrown("Error, image is already inside texture inside slot "+this.images.h[a.__id__].imageSlot);null!=c&&(this.tilesX=c);null!=e&&(this.tilesY=e);this.images.set(a,{imageSlot:b});this.freeSlots--;if(null!=this.gl){if(null==this.glTexture){if(this.width>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)||
this.height>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE))throw z.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");this.glTexture=qb.createEmptyTexture(this.gl,this.width,this.height,this.colorChannels,this.createMipmaps,this.magFilter,this.minFilter,this.useFloat)}this.bufferImage(a,{imageSlot:b})}},bufferImage:function(a,b){var c=this.gl,e=b.imageSlot%this.slotsX*this.slotWidth;b=this.slotHeight*Math.floor(b.imageSlot/this.slotsX);var d=a.width,f=a.height,h=this.createMipmaps,
p=this.useFloat;null==p&&(p=!1);null==h&&(h=!1);c.bindTexture(c.TEXTURE_2D,this.glTexture);if(p){p=d*f*4;p=null!=p?new Float32Array(p):null;for(var q=0,n=d*f*4;q<n;){var A=q++;p[A]=Va.toFloat(a.get_data()[A])/Va.toFloat(255)}c.texSubImage2D(c.TEXTURE_2D,0,e,b,d,f,c.RGBA,c.FLOAT,p)}else c.texSubImage2D(c.TEXTURE_2D,0,e,b,d,f,c.RGBA,c.UNSIGNED_BYTE,a.get_data());h&&c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null);this.updated=!0},__class__:Xc};var Nd=function(){var a=this.uniformBytes=
new Ab(new ArrayBuffer(32)),b=0;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=4;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b)};d["peote.view.UniformBufferDisplay"]=Nd;Nd.__name__=!0;Nd.prototype={createGLBuffer:function(a,
b,c,e,d){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=d;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},__class__:Nd};var Od=function(){var a=this.uniformBytes=new Ab(new ArrayBuffer(48)),
b=0;null==b&&(b=0);this.resolutionBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=16;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=20;null==b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b)};d["peote.view.UniformBufferView"]=
Od;Od.__name__=!0;Od.prototype={createGLBuffer:function(a,b,c,e,d,f,h){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=d;this.uniformBytes.b_UFloat32[4]=f;this.uniformBytes.b_UFloat32[5]=h;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},
__class__:Od};var Pe=function(a,b){this.name=a;this.value=b};d["peote.view.UniformFloat"]=Pe;Pe.__name__=!0;Pe.prototype={__class__:Pe};var Ge=function(a){this.gl=a;this.createBuffer();this.createProgram()};d["peote.view.utils.Background"]=Ge;Ge.__name__=!0;Ge.prototype={createBuffer:function(){var a=new Ab(new ArrayBuffer(32));a.b_UFloat32[0]=1;a.b_UFloat32[1]=1;a.b_UFloat32[2]=0;a.b_UFloat32[3]=1;a.b_UFloat32[4]=1;a.b_UFloat32[5]=0;a.b_UFloat32[6]=0;a.b_UFloat32[7]=0;this.buffer=this.gl.createBuffer();
this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);a=new Uint8Array(a.b.bufferValue,0);this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},createProgram:function(){var a="",b=Ea.VertexFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Ea.VertexFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));b=this.gl;var c=this.gl.VERTEX_SHADER,e=b.createShader(c);b.shaderSource(e,a+"\t\n\t\t\tattribute vec2 aPosition;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_Position = mat4 (\n\t\t\t\t\tvec4(2.0, 0.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, -2.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, 0.0, -1.0, 0.0),\n\t\t\t\t\tvec4(-1.0, 1.0, 0.0, 1.0)\n\t\t\t\t) * vec4 (aPosition, -1.0 ,1.0);\n\t\t\t}\n\t\t");
b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw z.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+p.string(b.getShaderInfoLog(e)));var d=e;b=Ea.FragmentFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Ea.FragmentFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));b=this.gl;c=this.gl.FRAGMENT_SHADER;e=b.createShader(c);b.shaderSource(e,a+"\n\t\t\tuniform vec4 uRGBA;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_FragColor = uRGBA;\n\t\t\t\t\n\t\t\t\t// TODO: Fix for old FF\n\t\t\t\tgl_FragColor.w = clamp(uRGBA.w, 0.003, 1.0);\n\t\t\t}\n\t\t");
b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw z.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+p.string(b.getShaderInfoLog(e)));a=e;this.glProgram=this.gl.createProgram();this.gl.attachShader(this.glProgram,d);this.gl.attachShader(this.glProgram,a);this.gl.deleteShader(d);this.gl.deleteShader(a);this.gl.bindAttribLocation(this.glProgram,0,"aPosition");b=this.gl;d=this.glProgram;b.linkProgram(d);if(0==b.getProgramParameter(d,b.LINK_STATUS))throw z.thrown(p.string(b.getProgramInfoLog(d))+
"VALIDATE_STATUS: "+p.string(b.getProgramParameter(d,b.VALIDATE_STATUS))+"ERROR: "+p.string(b.getError()));this.uRGBA=this.gl.getUniformLocation(this.glProgram,"uRGBA")},render:function(a,b,c,e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);this.gl.enableVertexAttribArray(0);this.gl.vertexAttribPointer(0,2,this.gl.FLOAT,!1,8,0);this.gl.useProgram(this.glProgram);this.gl.uniform4f(this.uRGBA,a,b,c,e);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);this.gl.disableVertexAttribArray(0);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
null)},__class__:Ge};var Ab=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b;this.b_UFloat32=new Float32Array(a);this.b_Int32=new Int32Array(a);this.b_Uint16=new Uint16Array(a)};d["peote.view.utils.BufferBytes"]=Ab;Ab.__name__=!0;Ab.prototype={blit:function(a,b,c,e){0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},fill:function(a,b,c){for(var e=0;e<b;)e++,this.b[a++]=c},__class__:Ab};var Ha=function(){};d["peote.view.utils.GLTool"]=
Ha;Ha.__name__=!0;Ha.clearGlErrorQueue=function(a){for(;a.getError()!=a.NO_ERROR;);};Ha.getLastGlError=function(a){var b=a.getError();b!=a.NO_ERROR&&(b==a.INVALID_ENUM?la.trace("(GL-Error: INVALID_ENUM)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:22,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.INVALID_VALUE?la.trace("(GL-Error: INVALID_VALUE)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:23,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==
a.INVALID_OPERATION?la.trace("(GL-Error: INVALID_OPERATION)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:24,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.OUT_OF_MEMORY?la.trace("(GL-Error: OUT_OF_MEMORY)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:25,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):la.trace("GL-Error: "+b,{fileName:"peote/view/utils/GLTool.hx",lineNumber:26,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}));return b};
var Pb=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_ActiveTexture"]=Pb;Pb.__name__=!0;Pb.prototype={__class__:Pb};var Zb=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_Display"]=Zb;Zb.__name__=!0;Zb.prototype={__class__:Zb};var pc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=
this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_Program"]=pc;pc.__name__=!0;pc.prototype={__class__:pc};var ud=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_ActiveTexture"]=ud;ud.__name__=!0;ud.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new Pb(a,null,null);else if(null==b)b=this.first=new Pb(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new Pb(a,c.prev,c),c==this.first&&(this.first=
b);else throw z.thrown("Error on add: "+p.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new Pb(a,null,null);else if(null==b)b=this.last=new Pb(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new Pb(a,c,c.next),c==this.last&&(this.last=b);else throw z.thrown("Error on add: "+p.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=
c.prev));this.itemMap.set(a,b)},clear:function(){for(;null!=this.first;){null!=this.last.value&&this.itemMap.remove(this.last.value);var a=this.last;a==this.first&&(this.first=a.next);a==this.last&&(this.last=a.prev);null!=a.prev&&(a.prev.next=a.next);null!=a.next&&(a.next.prev=a.prev)}},__class__:ud};var Pd=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_Display"]=Pd;Pd.__name__=!0;Pd.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=
this.last=new Zb(a,null,null);else if(null==b)b=this.first=new Zb(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new Zb(a,c.prev,c),c==this.first&&(this.first=b);else throw z.thrown("Error on add: "+p.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new Zb(a,null,null);else if(null==b)b=this.last=new Zb(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new Zb(a,c,c.next),c==this.last&&(this.last=b);else throw z.thrown("Error on add: "+p.string(b)+" is not in list.");
c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},remove:function(a){var b=this.itemMap.get(a);if(null!=b)this.itemMap.remove(a),b==this.first&&(this.first=b.next),b==this.last&&(this.last=b.prev),null!=b.prev&&(b.prev.next=b.next),null!=b.next&&(b.next.prev=b.prev);else throw z.thrown("Error on remove: "+p.string(a)+" is not in list.");},has:function(a){return this.itemMap.exists(a)},
__class__:Pd};var Fe=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_Program"]=Fe;Fe.__name__=!0;Fe.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new pc(a,null,null);else if(null==b)b=this.first=new pc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new pc(a,c.prev,c),c==this.first&&(this.first=b);else throw z.thrown("Error on add: "+p.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=
new pc(a,null,null);else if(null==b)b=this.last=new pc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new pc(a,c,c.next),c==this.last&&(this.last=b);else throw z.thrown("Error on add: "+p.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},__class__:Fe};var qb=function(){};d["peote.view.utils.TexUtils"]=qb;qb.__name__=
!0;qb.createEmptyTexture=function(a,b,c,e,d,f,h,p){null==p&&(p=!1);null==h&&(h=0);null==f&&(f=0);null==d&&(d=!1);e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e);Ha.clearGlErrorQueue(a);if(p){p=a.TEXTURE_2D;var g=a.RGBA32F,l=a.RGBA,m=a.FLOAT,q=0;0==q?a.texImage2D(p,0,g,b,c,0,l,m,null):a.texImage2D(p,0,g,b,c,0,l,m,q);Ha.getLastGlError(a)==a.INVALID_VALUE&&(la.trace("switching to RGBA16F for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:25,className:"peote.view.utils.TexUtils",
methodName:"createEmptyTexture"}),p=a.TEXTURE_2D,g=a.RGBA16F,l=a.RGBA,m=a.FLOAT,q=0,0==q?a.texImage2D(p,0,g,b,c,0,l,m,null):a.texImage2D(p,0,g,b,c,0,l,m,q),Ha.getLastGlError(a)==a.INVALID_VALUE&&(la.trace("switching to RGBA for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:28,className:"peote.view.utils.TexUtils",methodName:"createEmptyTexture"}),p=a.TEXTURE_2D,l=g=a.RGBA,m=a.FLOAT,q=0,0==q?a.texImage2D(p,0,g,b,c,0,l,m,null):a.texImage2D(p,0,g,b,c,0,l,m,q)))}else p=
a.TEXTURE_2D,l=g=a.RGBA,m=a.UNSIGNED_BYTE,q=0,0==q?a.texImage2D(p,0,g,b,c,0,l,m,null):a.texImage2D(p,0,g,b,c,0,l,m,q);if(Ha.getLastGlError(a)==a.OUT_OF_MEMORY)throw z.thrown("OUT OF GPU MEMORY while texture creation");1==f?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);if(d)switch(h){case 1:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR);break;case 2:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.NEAREST_MIPMAP_NEAREST);break;case 3:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_LINEAR);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST)}else 1==h?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);d&&a.generateMipmap(a.TEXTURE_2D);a.bindTexture(a.TEXTURE_2D,
null);return e};qb.createPickingTexture=function(a,b){null==b&&(b=!1);var c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c);if(b){b=a.TEXTURE_2D;var e=a.RGBA32I,d=a.RGBA_INTEGER,f=a.INT,h=0}else b=a.TEXTURE_2D,d=e=a.RGBA,f=a.UNSIGNED_BYTE,h=0;0==h?a.texImage2D(b,0,e,1,1,0,d,f,null):a.texImage2D(b,0,e,1,1,0,d,f,h);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null);return c};qb.optimalTextureSize=function(a,b,c,e,d,f){null==d&&(d=!0);f=Math.ceil(Math.log(e)/Math.log(2));for(var g=Math.ceil(Math.log(a*b*c)/Math.log(2)),h,p=1,l=g-1,q=Math.floor(Math.abs(p-l)),r=(1<<f)*(1<<f),n=!1,A=Math.floor(Math.min(f,g)),k;1<<A>=b;){for(k=Math.floor(Math.min(f,g-A+1));1<<k>=c&&!(Math.floor((1<<A)/b)*Math.floor((1<<k)/c)<a);){h=(1<<A)*(1<<k)-a*b*c;if(0>h)break;h<=r&&(h==r?Math.abs(A-k)<q&&(q=Math.floor(Math.abs(A-
k)),p=A,l=k,n=!0):(p=A,l=k,r=h,n=!0));--k}--A}if(n)p=1<<p,l=1<<l;else{if(d)throw z.thrown("Error: max texture-size ("+e+") is to small for "+a+" images ("+b+" x "+c+")");if(b>e||c>e)throw z.thrown("Error: max texture-size ("+e+") is to small for image ("+b+" x "+c+")");p=l=e}return{width:p,height:l,slotsX:p/b|0,slotsY:l/c|0,imageSlots:(p/b|0)*(l/c|0)}};var lc=function(){};d["peote.view.utils.Util"]=lc;lc.__name__=!0;lc.resolveFormulaCyclic=function(a){for(var b=[],c=a.h,e=Object.keys(c),d=e.length,
f=0;f<d;)if(c=e[f++],c=lc.resolveFormulaKey(c,a,b),null!=c.errKey)throw z.thrown(c);c=a.h;b=Object.keys(c);e=b.length;for(d=0;d<e;)c=b[d++],f=a.h[c].replace(/___:::___/g,""),a.h[c]=f};lc.resolveFormulaKey=function(a,b,c,e){null==e&&(e=[a]);null==c&&(c=[]);var d=b.h[a];if(0<=c.indexOf(a))return{formula:d,errKey:null,errVar:null};for(var f=Object.keys(b.h),h=f.length,p=0;p<h;){var q=f[p++];if(q!=a){var n=new Z("(^|.*?[^\\w.])"+q+"\\b.*?","g");if(n.match(d)){if(0<=e.indexOf(q))return{formula:d,errKey:a,
errVar:q};q=lc.resolveFormulaKey(q,b,c,e.concat([q]));if(null!=q.errKey)return q;d=d.replace(n.r,"$1(___:::___"+q.formula+"___:::___)")}}}b.h[a]=d;c.push(a);return{formula:d,errKey:null,errVar:null}};lc.resolveFormulaVars=function(a,b){for(var c=a.h,e=Object.keys(c),d=e.length,f=0;f<d;){var h=e[f++],p=a.h[h];c=b.h;c=Object.keys(c);for(var q=c.length,n=0;n<q;){var A=c[n++],r=new Z("(^|.*?[^\\w.])"+A+"\\b.*?","g");r.match(p)&&(p=p.replace(r.r,"$1("+b.h[A]+")"))}a.h[h]=p}};var Qe=function(){};d["tyke.Collidable"]=
Qe;Qe.__name__=!0;Qe.__isInterface__=!0;var mc=function(a,b,c,e,d){null==d&&(d=-855703297);this.body=Y.make(c,b);this.body.on_move=f(this,this.onMove);this.body.on_rotate=f(this,this.onRotate);this.body.hardlight=this;this.entity=null==a?this:a;switch(this.body.shapes[0].type){case 1:a=xd.CIRCLE;break;case 2:a=xd.POLYGON(b.shape.sides);break;default:a=xd.RECT}this.graphic=e.makeShape(b.x|0,b.y|0,b.shape.width|0,b.shape.height|0,a,d)};d["tyke.HardLight"]=mc;mc.__name__=!0;mc.__interfaces__=[Qe];mc.prototype=
{onMove:function(a,b){this.graphic.setPosition(a,b)},onRotate:function(a){this.graphic.rotation=a},__class__:mc};var Dc=function(a){this.rectangles=[];Gc.call(this);this.canvas=a;this.shape_color=1533993386;this.shape_fill_color=-874775382;this.shape_collided_color=-648584278;this.quadtree_color=-2072082518;this.quadtree_fill_color=-1683114070;this.intersection_color=-874775382;this.intersection_overlap_color=-648584278};d["tyke.EchoDebug"]=Dc;Dc.__name__=!0;Dc.__super__=Gc;Dc.prototype=B(Gc.prototype,
{draw_line:function(a,b,c,e,d,f){d=c-a;f=e-b;this.rectangles.push(this.canvas.makeRectangle(a,b,3,Math.sqrt(d*d+f*f),180/Math.PI*Math.atan2(a-c,-(b-e)),this.shape_color))},draw_rect:function(a,b,c,e,d,f,h){},draw_circle:function(a,b,c,e,d,f){},draw_polygon:function(a,b,c,e,d){if(!(2>a)){c=b[0].x;e=b[0].y;d=c;for(var g=e,f=1;f<a;){var h=f++,p=b[h].x;h=b[h].y;var q=p-d,n=h-g;q=Math.sqrt(q*q+n*n);n=180/Math.PI*Math.atan2(d-p,-(g-h));this.rectangles.push(this.canvas.makeRectangle(d,g,3,q,n,this.shape_color));
d=p;g=h}q=c-d;n=e-g;q=Math.sqrt(q*q+n*n);n=180/Math.PI*Math.atan2(d-c,-(g-e));this.rectangles.push(this.canvas.makeRectangle(d,g,3,q,n,this.shape_color))}},clear:function(){for(var a=this.rectangles.length;0<a;){var b=this.rectangles.pop();this.canvas.buffer.removeElement(b);--a}},__class__:Dc});var yd=function(){};d["tyke.IHaveGraphicsBuffer"]=yd;yd.__name__=!0;yd.__isInterface__=!0;yd.prototype={__class__:yd,__properties__:{get_program:"get_program"}};var xd=y["tyke.Geometry"]={__ename__:!0,__constructs__:null,
RECT:{_hx_name:"RECT",_hx_index:0,__enum__:"tyke.Geometry",toString:n},CIRCLE:{_hx_name:"CIRCLE",_hx_index:1,__enum__:"tyke.Geometry",toString:n},POLYGON:(h=function(a){return{_hx_index:2,numSides:a,__enum__:"tyke.Geometry",toString:n}},h._hx_name="POLYGON",h.__params__=["numSides"],h)};xd.__constructs__=[xd.RECT,xd.CIRCLE,xd.POLYGON];var He=function(a){this.frameBuffer=a;this.buffers=[]};d["tyke.Layer"]=He;He.__name__=!0;He.prototype={updateGraphicsBuffers:function(){for(var a=0,b=this.buffers;a<
b.length;){var c=b[a];++a;c.updateGraphicsBuffers()}},registerGraphicsBuffer:function(a){this.buffers.push(a)},addProgramToFrameBuffer:function(a){this.frameBuffer.display.addProgram(a)},__class__:He};var va=function(a,b,c,e,d,f,h){null==h&&(h=-1);null==f&&(f=3);null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.shape=0;this.sides=3;this.x=this.y=0;this.color=-1430585089;this.w=this.h=100;this.px_offset=this.py_offset=this.rotation=0;this.x=a;this.y=b;this.w=c;this.h=e;this.shape=d;this.color=h;this.sides=
f};d["tyke.Shape"]=va;va.__name__=!0;va.prototype={setPosition:function(a,b){this.x=a;this.y=b},__class__:va};var Qd=function(a){null==a&&(a=256);this.buffer=new Ld(a,a,!0);this._program=new bd(this.buffer);this._program.setFragmentFloatPrecision("high");this._program.discardAtAlpha(null);this._program.injectIntoFragmentShader(va.InjectFragment,!1);this._program.setColorFormula(va.ColorFormula)};d["tyke.ShapeRenderer"]=Qd;Qd.__name__=!0;Qd.__interfaces__=[yd];Qd.prototype={get_program:function(){return this._program},
makeShape:function(a,b,c,e,d,f){null==f&&(f=-855703297);switch(d._hx_index){case 0:var g=0;break;case 1:g=1;break;default:g=2}switch(d._hx_index){case 1:d=1;break;case 2:d=d.numSides;break;default:d=4}d=new va(a|0,b|0,c,e,g,d,f);this.buffer.addElement(d);return d},updateGraphicsBuffers:function(){this.buffer.update()},__class__:Qd,__properties__:{get_program:"get_program"}};var oa=function(a,b,c,e,d,f){null==f&&(f=-1);null==d&&(d=3);null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.shape=0;this.sides=
3;this.x=this.y=0;this.color=-1430585089;this.w=this.h=100;this.px_offset=this.py_offset=this.rotation=0;this.x=a;this.y=b;this.w=c;this.h=e;this.color=f;this.rotation=d};d["tyke.Rectangle"]=oa;oa.__name__=!0;oa.prototype={__class__:oa};var Rd=function(a){null==a&&(a=256);this.buffer=new wd(a,a,!0);this._program=new bd(this.buffer);this._program.discardAtAlpha(null)};d["tyke.RectangleRenderer"]=Rd;Rd.__name__=!0;Rd.__interfaces__=[yd];Rd.prototype={get_program:function(){return this._program},makeRectangle:function(a,
b,c,e,d,f){null==f&&(f=-855703297);a=new oa(a,b,c,e,d,f);this.buffer.addElement(a);return a},updateGraphicsBuffers:function(){this.buffer.update()},__class__:Rd,__properties__:{get_program:"get_program"}};var de=function(a){this.sortOrder=[];this.bindings=new Kb;for(var b=0;b<a.length;){var c=a[b];++b;this._bind(c)}};d["tyke.KeyPresses_tyke_PhysicalStageLoop"]=de;de.__name__=!0;de.prototype={handle:function(a,b){this.lastHandled=a;this.bindings.exists(a)&&this.bindings.get(a).handle(b)},_bind:function(a){this.sortOrder.push(a.code);
this.bindings.set(a.code,a)},__class__:de};var ee=function(a,b){this.layers=new T;this.display=a;this.coreLoop=b;this.buffer=new Md(1);this.program=new bd(this.buffer);this.program.setFragmentFloatPrecision("high");this.program.alphaEnabled=!0;this.program.discardAtAlpha(null);a.addProgram(this.program);this.view=new sa(0,0,a.width,a.height);this.buffer.addElement(this.view);this.globalFrameBuffer=this.makeFrameBuffer("globalFramebuffer",!1)};d["tyke.Stage"]=ee;ee.__name__=!0;ee.prototype={chainFrameBuffer:function(a,
b){this.program.addTexture(a.texture,b,!0)},makeFrameBuffer:function(a,b){b=this.coreLoop.getFrameBufferDisplay(this.display.x,this.display.y,this.display.width,this.display.height,b);this.chainFrameBuffer(b,a);return b},createLayer:function(a,b,c){null==c&&(c=!0);b=c?this.globalFrameBuffer:this.makeFrameBuffer(a,b);b=new He(b);return this.layers.h[a]=b},initGraphicsBuffer:function(a,b,c,e){c=this.createLayer(a,c,!e);c.registerGraphicsBuffer(b);c.addProgramToFrameBuffer(b.get_program());this.layers.h[a]=
c},createShapeRenderLayer:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);var e=new Qd;this.initGraphicsBuffer(a,e,b,c);return e},createRectangleRenderLayer:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);var e=new Rd;this.initGraphicsBuffer(a,e,b,c);return e},updateGraphicsBuffers:function(){for(var a=this.layers.h,b=Object.keys(a),c=b.length,e=0;e<c;)a[b[e++]].updateGraphicsBuffers()},get_width:function(){return this.display.width},get_height:function(){return this.display.height},__class__:ee,
__properties__:{get_height:"get_height",get_width:"get_width"}};var sa=function(a,b,c,e){null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.w=this.h=100;this.x=this.y=0;this.x=a;this.y=b;this.w=c;this.h=e};d["tyke.ViewElement"]=sa;sa.__name__=!0;sa.prototype={__class__:sa};var cb=function(){};d["utils.Loader"]=cb;cb.__name__=!0;cb.onProgressDebug=function(a,b,c){la.trace("...loading "+a+"/"+b+' of "'+c+'"',{fileName:"utils/Loader.hx",lineNumber:11,className:"utils.Loader",methodName:"onProgressDebug"})};
cb.onErrorDebug=function(a){la.trace("Error - "+a,{fileName:"utils/Loader.hx",lineNumber:15,className:"utils.Loader",methodName:"onErrorDebug"})};cb.onCompleteDebug=function(a){la.trace('Loading complete "'+a+'"',{fileName:"utils/Loader.hx",lineNumber:19,className:"utils.Loader",methodName:"onCompleteDebug"})};var Vb=y["utils._MultipassTemplate.TemplateExpr"]={__ename__:!0,__constructs__:null,OpVar:(h=function(a){return{_hx_index:0,v:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},
h._hx_name="OpVar",h.__params__=["v"],h),OpExpr:(h=function(a){return{_hx_index:1,expr:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},h._hx_name="OpExpr",h.__params__=["expr"],h),OpIf:(h=function(a,b,c){return{_hx_index:2,expr:a,eif:b,eelse:c,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},h._hx_name="OpIf",h.__params__=["expr","eif","eelse"],h),OpStr:(h=function(a){return{_hx_index:3,str:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},h._hx_name="OpStr",
h.__params__=["str"],h),OpBlock:(h=function(a){return{_hx_index:4,l:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},h._hx_name="OpBlock",h.__params__=["l"],h),OpForeach:(h=function(a,b){return{_hx_index:5,expr:a,loop:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},h._hx_name="OpForeach",h.__params__=["expr","loop"],h),OpMacro:(h=function(a,b){return{_hx_index:6,name:a,params:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},h._hx_name="OpMacro",h.__params__=
["name","params"],h)};Vb.__constructs__=[Vb.OpVar,Vb.OpExpr,Vb.OpIf,Vb.OpStr,Vb.OpBlock,Vb.OpForeach,Vb.OpMacro];var Ca=function(a){a=this.parseTokens(a);this.expr=this.parseBlock(a);if(!a.isEmpty())throw z.thrown("Unexpected '"+p.string(a.first().s)+"'");};d["utils.MultipassTemplate"]=Ca;Ca.__name__=!0;Ca.prototype={execute:function(a,b){this.macros=null==b?{}:b;this.context=a;this.stack=new yb;this.buf=new A;this.run(this.expr);return this.buf.b},resolve:function(a){if("__current__"==a)return this.context;
var b=C.getProperty(this.context,a);if(null!=b||Object.prototype.hasOwnProperty.call(this.context,a))return b;for(var c=this.stack.h;null!=c;){b=c.item;c=c.next;var e=b;b=C.getProperty(e,a);if(null!=b||Object.prototype.hasOwnProperty.call(e,a))return b}if(!Object.prototype.hasOwnProperty.call(Ca.globals,a))throw z.thrown(a);return C.field(Ca.globals,a)},parseTokens:function(a){for(var b=new yb;Ca.splitter.match(a);){var c=Ca.splitter.matchedPos();0<c.pos&&b.add({p:K.substr(a,0,c.pos),s:!0,l:null});
if(58==K.cca(a,c.pos))b.add({p:K.substr(a,c.pos+2,c.len-4),s:!1,l:null}),a=Ca.splitter.matchedRight();else{c=c.pos+c.len;for(var e=1,d=[],f="";;){var h=K.cca(a,c);++c;if(40==h)++e;else if(41==h){if(--e,0>=e)break}else if(null==h)throw z.thrown("Unclosed macro parenthesis");44==h&&1==e?(d.push(f),f=""):f+=String.fromCodePoint(h)}d.push(f);b.add({p:Ca.splitter.matched(2),s:!1,l:d});a=K.substr(a,c,a.length-c)}}0<a.length&&b.add({p:a,s:!0,l:null});return b},parseBlock:function(a){for(var b=new yb;;){var c=
a.first();if(null==c)break;if(!c.s&&("end"==c.p||"else"==c.p||"elseif "==K.substr(c.p,0,7)))break;b.add(this.parse(a))}return 1==b.length?b.first():Vb.OpBlock(b)},parse:function(a){var b=a.pop(),c=b.p;if(b.s)return Vb.OpStr(c);if(null!=b.l){a=new yb;var e=0;for(b=b.l;e<b.length;){var d=b[e];++e;a.add(this.parseBlock(this.parseTokens(d)))}return Vb.OpMacro(c,a)}if("if "==K.substr(c,0,3)){c=K.substr(c,3,c.length-3);e=null;try{e=this.parseExpr(c)}catch(l){ja.lastError=l;b=z.caught(l).unwrap();if("string"==
typeof b)throw la.trace(b,{fileName:"utils/MultipassTemplate.hx",lineNumber:211,className:"utils.MultipassTemplate",methodName:"parse"}),z.thrown(b);throw l;}c=this.parseBlock(a);b=a.first();if(null==b)throw z.thrown("Unclosed 'if'");if("end"==b.p)a.pop(),d=null;else if("else"==b.p){if(a.pop(),d=this.parseBlock(a),b=a.pop(),null==b||"end"!=b.p)throw z.thrown("Unclosed 'else'");}else b.p=K.substr(b.p,4,b.p.length-4),d=this.parse(a);return Vb.OpIf(e,c,d)}if("foreach "==K.substr(c,0,8)){c=K.substr(c,
8,c.length-8);e=this.parseExpr(c);c=this.parseBlock(a);b=a.pop();if(null==b||"end"!=b.p)throw z.thrown("Unclosed 'foreach'");return Vb.OpForeach(e,c)}return Ca.expr_splitter.match(c)?Vb.OpExpr(this.parseExpr(c)):Vb.OpVar(c)},parseExpr:function(a){for(var b=new yb,c=a;Ca.expr_splitter.match(a);){var e=Ca.expr_splitter.matchedPos();0!=e.pos&&b.add({p:K.substr(a,0,e.pos),s:!0});a=Ca.expr_splitter.matched(0);b.add({p:a,s:0<=a.indexOf('"')});a=Ca.expr_splitter.matchedRight()}0!=a.length&&b.add({p:a,s:!0});
try{var d=this.makeExpr(b);if(!b.isEmpty())throw z.thrown(b.first().p);}catch(l){ja.lastError=l;b=z.caught(l).unwrap();if("string"==typeof b)throw z.thrown("Unexpected '"+b+"' in "+c);throw l;}return function(){try{return d()}catch(x){ja.lastError=x;var a=z.caught(x).unwrap();throw z.thrown({v:a,expr:c});}}},makeConst:function(a){Ca.expr_trim.match(a);a=Ca.expr_trim.matched(1);if(34==K.cca(a,0)){var b=K.substr(a,1,a.length-2);return function(){return b}}if(Ca.expr_int.match(a)){var c=p.parseInt(a);
return function(){return c}}if(Ca.expr_float.match(a)){var e=parseFloat(a);return function(){return e}}var d=this;return function(){return d.resolve(a)}},makePath:function(a,b){var c=b.first();if(null==c||"."!=c.p)return a;b.pop();c=b.pop();if(null==c||!c.s)throw z.thrown(c.p);var e=c.p;Ca.expr_trim.match(e);e=Ca.expr_trim.matched(1);return this.makePath(function(){return C.field(a(),e)},b)},makeExpr:function(a){return this.makePath(this.makeExpr2(a),a)},makeExpr2:function(a){var b=a.pop();if(null==
b)throw z.thrown("<eof>");if(b.s)return this.makeConst(b.p);switch(b.p){case "!":var c=this.makeExpr(a);return function(){var a=c();return null!=a?0==a:!0};case "(":var e=this.makeExpr(a);b=a.pop();if(null==b||b.s)throw z.thrown(b);if(")"==b.p)return e;var d=this.makeExpr(a);a=a.pop();if(null==a||")"!=a.p)throw z.thrown(a);switch(b.p){case "!=":return function(){return e()!=d()};case "&&":return function(){return e()&&d()};case "*":return function(){return e()*d()};case "+":return function(){return e()+
d()};case "-":return function(){return e()-d()};case "/":return function(){return e()/d()};case "<":return function(){return e()<d()};case "<=":return function(){return e()<=d()};case "==":return function(){return e()==d()};case ">":return function(){return e()>d()};case ">=":return function(){return e()>=d()};case "||":return function(){return e()||d()};default:throw z.thrown("Unknown operation "+b.p);}case "-":var f=this.makeExpr(a);return function(){return-f()}}throw z.thrown(b.p);},run:function(a){switch(a._hx_index){case 0:var b=
a.v;try{var c=this.buf,e=p.string(this.resolve(b));c.b+=p.string(e)}catch(qc){ja.lastError=qc,this.buf.b+=p.string("::"+b+"::")}break;case 1:var d=a.expr;try{c=this.buf,e=p.string(d()),c.b+=p.string(e)}catch(qc){ja.lastError=qc,b=z.caught(qc).unwrap(),this.buf.b+=p.string("::("+p.string(b.expr)+")::")}break;case 2:d=a.expr;e=a.eif;c=a.eelse;try{b=d(),null==b||0==b?null!=c&&this.run(c):this.run(e)}catch(qc){ja.lastError=qc,b=z.caught(qc).unwrap(),this.buf.b+=p.string("::if "+p.string(b.expr)+"::"),
this.run(e),null!=c&&(this.buf.b+="::else::",this.run(c)),this.buf.b+="::end::"}break;case 3:b=a.str;this.buf.b+=null==b?"null":""+b;break;case 4:for(a=a.l.h;null!=a;){var h=a.item;a=a.next;d=h;this.run(d)}break;case 5:d=a.expr;c=a.loop;try{b=d();try{e=I(b);if(null==e.hasNext)throw z.thrown(null);b=e}catch(qc){ja.lastError=qc;try{if(null==b.hasNext)throw z.thrown(null);}catch(We){throw z.thrown("Cannot iter on "+p.string(b));}}for(this.stack.push(this.context);b.hasNext();)this.context=b.next(),this.run(c);
this.context=this.stack.pop()}catch(qc){ja.lastError=qc,b=z.caught(qc).unwrap(),this.buf.b+=p.string("::foreach "+p.string(b.v)+"::"),this.run(c),this.buf.b+="::end::"}break;case 6:d=a.name;a=a.params;b=C.field(this.macros,d);var q=[],m=this.buf;q.push(f(this,this.resolve));for(a=a.h;null!=a;)h=a.item,a=a.next,0==h._hx_index?(h=h.v,q.push(this.resolve(h))):(this.buf=new A,this.run(h),q.push(this.buf.b));this.buf=m;try{c=this.buf,e=p.string(b.apply(this.macros,q)),c.b+=p.string(e)}catch(qc){ja.lastError=
qc;a=z.caught(qc).unwrap();try{var n=q.join(",")}catch(We){n="???"}b="Macro call "+d+"("+n+") failed ("+p.string(a)+")";throw z.thrown(b);}}},__class__:Ca};v.$haxeUID|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(K.now=performance.now.bind(performance));d.Math=Math;null==String.fromCodePoint&&(String.fromCodePoint=function(a){return 65536>a?String.fromCharCode(a):String.fromCharCode((a>>10)+55232)+String.fromCharCode((a&1023)+56320)});String.prototype.__class__=d.String=
String;String.__name__=!0;d.Array=Array;Array.__name__=!0;Date.prototype.__class__=d.Date=Date;Date.__name__="Date";var $e={},Ye={},Ze=Number,Xe=Boolean,af={},bf={};xb.count=0;ua.__toStr={}.toString;var Te=new Uint32Array(256);Tb.__alpha16=Te;for(var Mc=0;256>Mc;){var zd=Mc++;Tb.__alpha16[zd]=Math.ceil(257.00392156862745*zd)}Te=new Uint8Array(511);Tb.__clamp=Te;for(Mc=0;255>Mc;)zd=Mc++,Tb.__clamp[zd]=zd;for(Mc=255;511>Mc;)zd=Mc++,Tb.__clamp[zd]=255;Ga.level=3;"undefined"==typeof console&&(console=
{});null==console.log&&(console.log=function(){});U.default_mass=-1;U.minimum_mass=1E-4;U.ids=0;fa.qr=[];fa.sqr=[];Y.cached_listeners=new Fb;Y.cached_collisions=[];Y.cached_body=new U({mass:1});Mb.pool=new Oc(Mb);ac.global=new ac(null,null,null,null,null);yc.pool=new Ad(yc);sc.pool=new ed(sc);Qb.pool=new fd(Qb);ob.pool=new Bd(ob);Lb.pool=new Ec(Lb);Qa.pool=new gd(Qa);Ib.pool=new Pc(Ib);eb.pool=new Fc(eb);La.pool=new hd(La);ta.norm=new O(0,0);ta.closest=new O(0,0);Jb.DEFAULT_RESOLVER=new Ed;Jb.BASE64=
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";db.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1];db.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];db.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1];db.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];db.CODE_LENGTHS_POS=
[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];R.activeRequests=0;R.requestLimit=17;R.requestQueue=new yb;Yc.windowID=0;hc.DICTIONARY="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");hc.EXTENDED_DICTIONARY=function(a){a=[];for(var b=0,c=hc.DICTIONARY;b<c.length;){var e=c[b];++b;for(var d=0,f=hc.DICTIONARY;d<f.length;){var h=f[d];++d;a.push(e+h)}}return a}(this);jc.sensorByID=new Kb;jc.sensors=[];Ta.devices=new Kb;Ta.onConnect=new ze;fb.devices=new Kb;fb.onConnect=new Ae;
Bb.onCancel=new Kc;Bb.onEnd=new Kc;Bb.onMove=new Kc;Bb.onStart=new Kc;ba.cache=new De;ba.onChange=new ab;ba.bundlePaths=new T;ba.libraries=new T;ba.libraryPaths=new T;Ga.throwErrors=!0;W.isES3=!1;W.isUBO=!1;W.isINSTANCED=!1;W.isVAO=!1;Ea.VertexFloat={high:0,medium:0,low:0};Ea.VertexInt={high:0,medium:0,low:0};Ea.VertexSampler={high:0,medium:0,low:0};Ea.FragmentFloat={high:0,medium:0,low:0};Ea.FragmentInt={high:0,medium:0,low:0};Ea.FragmentSampler={high:0,medium:0,low:0};Ha.rEmptylines=new Z("([ \t]*\r?\n)+",
"g");Ha.rStartspaces=new Z("^([ \t]*\r?\n)+","g");va.__meta__={fields:{px_offset:{pivotX:null,formula:["w * 0.5 + px_offset"]},py_offset:{pivotY:null,formula:["h * 0.5 + py_offset"]},rotation:{rotation:null},w:{sizeX:null,varying:null},h:{sizeY:null,varying:null},color:{color:null},x:{posX:null,set:["Position"]},y:{posY:null,set:["Position"]},sides:{custom:null,varying:null},shape:{custom:null,varying:null}}};va.InjectFragment="\n    #define PI 3.14159265359\n    #define TWO_PI 6.28318530718\n    \n    // from the book of shaders https://thebookofshaders.com/07/\n\t// only triangle is correct at the moment\n\t// todo ! calculate r for n sided polygons\n\t// or use vertices data from echo shape\n    vec4 polygon(vec4 c, float sides){\n        // Remap the coord for\n        vec2 coord = vTexCoord;\n        coord.y = (1.0 - coord.y);\n\n        // Remap the space to -1. to 1.\n        vec2 st = coord * 2.0-1.0;\n\n        // Angle and radius from the current pixel\n        float r = TWO_PI/sides;\n        float a = atan(st.x,st.y) + PI;\n\n        // Shaping function that modulate the distance\n        float d = cos(floor(.5+a/r)*r-a)*length(st);\n        float A = 1.0-smoothstep(.5,.51,d) == 1.0 ? c.a : 0.0;\n        return vec4(c.rgb, A);\n    }\n\n    // // https://github.com/ayamflow/glsl-2d-primitives/blob/master/polygon.glsl\n    // vec4 polygon(vec4 c, float sides){\n    //     vec2 st = vTexCoord * 2.0 - 1.0;\n    //     st.y  = (1.0 - st.y);\n    //     float angle = atan(st.x,st.y) + PI;\n    //     float slice = TWO_PI / sides;\n    //     // float radius = 0.4;\n    //     float radius = 0.5;//1.0;//0.7;//sides / 10.0;\n    //     // float x = vSize.x; \n    //     // float radius = 1.0 / cos(x) * (180.0 / sides);\n    //     float s = step(radius, cos(floor(0.5 + angle / slice ) * slice - angle) * length(st));\n    //     float A = 1.0 - s == 1.0 ? c.a : 0.0;\n    //     return vec4(c.rgb, A);\n    // }\n\n    float circle(vec2 st, float radius)\n    {\n        vec2 dist = st-vec2(0.5);\n        return 1.-smoothstep(radius-(radius*0.01),\n                             radius+(radius*0.01),\n                             dot(dist,dist)*4.0\n                            );\n    }\n\n    vec4 compose(vec4 c, float shapeType, float numSides){\n        // return vec4(0.8,0.8,0.8,1.0);\n        if(shapeType <= 0.0 ){\n            return c;\n        }\n        // circle\n        if(shapeType == 1.0){\n            float a = circle(vTexCoord, 1.0) == 1.0 ? c.a : 0.0;\n\t\t\treturn vec4(c.rgb, a);\n        }\n        // polygon\n        return polygon(c, numSides);\n    }\n    ";
va.ColorFormula="compose(color, shape, sides)";va.FORMULAS=function(a){a=new T;a.h.py_offset="h * 0.5 + py_offset";a.h.px_offset="w * 0.5 + px_offset";return a}(this);va.ATTRIBUTES=function(a){a=new T;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.sidesStart="aFloat0.x";a.h.sidesEnd="aFloat0.x";a.h.sides="aFloat0.x";a.h.shapeStart="aFloat0.y";a.h.shapeEnd="aFloat0.y";a.h.shape="aFloat0.y";
a.h.rotationStart="aRotZ";a.h.rotationEnd="aRotZ";a.h.rotation="aRotZ";a.h.py_offsetStart="aPivot.y";a.h.py_offsetEnd="aPivot.y";a.h.py_offset="aPivot.y";a.h.px_offsetStart="aPivot.x";a.h.px_offsetEnd="aPivot.x";a.h.px_offset="aPivot.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);va.FORMULA_NAMES=function(a){a=new T;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.rotation="rotation";a.h.pivotX="px_offset";a.h.pivotY="py_offset";return a}(this);va.FORMULA_VARYINGS=
"sides,shape";va.FORMULA_CONSTANTS="";va.DEFAULT_FORMULA_VARS=new T;oa.__meta__={fields:{px_offset:{pivotX:null},py_offset:{pivotY:null},rotation:{rotation:null},w:{sizeX:null,varying:null},h:{sizeY:null,varying:null},color:{color:null},x:{posX:null,set:["Position"]},y:{posY:null,set:["Position"]},sides:{custom:null,varying:null},shape:{custom:null,varying:null}}};oa.FORMULAS=new T;oa.ATTRIBUTES=function(a){a=new T;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd=
"aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.sidesStart="aFloat0.x";a.h.sidesEnd="aFloat0.x";a.h.sides="aFloat0.x";a.h.shapeStart="aFloat0.y";a.h.shapeEnd="aFloat0.y";a.h.shape="aFloat0.y";a.h.rotationStart="aRotZ";a.h.rotationEnd="aRotZ";a.h.rotation="aRotZ";a.h.py_offsetStart="aPivot.y";a.h.py_offsetEnd="aPivot.y";a.h.py_offset="aPivot.y";a.h.px_offsetStart="aPivot.x";a.h.px_offsetEnd="aPivot.x";a.h.px_offset="aPivot.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";
a.h.h="aSize.y";return a}(this);oa.FORMULA_NAMES=function(a){a=new T;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.rotation="rotation";a.h.pivotX="px_offset";a.h.pivotY="py_offset";return a}(this);oa.FORMULA_VARYINGS="sides,shape";oa.FORMULA_CONSTANTS="";oa.DEFAULT_FORMULA_VARS=new T;sa.__meta__={fields:{x:{posX:null},y:{posY:null},w:{sizeX:null},h:{sizeY:null}}};sa.FORMULAS=new T;sa.ATTRIBUTES=function(a){a=new T;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";
a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);sa.FORMULA_NAMES=function(a){a=new T;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";return a}(this);sa.FORMULA_VARYINGS="";sa.FORMULA_CONSTANTS="";sa.DEFAULT_FORMULA_VARS=new T;cb.corsServer="";Ca.splitter=new Z('(::[A-Za-z0-9_ ()&|!+=/><*."-]+::|\\$\\$([A-Za-z0-9_-]+)\\()',"");Ca.expr_splitter=new Z('(\\(|\\)|[ \r\n\t]*"[^"]*"[ \r\n\t]*|[!+=/><*.&|-]+)',
"");Ca.expr_trim=new Z("^[ ]*([^ ]+)[ ]*$","");Ca.expr_int=new Z("^[0-9]+$","");Ca.expr_float=new Z("^([+-]?)(?=\\d|,\\d)\\d*(,\\d*)?([Ee]([+-]?\\d+))?$","");Ca.globals={};H.main()})("undefined"!=typeof k?k:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof u?u:"undefined"!=typeof self?self:this)};H.lime.embed=function(v){var u={},t=H.lime.$scripts[v];if(!t)throw Error('Cannot find project name "'+v+'"');t(u,k);for(var F in u)H[F]=
H[F]||u[F];(t=u.lime||window.lime)&&t.embed&&this!=t.embed&&t.embed.apply(t,arguments);return u};"function"==typeof define&&define.amd&&(define([],function(){return H.lime}),define.__amd=define.amd,define.amd=null)})("undefined"!=typeof exports?exports:"function"==typeof define&&define.amd?{}:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
!function(){var H=function(){this.init()};H.prototype={init:function(){var f=this||k;return f._counter=1E3,f._html5AudioPool=[],f.html5PoolSize=10,f._codecs={},f._howls=[],f._muted=!1,f._volume=1,f._canPlayEvent="canplaythrough",f._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,f.masterGain=null,f.noAudio=!1,f.usingWebAudio=!0,f.autoSuspend=!0,f.ctx=null,f.autoUnlock=!0,f._setup(),f},volume:function(f){var d=this||k;if(f=parseFloat(f),d.ctx||I(),void 0!==f&&0<=f&&1>=
f){if(d._volume=f,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(f,k.ctx.currentTime);for(var n=0;n<d._howls.length;n++)if(!d._howls[n]._webAudio)for(var y=d._howls[n]._getSoundIds(),h=0;h<y.length;h++){var J=d._howls[n]._soundById(y[h]);J&&J._node&&(J._node.volume=J._volume*f)}return d}return d._volume},mute:function(f){var d=this||k;d.ctx||I();d._muted=f;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(f?0:d._volume,k.ctx.currentTime);for(var n=0;n<d._howls.length;n++)if(!d._howls[n]._webAudio)for(var y=
d._howls[n]._getSoundIds(),h=0;h<y.length;h++){var J=d._howls[n]._soundById(y[h]);J&&J._node&&(J._node.muted=!!f||J._muted)}return d},unload:function(){for(var f=this||k,d=f._howls.length-1;0<=d;d--)f._howls[d].unload();return f.usingWebAudio&&f.ctx&&void 0!==f.ctx.close&&(f.ctx.close(),f.ctx=null,I()),f},codecs:function(f){return(this||k)._codecs[f.replace(/^x-/,"")]},_setup:function(){var f=this||k;if(f.state=f.ctx?f.ctx.state||"suspended":"suspended",f._autoSuspend(),!f.usingWebAudio)if("undefined"!=
typeof Audio)try{var d=new Audio;void 0===d.oncanplaythrough&&(f._canPlayEvent="canplay")}catch(n){f.noAudio=!0}else f.noAudio=!0;try{d=new Audio,d.muted&&(f.noAudio=!0)}catch(n){}return f.noAudio||f._setupCodecs(),f},_setupCodecs:function(){var f=this||k,d=null;try{d="undefined"!=typeof Audio?new Audio:null}catch(h){return f}if(!d||"function"!=typeof d.canPlayType)return f;var n=d.canPlayType("audio/mpeg;").replace(/^no$/,""),y=f._navigator&&f._navigator.userAgent.match(/OPR\/([0-6].)/g);y=y&&33>
parseInt(y[0].split("/")[1],10);return f._codecs={mp3:!(y||!n&&!d.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!d.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||
d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},f},_unlockAudio:function(){var f=
this||k,d=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome|Safari/i.test(f._navigator&&f._navigator.userAgent);if(!f._audioUnlocked&&f.ctx&&d){f._audioUnlocked=!1;f.autoUnlock=!1;f._mobileUnloaded||44100===f.ctx.sampleRate||(f._mobileUnloaded=!0,f.unload());f._scratchBuffer=f.ctx.createBuffer(1,1,22050);var n=function(d){for(d=0;d<f.html5PoolSize;d++){var h=new Audio;h._unlocked=!0;f._releaseHtml5Audio(h)}for(d=0;d<f._howls.length;d++)if(!f._howls[d]._webAudio){h=f._howls[d]._getSoundIds();
for(var k=0;k<h.length;k++){var y=f._howls[d]._soundById(h[k]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}}f._autoResume();var u=f.ctx.createBufferSource();u.buffer=f._scratchBuffer;u.connect(f.ctx.destination);void 0===u.start?u.noteOn(0):u.start(0);"function"==typeof f.ctx.resume&&f.ctx.resume();u.onended=function(){u.disconnect(0);f._audioUnlocked=!0;document.removeEventListener("touchstart",n,!0);document.removeEventListener("touchend",n,!0);document.removeEventListener("click",
n,!0);for(var d=0;d<f._howls.length;d++)f._howls[d]._emit("unlock")}};return document.addEventListener("touchstart",n,!0),document.addEventListener("touchend",n,!0),document.addEventListener("click",n,!0),f}},_obtainHtml5Audio:function(){var f=this||k;if(f._html5AudioPool.length)return f._html5AudioPool.pop();f=(new Audio).play();return f&&"undefined"!=typeof Promise&&(f instanceof Promise||"function"==typeof f.then)&&f.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),
new Audio},_releaseHtml5Audio:function(f){var d=this||k;return f._unlocked&&d._html5AudioPool.push(f),d},_autoSuspend:function(){var f=this;if(f.autoSuspend&&f.ctx&&void 0!==f.ctx.suspend&&k.usingWebAudio){for(var d=0;d<f._howls.length;d++)if(f._howls[d]._webAudio)for(var n=0;n<f._howls[d]._sounds.length;n++)if(!f._howls[d]._sounds[n]._paused)return f;return f._suspendTimer&&clearTimeout(f._suspendTimer),f._suspendTimer=setTimeout(function(){f.autoSuspend&&(f._suspendTimer=null,f.state="suspending",
f.ctx.suspend().then(function(){f.state="suspended";f._resumeAfterSuspend&&(delete f._resumeAfterSuspend,f._autoResume())}))},3E4),f}},_autoResume:function(){var f=this;if(f.ctx&&void 0!==f.ctx.resume&&k.usingWebAudio)return"running"===f.state&&f._suspendTimer?(clearTimeout(f._suspendTimer),f._suspendTimer=null):"suspended"===f.state?(f.ctx.resume().then(function(){f.state="running";for(var d=0;d<f._howls.length;d++)f._howls[d]._emit("resume")}),f._suspendTimer&&(clearTimeout(f._suspendTimer),f._suspendTimer=
null)):"suspending"===f.state&&(f._resumeAfterSuspend=!0),f}};var k=new H,v=function(f){if(!f.src||0===f.src.length)return void console.error("An array of source files must be passed with any new Howl.");this.init(f)};v.prototype={init:function(f){var d=this;return k.ctx||I(),d._autoplay=f.autoplay||!1,d._format="string"!=typeof f.format?f.format:[f.format],d._html5=f.html5||!1,d._muted=f.mute||!1,d._loop=f.loop||!1,d._pool=f.pool||5,d._preload="boolean"!=typeof f.preload||f.preload,d._rate=f.rate||
1,d._sprite=f.sprite||{},d._src="string"!=typeof f.src?f.src:[f.src],d._volume=void 0!==f.volume?f.volume:1,d._xhrWithCredentials=f.xhrWithCredentials||!1,d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=f.onend?[{fn:f.onend}]:[],d._onfade=f.onfade?[{fn:f.onfade}]:[],d._onload=f.onload?[{fn:f.onload}]:[],d._onloaderror=f.onloaderror?[{fn:f.onloaderror}]:[],d._onplayerror=f.onplayerror?[{fn:f.onplayerror}]:[],d._onpause=f.onpause?[{fn:f.onpause}]:[],
d._onplay=f.onplay?[{fn:f.onplay}]:[],d._onstop=f.onstop?[{fn:f.onstop}]:[],d._onmute=f.onmute?[{fn:f.onmute}]:[],d._onvolume=f.onvolume?[{fn:f.onvolume}]:[],d._onrate=f.onrate?[{fn:f.onrate}]:[],d._onseek=f.onseek?[{fn:f.onseek}]:[],d._onunlock=f.onunlock?[{fn:f.onunlock}]:[],d._onresume=[],d._webAudio=k.usingWebAudio&&!d._html5,void 0!==k.ctx&&k.ctx&&k.autoUnlock&&k._unlockAudio(),k._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d.load(),d},load:function(){var f=
null;if(k.noAudio)return void this._emit("loaderror",null,"No audio support.");"string"==typeof this._src&&(this._src=[this._src]);for(var d=0;d<this._src.length;d++){var n;if(this._format&&this._format[d])var y=this._format[d];else{if("string"!=typeof(n=this._src[d])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(y=/^data:audio\/([^;,]+);/i.exec(n))||(y=/\.([^.]+)$/.exec(n.split("?",1)[0]));y&&(y=y[1].toLowerCase())}if(y||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),
y&&k.codecs(y)){f=this._src[d];break}}return f?(this._src=f,this._state="loading","https:"===window.location.protocol&&"http:"===f.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new u(this),this._webAudio&&F(this),this):void this._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(f,d){var n=this,y=null;if("number"==typeof f)y=f,f=null;else{if("string"==typeof f&&"loaded"===n._state&&!n._sprite[f])return null;if(void 0===f&&(f="__default",!n._playLock)){for(var h=
0,u=0;u<n._sounds.length;u++)n._sounds[u]._paused&&!n._sounds[u]._ended&&(h++,y=n._sounds[u]._id);1===h?f=null:y=null}}var t=y?n._soundById(y):n._inactiveSound();if(!t)return null;if(y&&!f&&(f=t._sprite||"__default"),"loaded"!==n._state){t._sprite=f;t._ended=!1;var v=t._id;return n._queue.push({event:"play",action:function(){n.play(v)}}),v}if(y&&!t._paused)return d||n._loadQueue("play"),t._id;n._webAudio&&k._autoResume();var B=Math.max(0,0<t._seek?t._seek:n._sprite[f][0]/1E3),I=Math.max(0,(n._sprite[f][0]+
n._sprite[f][1])/1E3-B),G=1E3*I/Math.abs(t._rate),F=n._sprite[f][0]/1E3,E=(n._sprite[f][0]+n._sprite[f][1])/1E3,M=!(!t._loop&&!n._sprite[f][2]);t._sprite=f;t._ended=!1;var N=function(){t._paused=!1;t._seek=B;t._start=F;t._stop=E;t._loop=M};if(B>=E)return void n._ended(t);var H=t._node;if(n._webAudio)y=function(){n._playLock=!1;N();n._refreshBuffer(t);H.gain.setValueAtTime(t._muted||n._muted?0:t._volume,k.ctx.currentTime);t._playStart=k.ctx.currentTime;void 0===H.bufferSource.start?t._loop?H.bufferSource.noteGrainOn(0,
B,86400):H.bufferSource.noteGrainOn(0,B,I):t._loop?H.bufferSource.start(0,B,86400):H.bufferSource.start(0,B,I);G!==1/0&&(n._endTimers[t._id]=setTimeout(n._ended.bind(n,t),G));d||setTimeout(function(){n._emit("play",t._id);n._loadQueue()},0)},"running"===k.state?y():(n._playLock=!0,n.once("resume",y),n._clearTimer(t._id));else{var S=function(){H.currentTime=B;H.muted=t._muted||n._muted||k._muted||H.muted;H.volume=t._volume*k.volume();H.playbackRate=t._rate;try{var h=H.play();if(h&&"undefined"!=typeof Promise&&
(h instanceof Promise||"function"==typeof h.then)?(n._playLock=!0,N(),h.then(function(){n._playLock=!1;H._unlocked=!0;d||(n._emit("play",t._id),n._loadQueue())}).catch(function(){n._playLock=!1;n._emit("playerror",t._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");t._ended=!0;t._paused=!0})):d||(n._playLock=!1,N(),n._emit("play",t._id),n._loadQueue()),H.playbackRate=t._rate,H.paused)return void n._emit("playerror",
t._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==f||t._loop?n._endTimers[t._id]=setTimeout(n._ended.bind(n,t),G):(n._endTimers[t._id]=function(){n._ended(t);H.removeEventListener("ended",n._endTimers[t._id],!1)},H.addEventListener("ended",n._endTimers[t._id],!1))}catch(Ja){n._emit("playerror",t._id,Ja)}};y=window&&window.ejecta||!H.readyState&&k._navigator.isCocoonJS;if(3<=H.readyState||
y)S();else{n._playLock=!0;var Q=function(){S();H.removeEventListener(k._canPlayEvent,Q,!1)};H.addEventListener(k._canPlayEvent,Q,!1);n._clearTimer(t._id)}}return t._id},pause:function(f,d){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"pause",action:function(){n.pause(f)}}),n;for(var k=n._getSoundIds(f),h=0;h<k.length;h++){n._clearTimer(k[h]);var t=n._soundById(k[h]);if(t&&!t._paused&&(t._seek=n.seek(k[h]),t._rateSeek=0,t._paused=!0,n._stopFade(k[h]),t._node))if(n._webAudio){if(!t._node.bufferSource)continue;
void 0===t._node.bufferSource.stop?t._node.bufferSource.noteOff(0):t._node.bufferSource.stop(0);n._cleanBuffer(t._node)}else isNaN(t._node.duration)&&t._node.duration!==1/0||t._node.pause();d||n._emit("pause",t?t._id:null)}return n},stop:function(f,d){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(f)}}),n;for(var k=n._getSoundIds(f),h=0;h<k.length;h++){n._clearTimer(k[h]);var t=n._soundById(k[h]);t&&(t._seek=t._start||0,t._rateSeek=0,t._paused=
!0,t._ended=!0,n._stopFade(k[h]),t._node&&(n._webAudio?t._node.bufferSource&&(void 0===t._node.bufferSource.stop?t._node.bufferSource.noteOff(0):t._node.bufferSource.stop(0),n._cleanBuffer(t._node)):isNaN(t._node.duration)&&t._node.duration!==1/0||(t._node.currentTime=t._start||0,t._node.pause())),d||n._emit("stop",t._id))}return n},mute:function(f,d){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(f,d)}}),n;if(void 0===d){if("boolean"!=typeof f)return n._muted;
n._muted=f}for(var t=n._getSoundIds(d),h=0;h<t.length;h++){var u=n._soundById(t[h]);u&&(u._muted=f,u._interval&&n._stopFade(u._id),n._webAudio&&u._node?u._node.gain.setValueAtTime(f?0:u._volume,k.ctx.currentTime):u._node&&(u._node.muted=!!k._muted||f),n._emit("mute",u._id))}return n},volume:function(){var f,d,n=this,t=arguments;if(0===t.length)return n._volume;1===t.length||2===t.length&&void 0===t[1]?0<=n._getSoundIds().indexOf(t[0])?d=parseInt(t[0],10):f=parseFloat(t[0]):2<=t.length&&(f=parseFloat(t[0]),
d=parseInt(t[1],10));var h;if(!(void 0!==f&&0<=f&&1>=f))return h=d?n._soundById(d):n._sounds[0],h?h._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,t)}}),n;void 0===d&&(n._volume=f);d=n._getSoundIds(d);for(var u=0;u<d.length;u++)(h=n._soundById(d[u]))&&(h._volume=f,t[2]||n._stopFade(d[u]),n._webAudio&&h._node&&!h._muted?h._node.gain.setValueAtTime(f,k.ctx.currentTime):h._node&&!h._muted&&(h._node.volume=f*k.volume()),n._emit("volume",
h._id));return n},fade:function(f,d,n,t){var h=this;if("loaded"!==h._state||h._playLock)return h._queue.push({event:"fade",action:function(){h.fade(f,d,n,t)}}),h;f=parseFloat(f);d=parseFloat(d);n=parseFloat(n);h.volume(f,t);for(var u=h._getSoundIds(t),y=0;y<u.length;y++){var B=h._soundById(u[y]);if(B){if(t||h._stopFade(u[y]),h._webAudio&&!B._muted){var v=k.ctx.currentTime,I=v+n/1E3;B._volume=f;B._node.gain.setValueAtTime(f,v);B._node.gain.linearRampToValueAtTime(d,I)}h._startFadeInterval(B,f,d,n,
u[y],void 0===t)}}return h},_startFadeInterval:function(f,d,n,k,h,t){var u=this,y=d,J=n-d;h=Math.abs(J/.01);h=Math.max(4,0<h?k/h:k);var B=Date.now();f._fadeTo=n;f._interval=setInterval(function(){var h=(Date.now()-B)/k;B=Date.now();y+=J*h;y=Math.max(0,y);y=Math.min(1,y);y=Math.round(100*y)/100;u._webAudio?f._volume=y:u.volume(y,f._id,!0);t&&(u._volume=y);(n<d&&y<=n||n>d&&y>=n)&&(clearInterval(f._interval),f._interval=null,f._fadeTo=null,u.volume(n,f._id),u._emit("fade",f._id))},h)},_stopFade:function(f){var d=
this._soundById(f);return d&&d._interval&&(this._webAudio&&d._node.gain.cancelScheduledValues(k.ctx.currentTime),clearInterval(d._interval),d._interval=null,this.volume(d._fadeTo,f),d._fadeTo=null,this._emit("fade",f)),this},loop:function(){var f,d,n,k=arguments;if(0===k.length)return this._loop;if(1===k.length){if("boolean"!=typeof k[0])return!!(n=this._soundById(parseInt(k[0],10)))&&n._loop;this._loop=f=k[0]}else 2===k.length&&(f=k[0],d=parseInt(k[1],10));d=this._getSoundIds(d);for(k=0;k<d.length;k++)(n=
this._soundById(d[k]))&&(n._loop=f,this._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=f,f&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return this},rate:function(){var f,d,n=this,t=arguments;0===t.length?d=n._sounds[0]._id:1===t.length?0<=n._getSoundIds().indexOf(t[0])?d=parseInt(t[0],10):f=parseFloat(t[0]):2===t.length&&(f=parseFloat(t[0]),d=parseInt(t[1],10));var h;if("number"!=typeof f)return h=n._soundById(d),h?h._rate:n._rate;if("loaded"!==
n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,t)}}),n;void 0===d&&(n._rate=f);d=n._getSoundIds(d);for(var u=0;u<d.length;u++)if(h=n._soundById(d[u])){n.playing(d[u])&&(h._rateSeek=n.seek(d[u]),h._playStart=n._webAudio?k.ctx.currentTime:h._playStart);h._rate=f;n._webAudio&&h._node&&h._node.bufferSource?h._node.bufferSource.playbackRate.setValueAtTime(f,k.ctx.currentTime):h._node&&(h._node.playbackRate=f);var B=n.seek(d[u]);B=1E3*((n._sprite[h._sprite][0]+
n._sprite[h._sprite][1])/1E3-B)/Math.abs(h._rate);!n._endTimers[d[u]]&&h._paused||(n._clearTimer(d[u]),n._endTimers[d[u]]=setTimeout(n._ended.bind(n,h),B));n._emit("rate",h._id)}return n},seek:function(){var f,d,n=this,t=arguments;0===t.length?d=n._sounds[0]._id:1===t.length?0<=n._getSoundIds().indexOf(t[0])?d=parseInt(t[0],10):n._sounds.length&&(d=n._sounds[0]._id,f=parseFloat(t[0])):2===t.length&&(f=parseFloat(t[0]),d=parseInt(t[1],10));if(void 0===d)return n;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"seek",
action:function(){n.seek.apply(n,t)}}),n;var h=n._soundById(d);if(h){if(!("number"==typeof f&&0<=f))return n._webAudio?(f=n.playing(d)?k.ctx.currentTime-h._playStart:0,h._seek+((h._rateSeek?h._rateSeek-h._seek:0)+f*Math.abs(h._rate))):h._node.currentTime;var u=n.playing(d);u&&n.pause(d,!0);h._seek=f;h._ended=!1;n._clearTimer(d);n._webAudio||!h._node||isNaN(h._node.duration)||(h._node.currentTime=f);var B=function(){n._emit("seek",d);u&&n.play(d,!0)};if(u&&!n._webAudio){var v=function(){n._playLock?
setTimeout(v,0):B()};setTimeout(v,0)}else B()}return n},playing:function(f){if("number"==typeof f)return f=this._soundById(f),!!f&&!f._paused;for(f=0;f<this._sounds.length;f++)if(!this._sounds[f]._paused)return!0;return!1},duration:function(f){var d=this._duration;f=this._soundById(f);return f&&(d=this._sprite[f._sprite][1]/1E3),d},state:function(){return this._state},unload:function(){for(var f=this._sounds,d=0;d<f.length;d++)(f[d]._paused||this.stop(f[d]._id),this._webAudio)||(/MSIE |Trident\//.test(k._navigator&&
k._navigator.userAgent)||(f[d]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),f[d]._node.removeEventListener("error",f[d]._errorFn,!1),f[d]._node.removeEventListener(k._canPlayEvent,f[d]._loadFn,!1),k._releaseHtml5Audio(f[d]._node)),delete f[d]._node,this._clearTimer(f[d]._id);d=k._howls.indexOf(this);0<=d&&k._howls.splice(d,1);f=!0;for(d=0;d<k._howls.length;d++)if(k._howls[d]._src===this._src||0<=this._src.indexOf(k._howls[d]._src)){f=!1;break}return t&&
f&&delete t[this._src],k.noAudio=!1,this._state="unloaded",this._sounds=[],null},on:function(f,d,n,k){f=this["_on"+f];return"function"==typeof d&&f.push(k?{id:n,fn:d,once:k}:{id:n,fn:d}),this},off:function(f,d,n){var k=this["_on"+f];if("number"==typeof d&&(n=d,d=null),d||n)for(f=0;f<k.length;f++){var h=n===k[f].id;if(d===k[f].fn&&h||!d&&h){k.splice(f,1);break}}else if(f)this["_on"+f]=[];else for(d=Object.keys(this),f=0;f<d.length;f++)0===d[f].indexOf("_on")&&Array.isArray(this[d[f]])&&(this[d[f]]=
[]);return this},once:function(f,d,n){return this.on(f,d,n,1),this},_emit:function(f,d,n){for(var k=this["_on"+f],h=k.length-1;0<=h;h--)k[h].id&&k[h].id!==d&&"load"!==f||(setTimeout(function(f){f.call(this,d,n)}.bind(this,k[h].fn),0),k[h].once&&this.off(f,k[h].fn,k[h].id));return this._loadQueue(f),this},_loadQueue:function(f){if(0<this._queue.length){var d=this._queue[0];d.event===f&&(this._queue.shift(),this._loadQueue());f||d.action()}return this},_ended:function(f){var d=f._sprite;if(!this._webAudio&&
f._node&&!f._node.paused&&!f._node.ended&&f._node.currentTime<f._stop)return setTimeout(this._ended.bind(this,f),100),this;d=!(!f._loop&&!this._sprite[d][2]);if(this._emit("end",f._id),!this._webAudio&&d&&this.stop(f._id,!0).play(f._id),this._webAudio&&d){this._emit("play",f._id);f._seek=f._start||0;f._rateSeek=0;f._playStart=k.ctx.currentTime;var n=1E3*(f._stop-f._start)/Math.abs(f._rate);this._endTimers[f._id]=setTimeout(this._ended.bind(this,f),n)}return this._webAudio&&!d&&(f._paused=!0,f._ended=
!0,f._seek=f._start||0,f._rateSeek=0,this._clearTimer(f._id),this._cleanBuffer(f._node),k._autoSuspend()),this._webAudio||d||this.stop(f._id,!0),this},_clearTimer:function(f){if(this._endTimers[f]){if("function"!=typeof this._endTimers[f])clearTimeout(this._endTimers[f]);else{var d=this._soundById(f);d&&d._node&&d._node.removeEventListener("ended",this._endTimers[f],!1)}delete this._endTimers[f]}return this},_soundById:function(f){for(var d=0;d<this._sounds.length;d++)if(f===this._sounds[d]._id)return this._sounds[d];
return null},_inactiveSound:function(){this._drain();for(var f=0;f<this._sounds.length;f++)if(this._sounds[f]._ended)return this._sounds[f].reset();return new u(this)},_drain:function(){var f=this._pool,d=0,n;if(!(this._sounds.length<f)){for(n=0;n<this._sounds.length;n++)this._sounds[n]._ended&&d++;for(n=this._sounds.length-1;0<=n&&!(d<=f);n--)this._sounds[n]._ended&&(this._webAudio&&this._sounds[n]._node&&this._sounds[n]._node.disconnect(0),this._sounds.splice(n,1),d--)}},_getSoundIds:function(f){if(void 0===
f){f=[];for(var d=0;d<this._sounds.length;d++)f.push(this._sounds[d]._id);return f}return[f]},_refreshBuffer:function(f){return f._node.bufferSource=k.ctx.createBufferSource(),f._node.bufferSource.buffer=t[this._src],f._panner?f._node.bufferSource.connect(f._panner):f._node.bufferSource.connect(f._node),f._node.bufferSource.loop=f._loop,f._loop&&(f._node.bufferSource.loopStart=f._start||0,f._node.bufferSource.loopEnd=f._stop||0),f._node.bufferSource.playbackRate.setValueAtTime(f._rate,k.ctx.currentTime),
this},_cleanBuffer:function(f){var d=k._navigator&&0<=k._navigator.vendor.indexOf("Apple");if(k._scratchBuffer&&f.bufferSource&&(f.bufferSource.onended=null,f.bufferSource.disconnect(0),d))try{f.bufferSource.buffer=k._scratchBuffer}catch(n){}return f.bufferSource=null,this}};var u=function(f){this._parent=f;this.init()};u.prototype={init:function(){var f=this._parent;return this._muted=f._muted,this._loop=f._loop,this._volume=f._volume,this._rate=f._rate,this._seek=0,this._paused=!0,this._ended=!0,
this._sprite="__default",this._id=++k._counter,f._sounds.push(this),this.create(),this},create:function(){var f=this._parent,d=k._muted||this._muted||this._parent._muted?0:this._volume;return f._webAudio?(this._node=void 0===k.ctx.createGain?k.ctx.createGainNode():k.ctx.createGain(),this._node.gain.setValueAtTime(d,k.ctx.currentTime),this._node.paused=!0,this._node.connect(k.masterGain)):(this._node=k._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",
this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(k._canPlayEvent,this._loadFn,!1),this._node.src=f._src,this._node.preload="auto",this._node.volume=d*k.volume(),this._node.load()),this},reset:function(){var f=this._parent;return this._muted=f._muted,this._loop=f._loop,this._volume=f._volume,this._rate=f._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++k._counter,this},_errorListener:function(){this._parent._emit("loaderror",
this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var f=this._parent;f._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(f._sprite).length&&(f._sprite={__default:[0,1E3*f._duration]});"loaded"!==f._state&&(f._state="loaded",f._emit("load"),f._loadQueue());this._node.removeEventListener(k._canPlayEvent,this._loadFn,!1)}};var t={},F=function(f){var d=f._src;if(t[d])return f._duration=t[d].duration,void G(f);
if(/^data:[^;]+;base64,/.test(d)){for(var n=atob(d.split(",")[1]),k=new Uint8Array(n.length),h=0;h<n.length;++h)k[h]=n.charCodeAt(h);M(k.buffer,f)}else{var u=new XMLHttpRequest;u.open("GET",d,!0);u.withCredentials=f._xhrWithCredentials;u.responseType="arraybuffer";u.onload=function(){var d=(u.status+"")[0];if("0"!==d&&"2"!==d&&"3"!==d)return void f._emit("loaderror",null,"Failed loading audio file with status: "+u.status+".");M(u.response,f)};u.onerror=function(){f._webAudio&&(f._html5=!0,f._webAudio=
!1,f._sounds=[],delete t[d],f.load())};B(u)}},B=function(f){try{f.send()}catch(d){f.onerror()}},M=function(f,d){var n=function(){d._emit("loaderror",null,"Decoding audio data failed.")},u=function(f){f&&0<d._sounds.length?(t[d._src]=f,G(d,f)):n()};"undefined"!=typeof Promise&&1===k.ctx.decodeAudioData.length?k.ctx.decodeAudioData(f).then(u).catch(n):k.ctx.decodeAudioData(f,u,n)},G=function(f,d){d&&!f._duration&&(f._duration=d.duration);0===Object.keys(f._sprite).length&&(f._sprite={__default:[0,1E3*
f._duration]});"loaded"!==f._state&&(f._state="loaded",f._emit("load"),f._loadQueue())},I=function(){if(k.usingWebAudio){try{"undefined"!=typeof AudioContext?k.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?k.ctx=new webkitAudioContext:k.usingWebAudio=!1}catch(n){k.usingWebAudio=!1}k.ctx||(k.usingWebAudio=!1);var f=/iP(hone|od|ad)/.test(k._navigator&&k._navigator.platform),d=k._navigator&&k._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);d=d?parseInt(d[1],10):null;f&&d&&9>d&&(f=
/safari/.test(k._navigator&&k._navigator.userAgent.toLowerCase()),(k._navigator&&k._navigator.standalone&&!f||k._navigator&&!k._navigator.standalone&&!f)&&(k.usingWebAudio=!1));k.usingWebAudio&&(k.masterGain=void 0===k.ctx.createGain?k.ctx.createGainNode():k.ctx.createGain(),k.masterGain.gain.setValueAtTime(k._muted?0:1,k.ctx.currentTime),k.masterGain.connect(k.ctx.destination));k._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:k,Howl:v}});"undefined"!=typeof exports&&
(exports.Howler=k,exports.Howl=v);"undefined"!=typeof window?(window.HowlerGlobal=H,window.Howler=k,window.Howl=v,window.Sound=u):"undefined"!=typeof global&&(global.HowlerGlobal=H,global.Howler=k,global.Howl=v,global.Sound=u)}();
!function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(k){if(!this.ctx||!this.ctx.listener)return this;for(var v=this._howls.length-1;0<=v;v--)this._howls[v].stereo(k);return this};HowlerGlobal.prototype.pos=function(k,v,u){return this.ctx&&this.ctx.listener?(v="number"!=typeof v?this._pos[1]:v,u="number"!=typeof u?this._pos[2]:u,"number"!=typeof k?this._pos:(this._pos=[k,v,u],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],
Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this};HowlerGlobal.prototype.orientation=function(k,v,u,t,F,B){if(!this.ctx||!this.ctx.listener)return this;var H=this._orientation;return v="number"!=typeof v?H[1]:v,u="number"!=typeof u?H[2]:u,t="number"!=typeof t?H[3]:t,F="number"!=
typeof F?H[4]:F,B="number"!=typeof B?H[5]:B,"number"!=typeof k?H:(this._orientation=[k,v,u,t,F,B],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(k,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(v,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(u,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(k,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(v,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(u,
Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(k,v,u,t,F,B),this)};Howl.prototype.init=function(k){return function(v){return this._orientation=v.orientation||[1,0,0],this._stereo=v.stereo||null,this._pos=v.pos||null,this._pannerAttr={coneInnerAngle:void 0!==v.coneInnerAngle?v.coneInnerAngle:360,coneOuterAngle:void 0!==v.coneOuterAngle?v.coneOuterAngle:360,coneOuterGain:void 0!==v.coneOuterGain?v.coneOuterGain:0,distanceModel:void 0!==v.distanceModel?v.distanceModel:"inverse",maxDistance:void 0!==
v.maxDistance?v.maxDistance:1E4,panningModel:void 0!==v.panningModel?v.panningModel:"HRTF",refDistance:void 0!==v.refDistance?v.refDistance:1,rolloffFactor:void 0!==v.rolloffFactor?v.rolloffFactor:1},this._onstereo=v.onstereo?[{fn:v.onstereo}]:[],this._onpos=v.onpos?[{fn:v.onpos}]:[],this._onorientation=v.onorientation?[{fn:v.onorientation}]:[],k.call(this,v)}}(Howl.prototype.init);Howl.prototype.stereo=function(k,v){var u=this;if(!u._webAudio)return u;if("loaded"!==u._state)return u._queue.push({event:"stereo",
action:function(){u.stereo(k,v)}}),u;var t=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===v){if("number"!=typeof k)return u._stereo;u._stereo=k;u._pos=[k,0,0]}for(var F=u._getSoundIds(v),B=0;B<F.length;B++){var M=u._soundById(F[B]);if(M){if("number"!=typeof k)return M._stereo;M._stereo=k;M._pos=[k,0,0];M._node&&(M._pannerAttr.panningModel="equalpower",M._panner&&M._panner.pan||H(M,t),"spatial"===t?void 0!==M._panner.positionX?(M._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),
M._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),M._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):M._panner.setPosition(k,0,0):M._panner.pan.setValueAtTime(k,Howler.ctx.currentTime));u._emit("stereo",M._id)}}return u};Howl.prototype.pos=function(k,v,u,t){var F=this;if(!F._webAudio)return F;if("loaded"!==F._state)return F._queue.push({event:"pos",action:function(){F.pos(k,v,u,t)}}),F;if(v="number"!=typeof v?0:v,u="number"!=typeof u?-.5:u,void 0===t){if("number"!=typeof k)return F._pos;
F._pos=[k,v,u]}for(var B=F._getSoundIds(t),M=0;M<B.length;M++){var G=F._soundById(B[M]);if(G){if("number"!=typeof k)return G._pos;G._pos=[k,v,u];G._node&&(G._panner&&!G._panner.pan||H(G,"spatial"),void 0!==G._panner.positionX?(G._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),G._panner.positionY.setValueAtTime(v,Howler.ctx.currentTime),G._panner.positionZ.setValueAtTime(u,Howler.ctx.currentTime)):G._panner.setPosition(k,v,u));F._emit("pos",G._id)}}return F};Howl.prototype.orientation=function(k,
v,u,t){var F=this;if(!F._webAudio)return F;if("loaded"!==F._state)return F._queue.push({event:"orientation",action:function(){F.orientation(k,v,u,t)}}),F;if(v="number"!=typeof v?F._orientation[1]:v,u="number"!=typeof u?F._orientation[2]:u,void 0===t){if("number"!=typeof k)return F._orientation;F._orientation=[k,v,u]}for(var B=F._getSoundIds(t),M=0;M<B.length;M++){var G=F._soundById(B[M]);if(G){if("number"!=typeof k)return G._orientation;G._orientation=[k,v,u];G._node&&(G._panner||(G._pos||(G._pos=
F._pos||[0,0,-.5]),H(G,"spatial")),void 0!==G._panner.orientationX?(G._panner.orientationX.setValueAtTime(k,Howler.ctx.currentTime),G._panner.orientationY.setValueAtTime(v,Howler.ctx.currentTime),G._panner.orientationZ.setValueAtTime(u,Howler.ctx.currentTime)):G._panner.setOrientation(k,v,u));F._emit("orientation",G._id)}}return F};Howl.prototype.pannerAttr=function(){var k,v,u=arguments;if(!this._webAudio)return this;if(0===u.length)return this._pannerAttr;if(1===u.length){if("object"!=typeof u[0])return v=
this._soundById(parseInt(u[0],10)),v?v._pannerAttr:this._pannerAttr;var t=u[0];void 0===k&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),this._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?
t.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:this._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:this._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:this._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:this._rolloffFactor,
panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:this._panningModel})}else 2===u.length&&(t=u[0],k=parseInt(u[1],10));k=this._getSoundIds(k);for(u=0;u<k.length;u++)if(v=this._soundById(k[u])){var F=v._pannerAttr;F={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:F.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:F.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:F.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:
F.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:F.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:F.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:F.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:F.panningModel};var B=v._panner;B?(B.coneInnerAngle=F.coneInnerAngle,B.coneOuterAngle=F.coneOuterAngle,B.coneOuterGain=F.coneOuterGain,B.distanceModel=F.distanceModel,B.maxDistance=F.maxDistance,B.refDistance=F.refDistance,B.rolloffFactor=
F.rolloffFactor,B.panningModel=F.panningModel):(v._pos||(v._pos=this._pos||[0,0,-.5]),H(v,"spatial"))}return this};Sound.prototype.init=function(k){return function(){var v=this._parent;this._orientation=v._orientation;this._stereo=v._stereo;this._pos=v._pos;this._pannerAttr=v._pannerAttr;k.call(this);this._stereo?v.stereo(this._stereo):this._pos&&v.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init);Sound.prototype.reset=function(k){return function(){var v=this._parent;return this._orientation=
v._orientation,this._stereo=v._stereo,this._pos=v._pos,this._pannerAttr=v._pannerAttr,this._stereo?v.stereo(this._stereo):this._pos?v.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,v._refreshBuffer(this)),k.call(this)}}(Sound.prototype.reset);var H=function(k,v){"spatial"===(v||"spatial")?(k._panner=Howler.ctx.createPanner(),k._panner.coneInnerAngle=k._pannerAttr.coneInnerAngle,k._panner.coneOuterAngle=k._pannerAttr.coneOuterAngle,
k._panner.coneOuterGain=k._pannerAttr.coneOuterGain,k._panner.distanceModel=k._pannerAttr.distanceModel,k._panner.maxDistance=k._pannerAttr.maxDistance,k._panner.refDistance=k._pannerAttr.refDistance,k._panner.rolloffFactor=k._pannerAttr.rolloffFactor,k._panner.panningModel=k._pannerAttr.panningModel,void 0!==k._panner.positionX?(k._panner.positionX.setValueAtTime(k._pos[0],Howler.ctx.currentTime),k._panner.positionY.setValueAtTime(k._pos[1],Howler.ctx.currentTime),k._panner.positionZ.setValueAtTime(k._pos[2],
Howler.ctx.currentTime)):k._panner.setPosition(k._pos[0],k._pos[1],k._pos[2]),void 0!==k._panner.orientationX?(k._panner.orientationX.setValueAtTime(k._orientation[0],Howler.ctx.currentTime),k._panner.orientationY.setValueAtTime(k._orientation[1],Howler.ctx.currentTime),k._panner.orientationZ.setValueAtTime(k._orientation[2],Howler.ctx.currentTime)):k._panner.setOrientation(k._orientation[0],k._orientation[1],k._orientation[2])):(k._panner=Howler.ctx.createStereoPanner(),k._panner.pan.setValueAtTime(k._stereo,
Howler.ctx.currentTime));k._panner.connect(k._node);k._paused||k._parent.pause(k._id,!0).play(k._id,!0)}}();
!function(H){"object"==typeof exports&&"undefined"!=typeof module?module.exports=H():"function"==typeof define&&define.amd?define([],H):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=H()}(function(){return function t(k,v,u){function F(G,I){if(!v[G]){if(!k[G]){var f="function"==typeof require&&require;if(!I&&f)return f(G,!0);if(B)return B(G,!0);I=Error("Cannot find module '"+G+"'");throw I.code="MODULE_NOT_FOUND",I;}I=v[G]={exports:{}};
k[G][0].call(I.exports,function(d){var f=k[G][1][d];return F(f?f:d)},I,I.exports,t,k,v,u)}return v[G].exports}for(var B="function"==typeof require&&require,M=0;M<u.length;M++)F(u[M]);return F}({1:[function(k,v,u){function t(k){if(!(this instanceof t))return new t(k);k=this.options=M.assign({level:y,method:J,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},k||{});k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&16>k.windowBits&&(k.windowBits+=16);this.err=0;this.msg=
"";this.ended=!1;this.chunks=[];this.strm=new f;this.strm.avail_out=0;var u=B.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(u!==n)throw Error(I[u]);if(k.header&&B.deflateSetHeader(this.strm,k.header),k.dictionary){var v;if(v="string"==typeof k.dictionary?G.string2buf(k.dictionary):"[object ArrayBuffer]"===d.call(k.dictionary)?new Uint8Array(k.dictionary):k.dictionary,u=B.deflateSetDictionary(this.strm,v),u!==n)throw Error(I[u]);this._dict_set=!0}}function F(d,f){f=
new t(f);if(f.push(d,!0),f.err)throw f.msg;return f.result}var B=k("./zlib/deflate"),M=k("./utils/common"),G=k("./utils/strings"),I=k("./zlib/messages"),f=k("./zlib/zstream"),d=Object.prototype.toString,n=0,y=-1,h=0,J=8;t.prototype.push=function(f,h){var k,t=this.strm,u=this.options.chunkSize;if(this.ended)return!1;h=h===~~h?h:!0===h?4:0;"string"==typeof f?t.input=G.string2buf(f):"[object ArrayBuffer]"===d.call(f)?t.input=new Uint8Array(f):t.input=f;t.next_in=0;t.avail_in=t.input.length;do{if(0===
t.avail_out&&(t.output=new M.Buf8(u),t.next_out=0,t.avail_out=u),k=B.deflate(t,h),1!==k&&k!==n)return this.onEnd(k),this.ended=!0,!1;0!==t.avail_out&&(0!==t.avail_in||4!==h&&2!==h)||("string"===this.options.to?this.onData(G.buf2binstring(M.shrinkBuf(t.output,t.next_out))):this.onData(M.shrinkBuf(t.output,t.next_out)))}while((0<t.avail_in||0===t.avail_out)&&1!==k);return 4===h?(k=B.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===n):2!==h||(this.onEnd(n),t.avail_out=0,!0)};t.prototype.onData=
function(d){this.chunks.push(d)};t.prototype.onEnd=function(d){d===n&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=M.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};u.Deflate=t;u.deflate=F;u.deflateRaw=function(d,f){return f=f||{},f.raw=!0,F(d,f)};u.gzip=function(d,f){return f=f||{},f.gzip=!0,F(d,f)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(k,v,u){function t(h){if(!(this instanceof
t))return new t(h);var k=this.options=M.assign({chunkSize:16384,windowBits:0,to:""},h||{});k.raw&&0<=k.windowBits&&16>k.windowBits&&(k.windowBits=-k.windowBits,0===k.windowBits&&(k.windowBits=-15));!(0<=k.windowBits&&16>k.windowBits)||h&&h.windowBits||(k.windowBits+=32);15<k.windowBits&&48>k.windowBits&&0===(15&k.windowBits)&&(k.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new d;this.strm.avail_out=0;h=B.inflateInit2(this.strm,k.windowBits);if(h!==I.Z_OK)throw Error(f[h]);
this.header=new n;B.inflateGetHeader(this.strm,this.header)}function F(d,f){f=new t(f);if(f.push(d,!0),f.err)throw f.msg;return f.result}var B=k("./zlib/inflate"),M=k("./utils/common"),G=k("./utils/strings"),I=k("./zlib/constants"),f=k("./zlib/messages"),d=k("./zlib/zstream"),n=k("./zlib/gzheader"),y=Object.prototype.toString;t.prototype.push=function(d,f){var h,k,n,t,u,v=this.strm,J=this.options.chunkSize,F=this.options.dictionary,N=!1;if(this.ended)return!1;f=f===~~f?f:!0===f?I.Z_FINISH:I.Z_NO_FLUSH;
"string"==typeof d?v.input=G.binstring2buf(d):"[object ArrayBuffer]"===y.call(d)?v.input=new Uint8Array(d):v.input=d;v.next_in=0;v.avail_in=v.input.length;do{if(0===v.avail_out&&(v.output=new M.Buf8(J),v.next_out=0,v.avail_out=J),h=B.inflate(v,I.Z_NO_FLUSH),h===I.Z_NEED_DICT&&F&&(u="string"==typeof F?G.string2buf(F):"[object ArrayBuffer]"===y.call(F)?new Uint8Array(F):F,h=B.inflateSetDictionary(this.strm,u)),h===I.Z_BUF_ERROR&&!0===N&&(h=I.Z_OK,N=!1),h!==I.Z_STREAM_END&&h!==I.Z_OK)return this.onEnd(h),
this.ended=!0,!1;v.next_out&&(0!==v.avail_out&&h!==I.Z_STREAM_END&&(0!==v.avail_in||f!==I.Z_FINISH&&f!==I.Z_SYNC_FLUSH)||("string"===this.options.to?(k=G.utf8border(v.output,v.next_out),n=v.next_out-k,t=G.buf2string(v.output,k),v.next_out=n,v.avail_out=J-n,n&&M.arraySet(v.output,v.output,k,n,0),this.onData(t)):this.onData(M.shrinkBuf(v.output,v.next_out))));0===v.avail_in&&0===v.avail_out&&(N=!0)}while((0<v.avail_in||0===v.avail_out)&&h!==I.Z_STREAM_END);return h===I.Z_STREAM_END&&(f=I.Z_FINISH),
f===I.Z_FINISH?(h=B.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,h===I.Z_OK):f!==I.Z_SYNC_FLUSH||(this.onEnd(I.Z_OK),v.avail_out=0,!0)};t.prototype.onData=function(d){this.chunks.push(d)};t.prototype.onEnd=function(d){d===I.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=M.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};u.Inflate=t;u.inflate=F;u.inflateRaw=function(d,f){return f=f||{},f.raw=!0,F(d,f)};u.ungzip=F},{"./utils/common":3,
"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(k,v,u){k="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;u.assign=function(k){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var u=t.shift();if(u){if("object"!=typeof u)throw new TypeError(u+"must be non-object");for(var v in u)u.hasOwnProperty(v)&&(k[v]=u[v])}}return k};u.shrinkBuf=function(k,t){return k.length===
t?k:k.subarray?k.subarray(0,t):(k.length=t,k)};var t={arraySet:function(k,t,u,v,f){if(t.subarray&&k.subarray)return void k.set(t.subarray(u,u+v),f);for(var d=0;d<v;d++)k[f+d]=t[u+d]},flattenChunks:function(k){var t,u;var v=u=0;for(t=k.length;v<t;v++)u+=k[v].length;var f=new Uint8Array(u);v=u=0;for(t=k.length;v<t;v++){var d=k[v];f.set(d,u);u+=d.length}return f}},F={arraySet:function(k,t,u,v,f){for(var d=0;d<v;d++)k[f+d]=t[u+d]},flattenChunks:function(k){return[].concat.apply([],k)}};u.setTyped=function(k){k?
(u.Buf8=Uint8Array,u.Buf16=Uint16Array,u.Buf32=Int32Array,u.assign(u,t)):(u.Buf8=Array,u.Buf16=Array,u.Buf32=Array,u.assign(u,F))};u.setTyped(k)},{}],4:[function(k,v,u){function t(k,f){if(65537>f&&(k.subarray&&M||!k.subarray&&B))return String.fromCharCode.apply(null,F.shrinkBuf(k,f));for(var d="",n=0;n<f;n++)d+=String.fromCharCode(k[n]);return d}var F=k("./common"),B=!0,M=!0;try{String.fromCharCode.apply(null,[0])}catch(I){B=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(I){M=!1}var G=
new F.Buf8(256);for(k=0;256>k;k++)G[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;G[254]=G[254]=1;u.string2buf=function(k){var f,d,n,t=k.length,h=0;for(d=0;d<t;d++){var u=k.charCodeAt(d);55296===(64512&u)&&d+1<t&&(f=k.charCodeAt(d+1),56320===(64512&f)&&(u=65536+(u-55296<<10)+(f-56320),d++));h+=128>u?1:2048>u?2:65536>u?3:4}var v=new F.Buf8(h);for(d=n=0;n<h;d++)u=k.charCodeAt(d),55296===(64512&u)&&d+1<t&&(f=k.charCodeAt(d+1),56320===(64512&f)&&(u=65536+(u-55296<<10)+(f-56320),d++)),128>u?v[n++]=
u:2048>u?(v[n++]=192|u>>>6,v[n++]=128|63&u):65536>u?(v[n++]=224|u>>>12,v[n++]=128|u>>>6&63,v[n++]=128|63&u):(v[n++]=240|u>>>18,v[n++]=128|u>>>12&63,v[n++]=128|u>>>6&63,v[n++]=128|63&u);return v};u.buf2binstring=function(k){return t(k,k.length)};u.binstring2buf=function(k){for(var f=new F.Buf8(k.length),d=0,n=f.length;d<n;d++)f[d]=k.charCodeAt(d);return f};u.buf2string=function(k,f){var d,n,u,h=f||k.length,v=Array(2*h);for(f=d=0;f<h;)if(n=k[f++],128>n)v[d++]=n;else if(u=G[n],4<u)v[d++]=65533,f+=u-
1;else{for(n&=2===u?31:3===u?15:7;1<u&&f<h;)n=n<<6|63&k[f++],u--;1<u?v[d++]=65533:65536>n?v[d++]=n:(n-=65536,v[d++]=55296|n>>10&1023,v[d++]=56320|1023&n)}return t(v,d)};u.utf8border=function(k,f){var d;f=f||k.length;f>k.length&&(f=k.length);for(d=f-1;0<=d&&128===(192&k[d]);)d--;return 0>d?f:0===d?f:d+G[k[d]]>f?d:f}},{"./common":3}],5:[function(k,v,u){v.exports=function(k,u,v,M){var t=65535&k|0;k=k>>>16&65535|0;for(var B;0!==v;){B=2E3<v?2E3:v;v-=B;do t=t+u[M++]|0,k=k+t|0;while(--B);t%=65521;k%=65521}return t|
k<<16|0}},{}],6:[function(k,v,u){v.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(k,v,u){var t=function(){for(var k,t=[],u=0;256>u;u++){k=u;
for(var v=0;8>v;v++)k=1&k?3988292384^k>>>1:k>>>1;t[u]=k}return t}();v.exports=function(k,u,v,G){v=G+v;for(k^=-1;G<v;G++)k=k>>>8^t[255&(k^u[G])];return k^-1}},{}],8:[function(k,v,u){function t(d,f){return d.msg=Da[f],f}function F(d){for(var f=d.length;0<=--f;)d[f]=0}function B(d){var f=d.state,h=f.pending;h>d.avail_out&&(h=d.avail_out);0!==h&&(ra.arraySet(d.output,f.pending_buf,f.pending_out,h,d.next_out),d.next_out+=h,f.pending_out+=h,d.total_out+=h,d.avail_out-=h,f.pending-=h,0===f.pending&&(f.pending_out=
0))}function M(d,f){Z._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,f);d.block_start=d.strstart;B(d.strm)}function G(d,f){d.pending_buf[d.pending++]=f}function I(d,f){d.pending_buf[d.pending++]=f>>>8&255;d.pending_buf[d.pending++]=255&f}function f(d,f){var h,p,k=d.max_chain_length,n=d.strstart,t=d.prev_length,u=d.nice_match,w=d.strstart>d.w_size-ca?d.strstart-(d.w_size-ca):0,v=d.window,y=d.w_mask,N=d.prev,B=d.strstart+V,C=v[n+t-1],D=v[n+t];d.prev_length>=d.good_match&&
(k>>=2);u>d.lookahead&&(u=d.lookahead);do if(h=f,v[h+t]===D&&v[h+t-1]===C&&v[h]===v[n]&&v[++h]===v[n+1]){n+=2;for(h++;v[++n]===v[++h]&&v[++n]===v[++h]&&v[++n]===v[++h]&&v[++n]===v[++h]&&v[++n]===v[++h]&&v[++n]===v[++h]&&v[++n]===v[++h]&&v[++n]===v[++h]&&n<B;);if(p=V-(B-n),n=B-V,p>t){if(d.match_start=f,t=p,p>=u)break;C=v[n+t-1];D=v[n+t]}}while((f=N[f&y])>w&&0!==--k);return t<=d.lookahead?t:d.lookahead}function d(d){var f,h,p=d.w_size;do{if(h=d.window_size-d.lookahead-d.strstart,d.strstart>=p+(p-ca)){ra.arraySet(d.window,
d.window,p,p,0);d.match_start-=p;d.strstart-=p;d.block_start-=p;var k=f=d.hash_size;do{var n=d.head[--k];d.head[k]=n>=p?n-p:0}while(--f);k=f=p;do n=d.prev[--k],d.prev[k]=n>=p?n-p:0;while(--f);h+=p}if(0===d.strm.avail_in)break;k=d.strm;n=d.window;var t=d.strstart+d.lookahead,u=k.avail_in;if(f=(u>h&&(u=h),0===u?0:(k.avail_in-=u,ra.arraySet(n,k.input,k.next_in,u,t),1===k.state.wrap?k.adler=K(k.adler,n,u,t):2===k.state.wrap&&(k.adler=E(k.adler,n,u,t)),k.next_in+=u,k.total_in+=u,u)),d.lookahead+=f,d.lookahead+
d.insert>=P)for(h=d.strstart-d.insert,d.ins_h=d.window[h],d.ins_h=(d.ins_h<<d.hash_shift^d.window[h+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[h+P-1])&d.hash_mask,d.prev[h&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=h,h++,d.insert--,!(d.lookahead+d.insert<P)););}while(d.lookahead<ca&&0!==d.strm.avail_in)}function n(h,k){for(var p,q;;){if(h.lookahead<ca){if(d(h),h.lookahead<ca&&k===N)return D;if(0===h.lookahead)break}if(p=0,h.lookahead>=P&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+
P-1])&h.hash_mask,p=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),0!==p&&h.strstart-p<=h.w_size-ca&&(h.match_length=f(h,p)),h.match_length>=P)if(q=Z._tr_tally(h,h.strstart-h.match_start,h.match_length-P),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=P){h.match_length--;do h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+P-1])&h.hash_mask,p=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart;while(0!==--h.match_length);
h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else q=Z._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(q&&(M(h,!1),0===h.strm.avail_out))return D}return h.insert=h.strstart<P-1?h.strstart:P-1,k===qa?(M(h,!0),0===h.strm.avail_out?ka:za):h.last_lit&&(M(h,!1),0===h.strm.avail_out)?D:$a}function y(h,k){for(var p,q,n;;){if(h.lookahead<ca){if(d(h),h.lookahead<ca&&k===N)return D;
if(0===h.lookahead)break}if(p=0,h.lookahead>=P&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+P-1])&h.hash_mask,p=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=P-1,0!==p&&h.prev_length<h.max_lazy_match&&h.strstart-p<=h.w_size-ca&&(h.match_length=f(h,p),5>=h.match_length&&(h.strategy===Ja||h.match_length===P&&4096<h.strstart-h.match_start)&&(h.match_length=P-1)),h.prev_length>=P&&h.match_length<=
h.prev_length){n=h.strstart+h.lookahead-P;q=Z._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-P);h.lookahead-=h.prev_length-1;h.prev_length-=2;do++h.strstart<=n&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+P-1])&h.hash_mask,p=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);while(0!==--h.prev_length);if(h.match_available=0,h.match_length=P-1,h.strstart++,q&&(M(h,!1),0===h.strm.avail_out))return D}else if(h.match_available){if(q=Z._tr_tally(h,0,h.window[h.strstart-
1]),q&&M(h,!1),h.strstart++,h.lookahead--,0===h.strm.avail_out)return D}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(Z._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<P-1?h.strstart:P-1,k===qa?(M(h,!0),0===h.strm.avail_out?ka:za):h.last_lit&&(M(h,!1),0===h.strm.avail_out)?D:$a}function h(d,f,h,q,k){this.good_length=d;this.max_lazy=f;this.nice_length=h;this.max_chain=q;this.func=k}function J(){this.strm=null;this.status=0;this.pending_buf=
null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=Ia;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=
this.hash_size=this.ins_h=0;this.dyn_ltree=new ra.Buf16(2*na);this.dyn_dtree=new ra.Buf16(2*(2*xa+1));this.bl_tree=new ra.Buf16(2*(2*w+1));F(this.dyn_ltree);F(this.dyn_dtree);F(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new ra.Buf16(Ra+1);this.heap=new ra.Buf16(2*Ba+1);F(this.heap);this.heap_max=this.heap_len=0;this.depth=new ra.Buf16(2*Ba+1);F(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=
this.l_buf=0}function ma(d){var f;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=Ua,f=d.state,f.pending=0,f.pending_out=0,0>f.wrap&&(f.wrap=-f.wrap),f.status=f.wrap?L:C,d.adler=2===f.wrap?0:1,f.last_flush=N,Z._tr_init(f),S):t(d,Q)}function ha(d){var f=ma(d);f===S&&(d=d.state,d.window_size=2*d.w_size,F(d.head),d.max_lazy_match=pa[d.level].max_lazy,d.good_match=pa[d.level].good_length,d.nice_match=pa[d.level].nice_length,d.max_chain_length=pa[d.level].max_chain,d.strstart=0,d.block_start=0,
d.lookahead=0,d.insert=0,d.match_length=d.prev_length=P-1,d.match_available=0,d.ins_h=0);return f}function gb(d,f,h,q,k,n){if(!d)return Q;var p=1;if(f===da&&(f=6),0>q?(p=0,q=-q):15<q&&(p=2,q-=16),1>k||k>Xa||h!==Ia||8>q||15<q||0>f||9<f||0>n||n>Na)return t(d,Q);8===q&&(q=9);var A=new J;return d.state=A,A.strm=d,A.wrap=p,A.gzhead=null,A.w_bits=q,A.w_size=1<<A.w_bits,A.w_mask=A.w_size-1,A.hash_bits=k+7,A.hash_size=1<<A.hash_bits,A.hash_mask=A.hash_size-1,A.hash_shift=~~((A.hash_bits+P-1)/P),A.window=
new ra.Buf8(2*A.w_size),A.head=new ra.Buf16(A.hash_size),A.prev=new ra.Buf16(A.w_size),A.lit_bufsize=1<<k+6,A.pending_buf_size=4*A.lit_bufsize,A.pending_buf=new ra.Buf8(A.pending_buf_size),A.d_buf=1*A.lit_bufsize,A.l_buf=3*A.lit_bufsize,A.level=f,A.strategy=n,A.method=h,ha(d)}var ra=k("../utils/common"),Z=k("./trees"),K=k("./adler32"),E=k("./crc32"),Da=k("./messages"),N=0,qa=4,S=0,Q=-2,da=-1,Ja=1,Na=4,Ua=2,Ia=8,Xa=9,Ba=286,xa=30,w=19,na=2*Ba+1,Ra=15,P=3,V=258,ca=V+P+1,L=42,C=113,D=1,$a=2,ka=3,za=
4;var pa=[new h(0,0,0,0,function(f,h){var k=65535;for(k>f.pending_buf_size-5&&(k=f.pending_buf_size-5);;){if(1>=f.lookahead){if(d(f),0===f.lookahead&&h===N)return D;if(0===f.lookahead)break}f.strstart+=f.lookahead;f.lookahead=0;var q=f.block_start+k;if((0===f.strstart||f.strstart>=q)&&(f.lookahead=f.strstart-q,f.strstart=q,M(f,!1),0===f.strm.avail_out)||f.strstart-f.block_start>=f.w_size-ca&&(M(f,!1),0===f.strm.avail_out))return D}return f.insert=0,h===qa?(M(f,!0),0===f.strm.avail_out?ka:za):(f.strstart>
f.block_start&&M(f,!1),D)}),new h(4,4,8,4,n),new h(4,5,16,8,n),new h(4,6,32,32,n),new h(4,4,16,16,y),new h(8,16,32,32,y),new h(8,16,128,128,y),new h(8,32,128,256,y),new h(32,128,258,1024,y),new h(32,258,258,4096,y)];u.deflateInit=function(d,f){return gb(d,f,Ia,15,8,0)};u.deflateInit2=gb;u.deflateReset=ha;u.deflateResetKeep=ma;u.deflateSetHeader=function(d,f){return d&&d.state?2!==d.state.wrap?Q:(d.state.gzhead=f,S):Q};u.deflate=function(f,h){var k,q;if(!f||!f.state||5<h||0>h)return f?t(f,Q):Q;if(q=
f.state,!f.output||!f.input&&0!==f.avail_in||666===q.status&&h!==qa)return t(f,0===f.avail_out?-5:Q);if(q.strm=f,k=q.last_flush,q.last_flush=h,q.status===L)if(2===q.wrap)f.adler=0,G(q,31),G(q,139),G(q,8),q.gzhead?(G(q,(q.gzhead.text?1:0)+(q.gzhead.hcrc?2:0)+(q.gzhead.extra?4:0)+(q.gzhead.name?8:0)+(q.gzhead.comment?16:0)),G(q,255&q.gzhead.time),G(q,q.gzhead.time>>8&255),G(q,q.gzhead.time>>16&255),G(q,q.gzhead.time>>24&255),G(q,9===q.level?2:2<=q.strategy||2>q.level?4:0),G(q,255&q.gzhead.os),q.gzhead.extra&&
q.gzhead.extra.length&&(G(q,255&q.gzhead.extra.length),G(q,q.gzhead.extra.length>>8&255)),q.gzhead.hcrc&&(f.adler=E(f.adler,q.pending_buf,q.pending,0)),q.gzindex=0,q.status=69):(G(q,0),G(q,0),G(q,0),G(q,0),G(q,0),G(q,9===q.level?2:2<=q.strategy||2>q.level?4:0),G(q,3),q.status=C);else{var p=Ia+(q.w_bits-8<<4)<<8;p|=(2<=q.strategy||2>q.level?0:6>q.level?1:6===q.level?2:3)<<6;0!==q.strstart&&(p|=32);q.status=C;I(q,p+(31-p%31));0!==q.strstart&&(I(q,f.adler>>>16),I(q,65535&f.adler));f.adler=1}if(69===
q.status)if(q.gzhead.extra){for(p=q.pending;q.gzindex<(65535&q.gzhead.extra.length)&&(q.pending!==q.pending_buf_size||(q.gzhead.hcrc&&q.pending>p&&(f.adler=E(f.adler,q.pending_buf,q.pending-p,p)),B(f),p=q.pending,q.pending!==q.pending_buf_size));)G(q,255&q.gzhead.extra[q.gzindex]),q.gzindex++;q.gzhead.hcrc&&q.pending>p&&(f.adler=E(f.adler,q.pending_buf,q.pending-p,p));q.gzindex===q.gzhead.extra.length&&(q.gzindex=0,q.status=73)}else q.status=73;if(73===q.status)if(q.gzhead.name){p=q.pending;do{if(q.pending===
q.pending_buf_size&&(q.gzhead.hcrc&&q.pending>p&&(f.adler=E(f.adler,q.pending_buf,q.pending-p,p)),B(f),p=q.pending,q.pending===q.pending_buf_size)){var n=1;break}n=q.gzindex<q.gzhead.name.length?255&q.gzhead.name.charCodeAt(q.gzindex++):0;G(q,n)}while(0!==n);q.gzhead.hcrc&&q.pending>p&&(f.adler=E(f.adler,q.pending_buf,q.pending-p,p));0===n&&(q.gzindex=0,q.status=91)}else q.status=91;if(91===q.status)if(q.gzhead.comment){p=q.pending;do{if(q.pending===q.pending_buf_size&&(q.gzhead.hcrc&&q.pending>p&&
(f.adler=E(f.adler,q.pending_buf,q.pending-p,p)),B(f),p=q.pending,q.pending===q.pending_buf_size)){n=1;break}n=q.gzindex<q.gzhead.comment.length?255&q.gzhead.comment.charCodeAt(q.gzindex++):0;G(q,n)}while(0!==n);q.gzhead.hcrc&&q.pending>p&&(f.adler=E(f.adler,q.pending_buf,q.pending-p,p));0===n&&(q.status=103)}else q.status=103;if(103===q.status&&(q.gzhead.hcrc?(q.pending+2>q.pending_buf_size&&B(f),q.pending+2<=q.pending_buf_size&&(G(q,255&f.adler),G(q,f.adler>>8&255),f.adler=0,q.status=C)):q.status=
C),0!==q.pending){if(B(f),0===f.avail_out)return q.last_flush=-1,S}else if(0===f.avail_in&&(h<<1)-(4<h?9:0)<=(k<<1)-(4<k?9:0)&&h!==qa)return t(f,-5);if(666===q.status&&0!==f.avail_in)return t(f,-5);if(0!==f.avail_in||0!==q.lookahead||h!==N&&666!==q.status){if(2===q.strategy)a:{for(var u;;){if(0===q.lookahead&&(d(q),0===q.lookahead)){if(h===N){var w=D;break a}break}if(q.match_length=0,u=Z._tr_tally(q,0,q.window[q.strstart]),q.lookahead--,q.strstart++,u&&(M(q,!1),0===q.strm.avail_out)){w=D;break a}}w=
(q.insert=0,h===qa?(M(q,!0),0===q.strm.avail_out?ka:za):q.last_lit&&(M(q,!1),0===q.strm.avail_out)?D:$a)}else if(3===q.strategy)a:{var v,y;for(u=q.window;;){if(q.lookahead<=V){if(d(q),q.lookahead<=V&&h===N){w=D;break a}if(0===q.lookahead)break}if(q.match_length=0,q.lookahead>=P&&0<q.strstart&&(y=q.strstart-1,v=u[y],v===u[++y]&&v===u[++y]&&v===u[++y])){for(k=q.strstart+V;v===u[++y]&&v===u[++y]&&v===u[++y]&&v===u[++y]&&v===u[++y]&&v===u[++y]&&v===u[++y]&&v===u[++y]&&y<k;);q.match_length=V-(k-y);q.match_length>
q.lookahead&&(q.match_length=q.lookahead)}if(q.match_length>=P?(w=Z._tr_tally(q,1,q.match_length-P),q.lookahead-=q.match_length,q.strstart+=q.match_length,q.match_length=0):(w=Z._tr_tally(q,0,q.window[q.strstart]),q.lookahead--,q.strstart++),w&&(M(q,!1),0===q.strm.avail_out)){w=D;break a}}w=(q.insert=0,h===qa?(M(q,!0),0===q.strm.avail_out?ka:za):q.last_lit&&(M(q,!1),0===q.strm.avail_out)?D:$a)}else w=pa[q.level].func(q,h);if(w!==ka&&w!==za||(q.status=666),w===D||w===ka)return 0===f.avail_out&&(q.last_flush=
-1),S;if(w===$a&&(1===h?Z._tr_align(q):5!==h&&(Z._tr_stored_block(q,0,0,!1),3===h&&(F(q.head),0===q.lookahead&&(q.strstart=0,q.block_start=0,q.insert=0))),B(f),0===f.avail_out))return q.last_flush=-1,S}return h!==qa?S:0>=q.wrap?1:(2===q.wrap?(G(q,255&f.adler),G(q,f.adler>>8&255),G(q,f.adler>>16&255),G(q,f.adler>>24&255),G(q,255&f.total_in),G(q,f.total_in>>8&255),G(q,f.total_in>>16&255),G(q,f.total_in>>24&255)):(I(q,f.adler>>>16),I(q,65535&f.adler)),B(f),0<q.wrap&&(q.wrap=-q.wrap),0!==q.pending?S:
1)};u.deflateEnd=function(d){var f;return d&&d.state?(f=d.state.status,f!==L&&69!==f&&73!==f&&91!==f&&103!==f&&f!==C&&666!==f?t(d,Q):(d.state=null,f===C?t(d,-3):S)):Q};u.deflateSetDictionary=function(f,h){var k,q,p;var n=h.length;if(!f||!f.state||(k=f.state,q=k.wrap,2===q||1===q&&k.status!==L||k.lookahead))return Q;1===q&&(f.adler=K(f.adler,h,n,0));k.wrap=0;n>=k.w_size&&(0===q&&(F(k.head),k.strstart=0,k.block_start=0,k.insert=0),p=new ra.Buf8(k.w_size),ra.arraySet(p,h,n-k.w_size,k.w_size,0),h=p,n=
k.w_size);p=f.avail_in;var u=f.next_in;var t=f.input;f.avail_in=n;f.next_in=0;f.input=h;for(d(k);k.lookahead>=P;){h=k.strstart;n=k.lookahead-(P-1);do k.ins_h=(k.ins_h<<k.hash_shift^k.window[h+P-1])&k.hash_mask,k.prev[h&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=h,h++;while(--n);k.strstart=h;k.lookahead=P-1;d(k)}return k.strstart+=k.lookahead,k.block_start=k.strstart,k.insert=k.lookahead,k.lookahead=0,k.match_length=k.prev_length=P-1,k.match_available=0,f.next_in=u,f.input=t,f.avail_in=p,k.wrap=q,S};
u.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(k,v,u){v.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],10:[function(k,v,u){v.exports=function(k,u){var t,v,F;var I=k.state;var f=k.next_in;var d=k.input;var n=f+(k.avail_in-5);var y=k.next_out;var h=k.output;u=y-(u-k.avail_out);var J=y+(k.avail_out-257);
var ma=I.dmax;var ha=I.wsize;var gb=I.whave;var ra=I.wnext;var Z=I.window;var K=I.hold;var E=I.bits;var Da=I.lencode;var N=I.distcode;var qa=(1<<I.lenbits)-1;var S=(1<<I.distbits)-1;a:do{15>E&&(K+=d[f++]<<E,E+=8,K+=d[f++]<<E,E+=8);var Q=Da[K&qa];b:for(;;){if(t=Q>>>24,K>>>=t,E-=t,t=Q>>>16&255,0===t)h[y++]=65535&Q;else{if(!(16&t)){if(0===(64&t)){Q=Da[(65535&Q)+(K&(1<<t)-1)];continue b}if(32&t){I.mode=12;break a}k.msg="invalid literal/length code";I.mode=30;break a}var da=65535&Q;(t&=15)&&(E<t&&(K+=
d[f++]<<E,E+=8),da+=K&(1<<t)-1,K>>>=t,E-=t);15>E&&(K+=d[f++]<<E,E+=8,K+=d[f++]<<E,E+=8);Q=N[K&S];c:for(;;){if(t=Q>>>24,K>>>=t,E-=t,t=Q>>>16&255,!(16&t)){if(0===(64&t)){Q=N[(65535&Q)+(K&(1<<t)-1)];continue c}k.msg="invalid distance code";I.mode=30;break a}if(v=65535&Q,t&=15,E<t&&(K+=d[f++]<<E,E+=8,E<t&&(K+=d[f++]<<E,E+=8)),v+=K&(1<<t)-1,v>ma){k.msg="invalid distance too far back";I.mode=30;break a}if(K>>>=t,E-=t,t=y-u,v>t){if(t=v-t,t>gb&&I.sane){k.msg="invalid distance too far back";I.mode=30;break a}if(Q=
0,F=Z,0===ra){if(Q+=ha-t,t<da){da-=t;do h[y++]=Z[Q++];while(--t);Q=y-v;F=h}}else if(ra<t){if(Q+=ha+ra-t,t-=ra,t<da){da-=t;do h[y++]=Z[Q++];while(--t);if(Q=0,ra<da){t=ra;da-=t;do h[y++]=Z[Q++];while(--t);Q=y-v;F=h}}}else if(Q+=ra-t,t<da){da-=t;do h[y++]=Z[Q++];while(--t);Q=y-v;F=h}for(;2<da;)h[y++]=F[Q++],h[y++]=F[Q++],h[y++]=F[Q++],da-=3;da&&(h[y++]=F[Q++],1<da&&(h[y++]=F[Q++]))}else{Q=y-v;do h[y++]=h[Q++],h[y++]=h[Q++],h[y++]=h[Q++],da-=3;while(2<da);da&&(h[y++]=h[Q++],1<da&&(h[y++]=h[Q++]))}break}}break}}while(f<
n&&y<J);da=E>>3;f-=da;E-=da<<3;k.next_in=f;k.next_out=y;k.avail_in=f<n?5+(n-f):5-(f-n);k.avail_out=y<J?257+(J-y):257-(y-J);I.hold=K&(1<<E)-1;I.bits=E}},{}],11:[function(k,v,u){function t(d){return(d>>>24&255)+(d>>>8&65280)+((65280&d)<<8)+((255&d)<<24)}function F(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=
this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new y.Buf16(320);this.work=new y.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function B(d){var f;return d&&d.state?(f=d.state,d.total_in=d.total_out=f.total=0,d.msg="",f.wrap&&(d.adler=1&f.wrap),f.mode=Z,f.last=0,f.havedict=0,f.dmax=32768,f.head=null,f.hold=0,f.bits=0,f.lencode=f.lendyn=new y.Buf32(K),f.distcode=f.distdyn=new y.Buf32(E),f.sane=1,f.back=-1,gb):
ra}function M(d){var f;return d&&d.state?(f=d.state,f.wsize=0,f.whave=0,f.wnext=0,B(d)):ra}function G(d,f){var h,k;return d&&d.state?(k=d.state,0>f?(h=0,f=-f):(h=(f>>4)+1,48>f&&(f&=15)),f&&(8>f||15<f)?ra:(null!==k.window&&k.wbits!==f&&(k.window=null),k.wrap=h,k.wbits=f,M(d))):ra}function I(d,f){var h,k;return d?(k=new F,d.state=k,k.window=null,h=G(d,f),h!==gb&&(d.state=null),h):ra}function f(d,f,h,k){var n;d=d.state;return null===d.window&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new y.Buf8(d.wsize)),
k>=d.wsize?(y.arraySet(d.window,f,h-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(n=d.wsize-d.wnext,n>k&&(n=k),y.arraySet(d.window,f,h-k,n,d.wnext),k-=n,k?(y.arraySet(d.window,f,h-k,k,0),d.wnext=k,d.whave=d.wsize):(d.wnext+=n,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=n))),0}var d,n,y=k("../utils/common"),h=k("./adler32"),J=k("./crc32"),ma=k("./inffast"),ha=k("./inftrees"),gb=0,ra=-2,Z=1,K=852,E=592,Da=!0;u.inflateReset=M;u.inflateReset2=G;u.inflateResetKeep=B;u.inflateInit=function(d){return I(d,
15)};u.inflateInit2=I;u.inflate=function(k,u){var v,F,B,E,I,G,K,N=0,M=new y.Buf8(4),qa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&0!==k.avail_in)return ra;var w=k.state;12===w.mode&&(w.mode=13);var na=k.next_out;var Ra=k.output;var P=k.avail_out;var V=k.next_in;var ca=k.input;var L=k.avail_in;var C=w.hold;var D=w.bits;var $a=L;var ka=P;var za=gb;a:for(;;)switch(w.mode){case Z:if(0===w.wrap){w.mode=13;break}for(;16>D;){if(0===L)break a;L--;C+=ca[V++]<<D;
D+=8}if(2&w.wrap&&35615===C){w.check=0;M[0]=255&C;M[1]=C>>>8&255;w.check=J(w.check,M,2,0);D=C=0;w.mode=2;break}if(w.flags=0,w.head&&(w.head.done=!1),!(1&w.wrap)||(((255&C)<<8)+(C>>8))%31){k.msg="incorrect header check";w.mode=30;break}if(8!==(15&C)){k.msg="unknown compression method";w.mode=30;break}if(C>>>=4,D-=4,G=(15&C)+8,0===w.wbits)w.wbits=G;else if(G>w.wbits){k.msg="invalid window size";w.mode=30;break}w.dmax=1<<G;k.adler=w.check=1;w.mode=512&C?10:12;D=C=0;break;case 2:for(;16>D;){if(0===L)break a;
L--;C+=ca[V++]<<D;D+=8}if(w.flags=C,8!==(255&w.flags)){k.msg="unknown compression method";w.mode=30;break}if(57344&w.flags){k.msg="unknown header flags set";w.mode=30;break}w.head&&(w.head.text=C>>8&1);512&w.flags&&(M[0]=255&C,M[1]=C>>>8&255,w.check=J(w.check,M,2,0));D=C=0;w.mode=3;case 3:for(;32>D;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}w.head&&(w.head.time=C);512&w.flags&&(M[0]=255&C,M[1]=C>>>8&255,M[2]=C>>>16&255,M[3]=C>>>24&255,w.check=J(w.check,M,4,0));D=C=0;w.mode=4;case 4:for(;16>D;){if(0===
L)break a;L--;C+=ca[V++]<<D;D+=8}w.head&&(w.head.xflags=255&C,w.head.os=C>>8);512&w.flags&&(M[0]=255&C,M[1]=C>>>8&255,w.check=J(w.check,M,2,0));D=C=0;w.mode=5;case 5:if(1024&w.flags){for(;16>D;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}w.length=C;w.head&&(w.head.extra_len=C);512&w.flags&&(M[0]=255&C,M[1]=C>>>8&255,w.check=J(w.check,M,2,0));D=C=0}else w.head&&(w.head.extra=null);w.mode=6;case 6:if(1024&w.flags&&(v=w.length,v>L&&(v=L),v&&(w.head&&(G=w.head.extra_len-w.length,w.head.extra||(w.head.extra=
Array(w.head.extra_len)),y.arraySet(w.head.extra,ca,V,v,G)),512&w.flags&&(w.check=J(w.check,ca,v,V)),L-=v,V+=v,w.length-=v),w.length))break a;w.length=0;w.mode=7;case 7:if(2048&w.flags){if(0===L)break a;v=0;do G=ca[V+v++],w.head&&G&&65536>w.length&&(w.head.name+=String.fromCharCode(G));while(G&&v<L);if(512&w.flags&&(w.check=J(w.check,ca,v,V)),L-=v,V+=v,G)break a}else w.head&&(w.head.name=null);w.length=0;w.mode=8;case 8:if(4096&w.flags){if(0===L)break a;v=0;do G=ca[V+v++],w.head&&G&&65536>w.length&&
(w.head.comment+=String.fromCharCode(G));while(G&&v<L);if(512&w.flags&&(w.check=J(w.check,ca,v,V)),L-=v,V+=v,G)break a}else w.head&&(w.head.comment=null);w.mode=9;case 9:if(512&w.flags){for(;16>D;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}if(C!==(65535&w.check)){k.msg="header crc mismatch";w.mode=30;break}D=C=0}w.head&&(w.head.hcrc=w.flags>>9&1,w.head.done=!0);k.adler=w.check=0;w.mode=12;break;case 10:for(;32>D;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}k.adler=w.check=t(C);D=C=0;w.mode=11;case 11:if(0===
w.havedict)return k.next_out=na,k.avail_out=P,k.next_in=V,k.avail_in=L,w.hold=C,w.bits=D,2;k.adler=w.check=1;w.mode=12;case 12:if(5===u||6===u)break a;case 13:if(w.last){C>>>=7&D;D-=7&D;w.mode=27;break}for(;3>D;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}switch(w.last=1&C,C>>>=1,--D,3&C){case 0:w.mode=14;break;case 1:var pa=w;if(Da){d=new y.Buf32(512);n=new y.Buf32(32);for(B=0;144>B;)pa.lens[B++]=8;for(;256>B;)pa.lens[B++]=9;for(;280>B;)pa.lens[B++]=7;for(;288>B;)pa.lens[B++]=8;ha(1,pa.lens,0,288,d,
0,pa.work,{bits:9});for(B=0;32>B;)pa.lens[B++]=5;ha(2,pa.lens,0,32,n,0,pa.work,{bits:5});Da=!1}pa.lencode=d;pa.lenbits=9;pa.distcode=n;pa.distbits=5;if(w.mode=20,6===u){C>>>=2;D-=2;break a}break;case 2:w.mode=17;break;case 3:k.msg="invalid block type",w.mode=30}C>>>=2;D-=2;break;case 14:C>>>=7&D;for(D-=7&D;32>D;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}if((65535&C)!==(C>>>16^65535)){k.msg="invalid stored block lengths";w.mode=30;break}if(w.length=65535&C,C=0,D=0,w.mode=15,6===u)break a;case 15:w.mode=
16;case 16:if(v=w.length){if(v>L&&(v=L),v>P&&(v=P),0===v)break a;y.arraySet(Ra,ca,V,v,na);L-=v;V+=v;P-=v;na+=v;w.length-=v;break}w.mode=12;break;case 17:for(;14>D;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}if(w.nlen=(31&C)+257,C>>>=5,D-=5,w.ndist=(31&C)+1,C>>>=5,D-=5,w.ncode=(15&C)+4,C>>>=4,D-=4,286<w.nlen||30<w.ndist){k.msg="too many length or distance symbols";w.mode=30;break}w.have=0;w.mode=18;case 18:for(;w.have<w.ncode;){for(;3>D;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}w.lens[qa[w.have++]]=
7&C;C>>>=3;D-=3}for(;19>w.have;)w.lens[qa[w.have++]]=0;if(w.lencode=w.lendyn,w.lenbits=7,K={bits:w.lenbits},za=ha(0,w.lens,0,19,w.lencode,0,w.work,K),w.lenbits=K.bits,za){k.msg="invalid code lengths set";w.mode=30;break}w.have=0;w.mode=19;case 19:for(;w.have<w.nlen+w.ndist;){for(;N=w.lencode[C&(1<<w.lenbits)-1],E=N>>>24,pa=65535&N,!(E<=D);){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}if(16>pa)C>>>=E,D-=E,w.lens[w.have++]=pa;else{if(16===pa){for(B=E+2;D<B;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}if(C>>>=
E,D-=E,0===w.have){k.msg="invalid bit length repeat";w.mode=30;break}G=w.lens[w.have-1];v=3+(3&C);C>>>=2;D-=2}else if(17===pa){for(B=E+3;D<B;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}C>>>=E;D-=E;G=0;v=3+(7&C);C>>>=3;D-=3}else{for(B=E+7;D<B;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}C>>>=E;D-=E;G=0;v=11+(127&C);C>>>=7;D-=7}if(w.have+v>w.nlen+w.ndist){k.msg="invalid bit length repeat";w.mode=30;break}for(;v--;)w.lens[w.have++]=G}}if(30===w.mode)break;if(0===w.lens[256]){k.msg="invalid code -- missing end-of-block";
w.mode=30;break}if(w.lenbits=9,K={bits:w.lenbits},za=ha(1,w.lens,0,w.nlen,w.lencode,0,w.work,K),w.lenbits=K.bits,za){k.msg="invalid literal/lengths set";w.mode=30;break}if(w.distbits=6,w.distcode=w.distdyn,K={bits:w.distbits},za=ha(2,w.lens,w.nlen,w.ndist,w.distcode,0,w.work,K),w.distbits=K.bits,za){k.msg="invalid distances set";w.mode=30;break}if(w.mode=20,6===u)break a;case 20:w.mode=21;case 21:if(6<=L&&258<=P){k.next_out=na;k.avail_out=P;k.next_in=V;k.avail_in=L;w.hold=C;w.bits=D;ma(k,ka);na=k.next_out;
Ra=k.output;P=k.avail_out;V=k.next_in;ca=k.input;L=k.avail_in;C=w.hold;D=w.bits;12===w.mode&&(w.back=-1);break}for(w.back=0;N=w.lencode[C&(1<<w.lenbits)-1],E=N>>>24,B=N>>>16&255,pa=65535&N,!(E<=D);){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}if(B&&0===(240&B)){var p=E;var hb=B;for(I=pa;N=w.lencode[I+((C&(1<<p+hb)-1)>>p)],E=N>>>24,B=N>>>16&255,pa=65535&N,!(p+E<=D);){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}C>>>=p;D-=p;w.back+=p}if(C>>>=E,D-=E,w.back+=E,w.length=pa,0===B){w.mode=26;break}if(32&B){w.back=
-1;w.mode=12;break}if(64&B){k.msg="invalid literal/length code";w.mode=30;break}w.extra=15&B;w.mode=22;case 22:if(w.extra){for(B=w.extra;D<B;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}w.length+=C&(1<<w.extra)-1;C>>>=w.extra;D-=w.extra;w.back+=w.extra}w.was=w.length;w.mode=23;case 23:for(;N=w.distcode[C&(1<<w.distbits)-1],E=N>>>24,B=N>>>16&255,pa=65535&N,!(E<=D);){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}if(0===(240&B)){p=E;hb=B;for(I=pa;N=w.distcode[I+((C&(1<<p+hb)-1)>>p)],E=N>>>24,B=N>>>16&255,pa=
65535&N,!(p+E<=D);){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}C>>>=p;D-=p;w.back+=p}if(C>>>=E,D-=E,w.back+=E,64&B){k.msg="invalid distance code";w.mode=30;break}w.offset=pa;w.extra=15&B;w.mode=24;case 24:if(w.extra){for(B=w.extra;D<B;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}w.offset+=C&(1<<w.extra)-1;C>>>=w.extra;D-=w.extra;w.back+=w.extra}if(w.offset>w.dmax){k.msg="invalid distance too far back";w.mode=30;break}w.mode=25;case 25:if(0===P)break a;if(v=ka-P,w.offset>v){if(v=w.offset-v,v>w.whave&&w.sane){k.msg=
"invalid distance too far back";w.mode=30;break}v>w.wnext?(v-=w.wnext,F=w.wsize-v):F=w.wnext-v;v>w.length&&(v=w.length);B=w.window}else B=Ra,F=na-w.offset,v=w.length;v>P&&(v=P);P-=v;w.length-=v;do Ra[na++]=B[F++];while(--v);0===w.length&&(w.mode=21);break;case 26:if(0===P)break a;Ra[na++]=w.length;P--;w.mode=21;break;case 27:if(w.wrap){for(;32>D;){if(0===L)break a;L--;C|=ca[V++]<<D;D+=8}if(ka-=P,k.total_out+=ka,w.total+=ka,ka&&(k.adler=w.check=w.flags?J(w.check,Ra,ka,na-ka):h(w.check,Ra,ka,na-ka)),
ka=P,(w.flags?C:t(C))!==w.check){k.msg="incorrect data check";w.mode=30;break}D=C=0}w.mode=28;case 28:if(w.wrap&&w.flags){for(;32>D;){if(0===L)break a;L--;C+=ca[V++]<<D;D+=8}if(C!==(4294967295&w.total)){k.msg="incorrect length check";w.mode=30;break}D=C=0}w.mode=29;case 29:za=1;break a;case 30:za=-3;break a;case 31:return-4;default:return ra}return k.next_out=na,k.avail_out=P,k.next_in=V,k.avail_in=L,w.hold=C,w.bits=D,(w.wsize||ka!==k.avail_out&&30>w.mode&&(27>w.mode||4!==u))&&f(k,k.output,k.next_out,
ka-k.avail_out)?(w.mode=31,-4):($a-=k.avail_in,ka-=k.avail_out,k.total_in+=$a,k.total_out+=ka,w.total+=ka,w.wrap&&ka&&(k.adler=w.check=w.flags?J(w.check,Ra,ka,k.next_out-ka):h(w.check,Ra,ka,k.next_out-ka)),k.data_type=w.bits+(w.last?64:0)+(12===w.mode?128:0)+(20===w.mode||15===w.mode?256:0),(0===$a&&0===ka||4===u)&&za===gb&&(za=-5),za)};u.inflateEnd=function(d){if(!d||!d.state)return ra;var f=d.state;return f.window&&(f.window=null),d.state=null,gb};u.inflateGetHeader=function(d,f){var h;return d&&
d.state?(h=d.state,0===(2&h.wrap)?ra:(h.head=f,f.done=!1,gb)):ra};u.inflateSetDictionary=function(d,k){var n,t,u=k.length;return d&&d.state?(n=d.state,0!==n.wrap&&11!==n.mode?ra:11===n.mode&&(t=1,t=h(t,k,u,0),t!==n.check)?-3:f(d,k,u,u)?(n.mode=31,-4):(n.havedict=1,gb)):ra};u.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(k,v,u){var t=k("../utils/common"),F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,
51,59,67,83,99,115,131,163,195,227,258,0,0],B=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],M=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],G=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];v.exports=function(k,f,d,n,u,h,v,ma){var y,J,I,Z,K,E,Da=ma.bits,N,qa,S,Q,da,Ja=0,Na,Ua=null,Ia=0,Xa=new t.Buf16(16);var Ba=new t.Buf16(16);var xa=
null,w=0;for(N=0;15>=N;N++)Xa[N]=0;for(qa=0;qa<n;qa++)Xa[f[d+qa]]++;var na=Da;for(S=15;1<=S&&0===Xa[S];S--);if(na>S&&(na=S),0===S)return u[h++]=20971520,u[h++]=20971520,ma.bits=1,0;for(Da=1;Da<S&&0===Xa[Da];Da++);na<Da&&(na=Da);for(N=y=1;15>=N;N++)if(y<<=1,y-=Xa[N],0>y)return-1;if(0<y&&(0===k||1!==S))return-1;Ba[1]=0;for(N=1;15>N;N++)Ba[N+1]=Ba[N]+Xa[N];for(qa=0;qa<n;qa++)0!==f[d+qa]&&(v[Ba[f[d+qa]]++]=qa);if(0===k?(Ua=xa=v,Z=19):1===k?(Ua=F,Ia-=257,xa=B,w-=257,Z=256):(Ua=M,xa=G,Z=-1),Na=0,qa=0,N=
Da,Ba=h,Q=na,da=0,I=-1,Ja=1<<na,n=Ja-1,1===k&&852<Ja||2===k&&592<Ja)return 1;for(var Ra=0;;){Ra++;var P=N-da;v[qa]<Z?(K=0,E=v[qa]):v[qa]>Z?(K=xa[w+v[qa]],E=Ua[Ia+v[qa]]):(K=96,E=0);y=1<<N-da;Da=J=1<<Q;do J-=y,u[Ba+(Na>>da)+J]=P<<24|K<<16|E|0;while(0!==J);for(y=1<<N-1;Na&y;)y>>=1;if(0!==y?(Na&=y-1,Na+=y):Na=0,qa++,0===--Xa[N]){if(N===S)break;N=f[d+v[qa]]}if(N>na&&(Na&n)!==I){0===da&&(da=na);Ba+=Da;Q=N-da;for(y=1<<Q;Q+da<S&&(y-=Xa[Q+da],!(0>=y));)Q++,y<<=1;if(Ja+=1<<Q,1===k&&852<Ja||2===k&&592<Ja)return 1;
I=Na&n;u[I]=na<<24|Q<<16|Ba-h|0}}return 0!==Na&&(u[Ba+Na]=N-da<<24|4194304),ma.bits=na,0}},{"../utils/common":3}],13:[function(k,v,u){v.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(k,v,u){function t(d){for(var f=d.length;0<=--f;)d[f]=0}function F(d,f,h,k,n){this.static_tree=d;this.extra_bits=f;this.extra_base=h;this.elems=k;this.max_length=n;this.has_stree=
d&&d.length}function B(d,f){this.dyn_tree=d;this.max_code=0;this.stat_desc=f}function M(d,f){d.pending_buf[d.pending++]=255&f;d.pending_buf[d.pending++]=f>>>8&255}function G(d,f,h){d.bi_valid>Ia-h?(d.bi_buf|=f<<d.bi_valid&65535,M(d,d.bi_buf),d.bi_buf=f>>Ia-d.bi_valid,d.bi_valid+=h-Ia):(d.bi_buf|=f<<d.bi_valid&65535,d.bi_valid+=h)}function I(d,f,h){G(d,h[2*f],h[2*f+1])}function f(d,f){var h=0;do h|=1&d,d>>>=1,h<<=1;while(0<--f);return h>>>1}function d(d,h,k){var q,n=Array(Ua+1),p=0;for(q=1;q<=Ua;q++)n[q]=
p=p+k[q-1]<<1;for(k=0;k<=h;k++)q=d[2*k+1],0!==q&&(d[2*k]=f(n[q]++,q))}function n(d){var f;for(f=0;f<Q;f++)d.dyn_ltree[2*f]=0;for(f=0;f<da;f++)d.dyn_dtree[2*f]=0;for(f=0;f<Ja;f++)d.bl_tree[2*f]=0;d.dyn_ltree[2*Xa]=1;d.opt_len=d.static_len=0;d.last_lit=d.matches=0}function y(d){8<d.bi_valid?M(d,d.bi_buf):0<d.bi_valid&&(d.pending_buf[d.pending++]=d.bi_buf);d.bi_buf=0;d.bi_valid=0}function h(d,f,h,k){var q=2*f,n=2*h;return d[q]<d[n]||d[q]===d[n]&&k[f]<=k[h]}function J(d,f,k){for(var q=d.heap[k],n=k<<
1;n<=d.heap_len&&(n<d.heap_len&&h(f,d.heap[n+1],d.heap[n],d.depth)&&n++,!h(f,q,d.heap[n],d.depth));)d.heap[k]=d.heap[n],k=n,n<<=1;d.heap[k]=q}function ma(d,f,h){var k,q,n=0;if(0!==d.last_lit){do{var p=d.pending_buf[d.d_buf+2*n]<<8|d.pending_buf[d.d_buf+2*n+1];var t=d.pending_buf[d.l_buf+n];n++;0===p?I(d,t,f):(k=D[t],I(d,k+S+1,f),q=na[k],0!==q&&(t-=$a[k],G(d,t,q)),p--,k=256>p?C[p]:C[256+(p>>>7)],I(d,k,h),q=Ra[k],0!==q&&(p-=ka[k],G(d,p,q)))}while(n<d.last_lit)}I(d,Xa,f)}function ha(f,h){var k,q=h.dyn_tree;
var n=h.stat_desc.static_tree;var p=h.stat_desc.has_stree,t=h.stat_desc.elems,u=-1;f.heap_len=0;f.heap_max=Na;for(k=0;k<t;k++)0!==q[2*k]?(f.heap[++f.heap_len]=u=k,f.depth[k]=0):q[2*k+1]=0;for(;2>f.heap_len;){var v=f.heap[++f.heap_len]=2>u?++u:0;q[2*v]=1;f.depth[v]=0;f.opt_len--;p&&(f.static_len-=n[2*v+1])}h.max_code=u;for(k=f.heap_len>>1;1<=k;k--)J(f,q,k);v=t;do k=f.heap[1],f.heap[1]=f.heap[f.heap_len--],J(f,q,1),n=f.heap[1],f.heap[--f.heap_max]=k,f.heap[--f.heap_max]=n,q[2*v]=q[2*k]+q[2*n],f.depth[v]=
(f.depth[k]>=f.depth[n]?f.depth[k]:f.depth[n])+1,q[2*k+1]=q[2*n+1]=v,f.heap[1]=v++,J(f,q,1);while(2<=f.heap_len);f.heap[--f.heap_max]=f.heap[1];var w,A;k=h.dyn_tree;v=h.max_code;t=h.stat_desc.static_tree;var y=h.stat_desc.has_stree,B=h.stat_desc.extra_bits,C=h.stat_desc.extra_base,D=h.stat_desc.max_length,E=0;for(p=0;p<=Ua;p++)f.bl_count[p]=0;k[2*f.heap[f.heap_max]+1]=0;for(h=f.heap_max+1;h<Na;h++)n=f.heap[h],p=k[2*k[2*n+1]+1]+1,p>D&&(p=D,E++),k[2*n+1]=p,n>v||(f.bl_count[p]++,w=0,n>=C&&(w=B[n-C]),
A=k[2*n],f.opt_len+=A*(p+w),y&&(f.static_len+=A*(t[2*n+1]+w)));if(0!==E){do{for(p=D-1;0===f.bl_count[p];)p--;f.bl_count[p]--;f.bl_count[p+1]+=2;f.bl_count[D]--;E-=2}while(0<E);for(p=D;0!==p;p--)for(n=f.bl_count[p];0!==n;)w=f.heap[--h],w>v||(k[2*w+1]!==p&&(f.opt_len+=(p-k[2*w+1])*k[2*w],k[2*w+1]=p),n--)}d(q,u,f.bl_count)}function gb(d,f,h){var k,q=-1,n=f[1],p=0,t=7,u=4;0===n&&(t=138,u=3);f[2*(h+1)+1]=65535;for(k=0;k<=h;k++){var v=n;n=f[2*(k+1)+1];++p<t&&v===n||(p<u?d.bl_tree[2*v]+=p:0!==v?(v!==q&&
d.bl_tree[2*v]++,d.bl_tree[2*Ba]++):10>=p?d.bl_tree[2*xa]++:d.bl_tree[2*w]++,p=0,q=v,0===n?(t=138,u=3):v===n?(t=6,u=3):(t=7,u=4))}}function ra(d,f,h){var k,q,n=-1,p=f[1],t=0,u=7,v=4;0===p&&(u=138,v=3);for(k=0;k<=h;k++)if(q=p,p=f[2*(k+1)+1],!(++t<u&&q===p)){if(t<v){do I(d,q,d.bl_tree);while(0!==--t)}else 0!==q?(q!==n&&(I(d,q,d.bl_tree),t--),I(d,Ba,d.bl_tree),G(d,t-3,2)):10>=t?(I(d,xa,d.bl_tree),G(d,t-3,3)):(I(d,w,d.bl_tree),G(d,t-11,7));t=0;n=q;0===p?(u=138,v=3):q===p?(u=6,v=3):(u=7,v=4)}}function Z(d){var f,
h=4093624447;for(f=0;31>=f;f++,h>>>=1)if(1&h&&0!==d.dyn_ltree[2*f])return Da;if(0!==d.dyn_ltree[18]||0!==d.dyn_ltree[20]||0!==d.dyn_ltree[26])return N;for(f=32;f<S;f++)if(0!==d.dyn_ltree[2*f])return N;return Da}function K(d,f,h,k){G(d,(qa<<1)+(k?1:0),3);y(d);M(d,h);M(d,~h);E.arraySet(d.pending_buf,d.window,f,h,d.pending);d.pending+=h}var E=k("../utils/common"),Da=0,N=1,qa=0,S=256,Q=S+1+29,da=30,Ja=19,Na=2*Q+1,Ua=15,Ia=16,Xa=256,Ba=16,xa=17,w=18,na=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,
5,5,5,5,0],Ra=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ca=Array(2*(Q+2));t(ca);var L=Array(2*da);t(L);var C=Array(512);t(C);var D=Array(256);t(D);var $a=Array(29);t($a);var ka=Array(da);t(ka);var za,pa,p,hb=!1;u._tr_init=function(h){if(!hb){var k,t,u,v=Array(Ua+1);for(u=t=0;28>u;u++)for($a[u]=t,k=0;k<1<<na[u];k++)D[t++]=u;D[t-1]=u;for(u=t=0;16>u;u++)for(ka[u]=t,k=0;k<1<<Ra[u];k++)C[t++]=
u;for(t>>=7;u<da;u++)for(ka[u]=t<<7,k=0;k<1<<Ra[u]-7;k++)C[256+t++]=u;for(k=0;k<=Ua;k++)v[k]=0;for(k=0;143>=k;)ca[2*k+1]=8,k++,v[8]++;for(;255>=k;)ca[2*k+1]=9,k++,v[9]++;for(;279>=k;)ca[2*k+1]=7,k++,v[7]++;for(;287>=k;)ca[2*k+1]=8,k++,v[8]++;d(ca,Q+1,v);for(k=0;k<da;k++)L[2*k+1]=5,L[2*k]=f(k,5);za=new F(ca,na,S+1,Q,Ua);pa=new F(L,Ra,0,da,Ua);p=new F([],P,0,Ja,7);hb=!0}h.l_desc=new B(h.dyn_ltree,za);h.d_desc=new B(h.dyn_dtree,pa);h.bl_desc=new B(h.bl_tree,p);h.bi_buf=0;h.bi_valid=0;n(h)};u._tr_stored_block=
K;u._tr_flush_block=function(d,f,h,k){var p=0;if(0<d.level){2===d.strm.data_type&&(d.strm.data_type=Z(d));ha(d,d.l_desc);ha(d,d.d_desc);gb(d,d.dyn_ltree,d.l_desc.max_code);gb(d,d.dyn_dtree,d.d_desc.max_code);ha(d,d.bl_desc);for(p=Ja-1;3<=p&&0===d.bl_tree[2*V[p]+1];p--);p=(d.opt_len+=3*(p+1)+14,p);var q=d.opt_len+3+7>>>3;var t=d.static_len+3+7>>>3;t<=q&&(q=t)}else q=t=h+5;if(h+4<=q&&-1!==f)K(d,f,h,k);else if(4===d.strategy||t===q)G(d,2+(k?1:0),3),ma(d,ca,L);else{G(d,4+(k?1:0),3);f=d.l_desc.max_code+
1;h=d.d_desc.max_code+1;p+=1;G(d,f-257,5);G(d,h-1,5);G(d,p-4,4);for(q=0;q<p;q++)G(d,d.bl_tree[2*V[q]+1],3);ra(d,d.dyn_ltree,f-1);ra(d,d.dyn_dtree,h-1);ma(d,d.dyn_ltree,d.dyn_dtree)}n(d);k&&y(d)};u._tr_tally=function(d,f,h){return d.pending_buf[d.d_buf+2*d.last_lit]=f>>>8&255,d.pending_buf[d.d_buf+2*d.last_lit+1]=255&f,d.pending_buf[d.l_buf+d.last_lit]=255&h,d.last_lit++,0===f?d.dyn_ltree[2*h]++:(d.matches++,f--,d.dyn_ltree[2*(D[h]+S+1)]++,d.dyn_dtree[2*(256>f?C[f]:C[256+(f>>>7)])]++),d.last_lit===
d.lit_bufsize-1};u._tr_align=function(d){G(d,2,3);I(d,Xa,ca);16===d.bi_valid?(M(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}},{"../utils/common":3}],15:[function(k,v,u){v.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],"/":[function(k,v,u){u=k("./lib/utils/common").assign;
var t=k("./lib/deflate"),F=k("./lib/inflate");k=k("./lib/zlib/constants");var B={};u(B,t,F,k);v.exports=B},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});
var saveAs=saveAs||function(H){if(!("undefined"===typeof H||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var k=H.document.createElementNS("http://www.w3.org/1999/xhtml","a"),v="download"in k,u=/constructor/i.test(H.HTMLElement)||H.safari,t=/CriOS\/[\d]+/.test(navigator.userAgent),F=function(f){(H.setImmediate||H.setTimeout)(function(){throw f;},0)},B=function(f){setTimeout(function(){"string"===typeof f?(H.URL||H.webkitURL||H).revokeObjectURL(f):f.remove()},4E4)},M=function(f){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?
new Blob([String.fromCharCode(65279),f],{type:f.type}):f},G=function(f,d,n){n||(f=M(f));var y=this,h="application/octet-stream"===f.type,G=function(){var d=["writestart","progress","write","writeend"];d=[].concat(d);for(var f=d.length;f--;){var h=y["on"+d[f]];if("function"===typeof h)try{h.call(y,y)}catch(Z){F(Z)}}};y.readyState=y.INIT;if(v){var I=(H.URL||H.webkitURL||H).createObjectURL(f);setTimeout(function(){k.href=I;k.download=d;var f=new MouseEvent("click");k.dispatchEvent(f);G();B(I);y.readyState=
y.DONE})}else(function(){if((t||h&&u)&&H.FileReader){var d=new FileReader;d.onloadend=function(){var f=t?d.result:d.result.replace(/^data:[^;]*;/,"data:attachment/file;");H.open(f,"_blank")||(H.location.href=f);y.readyState=y.DONE;G()};d.readAsDataURL(f);y.readyState=y.INIT}else I||(I=(H.URL||H.webkitURL||H).createObjectURL(f)),h?H.location.href=I:H.open(I,"_blank")||(H.location.href=I),y.readyState=y.DONE,G(),B(I)})()},I=G.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(f,
d,k){d=d||f.name||"download";k||(f=M(f));return navigator.msSaveOrOpenBlob(f,d)};I.abort=function(){};I.readyState=I.INIT=0;I.WRITING=1;I.DONE=2;I.error=I.onwritestart=I.onprogress=I.onwrite=I.onabort=I.onerror=I.onwriteend=null;return function(f,d,k){return new G(f,d||f.name||"download",k)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
"undefined"!==typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!==typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs});"function"==typeof define&&define.__amd&&(define.amd=define.__amd,delete define.__amd);
