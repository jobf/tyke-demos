/*
 howler.js v2.1.1 | (c) 2013-2018, James Simpson of GoldFire Studios | MIT License | howlerjs.com  Spatial Plugin  @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(D){var m=0;return function(){return m<D.length?{done:!1,value:D[m++]}:{done:!0}}};$jscomp.arrayIterator=function(D){return{next:$jscomp.arrayIteratorImpl(D)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(D,m,t){D!=Array.prototype&&D!=Object.prototype&&(D[m]=t.value)};$jscomp.getGlobal=function(D){D=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,D];for(var m=0;m<D.length;++m){var t=D[m];if(t&&t.Math==Math)return t}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(D,m){this.$jscomp$symbol$id_=D;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:m})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function D(t){if(this instanceof D)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(t||"")+"_"+m++,t)}var m=0;return D}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var D=$jscomp.global.Symbol.iterator;D||(D=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[D]&&$jscomp.defineProperty(Array.prototype,D,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var D=$jscomp.global.Symbol.asyncIterator;D||(D=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(D){$jscomp.initSymbolIterator();D={next:D};D[$jscomp.global.Symbol.iterator]=function(){return this};return D};
$jscomp.iteratorFromArray=function(D,m){$jscomp.initSymbolIterator();D instanceof String&&(D+="");var t=0,u={next:function(){if(t<D.length){var z=t++;return{value:m(z,D[z]),done:!1}}u.next=function(){return{done:!0,value:void 0}};return u.next()}};u[Symbol.iterator]=function(){return u};return u};
$jscomp.polyfill=function(D,m,t,u){if(m){t=$jscomp.global;D=D.split(".");for(u=0;u<D.length-1;u++){var z=D[u];z in t||(t[z]={});t=t[z]}D=D[D.length-1];u=t[D];m=m(u);m!=u&&null!=m&&$jscomp.defineProperty(t,D,{configurable:!0,writable:!0,value:m})}};$jscomp.polyfill("Array.prototype.values",function(D){return D?D:function(){return $jscomp.iteratorFromArray(this,function(m,t){return t})}},"es8","es3");
$jscomp.checkStringArgs=function(D,m,t){if(null==D)throw new TypeError("The 'this' value for String.prototype."+t+" must not be null or undefined");if(m instanceof RegExp)throw new TypeError("First argument to String.prototype."+t+" must not be a regular expression");return D+""};
$jscomp.polyfill("String.prototype.startsWith",function(D){return D?D:function(m,t){var u=$jscomp.checkStringArgs(this,m,"startsWith");m+="";var z=u.length,E=m.length;t=Math.max(0,Math.min(t|0,u.length));for(var F=0;F<E&&t<z;)if(u[t++]!=m[F++])return!1;return F>=E}},"es6","es3");$jscomp.polyfill("Array.prototype.keys",function(D){return D?D:function(){return $jscomp.iteratorFromArray(this,function(m){return m})}},"es6","es3");
$jscomp.polyfill("String.fromCodePoint",function(D){return D?D:function(m){for(var t="",u=0;u<arguments.length;u++){var z=Number(arguments[u]);if(0>z||1114111<z||z!==Math.floor(z))throw new RangeError("invalid_code_point "+z);65535>=z?t+=String.fromCharCode(z):(z-=65536,t+=String.fromCharCode(z>>>10&1023|55296),t+=String.fromCharCode(z&1023|56320))}return t}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(D){return D?D:function(m,t){var u=$jscomp.checkStringArgs(this,m,"endsWith");m+="";void 0===t&&(t=u.length);t=Math.max(0,Math.min(t|0,u.length));for(var z=m.length;0<z&&0<t;)if(u[--t]!=m[--z])return!1;return 0>=z}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(D){return D?D:function(m,t,u){var z=this.length||0;0>t&&(t=Math.max(0,z+t));if(null==u||u>z)u=z;u=Number(u);0>u&&(u=Math.max(0,z+u));for(t=Number(t||0);t<u;t++)this[t]=m;return this}},"es6","es3");
(function(D,m){D.lime=D.lime||{};D.lime.$scripts=D.lime.$scripts||{};D.lime.$scripts.TYKE=function(m,u){(function(m,t){function F(a,b){a=Object.create(a);for(var c in b)a[c]=b[c];b.toString!==Object.prototype.toString&&(a.toString=b.toString);return a}function u(a){return Math.ceil(a*Math.random())}function z(a){return a instanceof Array?new Ec(a):a.iterator()}function p(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=t.$haxeUID++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];
null==c&&(c=b.bind(a),a.hx__closures__[b.__id__]=c);return c}m.echo=m.echo||{};m.lime=m.lime||{};var d={},n=function(){return sa.__string_rec(this,"")},v=v||{},f,la=function(){};d["lime.app.IModule"]=la;la.__name__=!0;la.__isInterface__=!0;var K=function(){this.onExit=new cc};d["lime.app.Module"]=K;K.__name__=!0;K.__interfaces__=[la];K.prototype={__class__:K};var ka=function(a){this.gameDeviceCache=new xb;this.parent=a;this.nextUpdate=this.lastUpdate=this.currentUpdate=0;this.framePeriod=-1;Fc.init();
this.accelerometer=Tb.registerSensor(jf.ACCELEROMETER,0)};d["lime._internal.backend.html5.HTML5Application"]=ka;ka.__name__=!0;ka.prototype={convertKeyCode:function(a){if(65<=a&&90>=a)return a+32;switch(a){case 12:return 1073741980;case 16:return 1073742049;case 17:return 1073742048;case 18:return 1073742050;case 19:return 1073741896;case 20:return 1073741881;case 33:return 1073741899;case 34:return 1073741902;case 35:return 1073741901;case 36:return 1073741898;case 37:return 1073741904;case 38:return 1073741906;
case 39:return 1073741903;case 40:return 1073741905;case 41:return 1073741943;case 43:return 1073741940;case 44:return 1073741894;case 45:return 1073741897;case 46:return 127;case 91:return 1073742051;case 92:return 1073742055;case 93:return 1073742055;case 95:return 1073742106;case 96:return 1073741922;case 97:return 1073741913;case 98:return 1073741914;case 99:return 1073741915;case 100:return 1073741916;case 101:return 1073741917;case 102:return 1073741918;case 103:return 1073741919;case 104:return 1073741920;
case 105:return 1073741921;case 106:return 1073741909;case 107:return 1073741911;case 108:return 1073741923;case 109:return 1073741910;case 110:return 1073741923;case 111:return 1073741908;case 112:return 1073741882;case 113:return 1073741883;case 114:return 1073741884;case 115:return 1073741885;case 116:return 1073741886;case 117:return 1073741887;case 118:return 1073741888;case 119:return 1073741889;case 120:return 1073741890;case 121:return 1073741891;case 122:return 1073741892;case 123:return 1073741893;
case 124:return 1073741928;case 125:return 1073741929;case 126:return 1073741930;case 127:return 1073741931;case 128:return 1073741932;case 129:return 1073741933;case 130:return 1073741934;case 131:return 1073741935;case 132:return 1073741936;case 133:return 1073741937;case 134:return 1073741938;case 135:return 1073741939;case 144:return 1073741907;case 145:return 1073741895;case 160:return 94;case 161:return 33;case 163:return 35;case 164:return 36;case 166:return 1073742094;case 167:return 1073742095;
case 168:return 1073742097;case 169:return 41;case 170:return 42;case 171:return 96;case 172:return 1073741898;case 173:return 45;case 174:return 1073741953;case 175:return 1073741952;case 176:return 1073742082;case 177:return 1073742083;case 178:return 1073742084;case 179:return 1073742085;case 180:return 1073742089;case 181:return 1073742086;case 182:return 1073741953;case 183:return 1073741952;case 186:return 59;case 187:return 61;case 188:return 44;case 189:return 45;case 190:return 46;case 191:return 47;
case 192:return 96;case 193:return 63;case 194:return 1073741923;case 219:return 91;case 220:return 92;case 221:return 93;case 222:return 39;case 223:return 96;case 224:return 1073742051;case 226:return 92}return a},exec:function(){window.addEventListener("keydown",p(this,this.handleKeyEvent),!1);window.addEventListener("keyup",p(this,this.handleKeyEvent),!1);window.addEventListener("focus",p(this,this.handleWindowEvent),!1);window.addEventListener("blur",p(this,this.handleWindowEvent),!1);window.addEventListener("resize",
p(this,this.handleWindowEvent),!1);window.addEventListener("beforeunload",p(this,this.handleWindowEvent),!1);window.addEventListener("devicemotion",p(this,this.handleSensorEvent),!1);CanvasRenderingContext2D.prototype.isPointInStroke||(CanvasRenderingContext2D.prototype.isPointInStroke=function(a,b,c){return!1});CanvasRenderingContext2D.prototype.isPointInPath||(CanvasRenderingContext2D.prototype.isPointInPath=function(a,b,c){return!1});0=="performance"in window&&(window.performance={});if(0=="now"in
window.performance){var a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart);window.performance.now=function(){return Date.now()-a}}for(var b=0,c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"]||window[c[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=
function(a,c){var e=(new Date).getTime(),g=Math.max(0,16-(e-b));c=window.setTimeout(function(){a(e+g)},g);b=e+g;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});window.requestAnimFrame=window.requestAnimationFrame;this.lastUpdate=(new Date).getTime();this.handleApplicationEvent();return 0},exit:function(){},handleApplicationEvent:function(a){a=0;for(var b=this.parent.__windows;a<b.length;){var c=b[a];++a;c.__backend.updateSize()}this.updateGameDevices();
this.currentUpdate=(new Date).getTime();if(this.currentUpdate>=this.nextUpdate){this.deltaTime=this.currentUpdate-this.lastUpdate;a=0;for(b=this.parent.__windows;a<b.length;)c=b[a],++a,this.parent.onUpdate.dispatch(this.deltaTime|0),null!=c.context&&c.onRender.dispatch(c.context);this.nextUpdate=0>this.framePeriod?this.currentUpdate:this.currentUpdate-this.currentUpdate%this.framePeriod+this.framePeriod;this.lastUpdate=this.currentUpdate}window.requestAnimationFrame(p(this,this.handleApplicationEvent))},
handleKeyEvent:function(a){if(null!=this.parent.__window){var b=this.convertKeyCode(null!=a.keyCode?a.keyCode:a.which),c=(a.shiftKey?3:0)|(a.ctrlKey?192:0)|(a.altKey?768:0)|(a.metaKey?3072:0);"keydown"==a.type?(this.parent.__window.onKeyDown.dispatch(b,c),this.parent.__window.onKeyDown.canceled&&a.cancelable&&a.preventDefault()):(this.parent.__window.onKeyUp.dispatch(b,c),this.parent.__window.onKeyUp.canceled&&a.cancelable&&a.preventDefault())}},handleSensorEvent:function(a){this.accelerometer.onUpdate.dispatch(a.accelerationIncludingGravity.x,
a.accelerationIncludingGravity.y,a.accelerationIncludingGravity.z)},handleWindowEvent:function(a){if(null!=this.parent.__window)switch(a.type){case "blur":this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0);break;case "focus":this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1);break;case "resize":this.parent.__window.__backend.handleResizeEvent(a);break;case "visibilitychange":window.document.hidden?
this.hidden||(this.parent.__window.onFocusOut.dispatch(),this.parent.__window.onDeactivate.dispatch(),this.hidden=!0):this.hidden&&(this.parent.__window.onFocusIn.dispatch(),this.parent.__window.onActivate.dispatch(),this.hidden=!1)}},updateGameDevices:function(){var a=mb.__getDeviceData();if(null!=a)for(var b,c,e,g,h,x=0,k=a.length;x<k;)if(b=x++,g=a[b],null!=g){if(!this.gameDeviceCache.h.hasOwnProperty(b)){h=new be;h.id=b;h.connected=g.connected;c=0;for(e=g.buttons.length;c<e;){var d=c++;h.buttons.push(g.buttons[d].value)}c=
0;for(e=g.axes.length;c<e;)d=c++,h.axes.push(g.axes[d]);"standard"==g.mapping&&(h.isGamepad=!0);this.gameDeviceCache.h[b]=h;g.connected&&(mb.__connect(b),h.isGamepad&&db.__connect(b))}h=this.gameDeviceCache.h[b];e=mb.devices.h[b];c=db.devices.h[b];if(g.connected){for(var ba=0,N=g.buttons.length;ba<N;){var r=ba++;d=g.buttons[r].value;if(d!=h.buttons[r]){if(6==r)e.onAxisMove.dispatch(g.axes.length,d),null!=c&&c.onAxisMove.dispatch(4,d);else if(7==r)e.onAxisMove.dispatch(g.axes.length+1,d),null!=c&&
c.onAxisMove.dispatch(5,d);else if(0<d?e.onButtonDown.dispatch(r):e.onButtonUp.dispatch(r),null!=c){switch(r){case 0:b=0;break;case 1:b=1;break;case 2:b=2;break;case 3:b=3;break;case 4:b=9;break;case 5:b=10;break;case 8:b=4;break;case 9:b=6;break;case 10:b=7;break;case 11:b=8;break;case 12:b=11;break;case 13:b=12;break;case 14:b=13;break;case 15:b=14;break;case 16:b=5;break;default:continue}0<d?c.onButtonDown.dispatch(b):c.onButtonUp.dispatch(b)}h.buttons[r]=d}}b=0;for(d=g.axes.length;b<d;)ba=b++,
g.axes[ba]!=h.axes[ba]&&(e.onAxisMove.dispatch(ba,g.axes[ba]),null!=c&&c.onAxisMove.dispatch(ba,g.axes[ba]),h.axes[ba]=g.axes[ba])}else h.connected&&(h.connected=!1,mb.__disconnect(b),db.__disconnect(b))}},__class__:ka};var ca=function(){this.onCreateWindow=new ce;this.onUpdate=new cc;this.onExit=new cc;null==ca.current&&(ca.current=this);this.meta=new aa;this.modules=[];this.__windowByID=new xb;this.__windows=[];this.__backend=new ka(this);this.__registerLimeModule(this);this.__preloader=new de;
this.__preloader.onProgress.add(p(this,this.onPreloadProgress));this.__preloader.onComplete.add(p(this,this.onPreloadComplete))};d["lime.app.Application"]=ca;ca.__name__=!0;ca.__super__=K;ca.prototype=F(K.prototype,{createWindow:function(a){a=this.__createWindow(a);this.__addWindow(a);return a},exec:function(){ca.current=this;return this.__backend.exec()},onGamepadAxisMove:function(a,b,c){},onGamepadButtonDown:function(a,b){},onGamepadButtonUp:function(a,b){},onGamepadConnect:function(a){},onGamepadDisconnect:function(a){},
onJoystickAxisMove:function(a,b,c){},onJoystickButtonDown:function(a,b){},onJoystickButtonUp:function(a,b){},onJoystickConnect:function(a){},onJoystickDisconnect:function(a){},onJoystickHatMove:function(a,b,c){},onJoystickTrackballMove:function(a,b,c,e){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onModuleExit:function(a){},onMouseDown:function(a,b,c){},onMouseMove:function(a,b){},onMouseMoveRelative:function(a,b){},onMouseUp:function(a,b,c){},onMouseWheel:function(a,b,c){},onPreloadComplete:function(){},
onPreloadProgress:function(a,b){},onRenderContextLost:function(){},onRenderContextRestored:function(a){},onTextEdit:function(a,b,c){},onTextInput:function(a){},onTouchCancel:function(a){},onTouchEnd:function(a){},onTouchMove:function(a){},onTouchStart:function(a){},onWindowActivate:function(){},onWindowClose:function(){},onWindowCreate:function(){},onWindowDeactivate:function(){},onWindowDropFile:function(a){},onWindowEnter:function(){},onWindowExpose:function(){},onWindowFocusIn:function(){},onWindowFocusOut:function(){},
onWindowFullscreen:function(){},onWindowLeave:function(){},onWindowMove:function(a,b){},onWindowMinimize:function(){},onWindowResize:function(a,b){},onWindowRestore:function(){},render:function(a){},update:function(a){},__addWindow:function(a){if(null!=a){this.__windows.push(a);this.__windowByID.h[a.id]=a;var b=p(this,this.__onWindowClose);a.onClose.add(function(){b(a)},!1,-1E4);null==this.__window&&(this.__window=a,a.onActivate.add(p(this,this.onWindowActivate)),a.onRenderContextLost.add(p(this,
this.onRenderContextLost)),a.onRenderContextRestored.add(p(this,this.onRenderContextRestored)),a.onDeactivate.add(p(this,this.onWindowDeactivate)),a.onDropFile.add(p(this,this.onWindowDropFile)),a.onEnter.add(p(this,this.onWindowEnter)),a.onExpose.add(p(this,this.onWindowExpose)),a.onFocusIn.add(p(this,this.onWindowFocusIn)),a.onFocusOut.add(p(this,this.onWindowFocusOut)),a.onFullscreen.add(p(this,this.onWindowFullscreen)),a.onKeyDown.add(p(this,this.onKeyDown)),a.onKeyUp.add(p(this,this.onKeyUp)),
a.onLeave.add(p(this,this.onWindowLeave)),a.onMinimize.add(p(this,this.onWindowMinimize)),a.onMouseDown.add(p(this,this.onMouseDown)),a.onMouseMove.add(p(this,this.onMouseMove)),a.onMouseMoveRelative.add(p(this,this.onMouseMoveRelative)),a.onMouseUp.add(p(this,this.onMouseUp)),a.onMouseWheel.add(p(this,this.onMouseWheel)),a.onMove.add(p(this,this.onWindowMove)),a.onRender.add(p(this,this.render)),a.onResize.add(p(this,this.onWindowResize)),a.onRestore.add(p(this,this.onWindowRestore)),a.onTextEdit.add(p(this,
this.onTextEdit)),a.onTextInput.add(p(this,this.onTextInput)),this.onWindowCreate());this.onCreateWindow.dispatch(a)}},__createWindow:function(a){a=new ee(this,a);return-1==a.id?null:a},__registerLimeModule:function(a){a.onUpdate.add(p(this,this.update));a.onExit.add(p(this,this.onModuleExit),!1,0);a.onExit.add(p(this,this.__onModuleExit),!1,0);for(a=db.devices.iterator();a.hasNext();){var b=a.next();this.__onGamepadConnect(b)}db.onConnect.add(p(this,this.__onGamepadConnect));for(a=mb.devices.iterator();a.hasNext();)b=
a.next(),this.__onJoystickConnect(b);mb.onConnect.add(p(this,this.__onJoystickConnect));Ab.onCancel.add(p(this,this.onTouchCancel));Ab.onStart.add(p(this,this.onTouchStart));Ab.onMove.add(p(this,this.onTouchMove));Ab.onEnd.add(p(this,this.onTouchEnd))},__removeWindow:function(a){null!=a&&this.__windowByID.h.hasOwnProperty(a.id)&&(this.__window==a&&(this.__window=null),J.remove(this.__windows,a),this.__windowByID.remove(a.id),a.close(),0==this.__windows.length&&Zb.exit(0))},__onGamepadConnect:function(a){this.onGamepadConnect(a);
var b=p(this,this.onGamepadAxisMove),c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=p(this,this.onGamepadButtonDown);c=function(b){e(a,b)};a.onButtonDown.add(c);var g=p(this,this.onGamepadButtonUp);c=function(b){g(a,b)};a.onButtonUp.add(c);var h=p(this,this.onGamepadDisconnect);a.onDisconnect.add(function(){h(a)})},__onJoystickConnect:function(a){this.onJoystickConnect(a);var b=p(this,this.onJoystickAxisMove),c=function(c,e){b(a,c,e)};a.onAxisMove.add(c);var e=p(this,this.onJoystickButtonDown);
c=function(b){e(a,b)};a.onButtonDown.add(c);var g=p(this,this.onJoystickButtonUp);c=function(b){g(a,b)};a.onButtonUp.add(c);var h=p(this,this.onJoystickDisconnect);a.onDisconnect.add(function(){h(a)});var x=p(this,this.onJoystickHatMove);c=function(b,c){x(a,b,c)};a.onHatMove.add(c);var k=p(this,this.onJoystickTrackballMove);c=function(b,c,e){k(a,b,c,e)};a.onTrackballMove.add(c)},__onModuleExit:function(a){this.__backend.exit()},__onWindowClose:function(a){if(this.__window==a)this.onWindowClose();
this.__removeWindow(a)},__class__:ca});var E=function(){};d.ApplicationMain=E;E.__name__=!0;E.main=function(){Zb.__registerEntryPoint("TYKE",E.create)};E.create=function(a){Q.init(a);var b=new Y;b.meta.h.build="1";b.meta.h.company="ob";b.meta.h.file="TYKE";b.meta.h.name="tyke";b.meta.h.packageName="tyke";b.meta.h.version="0.0.1";var c={allowHighDPI:!1,alwaysOnTop:!1,borderless:!1,element:null,frameRate:60,height:600,hidden:!1,maximized:!1,minimized:!1,parameters:{},resizable:!0,title:"tyke",width:800,
x:null,y:null,context:{antialiasing:0,background:16777215,colorDepth:32,depth:!0,hardware:!0,stencil:!1,type:null,vsync:!0}};if(null==b.__window&&null!=a)for(var e=0,g=H.fields(a);e<g.length;){var h=g[e];++e;Object.prototype.hasOwnProperty.call(c,h)?c[h]=H.field(a,h):Object.prototype.hasOwnProperty.call(c.context,h)&&(c.context[h]=H.field(a,h))}b.createWindow(c);e=0;for(g=Q.preloadLibraries;e<g.length;)a=g[e],++e,b.__preloader.addLibrary(a);e=0;for(g=Q.preloadLibraryNames;e<g.length;)a=g[e],++e,b.__preloader.addLibraryName(a);
b.__preloader.load();E.start(b)};E.start=function(a){a.exec()};var D=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};d.EReg=D;D.__name__=!0;D.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw y.thrown("EReg::matched");},matchedRight:function(){if(null==this.r.m)throw y.thrown("No string matched");var a=this.r.m.index+this.r.m[0].length;
return J.substr(this.r.s,a,this.r.s.length-a)},matchedPos:function(){if(null==this.r.m)throw y.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(a,b,c){null==c&&(c=-1);if(this.r.global){if(this.r.lastIndex=b,this.r.m=this.r.exec(0>c?a:J.substr(a,0,b+c)),c=null!=this.r.m)this.r.s=a}else if(c=this.match(0>c?J.substr(a,b,null):J.substr(a,b,c)))this.r.s=a,this.r.m.index+=b;return c},map:function(a,b){for(var c=0,e="";!(c>=a.length);){if(!this.matchSub(a,
c)){e+=w.string(J.substr(a,c,null));break}var g=this.matchedPos();e+=w.string(J.substr(a,c,g.pos-c));e+=w.string(b(this));0==g.len?(e+=w.string(J.substr(a,g.pos,1)),c=g.pos+1):c=g.pos+g.len;if(!this.r.global)break}!this.r.global&&0<c&&c<a.length&&(e+=w.string(J.substr(a,c,null)));return e},__class__:D};var J=function(){};d.HxOverrides=J;J.__name__=!0;J.strDate=function(a){switch(a.length){case 8:a=a.split(":");var b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);
return b;case 10:return a=a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);case 19:return a=a.split(" "),b=a[0].split("-"),a=a[1].split(":"),new Date(b[0],b[1]-1,b[2],a[0],a[1],a[2]);default:throw y.thrown("Invalid date format : "+a);}};J.cca=function(a,b){a=a.charCodeAt(b);if(a==a)return a};J.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};J.remove=function(a,b){b=a.indexOf(b);if(-1==b)return!1;a.splice(b,1);return!0};J.now=function(){return Date.now()};
var B=function(a,b,c){this.errors=a;this.putils=b;this.errorType=c};d["json2object.reader.BaseParser"]=B;B.__name__=!0;B.prototype={fromJson:function(a,b){null==b&&(b="");this.putils=new fe(a);this.errors=[];try{var c=(new ge(a,b)).doParse();this.loadJson(c)}catch(e){if(ma.lastError=e,a=y.caught(e).unwrap(),a instanceof $b)this.errors.push(oa.ParserError(a.message,this.putils.convertPosition(a.pos)));else throw e;}return this.value},loadJson:function(a,b){null==b&&(b="");var c=this.putils.convertPosition(a.pos);
a=a.value;switch(a._hx_index){case 0:this.loadJsonString(a.s,c,b);break;case 1:this.loadJsonNumber(a.s,c,b);break;case 2:this.loadJsonObject(a.fields,c,b);break;case 3:this.loadJsonArray(a.values,c,b);break;case 4:this.loadJsonBool(a.b,c,b);break;case 5:this.loadJsonNull(c,b)}return this.value},loadJsonNull:function(a,b){this.onIncorrectType(a,b)},loadJsonString:function(a,b,c){this.onIncorrectType(b,c)},loadJsonNumber:function(a,b,c){this.onIncorrectType(b,c)},loadJsonUInt:function(a,b,c,e){var g=
0;a=W.trim(a);"-"==a.charAt(0)&&(a=J.substr(a,1,null));var h=W.startsWith(a,"0x");h&&(a=J.substr(a,2,null));for(var x=h?16:10,k=1,d=a.length-1;0<=d;){var ba=h?w.parseInt("0x"+a.charAt(d)):w.parseInt(a.charAt(d));if(null==ba)return this.onIncorrectType(b,c),e;g+=k*ba;k*=x;--d}return g},loadJsonInt:function(a,b,c,e){if(null!=w.parseInt(a)&&w.parseInt(a)==parseFloat(a))return w.parseInt(a);this.onIncorrectType(b,c);return e},loadJsonFloat:function(a,b,c,e){if(null!=w.parseInt(a))return parseFloat(a);
this.onIncorrectType(b,c);return e},loadJsonBool:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArray:function(a,b,c){this.onIncorrectType(b,c)},loadJsonArrayValue:function(a,b,c){for(var e=[],g=0;g<a.length;){var h=a[g];++g;try{var x=b(h,c)}catch(k){if(ma.lastError=k,h=y.caught(k).unwrap(),sa.__instanceof(h,sb)){if(h!=sb.ParsingThrow)throw y.thrown(h);continue}else throw k;}e.push(x)}return e},loadJsonObject:function(a,b,c){this.onIncorrectType(b,c)},loadObjectField:function(a,b,c,e,g,h){try{var x=
a(b.value,b.name);this.mapSet(e,c,!0);return x}catch(k){if(ma.lastError=k,a=y.caught(k).unwrap(),sa.__instanceof(a,sb)){if(a!=sb.ParsingThrow)throw y.thrown(a);}else this.errors.push(oa.CustomFunctionException(a,h))}return g},objectSetupAssign:function(a,b,c){for(var e=0,g=b.length;e<g;){var h=e++;this.mapSet(a,b[h],c[h])}},objectErrors:function(a,b){b=this.putils.convertPosition(new Ca(b.file,b.max-1,b.max-1));for(var c=Object.keys(a.h),e=c.length,g=0;g<e;){var h=c[g++];a.h[h]||this.errors.push(oa.UninitializedVariable(h,
b))}},onIncorrectType:function(a,b){this.parsingThrow()},parsingThrow:function(){if(0!=this.errorType)throw y.thrown(sb.ParsingThrow);},mapSet:function(a,b,c){a.h[b]=c},__class__:B};var U=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_0=U;U.__name__=!0;U.__super__=B;U.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"peote.text.FontConfig",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,
b,c){c=new aa;this.objectSetupAssign(c,"packed distancefield kerning width height color bgColor line tiles rangeSplitSize ranges".split(" "),[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "bgColor":this.value.bgColor=this.loadObjectField((f=new tb(this.errors,this.putils,1),p(f,f.loadJson)),g,"bgColor",c,this.value.bgColor,b);break;case "color":this.value.color=this.loadObjectField((f=new tb(this.errors,this.putils,1),p(f,
f.loadJson)),g,"color",c,this.value.color,b);break;case "distancefield":this.value.distancefield=this.loadObjectField((f=new ab(this.errors,this.putils,1),p(f,f.loadJson)),g,"distancefield",c,this.value.distancefield,b);break;case "height":this.value.height=this.loadObjectField((f=new Da(this.errors,this.putils,1),p(f,f.loadJson)),g,"height",c,this.value.height,b);break;case "kerning":this.value.kerning=this.loadObjectField((f=new Za(this.errors,this.putils,1),p(f,f.loadJson)),g,"kerning",c,this.value.kerning,
b);break;case "line":this.value.line=this.loadObjectField((f=new q(this.errors,this.putils,1),p(f,f.loadJson)),g,"line",c,this.value.line,b);break;case "packed":this.value.packed=this.loadObjectField((f=new ab(this.errors,this.putils,1),p(f,f.loadJson)),g,"packed",c,this.value.packed,b);break;case "rangeSplitSize":this.value.rangeSplitSize=this.loadObjectField((f=new ia(this.errors,this.putils,1),p(f,f.loadJson)),g,"rangeSplitSize",c,this.value.rangeSplitSize,b);break;case "ranges":this.value.ranges=
this.loadObjectField((f=new pa(this.errors,this.putils,1),p(f,f.loadJson)),g,"ranges",c,this.value.ranges,b);break;case "tiles":this.value.tiles=this.loadObjectField((f=new Ha(this.errors,this.putils,1),p(f,f.loadJson)),g,"tiles",c,this.value.tiles,b);break;case "width":this.value.width=this.loadObjectField((f=new Da(this.errors,this.putils,1),p(f,f.loadJson)),g,"width",c,this.value.width,b);break;default:this.errors.push(oa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,
b)},getAuto:function(){var a=Object.create(he.prototype);a.packed=!1;a.distancefield=!1;a.kerning=null;a.width=16;a.height=16;a.color=-1;a.bgColor=0;a.line=null;a.tiles=null;a.rangeSplitSize=4096;a.ranges=(new pa([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1)));return a},__class__:U});var pa=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_1=pa;pa.__name__=!0;pa.__super__=B;pa.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"Array<{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }>",
a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonArray:function(a,b,c){this.value=this.loadJsonArrayValue(a,(f=new S(this.errors,this.putils,2),p(f,f.loadJson)),c)},__class__:pa});var O=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c);this.value=0};d.JsonParser_10=O;O.__name__=!0;O.__super__=B;O.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"UInt",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,
b,c){this.value=this.loadJsonUInt(a,b,c,this.value)},__class__:O});var S=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_11=S;S.__name__=!0;S.__super__=B;S.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"{ ?tiles : Null<{ y : Int, x : Int }>, slot : { width : Int, height : Int }, range : peote.text.Range, ?line : Null<{ height : Float, base : Float }>, image : String, ?data : Null<String> }",a));B.prototype.onIncorrectType.call(this,a,b)},
loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new aa;this.objectSetupAssign(c,"data image line range slot tiles".split(" "),[!0,!1,!0,!1,!1,!0]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "data":this.value.data=this.loadObjectField((f=new ea(this.errors,this.putils,1),p(f,f.loadJson)),g,"data",c,this.value.data,b);break;case "image":this.value.image=this.loadObjectField((f=new R(this.errors,this.putils,1),p(f,f.loadJson)),g,
"image",c,this.value.image,b);break;case "line":this.value.line=this.loadObjectField((f=new T(this.errors,this.putils,1),p(f,f.loadJson)),g,"line",c,this.value.line,b);break;case "range":this.value.range=this.loadObjectField((f=new Pa(this.errors,this.putils,1),p(f,f.loadJson)),g,"range",c,this.value.range,b);break;case "slot":this.value.slot=this.loadObjectField((f=new Ua(this.errors,this.putils,1),p(f,f.loadJson)),g,"slot",c,this.value.slot,b);break;case "tiles":this.value.tiles=this.loadObjectField((f=
new $a(this.errors,this.putils,1),p(f,f.loadJson)),g,"tiles",c,this.value.tiles,b);break;default:this.errors.push(oa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{data:(new ea([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1))),image:(new R([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1))),line:(new T([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1))),range:(new Pa([],this.putils,0)).loadJson(new Fa(Ba.JNull,
new Ca("",0,1))),slot:(new Ua([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1))),tiles:(new $a([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1)))}},__class__:S});var ea=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_13=ea;ea.__name__=!0;ea.__super__=B;ea.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"String",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,
b,c){this.value=a},__class__:ea});var R=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_14=R;R.__name__=!0;R.__super__=B;R.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"String",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonString:function(a,b,c){this.value=a},__class__:R});var T=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_16=T;T.__name__=!0;T.__super__=B;T.prototype=
F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"{ height : Float, base : Float }",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new aa;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "base":this.value.base=this.loadObjectField((f=new Da(this.errors,this.putils,1),p(f,f.loadJson)),g,"base",c,this.value.base,
b);break;case "height":this.value.height=this.loadObjectField((f=new Da(this.errors,this.putils,1),p(f,f.loadJson)),g,"height",c,this.value.height,b);break;default:this.errors.push(oa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new Da([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1))),height:(new Da([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1)))}},__class__:T});var Pa=function(a,b,c){null==c&&(c=0);
B.call(this,a,b,c)};d.JsonParser_17=Pa;Pa.__name__=!0;Pa.__super__=B;Pa.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"peote.text.Range",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new aa;this.objectSetupAssign(c,["min","max"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "max":this.value.max=this.loadObjectField((f=new ia(this.errors,
this.putils,1),p(f,f.loadJson)),g,"max",c,this.value.max,b);break;case "min":this.value.min=this.loadObjectField((f=new ia(this.errors,this.putils,1),p(f,f.loadJson)),g,"min",c,this.value.min,b);break;default:this.errors.push(oa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){var a=Object.create(ie.prototype);a.min=(new ia([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1)));a.max=(new ia([],this.putils,0)).loadJson(new Fa(Ba.JNull,
new Ca("",0,1)));return a},__class__:Pa});var Ua=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_18=Ua;Ua.__name__=!0;Ua.__super__=B;Ua.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"{ width : Int, height : Int }",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new aa;this.objectSetupAssign(c,["height","width"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=
a[e];++e;switch(g.name){case "height":this.value.height=this.loadObjectField((f=new ia(this.errors,this.putils,1),p(f,f.loadJson)),g,"height",c,this.value.height,b);break;case "width":this.value.width=this.loadObjectField((f=new ia(this.errors,this.putils,1),p(f,f.loadJson)),g,"width",c,this.value.width,b);break;default:this.errors.push(oa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{height:(new ia([],this.putils,0)).loadJson(new Fa(Ba.JNull,
new Ca("",0,1))),width:(new ia([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1)))}},__class__:Ua});var ab=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c);this.value=!1};d.JsonParser_2=ab;ab.__name__=!0;ab.__super__=B;ab.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"Bool",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonBool:function(a,b,c){this.value=a},__class__:ab});var $a=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_20=
$a;$a.__name__=!0;$a.__super__=B;$a.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"{ y : Int, x : Int }",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new aa;this.objectSetupAssign(c,["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "x":this.value.x=this.loadObjectField((f=new ia(this.errors,this.putils,1),p(f,f.loadJson)),
g,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((f=new ia(this.errors,this.putils,1),p(f,f.loadJson)),g,"y",c,this.value.y,b);break;default:this.errors.push(oa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new ia([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1))),y:(new ia([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1)))}},__class__:$a});var Za=function(a,b,c){null==c&&(c=0);B.call(this,
a,b,c)};d.JsonParser_4=Za;Za.__name__=!0;Za.__super__=B;Za.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"Bool",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonBool:function(a,b,c){this.value=a},__class__:Za});var Da=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c);this.value=0};d.JsonParser_5=Da;Da.__name__=!0;Da.__super__=B;Da.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,
"Float",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonFloat(a,b,c,this.value)},__class__:Da});var tb=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_6=tb;tb.__name__=!0;tb.__super__=B;tb.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"peote.view.Color",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=(new O(this.errors,this.putils,0)).loadJson(new Fa(Ba.JNumber(a),
new Ca(b.file,b.min-1,b.max-1)),c)},__class__:tb});var q=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_7=q;q.__name__=!0;q.__super__=B;q.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"{ height : Float, base : Float }",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new aa;this.objectSetupAssign(c,["base","height"],[!1,!1]);this.value=this.getAuto();for(var e=
0;e<a.length;){var g=a[e];++e;switch(g.name){case "base":this.value.base=this.loadObjectField((f=new Da(this.errors,this.putils,1),p(f,f.loadJson)),g,"base",c,this.value.base,b);break;case "height":this.value.height=this.loadObjectField((f=new Da(this.errors,this.putils,1),p(f,f.loadJson)),g,"height",c,this.value.height,b);break;default:this.errors.push(oa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{base:(new Da([],this.putils,
0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1))),height:(new Da([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1)))}},__class__:q});var Ha=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c)};d.JsonParser_8=Ha;Ha.__name__=!0;Ha.__super__=B;Ha.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"{ y : Int, x : Int }",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNull:function(a,b){this.value=null},loadJsonObject:function(a,b,c){c=new aa;this.objectSetupAssign(c,
["x","y"],[!1,!1]);this.value=this.getAuto();for(var e=0;e<a.length;){var g=a[e];++e;switch(g.name){case "x":this.value.x=this.loadObjectField((f=new ia(this.errors,this.putils,1),p(f,f.loadJson)),g,"x",c,this.value.x,b);break;case "y":this.value.y=this.loadObjectField((f=new ia(this.errors,this.putils,1),p(f,f.loadJson)),g,"y",c,this.value.y,b);break;default:this.errors.push(oa.UnknownVariable(g.name,this.putils.convertPosition(g.namePos)))}}this.objectErrors(c,b)},getAuto:function(){return{x:(new ia([],
this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1))),y:(new ia([],this.putils,0)).loadJson(new Fa(Ba.JNull,new Ca("",0,1)))}},__class__:Ha});var ia=function(a,b,c){null==c&&(c=0);B.call(this,a,b,c);this.value=0};d.JsonParser_9=ia;ia.__name__=!0;ia.__super__=B;ia.prototype=F(B.prototype,{onIncorrectType:function(a,b){this.errors.push(oa.IncorrectType(b,"Int",a));B.prototype.onIncorrectType.call(this,a,b)},loadJsonNumber:function(a,b,c){this.value=this.loadJsonInt(a,b,c,this.value)},__class__:ia});
var da=function(){this.isReadyForUpdate=!1;ca.call(this)};d["ob.gum.backends.App"]=da;da.__name__=!0;da.__super__=ca;da.prototype=F(ca.prototype,{init:function(a,b){this.gum=new je(a,b);this.isReadyForUpdate=!0},onWindowCreate:function(){fa.trace("App onWindowCreate",{fileName:"ob/gum/backends/Lime.hx",lineNumber:22,className:"ob.gum.backends.App",methodName:"onWindowCreate"});switch(this.__window.context.type){case "opengl":case "opengles":case "webgl":try{this.init(this.__window)}catch(b){var a=
y.caught(b);fa.trace(zc.toString(zc.exceptionStack()),{fileName:"ob/gum/backends/Lime.hx",lineNumber:28,className:"ob.gum.backends.App",methodName:"onWindowCreate",customParams:[a]})}break;default:throw y.thrown("Sorry, only works with OpenGL.");}},update:function(a){if(this.isReadyForUpdate)this.gum.onUpdate(a)},onKeyDown:function(a,b){this.gum.onKeyDown(a,b)},onKeyUp:function(a,b){this.gum.onKeyUp(a,b)},onMouseMove:function(a,b){this.gum.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.gum.onMouseDown(a,
b,c)},onMouseUp:function(a,b,c){this.gum.onMouseUp(a,b,c)},onMouseWheel:function(a,b,c){this.gum.onMouseScroll(a,b,c)},onWindowResize:function(a,b){ca.prototype.onWindowResize.call(this,a,b);this.gum.onWindowResize(a,b)},__class__:da});var Y=function(){da.call(this)};d.Main=Y;Y.__name__=!0;Y.__super__=da;Y.prototype=F(da.prototype,{init:function(a,b){da.prototype.init.call(this,a,{framesPerSecond:30,drawOnlyWhenRequested:!0,displayWidth:800,displayHeight:600,displayIsScaled:!0});a=new ke(50,37);b=
new le({fonts:["assets/fonts/tiled/hack_ascii.json"],images:["assets/images/bit-bonanza-food.png"]});this.gum.changeLoop(new kb(a,b))},__class__:Y});var Q=function(){};d.ManifestResources=Q;Q.__name__=!0;Q.init=function(a){Q.preloadLibraries=[];Q.preloadLibraryNames=[];Q.rootPath=null;null!=a&&Object.prototype.hasOwnProperty.call(a,"rootPath")&&(Q.rootPath=H.field(a,"rootPath"));null==Q.rootPath&&(Q.rootPath="./");a=Bb.parse('{"name":null,"assets":"aoy4:pathy38:assets%2Fimages%2Fbit-bonanza-food.pngy4:sizei25790y4:typey5:IMAGEy2:idR1y7:preloadtgoR0y27:assets%2Fimages%2Freadme.mdR2i226R3y4:TEXTR5R7R6tgoR0y40:assets%2Ffonts%2Ftiled%2Fhack_ascii.jsonR2i1258R3R8R5R9R6tgoR0y39:assets%2Ffonts%2Ftiled%2Fhack_ascii.pngR2i12425R3R4R5R10R6tgh","rootPath":null,"version":2,"libraryArgs":[],"libraryType":null}',
Q.rootPath);a=Kb.fromManifest(a);X.registerLibrary("default",a);a=X.getLibrary("default");null!=a?Q.preloadLibraries.push(a):Q.preloadLibraryNames.push("default")};Math.__name__=!0;var H=function(){};d.Reflect=H;H.__name__=!0;H.field=function(a,b){try{return a[b]}catch(c){return ma.lastError=c,null}};H.getProperty=function(a,b){var c;if(null==a)return null;var e=a.__properties__?c=a.__properties__["get_"+b]:!1;return e?a[c]():a[b]};H.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,
e;for(e in a)"__id__"!=e&&"hx__closures__"!=e&&c.call(a,e)&&b.push(e)}return b};H.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};H.compareMethods=function(a,b){return a==b?!0:H.isFunction(a)&&H.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};H.copy=function(a){if(null==a)return null;for(var b={},c=0,e=H.fields(a);c<e.length;){var g=e[c];++c;b[g]=H.field(a,g)}return b};var w=function(){};d.Std=w;w.__name__=!0;w.string=function(a){return sa.__string_rec(a,
"")};w.parseInt=function(a){if(null!=a)for(var b=0,c=a.length;b<c;){var e=b++,g=a.charCodeAt(e);if(8>=g||14<=g&&32!=g&&45!=g)if(b=a.charCodeAt(e+1),a=parseInt(a,120==b||88==b?16:10),isNaN(a))break;else return a}return null};var G=function(){};d["_String.String_Impl_"]=G;G.__name__=!0;G.fromCharCode=function(a){return String.fromCodePoint(a)};var gb=function(){this.b=""};d.StringBuf=gb;gb.__name__=!0;gb.prototype={__class__:gb};var W=function(){};d.StringTools=W;W.__name__=!0;W.startsWith=function(a,
b){return a.length>=b.length?0==a.lastIndexOf(b,0):!1};W.endsWith=function(a,b){var c=b.length,e=a.length;return e>=c?a.indexOf(b,e-c)==e-c:!1};W.isSpace=function(a,b){a=J.cca(a,b);return 8<a&&14>a?!0:32==a};W.ltrim=function(a){for(var b=a.length,c=0;c<b&&W.isSpace(a,c);)++c;return 0<c?J.substr(a,c,b-c):a};W.rtrim=function(a){for(var b=a.length,c=0;c<b&&W.isSpace(a,b-c-1);)++c;return 0<c?J.substr(a,0,b-c):a};W.trim=function(a){return W.ltrim(W.rtrim(a))};W.replace=function(a,b,c){return a.split(b).join(c)};
var Ea=function(){};d["ob.gum.ILoop"]=Ea;Ea.__name__=!0;Ea.__isInterface__=!0;Ea.prototype={__class__:Ea};var ua=function(){};d["ob.gum.backends.PeoteViewLoop"]=ua;ua.__name__=!0;ua.__interfaces__=[Ea];ua.prototype={onInit:function(a){this.gum=a;this.peoteView=new me(a.window);this.w=null==a.config.displayWidth?a.window.__width:a.config.displayWidth;this.h=null==a.config.displayHeight?a.window.__height:a.config.displayHeight;this.ratio=this.w/this.h;this.display=new zd(0,0,a.window.__width,a.window.__height,
255);this.peoteView.addDisplay(this.display);this.peoteView.start();this.setZoom()},setZoom:function(){var a=this.display,b=this.gum.window.__width/this.w|0;a.xz=a.zoom*b;if(I.isUBO){var c=a.uniformBuffer,e=a.gl;c.uniformBytes.b_UFloat32[2]=a.xz;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,8,c.xZoomBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null);c=a.uniformBufferFB;e=a.gl;c.uniformBytes.b_UFloat32[2]=a.xz;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);e.bufferSubData(e.UNIFORM_BUFFER,
8,c.xZoomBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}a.xZoom=b;a=this.display;b=this.gum.window.__height/this.h|0;a.yz=a.zoom*b;I.isUBO&&(c=a.uniformBuffer,e=a.gl,c.uniformBytes.b_UFloat32[3]=a.yz,e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer),e.bufferSubData(e.UNIFORM_BUFFER,12,c.yZoomBufferPointer),e.bindBuffer(e.UNIFORM_BUFFER,null),c=a.uniformBufferFB,e=a.gl,c.uniformBytes.b_UFloat32[3]=a.yz,e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer),e.bufferSubData(e.UNIFORM_BUFFER,12,c.yZoomBufferPointer),
e.bindBuffer(e.UNIFORM_BUFFER,null));a.yZoom=b;this.display.width=this.gum.window.__width;this.display.height=this.gum.window.__height},onUpdate:function(a){},onTick:function(a){return!1},onDraw:function(a){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){this.peoteView.resize(a,b);this.setZoom()},getFrameBufferDisplay:function(a,b,c,e,g){a=new zd(a,
b,c,e);this.peoteView.addDisplay(a);this.peoteView.renderToTexture(a,0);this.peoteView.addFramebufferDisplay(a);c=new Nc(c,e);c.clearOnRenderInto=!g;a.setFramebuffer(c);this.peoteView.removeDisplay(a);return new ne(c,a)},__class__:ua};var l=function(a){this.alwaysDraw=!1;this.onInitComplete=function(){throw y.thrown("You must set onInitComplete function!");};this.assets=a;this.keyboard=new oe([])};d["tyke.PhysicalStageLoop"]=l;l.__name__=!0;l.__super__=ua;l.prototype=F(ua.prototype,{onInit:function(a){var b=
this;ua.prototype.onInit.call(this,a);this.assets.Preload(function(){b.initWorldAndStage();b.onInitComplete()})},initWorldAndStage:function(){this.stage=new pe(this.display,this);this.world=na.start({width:this.display.width,height:this.display.height,gravity_y:100,iterations:2})},onTick:function(a){return this.alwaysDraw?!0:!1},onUpdate:function(a){na.step(this.world,a/1E3)},onDraw:function(a){this.stage.updateGraphicsBuffers()},onKeyDown:function(a,b){this.keyboard.handle(a,this)},__class__:l});
var kb=function(a,b){var c=this;l.call(this,b);this.onInitComplete=function(){c.setupBackgroundLayer();var a=Math.ceil(c.stage.get_width()/b.fontCache[0].config.width),g=Math.ceil(c.stage.get_height()/b.fontCache[0].config.height);c.soup=new V(a,g,c.stage,b.fontCache[0]);c.salad=new C(c.world,c.stage,b.imageCache[0]);c.stage.globalFilter("globalCompose(globalFramebuffer_ID)","\n\t\t\tfloat greyScale(in vec3 col) {\n\t\t\t\treturn dot(col, vec3(0.2126, 0.7152, 0.0722));\n\t\t\t}\n\n\t\t\tmat2 rotate2d(float angle){\n\t\t\t\treturn mat2(cos(angle), -sin(angle), sin(angle),cos(angle));\n\t\t\t}\n\n\t\t\tfloat dotScreen(in vec2 uv, in float angle, in float scale, vec2 res) {\n\t\t\t\tfloat s = sin( angle ), c = cos( angle );\n\t\t\t\tvec2 p = (uv - vec2(0.5)) * res.xy;\n\t\t\t\tvec2 q = rotate2d(angle) * p * scale; \n\t\t\t\treturn ( sin( q.x ) * sin( q.y ) ) * 4.0;\n\t\t\t}\n\t\t\t\n\t\t\tvec4 globalCompose( int textureID ){\n\t\t\t\tvec2 uv = vTexCoord;\n\t\t\t\tvec3 col = getTextureColor(textureID, vTexCoord).rgb; \n\t\t\t\tfloat grey = greyScale(col); \n\t\t\t\tfloat angle = 0.4;\n\t\t\t\tfloat scale = 1.0 + 0.8 * sin(uTime); \n\t\t\t\tvec2 res = getTextureResolution(textureID);\n\t\t\t\tcol = vec3( grey * 10.0 - 5.0 + dotScreen(uv, angle, scale, res ) );\n\t\t\t\tvec3 tex = getTextureColor(textureID, vTexCoord).rgb;\n\t\t\t\treturn vec4( mix(col, tex, 0.9), 1.0 );\n\t\t\t}\n\t\t\t");
c.alwaysDraw=!0;c.gum.toggleUpdate(!0)};this.keyboard.bind(112,"PAUSE","TOGGLE UPDATE",function(a){c.gum.toggleUpdate()})};d.TYKE=kb;kb.__name__=!0;kb.__super__=l;kb.prototype=F(l.prototype,{onTick:function(a){this.soup.onTick(a);this.salad.onTick(a);return this.alwaysDraw},setupBackgroundLayer:function(){var a=new qe(this.stage.get_width(),this.stage.get_height(),hb.Hues,!0),b=this.stage.createLayer("bg",!1);a.addToDisplay(b.get_display())},__class__:kb});var V=function(a,b,c,e){this.elapsedTicks=
0;this.gain=.02;this.waves=2;this.word="TYKE";var g=this;this.glyphRender=c.createGlyphRendererLayer("wordSoup",e);var h=this.glyphRender.get_fontProgram().fontStyle.width,x=this.glyphRender.get_fontProgram().fontStyle.height;a=new re(a,b,Math.ceil(h),Math.ceil(x),new se(tc.toRGBA(Ye.Versitle)),function(a,b){var c=u(g.word.length)-1;c=J.cca(g.word,c);a*=h;b*=x;var e=g.glyphRender.get_fontProgram(),k=g.glyphRender.get_fontProgram().fontStyle,d=e.font;d=c>=d.rangeMapping.min&&c<=d.rangeMapping.max?
d.rangeMapping:null;if(null!=d){var Gc=new va;k=null!=k?k:e.fontStyle;Gc.width=k.width;Gc.height=k.height;Gc.color=k.color;Gc.bgColor=k.bgColor;Gc.weight=k.weight;Gc.tilt=k.tilt;Gc.zIndex=k.zIndex;Gc.char=c;Gc.tile=c-d.min;Gc.x=a;Gc.y=b;e._buffer.addElement(Gc);a=Gc}else a=null;return new ed(c,a,4,-1,1)});this.glyphs=new fd(a,this.glyphRender.get_fontProgram())};d.WordSoup=V;V.__name__=!0;V.prototype={onTick:function(a){var b=this;this.elapsedTicks++;this.glyphs.forEach(function(a,e,g){var c=.5+.5*
Math.cos(b.elapsedTicks+e+2),x=.5+.5*Math.cos(b.elapsedTicks+a+4);e=Math.sin(a-e*b.waves*b.elapsedTicks*b.gain);g.glyph.color=g.glyph.color&16777215|Math.ceil(255*(.5+.5*Math.cos(b.elapsedTicks+a)))<<24;g.glyph.color=g.glyph.color&-16711681|Math.ceil(255*c)<<16;g.glyph.color=g.glyph.color&-65281|Math.ceil(255*x)<<8;g.glyph.color=g.glyph.color&-256|Math.ceil(127*e+127);g.char=J.cca(b.word,Math.ceil((.5+.5*Math.sin(.3*b.elapsedTicks+a+4))*b.word.length)-1);c=b.glyphRender.get_fontProgram();a=g.glyph;
g=g.char;c=c.font;c=g>=c.rangeMapping.min&&g<=c.rangeMapping.max?c.rangeMapping:null;null!=c&&(a.char=g,a.tile=g-c.min)})},__class__:V};var C=function(a,b,c){this.spriteScale=3;this.colliders=[];this.timer=0;this.frameSize=10;this.world=a;this.stage=b;this.sprites=[];this.initSprites(c);this.initEdges();this.initCollisionListeners()};d.SimulationSalad=C;C.__name__=!0;C.prototype={initSprites:function(a){this.spriteFrames=this.stage.createSpriteRendererLayer("fruitSprites",a,this.frameSize);this.debugLayer=
this.stage.createShapeRenderLayer("echo")},initEdges:function(){this.makeEdge(.5*this.stage.get_width()|0,0,this.stage.get_width()+80,40);this.makeEdge(.5*this.stage.get_width()|0,this.stage.get_height(),this.stage.get_width()+80,40);this.makeEdge(20,.5*this.stage.get_height()|0,40,this.stage.get_height()+80)},makeEdge:function(a,b,c,e){na.make(this.world,{shape:{type:0,width:c,height:e},mass:0,x:a,y:b,elasticity:2})},initCollisionListeners:function(){na.listen(this.world,null,null,{enter:function(a,
b,c){if(null!=a.sprite){c=u(30);a.sprite.tile=c+4;(c=0!=a.rotational_velocity)||(c=void 0,null==c&&(c=50),c=Math.random()<c/100);if(c){var e=10*a.mass;c=a.rotational_velocity;var g=e;e+=10;null==e&&(e=1);null==g&&(g=0);a.rotational_velocity=c-(g+Math.random()*(e-g))}null!=b.sprite&&(b.sprite.tile=a.sprite.tile)}}})},onTick:function(a){for(var b=0,c=this.colliders;b<c.length;){var e=c[b];++b;e.transform.local_x>this.stage.get_width()+100&&(e.active=!1)}b=750-u(300);this.timer+=a;if(this.timer>b){a=
{elasticity:.5,mass:10-u(5),x:-100,y:-100,max_velocity_x:900,max_velocity_y:900,max_rotational_velocity:200,shape:{type:0,width:50,height:50}};b=new Wa(a);c=4;null==c&&(c=0);var g=this.spriteFrames.makeSprite(-100,-100,a.shape.width*this.spriteScale|0,c);b.on_move=function(a,b){g.move(a,b)};b.on_rotate=function(a){g.rotate(a)};b.sprite=g;g.c=g.c&-256|Math.ceil(5/b.mass*95)+160;this.sprites.push(g);this.colliders.push(b);b=this.world.add(b);a=this.world;b.set_position(a.width-20,a.height/2);a=b.velocity;
a.x=-3E3;a.y=3E3;this.timer=0}},__class__:C};var hb=function(){};d.ColorFilterFormulas=hb;hb.__name__=!0;var ja=function(){};d.Type=ja;ja.__name__=!0;ja.createInstance=function(a,b){return new (Function.prototype.bind.apply(a,[null].concat(b)))};ja.createEnum=function(a,b,c){var e=H.field(a,b);if(null==e)throw y.thrown("No such constructor "+b);if(H.isFunction(e)){if(null==c)throw y.thrown("Constructor "+b+" need parameters");return e.apply(a,c)}if(null!=c&&0!=c.length)throw y.thrown("Constructor "+
b+" does not need parameters");return e};var bb={toFloat:function(a){return 0>a?4294967296+a:a+0}},Ia=function(){};d["echo.util.Disposable"]=Ia;Ia.__name__=!0;Ia.__isInterface__=!0;var Wa=function(a){this.transform=new Yc;this.layer_mask=mf._new();this.layers=mf._new();var b=new P(0,0);this.drag=b;this.max_velocity=b=new P(0,0);this.torque=0;this.acceleration=b=new P(0,0);this.velocity=b=new P(0,0);this.material=Lb.global;this.id=++Wa.ids;this.active=!0;this.shapes=[];this.data={};this.disposed=!1;
this.transform.on_dirty=p(this,this.on_dirty);this.load_options(a)};d["echo.Body"]=Wa;Wa.__name__=!0;Wa.__interfaces__=[Ia];Wa.__properties__={get_defaults:"get_defaults"};Wa.get_defaults=function(){return{kinematic:!1,mass:Wa.default_mass,x:0,y:0,rotation:0,scale_x:1,scale_y:1,velocity_x:0,velocity_y:0,rotational_velocity:0,max_velocity_x:0,max_velocity_y:0,max_velocity_length:0,max_rotational_velocity:1E4,drag_x:0,drag_y:0,drag_length:0,rotational_drag:0}};Wa.prototype={load_options:function(a){a=
Ad.copy_fields(a,Wa.get_defaults());for(var b=0,c=this.shapes;b<c.length;){var e=c[b];++b;e.put()}this.shapes.length=0;c=a.x;b=this.transform;b.dirty||b.set_dirty();b.local_x=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);c=a.y;b=this.transform;b.dirty||b.set_dirty();b.local_y=c;if(null!=this.on_move)this.on_move(this.transform.local_x,this.transform.local_y);b=this.transform;c=Math.PI/180*a.rotation;b.dirty||b.set_dirty();b.local_radians=c;if(null!=this.on_rotate)this.on_rotate(180/
Math.PI*this.transform.local_radians);c=a.scale_x;b=this.transform;b.dirty||b.set_dirty();b.local_scale_x=c;c=a.scale_y;b=this.transform;b.dirty||b.set_dirty();b.local_scale_y=c;this.kinematic=a.kinematic;this.material=null!=a.material?a.material:null!=a.gravity_scale||null!=a.elasticity?new Lb(a.elasticity,null,null,null,a.gravity_scale):Lb.global;c=this.velocity;c.x=a.velocity_x;c.y=a.velocity_y;this.rotational_velocity=a.rotational_velocity;c=this.max_velocity;c.x=a.max_velocity_x;c.y=a.max_velocity_y;
this.max_velocity_length=a.max_velocity_length;this.max_rotational_velocity=a.max_rotational_velocity;c=this.drag;c.x=a.drag_x;c.y=a.drag_y;this.drag_length=a.drag_length;this.rotational_drag=a.rotational_drag;this.last_rotation=this.last_y=this.last_x=NaN;this.dirty=!0;if(null!=a.shape){e=eb.get(a.shape);var g=-1;null==g&&(g=-1);-1==this.shapes.indexOf(e)&&(-1<g?this.shapes[g]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),
this.world.static_quadtree.update(this.quadtree_data)))}if(null!=a.shapes)for(b=0,c=a.shapes;b<c.length;)e=c[b],++b,e=eb.get(e),g=-1,null==g&&(g=-1),-1==this.shapes.indexOf(e)&&(-1<g?this.shapes[g]=e:this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));null!=a.shape_instance&&(e=a.shape_instance,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=
!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))));if(null!=a.shape_instances)for(b=0,c=a.shape_instances;b<c.length;)e=c[b],++b,-1==this.shapes.indexOf(e)&&(this.shapes.push(e),e.set_parent(this),this.dirty=!0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data)));b=a.mass;if(null==b)c=a.mass,c<Wa.minimum_mass?(this.mass=this.inverse_mass=0,0>=
this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);else switch(b){case -1:b=a=0;for(c=this.shapes;b<c.length;)e=c[b],++b,a+=e.volume()*this.material.density;a<Wa.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):
(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=a,this.inverse_mass=1/this.mass);break;case 0:c=0;c<Wa.minimum_mass?(this.mass=this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass);break;default:c=a.mass,c<Wa.minimum_mass?(this.mass=
this.inverse_mass=0,0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))):(0>=this.mass&&null!=this.world&&this.world.static_quadtree.remove(this.quadtree_data),this.mass=c,this.inverse_mass=1/this.mass)}},set_position:function(a,b){null==b&&(b=0);null==a&&(a=0);var c=this.transform;null==b&&(b=0);null==a&&(a=0);c.dirty||c.set_dirty();c.local_x=a;c.dirty||c.set_dirty();c.local_y=b},bounds:function(a){if(0==this.shapes.length){var b=
this.transform.local_x,c=this.transform.local_y,e=1,g=1;null==g&&(g=1);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);a=Sa.pool.get();var h=b;null==g&&(g=1);null==e&&(e=1);null==c&&(c=0);null==h&&(h=0);e*=.5;g*=.5;a.min_x=h-e;a.min_y=c-g;a.max_x=h+e;a.max_y=c+g;a.pooled=!1;return a}h=this.shapes[0].bounds();if(1<this.shapes.length)for(g=1,e=this.shapes.length;g<e;)c=g++,c=this.shapes[c].bounds(),h.min_x>c.min_x&&(h.min_x=c.min_x),h.min_y>c.min_y&&(h.min_y=c.min_y),h.max_x<c.max_x&&(h.max_x=c.max_x),
h.max_y<c.max_y&&(h.max_y=c.max_y),c.put();null==a&&(a=Sa.pool.get(),c=b=0,g=e=1,null==g&&(g=1),null==e&&(e=1),null==c&&(c=0),null==b&&(b=0),e*=.5,g*=.5,a.min_x=b-e,a.min_y=c-g,a.max_x=b+e,a.max_y=c+g,a.pooled=!1);a.min_x=h.min_x;a.max_x=h.max_x;a.min_y=h.min_y;a.max_y=h.max_y;h.put();return a},on_dirty:function(a){this.dirty=!0;0>=this.mass&&null!=this.world&&(this.bounds(this.quadtree_data.bounds),this.world.static_quadtree.update(this.quadtree_data))},__class__:Wa};var za=function(){};d["echo.Collisions"]=
za;za.__name__=!0;za.update_quadtree=function(a){for(var b=0,c=a.members;b<c.length;){var e=c[b];++b;if(!e.disposed){e.collided=!1;for(var g=0,h=e.shapes;g<h.length;){var x=h[g];++g;x.collided=!1}e.active&&0<e.mass&&e.dirty&&0<e.shapes.length&&(null==e.quadtree_data.bounds?e.quadtree_data.bounds=e.bounds():e.bounds(e.quadtree_data.bounds),a.quadtree.update(e.quadtree_data,!1),e.dirty=!1)}}a.quadtree.shake()};za.query=function(a,b){za.update_quadtree(a);b=null==b?a.listeners.members:b.members;for(var c=
0;c<b.length;){var e=b[c];++c;e.quadtree_results.length=0;var g=e.a;switch(g._hx_index){case 0:g=g.v;var h=e.b;switch(h._hx_index){case 0:g=za.overlap_body_and_body_bounds(g,h.v);null!=g&&e.quadtree_results.push(g);break;case 1:za.overlap_body_and_bodies_bounds(g,h.v,a,e.quadtree_results)}break;case 1:switch(g=g.v,h=e.b,h._hx_index){case 0:za.overlap_body_and_bodies_bounds(h.v,g,a,e.quadtree_results);break;case 1:h=h.v,za.overlap_bodies_and_bodies_bounds(g,h,a,e.quadtree_results),g!=h&&za.overlap_bodies_and_bodies_bounds(h,
g,a,e.quadtree_results)}}g=0;for(h=e.last_collisions;g<h.length;){var x=h[g];++g;x.put()}e.last_collisions.length=e.collisions.length;g=0;for(h=e.collisions.length;g<h;)x=g++,e.last_collisions[x]=e.collisions[x];g=e.collisions.length=0;for(h=e.quadtree_results;g<h.length;)if(x=h[g],++g,x.a.disposed||x.b.disposed)x.put();else if(x.a.id==x.b.id)x.put();else{for(var k=!1,d=0,ba=e.collisions;d<ba.length;){var N=ba[d];++d;if(N.a.id==x.a.id&&N.b.id==x.b.id||N.b.id==x.a.id&&N.a.id==x.b.id){k=!0;break}}if(k)x.put();
else{if(1==x.a.shapes.length&&1==x.b.shapes.length)k=x.a.shapes[0].collides(x.b.shapes[0]),null!=k&&x.data.push(k);else for(k=x.a.shapes,d=0,ba=k.length;d<ba;){N=d++;for(var r=x.b.shapes,f=k[N].bounds(),n=0,l=r.length;n<l;){var C=n++,V=r[C].bounds();f.min_x<V.max_x&&f.max_x>=V.min_x&&f.min_y<V.max_y&&f.max_y>=V.min_y&&(C=k[N].collides(r[C]),null!=C&&x.data.push(C));V.put()}f.put()}if(0==x.data.length)x.put();else if(null==e.condition||e.condition(x.a,x.b,x.data)&&!x.a.disposed&&!x.b.disposed){k=0;
for(d=x.data;k<d.length;)ba=d[k],++k,ba.sa.collided=ba.sb.collided=!0;x.a.collided=x.b.collided=!0;e.collisions.push(x)}else x.put()}}}};za.notify=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(null!=c.enter||null!=c.stay)for(var e=0,g=c.collisions;e<g.length;){var h=g[e];++e;if(!h.a.disposed&&!h.b.disposed){if(null!=c.enter){var x=!1;for(var k=0,d=c.last_collisions;k<d.length;){var ba=d[k];++k;if(ba.a==h.a&&ba.b==h.b||ba.a==h.b&&ba.b==h.a){x=!0;break}}x=
!x}else x=!1;x?c.enter(h.a,h.b,h.data):null!=c.stay&&c.stay(h.a,h.b,h.data)}}if(null!=c.exit)for(e=0,g=c.last_collisions;e<g.length;){h=g[e];++e;if(h.a.disposed||h.b.disposed)x=!1;else{x=!1;k=0;for(d=c.collisions;k<d.length;)if(ba=d[k],++k,ba.a==h.a&&ba.b==h.b||ba.a==h.b&&ba.b==h.a){x=!0;break}x=!x}x&&c.exit(h.a,h.b)}}};za.overlap_bodies_and_bodies_bounds=function(a,b,c,e){if(0!=a.length&&0!=b.length)for(var g=0;g<a.length;){var h=a[g];++g;za.overlap_body_and_bodies_bounds(h,b,c,e)}};za.overlap_body_and_bodies_bounds=
function(a,b,c,e){if(!(a.disposed||0==a.shapes.length||!a.active||0>=a.mass)){var g=a.bounds();za.qr.length=0;za.sqr.length=0;c.quadtree.query(g,za.qr);c.static_quadtree.query(g,za.sqr);for(c=0;c<b.length;){var h=b[c];++c;if(!h.disposed&&0!=h.shapes.length&&h.active&&(0==a.layer_mask||0==h.layer_mask||0!=(a.layer_mask&h.layers)&&0!=(h.layer_mask&a.layers)))for(var x=0,k=0<h.mass?za.qr:za.sqr;x<k.length;){var d=k[x];++x;d.id==h.id&&(d=qc.pool.get(),d.a=a,d.b=h,d.data.length=0,d.pooled=!1,e.push(d))}}g.put()}};
za.overlap_body_and_body_bounds=function(a,b){if(a.disposed||b.disposed||0==a.shapes.length||0==b.shapes.length||!a.active||!b.active||a==b||0!=a.layer_mask&&0!=b.layer_mask&&(0==(a.layer_mask&b.layers)||0==(b.layer_mask&a.layers))||0>=a.mass&&0>=b.mass)return null;var c=a.bounds(),e=b.bounds(),g=c.min_x<e.max_x&&c.max_x>=e.min_x&&c.min_y<e.max_y&&c.max_y>=e.min_y;c.put();e.put();return g?(c=qc.pool.get(),c.a=a,c.b=b,c.data.length=0,c.pooled=!1,c):null};var pb=function(a){this.members=null==a?[]:
a};d["echo.Listeners"]=pb;pb.__name__=!0;pb.__interfaces__=[Ia];pb.prototype={add:function(a,b,c){c=Ad.copy_fields(c,Ub.get_defaults());a=new Ub(a,b,c.separate,[],[],null,null,null,null,[],c.percent_correction,c.correction_threshold);null!=c.enter&&(a.enter=c.enter);null!=c.stay&&(a.stay=c.stay);null!=c.exit&&(a.exit=c.exit);null!=c.condition&&(a.condition=c.condition);this.members.push(a);return a},clear:function(){this.members.length=0},__class__:pb};var na=m.echo.Echo=function(){};d["echo.Echo"]=
na;na.__name__=!0;na.start=function(a){return new Hc(a)};na.make=function(a,b){return a.add(new Wa(b))};na.listen=function(a,b,c,e){return null==b?null==c?a.listeners.add(gd.Right(a.members),gd.Right(a.members),e):a.listeners.add(c,c,e):null==c?a.listeners.add(b,b,e):a.listeners.add(b,c,e)};na.check=function(a,b,c,e){na.cached_listeners.clear();null==b&&null==c?na.cached_listeners.add(gd.Right(a.members),gd.Right(a.members),e):null==b?na.cached_listeners.add(c,c,e):null==c?na.cached_listeners.add(b,
b,e):na.cached_listeners.add(b,c,e);za.query(a,na.cached_listeners);hd.separate(a,na.cached_listeners);za.notify(a,na.cached_listeners)};na.step=function(a,b){if(null!=a.history){for(var c=a.history,e=[],g=0,h=a.members;g<h.length;){var x=h[g];++g;e.push(new te(x.id,x.transform.local_x,x.transform.local_y,180/Math.PI*x.transform.local_radians,x.velocity.x,x.velocity.y,x.acceleration.x,x.acceleration.y,x.rotational_velocity))}c.add(e)}b/=a.iterations;e=0;for(g=a.iterations;e<g;)e++,hd.step(a,b),za.query(a),
hd.separate(a),za.notify(a)};na.linecast_floats=function(a,b,c,e,g,h,x){null==x&&(x=!0);null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var k=Mb.pool.get();null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var d=k.start;d.x=a;d.y=b;d=k.end;d.x=c;d.y=e;k.pooled=!1;g=na.linecast(k,g,h,x);k.pooled||(k.pooled=!0,Mb.pool.put_unsafe(k));return g};na.linecast_vector=function(a,b,c,e,g,h){null==h&&(h=!0);var x=Mb.pool.get();x.set_from_vector(a,b,c);x.pooled=!1;a=na.linecast(x,e,g,h);
x.pooled||(x.pooled=!0,Mb.pool.put_unsafe(x));return a};na.linecast_vectors=function(a,b,c,e,g){g=a.x;var h=a.y;a=b.x;var x=b.y;null==x&&(x=1);null==a&&(a=1);null==h&&(h=0);null==g&&(g=0);b=Mb.pool.get();null==x&&(x=1);null==a&&(a=1);null==h&&(h=0);null==g&&(g=0);var k=b.start;k.x=g;k.y=h;k=b.end;k.x=a;k.y=x;b.pooled=!1;c=na.linecast(b,c,e);b.pooled||(b.pooled=!0,Mb.pool.put_unsafe(b));return c};na.linecast=function(a,b,c,e){null==e&&(e=!0);var g=null,h=Math.min(a.start.x,a.end.x),x=Math.min(a.start.y,
a.end.y),k=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,a.end.y),ba=Sa.pool.get();ba.min_x=h;ba.max_x=k;ba.min_y=x;ba.max_y=d;ba.pooled=!1;var N=b;switch(N._hx_index){case 0:var r=N.v;if(!r.disposed&&r.active){var f=r.bounds();if(ba.min_x<f.max_x&&ba.max_x>=f.min_x&&ba.min_y<f.max_y&&ba.max_y>=f.min_y){var n=0;for(e=r.shapes.length;n<e;)x=n++,h=r.shapes[x].intersect(a),null!=h&&(null==g&&(x=yb.pool.get(),x.line=a,x.body=r,x.data.length=0,x.pooled=!1,g=x),g.data.push(h))}f.put()}break;case 1:if(b=
N.v,null==c)for(N=0;N<b.length;){if(r=b[N],++N,null!=r&&!r.disposed&&r.active){f=r.bounds();x=yb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;if(ba.min_x<f.max_x&&ba.max_x>=f.min_x&&ba.min_y<f.max_y&&ba.max_y>=f.min_y)for(n=0,e=r.shapes.length;n<e;)x=n++,h=r.shapes[x].intersect(a),null!=h&&c.data.push(h);f.put();if(0<c.data.length)if(null!=g){if(0==g.data.length)h=null;else if(1==g.data.length)h=g.data[0];else{f=g.data[0];r=1;for(h=g.data.length;r<h;)x=r++,null!=g.data[x]&&g.data[x].distance<
f.distance&&(f=g.data[x]);h=f}f=h.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];e=1;for(h=c.data.length;e<h;)x=e++,null!=c.data[x]&&c.data[x].distance<r.distance&&(r=c.data[x]);e=r}h=f>e.distance}else h=!0;else h=!1;h?(null!=g&&g.put(),g=c):c.put()}}else{N=0;for(n=na.cached_collisions;N<n.length;)f=n[N],++N,f.put();na.cached_collisions.length=0;f=na.cached_body;h=ba.min_x;x=ba.min_y;k=ba.max_x;d=ba.max_y;r=Vb.pool.get();N=.5*(h+k);n=.5*(x+d);h=k-h;d-=x;
null==d&&(d=0);null==h&&(h=1);null==n&&(n=0);null==N&&(N=0);k=r.transform;k.dirty||k.set_dirty();k.local_x=N;k=r.transform;k.dirty||k.set_dirty();k.local_y=n;N=.5*h;k=r.transform;null==k.parent?n=k.local_scale_x:(k.sync(),n=k._scale_x);r.local_ex=N/n;if(null!=r.transformed_rect){k=r.transformed_rect;k.count=4;N=0;for(n=k.count;N<n;)if(x=N++,null==k.local_vertices[x]){var l=k.local_vertices,C=new P(0,0);l[x]=C}N=k.local_vertices[0];N.x=-(r.local_ex*r.transform.local_scale_x);N.y=-(r.local_ey*r.transform.local_scale_y);
N=k.local_vertices[1];N.x=r.local_ex*r.transform.local_scale_x;N.y=-(r.local_ey*r.transform.local_scale_y);N=k.local_vertices[2];N.x=r.local_ex*r.transform.local_scale_x;N.y=r.local_ey*r.transform.local_scale_y;N=k.local_vertices[3];N.x=-(r.local_ex*r.transform.local_scale_x);N.y=r.local_ey*r.transform.local_scale_y;N=r.transform.local_x;l=k.transform;l.dirty||l.set_dirty();l.local_x=N;N=r.transform.local_y;l=k.transform;l.dirty||l.set_dirty();l.local_y=N;l=k.transform;N=Math.PI/180*(180/Math.PI)*
r.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=N;N=r.transform.local_scale_x;l=k.transform;l.dirty||l.set_dirty();l.local_scale_x=N;N=r.transform.local_scale_y;l=k.transform;l.dirty||l.set_dirty();l.local_scale_y=N;k.dirty_vertices=!0;k.dirty_bounds=!0}N=.5*(0>=d?h:d);k=r.transform;null==k.parent?n=k.local_scale_y:(k.sync(),n=k._scale_y);r.local_ey=N/n;if(null!=r.transformed_rect){k=r.transformed_rect;k.count=4;N=0;for(n=k.count;N<n;)x=N++,null==k.local_vertices[x]&&(l=k.local_vertices,
C=new P(0,0),l[x]=C);N=k.local_vertices[0];N.x=-(r.local_ex*r.transform.local_scale_x);N.y=-(r.local_ey*r.transform.local_scale_y);N=k.local_vertices[1];N.x=r.local_ex*r.transform.local_scale_x;N.y=-(r.local_ey*r.transform.local_scale_y);N=k.local_vertices[2];N.x=r.local_ex*r.transform.local_scale_x;N.y=r.local_ey*r.transform.local_scale_y;N=k.local_vertices[3];N.x=-(r.local_ex*r.transform.local_scale_x);N.y=r.local_ey*r.transform.local_scale_y;N=r.transform.local_x;l=k.transform;l.dirty||l.set_dirty();
l.local_x=N;N=r.transform.local_y;l=k.transform;l.dirty||l.set_dirty();l.local_y=N;l=k.transform;N=Math.PI/180*(180/Math.PI)*r.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=N;N=r.transform.local_scale_x;l=k.transform;l.dirty||l.set_dirty();l.local_scale_x=N;N=r.transform.local_scale_y;l=k.transform;l.dirty||l.set_dirty();l.local_scale_y=N;k.dirty_vertices=!0;k.dirty_bounds=!0}k=r.transform;N=Math.PI/180*0;k.dirty||k.set_dirty();k.local_radians=N;k=r.transform;k.dirty||k.set_dirty();
k.local_scale_x=1;k=r.transform;k.dirty||k.set_dirty();k.local_scale_y=1;null==r.transformed_rect?(k=r.transform,null==k.parent?h=180/Math.PI*k.local_radians:(k.sync(),h=180/Math.PI*k._radians),h=0!=h):h=!1;if(h){h=Xa.pool.get();h.count=4;N=0;for(n=h.count;N<n;)x=N++,null==h.local_vertices[x]&&(d=h.local_vertices,C=new P(0,0),d[x]=C);N=h.local_vertices[0];N.x=-(r.local_ex*r.transform.local_scale_x);N.y=-(r.local_ey*r.transform.local_scale_y);N=h.local_vertices[1];N.x=r.local_ex*r.transform.local_scale_x;
N.y=-(r.local_ey*r.transform.local_scale_y);N=h.local_vertices[2];N.x=r.local_ex*r.transform.local_scale_x;N.y=r.local_ey*r.transform.local_scale_y;N=h.local_vertices[3];N.x=-(r.local_ex*r.transform.local_scale_x);N.y=r.local_ey*r.transform.local_scale_y;N=r.transform.local_x;k=h.transform;k.dirty||k.set_dirty();k.local_x=N;N=r.transform.local_y;k=h.transform;k.dirty||k.set_dirty();k.local_y=N;k=h.transform;N=Math.PI/180*(180/Math.PI)*r.transform.local_radians;k.dirty||k.set_dirty();k.local_radians=
N;N=r.transform.local_scale_x;k=h.transform;k.dirty||k.set_dirty();k.local_scale_x=N;N=r.transform.local_scale_y;k=h.transform;k.dirty||k.set_dirty();k.local_scale_y=N;h.dirty_vertices=!0;h.dirty_bounds=!0;h.pooled=!1;r.transformed_rect=h;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(N=r.transform.local_x,k=r.transformed_rect.transform,k.dirty||k.set_dirty(),k.local_x=N,N=r.transform.local_y,k=r.transformed_rect.transform,k.dirty||k.set_dirty(),k.local_y=N,k=r.transformed_rect.transform,
N=Math.PI/180*(180/Math.PI)*r.transform.local_radians,k.dirty||k.set_dirty(),k.local_radians=N,N=r.transform.local_scale_x,k=r.transformed_rect.transform,k.dirty||k.set_dirty(),k.local_scale_x=N,N=r.transform.local_scale_y,k=r.transformed_rect.transform,k.dirty||k.set_dirty(),k.local_scale_y=N);r.pooled=!1;null!=f.shapes[0]&&f.shapes[0].put();f.shapes[0]=r;f.shapes[0].set_parent(f);f.dirty=!0;0>=f.mass&&null!=f.world&&(f.bounds(f.quadtree_data.bounds),f.world.static_quadtree.update(f.quadtree_data));
e&&za.update_quadtree(c);za.overlap_body_and_bodies_bounds(na.cached_body,b,c,na.cached_collisions);N=0;for(n=na.cached_collisions;N<n.length;){f=n[N];++N;r=f.b;x=yb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;e=0;for(r=f.b.shapes.length;e<r;)x=e++,h=f.b.shapes[x].intersect(a),null!=h&&c.data.push(h);if(0<c.data.length)if(null!=g){if(0==g.data.length)h=null;else if(1==g.data.length)h=g.data[0];else{f=g.data[0];h=1;for(e=g.data.length;h<e;)x=h++,null!=g.data[x]&&g.data[x].distance<
f.distance&&(f=g.data[x]);h=f}f=h.distance;if(0==c.data.length)e=null;else if(1==c.data.length)e=c.data[0];else{r=c.data[0];h=1;for(b=c.data.length;h<b;)x=h++,null!=c.data[x]&&c.data[x].distance<r.distance&&(r=c.data[x]);e=r}h=f>e.distance}else h=!0;else h=!1;h?(null!=g&&g.put(),g=c):c.put()}na.cached_body.shapes[0].put()}}ba.put();return g};na.linecast_all=function(a,b,c,e){null==e&&(e=!0);var g=[],h=Math.min(a.start.x,a.end.x),x=Math.min(a.start.y,a.end.y),k=Math.max(a.start.x,a.end.x),d=Math.max(a.start.y,
a.end.y),ba=Sa.pool.get();ba.min_x=h;ba.max_x=k;ba.min_y=x;ba.max_y=d;ba.pooled=!1;var f=b;switch(f._hx_index){case 0:var r=f.v;x=yb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;var l=r.bounds();if(ba.min_x<l.max_x&&ba.max_x>=l.min_x&&ba.min_y<l.max_y&&ba.max_y>=l.min_y){var n=0;for(e=r.shapes.length;n<e;)x=n++,x=r.shapes[x].intersect(a),null!=x&&c.data.push(x)}l.put();0<c.data.length?g.push(c):c.put();break;case 1:if(b=f.v,null==c)for(f=0;f<b.length;){if(r=b[f],++f,null!=r){l=r.bounds();
x=yb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;if(ba.min_x<l.max_x&&ba.max_x>=l.min_x&&ba.min_y<l.max_y&&ba.max_y>=l.min_y)for(n=0,e=r.shapes.length;n<e;)x=n++,x=r.shapes[x].intersect(a),null!=x&&c.data.push(x);l.put();0<c.data.length?g.push(c):c.put()}}else{f=0;for(n=na.cached_collisions;f<n.length;)l=n[f],++f,l.put();na.cached_collisions.length=0;l=na.cached_body;h=ba.min_x;x=ba.min_y;k=ba.max_x;d=ba.max_y;r=Vb.pool.get();f=.5*(h+k);n=.5*(x+d);h=k-h;d-=x;null==d&&(d=0);null==
h&&(h=1);null==n&&(n=0);null==f&&(f=0);k=r.transform;k.dirty||k.set_dirty();k.local_x=f;k=r.transform;k.dirty||k.set_dirty();k.local_y=n;f=.5*h;k=r.transform;null==k.parent?n=k.local_scale_x:(k.sync(),n=k._scale_x);r.local_ex=f/n;if(null!=r.transformed_rect){k=r.transformed_rect;k.count=4;f=0;for(n=k.count;f<n;)if(x=f++,null==k.local_vertices[x]){var C=k.local_vertices,V=new P(0,0);C[x]=V}f=k.local_vertices[0];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=-(r.local_ey*r.transform.local_scale_y);
f=k.local_vertices[1];f.x=r.local_ex*r.transform.local_scale_x;f.y=-(r.local_ey*r.transform.local_scale_y);f=k.local_vertices[2];f.x=r.local_ex*r.transform.local_scale_x;f.y=r.local_ey*r.transform.local_scale_y;f=k.local_vertices[3];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=r.local_ey*r.transform.local_scale_y;f=r.transform.local_x;C=k.transform;C.dirty||C.set_dirty();C.local_x=f;f=r.transform.local_y;C=k.transform;C.dirty||C.set_dirty();C.local_y=f;C=k.transform;f=Math.PI/180*(180/Math.PI)*
r.transform.local_radians;C.dirty||C.set_dirty();C.local_radians=f;f=r.transform.local_scale_x;C=k.transform;C.dirty||C.set_dirty();C.local_scale_x=f;f=r.transform.local_scale_y;C=k.transform;C.dirty||C.set_dirty();C.local_scale_y=f;k.dirty_vertices=!0;k.dirty_bounds=!0}f=.5*(0>=d?h:d);k=r.transform;null==k.parent?n=k.local_scale_y:(k.sync(),n=k._scale_y);r.local_ey=f/n;if(null!=r.transformed_rect){k=r.transformed_rect;k.count=4;f=0;for(n=k.count;f<n;)x=f++,null==k.local_vertices[x]&&(C=k.local_vertices,
V=new P(0,0),C[x]=V);f=k.local_vertices[0];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=-(r.local_ey*r.transform.local_scale_y);f=k.local_vertices[1];f.x=r.local_ex*r.transform.local_scale_x;f.y=-(r.local_ey*r.transform.local_scale_y);f=k.local_vertices[2];f.x=r.local_ex*r.transform.local_scale_x;f.y=r.local_ey*r.transform.local_scale_y;f=k.local_vertices[3];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=r.local_ey*r.transform.local_scale_y;f=r.transform.local_x;C=k.transform;C.dirty||C.set_dirty();
C.local_x=f;f=r.transform.local_y;C=k.transform;C.dirty||C.set_dirty();C.local_y=f;C=k.transform;f=Math.PI/180*(180/Math.PI)*r.transform.local_radians;C.dirty||C.set_dirty();C.local_radians=f;f=r.transform.local_scale_x;C=k.transform;C.dirty||C.set_dirty();C.local_scale_x=f;f=r.transform.local_scale_y;C=k.transform;C.dirty||C.set_dirty();C.local_scale_y=f;k.dirty_vertices=!0;k.dirty_bounds=!0}k=r.transform;f=Math.PI/180*0;k.dirty||k.set_dirty();k.local_radians=f;k=r.transform;k.dirty||k.set_dirty();
k.local_scale_x=1;k=r.transform;k.dirty||k.set_dirty();k.local_scale_y=1;null==r.transformed_rect?(k=r.transform,null==k.parent?f=180/Math.PI*k.local_radians:(k.sync(),f=180/Math.PI*k._radians),f=0!=f):f=!1;if(f){h=Xa.pool.get();h.count=4;f=0;for(n=h.count;f<n;)x=f++,null==h.local_vertices[x]&&(d=h.local_vertices,V=new P(0,0),d[x]=V);f=h.local_vertices[0];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=-(r.local_ey*r.transform.local_scale_y);f=h.local_vertices[1];f.x=r.local_ex*r.transform.local_scale_x;
f.y=-(r.local_ey*r.transform.local_scale_y);f=h.local_vertices[2];f.x=r.local_ex*r.transform.local_scale_x;f.y=r.local_ey*r.transform.local_scale_y;f=h.local_vertices[3];f.x=-(r.local_ex*r.transform.local_scale_x);f.y=r.local_ey*r.transform.local_scale_y;f=r.transform.local_x;k=h.transform;k.dirty||k.set_dirty();k.local_x=f;f=r.transform.local_y;k=h.transform;k.dirty||k.set_dirty();k.local_y=f;k=h.transform;f=Math.PI/180*(180/Math.PI)*r.transform.local_radians;k.dirty||k.set_dirty();k.local_radians=
f;f=r.transform.local_scale_x;k=h.transform;k.dirty||k.set_dirty();k.local_scale_x=f;f=r.transform.local_scale_y;k=h.transform;k.dirty||k.set_dirty();k.local_scale_y=f;h.dirty_vertices=!0;h.dirty_bounds=!0;h.pooled=!1;r.transformed_rect=h;r.transformed_rect.set_parent(r.parent)}else null!=r.transformed_rect&&(f=r.transform.local_x,k=r.transformed_rect.transform,k.dirty||k.set_dirty(),k.local_x=f,f=r.transform.local_y,k=r.transformed_rect.transform,k.dirty||k.set_dirty(),k.local_y=f,k=r.transformed_rect.transform,
f=Math.PI/180*(180/Math.PI)*r.transform.local_radians,k.dirty||k.set_dirty(),k.local_radians=f,f=r.transform.local_scale_x,k=r.transformed_rect.transform,k.dirty||k.set_dirty(),k.local_scale_x=f,f=r.transform.local_scale_y,k=r.transformed_rect.transform,k.dirty||k.set_dirty(),k.local_scale_y=f);r.pooled=!1;null!=l.shapes[0]&&l.shapes[0].put();l.shapes[0]=r;l.shapes[0].set_parent(l);l.dirty=!0;0>=l.mass&&null!=l.world&&(l.bounds(l.quadtree_data.bounds),l.world.static_quadtree.update(l.quadtree_data));
e&&za.update_quadtree(c);za.overlap_body_and_bodies_bounds(na.cached_body,b,c,na.cached_collisions);f=0;for(n=na.cached_collisions;f<n.length;){l=n[f];++f;r=l.b;x=yb.pool.get();x.line=a;x.body=r;x.data.length=0;x.pooled=!1;c=x;e=0;for(b=l.b.shapes.length;e<b;)x=e++,x=l.b.shapes[x].intersect(a),null!=x&&c.data.push(x);0<c.data.length?g.push(c):c.put()}na.cached_body.shapes[0].put()}}ba.put();return g};na.undo=function(a){if(null!=a.history){var b=a.history.undo();if(null!=b){for(var c=0;c<b.length;){var e=
b[c];++c;for(var g=0,h=a.members;g<h.length;){var x=h[g];++g;if(e.id==x.id){var k=e.x,d=x.transform;d.dirty||d.set_dirty();d.local_x=k;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);k=e.y;d=x.transform;d.dirty||d.set_dirty();d.local_y=k;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);k=x.transform;d=Math.PI/180*e.rotation;k.dirty||k.set_dirty();k.local_radians=d;if(null!=x.on_rotate)x.on_rotate(180/Math.PI*x.transform.local_radians);k=x.velocity;k.x=e.velocity_x;
k.y=e.velocity_y;k=x.acceleration;k.x=e.acceleration_x;k.y=e.acceleration_y;x.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}}return a};na.redo=function(a){if(null!=a.history){var b=a.history.redo();if(null!=b)for(var c=0;c<b.length;){var e=b[c];++c;for(var g=0,h=a.members;g<h.length;){var x=h[g];++g;if(e.id==x.id){var k=e.x,d=x.transform;d.dirty||d.set_dirty();d.local_x=k;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);k=e.y;d=x.transform;d.dirty||d.set_dirty();
d.local_y=k;if(null!=x.on_move)x.on_move(x.transform.local_x,x.transform.local_y);k=x.transform;d=Math.PI/180*e.rotation;k.dirty||k.set_dirty();k.local_radians=d;if(null!=x.on_rotate)x.on_rotate(180/Math.PI*x.transform.local_radians);k=x.velocity;k.x=e.velocity_x;k.y=e.velocity_y;k=x.acceleration;k.x=e.acceleration_x;k.y=e.acceleration_y;x.rotational_velocity=e.rotational_velocity}}}a.reset_quadtrees()}return a};var Nb=function(){};d["echo.util.Poolable"]=Nb;Nb.__name__=!0;Nb.__isInterface__=!0;var Wb=
function(){};d["echo.util.Pool"]=Wb;Wb.__name__=!0;Wb.__isInterface__=!0;var Zc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_Line"]=Zc;Zc.__name__=!0;Zc.__interfaces__=[Wb];Zc.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Zc};var Mb=function(a,b,c,e){null==e&&(e=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this.pooled=!1;this.start=
a=new P(a,b);this.end=a=new P(c,e)};d["echo.Line"]=Mb;Mb.__name__=!0;Mb.__interfaces__=[Nb];Mb.prototype={set_from_vector:function(a,b,c){var e=Math.PI/180*b;b=a.x;var g=a.y,h=a.x+c*Math.cos(e);a=a.y+c*Math.sin(e);null==a&&(a=1);null==h&&(h=1);null==g&&(g=0);null==b&&(b=0);c=this.start;c.x=b;c.y=g;c=this.end;c.x=h;c.y=a;return this},get_x:function(){return this.start.x},get_y:function(){return this.start.y},get_dx:function(){return this.end.x},get_dy:function(){return this.end.y},__class__:Mb,__properties__:{get_dy:"get_dy",
get_dx:"get_dx",get_y:"get_y",get_x:"get_x"}};var Ub=function(a,b,c,e,g,h,x,k,d,f,l,r){this.a=a;this.b=b;this.separate=c;this.collisions=e;this.last_collisions=g;this.enter=h;this.stay=x;this.exit=k;this.condition=d;this.quadtree_results=f;this.percent_correction=l;this.correction_threshold=r};d["echo.Listener"]=Ub;Ub.__name__=!0;Ub.__properties__={get_defaults:"get_defaults"};Ub.get_defaults=function(){return{separate:!0,percent_correction:.9,correction_threshold:.013}};Ub.prototype={__class__:Ub};
var Lb=function(a,b,c,e,g){this.gravity_scale=1;this.friction=this.static_friction=0;this.density=1;this.elasticity=0;null!=a&&(this.elasticity=a);null!=b&&(this.density=b);null!=c&&(this.friction=c);null!=e&&(this.static_friction=e);null!=g&&(this.gravity_scale=g)};d["echo.Material"]=Lb;Lb.__name__=!0;Lb.prototype={__class__:Lb};var hd=function(){};d["echo.Physics"]=hd;hd.__name__=!0;hd.step=function(a,b){for(var c=0,e=a.members;c<e.length;){var g=e[c];++c;if(0<g.mass&&!g.disposed&&g.active){g.last_x=
g.transform.local_x;g.last_y=g.transform.local_y;g.last_rotation=180/Math.PI*g.transform.local_radians;var h=g.acceleration.x*g.inverse_mass,x=g.acceleration.y*g.inverse_mass;g.kinematic||(h+=a.gravity.x*g.material.gravity_scale,x+=a.gravity.y*g.material.gravity_scale);var k=g.velocity.x,d=g.drag.x,f=g.max_velocity.x;1E-5>=Math.abs(h)?1E-5>=Math.abs(d)||(d*=b,k=0<k-d?k-d:0>k+d?k+d:0):k+=h*b;1E-5>=Math.abs(f)||(h=-f,k<h?k=h:k>f&&(k=f));g.velocity.x=k;k=g.velocity.y;h=g.drag.y;f=g.max_velocity.y;1E-5>=
Math.abs(x)?1E-5>=Math.abs(h)||(h*=b,k=0<k-h?k-h:0>k+h?k+h:0):k+=x*b;1E-5>=Math.abs(f)||(x=-f,k<x?k=x:k>f&&(k=f));g.velocity.y=k;0<g.drag_length?(x=g.acceleration,x=0==x.x&&0==x.y):x=!1;x?(x=g.velocity,x=!(0==x.x&&0==x.y)):x=!1;x&&(x=f=g.velocity,x=Math.sqrt(x.x*x.x+x.y*x.y)-g.drag_length*b,h=k=f,h=h.x*h.x+h.y*h.y,h=0==h?1:Math.sqrt(h),d=f.y/h*x,k.x=f.x/h*x,k.y=d);0<g.max_velocity_length?(x=g.velocity,x=Math.sqrt(x.x*x.x+x.y*x.y)>g.max_velocity_length):x=!1;x&&(f=g.velocity,x=g.max_velocity_length,
h=k=f,h=h.x*h.x+h.y*h.y,h=0==h?1:Math.sqrt(h),d=f.y/h*x,k.x=f.x/h*x,k.y=d);x=g.transform.local_x+g.velocity.x*b;k=g.transform;k.dirty||k.set_dirty();k.local_x=x;if(null!=g.on_move)g.on_move(g.transform.local_x,g.transform.local_y);x=g.transform.local_y+g.velocity.y*b;k=g.transform;k.dirty||k.set_dirty();k.local_y=x;if(null!=g.on_move)g.on_move(g.transform.local_x,g.transform.local_y);x=g.rotational_velocity;f=g.rotational_drag;h=g.torque*g.inverse_mass;k=g.max_rotational_velocity;1E-5>=Math.abs(f)?
1E-5>=Math.abs(h)||(h*=b,x=0<x-h?x-h:0>x+h?x+h:0):x+=f*b;1E-5>=Math.abs(k)||(f=-k,x<f?x=f:x>k&&(x=k));g.rotational_velocity=x;x=g.transform;k=Math.PI/180*(180/Math.PI*g.transform.local_radians+g.rotational_velocity*b);x.dirty||x.set_dirty();x.local_radians=k;if(null!=g.on_rotate)g.on_rotate(180/Math.PI*g.transform.local_radians)}}};hd.separate=function(a,b){a=null==b?a.listeners.members:b.members;for(b=0;b<a.length;){var c=a[b];++b;if(c.separate)for(var e=0,g=c.collisions;e<g.length;){var h=g[e];
++e;for(var x=0,k=h.data.length;x<k;){var d=x++,f=h.a,l=h.b;d=h.data[d];var r=c.correction_threshold,n=c.percent_correction;null==n&&(n=.9);null==r&&(r=.013);if(d.sa.solid&&d.sb.solid&&f.active&&l.active&&!f.disposed&&!l.disposed&&!(0>=f.mass&&0>=l.mass)){var C=(f.velocity.x-l.velocity.x)*d.normal.x+(f.velocity.y-l.velocity.y)*d.normal.y,V=f.inverse_mass+l.inverse_mass;if(0<C){var v=-(1+.5*(f.material.elasticity+l.material.elasticity))*C/V;C=-v*d.normal.x;v=-v*d.normal.y;f.kinematic||(f.velocity.x-=
C*f.inverse_mass,f.velocity.y-=v*f.inverse_mass);l.kinematic||(l.velocity.x+=C*l.inverse_mass,l.velocity.y+=v*l.inverse_mass)}n*=Math.max(d.overlap-r,0)/V;r=n*d.normal.x;d=n*d.normal.y;if(!f.kinematic){n=f.transform.local_x-f.inverse_mass*r;V=f.transform;V.dirty||V.set_dirty();V.local_x=n;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y);n=f.transform.local_y-f.inverse_mass*d;V=f.transform;V.dirty||V.set_dirty();V.local_y=n;if(null!=f.on_move)f.on_move(f.transform.local_x,f.transform.local_y)}if(!l.kinematic){f=
l.transform.local_x+l.inverse_mass*r;r=l.transform;r.dirty||r.set_dirty();r.local_x=f;if(null!=l.on_move)l.on_move(l.transform.local_x,l.transform.local_y);f=l.transform.local_y+l.inverse_mass*d;d=l.transform;d.dirty||d.set_dirty();d.local_y=f;if(null!=l.on_move)l.on_move(l.transform.local_x,l.transform.local_y)}}}}}};var eb=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.solid=!0;var e=this.transform=new Yc;e.dirty||e.set_dirty();e.local_x=a;e=this.transform;e.dirty||e.set_dirty();
e.local_y=b;e=this.transform;a=Math.PI/180*c;e.dirty||e.set_dirty();e.local_radians=a};d["echo.Shape"]=eb;eb.__name__=!0;eb.__properties__={get_defaults:"get_defaults"};eb.get=function(a){a=Ad.copy_fields(a,eb.get_defaults());switch(a.type){case 0:var b=a.offset_x,c=a.offset_y,e=a.width,g=a.height,h=a.rotation,x=a.scale_x,k=a.scale_y;null==k&&(k=1);null==x&&(x=1);null==h&&(h=0);null==g&&(g=0);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);var d=Vb.pool.get();var f=b,l=c;b=g;null==k&&(k=1);null==x&&
(x=1);null==h&&(h=0);null==b&&(b=0);null==e&&(e=1);null==l&&(l=0);null==f&&(f=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=f;c=d.transform;c.dirty||c.set_dirty();c.local_y=l;f=.5*e;c=d.transform;null==c.parent?l=c.local_scale_x:(c.sync(),l=c._scale_x);d.local_ex=f/l;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;f=0;for(l=c.count;f<l;)if(g=f++,null==c.local_vertices[g]){var r=c.local_vertices,n=new P(0,0);r[g]=n}f=c.local_vertices[0];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=
-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[1];f.x=d.local_ex*d.transform.local_scale_x;f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[2];f.x=d.local_ex*d.transform.local_scale_x;f.y=d.local_ey*d.transform.local_scale_y;f=c.local_vertices[3];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=d.local_ey*d.transform.local_scale_y;f=d.transform.local_x;r=c.transform;r.dirty||r.set_dirty();r.local_x=f;f=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=f;r=
c.transform;f=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=f;f=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=f;f=d.transform.local_scale_y;r=c.transform;r.dirty||r.set_dirty();r.local_scale_y=f;c.dirty_vertices=!0;c.dirty_bounds=!0}f=.5*(0>=b?e:b);c=d.transform;null==c.parent?l=c.local_scale_y:(c.sync(),l=c._scale_y);d.local_ey=f/l;if(null!=d.transformed_rect){c=d.transformed_rect;c.count=4;f=0;for(l=c.count;f<l;)g=f++,
null==c.local_vertices[g]&&(r=c.local_vertices,n=new P(0,0),r[g]=n);f=c.local_vertices[0];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[1];f.x=d.local_ex*d.transform.local_scale_x;f.y=-(d.local_ey*d.transform.local_scale_y);f=c.local_vertices[2];f.x=d.local_ex*d.transform.local_scale_x;f.y=d.local_ey*d.transform.local_scale_y;f=c.local_vertices[3];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=d.local_ey*d.transform.local_scale_y;f=d.transform.local_x;
r=c.transform;r.dirty||r.set_dirty();r.local_x=f;f=d.transform.local_y;r=c.transform;r.dirty||r.set_dirty();r.local_y=f;r=c.transform;f=Math.PI/180*(180/Math.PI)*d.transform.local_radians;r.dirty||r.set_dirty();r.local_radians=f;f=d.transform.local_scale_x;r=c.transform;r.dirty||r.set_dirty();r.local_scale_x=f;f=d.transform.local_scale_y;r=c.transform;r.dirty||r.set_dirty();r.local_scale_y=f;c.dirty_vertices=!0;c.dirty_bounds=!0}c=d.transform;f=Math.PI/180*h;c.dirty||c.set_dirty();c.local_radians=
f;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=x;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=k;null==d.transformed_rect?(c=d.transform,null==c.parent?k=180/Math.PI*c.local_radians:(c.sync(),k=180/Math.PI*c._radians),k=0!=k):k=!1;if(k){e=Xa.pool.get();e.count=4;f=0;for(l=e.count;f<l;)g=f++,null==e.local_vertices[g]&&(k=e.local_vertices,n=new P(0,0),k[g]=n);f=e.local_vertices[0];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=-(d.local_ey*d.transform.local_scale_y);f=e.local_vertices[1];
f.x=d.local_ex*d.transform.local_scale_x;f.y=-(d.local_ey*d.transform.local_scale_y);f=e.local_vertices[2];f.x=d.local_ex*d.transform.local_scale_x;f.y=d.local_ey*d.transform.local_scale_y;f=e.local_vertices[3];f.x=-(d.local_ex*d.transform.local_scale_x);f.y=d.local_ey*d.transform.local_scale_y;f=d.transform.local_x;c=e.transform;c.dirty||c.set_dirty();c.local_x=f;f=d.transform.local_y;c=e.transform;c.dirty||c.set_dirty();c.local_y=f;c=e.transform;f=Math.PI/180*(180/Math.PI)*d.transform.local_radians;
c.dirty||c.set_dirty();c.local_radians=f;f=d.transform.local_scale_x;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=f;f=d.transform.local_scale_y;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=f;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;d.transformed_rect=e;d.transformed_rect.set_parent(d.parent)}else null!=d.transformed_rect&&(f=d.transform.local_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_x=f,f=d.transform.local_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),
c.local_y=f,c=d.transformed_rect.transform,f=Math.PI/180*(180/Math.PI)*d.transform.local_radians,c.dirty||c.set_dirty(),c.local_radians=f,f=d.transform.local_scale_x,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_scale_x=f,f=d.transform.local_scale_y,c=d.transformed_rect.transform,c.dirty||c.set_dirty(),c.local_scale_y=f);d.pooled=!1;break;case 1:b=a.offset_x;c=a.offset_y;r=a.radius;h=a.rotation;x=a.scale_x;k=a.scale_y;null==k&&(k=1);null==x&&(x=1);null==h&&(h=0);null==r&&(r=1);null==
c&&(c=0);null==b&&(b=0);d=mc.pool.get();f=b;l=c;e=r;null==k&&(k=1);null==x&&(x=1);null==h&&(h=0);null==e&&(e=1);null==l&&(l=0);null==f&&(f=0);c=d.transform;c.dirty||c.set_dirty();c.local_x=f;c=d.transform;c.dirty||c.set_dirty();c.local_y=l;c=d.transform;f=Math.PI/180*h;c.dirty||c.set_dirty();c.local_radians=f;c=d.transform;c.dirty||c.set_dirty();c.local_scale_x=x;c=d.transform;c.dirty||c.set_dirty();c.local_scale_y=k;c=d.transform;null==c.parent?k=c.local_scale_x:(c.sync(),k=c._scale_x);d.local_radius=
e/k;d.pooled=!1;break;case 2:if(null!=a.vertices)b=a.offset_x,c=a.offset_y,h=a.rotation,d=a.vertices,x=a.scale_x,k=a.scale_y,null==k&&(k=1),null==x&&(x=1),null==h&&(h=0),null==c&&(c=0),null==b&&(b=0),e=Xa.pool.get(),f=b,l=c,null==k&&(k=1),null==x&&(x=1),null==h&&(h=0),null==l&&(l=0),null==f&&(f=0),c=e.transform,c.dirty||c.set_dirty(),c.local_x=f,c=e.transform,c.dirty||c.set_dirty(),c.local_y=l,c=e.transform,f=Math.PI/180*h,c.dirty||c.set_dirty(),c.local_radians=f,c=e.transform,c.dirty||c.set_dirty(),
c.local_scale_x=x,c=e.transform,c.dirty||c.set_dirty(),c.local_scale_y=k,k=null,e.local_vertices=null==d?[]:d;else{b=a.offset_x;c=a.offset_y;l=a.sides;r=a.radius;h=a.rotation;x=a.scale_x;k=a.scale_y;null==k&&(k=1);null==x&&(x=1);null==h&&(h=0);null==r&&(r=1);null==l&&(l=3);null==c&&(c=0);null==b&&(b=0);if(3>l)throw y.thrown("Polygons require 3 sides as a minimum");e=Xa.pool.get();var C=2*Math.PI/l;d=[];for(f=0;f<l;)g=f++,g=g*C+.5*(Math.PI-C),n=new P(Math.cos(g)*r,Math.sin(g)*r),d.push(n);f=b;l=c;
null==k&&(k=1);null==x&&(x=1);null==h&&(h=0);null==l&&(l=0);null==f&&(f=0);c=e.transform;c.dirty||c.set_dirty();c.local_x=f;c=e.transform;c.dirty||c.set_dirty();c.local_y=l;c=e.transform;f=Math.PI/180*h;c.dirty||c.set_dirty();c.local_radians=f;c=e.transform;c.dirty||c.set_dirty();c.local_scale_x=x;c=e.transform;c.dirty||c.set_dirty();c.local_scale_y=k;k=null;e.local_vertices=null==d?[]:d}e.count=null!=k&&0<=k?k:e.local_vertices.length;if(k>e.local_vertices.length)for(f=e.local_vertices.length,l=k;f<
l;)g=f++,k=e.local_vertices,n=new P(0,0),k[g]=n;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;d=e}d.solid=a.solid;return d};eb.get_defaults=function(){return{type:0,radius:1,width:1,height:0,sides:3,rotation:0,scale_x:1,scale_y:1,offset_x:0,offset_y:0,solid:!0}};eb.prototype={put:function(){this.transform.set_parent(null);this.parent=null;this.collided=!1},set_parent:function(a){this.parent!=a&&(this.parent=a,this.transform.set_parent(null==a?null:a.transform))},bounds:function(a){if(null==a){var b=
this.transform;if(null==b.parent)var c=b.local_x;else b.sync(),c=b._x;b=this.transform;if(null==b.parent)var e=b.local_y;else b.sync(),e=b._y;var g=0;b=0;null==b&&(b=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);a=Sa.pool.get();null==b&&(b=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);g*=.5;b*=.5;a.min_x=c-g;a.min_y=e-b;a.max_x=c+g;a.max_y=e+b;a.pooled=!1;return a}b=this.transform;null==b.parent?c=b.local_x:(b.sync(),c=b._x);b=this.transform;null==b.parent?e=b.local_y:(b.sync(),e=b._y);b=g=0;
null==b&&(b=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);g*=.5;b*=.5;a.min_x=c-g;a.min_y=e-b;a.max_x=c+g;a.max_y=e+b;return a},volume:function(){return 0},intersect:function(a){return null},collides:function(a){return null},collide_rect:function(a){return null},collide_circle:function(a){return null},collide_polygon:function(a){return null},__class__:eb};var Hc=function(a){this.members=null==a.members?[]:a.members;this.init=!1;var b;if(1>a.width)throw y.thrown("World must have a width of at least 1");
this.width=b=a.width;this.init&&this.reset_quadtrees();if(1>a.height)throw y.thrown("World must have a width of at least 1");this.height=b=a.height;this.init&&this.reset_quadtrees();this.x=null==a.x?0:a.x;this.init&&this.reset_quadtrees();this.y=null==a.y?0:a.y;this.init&&this.reset_quadtrees();this.gravity=new P(null==a.gravity_x?0:a.gravity_x,null==a.gravity_y?0:a.gravity_y);this.reset_quadtrees();this.listeners=new pb(a.listeners);this.iterations=null==a.iterations?5:a.iterations;null!=a.history&&
(this.history=new ue(a.history))};d["echo.World"]=Hc;Hc.__name__=!0;Hc.__interfaces__=[Ia];Hc.prototype={add:function(a){if(a.world==this)return a;null!=a.world&&(null!=a.world&&a.world.remove(a),null!=a.quadtree_data&&null!=a.quadtree_data.bounds&&a.quadtree_data.bounds.put());a.world=this;a.dirty=!0;this.members.push(a);a.quadtree_data=new ve(a.id,a.bounds(),!1);0>=a.mass?this.static_quadtree.insert(a.quadtree_data):this.quadtree.insert(a.quadtree_data);return a},remove:function(a){this.quadtree.remove(a.quadtree_data);
this.static_quadtree.remove(a.quadtree_data);J.remove(this.members,a);a.world=null;return a},reset_quadtrees:function(){this.init=!0;if(null!=this.quadtree){var a=this.quadtree;if(!a.pooled){a.pooled=!0;for(var b=0,c=a.children.length;b<c;){var e=b++;if(null!=a.children[e]){a.children[e].clear_children();var g=a.children[e];g.pooled||(g.pooled=!0,g.clear_children(),g.contents.length=0,g.contents_count=0,g.nodes_list.length=0,ib.pool.put_unsafe(g));a.children[e]=null}}a.contents.length=0;a.contents_count=
0;a.nodes_list.length=0;ib.pool.put_unsafe(a)}}var h=ib.pool.get();c=b=0;var d=1,k=1;null==k&&(k=1);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);d*=.5;k*=.5;h.min_x=b-d;h.min_y=c-k;h.max_x=b+d;h.max_y=c+k;b=0;for(c=h.children.length;b<c;)e=b++,null!=h.children[e]&&(h.children[e].clear_children(),a=h.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=0,a.nodes_list.length=0,ib.pool.put_unsafe(a)),h.children[e]=null);h.contents.length=0;h.contents_count=0;h.pooled=
!1;this.quadtree=h;if(null!=this.static_quadtree&&(a=this.static_quadtree,!a.pooled)){a.pooled=!0;b=0;for(c=a.children.length;b<c;)e=b++,null!=a.children[e]&&(a.children[e].clear_children(),g=a.children[e],g.pooled||(g.pooled=!0,g.clear_children(),g.contents.length=0,g.contents_count=0,g.nodes_list.length=0,ib.pool.put_unsafe(g)),a.children[e]=null);a.contents.length=0;a.contents_count=0;a.nodes_list.length=0;ib.pool.put_unsafe(a)}h=ib.pool.get();c=b=0;k=d=1;null==k&&(k=1);null==d&&(d=1);null==c&&
(c=0);null==b&&(b=0);d*=.5;k*=.5;h.min_x=b-d;h.min_y=c-k;h.max_x=b+d;h.max_y=c+k;b=0;for(c=h.children.length;b<c;)e=b++,null!=h.children[e]&&(h.children[e].clear_children(),a=h.children[e],a.pooled||(a.pooled=!0,a.clear_children(),a.contents.length=0,a.contents_count=0,a.nodes_list.length=0,ib.pool.put_unsafe(a)),h.children[e]=null);h.contents.length=0;h.contents_count=0;h.pooled=!1;this.static_quadtree=h;h=null;if(null!=h){b=this.x+.5*this.width;c=this.y+.5*this.height;d=this.width;k=this.height;
null==k&&(k=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);a=h.transform;a.dirty||a.set_dirty();a.local_x=b;a=h.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*d;a=h.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);h.local_ex=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)if(e=b++,null==a.local_vertices[e]){g=a.local_vertices;var f=new P(0,0);g[e]=f}b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);
b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*
h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*(0>=k?d:k);a=h.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);h.local_ey=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,
f=new P(0,0),g[e]=f);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();
g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=h.transform;b=Math.PI/180*0;a.dirty||a.set_dirty();a.local_radians=b;a=h.transform;a.dirty||a.set_dirty();
a.local_scale_x=1;a=h.transform;a.dirty||a.set_dirty();a.local_scale_y=1;null==h.transformed_rect?(a=h.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){k=Xa.pool.get();k.count=4;b=0;for(c=k.count;b<c;)e=b++,null==k.local_vertices[e]&&(a=k.local_vertices,f=new P(0,0),a[e]=f);b=k.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=k.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;
b.y=-(h.local_ey*h.transform.local_scale_y);b=k.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=k.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;a=k.transform;a.dirty||a.set_dirty();a.local_x=b;b=h.transform.local_y;a=k.transform;a.dirty||a.set_dirty();a.local_y=b;a=k.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=
b;b=h.transform.local_scale_x;a=k.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=h.transform.local_scale_y;a=k.transform;a.dirty||a.set_dirty();a.local_scale_y=b;k.dirty_vertices=!0;k.dirty_bounds=!0;k.pooled=!1;h.transformed_rect=k;h.transformed_rect.set_parent(h.parent)}else null!=h.transformed_rect&&(b=h.transform.local_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=h.transform.local_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=h.transformed_rect.transform,
b=Math.PI/180*(180/Math.PI)*h.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=h.transform.local_scale_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=h.transform.local_scale_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_y=b)}else{b=this.x+.5*this.width;c=this.y+.5*this.height;d=this.width;k=this.height;null==k&&(k=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);h=Vb.pool.get();var l=0,n=1,r=1;null==r&&(r=1);null==n&&(n=1);null==
l&&(l=0);null==k&&(k=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);a=h.transform;a.dirty||a.set_dirty();a.local_x=b;a=h.transform;a.dirty||a.set_dirty();a.local_y=c;b=.5*d;a=h.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);h.local_ex=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,f=new P(0,0),g[e]=f);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);
b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*
h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}b=.5*(0>=k?d:k);a=h.transform;null==a.parent?a=a.local_scale_y:(a.sync(),a=a._scale_y);h.local_ey=b/a;if(null!=h.transformed_rect){a=h.transformed_rect;a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,
f=new P(0,0),g[e]=f);b=a.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;b.y=-(h.local_ey*h.transform.local_scale_y);b=a.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=a.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;g=a.transform;g.dirty||g.set_dirty();
g.local_x=b;b=h.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=h.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=h.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}a=h.transform;b=Math.PI/180*l;a.dirty||a.set_dirty();a.local_radians=b;a=h.transform;a.dirty||a.set_dirty();
a.local_scale_x=n;a=h.transform;a.dirty||a.set_dirty();a.local_scale_y=r;null==h.transformed_rect?(a=h.transform,null==a.parent?a=180/Math.PI*a.local_radians:(a.sync(),a=180/Math.PI*a._radians),b=0!=a):b=!1;if(b){k=Xa.pool.get();k.count=4;b=0;for(c=k.count;b<c;)e=b++,null==k.local_vertices[e]&&(a=k.local_vertices,f=new P(0,0),a[e]=f);b=k.local_vertices[0];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=-(h.local_ey*h.transform.local_scale_y);b=k.local_vertices[1];b.x=h.local_ex*h.transform.local_scale_x;
b.y=-(h.local_ey*h.transform.local_scale_y);b=k.local_vertices[2];b.x=h.local_ex*h.transform.local_scale_x;b.y=h.local_ey*h.transform.local_scale_y;b=k.local_vertices[3];b.x=-(h.local_ex*h.transform.local_scale_x);b.y=h.local_ey*h.transform.local_scale_y;b=h.transform.local_x;a=k.transform;a.dirty||a.set_dirty();a.local_x=b;b=h.transform.local_y;a=k.transform;a.dirty||a.set_dirty();a.local_y=b;a=k.transform;b=Math.PI/180*(180/Math.PI)*h.transform.local_radians;a.dirty||a.set_dirty();a.local_radians=
b;b=h.transform.local_scale_x;a=k.transform;a.dirty||a.set_dirty();a.local_scale_x=b;b=h.transform.local_scale_y;a=k.transform;a.dirty||a.set_dirty();a.local_scale_y=b;k.dirty_vertices=!0;k.dirty_bounds=!0;k.pooled=!1;h.transformed_rect=k;h.transformed_rect.set_parent(h.parent)}else null!=h.transformed_rect&&(b=h.transform.local_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_x=b,b=h.transform.local_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_y=b,a=h.transformed_rect.transform,
b=Math.PI/180*(180/Math.PI)*h.transform.local_radians,a.dirty||a.set_dirty(),a.local_radians=b,b=h.transform.local_scale_x,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_x=b,b=h.transform.local_scale_y,a=h.transformed_rect.transform,a.dirty||a.set_dirty(),a.local_scale_y=b);h.pooled=!1}b=h.to_aabb(!0);a=this.quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;a=this.static_quadtree;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;b=0;for(c=
this.members;b<c.length;)h=c[b],++b,0<h.mass?h.dirty=!0:(h.bounds(h.quadtree_data.bounds),this.static_quadtree.update(h.quadtree_data))},__class__:Hc};var te=function(a,b,c,e,g,h,d,k,f){this.id=a;this.x=b;this.y=c;this.rotation=e;this.velocity_x=g;this.velocity_y=h;this.acceleration_x=d;this.acceleration_y=k;this.rotational_velocity=f};d["echo.data.BodyState"]=te;te.__name__=!0;te.prototype={__class__:te};var id=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_Collision"]=
id;id.__name__=!0;id.__interfaces__=[Wb];id.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:id};var qc=function(){this.pooled=!1;this.data=[]};d["echo.data.Collision"]=qc;qc.__name__=!0;qc.__interfaces__=[Nb];qc.prototype={put:function(){if(!this.pooled){for(var a=0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;qc.pool.put_unsafe(this)}},__class__:qc};
var Oc=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_CollisionData"]=Oc;Oc.__name__=!0;Oc.__interfaces__=[Wb];Oc.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Oc};var uc=function(){this.pooled=!1;var a=new P(0,0);this.normal=a;a=new P(0,0);var b=new P(0,0);this.contacts=[a,b].slice(0);this.overlap=this.contact_count=0};d["echo.data.CollisionData"]=
uc;uc.__name__=!0;uc.__interfaces__=[Nb];uc.prototype={put:function(){this.pooled||(this.pooled=!0,uc.pool.put_unsafe(this))},__class__:uc};var Ic=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_Intersection"]=Ic;Ic.__name__=!0;Ic.__interfaces__=[Wb];Ic.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Ic};var yb=function(){this.pooled=
!1;this.data=[]};d["echo.data.Intersection"]=yb;yb.__name__=!0;yb.__interfaces__=[Nb];yb.prototype={put:function(){if(!this.pooled){for(var a=0,b=this.data;a<b.length;){var c=b[a];++a;c.put()}this.pooled=!0;yb.pool.put_unsafe(this)}},__class__:yb};var jd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_data_IntersectionData"]=jd;jd.__name__=!0;jd.__interfaces__=[Wb];jd.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},
put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:jd};var Xb=function(){this.inverse_normal=this.pooled=!1;var a=new P(0,0);this.normal=a;this.distance=this.overlap=0;this.hit=a=new P(0,0);this.hit=a=new P(0,0);this.normal=a=new P(0,0)};d["echo.data.IntersectionData"]=Xb;Xb.__name__=!0;Xb.__interfaces__=[Nb];Xb.prototype={put:function(){this.pooled||(this.pooled=!0,Xb.pool.put_unsafe(this))},__class__:Xb};var ve=function(a,b,c){this.flag=!1;this.bounds=null;this.id=a;null!=
b&&(this.bounds=b);null!=c&&(this.flag=c)};d["echo.data.QuadTreeData"]=ve;ve.__name__=!0;ve.prototype={__class__:ve};var we=function(a,b,c,e,g,h,d,k,f){this.m00=a;this.m10=b;this.m20=c;this.m01=e;this.m11=g;this.m21=h;this.m02=d;this.m12=k;this.m22=f};d["echo.math.Matrix3Default"]=we;we.__name__=!0;we.prototype={__class__:we};var P=function(a,b){this.x=a;this.y=b};d["echo.math.Vector2Default"]=P;P.__name__=!0;P.prototype={__class__:P};var Bd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Circle"]=
Bd;Bd.__name__=!0;Bd.__interfaces__=[Wb];Bd.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Bd};var mc=function(){this.pooled=!1;eb.call(this);this.type=1;var a=this.transform;null==a.parent?a=a.local_scale_x:(a.sync(),a=a._scale_x);this.local_radius=0/a};d["echo.shape.Circle"]=mc;mc.__name__=!0;mc.__interfaces__=[Nb];mc.get=function(a,b,c,e,g,h){null==h&&(h=1);null==
g&&(g=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var d=mc.pool.get();null==h&&(h=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var k=d.transform;k.dirty||k.set_dirty();k.local_x=a;k=d.transform;k.dirty||k.set_dirty();k.local_y=b;k=d.transform;a=Math.PI/180*e;k.dirty||k.set_dirty();k.local_radians=a;k=d.transform;k.dirty||k.set_dirty();k.local_scale_x=g;k=d.transform;k.dirty||k.set_dirty();k.local_scale_y=h;k=d.transform;null==k.parent?a=k.local_scale_x:
(k.sync(),a=k._scale_x);d.local_radius=c/a;d.pooled=!1;return d};mc.__super__=eb;mc.prototype=F(eb.prototype,{put:function(){eb.prototype.put.call(this);this.pooled||(this.pooled=!0,mc.pool.put_unsafe(this))},bounds:function(a){var b=this.local_radius,c=this.transform;null==c.parent?c=c.local_scale_x:(c.sync(),c=c._scale_x);b=b*c*2;if(null==a){c=this.transform;if(null==c.parent)var e=c.local_x;else c.sync(),e=c._x;c=this.transform;if(null==c.parent)var g=c.local_y;else c.sync(),g=c._y;c=b;null==b&&
(b=1);null==c&&(c=1);null==g&&(g=0);null==e&&(e=0);a=Sa.pool.get();null==b&&(b=1);null==c&&(c=1);null==g&&(g=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=g-b;a.max_x=e+c;a.max_y=g+b;a.pooled=!1;return a}c=this.transform;null==c.parent?e=c.local_x:(c.sync(),e=c._x);c=this.transform;null==c.parent?g=c.local_y:(c.sync(),g=c._y);c=b;null==b&&(b=1);null==c&&(c=1);null==g&&(g=0);null==e&&(e=0);c*=.5;b*=.5;a.min_x=e-c;a.min_y=g-b;a.max_x=e+c;a.max_y=g+b;return a},volume:function(){var a=this.local_radius,
b=this.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);a*=b;return Math.PI*a*a},intersect:function(a){return xa.line_intersects_circle(a,this)},collides:function(a){return a.collide_circle(this)},collide_rect:function(a){return xa.rect_and_circle(a,this,!0)},collide_circle:function(a){return xa.circle_and_circle(a,this)},collide_polygon:function(a){return xa.circle_and_polygon(this,a,!0)},__class__:mc});var Cd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_shape_Polygon"]=
Cd;Cd.__name__=!0;Cd.__interfaces__=[Wb];Cd.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Cd};var Xa=function(a){this.pooled=!1;eb.call(this);this.type=2;this._vertices=[];this._normals=[];var b=Sa.pool.get(),c=0,e=0,g=1,h=1;null==h&&(h=1);null==g&&(g=1);null==e&&(e=0);null==c&&(c=0);g*=.5;h*=.5;b.min_x=c-g;b.min_y=e-h;b.max_x=c+g;b.max_y=e+h;b.pooled=!1;this._bounds=
b;this.transform.on_dirty=p(this,this.on_dirty);this.local_vertices=null==a?[]:a;this.count=this.local_vertices.length;if(null>this.local_vertices.length)for(a=this.local_vertices.length;null>a;)b=a++,c=this.local_vertices,e=new P(0,0),c[b]=e;this.dirty_bounds=this.dirty_vertices=!0};d["echo.shape.Polygon"]=Xa;Xa.__name__=!0;Xa.__interfaces__=[Nb];Xa.get=function(a,b,c,e,g,h,d){null==d&&(d=1);null==h&&(h=1);null==g&&(g=0);null==e&&(e=1);null==c&&(c=3);null==b&&(b=0);null==a&&(a=0);if(3>c)throw y.thrown("Polygons require 3 sides as a minimum");
for(var k=Xa.pool.get(),x=2*Math.PI/c,f,l=[],r=0;r<c;){f=r++;f=f*x+.5*(Math.PI-x);var n=new P(Math.cos(f)*e,Math.sin(f)*e);l.push(n)}r=a;null==d&&(d=1);null==h&&(h=1);null==g&&(g=0);null==b&&(b=0);null==r&&(r=0);a=k.transform;a.dirty||a.set_dirty();a.local_x=r;a=k.transform;a.dirty||a.set_dirty();a.local_y=b;a=k.transform;g*=Math.PI/180;a.dirty||a.set_dirty();a.local_radians=g;a=k.transform;a.dirty||a.set_dirty();a.local_scale_x=h;a=k.transform;a.dirty||a.set_dirty();a.local_scale_y=d;k.local_vertices=
null==l?[]:l;k.count=k.local_vertices.length;if(null>k.local_vertices.length)for(r=k.local_vertices.length,c=null;r<c;)f=r++,l=k.local_vertices,n=new P(0,0),l[f]=n;k.dirty_vertices=!0;k.dirty_bounds=!0;k.pooled=!1;return k};Xa.__super__=eb;Xa.prototype=F(eb.prototype,{put:function(){eb.prototype.put.call(this);this.pooled||(this.pooled=!0,Xa.pool.put_unsafe(this))},bounds:function(a){if(this.dirty_bounds){this.dirty_bounds=!1;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>
this.count;)this._vertices.pop();for(var b=0,c=this.count;b<c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var g=this._vertices,h=new P(0,0);g[e]=h}var d=this.local_vertices[e].x,k=this.local_vertices[e].y;null==k&&(k=0);null==d&&(d=0);g=this.transform.get_local_to_world_matrix();h=d;d=g.m01*h+g.m11*k+1*g.m21;var f=this._vertices[e];f.x=g.m00*h+g.m10*k+1*g.m20;f.y=d}}b=0;for(c=this.count;b<c;)e=b++,f=this._vertices[(e+1)%this.count],h=f.x,k=f.y,g=this._vertices[e],k-=g.y,
h-=g.x,d=-k,k=h,h=d,null==this._normals[e]?(g=this._normals,h=new P(h,k),g[e]=h):(g=this._normals[e],g.x=h,g.y=k),k=e=h=this._normals[e],k=k.x*k.x+k.y*k.y,k=0==k?1:Math.sqrt(k),g=h.y/k,e.x=h.x/k,e.y=g}f=this._vertices;h=f[0].x;k=f[0].y;g=f[0].x;d=f[0].y;b=1;for(c=this.count;b<c;)e=b++,f[e].x<h&&(h=f[e].x),f[e].y<k&&(k=f[e].y),f[e].x>g&&(g=f[e].x),f[e].y>d&&(d=f[e].y);b=this._bounds;b.min_x=h;b.max_x=g;b.min_y=k;b.max_y=d}if(null==a)return b=this._bounds,a=b.min_x,c=b.min_y,e=b.max_x,h=b.max_y,b=Sa.pool.get(),
b.min_x=a,b.max_x=e,b.min_y=c,b.max_y=h,b.pooled=!1,b;b=this._bounds;a.min_x=b.min_x;a.max_x=b.max_x;a.min_y=b.min_y;a.max_y=b.max_y;return a},volume:function(){var a=0;if(this.dirty_vertices){for(this.dirty_vertices=!1;this._vertices.length>this.count;)this._vertices.pop();for(var b=0,c=this.count;b<c;){var e=b++;if(null!=this.local_vertices[e]){if(null==this._vertices[e]){var g=this._vertices,h=new P(0,0);g[e]=h}var d=this.local_vertices[e].x,k=this.local_vertices[e].y;null==k&&(k=0);null==d&&(d=
0);g=this.transform.get_local_to_world_matrix();h=d;var f=g.m01*h+g.m11*k+1*g.m21;d=this._vertices[e];d.x=g.m00*h+g.m10*k+1*g.m20;d.y=f}}b=0;for(c=this.count;b<c;)e=b++,d=this._vertices[(e+1)%this.count],h=d.x,k=d.y,g=this._vertices[e],k-=g.y,h-=g.x,d=-k,k=h,h=d,null==this._normals[e]?(g=this._normals,h=new P(h,k),g[e]=h):(g=this._normals[e],g.x=h,g.y=k),k=e=h=this._normals[e],k=k.x*k.x+k.y*k.y,k=0==k?1:Math.sqrt(k),g=h.y/k,e.x=h.x/k,e.y=g}h=this._vertices;d=h[h.length-1];b=0;for(c=this.count;b<c;)e=
b++,e=h[e],a+=e.x*d.y-d.x*e.y,d=e;return.5*Math.abs(a)},intersect:function(a){return xa.line_intersects_polygon(a,this)},collides:function(a){return a.collide_polygon(this)},collide_rect:function(a){return xa.rect_and_polygon(a,this,!0)},collide_circle:function(a){return xa.circle_and_polygon(a,this)},collide_polygon:function(a){return xa.polygon_and_polygon(a,this,!0)},on_dirty:function(a){this.dirty_bounds=this.dirty_vertices=!0},__class__:Xa});var Dd=function(a){this.type=a;this.members=[];this.count=
0};d["echo.util.GenericPool_echo_shape_Rect"]=Dd;Dd.__name__=!0;Dd.__interfaces__=[Wb];Dd.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Dd};var Vb=function(){this.pooled=!1;eb.call(this);this.local_ex=0;if(null!=this.transformed_rect){var a=this.transformed_rect;a.count=4;for(var b=0,c=a.count;b<c;){var e=b++;if(null==a.local_vertices[e]){var g=a.local_vertices,h=
new P(0,0);g[e]=h}}b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;
g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=this.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=this.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=this.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.local_ey=0;if(null!=this.transformed_rect){a=this.transformed_rect;
a.count=4;b=0;for(c=a.count;b<c;)e=b++,null==a.local_vertices[e]&&(g=a.local_vertices,h=new P(0,0),g[e]=h);b=a.local_vertices[0];b.x=-(this.local_ex*this.transform.local_scale_x);b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[1];b.x=this.local_ex*this.transform.local_scale_x;b.y=-(this.local_ey*this.transform.local_scale_y);b=a.local_vertices[2];b.x=this.local_ex*this.transform.local_scale_x;b.y=this.local_ey*this.transform.local_scale_y;b=a.local_vertices[3];b.x=-(this.local_ex*
this.transform.local_scale_x);b.y=this.local_ey*this.transform.local_scale_y;b=this.transform.local_x;g=a.transform;g.dirty||g.set_dirty();g.local_x=b;b=this.transform.local_y;g=a.transform;g.dirty||g.set_dirty();g.local_y=b;g=a.transform;b=Math.PI/180*(180/Math.PI)*this.transform.local_radians;g.dirty||g.set_dirty();g.local_radians=b;b=this.transform.local_scale_x;g=a.transform;g.dirty||g.set_dirty();g.local_scale_x=b;b=this.transform.local_scale_y;g=a.transform;g.dirty||g.set_dirty();g.local_scale_y=
b;a.dirty_vertices=!0;a.dirty_bounds=!0}this.type=0;this.transform.on_dirty=p(this,this.on_dirty)};d["echo.shape.Rect"]=Vb;Vb.__name__=!0;Vb.__interfaces__=[Nb];Vb.get=function(a,b,c,e,g,h,d){null==d&&(d=1);null==h&&(h=1);null==g&&(g=0);null==e&&(e=0);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);var k=Vb.pool.get(),x=b;null==d&&(d=1);null==h&&(h=1);null==g&&(g=0);null==e&&(e=0);null==c&&(c=1);null==x&&(x=0);null==a&&(a=0);b=k.transform;b.dirty||b.set_dirty();b.local_x=a;b=k.transform;b.dirty||b.set_dirty();
b.local_y=x;a=.5*c;b=k.transform;null==b.parent?b=b.local_scale_x:(b.sync(),b=b._scale_x);k.local_ex=a/b;if(null!=k.transformed_rect){b=k.transformed_rect;b.count=4;a=0;for(x=b.count;a<x;){var f=a++;if(null==b.local_vertices[f]){var l=b.local_vertices,r=new P(0,0);l[f]=r}}a=b.local_vertices[0];a.x=-(k.local_ex*k.transform.local_scale_x);a.y=-(k.local_ey*k.transform.local_scale_y);a=b.local_vertices[1];a.x=k.local_ex*k.transform.local_scale_x;a.y=-(k.local_ey*k.transform.local_scale_y);a=b.local_vertices[2];
a.x=k.local_ex*k.transform.local_scale_x;a.y=k.local_ey*k.transform.local_scale_y;a=b.local_vertices[3];a.x=-(k.local_ex*k.transform.local_scale_x);a.y=k.local_ey*k.transform.local_scale_y;a=k.transform.local_x;l=b.transform;l.dirty||l.set_dirty();l.local_x=a;a=k.transform.local_y;l=b.transform;l.dirty||l.set_dirty();l.local_y=a;l=b.transform;a=Math.PI/180*(180/Math.PI)*k.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=a;a=k.transform.local_scale_x;l=b.transform;l.dirty||l.set_dirty();
l.local_scale_x=a;a=k.transform.local_scale_y;l=b.transform;l.dirty||l.set_dirty();l.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}a=.5*(0>=e?c:e);b=k.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);k.local_ey=a/b;if(null!=k.transformed_rect){b=k.transformed_rect;b.count=4;a=0;for(x=b.count;a<x;)f=a++,null==b.local_vertices[f]&&(l=b.local_vertices,r=new P(0,0),l[f]=r);a=b.local_vertices[0];a.x=-(k.local_ex*k.transform.local_scale_x);a.y=-(k.local_ey*k.transform.local_scale_y);
a=b.local_vertices[1];a.x=k.local_ex*k.transform.local_scale_x;a.y=-(k.local_ey*k.transform.local_scale_y);a=b.local_vertices[2];a.x=k.local_ex*k.transform.local_scale_x;a.y=k.local_ey*k.transform.local_scale_y;a=b.local_vertices[3];a.x=-(k.local_ex*k.transform.local_scale_x);a.y=k.local_ey*k.transform.local_scale_y;a=k.transform.local_x;l=b.transform;l.dirty||l.set_dirty();l.local_x=a;a=k.transform.local_y;l=b.transform;l.dirty||l.set_dirty();l.local_y=a;l=b.transform;a=Math.PI/180*(180/Math.PI)*
k.transform.local_radians;l.dirty||l.set_dirty();l.local_radians=a;a=k.transform.local_scale_x;l=b.transform;l.dirty||l.set_dirty();l.local_scale_x=a;a=k.transform.local_scale_y;l=b.transform;l.dirty||l.set_dirty();l.local_scale_y=a;b.dirty_vertices=!0;b.dirty_bounds=!0}b=k.transform;a=Math.PI/180*g;b.dirty||b.set_dirty();b.local_radians=a;b=k.transform;b.dirty||b.set_dirty();b.local_scale_x=h;b=k.transform;b.dirty||b.set_dirty();b.local_scale_y=d;null==k.transformed_rect?(b=k.transform,null==b.parent?
c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*b._radians),c=0!=c):c=!1;if(c){c=Xa.pool.get();c.count=4;a=0;for(x=c.count;a<x;)f=a++,null==c.local_vertices[f]&&(e=c.local_vertices,r=new P(0,0),e[f]=r);a=c.local_vertices[0];a.x=-(k.local_ex*k.transform.local_scale_x);a.y=-(k.local_ey*k.transform.local_scale_y);a=c.local_vertices[1];a.x=k.local_ex*k.transform.local_scale_x;a.y=-(k.local_ey*k.transform.local_scale_y);a=c.local_vertices[2];a.x=k.local_ex*k.transform.local_scale_x;a.y=k.local_ey*
k.transform.local_scale_y;a=c.local_vertices[3];a.x=-(k.local_ex*k.transform.local_scale_x);a.y=k.local_ey*k.transform.local_scale_y;a=k.transform.local_x;b=c.transform;b.dirty||b.set_dirty();b.local_x=a;a=k.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=a;b=c.transform;a=Math.PI/180*(180/Math.PI)*k.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=a;a=k.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=a;a=k.transform.local_scale_y;b=c.transform;
b.dirty||b.set_dirty();b.local_scale_y=a;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;k.transformed_rect=c;k.transformed_rect.set_parent(k.parent)}else null!=k.transformed_rect&&(a=k.transform.local_x,b=k.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=a,a=k.transform.local_y,b=k.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=a,b=k.transformed_rect.transform,a=Math.PI/180*(180/Math.PI)*k.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=a,a=k.transform.local_scale_x,
b=k.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=a,a=k.transform.local_scale_y,b=k.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=a);k.pooled=!1;return k};Vb.__super__=eb;Vb.prototype=F(eb.prototype,{put:function(){eb.prototype.put.call(this);null!=this.transformed_rect&&(this.transformed_rect.put(),this.transformed_rect=null);this.pooled||(this.pooled=!0,Vb.pool.put_unsafe(this))},to_aabb:function(a){null==a&&(a=!1);if(a){a=null;if(null!=this.transformed_rect){var b=
this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;b=0!=c}else b=!1;if(b)a=this.transformed_rect.bounds(a);else if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);var g=2*this.local_ex;b=this.transform;if(null==b.parent)var h=b.local_scale_x;else b.sync(),h=b._scale_x;g*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),
b=b._scale_y);h*=b;null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);b=Sa.pool.get();null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;h*=.5;b.min_x=e-g;b.min_y=c-h;b.max_x=e+g;b.max_y=c+h;b.pooled=!1;a=b}else b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,null==b.parent?c=b.local_y:(b.sync(),c=b._y),g=2*this.local_ex,b=this.transform,null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x),g*=h,h=2*this.local_ey,b=this.transform,null==b.parent?
b=b.local_scale_y:(b.sync(),b=b._scale_y),h*=b,null==h&&(h=1),null==g&&(g=1),null==c&&(c=0),null==e&&(e=0),g*=.5,h*=.5,a.min_x=e-g,a.min_y=c-h,a.max_x=e+g,a.max_y=c+h;this.put();return a}a=null;null!=this.transformed_rect?(b=this.transform,null==b.parent?c=180/Math.PI*b.local_radians:(b.sync(),c=180/Math.PI*b._radians),c=0!=c):c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a)return b=this.transform,null==b.parent?e=b.local_x:(b.sync(),e=b._x),b=this.transform,null==b.parent?c=b.local_y:
(b.sync(),c=b._y),g=2*this.local_ex,b=this.transform,null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x),g*=h,h=2*this.local_ey,b=this.transform,null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y),h*=b,null==h&&(h=1),null==g&&(g=1),null==c&&(c=0),null==e&&(e=0),a=Sa.pool.get(),null==h&&(h=1),null==g&&(g=1),null==c&&(c=0),null==e&&(e=0),g*=.5,h*=.5,a.min_x=e-g,a.min_y=c-h,a.max_x=e+g,a.max_y=c+h,a.pooled=!1,a;b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;
null==b.parent?c=b.local_y:(b.sync(),c=b._y);g=2*this.local_ex;b=this.transform;null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x);g*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;h*=.5;a.min_x=e-g;a.min_y=c-h;a.max_x=e+g;a.max_y=c+h;return a},bounds:function(a){if(null!=this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),
c=180/Math.PI*b._radians;c=0!=c}else c=!1;if(c)return this.transformed_rect.bounds(a);if(null==a){b=this.transform;if(null==b.parent)var e=b.local_x;else b.sync(),e=b._x;b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);var g=2*this.local_ex;b=this.transform;if(null==b.parent)var h=b.local_scale_x;else b.sync(),h=b._scale_x;g*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);a=
Sa.pool.get();null==h&&(h=1);null==g&&(g=1);null==c&&(c=0);null==e&&(e=0);g*=.5;h*=.5;a.min_x=e-g;a.min_y=c-h;a.max_x=e+g;a.max_y=c+h;a.pooled=!1;return a}b=this.transform;null==b.parent?e=b.local_x:(b.sync(),e=b._x);b=this.transform;null==b.parent?c=b.local_y:(b.sync(),c=b._y);g=2*this.local_ex;b=this.transform;null==b.parent?h=b.local_scale_x:(b.sync(),h=b._scale_x);g*=h;h=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);h*=b;null==h&&(h=1);null==g&&(g=1);
null==c&&(c=0);null==e&&(e=0);g*=.5;h*=.5;a.min_x=e-g;a.min_y=c-h;a.max_x=e+g;a.max_y=c+h;return a},volume:function(){var a=2*this.local_ex,b=this.transform;if(null==b.parent)var c=b.local_scale_x;else b.sync(),c=b._scale_x;var e=2*this.local_ey;b=this.transform;null==b.parent?b=b.local_scale_y:(b.sync(),b=b._scale_y);return a*c*e*b},intersect:function(a){return xa.line_intersects_rect(a,this)},collides:function(a){return a.collide_rect(this)},collide_rect:function(a){return xa.rect_and_rect(a,this)},
collide_circle:function(a){return xa.rect_and_circle(this,a)},collide_polygon:function(a){return xa.rect_and_polygon(this,a)},set_parent:function(a){eb.prototype.set_parent.call(this,a);if(null==this.transformed_rect){var b=this.transform;if(null==b.parent)var c=180/Math.PI*b.local_radians;else b.sync(),c=180/Math.PI*b._radians;c=0!=c}else c=!1;if(c){c=Xa.pool.get();c.count=4;b=0;for(var e=c.count;b<e;){var g=b++;if(null==c.local_vertices[g]){var h=c.local_vertices,d=new P(0,0);h[g]=d}}e=c.local_vertices[0];
e.x=-(this.local_ex*this.transform.local_scale_x);e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[1];e.x=this.local_ex*this.transform.local_scale_x;e.y=-(this.local_ey*this.transform.local_scale_y);e=c.local_vertices[2];e.x=this.local_ex*this.transform.local_scale_x;e.y=this.local_ey*this.transform.local_scale_y;e=c.local_vertices[3];e.x=-(this.local_ex*this.transform.local_scale_x);e.y=this.local_ey*this.transform.local_scale_y;e=this.transform.local_x;b=c.transform;b.dirty||
b.set_dirty();b.local_x=e;e=this.transform.local_y;b=c.transform;b.dirty||b.set_dirty();b.local_y=e;b=c.transform;e=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=e;e=this.transform.local_scale_x;b=c.transform;b.dirty||b.set_dirty();b.local_scale_x=e;e=this.transform.local_scale_y;b=c.transform;b.dirty||b.set_dirty();b.local_scale_y=e;c.dirty_vertices=!0;c.dirty_bounds=!0;c.pooled=!1;this.transformed_rect=c;this.transformed_rect.set_parent(this.parent)}else null!=
this.transformed_rect&&(e=this.transform.local_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_x=e,e=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=e,b=this.transformed_rect.transform,e=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=e,e=this.transform.local_scale_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=e,e=this.transform.local_scale_y,b=this.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_scale_y=e);null!=this.transformed_rect&&this.transformed_rect.set_parent(a)},on_dirty:function(a){if(null==this.transformed_rect){var b=this.transform;null==b.parent?a=180/Math.PI*b.local_radians:(b.sync(),a=180/Math.PI*b._radians);a=0!=a}else a=!1;if(a){a=Xa.pool.get();a.count=4;b=0;for(var c=a.count;b<c;){var e=b++;if(null==a.local_vertices[e]){var g=a.local_vertices,h=new P(0,0);g[e]=h}}c=a.local_vertices[0];c.x=-(this.local_ex*this.transform.local_scale_x);c.y=-(this.local_ey*
this.transform.local_scale_y);c=a.local_vertices[1];c.x=this.local_ex*this.transform.local_scale_x;c.y=-(this.local_ey*this.transform.local_scale_y);c=a.local_vertices[2];c.x=this.local_ex*this.transform.local_scale_x;c.y=this.local_ey*this.transform.local_scale_y;c=a.local_vertices[3];c.x=-(this.local_ex*this.transform.local_scale_x);c.y=this.local_ey*this.transform.local_scale_y;c=this.transform.local_x;b=a.transform;b.dirty||b.set_dirty();b.local_x=c;c=this.transform.local_y;b=a.transform;b.dirty||
b.set_dirty();b.local_y=c;b=a.transform;c=Math.PI/180*(180/Math.PI)*this.transform.local_radians;b.dirty||b.set_dirty();b.local_radians=c;c=this.transform.local_scale_x;b=a.transform;b.dirty||b.set_dirty();b.local_scale_x=c;c=this.transform.local_scale_y;b=a.transform;b.dirty||b.set_dirty();b.local_scale_y=c;a.dirty_vertices=!0;a.dirty_bounds=!0;a.pooled=!1;this.transformed_rect=a;this.transformed_rect.set_parent(this.parent)}else null!=this.transformed_rect&&(c=this.transform.local_x,b=this.transformed_rect.transform,
b.dirty||b.set_dirty(),b.local_x=c,c=this.transform.local_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_y=c,b=this.transformed_rect.transform,c=Math.PI/180*(180/Math.PI)*this.transform.local_radians,b.dirty||b.set_dirty(),b.local_radians=c,c=this.transform.local_scale_x,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_x=c,c=this.transform.local_scale_y,b=this.transformed_rect.transform,b.dirty||b.set_dirty(),b.local_scale_y=c)},__class__:Vb});var Ed=function(a){this.type=
a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_util_AABB"]=Ed;Ed.__name__=!0;Ed.__interfaces__=[Wb];Ed.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:Ed};var Sa=function(){this.pooled=!1;this.min_x=0;this.max_x=1;this.min_y=0;this.max_y=1};d["echo.util.AABB"]=Sa;Sa.__name__=!0;Sa.__interfaces__=[Nb];Sa.prototype={put:function(){this.pooled||(this.pooled=
!0,Sa.pool.put_unsafe(this))},__class__:Sa};var mf={_new:function(a){null==a&&(a=0);return a}},kd=function(a){this.type=a;this.members=[];this.count=0};d["echo.util.GenericPool_echo_util_QuadTree"]=kd;kd.__name__=!0;kd.__interfaces__=[Wb];kd.prototype={get:function(){return 0==this.count?ja.createInstance(this.type,[]):this.members[--this.count]},put_unsafe:function(a){null!=a&&(this.members[this.count++]=a)},__class__:kd};var ue=function(a){this.re=new ld(a);this.un=new ld(a)};d["echo.util.History_Array_echo_data_BodyState"]=
ue;ue.__name__=!0;ue.prototype={redo:function(){var a=this.re.pop();null!=a&&this.un.push(a);return a},undo:function(){var a=this.un.pop();null!=a&&this.re.push(a);return a},add:function(a){this.un.push(a);this.re.reset()},__class__:ue};var Ad=function(){};d["echo.util.JSON"]=Ad;Ad.__name__=!0;Ad.copy_fields=function(a,b){if(null==a)return b;if(null==b)b=H.copy(a);else for(var c=0,e=H.fields(a);c<e.length;){var g=e[c];++c;b[g]=H.field(a,g)}return b};var ib=function(a,b){null==b&&(b=0);this.nodes_list=
[];this.max_contents=10;this.max_depth=5;Sa.call(this);null!=a&&(this.min_x=a.min_x,this.max_x=a.max_x,this.min_y=a.min_y,this.max_y=a.max_y);this.depth=b;this.children=Array(4);this.contents=[];this.contents_count=0};d["echo.util.QuadTree"]=ib;ib.__name__=!0;ib.__super__=Sa;ib.prototype=F(Sa.prototype,{put:function(){if(!this.pooled){this.pooled=!0;for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];e.pooled||(e.pooled=
!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,ib.pool.put_unsafe(e));this.children[c]=null}}this.contents_count=this.contents.length=0;this.nodes_list.length=0;ib.pool.put_unsafe(this)}},insert:function(a){if(null!=a.bounds){var b=a.bounds;if(b.min_x<this.max_x&&b.max_x>=this.min_x&&b.min_y<this.max_y&&b.max_y>=this.min_y)if(null==this.children[0]&&this.contents_count+1>this.max_contents&&this.split(),null==this.children[0])b=this.get_first_null(this.contents),
-1==b?this.contents.push(a):this.contents[b]=a,this.contents_count++;else{b=0;for(var c=this.children;b<c.length;){var e=c[b];++b;e.insert(a)}}}},remove:function(a,b){null==b&&(b=!0);if(null==this.children[0]){for(b=0;b<this.contents.length;){if(null!=this.contents[b]&&this.contents[b].id==a.id)return this.contents[b]=null,this.contents_count--,!0;++b}return!1}for(var c=!1,e=0,g=this.children;e<g.length;){var h=g[e];++e;null!=h&&h.remove(a)&&(c=!0)}b&&c&&this.shake();return c},update:function(a,b){null==
b&&(b=!0);this.remove(a,b);this.insert(a)},query:function(a,b){if(this.min_x<a.max_x&&this.max_x>=a.min_x&&this.min_y<a.max_y&&this.max_y>=a.min_y)if(null==this.children[0])for(var c=0,e=this.contents;c<e.length;){var g=e[c];++c;if(null!=g){var h=g.bounds;h=h.min_x<a.max_x&&h.max_x>=a.min_x&&h.min_y<a.max_y&&h.max_y>=a.min_y}else h=!1;h&&b.push(g)}else for(c=0,e=this.children;c<e.length;)g=e[c],++c,g.query(a,b)},shake:function(){if(null==this.children[0])return!1;var a=this.get_count();if(0==a){a=
0;for(var b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){for(var e=this.children[c],g=0,h=e.children.length;g<h;){var d=g++;if(null!=e.children[d]){e.children[d].clear_children();var k=e.children[d];k.pooled||(k.pooled=!0,k.clear_children(),k.contents.length=0,k.contents_count=0,k.nodes_list.length=0,ib.pool.put_unsafe(k));e.children[d]=null}}g=this.children[c];if(!g.pooled){g.pooled=!0;h=0;for(e=g.children.length;h<e;)d=h++,null!=g.children[d]&&(g.children[d].clear_children(),
k=g.children[d],k.pooled||(k.pooled=!0,k.clear_children(),k.contents.length=0,k.contents_count=0,k.nodes_list.length=0,ib.pool.put_unsafe(k)),g.children[d]=null);g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;ib.pool.put_unsafe(g)}this.children[c]=null}}}else if(a<this.max_contents){this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;)if(b=this.nodes_list.shift(),b!=this&&null==b.children[0])for(a=0,b=b.contents;a<b.length;)c=b[a],++a,-1==this.contents.indexOf(c)&&
(g=this.get_first_null(this.contents),-1==g?this.contents.push(c):this.contents[g]=c,this.contents_count++);else for(g=0,h=b.children;g<h.length;)a=h[g],++g,this.nodes_list.push(a);a=0;for(b=this.children.length;a<b;)if(c=a++,null!=this.children[c]){e=this.children[c];g=0;for(h=e.children.length;g<h;)d=g++,null!=e.children[d]&&(e.children[d].clear_children(),k=e.children[d],k.pooled||(k.pooled=!0,k.clear_children(),k.contents.length=0,k.contents_count=0,k.nodes_list.length=0,ib.pool.put_unsafe(k)),
e.children[d]=null);g=this.children[c];if(!g.pooled){g.pooled=!0;h=0;for(e=g.children.length;h<e;)d=h++,null!=g.children[d]&&(g.children[d].clear_children(),k=g.children[d],k.pooled||(k.pooled=!0,k.clear_children(),k.contents.length=0,k.contents_count=0,k.nodes_list.length=0,ib.pool.put_unsafe(k)),g.children[d]=null);g.contents.length=0;g.contents_count=0;g.nodes_list.length=0;ib.pool.put_unsafe(g)}this.children[c]=null}return!0}return!1},split:function(){if(!(this.depth+1>=this.max_depth)){for(var a=
.5*(this.max_x-this.min_x),b=.5*(this.max_y-this.min_y),c=0;4>c;){var e=c++,g=ib.pool.get(),h=0,d=0,k=1,f=1;null==f&&(f=1);null==k&&(k=1);null==d&&(d=0);null==h&&(h=0);k*=.5;f*=.5;g.min_x=h-k;g.min_y=d-f;g.max_x=h+k;g.max_y=d+f;h=0;for(d=g.children.length;h<d;)k=h++,null!=g.children[k]&&(g.children[k].clear_children(),f=g.children[k],f.pooled||(f.pooled=!0,f.clear_children(),f.contents.length=0,f.contents_count=0,f.nodes_list.length=0,ib.pool.put_unsafe(f)),g.children[k]=null);g.contents.length=0;
g.contents_count=0;g.pooled=!1;switch(e){case 0:h=this.min_x+a;d=this.min_y+b;g.min_x=this.min_x;g.max_x=h;g.min_y=this.min_y;g.max_y=d;break;case 1:h=this.min_y+b;g.min_x=this.min_x+a;g.max_x=this.max_x;g.min_y=this.min_y;g.max_y=h;break;case 2:h=this.min_x+a;g.min_x=this.min_x;g.max_x=h;g.min_y=this.min_y+b;g.max_y=this.max_y;break;case 3:g.min_x=this.min_x+a,g.max_x=this.max_x,g.min_y=this.min_y+b,g.max_y=this.max_y}g.depth=this.depth+1;h=this.max_depth;d=0;for(k=g.children.length;d<k;)if(f=d++,
null!=g.children[f]){f=g.children[f];for(var l=0,n=f.children.length;l<n;){var r=l++;null!=f.children[r]&&f.children[r].set_max_depth(h)}f.max_depth=h}g.max_depth=h;h=this.max_contents;d=0;for(k=g.children.length;d<k;)if(f=d++,null!=g.children[f]){f=g.children[f];l=0;for(n=f.children.length;l<n;)if(r=l++,null!=f.children[r]){r=f.children[r];for(var C=0,V=r.children.length;C<V;){var v=C++;null!=r.children[v]&&r.children[v].set_max_depth(h)}r.max_depth=h}f.max_depth=h}g.max_contents=h;g.shake();h=0;
for(d=this.contents.length;h<d;)k=h++,null!=this.contents[k]&&g.insert(this.contents[k]);this.children[e]=g}this.contents_count=this.contents.length=0}},clear_children:function(){for(var a=0,b=this.children.length;a<b;){var c=a++;if(null!=this.children[c]){this.children[c].clear_children();var e=this.children[c];e.pooled||(e.pooled=!0,e.clear_children(),e.contents.length=0,e.contents_count=0,e.nodes_list.length=0,ib.pool.put_unsafe(e));this.children[c]=null}}},reset_data_flags:function(){for(var a=
0,b=this.contents.length;a<b;){var c=a++;null!=this.contents[c]&&(this.contents[c].flag=!1)}a=0;for(b=this.children.length;a<b;)c=a++,null!=this.children[c]&&this.children[c].reset_data_flags()},get_count:function(){this.reset_data_flags();for(var a=0,b=0,c=this.contents.length;b<c;){var e=b++;null!=this.contents[e]&&(this.contents[e].flag=!0,++a)}this.nodes_list.length=0;for(this.nodes_list.push(this);0<this.nodes_list.length;){var g=this.nodes_list.shift();if(null==g.children[0])for(b=0,c=g.contents.length;b<
c;)e=b++,null==g.contents[e]||g.contents[e].flag||(++a,g.contents[e].flag=!0);else for(b=0,c=g.children.length;b<c;)e=b++,this.nodes_list.push(g.children[e])}return a},get_first_null:function(a){for(var b=0,c=a.length;b<c;){var e=b++;if(null==a[e])return e}return-1},set_max_depth:function(a){for(var b=0,c=this.children.length;b<c;){var e=b++;null!=this.children[e]&&this.children[e].set_max_depth(a)}return this.max_depth=a},__class__:ib,__properties__:{get_count:"get_count",set_max_depth:"set_max_depth"}});
var ld=function(a){this.a=Array(a);this.reset()};d["echo.util.Ring_Array_echo_data_BodyState"]=ld;ld.__name__=!0;ld.prototype={pop:function(){if(0>=this.i+this.left-this.start)return null;0==this.i&&(this.i=this.a.length,this.left=0);return this.a[--this.i]},push:function(a){this.i==this.a.length&&(0<this.left&&this.start==this.i&&(this.start=0),this.i=0,this.left=this.a.length);this.i+this.left-this.start==this.a.length&&this.start++;this.a[this.i++]=a},reset:function(){this.left=this.start=this.i=
0},__class__:ld};var xa=function(){};d["echo.util.SAT"]=xa;xa.__name__=!0;xa.line_intersects_rect=function(a,b){if(null!=b.transformed_rect){var c=b.transform;if(null==c.parent)var e=180/Math.PI*c.local_radians;else c.sync(),e=180/Math.PI*c._radians;var g=0!=e}else g=!1;if(g)return b.transformed_rect.intersect(a);var h=null;if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var d=180/Math.PI*c.local_radians;else c.sync(),d=180/Math.PI*c._radians;var k=0==d}else k=!0;if(k){c=b.transform;
null==c.parent?k=c.local_x:(c.sync(),k=c._x);var f=k-b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var l=0,n=c.count;l<n;){var r=l++;if(null!=c.local_vertices[r]){if(null==c._vertices[r]){var C=c._vertices,V=new P(0,0);C[r]=V}var v=c.local_vertices[r].x,m=c.local_vertices[r].y;null==m&&(m=0);null==v&&(v=0);var q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*
p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[r];t.x=O;t.y=F}}l=0;for(n=c.count;l<n;){r=l++;t=c._vertices[(r+1)%c.count];p=t.x;w=t.y;var u=c._vertices[r],z=p-u.x,ka=w-u.y;p=z;w=ka;v=-w;w=p;p=v;null==c._normals[r]?(C=c._normals,V=new P(p,w),C[r]=V):(q=c._normals[r],q.x=p,q.y=w);var hb=c._normals[r],A=hb,ja=hb,D=ja,G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E;A.x=Ia;A.y=H}}k=null==c._vertices[0]}else k=!0;if(k)C=c.transform,null==C.parent?f=C.local_x:(C.sync(),
f=C._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();l=0;for(n=c.count;l<n;)r=l++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,V=new P(0,0),C[r]=V),v=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[r],t.x=O,t.y=F);l=0;for(n=c.count;l<n;)r=l++,t=c._vertices[(r+1)%c.count],
p=t.x,w=t.y,u=c._vertices[r],z=p-u.x,ka=w-u.y,p=z,w=ka,v=-w,w=p,p=v,null==c._normals[r]?(C=c._normals,V=new P(p,w),C[r]=V):(q=c._normals[r],q.x=p,q.y=w),D=ja=A=hb=c._normals[r],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}k=c._vertices[0].x;l=1;for(n=c.count;l<n;){r=l++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var L=0,kb=c.count;L<kb;){var ea=L++;null!=c.local_vertices[ea]&&(null==c._vertices[ea]&&(C=c._vertices,
V=new P(0,0),C[ea]=V),v=c.local_vertices[ea].x,m=c.local_vertices[ea].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[ea],t.x=O,t.y=F)}for(var S=0,I=c.count;S<I;){var bb=S++;hb=c._vertices[(bb+1)%c.count];var J=hb.x,T=hb.y;u=c._vertices[bb];z=J-u.x;ka=T-u.y;J=z;T=ka;var R=-T;T=J;J=R;if(null==c._normals[bb]){var za=c._normals,ya=new P(J,T);za[bb]=ya}else{var M=c._normals[bb];M.x=J;M.y=
T}var aa=c._normals[bb];D=ja=A=aa;G=D.x*D.x+D.y*D.y;B=0==G?1:Math.sqrt(G);ca=ja.x/B;E=ja.y/B;Ia=ca;H=E;A.x=Ia;A.y=H}}if(c._vertices[r].x<k){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();for(var na=0,W=c.count;na<W;){var Q=na++;if(null!=c.local_vertices[Q]){if(null==c._vertices[Q]){var da=c._vertices,Wa=new P(0,0);da[Q]=Wa}var X=c.local_vertices[Q].x,La=c.local_vertices[Q].y;null==La&&(La=0);null==X&&(X=0);var U=c.transform.get_local_to_world_matrix(),Y=
X,Pa=La,fa=1,Da=U.m00*Y+U.m10*Pa+U.m20*fa,ma=U.m01*Y+U.m11*Pa+U.m21*fa,ua=Da,ab=ma,ta=c._vertices[Q];ta.x=ua;ta.y=ab}}for(var ra=0,Za=c.count;ra<Za;){var ia=ra++,va=c._vertices[(ia+1)%c.count],pa=va.x,ha=va.y,wa=c._vertices[ia],sa=pa-wa.x,Ca=ha-wa.y;pa=sa;ha=Ca;var oa=-ha;ha=pa;pa=oa;if(null==c._normals[ia]){var Ha=c._normals,Ba=new P(pa,ha);Ha[ia]=Ba}else{var qa=c._normals[ia];qa.x=pa;qa.y=ha}var Ga=c._normals[ia],pb=Ga,Fa=Ga,Aa=Fa,$a=Aa.x*Aa.x+Aa.y*Aa.y,Ea=0==$a?1:Math.sqrt($a),Oa=Fa.x/Ea,Ua=Fa.y/
Ea,Ka=Oa,Ma=Ua;pb.x=Ka;pb.y=Ma}}k=c._vertices[r].x}}f=k}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var ib=180/Math.PI*c.local_radians;else c.sync(),ib=180/Math.PI*c._radians;var Ja=0==ib}else Ja=!0;if(Ja){c=b.transform;null==c.parent?Ja=c.local_x:(c.sync(),Ja=c._x);var Va=Ja+b.local_ex*b.transform.local_scale_x}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();l=0;for(n=c.count;l<n;)r=l++,null!=c.local_vertices[r]&&
(null==c._vertices[r]&&(C=c._vertices,V=new P(0,0),C[r]=V),v=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[r],t.x=O,t.y=F);l=0;for(n=c.count;l<n;)r=l++,t=c._vertices[(r+1)%c.count],p=t.x,w=t.y,u=c._vertices[r],z=p-u.x,ka=w-u.y,p=z,w=ka,v=-w,w=p,p=v,null==c._normals[r]?(C=c._normals,V=new P(p,w),C[r]=V):(q=c._normals[r],q.x=p,q.y=w),D=ja=A=
hb=c._normals[r],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}Ja=null==c._vertices[0]}else Ja=!0;if(Ja)C=c.transform,null==C.parent?Va=C.local_x:(C.sync(),Va=C._x);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();l=0;for(n=c.count;l<n;)r=l++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,V=new P(0,0),C[r]=V),v=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),
p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[r],t.x=O,t.y=F);l=0;for(n=c.count;l<n;)r=l++,t=c._vertices[(r+1)%c.count],p=t.x,w=t.y,u=c._vertices[r],z=p-u.x,ka=w-u.y,p=z,w=ka,v=-w,w=p,p=v,null==c._normals[r]?(C=c._normals,V=new P(p,w),C[r]=V):(q=c._normals[r],q.x=p,q.y=w),D=ja=A=hb=c._normals[r],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}Ja=c._vertices[0].x;l=1;for(n=c.count;l<n;){r=l++;if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();L=0;for(kb=c.count;L<kb;)ea=L++,null!=c.local_vertices[ea]&&(null==c._vertices[ea]&&(C=c._vertices,V=new P(0,0),C[ea]=V),v=c.local_vertices[ea].x,m=c.local_vertices[ea].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[ea],t.x=O,t.y=F);S=0;for(I=c.count;S<I;)bb=S++,hb=c._vertices[(bb+1)%c.count],J=hb.x,T=hb.y,u=c._vertices[bb],z=J-u.x,ka=
T-u.y,J=z,T=ka,R=-T,T=J,J=R,null==c._normals[bb]?(za=c._normals,ya=new P(J,T),za[bb]=ya):(M=c._normals[bb],M.x=J,M.y=T),D=ja=A=aa=c._normals[bb],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}if(c._vertices[r].x>Ja){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();na=0;for(W=c.count;na<W;)Q=na++,null!=c.local_vertices[Q]&&(null==c._vertices[Q]&&(da=c._vertices,Wa=new P(0,0),da[Q]=Wa),X=c.local_vertices[Q].x,La=c.local_vertices[Q].y,
null==La&&(La=0),null==X&&(X=0),U=c.transform.get_local_to_world_matrix(),Y=X,Pa=La,fa=1,Da=U.m00*Y+U.m10*Pa+U.m20*fa,ma=U.m01*Y+U.m11*Pa+U.m21*fa,ua=Da,ab=ma,ta=c._vertices[Q],ta.x=ua,ta.y=ab);ra=0;for(Za=c.count;ra<Za;)ia=ra++,va=c._vertices[(ia+1)%c.count],pa=va.x,ha=va.y,wa=c._vertices[ia],sa=pa-wa.x,Ca=ha-wa.y,pa=sa,ha=Ca,oa=-ha,ha=pa,pa=oa,null==c._normals[ia]?(Ha=c._normals,Ba=new P(pa,ha),Ha[ia]=Ba):(qa=c._normals[ia],qa.x=pa,qa.y=ha),Aa=Fa=pb=Ga=c._normals[ia],$a=Aa.x*Aa.x+Aa.y*Aa.y,Ea=0==
$a?1:Math.sqrt($a),Oa=Fa.x/Ea,Ua=Fa.y/Ea,Ka=Oa,Ma=Ua,pb.x=Ka,pb.y=Ma}Ja=c._vertices[r].x}}Va=Ja}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var jb=180/Math.PI*c.local_radians;else c.sync(),jb=180/Math.PI*c._radians;var Pc=0==jb}else Pc=!0;if(Pc){c=b.transform;null==c.parent?Pc=c.local_y:(c.sync(),Pc=c._y);var Ta=Pc-b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();
l=0;for(n=c.count;l<n;)r=l++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,V=new P(0,0),C[r]=V),v=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[r],t.x=O,t.y=F);l=0;for(n=c.count;l<n;)r=l++,t=c._vertices[(r+1)%c.count],p=t.x,w=t.y,u=c._vertices[r],z=p-u.x,ka=w-u.y,p=z,w=ka,v=-w,w=p,p=v,null==c._normals[r]?(C=c._normals,V=
new P(p,w),C[r]=V):(q=c._normals[r],q.x=p,q.y=w),D=ja=A=hb=c._normals[r],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}Pc=null==c._vertices[0]}else Pc=!0;if(Pc)C=c.transform,null==C.parent?Ta=C.local_y:(C.sync(),Ta=C._y);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();l=0;for(n=c.count;l<n;)r=l++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,V=new P(0,0),C[r]=V),v=c.local_vertices[r].x,m=c.local_vertices[r].y,
null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[r],t.x=O,t.y=F);l=0;for(n=c.count;l<n;)r=l++,t=c._vertices[(r+1)%c.count],p=t.x,w=t.y,u=c._vertices[r],z=p-u.x,ka=w-u.y,p=z,w=ka,v=-w,w=p,p=v,null==c._normals[r]?(C=c._normals,V=new P(p,w),C[r]=V):(q=c._normals[r],q.x=p,q.y=w),D=ja=A=hb=c._normals[r],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}Pc=c._vertices[0].y;
l=1;for(n=c.count;l<n;){r=l++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();L=0;for(kb=c.count;L<kb;)ea=L++,null!=c.local_vertices[ea]&&(null==c._vertices[ea]&&(C=c._vertices,V=new P(0,0),C[ea]=V),v=c.local_vertices[ea].x,m=c.local_vertices[ea].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[ea],t.x=O,t.y=F);S=0;for(I=c.count;S<I;)bb=S++,hb=
c._vertices[(bb+1)%c.count],J=hb.x,T=hb.y,u=c._vertices[bb],z=J-u.x,ka=T-u.y,J=z,T=ka,R=-T,T=J,J=R,null==c._normals[bb]?(za=c._normals,ya=new P(J,T),za[bb]=ya):(M=c._normals[bb],M.x=J,M.y=T),D=ja=A=aa=c._normals[bb],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}if(c._vertices[r].y<Pc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();na=0;for(W=c.count;na<W;)Q=na++,null!=c.local_vertices[Q]&&(null==c._vertices[Q]&&(da=c._vertices,
Wa=new P(0,0),da[Q]=Wa),X=c.local_vertices[Q].x,La=c.local_vertices[Q].y,null==La&&(La=0),null==X&&(X=0),U=c.transform.get_local_to_world_matrix(),Y=X,Pa=La,fa=1,Da=U.m00*Y+U.m10*Pa+U.m20*fa,ma=U.m01*Y+U.m11*Pa+U.m21*fa,ua=Da,ab=ma,ta=c._vertices[Q],ta.x=ua,ta.y=ab);ra=0;for(Za=c.count;ra<Za;)ia=ra++,va=c._vertices[(ia+1)%c.count],pa=va.x,ha=va.y,wa=c._vertices[ia],sa=pa-wa.x,Ca=ha-wa.y,pa=sa,ha=Ca,oa=-ha,ha=pa,pa=oa,null==c._normals[ia]?(Ha=c._normals,Ba=new P(pa,ha),Ha[ia]=Ba):(qa=c._normals[ia],
qa.x=pa,qa.y=ha),Aa=Fa=pb=Ga=c._normals[ia],$a=Aa.x*Aa.x+Aa.y*Aa.y,Ea=0==$a?1:Math.sqrt($a),Oa=Fa.x/Ea,Ua=Fa.y/Ea,Ka=Oa,Ma=Ua,pb.x=Ka,pb.y=Ma}Pc=c._vertices[r].y}}Ta=Pc}}if(null!=b.transformed_rect){c=b.transform;if(null==c.parent)var mb=180/Math.PI*c.local_radians;else c.sync(),mb=180/Math.PI*c._radians;var Qc=0==mb}else Qc=!0;if(Qc){c=b.transform;null==c.parent?Qc=c.local_y:(c.sync(),Qc=c._y);var eb=Qc+b.local_ey*b.transform.local_scale_y}else{c=b.transformed_rect;if(0!=c.count){if(c.dirty_vertices){for(c.dirty_vertices=
!1;c._vertices.length>c.count;)c._vertices.pop();l=0;for(n=c.count;l<n;)r=l++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,V=new P(0,0),C[r]=V),v=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[r],t.x=O,t.y=F);l=0;for(n=c.count;l<n;)r=l++,t=c._vertices[(r+1)%c.count],p=t.x,w=t.y,u=c._vertices[r],z=p-u.x,ka=w-u.y,p=z,w=ka,
v=-w,w=p,p=v,null==c._normals[r]?(C=c._normals,V=new P(p,w),C[r]=V):(q=c._normals[r],q.x=p,q.y=w),D=ja=A=hb=c._normals[r],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}Qc=null==c._vertices[0]}else Qc=!0;if(Qc)C=c.transform,null==C.parent?eb=C.local_y:(C.sync(),eb=C._y);else{if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();l=0;for(n=c.count;l<n;)r=l++,null!=c.local_vertices[r]&&(null==c._vertices[r]&&(C=c._vertices,V=new P(0,
0),C[r]=V),v=c.local_vertices[r].x,m=c.local_vertices[r].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=c._vertices[r],t.x=O,t.y=F);l=0;for(n=c.count;l<n;)r=l++,t=c._vertices[(r+1)%c.count],p=t.x,w=t.y,u=c._vertices[r],z=p-u.x,ka=w-u.y,p=z,w=ka,v=-w,w=p,p=v,null==c._normals[r]?(C=c._normals,V=new P(p,w),C[r]=V):(q=c._normals[r],q.x=p,q.y=w),D=ja=A=hb=c._normals[r],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),
ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}Qc=c._vertices[0].y;l=1;for(n=c.count;l<n;){r=l++;if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();L=0;for(kb=c.count;L<kb;)ea=L++,null!=c.local_vertices[ea]&&(null==c._vertices[ea]&&(C=c._vertices,V=new P(0,0),C[ea]=V),v=c.local_vertices[ea].x,m=c.local_vertices[ea].y,null==m&&(m=0),null==v&&(v=0),q=c.transform.get_local_to_world_matrix(),p=v,w=m,K=1,y=q.m00*p+q.m10*w+q.m20*K,la=q.m01*p+q.m11*w+q.m21*K,O=y,F=la,t=
c._vertices[ea],t.x=O,t.y=F);S=0;for(I=c.count;S<I;)bb=S++,hb=c._vertices[(bb+1)%c.count],J=hb.x,T=hb.y,u=c._vertices[bb],z=J-u.x,ka=T-u.y,J=z,T=ka,R=-T,T=J,J=R,null==c._normals[bb]?(za=c._normals,ya=new P(J,T),za[bb]=ya):(M=c._normals[bb],M.x=J,M.y=T),D=ja=A=aa=c._normals[bb],G=D.x*D.x+D.y*D.y,B=0==G?1:Math.sqrt(G),ca=ja.x/B,E=ja.y/B,Ia=ca,H=E,A.x=Ia,A.y=H}if(c._vertices[r].y>Qc){if(c.dirty_vertices){for(c.dirty_vertices=!1;c._vertices.length>c.count;)c._vertices.pop();na=0;for(W=c.count;na<W;)Q=
na++,null!=c.local_vertices[Q]&&(null==c._vertices[Q]&&(da=c._vertices,Wa=new P(0,0),da[Q]=Wa),X=c.local_vertices[Q].x,La=c.local_vertices[Q].y,null==La&&(La=0),null==X&&(X=0),U=c.transform.get_local_to_world_matrix(),Y=X,Pa=La,fa=1,Da=U.m00*Y+U.m10*Pa+U.m20*fa,ma=U.m01*Y+U.m11*Pa+U.m21*fa,ua=Da,ab=ma,ta=c._vertices[Q],ta.x=ua,ta.y=ab);ra=0;for(Za=c.count;ra<Za;)ia=ra++,va=c._vertices[(ia+1)%c.count],pa=va.x,ha=va.y,wa=c._vertices[ia],sa=pa-wa.x,Ca=ha-wa.y,pa=sa,ha=Ca,oa=-ha,ha=pa,pa=oa,null==c._normals[ia]?
(Ha=c._normals,Ba=new P(pa,ha),Ha[ia]=Ba):(qa=c._normals[ia],qa.x=pa,qa.y=ha),Aa=Fa=pb=Ga=c._normals[ia],$a=Aa.x*Aa.x+Aa.y*Aa.y,Ea=0==$a?1:Math.sqrt($a),Oa=Fa.x/Ea,Ua=Fa.y/Ea,Ka=Oa,Ma=Ua,pb.x=Ka,pb.y=Ma}Qc=c._vertices[r].y}}eb=Qc}}v=f;m=Ta;var nb=Va,vc=Ta;null==vc&&(vc=1);null==nb&&(nb=1);null==m&&(m=0);null==v&&(v=0);var Z=Mb.pool.get();R=v;La=m;var gb=nb,Sa=vc;null==Sa&&(Sa=1);null==gb&&(gb=1);null==La&&(La=0);null==R&&(R=0);t=Z.start;t.x=R;t.y=La;t=Z.end;t.x=gb;t.y=Sa;Z.pooled=!1;var lb=(Z.get_dy()-
Z.get_y())*(a.get_dx()-a.get_x())-(Z.get_dx()-Z.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(lb))var qb=null;else{var nc=((Z.get_dx()-Z.get_x())*(a.get_y()-Z.get_y())-(Z.get_dy()-Z.get_y())*(a.get_x()-Z.get_x()))/lb,Uc=((a.get_dx()-a.get_x())*(a.get_y()-Z.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-Z.get_x()))/lb;if(0>nc||1<nc||0>Uc||1<Uc)qb=null;else{q=a.start;var Xa=nc;M=a.end;u=a.start;var Jd=M.x-u.x,Ra=M.y-u.y;z=Jd*Xa;ka=Ra*Xa;var Na=q.x+z,ac=q.y+ka;q=a.start;var Qa=Na-q.x,cb=ac-q.y,ub=Math.sqrt(Qa*
Qa+cb*cb);q=a.start;u=a.end;Qa=u.x-q.x;cb=u.y-q.y;var db=Math.sqrt(Qa*Qa+cb*cb)-ub,ob=0<=lb;q=Z.start;u=Z.end;Qa=u.x-q.x;cb=u.y-q.y;var zb=Math.sqrt(Qa*Qa+cb*cb)*(ob?-1:1);t=xa.norm;v=(Z.get_dy()-Z.get_y())/zb;m=-(Z.get_dx()-Z.get_x())/zb;t.x=v;t.y=m;var fb=xa.norm.x,Ya=xa.norm.y,dc=ob;null==dc&&(dc=!1);r=Xb.pool.get();r.line=null;r.shape=null;r.line2=null;var Cb=dc;null==Cb&&(Cb=!1);r.distance=ub;r.overlap=db;r.inverse_normal=Cb;t=r.hit;t.x=Na;t.y=ac;t=r.normal;t.x=fb;t.y=Ya;r.pooled=!1;var ec=r;
ec.line=a;ec.line2=Z;qb=ec}}null!=qb&&(h=qb);v=Va;m=Ta;nb=Va;vc=eb;null==vc&&(vc=1);null==nb&&(nb=1);null==m&&(m=0);null==v&&(v=0);t=Z.start;t.x=v;t.y=m;t=Z.end;t.x=nb;t.y=vc;lb=(Z.get_dy()-Z.get_y())*(a.get_dx()-a.get_x())-(Z.get_dx()-Z.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(lb)?qb=null:(nc=((Z.get_dx()-Z.get_x())*(a.get_y()-Z.get_y())-(Z.get_dy()-Z.get_y())*(a.get_x()-Z.get_x()))/lb,Uc=((a.get_dx()-a.get_x())*(a.get_y()-Z.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-Z.get_x()))/lb,0>nc||1<
nc||0>Uc||1<Uc?qb=null:(q=a.start,Xa=nc,M=a.end,u=a.start,Jd=M.x-u.x,Ra=M.y-u.y,z=Jd*Xa,ka=Ra*Xa,Na=q.x+z,ac=q.y+ka,q=a.start,Qa=Na-q.x,cb=ac-q.y,ub=Math.sqrt(Qa*Qa+cb*cb),q=a.start,u=a.end,Qa=u.x-q.x,cb=u.y-q.y,db=Math.sqrt(Qa*Qa+cb*cb)-ub,ob=0<=lb,q=Z.start,u=Z.end,Qa=u.x-q.x,cb=u.y-q.y,zb=Math.sqrt(Qa*Qa+cb*cb)*(ob?-1:1),t=xa.norm,v=(Z.get_dy()-Z.get_y())/zb,m=-(Z.get_dx()-Z.get_x())/zb,t.x=v,t.y=m,fb=xa.norm.x,Ya=xa.norm.y,dc=ob,null==dc&&(dc=!1),r=Xb.pool.get(),r.line=null,r.shape=null,r.line2=
null,Cb=dc,null==Cb&&(Cb=!1),r.distance=ub,r.overlap=db,r.inverse_normal=Cb,t=r.hit,t.x=Na,t.y=ac,t=r.normal,t.x=fb,t.y=Ya,r.pooled=!1,ec=r,ec.line=a,ec.line2=Z,qb=ec));null!=qb&&(null==h||h.distance>qb.distance)&&(h=qb);v=Va;m=eb;nb=f;vc=eb;null==vc&&(vc=1);null==nb&&(nb=1);null==m&&(m=0);null==v&&(v=0);t=Z.start;t.x=v;t.y=m;t=Z.end;t.x=nb;t.y=vc;lb=(Z.get_dy()-Z.get_y())*(a.get_dx()-a.get_x())-(Z.get_dx()-Z.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(lb)?qb=null:(nc=((Z.get_dx()-Z.get_x())*(a.get_y()-
Z.get_y())-(Z.get_dy()-Z.get_y())*(a.get_x()-Z.get_x()))/lb,Uc=((a.get_dx()-a.get_x())*(a.get_y()-Z.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-Z.get_x()))/lb,0>nc||1<nc||0>Uc||1<Uc?qb=null:(q=a.start,Xa=nc,M=a.end,u=a.start,Jd=M.x-u.x,Ra=M.y-u.y,z=Jd*Xa,ka=Ra*Xa,Na=q.x+z,ac=q.y+ka,q=a.start,Qa=Na-q.x,cb=ac-q.y,ub=Math.sqrt(Qa*Qa+cb*cb),q=a.start,u=a.end,Qa=u.x-q.x,cb=u.y-q.y,db=Math.sqrt(Qa*Qa+cb*cb)-ub,ob=0<=lb,q=Z.start,u=Z.end,Qa=u.x-q.x,cb=u.y-q.y,zb=Math.sqrt(Qa*Qa+cb*cb)*(ob?-1:1),t=xa.norm,
v=(Z.get_dy()-Z.get_y())/zb,m=-(Z.get_dx()-Z.get_x())/zb,t.x=v,t.y=m,fb=xa.norm.x,Ya=xa.norm.y,dc=ob,null==dc&&(dc=!1),r=Xb.pool.get(),r.line=null,r.shape=null,r.line2=null,Cb=dc,null==Cb&&(Cb=!1),r.distance=ub,r.overlap=db,r.inverse_normal=Cb,t=r.hit,t.x=Na,t.y=ac,t=r.normal,t.x=fb,t.y=Ya,r.pooled=!1,ec=r,ec.line=a,ec.line2=Z,qb=ec));null!=qb&&(null==h||h.distance>qb.distance)&&(h=qb);v=f;m=eb;nb=f;vc=Ta;null==vc&&(vc=1);null==nb&&(nb=1);null==m&&(m=0);null==v&&(v=0);t=Z.start;t.x=v;t.y=m;t=Z.end;
t.x=nb;t.y=vc;lb=(Z.get_dy()-Z.get_y())*(a.get_dx()-a.get_x())-(Z.get_dx()-Z.get_x())*(a.get_dy()-a.get_y());1E-5>=Math.abs(lb)?qb=null:(nc=((Z.get_dx()-Z.get_x())*(a.get_y()-Z.get_y())-(Z.get_dy()-Z.get_y())*(a.get_x()-Z.get_x()))/lb,Uc=((a.get_dx()-a.get_x())*(a.get_y()-Z.get_y())-(a.get_dy()-a.get_y())*(a.get_x()-Z.get_x()))/lb,0>nc||1<nc||0>Uc||1<Uc?qb=null:(q=a.start,Xa=nc,M=a.end,u=a.start,Jd=M.x-u.x,Ra=M.y-u.y,z=Jd*Xa,ka=Ra*Xa,Na=q.x+z,ac=q.y+ka,q=a.start,Qa=Na-q.x,cb=ac-q.y,ub=Math.sqrt(Qa*
Qa+cb*cb),q=a.start,u=a.end,Qa=u.x-q.x,cb=u.y-q.y,db=Math.sqrt(Qa*Qa+cb*cb)-ub,ob=0<=lb,q=Z.start,u=Z.end,Qa=u.x-q.x,cb=u.y-q.y,zb=Math.sqrt(Qa*Qa+cb*cb)*(ob?-1:1),t=xa.norm,v=(Z.get_dy()-Z.get_y())/zb,m=-(Z.get_dx()-Z.get_x())/zb,t.x=v,t.y=m,fb=xa.norm.x,Ya=xa.norm.y,dc=ob,null==dc&&(dc=!1),r=Xb.pool.get(),r.line=null,r.shape=null,r.line2=null,Cb=dc,null==Cb&&(Cb=!1),r.distance=ub,r.overlap=db,r.inverse_normal=Cb,t=r.hit,t.x=Na,t.y=ac,t=r.normal,t.x=fb,t.y=Ya,r.pooled=!1,ec=r,ec.line=a,ec.line2=
Z,qb=ec));null!=qb&&(null==h||h.distance>qb.distance)&&(h=qb);null!=h&&(h.line=a,h.shape=b);return h};xa.line_intersects_circle=function(a,b){var c=a.end,e=a.start,g=c.x-e.x,h=c.y-e.y;c=a.start;var d=b.transform;d.sync();var k=d._x,f=d._y,l=c.x-k;k=c.y-f;f=b.local_radius;d=b.transform;null==d.parent?c=d.local_scale_x:(d.sync(),c=d._scale_x);f*=c;c=g*g+h*h;e=2*(l*g+k*h);h=e*e-4*c*(l*l+k*k-f*f);if(0>h)return null;h=Math.sqrt(h);g=(-e-h)/(2*c);h=(-e+h)/(2*c);return 0<=g&&1>=g?(c=a.start,h=g,d=a.end,
e=a.start,g=d.x-e.x,l=d.y-e.y,g=c.x+g*h,h=c.y+l*h,c=a.start,d=g-c.x,c=h-c.y,l=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-l,c=xa.norm,d=b.transform,null==d.parent?k=d.local_x:(d.sync(),k=d._x),d=b.transform,null==d.parent?d=d.local_y:(d.sync(),d=d._y),c.x=g-k,c.y=h-d,c=xa.norm,k=c.x/f,f=c.y/f,c.x=k,c.y=f,f=xa.norm.x,d=xa.norm.y,k=Xb.pool.get(),k.line=null,k.shape=null,k.line2=null,c=!1,null==c&&(c=!1),k.distance=l,k.overlap=e,k.inverse_normal=c,c=k.hit,c.x=g,c.y=
h,c=k.normal,c.x=f,c.y=d,k.pooled=!1,f=k,f.line=a,f.shape=b,f):0<=h&&1>=h?(c=a.start,d=a.end,e=a.start,g=d.x-e.x,l=d.y-e.y,g=c.x+g*h,h=c.y+l*h,c=a.start,d=g-c.x,c=h-c.y,l=Math.sqrt(d*d+c*c),c=a.start,e=a.end,d=e.x-c.x,c=e.y-c.y,e=Math.sqrt(d*d+c*c)-l,c=xa.norm,d=b.transform,null==d.parent?k=d.local_x:(d.sync(),k=d._x),d=b.transform,null==d.parent?d=d.local_y:(d.sync(),d=d._y),c.x=g-k,c.y=h-d,d=c=xa.norm,k=-d.y,c.x=-d.x/f,c.y=k/f,f=xa.norm.x,d=xa.norm.y,c=!0,null==c&&(c=!1),k=Xb.pool.get(),k.line=
null,k.shape=null,k.line2=null,null==c&&(c=!1),k.distance=l,k.overlap=e,k.inverse_normal=c,c=k.hit,c.x=g,c.y=h,c=k.normal,c.x=f,c.y=d,k.pooled=!1,f=k,f.line=a,f.shape=b,f):null};xa.line_intersects_polygon=function(a,b){var c=null,e=Mb.pool.get(),g=0,h=0,d=1,k=1;null==k&&(k=1);null==d&&(d=1);null==h&&(h=0);null==g&&(g=0);var f=e.start;f.x=g;f.y=h;f=e.end;f.x=d;f.y=k;e.pooled=!1;for(var l=0,n=b.count;l<n;){var r=l++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();
for(var C=0,q=b.count;C<q;){var v=C++;if(null!=b.local_vertices[v]){if(null==b._vertices[v]){var V=b._vertices,m=new P(0,0);V[v]=m}g=b.local_vertices[v].x;h=b.local_vertices[v].y;null==h&&(h=0);null==g&&(g=0);var p=b.transform.get_local_to_world_matrix(),w=g,t=h,u=p.m00*w+p.m10*t+1*p.m20,K=p.m01*w+p.m11*t+1*p.m21;f=b._vertices[v];f.x=u;f.y=K}}for(var y=0,la=b.count;y<la;){var O=y++,F=b._vertices[(O+1)%b.count],z=F.x,ka=F.y,D=b._vertices[O],A=ka-D.y;z-=D.x;ka=A;var hb=-ka;ka=z;z=hb;if(null==b._normals[O]){var ja=
b._normals,G=new P(z,ka);ja[O]=G}else{var B=b._normals[O];B.x=z;B.y=ka}var ca=b._normals[O],E=ca,Ia=ca,H=Ia,ea=H.x*H.x+H.y*H.y,bb=0==ea?1:Math.sqrt(ea),J=Ia.y/bb;E.x=Ia.x/bb;E.y=J}}var L=b._vertices[r];if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var T=0,kb=b.count;T<kb;){var S=T++;if(null!=b.local_vertices[S]){if(null==b._vertices[S]){var I=b._vertices,R=new P(0,0);I[S]=R}var za=b.local_vertices[S].x,M=b.local_vertices[S].y;null==M&&(M=0);null==za&&
(za=0);var Q=b.transform.get_local_to_world_matrix(),ya=za,U=M,na=Q.m01*ya+Q.m11*U+1*Q.m21,La=b._vertices[S];La.x=Q.m00*ya+Q.m10*U+1*Q.m20;La.y=na}}for(var X=0,aa=b.count;X<aa;){var W=X++,da=b._vertices[(W+1)%b.count],Wa=da.x,Y=da.y,ia=b._vertices[W],pa=Y-ia.y;Wa-=ia.x;Y=pa;var ha=-Y;Y=Wa;Wa=ha;if(null==b._normals[W]){var Pa=b._normals,fa=new P(Wa,Y);Pa[W]=fa}else{var Da=b._normals[W];Da.x=Wa;Da.y=Y}var ma=b._normals[W],ta=ma,ra=ma,ua=ra,ab=ua.x*ua.x+ua.y*ua.y,va=0==ab?1:Math.sqrt(ab),Aa=ra.y/va;
ta.x=ra.x/va;ta.y=Aa}}var wa=b._vertices[(r+1)%b.count],Za=L.x,qa=L.y;d=wa.x;k=wa.y;null==k&&(k=1);null==d&&(d=1);null==qa&&(qa=0);null==Za&&(Za=0);var sa=e.start;sa.x=Za;sa.y=qa;var Ca=e.end;Ca.x=d;Ca.y=k;var pb=(e.get_dy()-e.get_y())*(a.get_dx()-a.get_x())-(e.get_dx()-e.get_x())*(a.get_dy()-a.get_y());if(1E-5>=Math.abs(pb))var oa=null;else{var Fa=((e.get_dx()-e.get_x())*(a.get_y()-e.get_y())-(e.get_dy()-e.get_y())*(a.get_x()-e.get_x()))/pb,Ha=((a.get_dx()-a.get_x())*(a.get_y()-e.get_y())-(a.get_dy()-
a.get_y())*(a.get_x()-e.get_x()))/pb;if(0>Fa||1<Fa||0>Ha||1<Ha)oa=null;else{var Ba=a.start,$a=Fa,Ea=a.end,Ga=a.start,Ja=Ba.x+(Ea.x-Ga.x)*$a,Oa=Ba.y+(Ea.y-Ga.y)*$a,Ua=a.start,Ka=Ja-Ua.x,Ma=Oa-Ua.y,Xa=Math.sqrt(Ka*Ka+Ma*Ma),Na=a.start,Va=a.end,Ta=Va.x-Na.x,eb=Va.y-Na.y,Ra=Math.sqrt(Ta*Ta+eb*eb)-Xa,db=0<=pb,ib=e.start,nb=e.end,fb=nb.x-ib.x,Z=nb.y-ib.y,Ya=Math.sqrt(fb*fb+Z*Z)*(db?-1:1),jb=xa.norm,lb=(e.get_dy()-e.get_y())/Ya,qb=-(e.get_dx()-e.get_x())/Ya;jb.x=lb;jb.y=qb;var nc=xa.norm.x,mb=xa.norm.y,
gb=db;null==gb&&(gb=!1);var Sa=Xb.pool.get();Sa.line=null;Sa.shape=null;Sa.line2=null;var tb=gb;null==tb&&(tb=!1);Sa.distance=Xa;Sa.overlap=Ra;Sa.inverse_normal=tb;var Nb=Sa.hit;Nb.x=Ja;Nb.y=Oa;var ac=Sa.normal;ac.x=nc;ac.y=mb;Sa.pooled=!1;var Qa=Sa;Qa.line=a;Qa.line2=e;oa=Qa}}null!=oa&&(null==c||c.distance>oa.distance)&&(c=oa)}null!=c&&(c.line=a,c.shape=b);return c};xa.rect_and_rect=function(a,b,c){null==c&&(c=!1);var e=null,g=a.transform;if(null==g.parent)var h=180/Math.PI*g.local_radians;else g.sync(),
h=180/Math.PI*g._radians;0==h?(g=b.transform,null==g.parent?h=180/Math.PI*g.local_radians:(g.sync(),h=180/Math.PI*g._radians),h=0!=h):h=!0;if(h){if(null!=a.transformed_rect){e=xa.rect_and_polygon(b,a.transformed_rect,c);if(null==e)return null;c?e.sa=a:e.sb=a;return e}if(null!=b.transformed_rect){e=xa.rect_and_polygon(a,b.transformed_rect,!c);if(null==e)return null;c?e.sa=b:e.sb=b;return e}}h=c?b:a;a=c?a:b;g=a.transform;null==g.parent?b=g.local_x:(g.sync(),b=g._x);g=h.transform;null==g.parent?g=g.local_x:
(g.sync(),g=g._x);b-=g;g=a.transform;null==g.parent?c=g.local_y:(g.sync(),c=g._y);g=h.transform;null==g.parent?g=g.local_y:(g.sync(),g=g._y);g=c-g;c=h.local_ex*h.transform.local_scale_x+a.local_ex*a.transform.local_scale_x-Math.abs(b);if(0<c){var d=h.local_ey*h.transform.local_scale_y+a.local_ey*a.transform.local_scale_y-Math.abs(g);if(0<d){if(c<d){e=uc.pool.get();e.sa=null;e.sb=null;for(var k=e.contact_count=0,f=e.contacts;k<f.length;){var l=f[k];++k;l.x=0;l.y=0}e.overlap=c;c=e.normal;c.x=0>b?-1:
1;c.y=0}else{e=uc.pool.get();e.sa=null;e.sb=null;k=e.contact_count=0;for(f=e.contacts;k<f.length;)l=f[k],++k,l.x=0,l.y=0;e.overlap=d;c=e.normal;c.x=0;c.y=0>g?-1:1}e.pooled=!1;e.sa=h;e.sb=a}}return e};xa.circle_and_circle=function(a,b,c){null==c&&(c=!1);var e=c?b:a;a=c?a:b;var g=a.transform;null==g.parent?b=g.local_x:(g.sync(),b=g._x);g=e.transform;null==g.parent?c=g.local_x:(g.sync(),c=g._x);b-=c;g=a.transform;null==g.parent?c=g.local_y:(g.sync(),c=g._y);g=e.transform;null==g.parent?g=g.local_y:(g.sync(),
g=g._y);c-=g;var h=e.local_radius;g=e.transform;if(null==g.parent)var d=g.local_scale_x;else g.sync(),d=g._scale_x;var k=a.local_radius;g=a.transform;null==g.parent?g=g.local_scale_x:(g.sync(),g=g._scale_x);h=h*d+k*g;d=b*b+c*c;g=null;if(d>=h*h)return g;if(1E-5>=Math.abs(d)){h=e.local_radius;g=e.transform;null==g.parent?b=g.local_scale_x:(g.sync(),b=g._scale_x);b*=h;g=uc.pool.get();g.sa=null;g.sb=null;k=g.contact_count=0;for(var f=g.contacts;k<f.length;){var l=f[k];++k;l.x=0;l.y=0}g.overlap=b;h=g.normal;
h.x=1;h.y=0}else{d=Math.sqrt(d);b/=d;c/=d;g=uc.pool.get();g.sa=null;g.sb=null;k=g.contact_count=0;for(f=g.contacts;k<f.length;)l=f[k],++k,l.x=0,l.y=0;g.overlap=h-d;h=g.normal;h.x=b;h.y=c}g.pooled=!1;g.sa=e;g.sb=a;return g};xa.polygon_and_polygon=function(a,b,c){null==c&&(c=!1);var e=xa.check_polygons(a,b,c);if(null==e)return null;a=xa.check_polygons(b,a,!c);if(null==a)return null;0>e.overlap&&(e.overlap=Math.abs(e.overlap));0>a.overlap&&(a.overlap=Math.abs(a.overlap));if(e.overlap<a.overlap)return a.put(),
e;e.put();return a};xa.rect_and_circle=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect){var e=a.transform;if(null==e.parent)var g=180/Math.PI*e.local_radians;else e.sync(),g=180/Math.PI*e._radians;g=0!=g}else g=!1;if(g){g=xa.circle_and_polygon(b,a.transformed_rect,c);if(null==g)return null;c?g.sa=a:g.sb=a;return g}c?(e=b.transform,null==e.parent?g=e.local_x:(e.sync(),g=e._x),e=a.transform):(e=a.transform,null==e.parent?g=e.local_x:(e.sync(),g=e._x),e=b.transform);if(null==e.parent)var h=
e.local_x;else e.sync(),h=e._x;g-=h;c?(e=b.transform,null==e.parent?h=e.local_y:(e.sync(),h=e._y),e=a.transform):(e=a.transform,null==e.parent?h=e.local_y:(e.sync(),h=e._y),e=b.transform);if(null==e.parent)var d=e.local_y;else e.sync(),d=e._y;h-=d;var k=g,f=h;d=-(a.local_ex*a.transform.local_scale_x);var l=a.local_ex*a.transform.local_scale_x;k<d?k=d:k>l&&(k=l);d=-(a.local_ey*a.transform.local_scale_y);l=a.local_ey*a.transform.local_scale_y;f<d?f=d:f>l&&(f=l);l=!1;d=b.local_radius;e=b.transform;null==
e.parent?e=e.local_scale_x:(e.sync(),e=e._scale_x);d*=e;1E-5>=Math.abs(g-k)&&1E-5>=Math.abs(h-f)&&(l=!0,Math.abs(g)>Math.abs(h)?k=0<k?a.local_ex*a.transform.local_scale_x+d+.1:-(a.local_ex*a.transform.local_scale_x)-d-.1:f=0<f?a.local_ey*a.transform.local_scale_y+d+.1:-(a.local_ey*a.transform.local_scale_y)-d-.1);g-=k;h-=f;k=g*g+h*h;if(k>d*d&&!l)return null;k=Math.sqrt(k);g/=k;h/=k;l&&(g*=-1,h*=-1);k=Math.abs(d-k);d=uc.pool.get();d.sa=null;d.sb=null;f=d.contact_count=0;for(l=d.contacts;f<l.length;)e=
l[f],++f,e.x=0,e.y=0;d.overlap=k;k=d.normal;k.x=g;k.y=h;d.pooled=!1;g=d;g.sa=c?b:a;g.sb=c?a:b;return g};xa.rect_and_polygon=function(a,b,c){null==c&&(c=!1);if(null!=a.transformed_rect)b=xa.polygon_and_polygon(a.transformed_rect,b,c);else{var e=Xa.pool.get();e.count=4;for(var g=0,h=e.count;g<h;){var d=g++;if(null==e.local_vertices[d]){var k=e.local_vertices,f=new P(0,0);k[d]=f}}g=e.local_vertices[0];g.x=-(a.local_ex*a.transform.local_scale_x);g.y=-(a.local_ey*a.transform.local_scale_y);g=e.local_vertices[1];
g.x=a.local_ex*a.transform.local_scale_x;g.y=-(a.local_ey*a.transform.local_scale_y);g=e.local_vertices[2];g.x=a.local_ex*a.transform.local_scale_x;g.y=a.local_ey*a.transform.local_scale_y;g=e.local_vertices[3];g.x=-(a.local_ex*a.transform.local_scale_x);g.y=a.local_ey*a.transform.local_scale_y;g=a.transform.local_x;h=e.transform;h.dirty||h.set_dirty();h.local_x=g;g=a.transform.local_y;h=e.transform;h.dirty||h.set_dirty();h.local_y=g;h=e.transform;g=Math.PI/180*(180/Math.PI)*a.transform.local_radians;
h.dirty||h.set_dirty();h.local_radians=g;g=a.transform.local_scale_x;h=e.transform;h.dirty||h.set_dirty();h.local_scale_x=g;g=a.transform.local_scale_y;h=e.transform;h.dirty||h.set_dirty();h.local_scale_y=g;e.dirty_vertices=!0;e.dirty_bounds=!0;e.pooled=!1;e.set_parent(a.parent);b=xa.polygon_and_polygon(e,b,c);e.put()}if(null==b)return null;c?b.sb=a:b.sa=a;return b};xa.circle_and_polygon=function(a,b,c){null==c&&(c=!1);var e=0,g=1073741823,h=a.transform;h.sync();var d=h._x,k=h._y,f=a.local_radius;
h=a.transform;if(null==h.parent)var l=h.local_scale_x;else h.sync(),l=h._scale_x;for(var n=f*l,r=0,C=b.count;r<C;){var q=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var v=0,V=b.count;v<V;){var m=v++;if(null!=b.local_vertices[m]){if(null==b._vertices[m]){var p=b._vertices,w=new P(0,0);p[m]=w}var t=b.local_vertices[m].x,u=b.local_vertices[m].y;null==u&&(u=0);null==t&&(t=0);var K=b.transform.get_local_to_world_matrix(),y=t,O=u,la=1,z=K.m00*y+K.m10*
O+K.m20*la,F=K.m01*y+K.m11*O+K.m21*la,ka=z,D=F,A=b._vertices[m];A.x=ka;A.y=D}}for(var hb=0,ja=b.count;hb<ja;){var G=hb++,B=b._vertices[(G+1)%b.count],ca=B.x,E=B.y,Ia=b._vertices[G],H=ca-Ia.x,ea=E-Ia.y;ca=H;E=ea;var bb=-E;E=ca;ca=bb;if(null==b._normals[G]){var J=b._normals,L=new P(ca,E);J[G]=L}else{var S=b._normals[G];S.x=ca;S.y=E}var T=b._normals[G],kb=T,I=T,R=I,za=R.x*R.x+R.y*R.y,M=0==za?1:Math.sqrt(za),Q=I.x/M,ya=I.y/M,U=Q,na=ya;kb.x=U;kb.y=na}}var La=b._vertices[q],W=d-La.x,X=k-La.y;e=W*W+X*X;
if(e<g){g=e;var aa=xa.closest;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var Wa=0,da=b.count;Wa<da;){var Y=Wa++;if(null!=b.local_vertices[Y]){if(null==b._vertices[Y]){var ia=b._vertices,pa=new P(0,0);ia[Y]=pa}var ha=b.local_vertices[Y].x,Pa=b.local_vertices[Y].y;null==Pa&&(Pa=0);null==ha&&(ha=0);var fa=b.transform.get_local_to_world_matrix(),Da=ha,ma=Pa,ra=1,ua=fa.m00*Da+fa.m10*ma+fa.m20*ra,ta=fa.m01*Da+fa.m11*ma+fa.m21*ra,ab=ua,va=ta,Za=b._vertices[Y];
Za.x=ab;Za.y=va}}for(var wa=0,Aa=b.count;wa<Aa;){var oa=wa++,pb=b._vertices[(oa+1)%b.count],qa=pb.x,sa=pb.y,Ca=b._vertices[oa],Fa=qa-Ca.x,Ha=sa-Ca.y;qa=Fa;sa=Ha;var Ba=-sa;sa=qa;qa=Ba;if(null==b._normals[oa]){var $a=b._normals,Ea=new P(qa,sa);$a[oa]=Ea}else{var Ga=b._normals[oa];Ga.x=qa;Ga.y=sa}var Ja=b._normals[oa],Oa=Ja,Ua=Ja,Ka=Ua,Ma=Ka.x*Ka.x+Ka.y*Ka.y,Sa=0==Ma?1:Math.sqrt(Ma),Xa=Ua.x/Sa,Na=Ua.y/Sa,Va=Xa,Ta=Na;Oa.x=Va;Oa.y=Ta}}var eb=b._vertices[q].x;if(b.dirty_vertices){for(b.dirty_vertices=
!1;b._vertices.length>b.count;)b._vertices.pop();for(var db=0,ib=b.count;db<ib;){var nb=db++;if(null!=b.local_vertices[nb]){if(null==b._vertices[nb]){var fb=b._vertices,Z=new P(0,0);fb[nb]=Z}var Ra=b.local_vertices[nb].x,Ya=b.local_vertices[nb].y;null==Ya&&(Ya=0);null==Ra&&(Ra=0);var lb=b.transform.get_local_to_world_matrix(),qb=Ra,jb=Ya,gb=1,mb=lb.m00*qb+lb.m10*jb+lb.m20*gb,tb=lb.m01*qb+lb.m11*jb+lb.m21*gb,Nb=mb,vb=tb,ac=b._vertices[nb];ac.x=Nb;ac.y=vb}}for(var Qa=0,cb=b.count;Qa<cb;){var ub=Qa++,
Mb=b._vertices[(ub+1)%b.count],ob=Mb.x,zb=Mb.y,Wb=b._vertices[ub],rb=ob-Wb.x,dc=zb-Wb.y;ob=rb;zb=dc;var Cb=-zb;zb=ob;ob=Cb;if(null==b._normals[ub]){var ec=b._normals,Gb=new P(ob,zb);ec[ub]=Gb}else{var Ab=b._normals[ub];Ab.x=ob;Ab.y=zb}var Bb=b._normals[ub],Fb=Bb,wb=Bb,md=wb,xb=md.x*md.x+md.y*md.y,sb=0==xb?1:Math.sqrt(xb),Vb=wb.x/sb,Xb=wb.y/sb,Pb=Vb,Qb=Xb;Fb.x=Pb;Fb.y=Qb}}var Ib=b._vertices[q].y;aa.x=eb;aa.y=Ib}}K=xa.closest;W=K.x-d;X=K.y-k;za=W*W+X*X;M=0==za?1:Math.sqrt(za);var Lb=W/M,Ub=X/M,yb=0;
if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();r=0;for(C=b.count;r<C;)q=r++,null!=b.local_vertices[q]&&(null==b._vertices[q]&&(p=b._vertices,w=new P(0,0),p[q]=w),t=b.local_vertices[q].x,u=b.local_vertices[q].y,null==u&&(u=0),null==t&&(t=0),K=b.transform.get_local_to_world_matrix(),y=t,O=u,la=1,z=K.m00*y+K.m10*O+K.m20*la,F=K.m01*y+K.m11*O+K.m21*la,ka=z,D=F,A=b._vertices[q],A.x=ka,A.y=D);r=0;for(C=b.count;r<C;)q=r++,A=b._vertices[(q+1)%b.count],y=A.x,O=A.y,
Ia=b._vertices[q],H=y-Ia.x,ea=O-Ia.y,y=H,O=ea,t=-O,O=y,y=t,null==b._normals[q]?(p=b._normals,w=new P(y,O),p[q]=w):(K=b._normals[q],K.x=y,K.y=O),R=I=kb=B=b._normals[q],za=R.x*R.x+R.y*R.y,M=0==za?1:Math.sqrt(za),Q=I.x/M,ya=I.y/M,U=Q,na=ya,kb.x=U,kb.y=na}Ia=b._vertices[0];var Rc=Lb*Ia.x+Ub*Ia.y,Db=Rc;r=1;for(C=b.count;r<C;){var Ob=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();v=0;for(V=b.count;v<V;)q=v++,null!=b.local_vertices[q]&&(null==b._vertices[q]&&
(p=b._vertices,w=new P(0,0),p[q]=w),t=b.local_vertices[q].x,u=b.local_vertices[q].y,null==u&&(u=0),null==t&&(t=0),K=b.transform.get_local_to_world_matrix(),y=t,O=u,la=1,z=K.m00*y+K.m10*O+K.m20*la,F=K.m01*y+K.m11*O+K.m21*la,ka=z,D=F,A=b._vertices[q],A.x=ka,A.y=D);hb=0;for(ja=b.count;hb<ja;)m=hb++,B=b._vertices[(m+1)%b.count],ca=B.x,E=B.y,Ia=b._vertices[m],H=ca-Ia.x,ea=E-Ia.y,ca=H,E=ea,bb=-E,E=ca,ca=bb,null==b._normals[m]?(J=b._normals,L=new P(ca,E),J[m]=L):(S=b._normals[m],S.x=ca,S.y=E),R=I=kb=T=b._normals[m],
za=R.x*R.x+R.y*R.y,M=0==za?1:Math.sqrt(za),Q=I.x/M,ya=I.y/M,U=Q,na=ya,kb.x=U,kb.y=na}La=b._vertices[Ob];yb=Lb*La.x+Ub*La.y;yb<Rc&&(Rc=yb);yb>Db&&(Db=yb)}var Rb=n,Jb=-n;H=-d;ea=-k;var Sb=Lb*H+Ub*ea;Rc+=Sb;Db+=Sb;var Zb=Rc-Rb,fc=Jb-Db;if(0<Zb||0<fc)return null;var Hb=-(Rb-Rc);c&&(Hb*=-1);t=Lb;u=Ub;f=uc.pool.get();f.sa=null;f.sb=null;r=f.contact_count=0;for(C=f.contacts;r<C.length;){var gc=C[r];++r;gc.x=0;gc.y=0}f.overlap=Hb;A=f.normal;A.x=t;A.y=u;f.pooled=!1;var Eb=f,Kb=Math.abs(Hb);r=0;for(C=b.count;r<
C;){q=r++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();v=0;for(V=b.count;v<V;)m=v++,null!=b.local_vertices[m]&&(null==b._vertices[m]&&(p=b._vertices,w=new P(0,0),p[m]=w),t=b.local_vertices[m].x,u=b.local_vertices[m].y,null==u&&(u=0),null==t&&(t=0),K=b.transform.get_local_to_world_matrix(),y=t,O=u,la=1,z=K.m00*y+K.m10*O+K.m20*la,F=K.m01*y+K.m11*O+K.m21*la,ka=z,D=F,A=b._vertices[m],A.x=ka,A.y=D);hb=0;for(ja=b.count;hb<ja;)G=hb++,B=b._vertices[(G+1)%b.count],
ca=B.x,E=B.y,Ia=b._vertices[G],H=ca-Ia.x,ea=E-Ia.y,ca=H,E=ea,bb=-E,E=ca,ca=bb,null==b._normals[G]?(J=b._normals,L=new P(ca,E),J[G]=L):(S=b._normals[G],S.x=ca,S.y=E),R=I=kb=T=b._normals[G],za=R.x*R.x+R.y*R.y,M=0==za?1:Math.sqrt(za),Q=I.x/M,ya=I.y/M,U=Q,na=ya,kb.x=U,kb.y=na}ha=b._normals[q].x;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();Wa=0;for(da=b.count;Wa<da;)Y=Wa++,null!=b.local_vertices[Y]&&(null==b._vertices[Y]&&(ia=b._vertices,pa=new P(0,0),ia[Y]=
pa),Ba=b.local_vertices[Y].x,Pa=b.local_vertices[Y].y,null==Pa&&(Pa=0),null==Ba&&(Ba=0),fa=b.transform.get_local_to_world_matrix(),Da=Ba,ma=Pa,ra=1,ua=fa.m00*Da+fa.m10*ma+fa.m20*ra,ta=fa.m01*Da+fa.m11*ma+fa.m21*ra,ab=ua,va=ta,aa=b._vertices[Y],aa.x=ab,aa.y=va);wa=0;for(Aa=b.count;wa<Aa;)oa=wa++,Za=b._vertices[(oa+1)%b.count],qa=Za.x,sa=Za.y,La=b._vertices[oa],Fa=qa-La.x,Ha=sa-La.y,qa=Fa,sa=Ha,eb=-sa,sa=qa,qa=eb,null==b._normals[oa]?($a=b._normals,Ea=new P(qa,sa),$a[oa]=Ea):(Ga=b._normals[oa],Ga.x=
qa,Ga.y=sa),Ka=Ua=Oa=pb=b._normals[oa],Ma=Ka.x*Ka.x+Ka.y*Ka.y,Sa=0==Ma?1:Math.sqrt(Ma),Xa=Ua.x/Sa,Na=Ua.y/Sa,Va=Xa,Ta=Na,Oa.x=Va,Oa.y=Ta}Lb=ha;Ub=b._normals[q].y;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();db=0;for(ib=b.count;db<ib;)nb=db++,null!=b.local_vertices[nb]&&(null==b._vertices[nb]&&(fb=b._vertices,Z=new P(0,0),fb[nb]=Z),Ra=b.local_vertices[nb].x,Ya=b.local_vertices[nb].y,null==Ya&&(Ya=0),null==Ra&&(Ra=0),lb=b.transform.get_local_to_world_matrix(),
qb=Ra,jb=Ya,gb=1,mb=lb.m00*qb+lb.m10*jb+lb.m20*gb,tb=lb.m01*qb+lb.m11*jb+lb.m21*gb,Nb=mb,vb=tb,Ja=b._vertices[nb],Ja.x=Nb,Ja.y=vb);Qa=0;for(cb=b.count;Qa<cb;)ub=Qa++,ac=b._vertices[(ub+1)%b.count],ob=ac.x,zb=ac.y,Ca=b._vertices[ub],rb=ob-Ca.x,dc=zb-Ca.y,ob=rb,zb=dc,Cb=-zb,zb=ob,ob=Cb,null==b._normals[ub]?(ec=b._normals,Gb=new P(ob,zb),ec[ub]=Gb):(Ab=b._normals[ub],Ab.x=ob,Ab.y=zb),md=wb=Fb=Mb=b._normals[ub],xb=md.x*md.x+md.y*md.y,sb=0==xb?1:Math.sqrt(xb),Vb=wb.x/sb,Xb=wb.y/sb,Pb=Vb,Qb=Xb,Fb.x=Pb,
Fb.y=Qb}Wb=b._vertices[0];Db=Rc=Lb*Wb.x+Ub*Wb.y;for(var mc=1,Yb=b.count;mc<Yb;){Ob=mc++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();for(var hc=0,pc=b.count;hc<pc;){var Tb=hc++;if(null!=b.local_vertices[Tb]){if(null==b._vertices[Tb]){var Zc=b._vertices,rc=new P(0,0);Zc[Tb]=rc}var ic=b.local_vertices[Tb].x;Ib=b.local_vertices[Tb].y;null==Ib&&(Ib=0);null==ic&&(ic=0);var $b=b.transform.get_local_to_world_matrix(),qc=ic,sc=Ib,lc=$b.m00*qc+$b.m10*sc+1*$b.m20,
jc=$b.m01*qc+$b.m11*sc+1*$b.m21;Bb=b._vertices[Tb];Bb.x=lc;Bb.y=jc}}for(var xc=0,yc=b.count;xc<yc;){var cc=xc++,wc=b._vertices[(cc+1)%b.count],oc=wc.x,kc=wc.y,Fc=b._vertices[cc],zc=kc-Fc.y;oc-=Fc.x;kc=zc;var Jc=-kc;kc=oc;oc=Jc;if(null==b._normals[cc]){var Kc=b._normals,Sc=new P(oc,kc);Kc[cc]=Sc}else{var Lc=b._normals[cc];Lc.x=oc;Lc.y=kc}var Mc=b._normals[cc],Ac=Mc,Cc=Mc,bc=Cc,Dc=bc.x*bc.x+bc.y*bc.y,Ec=0==Dc?1:Math.sqrt(Dc),Nc=Cc.y/Ec;Ac.x=Cc.x/Ec;Ac.y=Nc}}var nd=b._vertices[Ob];yb=Lb*nd.x+Ub*nd.y;
yb<Rc&&(Rc=yb);yb>Db&&(Db=yb)}Rb=n;Jb=-n;Sb=Lb*-d+Ub*-k;Rc+=Sb;Db+=Sb;Zb=Rc-Rb;fc=Jb-Db;if(0<Zb||0<fc)return Eb.put(),null;Hb=-(Rb-Rc);c&&(Hb*=-1);if(Math.abs(Hb)<Kb){var tc=Eb.normal;tc.x=Lb;tc.y=Ub;Eb.overlap=Hb;Kb=Math.abs(Hb)}}Eb.sa=c?b:a;Eb.sb=c?a:b;Eb.overlap=Math.abs(Eb.overlap);c&&(A=Eb.normal,A.x=-A.x,A.y=-A.y);return Eb};xa.check_polygons=function(a,b,c){null==c&&(c=!1);for(var e=0,g=0,h=0,d=0,k=0,f=0,l=0,n=1073741823,r=null,C=0,q=0,v=0,V=a.count;v<V;){var m=v++;if(a.dirty_vertices){for(a.dirty_vertices=
!1;a._vertices.length>a.count;)a._vertices.pop();for(var p=0,w=a.count;p<w;){var t=p++;if(null!=a.local_vertices[t]){if(null==a._vertices[t]){var K=a._vertices,u=new P(0,0);K[t]=u}var y=a.local_vertices[t].x,O=a.local_vertices[t].y;null==O&&(O=0);null==y&&(y=0);var la=a.transform.get_local_to_world_matrix(),z=y,F=O,ka=la.m01*z+la.m11*F+1*la.m21,A=a._vertices[t];A.x=la.m00*z+la.m10*F+1*la.m20;A.y=ka}}for(var D=0,hb=a.count;D<hb;){var ja=D++,G=a._vertices[(ja+1)%a.count],B=G.x,ca=G.y,E=a._vertices[ja],
Ia=ca-E.y;B-=E.x;ca=Ia;var H=-ca;ca=B;B=H;if(null==a._normals[ja]){var ea=a._normals,bb=new P(B,ca);ea[ja]=bb}else{var J=a._normals[ja];J.x=B;J.y=ca}var S=a._normals[ja],kb=S,L=S,T=L,I=T.x*T.x+T.y*T.y,R=0==I?1:Math.sqrt(I),za=L.y/R;kb.x=L.x/R;kb.y=za}}var M=a._normals[m].x;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var Q=0,ya=a.count;Q<ya;){var U=Q++;if(null!=a.local_vertices[U]){if(null==a._vertices[U]){var na=a._vertices,La=new P(0,0);na[U]=La}var W=
a.local_vertices[U].x,Y=a.local_vertices[U].y;null==Y&&(Y=0);null==W&&(W=0);var X=a.transform.get_local_to_world_matrix(),aa=W,Wa=Y,da=X.m01*aa+X.m11*Wa+1*X.m21,fa=a._vertices[U];fa.x=X.m00*aa+X.m10*Wa+1*X.m20;fa.y=da}}for(var ia=0,Pa=a.count;ia<Pa;){var ha=ia++,pa=a._vertices[(ha+1)%a.count],Da=pa.x,ma=pa.y,oa=a._vertices[ha],qa=ma-oa.y;Da-=oa.x;ma=qa;var ra=-ma;ma=Da;Da=ra;if(null==a._normals[ha]){var sa=a._normals,ua=new P(Da,ma);sa[ha]=ua}else{var ta=a._normals[ha];ta.x=Da;ta.y=ma}var Za=a._normals[ha],
wa=Za,ab=Za,va=ab,xa=va.x*va.x+va.y*va.y,Aa=0==xa?1:Math.sqrt(xa),Ca=ab.y/Aa;wa.x=ab.x/Aa;wa.y=Ca}}C=M;q=a._normals[m].y;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var pb=0,Fa=a.count;pb<Fa;){var Ba=pb++;if(null!=a.local_vertices[Ba]){if(null==a._vertices[Ba]){var Ha=a._vertices,Ka=new P(0,0);Ha[Ba]=Ka}var Ga=a.local_vertices[Ba].x,$a=a.local_vertices[Ba].y;null==$a&&($a=0);null==Ga&&(Ga=0);var Ea=a.transform.get_local_to_world_matrix(),Ja=Ga,Ua=
$a,Oa=Ea.m01*Ja+Ea.m11*Ua+1*Ea.m21,Ma=a._vertices[Ba];Ma.x=Ea.m00*Ja+Ea.m10*Ua+1*Ea.m20;Ma.y=Oa}}for(var Sa=0,Xa=a.count;Sa<Xa;){var Na=Sa++,Va=a._vertices[(Na+1)%a.count],Ta=Va.x,Ra=Va.y,Ya=a._vertices[Na],db=Ra-Ya.y;Ta-=Ya.x;Ra=db;var eb=-Ra;Ra=Ta;Ta=eb;if(null==a._normals[Na]){var Z=a._normals,jb=new P(Ta,Ra);Z[Na]=jb}else{var gb=a._normals[Na];gb.x=Ta;gb.y=Ra}var lb=a._normals[Na],ib=lb,fb=lb,mb=fb,tb=mb.x*mb.x+mb.y*mb.y,Nb=0==tb?1:Math.sqrt(tb),yb=fb.y/Nb;ib.x=fb.x/Nb;ib.y=yb}}var Lb=a._vertices[0];
k=d=C*Lb.x+q*Lb.y;for(var Ub=1,Qa=a.count;Ub<Qa;){var cb=Ub++;if(a.dirty_vertices){for(a.dirty_vertices=!1;a._vertices.length>a.count;)a._vertices.pop();for(var ub=0,Wb=a.count;ub<Wb;){var ob=ub++;if(null!=a.local_vertices[ob]){if(null==a._vertices[ob]){var zb=a._vertices,Db=new P(0,0);zb[ob]=Db}var vb=a.local_vertices[ob].x,wb=a.local_vertices[ob].y;null==wb&&(wb=0);null==vb&&(vb=0);var Cb=a.transform.get_local_to_world_matrix(),Ab=vb,Bb=wb,Fb=Cb.m01*Ab+Cb.m11*Bb+1*Cb.m21,Eb=a._vertices[ob];Eb.x=
Cb.m00*Ab+Cb.m10*Bb+1*Cb.m20;Eb.y=Fb}}for(var Mb=0,Hb=a.count;Mb<Hb;){var rb=Mb++,Gb=a._vertices[(rb+1)%a.count],xb=Gb.x,sb=Gb.y,Ib=a._vertices[rb],Rb=sb-Ib.y;xb-=Ib.x;sb=Rb;var Sb=-sb;sb=xb;xb=Sb;if(null==a._normals[rb]){var Vb=a._normals,Xb=new P(xb,sb);Vb[rb]=Xb}else{var Pb=a._normals[rb];Pb.x=xb;Pb.y=sb}var Qb=a._normals[rb],Tb=Qb,Ob=Qb,Jb=Ob,Zb=Jb.x*Jb.x+Jb.y*Jb.y,$b=0==Zb?1:Math.sqrt(Zb),fc=Ob.y/$b;Tb.x=Ob.x/$b;Tb.y=fc}}var cc=a._vertices[cb];h=C*cc.x+q*cc.y;h<d&&(d=h);h>k&&(k=h)}if(b.dirty_vertices){for(b.dirty_vertices=
!1;b._vertices.length>b.count;)b._vertices.pop();for(var gc=0,kc=b.count;gc<kc;){var Kb=gc++;if(null!=b.local_vertices[Kb]){if(null==b._vertices[Kb]){var mc=b._vertices,oc=new P(0,0);mc[Kb]=oc}var hc=b.local_vertices[Kb].x,ic=b.local_vertices[Kb].y;null==ic&&(ic=0);null==hc&&(hc=0);var Yb=b.transform.get_local_to_world_matrix(),pc=hc,qc=ic,Zc=Yb.m01*pc+Yb.m11*qc+1*Yb.m21,rc=b._vertices[Kb];rc.x=Yb.m00*pc+Yb.m10*qc+1*Yb.m20;rc.y=Zc}}for(var sc=0,xc=b.count;sc<xc;){var bc=sc++,wc=b._vertices[(bc+1)%
b.count],lc=wc.x,jc=wc.y,yc=b._vertices[bc],Cc=jc-yc.y;lc-=yc.x;jc=Cc;var Fc=-jc;jc=lc;lc=Fc;if(null==b._normals[bc]){var Lc=b._normals,Mc=new P(lc,jc);Lc[bc]=Mc}else{var Ac=b._normals[bc];Ac.x=lc;Ac.y=jc}var Dc=b._normals[bc],Ec=Dc,zc=Dc,tc=zc,Jc=tc.x*tc.x+tc.y*tc.y,Kc=0==Jc?1:Math.sqrt(Jc),Sc=zc.y/Kc;Ec.x=zc.x/Kc;Ec.y=Sc}}var Nc=b._vertices[0];l=f=C*Nc.x+q*Nc.y;for(var Yc=1,gd=b.count;Yc<gd;){var hd=Yc++;if(b.dirty_vertices){for(b.dirty_vertices=!1;b._vertices.length>b.count;)b._vertices.pop();
for(var $c=0,rd=b.count;$c<rd;){var nd=$c++;if(null!=b.local_vertices[nd]){if(null==b._vertices[nd]){var sd=b._vertices,td=new P(0,0);sd[nd]=td}var Wc=b.local_vertices[nd].x,Xc=b.local_vertices[nd].y;null==Xc&&(Xc=0);null==Wc&&(Wc=0);var Bc=b.transform.get_local_to_world_matrix(),cd=Wc,dd=Xc,zd=Bc.m01*cd+Bc.m11*dd+1*Bc.m21,ed=b._vertices[nd];ed.x=Bc.m00*cd+Bc.m10*dd+1*Bc.m20;ed.y=zd}}for(var fd=0,Ad=b.count;fd<Ad;){var Hc=fd++,id=b._vertices[(Hc+1)%b.count],Oc=id.x,Ic=id.y,jd=b._vertices[Hc],Bd=Ic-
jd.y;Oc-=jd.x;Ic=Bd;var Cd=-Ic;Ic=Oc;Oc=Cd;if(null==b._normals[Hc]){var Dd=b._normals,Ed=new P(Oc,Ic);Dd[Hc]=Ed}else{var kd=b._normals[Hc];kd.x=Oc;kd.y=Ic}var ld=b._normals[Hc],od=ld,ad=ld,Vc=ad,pd=Vc.x*Vc.x+Vc.y*Vc.y,qd=0==pd?1:Math.sqrt(pd),Gd=ad.y/qd;od.x=ad.x/qd;od.y=Gd}}var ud=b._vertices[hd];h=C*ud.x+q*ud.y;h<f&&(f=h);h>l&&(l=h)}e=d-l;g=f-k;if(0<e||0<g)return null;var Tc=-(l-d);c&&(Tc*=-1);if(Math.abs(Tc)<n){if(null==r){var Hd=C,Id=q,Fd=uc.pool.get();Fd.sa=null;Fd.sb=null;for(var bd=Fd.contact_count=
0,vd=Fd.contacts;bd<vd.length;){var wd=vd[bd];++bd;wd.x=0;wd.y=0}Fd.overlap=Tc;var xd=Fd.normal;xd.x=Hd;xd.y=Id;Fd.pooled=!1;r=Fd}else{r.overlap=Tc;var yd=r.normal;yd.x=C;yd.y=q}n=Math.abs(Tc)}}if(null==r)return null;r.sa=c?b:a;r.sb=c?a:b;c&&(A=r.normal,A.x=-A.x,A.y=-A.y);return r};var Yc=function(a,b,c,e,g){null==g&&(g=1);null==e&&(e=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.dirty=this.inverse_dirty=this.coordinates_dirty=!1;this.local_to_world_matrix=new we(1,0,0,0,1,0,0,0,1);this.children=
[];this._scale_x=this._scale_y=1;this._x=this._y=this._radians=0;this.on_dirty=null;this.dirty||this.set_dirty();this.local_x=a;this.dirty||this.set_dirty();this.local_y=b;a=Math.PI/180*c;this.dirty||this.set_dirty();this.local_radians=a;this.dirty||this.set_dirty();this.local_scale_x=e;this.dirty||this.set_dirty();this.local_scale_y=g};d["echo.util.Transform"]=Yc;Yc.__name__=!0;Yc.__interfaces__=[Ia];Yc.prototype={set_parent:function(a,b){null!=this.parent&&J.remove(this.parent.children,this);this.parent=
a;null!=a&&this.parent.children.push(this);this.set_dirty()},get_local_to_world_matrix:function(){if(this.dirty){if(null==this.parent){var a=this.local_to_world_matrix,b=Math.sin(this.local_radians),c=Math.cos(this.local_radians),e=c*this.local_scale_x,g=-b*this.local_scale_y,h=this.local_x;b*=this.local_scale_x;var d=c*this.local_scale_y,k=this.local_y;a.m00=e;a.m10=g;a.m20=h;a.m01=b;a.m11=d;a.m21=k;a.m02=0;a.m12=0;a.m22=1}else{a=this.local_to_world_matrix;var f=this.parent.get_local_to_world_matrix();
b=Math.sin(this.local_radians);c=Math.cos(this.local_radians);e=c*this.local_scale_x;g=-b*this.local_scale_y;h=this.local_x;b*=this.local_scale_x;d=c*this.local_scale_y;k=this.local_y;c=f.m00*g+f.m10*d+0*f.m20;var l=f.m00*h+f.m10*k+1*f.m20,n=f.m01*e+f.m11*b+0*f.m21,r=f.m01*g+f.m11*d+0*f.m21,C=f.m01*h+f.m11*k+1*f.m21,q=f.m02*e+f.m12*b+0*f.m22;g=f.m02*g+f.m12*d+0*f.m22;h=f.m02*h+f.m12*k+1*f.m22;a.m00=f.m00*e+f.m10*b+0*f.m20;a.m10=c;a.m20=l;a.m01=n;a.m11=r;a.m21=C;a.m02=q;a.m12=g;a.m22=h}this.dirty=
!1}return this.local_to_world_matrix},sync:function(){if(this.coordinates_dirty){var a=this.get_local_to_world_matrix();if(null==this.parent)this._x=this.local_x,this._y=this.local_y,this._scale_x=this.local_scale_x,this._scale_y=this.local_scale_y,this._radians=this.local_radians;else{var b=a.m00,c=a.m01,e=a.m10,g=a.m11;this._x=a.m20;this._y=a.m21;this._scale_x=Math.sqrt(b*b+c*c);this._scale_y=Math.sqrt(e*e+g*g);this._radians=180/Math.PI*Math.atan2(-e/this._scale_y,b/this._scale_x)}this.coordinates_dirty=
!1}},set_dirty:function(){this.dirty=this.inverse_dirty=this.coordinates_dirty=!0;for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;c.set_dirty()}if(null!=this.on_dirty)this.on_dirty(this)},__class__:Yc};var fc=v["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:n},Module:(f=function(a){return{_hx_index:1,m:a,__enum__:"haxe.StackItem",toString:n}},f._hx_name="Module",f.__params__=["m"],f),FilePos:(f=function(a,
b,c,e){return{_hx_index:2,s:a,file:b,line:c,column:e,__enum__:"haxe.StackItem",toString:n}},f._hx_name="FilePos",f.__params__=["s","file","line","column"],f),Method:(f=function(a,b){return{_hx_index:3,classname:a,method:b,__enum__:"haxe.StackItem",toString:n}},f._hx_name="Method",f.__params__=["classname","method"],f),LocalFunction:(f=function(a){return{_hx_index:4,v:a,__enum__:"haxe.StackItem",toString:n}},f._hx_name="LocalFunction",f.__params__=["v"],f)};fc.__constructs__=[fc.CFunction,fc.Module,
fc.FilePos,fc.Method,fc.LocalFunction];var zc={callStack:function(){return ma.toHaxe(ma.callStack())},exceptionStack:function(a){null==a&&(a=!1);var b=ma.toHaxe(ma.exceptionStack());return a?b:zc.subtract(b,zc.callStack())},toString:function(a){for(var b=new gb,c=0;c<a.length;){var e=a[c];++c;b.b+="\nCalled from ";zc.itemToString(b,e)}return b.b},subtract:function(a,b){for(var c=-1,e=-1;++e<a.length;){for(var g=0,h=b.length;g<h;){var d=g++;if(zc.equalItems(a[e],b[d])){if(0>c&&(c=e),++e,e>=a.length)break}else c=
-1}if(0<=c)break}return 0<=c?a.slice(0,c):a},equalItems:function(a,b){if(null==a)return null==b?!0:!1;switch(a._hx_index){case 0:return null==b?!1:0==b._hx_index?!0:!1;case 1:return null==b?!1:1==b._hx_index?a.m==b.m:!1;case 2:if(null==b)return!1;if(2==b._hx_index){var c=b.s,e=b.line,g=b.column,h=a.column,d=a.line,k=a.s;return a.file==b.file&&d==e&&h==g?zc.equalItems(k,c):!1}return!1;case 3:return null==b?!1:3==b._hx_index?(c=b.method,e=a.method,a.classname==b.classname?e==c:!1):!1;case 4:return null==
b?!1:4==b._hx_index?a.v==b.v:!1}},itemToString:function(a,b){switch(b._hx_index){case 0:a.b+="a C function";break;case 1:b=b.m;a.b+="module ";a.b+=null==b?"null":""+b;break;case 2:var c=b.s,e=b.file,g=b.line;b=b.column;null!=c&&(zc.itemToString(a,c),a.b+=" (");a.b+=null==e?"null":""+e;a.b+=" line ";a.b+=null==g?"null":""+g;null!=b&&(a.b+=" column ",a.b+=null==b?"null":""+b);null!=c&&(a.b+=")");break;case 3:c=b.classname;b=b.method;a.b+=w.string(null==c?"<unknown>":c);a.b+=".";a.b+=null==b?"null":
""+b;break;case 4:b=b.v,a.b+="local function #",a.b+=null==b?"null":""+b}}},Jc=function(){};d["haxe.IMap"]=Jc;Jc.__name__=!0;Jc.__isInterface__=!0;Jc.prototype={__class__:Jc};var y=function(a,b,c){Error.call(this,a);this.message=a;this.__previousException=b;this.__nativeException=null!=c?c:this;this.__skipStack=0;a=Error.prepareStackTrace;Error.prepareStackTrace=function(a){return a.stack};if(c instanceof Error)this.stack=c.stack;else{c=null;if(Error.captureStackTrace)Error.captureStackTrace(this,
y),c=this;else if(c=Error(),"undefined"==typeof c.stack){try{throw c;}catch(e){}this.__skipStack++}this.stack=c.stack}Error.prepareStackTrace=a};d["haxe.Exception"]=y;y.__name__=!0;y.caught=function(a){return a instanceof y?a:a instanceof Error?new y(a.message,null,a):new $c(a,null,a)};y.thrown=function(a){if(a instanceof y)return a.get_native();if(a instanceof Error)return a;a=new $c(a);a.__skipStack++;return a};y.__super__=Error;y.prototype=F(Error.prototype,{unwrap:function(){return this.__nativeException},
toString:function(){return this.get_message()},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_native:function(){return this.__nativeException},get_stack:function(){var a=this.__exceptionStack;null==a&&(a=ma.toHaxe(ma.normalize(this.stack),this.__skipStack),this.setProperty("__exceptionStack",a));return a},setProperty:function(a,b){try{Object.defineProperty(this,a,{value:b})}catch(c){this[a]=b}},__class__:y,__properties__:{get_native:"get_native",get_stack:"get_stack",
get_message:"get_message"}});var fa=function(){};d["haxe.Log"]=fa;fa.__name__=!0;fa.formatOutput=function(a,b){var c=w.string(a);if(null==b)return c;var e=b.fileName+":"+b.lineNumber;if(null!=b.customParams){var g=0;for(b=b.customParams;g<b.length;)a=b[g],++g,c+=", "+w.string(a)}return e+": "+c};fa.trace=function(a,b){a=fa.formatOutput(a,b);"undefined"!=typeof console&&null!=console.log&&console.log(a)};var ma=function(){};d["haxe.NativeStackTrace"]=ma;ma.__name__=!0;ma.saveStack=function(a){ma.lastError=
a};ma.callStack=function(){var a=Error(""),b=ma.tryHaxeStack(a);if("undefined"==typeof b){try{throw a;}catch(c){}b=a.stack}return ma.normalize(b,2)};ma.exceptionStack=function(){return ma.normalize(ma.tryHaxeStack(ma.lastError))};ma.toHaxe=function(a,b){null==b&&(b=0);if(null==a)return[];if("string"==typeof a){a=a.split("\n");"Error"==a[0]&&a.shift();for(var c=[],e=0,g=a.length;e<g;){var h=e++;if(!(b>h)){var d=a[h];h=d.match(/^    at ([A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=h){d=
h[1].split(".");"$hxClasses"==d[0]&&d.shift();var k=d.pop(),f=h[2],l=w.parseInt(h[3]);h=w.parseInt(h[4]);c.push(fc.FilePos("Anonymous function"==k?fc.LocalFunction():"Global code"==k?null:fc.Method(d.join("."),k),f,l,h))}else c.push(fc.Module(W.trim(d)))}}return c}return 0<b&&Array.isArray(a)?a.slice(b):a};ma.tryHaxeStack=function(a){if(null==a)return[];var b=Error.prepareStackTrace;Error.prepareStackTrace=ma.prepareHxStackTrace;a=a.stack;Error.prepareStackTrace=b;return a};ma.prepareHxStackTrace=
function(a,b){a=[];for(var c=0;c<b.length;){var e=b[c];++c;null!=ma.wrapCallSite&&(e=ma.wrapCallSite(e));var g=null,h=e.getFunctionName();if(null!=h){var d=h.lastIndexOf(".");0<=d?(g=h.substring(0,d),h=h.substring(d+1),g=fc.Method(g,h)):g=fc.Method(null,h)}h=e.getFileName();d=null==h?-1:h.indexOf("file:");null!=ma.wrapCallSite&&0<d&&(h=h.substring(d+6));a.push(fc.FilePos(g,h,e.getLineNumber(),e.getColumnNumber()))}return a};ma.normalize=function(a,b){null==b&&(b=0);if(Array.isArray(a)&&0<b)return a.slice(b);
if("string"==typeof a){switch(a.substring(0,6)){case "Error\n":case "Error:":++b}return ma.skipLines(a,b)}return a};ma.skipLines=function(a,b,c){null==c&&(c=0);return 0<b?(c=a.indexOf("\n",c),0>c?"":ma.skipLines(a,--b,c+1)):a.substring(c)};var od=function(){};d["haxe._Unserializer.DefaultResolver"]=od;od.__name__=!0;od.prototype={resolveClass:function(a){return d[a]},resolveEnum:function(a){return v[a]},__class__:od};var Fb=function(a){this.buf=a;this.length=this.buf.length;this.pos=0;this.scache=
[];this.cache=[];a=Fb.DEFAULT_RESOLVER;null==a&&(a=new od,Fb.DEFAULT_RESOLVER=a);this.resolver=a};d["haxe.Unserializer"]=Fb;Fb.__name__=!0;Fb.initCodes=function(){for(var a=[],b=0,c=Fb.BASE64.length;b<c;){var e=b++;a[Fb.BASE64.charCodeAt(e)]=e}return a};Fb.run=function(a){return(new Fb(a)).unserialize()};Fb.prototype={readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(45==e){if(this.pos!=c)break;b=!0}else{if(48>e||57<e)break;a=10*a+(e-48)}this.pos++}b&&
(a*=-1);return a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(b!=b)break;if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return parseFloat(J.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw y.thrown("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw y.thrown("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,
b){if(58!=this.buf.charCodeAt(this.pos++))throw y.thrown("Invalid enum format");var c=this.readDigits();if(0==c)return ja.createEnum(a,b);for(var e=[];0<c--;)e.push(this.unserialize());return ja.createEnum(a,b,e)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var a=this.unserialize(),b=this.resolver.resolveClass(a);if(null==b)throw y.thrown("Class not found "+a);return b;case 66:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw y.thrown("Enum not found "+
a);return b;case 67:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw y.thrown("Class not found "+a);b=Object.create(b.prototype);this.cache.push(b);b.hxUnserialize(this);if(103!=this.buf.charCodeAt(this.pos++))throw y.thrown("Invalid custom data");return b;case 77:a=new Db;this.cache.push(a);for(var c;104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),a.set(b,this.unserialize());this.pos++;return a;case 82:a=this.readDigits();if(0>a||a>=this.scache.length)throw y.thrown("Invalid string reference");
return this.scache[a];case 97:b=[];for(this.cache.push(b);;){c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}117==c?(this.pos++,a=this.readDigits(),b[b.length+a-1]=null):b.push(this.unserialize())}return b;case 98:a=new aa;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)b=this.unserialize(),c=this.unserialize(),a.h[b]=c;this.pos++;return a;case 99:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw y.thrown("Class not found "+a);b=Object.create(b.prototype);
this.cache.push(b);this.unserializeObject(b);return b;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw y.thrown("Enum not found "+a);this.pos++;for(var e=this.readDigits(),g=c.__constructs__,h=Array(g.length),d=0,k=g.length;d<k;)b=d++,h[b]=g[b]._hx_name;b=h[e];if(null==b)throw y.thrown("Unknown enum index "+a+"@"+e);b=this.unserializeEnum(c,b);this.cache.push(b);return b;case 107:return NaN;
case 108:b=new Ob;for(this.cache.push(b);104!=this.buf.charCodeAt(this.pos);)b.add(this.unserialize());this.pos++;return b;case 109:return-Infinity;case 110:return null;case 111:return b={},this.cache.push(b),this.unserializeObject(b),b;case 112:return Infinity;case 113:a=new xb;this.cache.push(a);for(c=this.buf.charCodeAt(this.pos++);58==c;)b=this.readDigits(),c=this.unserialize(),a.h[b]=c,c=this.buf.charCodeAt(this.pos++);if(104!=c)throw y.thrown("Invalid IntMap format");return a;case 114:a=this.readDigits();
if(0>a||a>=this.cache.length)throw y.thrown("Invalid reference");return this.cache[a];case 115:a=this.readDigits();c=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw y.thrown("Invalid bytes length");e=Fb.CODES;null==e&&(e=Fb.initCodes(),Fb.CODES=e);b=this.pos;g=a&3;h=b+(a-g);d=new Ja(new ArrayBuffer(3*(a>>2)+(2<=g?g-1:0)));for(k=0;b<h;){var f=e[c.charCodeAt(b++)],l=e[c.charCodeAt(b++)];d.b[k++]=(f<<2|l>>4)&255;f=e[c.charCodeAt(b++)];d.b[k++]=(l<<4|f>>2)&255;l=e[c.charCodeAt(b++)];
d.b[k++]=(f<<6|l)&255}2<=g&&(f=e[c.charCodeAt(b++)],l=e[c.charCodeAt(b++)],d.b[k++]=(f<<2|l>>4)&255,3==g&&(f=e[c.charCodeAt(b++)],d.b[k++]=(l<<4|f>>2)&255));this.pos+=a;this.cache.push(d);return d;case 116:return!0;case 118:return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&48<=this.buf.charCodeAt(this.pos+1)&&57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+
3)&&45==this.buf.charCodeAt(this.pos+4)?(b=J.strDate(J.substr(this.buf,this.pos,19)),this.pos+=19):b=new Date(this.readFloat()),this.cache.push(b),b;case 119:a=this.unserialize();c=this.resolver.resolveEnum(a);if(null==c)throw y.thrown("Enum not found "+a);b=this.unserializeEnum(c,this.unserialize());this.cache.push(b);return b;case 120:throw y.thrown(this.unserialize());case 121:a=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw y.thrown("Invalid string length");
b=J.substr(this.buf,this.pos,a);this.pos+=a;b=decodeURIComponent(b.split("+").join(" "));this.scache.push(b);return b;case 122:return 0}this.pos--;throw y.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos);},__class__:Fb};var $c=function(a,b,c){y.call(this,String(a),b,c);this.value=a;this.__skipStack++};d["haxe.ValueException"]=$c;$c.__name__=!0;$c.__super__=y;$c.prototype=F(y.prototype,{unwrap:function(){return this.value},__class__:$c});var Kc=function(){this.a1=1;this.a2=
0};d["haxe.crypto.Adler32"]=Kc;Kc.__name__=!0;Kc.read=function(a){var b=new Kc,c=a.readByte(),e=a.readByte(),g=a.readByte();a=a.readByte();b.a1=g<<8|a;b.a2=c<<8|e;return b};Kc.prototype={update:function(a,b,c){var e=this.a1,g=this.a2,h=b;for(b+=c;h<b;)c=h++,e=(e+a.b[c])%65521,g=(g+e)%65521;this.a1=e;this.a2=g},equals:function(a){return a.a1==this.a1?a.a2==this.a2:!1},__class__:Kc};var Ja=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};
d["haxe.io.Bytes"]=Ja;Ja.__name__=!0;Ja.ofString=function(a,b){b=[];for(var c=0;c<a.length;){var e=a.charCodeAt(c++);55296<=e&&56319>=e&&(e=e-55232<<10|a.charCodeAt(c++)&1023);127>=e?b.push(e):(2047>=e?b.push(192|e>>6):(65535>=e?b.push(224|e>>12):(b.push(240|e>>18),b.push(128|e>>12&63)),b.push(128|e>>6&63)),b.push(128|e&63))}return new Ja((new Uint8Array(b)).buffer)};Ja.ofData=function(a){var b=a.hxBytes;return null!=b?b:new Ja(a)};Ja.prototype={blit:function(a,b,c,e){if(0>a||0>c||0>e||a+e>this.length||
c+e>b.length)throw y.thrown(Hb.OutsideBounds);0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},getString:function(a,b,c){if(0>a||0>b||a+b>this.length)throw y.thrown(Hb.OutsideBounds);c="";var e=this.b,g=G.fromCharCode,h=a;for(a+=b;h<a;)if(b=e[h++],128>b){if(0==b)break;c+=g(b)}else if(224>b)c+=g((b&63)<<6|e[h++]&127);else if(240>b){var d=e[h++];c+=g((b&31)<<12|(d&127)<<6|e[h++]&127)}else{d=e[h++];var k=e[h++];b=(b&15)<<18|(d&127)<<12|(k&127)<<6|e[h++]&127;c+=g((b>>10)+55232);
c+=g(b&1023|56320)}return c},toString:function(){return this.getString(0,this.length)},__class__:Ja};var gd=v["haxe.ds.Either"]={__ename__:!0,__constructs__:null,Left:(f=function(a){return{_hx_index:0,v:a,__enum__:"haxe.ds.Either",toString:n}},f._hx_name="Left",f.__params__=["v"],f),Right:(f=function(a){return{_hx_index:1,v:a,__enum__:"haxe.ds.Either",toString:n}},f._hx_name="Right",f.__params__=["v"],f)};gd.__constructs__=[gd.Left,gd.Right];var xb=function(){this.h={}};d["haxe.ds.IntMap"]=xb;xb.__name__=
!0;xb.__interfaces__=[Jc];xb.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(+b);return new Ec(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref[a]}}},toString:function(){var a=
"{";for(var b=this.keys();b.hasNext();){var c=b.next();a+=null==c?"null":""+c;a+=" => ";a+=w.string(w.string(this.h[c]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:xb};var Ob=function(){this.length=0};d["haxe.ds.List"]=Ob;Ob.__name__=!0;Ob.prototype={add:function(a){a=new ad(a,null);null==this.h?this.h=a:this.q.next=a;this.q=a;this.length++},push:function(a){this.h=a=new ad(a,this.h);null==this.q&&(this.q=a);this.length++},first:function(){return null==this.h?null:this.h.item},pop:function(){if(null==
this.h)return null;var a=this.h.item;this.h=this.h.next;null==this.h&&(this.q=null);this.length--;return a},isEmpty:function(){return null==this.h},toString:function(){var a,b=!0,c=this.h;for(a="{";null!=c;)b?b=!1:a+=", ",a+=w.string(w.string(c.item)),c=c.next;return a+"}"},__class__:Ob};var ad=function(a,b){this.item=a;this.next=b};d["haxe.ds._List.ListNode"]=ad;ad.__name__=!0;ad.prototype={__class__:ad};var Db=function(){this.h={__keys__:{}}};d["haxe.ds.ObjectMap"]=Db;Db.__name__=!0;Db.__interfaces__=
[Jc];Db.prototype={set:function(a,b){var c=a.__id__;null==c&&(c=a.__id__=t.$haxeUID++);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},exists:function(a){return null!=this.h.__keys__[a.__id__]},remove:function(a){a=a.__id__;if(null==this.h.__keys__[a])return!1;delete this.h[a];delete this.h.__keys__[a];return!0},keys:function(){var a=[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return new Ec(a)},toString:function(){var a="{";for(var b=
this.keys();b.hasNext();){var c=b.next();a+=w.string(w.string(c));a+=" => ";a+=w.string(w.string(this.h[c.__id__]));b.hasNext()&&(a+=", ")}return a+"}"},__class__:Db};var aa=function(){this.h=Object.create(null)};d["haxe.ds.StringMap"]=aa;aa.__name__=!0;aa.__interfaces__=[Jc];aa.stringify=function(a){var b="{",c=!0,e;for(e in a)c?c=!1:b+=",",b+=e+" => "+w.string(a[e]);return b+"}"};aa.prototype={exists:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)},get:function(a){return this.h[a]},
set:function(a,b){this.h[a]=b},remove:function(a){return Object.prototype.hasOwnProperty.call(this.h,a)?(delete this.h[a],!0):!1},toString:function(){return aa.stringify(this.h)},__class__:aa};var Sc=function(a,b,c){y.call(this,a,b);this.posInfos=null==c?{fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:c;this.__skipStack++};d["haxe.exceptions.PosException"]=Sc;Sc.__name__=!0;Sc.__super__=y;Sc.prototype=F(y.prototype,{toString:function(){return""+y.prototype.toString.call(this)+
" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber},__class__:Sc});var Vc=function(a,b,c){null==a&&(a="Not implemented");Sc.call(this,a,b,c);this.__skipStack++};d["haxe.exceptions.NotImplementedException"]=Vc;Vc.__name__=!0;Vc.__super__=Sc;Vc.prototype=F(Sc.prototype,{__class__:Vc});var pd=function(){this.size=this.pos=0};d["haxe.io.BytesBuffer"]=pd;pd.__name__=!0;pd.prototype={addByte:function(a){this.pos==this.size&&this.grow(1);
this.view.setUint8(this.pos++,a)},add:function(a){this.pos+a.length>this.size&&this.grow(a.length);if(0!=this.size){var b=new Uint8Array(a.b.buffer,a.b.byteOffset,a.length);this.u8.set(b,this.pos);this.pos+=a.length}},addBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw y.thrown(Hb.OutsideBounds);this.pos+c>this.size&&this.grow(c);0!=this.size&&(a=new Uint8Array(a.b.buffer,a.b.byteOffset+b,c),this.u8.set(a,this.pos),this.pos+=c)},grow:function(a){var b=this.pos+a;for(a=0==this.size?16:this.size;a<
b;)a=3*a>>1;b=new ArrayBuffer(a);var c=new Uint8Array(b);0<this.size&&c.set(this.u8);this.size=a;this.buffer=b;this.u8=c;this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new Ja(new ArrayBuffer(0));var a=new Ja(this.buffer);a.length=this.pos;return a},__class__:pd};var qd=function(){};d["haxe.io.Input"]=qd;qd.__name__=!0;qd.prototype={readByte:function(){throw new Vc(null,null,{fileName:"haxe/io/Input.hx",lineNumber:53,className:"haxe.io.Input",methodName:"readByte"});
},readBytes:function(a,b,c){var e=c,g=a.b;if(0>b||0>c||b+c>a.length)throw y.thrown(Hb.OutsideBounds);try{for(;0<e;)g[b]=this.readByte(),++b,--e}catch(h){if(ma.lastError=h,!(y.caught(h).unwrap()instanceof rd))throw h;}return c-e},readFullBytes:function(a,b,c){for(;0<c;){var e=this.readBytes(a,b,c);if(0==e)throw y.thrown(Hb.Blocked);b+=e;c-=e}},read:function(a){for(var b=new Ja(new ArrayBuffer(a)),c=0;0<a;){var e=this.readBytes(b,c,a);if(0==e)throw y.thrown(Hb.Blocked);c+=e;a-=e}return b},readInt16:function(){var a=
this.readByte(),b=this.readByte();a=this.bigEndian?b|a<<8:a|b<<8;return 0!=(a&32768)?a-65536:a},readUInt16:function(){var a=this.readByte(),b=this.readByte();return this.bigEndian?b|a<<8:a|b<<8},readInt32:function(){var a=this.readByte(),b=this.readByte(),c=this.readByte(),e=this.readByte();return this.bigEndian?e|c<<8|b<<16|a<<24:a|b<<8|c<<16|e<<24},readString:function(a,b){var c=new Ja(new ArrayBuffer(a));this.readFullBytes(c,0,a);return c.getString(0,a,b)},__class__:qd};var Gd=function(a,b,c){null==
b&&(b=0);null==c&&(c=a.length-b);if(0>b||0>c||b+c>a.length)throw y.thrown(Hb.OutsideBounds);this.b=a.b;this.pos=b;this.totlen=this.len=c};d["haxe.io.BytesInput"]=Gd;Gd.__name__=!0;Gd.__super__=qd;Gd.prototype=F(qd.prototype,{readByte:function(){if(0==this.len)throw y.thrown(new rd);this.len--;return this.b[this.pos++]},readBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw y.thrown(Hb.OutsideBounds);if(0==this.len&&0<c)throw y.thrown(new rd);this.len<c&&(c=this.len);var e=this.b;a=a.b;for(var g=
0,h=c;g<h;){var d=g++;a[b+d]=e[this.pos+d]}this.pos+=c;this.len-=c;return c},__class__:Gd});var kf=v["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}};kf.__constructs__=[kf.UTF8,kf.RawNative];var rd=function(){};d["haxe.io.Eof"]=rd;rd.__name__=!0;rd.prototype={toString:function(){return"Eof"},__class__:rd};var Hb=v["haxe.io.Error"]={__ename__:!0,
__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(f=function(a){return{_hx_index:3,e:a,__enum__:"haxe.io.Error",toString:n}},f._hx_name="Custom",f.__params__=["e"],f)};Hb.__constructs__=[Hb.Blocked,Hb.Overflow,Hb.OutsideBounds,Hb.Custom];var wc=function(a){switch(a){case ".":case "..":this.dir=
a;this.file="";return}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this.dir=J.substr(a,0,c),a=J.substr(a,c+1,null),this.backslash=!0):c<b?(this.dir=J.substr(a,0,b),a=J.substr(a,b+1,null)):this.dir=null;b=a.lastIndexOf(".");-1!=b?(this.ext=J.substr(a,b+1,null),this.file=J.substr(a,0,b)):(this.ext=null,this.file=a)};d["haxe.io.Path"]=wc;wc.__name__=!0;wc.directory=function(a){a=new wc(a);return null==a.dir?"":a.dir};wc.prototype={__class__:wc};var Ec=function(a){this.current=0;this.array=a};
d["haxe.iterators.ArrayIterator"]=Ec;Ec.__name__=!0;Ec.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Ec};var Lc=v["haxe.zip.ExtraField"]={__ename__:!0,__constructs__:null,FUnknown:(f=function(a,b){return{_hx_index:0,tag:a,bytes:b,__enum__:"haxe.zip.ExtraField",toString:n}},f._hx_name="FUnknown",f.__params__=["tag","bytes"],f),FInfoZipUnicodePath:(f=function(a,b){return{_hx_index:1,name:a,crc:b,__enum__:"haxe.zip.ExtraField",
toString:n}},f._hx_name="FInfoZipUnicodePath",f.__params__=["name","crc"],f),FUtf8:{_hx_name:"FUtf8",_hx_index:2,__enum__:"haxe.zip.ExtraField",toString:n}};Lc.__constructs__=[Lc.FUnknown,Lc.FInfoZipUnicodePath,Lc.FUtf8];var gc=v["haxe.zip.Huffman"]={__ename__:!0,__constructs__:null,Found:(f=function(a){return{_hx_index:0,i:a,__enum__:"haxe.zip.Huffman",toString:n}},f._hx_name="Found",f.__params__=["i"],f),NeedBit:(f=function(a,b){return{_hx_index:1,left:a,right:b,__enum__:"haxe.zip.Huffman",toString:n}},
f._hx_name="NeedBit",f.__params__=["left","right"],f),NeedBits:(f=function(a,b){return{_hx_index:2,n:a,table:b,__enum__:"haxe.zip.Huffman",toString:n}},f._hx_name="NeedBits",f.__params__=["n","table"],f)};gc.__constructs__=[gc.Found,gc.NeedBit,gc.NeedBits];var xe=function(){};d["haxe.zip.HuffTools"]=xe;xe.__name__=!0;xe.prototype={treeDepth:function(a){switch(a._hx_index){case 0:return 0;case 1:var b=a.right;a=this.treeDepth(a.left);b=this.treeDepth(b);return 1+(a<b?a:b);case 2:throw y.thrown("assert");
}},treeCompress:function(a){var b=this.treeDepth(a);if(0==b)return a;if(1==b){if(1==a._hx_index)return b=a.right,gc.NeedBit(this.treeCompress(a.left),this.treeCompress(b));throw y.thrown("assert");}for(var c=[],e=0,g=1<<b;e<g;)e++,c.push(gc.Found(-1));this.treeWalk(c,0,0,b,a);return gc.NeedBits(b,c)},treeWalk:function(a,b,c,e,g){if(1==g._hx_index){var h=g.left,d=g.right;0<e?(this.treeWalk(a,b,c+1,e-1,h),this.treeWalk(a,b|1<<c,c+1,e-1,d)):a[b]=this.treeCompress(g)}else a[b]=this.treeCompress(g)},treeMake:function(a,
b,c,e){if(e>b)throw y.thrown("Invalid huffman");var g=c<<5|e;if(a.h.hasOwnProperty(g))return gc.Found(a.h[g]);c<<=1;++e;return gc.NeedBit(this.treeMake(a,b,c,e),this.treeMake(a,b,c|1,e))},make:function(a,b,c,e){if(1==c)return gc.NeedBit(gc.Found(0),gc.Found(0));var g=[],h=[];if(32<e)throw y.thrown("Invalid huffman");for(var d=0,k=e;d<k;)d++,g.push(0),h.push(0);d=0;for(k=c;d<k;){var f=d++;f=a[f+b];if(f>=e)throw y.thrown("Invalid huffman");g[f]++}var l=0;d=1;for(k=e-1;d<k;)f=d++,l=l+g[f]<<1,h[f]=l;
g=new xb;d=0;for(k=c;d<k;)f=d++,c=a[f+b],0!=c&&(l=h[c-1],h[c-1]=l+1,g.h[l<<5|c]=f);return this.treeCompress(gc.NeedBit(this.treeMake(g,e,0,1),this.treeMake(g,e,1,1)))},__class__:xe};var ye=function(a){this.buffer=new Ja(new ArrayBuffer(65536));this.pos=0;a&&(this.crc=new Kc)};d["haxe.zip._InflateImpl.Window"]=ye;ye.__name__=!0;ye.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,0,32768);var a=new Ja(new ArrayBuffer(65536));this.pos-=32768;a.blit(0,this.buffer,32768,this.pos);
this.buffer=a},addBytes:function(a,b,c){65536<this.pos+c&&this.slide();this.buffer.blit(this.pos,a,b,c);this.pos+=c},addByte:function(a){65536==this.pos&&this.slide();this.buffer.b[this.pos]=a&255;this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){null!=this.crc&&this.crc.update(this.buffer,0,this.pos);return this.crc},__class__:ye};var jb=v["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:null,Head:{_hx_name:"Head",
_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:n},Block:{_hx_name:"Block",_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:n},CData:{_hx_name:"CData",_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",toString:n},Flat:{_hx_name:"Flat",_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:n},Crc:{_hx_name:"Crc",_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:n},Dist:{_hx_name:"Dist",_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:n},DistOne:{_hx_name:"DistOne",
_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:n},Done:{_hx_name:"Done",_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:n}};jb.__constructs__=[jb.Head,jb.Block,jb.CData,jb.Flat,jb.Crc,jb.Dist,jb.DistOne,jb.Done];var vb=function(a,b,c){null==c&&(c=!0);null==b&&(b=!0);this.isFinal=!1;this.htools=new xe;this.huffman=this.buildFixedHuffman();this.huffdist=null;this.dist=this.len=0;this.state=b?jb.Head:jb.Block;this.input=a;this.needed=this.nbits=this.bits=0;this.output=null;this.outpos=
0;this.lengths=[];this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.lengths.push(-1);this.window=new ye(c)};d["haxe.zip.InflateImpl"]=vb;vb.__name__=!0;
vb.prototype={buildFixedHuffman:function(){if(null!=vb.FIXED_HUFFMAN)return vb.FIXED_HUFFMAN;for(var a=[],b=0;288>b;){var c=b++;a.push(143>=c?8:255>=c?9:279>=c?7:8)}vb.FIXED_HUFFMAN=this.htools.make(a,0,288,10);return vb.FIXED_HUFFMAN},readBytes:function(a,b,c){this.needed=c;this.outpos=b;this.output=a;if(0<c)for(;this.inflateLoop(););return c-this.needed},getBits:function(a){for(;this.nbits<a;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var b=this.bits&(1<<a)-1;this.nbits-=a;this.bits>>=
a;return b},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var a=1==(this.bits&1);this.nbits--;this.bits>>=1;return a},getRevBits:function(a){return 0==a?0:this.getBit()?1<<a-1|this.getRevBits(a-1):this.getRevBits(a-1)},resetBits:function(){this.nbits=this.bits=0},addBytes:function(a,b,c){this.window.addBytes(a,b,c);this.output.blit(this.outpos,a,b,c);this.needed-=c;this.outpos+=c},addByte:function(a){this.window.addByte(a);this.output.b[this.outpos]=a&255;this.needed--;
this.outpos++},addDistOne:function(a){for(var b=this.window.getLastChar(),c=0;c<a;)c++,this.addByte(b)},addDist:function(a,b){this.addBytes(this.window.buffer,this.window.pos-a,b)},applyHuffman:function(a){switch(a._hx_index){case 0:var b=a.i;return b;case 1:return b=a.left,a=a.right,this.applyHuffman(this.getBit()?a:b);case 2:return b=a.n,this.applyHuffman(a.table[this.getBits(b)])}},inflateLengths:function(a,b){for(var c=0,e=0;c<b;){var g=this.applyHuffman(this.huffman);switch(g){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:e=
g;a[c]=g;++c;break;case 16:g=c+3+this.getBits(2);if(g>b)throw y.thrown("Invalid data");for(;c<g;)a[c]=e,++c;break;case 17:c+=3+this.getBits(3);if(c>b)throw y.thrown("Invalid data");break;case 18:c+=11+this.getBits(7);if(c>b)throw y.thrown("Invalid data");break;default:throw y.thrown("Invalid data");}}},inflateLoop:function(){switch(this.state._hx_index){case 0:var a=this.input.readByte();if(8!=(a&15))throw y.thrown("Invalid data");var b=this.input.readByte(),c=0!=(b&32);if(0!=((a<<8)+b)%31)throw y.thrown("Invalid data");
if(c)throw y.thrown("Unsupported dictionary");this.state=jb.Block;return!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:this.len=this.input.readUInt16();if(this.input.readUInt16()!=65535-this.len)throw y.thrown("Invalid data");this.state=jb.Flat;a=this.inflateLoop();this.resetBits();return a;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=jb.CData,!0;case 2:a=this.getBits(5)+257;b=this.getBits(5)+1;var e=this.getBits(4)+4;c=0;for(var g=e;c<g;){var h=
c++;this.lengths[vb.CODE_LENGTHS_POS[h]]=this.getBits(3)}c=e;for(g=19;c<g;)h=c++,this.lengths[vb.CODE_LENGTHS_POS[h]]=0;this.huffman=this.htools.make(this.lengths,0,19,8);e=[];c=0;for(g=a+b;c<g;)c++,e.push(0);this.inflateLengths(e,a+b);this.huffdist=this.htools.make(e,a,b,16);this.huffman=this.htools.make(e,0,a,16);this.state=jb.CData;return!0;default:throw y.thrown("Invalid data");}case 2:b=this.applyHuffman(this.huffman);if(256>b)return this.addByte(b),0<this.needed;if(256==b)this.state=this.isFinal?
jb.Crc:jb.Block;else{b-=257;a=vb.LEN_EXTRA_BITS_TBL[b];if(-1==a)throw y.thrown("Invalid data");this.len=vb.LEN_BASE_VAL_TBL[b]+this.getBits(a);b=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);a=vb.DIST_EXTRA_BITS_TBL[b];if(-1==a)throw y.thrown("Invalid data");this.dist=vb.DIST_BASE_VAL_TBL[b]+this.getBits(a);if(this.dist>this.window.available())throw y.thrown("Invalid data");this.state=1==this.dist?jb.DistOne:jb.Dist}return!0;case 3:return a=this.len<this.needed?this.len:
this.needed,b=this.input.read(a),this.len-=a,this.addBytes(b,0,a),0==this.len&&(this.state=this.isFinal?jb.Crc:jb.Block),0<this.needed;case 4:a=this.window.checksum();if(null==a)return this.state=jb.Done,!0;b=Kc.read(this.input);if(!a.equals(b))throw y.thrown("Invalid CRC");this.state=jb.Done;return!0;case 5:for(;0<this.len&&0<this.needed;)a=this.len<this.dist?this.len:this.dist,a=this.needed<a?this.needed:a,this.addDist(this.dist,a),this.len-=a;0==this.len&&(this.state=jb.CData);return 0<this.needed;
case 6:return a=this.len<this.needed?this.len:this.needed,this.addDistOne(a),this.len-=a,0==this.len&&(this.state=jb.CData),0<this.needed;case 7:return!1}},__class__:vb};var sd=function(a){this.i=a};d["haxe.zip.Reader"]=sd;sd.__name__=!0;sd.readZip=function(a){return(new sd(a)).read()};sd.prototype={readZipDate:function(){var a=this.i.readUInt16(),b=a>>11&31,c=a>>5&63;a&=31;var e=this.i.readUInt16();return new Date((e>>9)+1980,(e>>5&15)-1,e&31,b,c,a<<1)},readExtraFields:function(a){for(var b=new Ob;0<
a;){if(4>a)throw y.thrown("Invalid extra fields data");var c=this.i.readUInt16(),e=this.i.readUInt16();if(a<e)throw y.thrown("Invalid extra fields data");if(28789==c){var g=this.i.readByte();if(1!=g){var h=new pd;h.addByte(g);h.add(this.i.read(e-1));b.add(Lc.FUnknown(c,h.getBytes()))}else c=this.i.readInt32(),g=this.i.read(e-5).toString(),b.add(Lc.FInfoZipUnicodePath(g,c))}else b.add(Lc.FUnknown(c,this.i.read(e)));a-=4+e}return b},readEntryHeader:function(){var a=this.i,b=a.readInt32();if(33639248==
b||101010256==b)return null;if(67324752!=b)throw y.thrown("Invalid Zip Data");a.readUInt16();b=a.readUInt16();var c=0!=(b&2048),e=a.readUInt16(),g=0!=e;if(g&&8!=e)throw y.thrown("Unsupported compression "+e);e=this.readZipDate();var h=a.readInt32(),d=a.readInt32(),k=a.readInt32(),f=a.readInt16(),l=a.readInt16();a=a.readString(f);l=this.readExtraFields(l);c&&l.push(Lc.FUtf8);0!=(b&8)&&(d=-1);return{fileName:a,fileSize:k,fileTime:e,compressed:g,dataSize:d,data:null,crc32:h,extraFields:l}},read:function(){for(var a=
new Ob,b=null;;){var c=this.readEntryHeader();if(null==c)break;if(0>c.dataSize){null==b&&(b=new Ja(new ArrayBuffer(65536)));for(var e=new pd,g=new vb(this.i,!1,!1);;){var h=g.readBytes(b,0,65536);e.addBytes(b,0,h);if(65536>h)break}c.data=e.getBytes();c.crc32=this.i.readInt32();134695760==c.crc32&&(c.crc32=this.i.readInt32());c.dataSize=this.i.readInt32();c.fileSize=this.i.readInt32();c.dataSize=c.fileSize;c.compressed=!1}else c.data=this.i.read(c.dataSize);a.add(c)}return a},__class__:sd};var $b=
function(a,b){this.message=a;this.pos=b};d["hxjsonast.Error"]=$b;$b.__name__=!0;$b.prototype={__class__:$b};var Fa=function(a,b){this.value=a;this.pos=b};d["hxjsonast.Json"]=Fa;Fa.__name__=!0;Fa.prototype={__class__:Fa};var Ba=v["hxjsonast.JsonValue"]={__ename__:!0,__constructs__:null,JString:(f=function(a){return{_hx_index:0,s:a,__enum__:"hxjsonast.JsonValue",toString:n}},f._hx_name="JString",f.__params__=["s"],f),JNumber:(f=function(a){return{_hx_index:1,s:a,__enum__:"hxjsonast.JsonValue",toString:n}},
f._hx_name="JNumber",f.__params__=["s"],f),JObject:(f=function(a){return{_hx_index:2,fields:a,__enum__:"hxjsonast.JsonValue",toString:n}},f._hx_name="JObject",f.__params__=["fields"],f),JArray:(f=function(a){return{_hx_index:3,values:a,__enum__:"hxjsonast.JsonValue",toString:n}},f._hx_name="JArray",f.__params__=["values"],f),JBool:(f=function(a){return{_hx_index:4,b:a,__enum__:"hxjsonast.JsonValue",toString:n}},f._hx_name="JBool",f.__params__=["b"],f),JNull:{_hx_name:"JNull",_hx_index:5,__enum__:"hxjsonast.JsonValue",
toString:n}};Ba.__constructs__=[Ba.JString,Ba.JNumber,Ba.JObject,Ba.JArray,Ba.JBool,Ba.JNull];var ze=function(a,b,c){this.name=a;this.namePos=b;this.value=c};d["hxjsonast.JObjectField"]=ze;ze.__name__=!0;ze.prototype={__class__:ze};var ge=function(a,b){this.source=a;this.filename=b;this.pos=0};d["hxjsonast.Parser"]=ge;ge.__name__=!0;ge.prototype={doParse:function(){for(var a=this.parseRec(),b;;){var c=b=this.source.charCodeAt(this.pos++);if(c!=c)break;switch(b){case 9:case 10:case 13:case 32:break;
default:this.invalidChar()}}return a},parseRec:function(){for(;;){var a=this.source.charCodeAt(this.pos++);switch(a){case 9:case 10:case 13:case 32:break;case 34:var b=this.pos,c=this.parseString();return new Fa(Ba.JString(c),new Ca(this.filename,b-1,this.pos));case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:b=this.pos-1;c=45==a;var e=!c;a=48==a;for(var g=!1,h=!1,d=!1,k=!1;;){switch(this.source.charCodeAt(this.pos++)){case 43:case 45:h&&!d||this.invalidNumber(b);
e=!1;d=!0;break;case 46:(c||g||h)&&this.invalidNumber(b);e=!1;g=!0;break;case 48:a&&!g&&this.invalidNumber(b);c&&(c=!1,a=!0);e=!0;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:a&&!g&&this.invalidNumber(b);c&&(c=!1);e=!0;a=!1;break;case 69:case 101:(c||a||h)&&this.invalidNumber(b);e=!1;h=!0;break;default:e||this.invalidNumber(b),this.pos--,k=!0}if(k)break}c=J.substr(this.source,b,this.pos-b);return new Fa(Ba.JNumber(c),new Ca(this.filename,b,this.pos));case 91:for(b=
[],c=null,e=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 44:c?c=!1:this.invalidChar();break;case 93:return 0==c&&this.invalidChar(),new Fa(Ba.JArray(b),new Ca(this.filename,e,this.pos));default:c&&this.invalidChar(),this.pos--,b.push(this.parseRec()),c=!0}case 102:b=this.pos;if(97!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||115!=this.source.charCodeAt(this.pos++)||101!=this.source.charCodeAt(this.pos++))this.pos=
b,this.invalidChar();return new Fa(Ba.JBool(!1),new Ca(this.filename,b-1,this.pos));case 110:b=this.pos;if(117!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++)||108!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new Fa(Ba.JNull,new Ca(this.filename,b-1,this.pos));case 116:b=this.pos;if(114!=this.source.charCodeAt(this.pos++)||117!=this.source.charCodeAt(this.pos++)||101!=this.source.charCodeAt(this.pos++))this.pos=b,this.invalidChar();return new Fa(Ba.JBool(!0),
new Ca(this.filename,b-1,this.pos));case 123:for(b=[],c=Object.create(null),a=h=e=null,g=this.pos-1;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 34:(null!=e||a)&&this.invalidChar();h=this.pos-1;e=this.parseString();h=new Ca(this.filename,h,this.pos);if(Object.prototype.hasOwnProperty.call(c,e))throw y.thrown(new $b('Duplicate field name "'+e+'"',h));c[e]=!0;break;case 44:a?a=!1:this.invalidChar();break;case 58:null==e&&this.invalidChar();b.push(new ze(e,h,
this.parseRec()));h=e=null;a=!0;break;case 125:return null==e&&0!=a||this.invalidChar(),new Fa(Ba.JObject(b),new Ca(this.filename,g,this.pos));default:this.invalidChar()}default:this.invalidChar()}}},parseString:function(){for(var a=this.pos,b=null;;){var c=this.source.charCodeAt(this.pos++);if(34==c)break;if(92==c){null==b&&(b=new gb);c=this.source;var e=this.pos-a-1;b.b+=null==e?J.substr(c,a,null):J.substr(c,a,e);c=this.source.charCodeAt(this.pos++);switch(c){case 34:case 47:case 92:b.b+=String.fromCodePoint(c);
break;case 98:b.b+=String.fromCodePoint(8);break;case 102:b.b+=String.fromCodePoint(12);break;case 110:b.b+=String.fromCodePoint(10);break;case 114:b.b+=String.fromCodePoint(13);break;case 116:b.b+=String.fromCodePoint(9);break;case 117:a=w.parseInt("0x"+J.substr(this.source,this.pos,4));this.pos+=4;b.b+=String.fromCodePoint(a);break;default:throw y.thrown(new $b("Invalid escape sequence \\"+String.fromCodePoint(c),new Ca(this.filename,this.pos-2,this.pos)));}a=this.pos}else if(c!=c)throw this.pos--,
y.thrown(new $b("Unclosed string",new Ca(this.filename,a-1,this.pos)));}if(null==b)return J.substr(this.source,a,this.pos-a-1);c=this.source;e=this.pos-a-1;b.b+=null==e?J.substr(c,a,null):J.substr(c,a,e);return b.b},invalidChar:function(){this.pos--;throw y.thrown(new $b("Invalid character: "+this.source.charAt(this.pos),new Ca(this.filename,this.pos,this.pos+1)));},invalidNumber:function(a){throw y.thrown(new $b("Invalid number: "+this.source.substring(a,this.pos),new Ca(this.filename,a,this.pos)));
},__class__:ge};var Ca=function(a,b,c){this.file=a;this.min=b;this.max=c};d["hxjsonast.Position"]=Ca;Ca.__name__=!0;Ca.prototype={__class__:Ca};var sa=function(){};d["js.Boot"]=sa;sa.__name__=!0;sa.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;var b=a.__class__;if(null!=b)return b;a=sa.__nativeClassName(a);return null!=a?sa.__resolveNativeClass(a):null};sa.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&
(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a.__enum__){var e=v[a.__enum__].__constructs__[a._hx_index];c=e._hx_name;if(e.__params__){b+="\t";var g=[],h=0;for(e=e.__params__;h<e.length;){var d=e[h];h+=1;g.push(sa.__string_rec(a[d],b))}return c+"("+g.join(",")+")"}return c}if(a instanceof Array){c="[";b+="\t";g=0;for(h=a.length;g<h;)e=g++,c+=(0<e?",":"")+sa.__string_rec(a[e],b);return c+"]"}try{g=a.toString}catch(k){return ma.lastError=k,"???"}if(null!=
g&&g!=Object.toString&&"function"==typeof g&&(c=a.toString(),"[object Object]"!=c))return c;c="{\n";b+="\t";g=null!=a.hasOwnProperty;h=null;for(h in a)g&&!a.hasOwnProperty(h)||"prototype"==h||"__class__"==h||"__super__"==h||"__interfaces__"==h||"__properties__"==h||(2!=c.length&&(c+=", \n"),c+=b+h+" : "+sa.__string_rec(a[h],b));b=b.substring(1);return c+("\n"+b+"}");case "string":return a;default:return String(a)}};sa.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;
if(null!=c)for(var e=0,g=c.length;e<g;){var h=e++;h=c[h];if(h==b||sa.__interfLoop(h,b))return!0}return sa.__interfLoop(a.__super__,b)};sa.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array;case of:return"boolean"==typeof a;case pf:return null!=a;case qf:return"number"==typeof a;case rf:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==typeof b){if(sa.__downcastCheck(a,b))return!0}else{if("object"==
typeof b&&sa.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==sf&&null!=a.__name__||b==tf&&null!=a.__ename__?!0:null!=a.__enum__?v[a.__enum__]==b:!1}};sa.__downcastCheck=function(a,b){return a instanceof b?!0:b.__isInterface__?sa.__interfLoop(sa.getClass(a),b):!1};sa.__cast=function(a,b){if(null==a||sa.__instanceof(a,b))return a;throw y.thrown("Cannot cast "+w.string(a)+" to "+w.string(b));};sa.__nativeClassName=function(a){a=sa.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==
a||"Math"==a||"JSON"==a?null:a};sa.__isNativeObj=function(a){return null!=sa.__nativeClassName(a)};sa.__resolveNativeClass=function(a){return t[a]};var oa=v["json2object.Error"]={__ename__:!0,__constructs__:null,IncorrectType:(f=function(a,b,c){return{_hx_index:0,variable:a,expected:b,pos:c,__enum__:"json2object.Error",toString:n}},f._hx_name="IncorrectType",f.__params__=["variable","expected","pos"],f),IncorrectEnumValue:(f=function(a,b,c){return{_hx_index:1,value:a,expected:b,pos:c,__enum__:"json2object.Error",
toString:n}},f._hx_name="IncorrectEnumValue",f.__params__=["value","expected","pos"],f),InvalidEnumConstructor:(f=function(a,b,c){return{_hx_index:2,value:a,expected:b,pos:c,__enum__:"json2object.Error",toString:n}},f._hx_name="InvalidEnumConstructor",f.__params__=["value","expected","pos"],f),UninitializedVariable:(f=function(a,b){return{_hx_index:3,variable:a,pos:b,__enum__:"json2object.Error",toString:n}},f._hx_name="UninitializedVariable",f.__params__=["variable","pos"],f),UnknownVariable:(f=
function(a,b){return{_hx_index:4,variable:a,pos:b,__enum__:"json2object.Error",toString:n}},f._hx_name="UnknownVariable",f.__params__=["variable","pos"],f),ParserError:(f=function(a,b){return{_hx_index:5,message:a,pos:b,__enum__:"json2object.Error",toString:n}},f._hx_name="ParserError",f.__params__=["message","pos"],f),CustomFunctionException:(f=function(a,b){return{_hx_index:6,e:a,pos:b,__enum__:"json2object.Error",toString:n}},f._hx_name="CustomFunctionException",f.__params__=["e","pos"],f)};oa.__constructs__=
[oa.IncorrectType,oa.IncorrectEnumValue,oa.InvalidEnumConstructor,oa.UninitializedVariable,oa.UnknownVariable,oa.ParserError,oa.CustomFunctionException];var sb=v["json2object.InternalError"]={__ename__:!0,__constructs__:null,AbstractNoJsonRepresentation:(f=function(a){return{_hx_index:0,name:a,__enum__:"json2object.InternalError",toString:n}},f._hx_name="AbstractNoJsonRepresentation",f.__params__=["name"],f),CannotGenerateSchema:(f=function(a){return{_hx_index:1,name:a,__enum__:"json2object.InternalError",
toString:n}},f._hx_name="CannotGenerateSchema",f.__params__=["name"],f),HandleExpr:{_hx_name:"HandleExpr",_hx_index:2,__enum__:"json2object.InternalError",toString:n},ParsingThrow:{_hx_name:"ParsingThrow",_hx_index:3,__enum__:"json2object.InternalError",toString:n},UnsupportedAbstractEnumType:(f=function(a){return{_hx_index:4,name:a,__enum__:"json2object.InternalError",toString:n}},f._hx_name="UnsupportedAbstractEnumType",f.__params__=["name"],f),UnsupportedEnumAbstractValue:(f=function(a){return{_hx_index:5,
name:a,__enum__:"json2object.InternalError",toString:n}},f._hx_name="UnsupportedEnumAbstractValue",f.__params__=["name"],f),UnsupportedMapKeyType:(f=function(a){return{_hx_index:6,name:a,__enum__:"json2object.InternalError",toString:n}},f._hx_name="UnsupportedMapKeyType",f.__params__=["name"],f),UnsupportedSchemaObjectType:(f=function(a){return{_hx_index:7,name:a,__enum__:"json2object.InternalError",toString:n}},f._hx_name="UnsupportedSchemaObjectType",f.__params__=["name"],f),UnsupportedSchemaType:(f=
function(a){return{_hx_index:8,type:a,__enum__:"json2object.InternalError",toString:n}},f._hx_name="UnsupportedSchemaType",f.__params__=["type"],f)};sb.__constructs__=[sb.AbstractNoJsonRepresentation,sb.CannotGenerateSchema,sb.HandleExpr,sb.ParsingThrow,sb.UnsupportedAbstractEnumType,sb.UnsupportedEnumAbstractValue,sb.UnsupportedMapKeyType,sb.UnsupportedSchemaObjectType,sb.UnsupportedSchemaType];var Ze=function(){};d["json2object.ErrorUtils"]=Ze;Ze.__name__=!0;Ze.convertError=function(a){switch(a._hx_index){case 0:var b=
a.pos;var c=b;break;case 1:c=b=a.pos;break;case 2:c=b=a.pos;break;case 3:c=b=a.pos;break;case 4:c=b=a.pos;break;case 5:c=b=a.pos;break;case 6:c=b=a.pos}b="";if(null!=c){var e=""==c.file?"line":""+c.file+":";1==c.lines.length?b=""+e+c.lines[0].number+": characters "+c.lines[0].start+"-"+c.lines[0].end+" : ":1<c.lines.length&&(b=""+e+c.lines[0].number+": lines "+c.lines[0].number+"-"+c.lines[c.lines.length-1].number+" : ")}switch(a._hx_index){case 0:return c=a.variable,a=a.expected,b+("Variable '"+
c+"' should be of type '"+a+"'");case 1:return c=a.value,a=a.expected,b+("Identifier '"+c+"' isn't part of '"+a+"'");case 2:return c=a.value,a=a.expected,b+("Enum argument '"+c+"' should be of type '"+a+"'");case 3:return c=a.variable,b+("Variable '"+c+"' should be in the json");case 4:return c=a.variable,b+("Variable '"+c+"' isn't part of the schema");case 5:return b+("Parser error: "+a.message);case 6:return a=a.e,b+("Custom function exception: "+(null==a?"null":w.string(a)))}};var fe=function(a){this.linesInfo=
[];for(var b=0,c,e=0,g=0;e<a.length;)switch(a.charAt(e)){case "\n":c=e;this.linesInfo.push({number:g,start:b,end:c});++g;++e;b=e;break;case "\r":c=e;"\n"==a.charAt(e+1)&&++c;this.linesInfo.push({number:g,start:b,end:c});++g;b=e=c+1;break;default:++e}this.linesInfo.push({number:g,start:b,end:e})};d["json2object.PositionUtils"]=fe;fe.__name__=!0;fe.prototype={convertPosition:function(a){var b=a.min,c=a.max;a={file:a.file,min:b+1,max:c+1,lines:[]};var e=0,g=this.linesInfo.length-1;if(b>this.linesInfo[0].end)for(;g>
e;){var h=(e+g)/2|0,d=this.linesInfo[h];d.start==b&&(g=e=h);d.end<b&&(e=h+1);if(d.start>b||d.end>=b&&d.start<b)g=h}for(g=this.linesInfo.length;e<g;){h=e++;d=this.linesInfo[h];if(d.start<=b&&d.end>=c){a.lines.push({number:d.number+1,start:b-d.start+1,end:c-d.start+1});break}d.start<=b&&b<=d.end&&a.lines.push({number:d.number+1,start:b-d.start+1,end:d.end+1});d.start<=c&&c<=d.end&&a.lines.push({number:d.number+1,start:d.start+1,end:c-d.start+1});if(d.start>=c||d.end>=c)break}return a},__class__:fe};
var be=function(){this.connected=!0;this.buttons=[];this.axes=[]};d["lime._internal.backend.html5.GameDeviceData"]=be;be.__name__=!0;be.prototype={__class__:be};var M=function(){this.validStatus0=(new D("Tizen","gi")).match(window.navigator.userAgent)};d["lime._internal.backend.html5.HTML5HTTPRequest"]=M;M.__name__=!0;M.loadImage=function(a){var b=new wb;M.activeRequests<M.requestLimit?(M.activeRequests++,M.__loadImage(a,b,0)):M.requestQueue.add({instance:null,uri:a,promise:b,type:"IMAGE",options:0});
return b.future};M.loadImageFromBytes=function(a,b){var c=URL.createObjectURL(new Blob([a.b.bufferValue],{type:b}));return null!=c?(a=new wb,M.activeRequests<M.requestLimit?(M.activeRequests++,M.__loadImage(c,a,1)):M.requestQueue.add({instance:null,uri:c,promise:a,type:"IMAGE",options:1}),a.future):M.loadImage("data:"+b+";base64,"+Yb.encode(a))};M.processQueue=function(){if(M.activeRequests<M.requestLimit&&0<M.requestQueue.length){M.activeRequests++;var a=M.requestQueue.pop();switch(a.type){case "BINARY":a.instance.__loadData(a.uri,
a.promise);break;case "IMAGE":M.__loadImage(a.uri,a.promise,a.options);break;case "TEXT":a.instance.__loadText(a.uri,a.promise);break;default:M.activeRequests--}}};M.__fixHostname=function(a){return null==a?"":a};M.__fixPort=function(a,b){if(null==a||""==a)switch(b){case "ftp:":return"21";case "gopher:":return"70";case "http:":return"80";case "https:":return"443";case "ws:":return"80";case "wss:":return"443";default:return""}return a};M.__fixProtocol=function(a){return null==a||""==a?"http:":a};M.__isInMemoryURI=
function(a){return W.startsWith(a,"data:")?!0:W.startsWith(a,"blob:")};M.__isSameOrigin=function(a){if(null==a||""==a||M.__isInMemoryURI(a))return!0;null==M.originElement&&(M.originElement=window.document.createElement("a"),M.originHostname=M.__fixHostname(t.location.hostname),M.originProtocol=M.__fixProtocol(t.location.protocol),M.originPort=M.__fixPort(t.location.port,M.originProtocol));var b=M.originElement;b.href=a;""==b.hostname&&(b.href=b.href);var c=M.__fixHostname(b.hostname);a=M.__fixProtocol(b.protocol);
b=M.__fixPort(b.port,a);c=""==c||c==M.originHostname;b=""==b||b==M.originPort;return"file:"!=a&&c?b:!1};M.__loadImage=function(a,b,c){var e=new Image;M.__isSameOrigin(a)||(e.crossOrigin="Anonymous");null==M.supportsImageProgress&&(M.supportsImageProgress="onprogress"in e);if(M.supportsImageProgress||M.__isInMemoryURI(a))e.addEventListener("load",function(g){M.__revokeBlobURI(a,c);g=new oc(null,e.width,e.height);g.__srcImage=e;M.activeRequests--;M.processQueue();b.complete(new Ka(g))},!1),e.addEventListener("progress",
function(a){b.progress(a.loaded,a.total)},!1),e.addEventListener("error",function(e){M.__revokeBlobURI(a,c);M.activeRequests--;M.processQueue();b.error(e.detail)},!1),e.src=a;else{var g=new XMLHttpRequest;g.onload=function(a){M.activeRequests--;M.processQueue();(new Ka).__fromBytes(Ja.ofData(g.response),function(a){b.complete(a)})};g.onerror=function(a){b.error(a.message)};g.onprogress=function(a){a.lengthComputable&&b.progress(a.loaded,a.total)};g.open("GET",a,!0);g.responseType="arraybuffer";g.overrideMimeType("text/plain; charset=x-user-defined");
g.send(null)}};M.__revokeBlobURI=function(a,b){0!=(b&1)&&URL.revokeObjectURL(a)};M.prototype={init:function(a){this.parent=a},load:function(a,b,c){this.request=new XMLHttpRequest;"POST"==this.parent.method?this.request.upload.addEventListener("progress",b,!1):this.request.addEventListener("progress",b,!1);this.request.onreadystatechange=c;b="";if(null==this.parent.data){c=Object.keys(this.parent.formData.h);for(var e=c.length,g=0;g<e;){var h=c[g++];0<b.length&&(b+="&");var d=this.parent.formData.h[h];
if(-1<h.indexOf("[]")&&d instanceof Array){var k=[];for(d=z(d);d.hasNext();){var f=d.next();k.push(encodeURIComponent(f))}k=k.join("&amp;"+h+"=");b+=encodeURIComponent(h)+"="+k}else k=encodeURIComponent(h)+"=",h=w.string(d),b+=k+encodeURIComponent(h)}"GET"==this.parent.method&&""!=b&&(a=-1<a.indexOf("?")?a+("&"+b):a+("?"+b),b="")}this.request.open(w.string(this.parent.method),a,!0);0<this.parent.timeout&&(this.request.timeout=this.parent.timeout);this.binary&&(this.request.responseType="arraybuffer");
a=null;k=0;for(c=this.parent.headers;k<c.length;)e=c[k],++k,"Content-Type"==e.name?a=e.value:this.request.setRequestHeader(e.name,e.value);null!=this.parent.contentType&&(a=this.parent.contentType);null==a&&(null!=this.parent.data?a="application/octet-stream":""!=b&&(a="application/x-www-form-urlencoded"));null!=a&&this.request.setRequestHeader("Content-Type",a);this.parent.withCredentials&&(this.request.withCredentials=!0);null!=this.parent.data?this.request.send(this.parent.data.b.bufferValue):
this.request.send(b)},loadData:function(a){var b=new wb;M.activeRequests<M.requestLimit?(M.activeRequests++,this.__loadData(a,b)):M.requestQueue.add({instance:this,uri:a,promise:b,type:"BINARY",options:0});return b.future},loadText:function(a){var b=new wb;M.activeRequests<M.requestLimit?(M.activeRequests++,this.__loadText(a,b)):M.requestQueue.add({instance:this,uri:a,promise:b,type:"TEXT",options:0});return b.future},processResponse:function(){if(this.parent.enableResponseHeaders){this.parent.responseHeaders=
[];for(var a,b,c=0,e=this.request.getAllResponseHeaders().split("\n");c<e.length;)b=e[c],++c,a=W.trim(J.substr(b,0,b.indexOf(":"))),b=W.trim(J.substr(b,b.indexOf(":")+1,null)),""!=a&&this.parent.responseHeaders.push(new Ae(a,b))}this.parent.responseStatus=this.request.status},__loadData:function(a,b){var c=this;this.binary=!0;this.load(a,function(a){b.progress(a.loaded,a.total)},function(a){4==c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&400>c.request.status||c.validStatus0&&
0==c.request.status)?(a=null,""==c.request.responseType?null!=c.request.responseText&&(a=Ja.ofString(c.request.responseText)):null!=c.request.response&&(a=Ja.ofData(c.request.response)),c.processResponse(),b.complete(a)):(c.processResponse(),b.error(c.request.status)),c.request=null,M.activeRequests--,M.processQueue())})},__loadText:function(a,b){var c=this;this.binary=!1;this.load(a,function(a){b.progress(a.loaded,a.total)},function(a){4==c.request.readyState&&(null!=c.request.status&&(200<=c.request.status&&
400>=c.request.status||c.validStatus0&&0==c.request.status)?(c.processResponse(),b.complete(c.request.responseText)):(c.processResponse(),b.error(c.request.status)),c.request=null,M.activeRequests--,M.processQueue())})},__class__:M};var td=function(a){this.unusedTouchesPool=new Ob;this.scale=1;this.currentTouches=new xb;this.parent=a;this.cursor=Pb.DEFAULT;this.cacheMouseY=this.cacheMouseX=0;var b=a.__attributes;Object.prototype.hasOwnProperty.call(b,"context")||(b.context={});this.renderType=b.context.type;
Object.prototype.hasOwnProperty.call(b,"element")&&(a.element=b.element);var c=a.element;Object.prototype.hasOwnProperty.call(b,"allowHighDPI")&&b.allowHighDPI&&"dom"!=this.renderType&&(this.scale=window.devicePixelRatio);a.__scale=this.scale;this.setWidth=Object.prototype.hasOwnProperty.call(b,"width")?b.width:0;this.setHeight=Object.prototype.hasOwnProperty.call(b,"height")?b.height:0;a.__width=this.setWidth;a.__height=this.setHeight;a.id=td.windowID++;c instanceof HTMLCanvasElement?this.canvas=
c:"dom"==this.renderType?this.div=window.document.createElement("div"):this.canvas=window.document.createElement("canvas");if(null!=this.canvas){var e=this.canvas.style;e.setProperty("-webkit-transform","translateZ(0)",null);e.setProperty("transform","translateZ(0)",null)}else null!=this.div&&(e=this.div.style,e.setProperty("-webkit-transform","translate3D(0,0,0)",null),e.setProperty("transform","translate3D(0,0,0)",null),e.position="relative",e.overflow="hidden",e.setProperty("-webkit-user-select",
"none",null),e.setProperty("-moz-user-select","none",null),e.setProperty("-ms-user-select","none",null),e.setProperty("-o-user-select","none",null));0==a.__width&&0==a.__height&&(null!=c?(a.__width=c.clientWidth,a.__height=c.clientHeight):(a.__width=window.innerWidth,a.__height=window.innerHeight),this.cacheElementWidth=a.__width,this.cacheElementHeight=a.__height,this.resizeElement=!0);null!=this.canvas?(this.canvas.width=Math.round(a.__width*this.scale),this.canvas.height=Math.round(a.__height*
this.scale),this.canvas.style.width=a.__width+"px",this.canvas.style.height=a.__height+"px"):(this.div.style.width=a.__width+"px",this.div.style.height=a.__height+"px");if(Object.prototype.hasOwnProperty.call(b,"resizable")&&b.resizable||!Object.prototype.hasOwnProperty.call(b,"width")&&0==this.setWidth&&0==this.setHeight)a.__resizable=!0;this.updateSize();if(null!=c){null!=this.canvas?c!=this.canvas&&c.appendChild(this.canvas):c.appendChild(this.div);b="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" ");
for(e=0;e<b.length;){var g=b[e];++e;c.addEventListener(g,p(this,this.handleMouseEvent),!0)}c.addEventListener("contextmenu",p(this,this.handleContextMenuEvent),!0);c.addEventListener("dragstart",p(this,this.handleDragEvent),!0);c.addEventListener("dragover",p(this,this.handleDragEvent),!0);c.addEventListener("drop",p(this,this.handleDragEvent),!0);c.addEventListener("touchstart",p(this,this.handleTouchEvent),!0);c.addEventListener("touchmove",p(this,this.handleTouchEvent),!0);c.addEventListener("touchend",
p(this,this.handleTouchEvent),!0);c.addEventListener("touchcancel",p(this,this.handleTouchEvent),!0);c.addEventListener("gamepadconnected",p(this,this.handleGamepadEvent),!0);c.addEventListener("gamepaddisconnected",p(this,this.handleGamepadEvent),!0)}this.createContext();"webgl"==a.context.type&&(this.canvas.addEventListener("webglcontextlost",p(this,this.handleContextEvent),!1),this.canvas.addEventListener("webglcontextrestored",p(this,this.handleContextEvent),!1))};d["lime._internal.backend.html5.HTML5Window"]=
td;td.__name__=!0;td.prototype={close:function(){this.parent.application.__removeWindow(this.parent)},createContext:function(){var a=new Be,b=this.parent.__attributes.context;a.window=this.parent;a.attributes=b;if(null!=this.div)a.dom=this.div,a.type="dom",a.version="";else if(null!=this.canvas){var c=null,e="canvas"==this.renderType,g="opengl"==this.renderType||"opengles"==this.renderType||"webgl"==this.renderType,h=!Object.prototype.hasOwnProperty.call(b,"version")||"1"!=b.version,d=!1;if(g||!e&&
(!Object.prototype.hasOwnProperty.call(b,"hardware")||b.hardware)){e=Object.prototype.hasOwnProperty.call(b,"background")&&null==b.background;g=Object.prototype.hasOwnProperty.call(b,"colorDepth")?b.colorDepth:16;var k=Object.prototype.hasOwnProperty.call(b,"antialiasing")&&0<b.antialiasing,f=Object.prototype.hasOwnProperty.call(b,"depth")?b.depth:!0;b=Object.prototype.hasOwnProperty.call(b,"stencil")&&b.stencil;b={alpha:e||16<g,antialias:k,depth:f,premultipliedAlpha:!0,stencil:b,preserveDrawingBuffer:!1,
failIfMajorPerformanceCaveat:!1};e=["webgl","experimental-webgl"];h&&e.unshift("webgl2");for(h=0;h<e.length&&(g=e[h],++h,c=this.canvas.getContext(g,b),null!=c&&"webgl2"==g&&(d=!0),null==c););}null==c?(a.canvas2D=this.canvas.getContext("2d"),a.type="canvas",a.version=""):(a.webgl=uf.fromWebGL2RenderContext(c),d&&(a.webgl2=c),null==ud.context&&(ud.context=c,ud.type="webgl",ud.version=d?2:1),a.type="webgl",a.version=d?"2":"1")}this.parent.context=a},handleContextEvent:function(a){switch(a.type){case "webglcontextlost":a.cancelable&&
a.preventDefault();this.parent.context=null;this.parent.onRenderContextLost.dispatch();break;case "webglcontextrestored":this.createContext(),this.parent.onRenderContextRestored.dispatch(this.parent.context)}},handleContextMenuEvent:function(a){(this.parent.onMouseUp.canceled||this.parent.onMouseDown.canceled)&&a.cancelable&&a.preventDefault()},handleDragEvent:function(a){switch(a.type){case "dragover":return a.preventDefault(),!1;case "dragstart":if("img"==sa.__cast(a.target,HTMLElement).nodeName.toLowerCase()&&
a.cancelable)return a.preventDefault(),!1;break;case "drop":if(null!=a.dataTransfer&&0<a.dataTransfer.files.length)return this.parent.onDropFile.dispatch(a.dataTransfer.files),a.preventDefault(),!1}return!0},handleGamepadEvent:function(a){switch(a.type){case "gamepadconnected":mb.__connect(a.gamepad.index);"standard"==a.gamepad.mapping&&db.__connect(a.gamepad.index);break;case "gamepaddisconnected":mb.__disconnect(a.gamepad.index),db.__disconnect(a.gamepad.index)}},handleMouseEvent:function(a){if("wheel"!=
a.type){if(null!=this.parent.element)if(null!=this.canvas){var b=this.canvas.getBoundingClientRect();var c=this.parent.__width/b.width*(a.clientX-b.left);b=this.parent.__height/b.height*(a.clientY-b.top)}else null!=this.div?(b=this.div.getBoundingClientRect(),c=a.clientX-b.left,b=a.clientY-b.top):(b=this.parent.element.getBoundingClientRect(),c=this.parent.__width/b.width*(a.clientX-b.left),b=this.parent.__height/b.height*(a.clientY-b.top));else c=a.clientX,b=a.clientY;switch(a.type){case "mousedown":a.currentTarget==
this.parent.element&&window.addEventListener("mouseup",p(this,this.handleMouseEvent));this.parent.onMouseDown.dispatch(c,b,a.button);this.parent.onMouseDown.canceled&&a.cancelable&&a.preventDefault();break;case "mouseenter":a.target==this.parent.element&&(this.parent.onEnter.dispatch(),this.parent.onEnter.canceled&&a.cancelable&&a.preventDefault());break;case "mouseleave":a.target==this.parent.element&&(this.parent.onLeave.dispatch(),this.parent.onLeave.canceled&&a.cancelable&&a.preventDefault());
break;case "mousemove":if(c!=this.cacheMouseX||b!=this.cacheMouseY)this.parent.onMouseMove.dispatch(c,b),this.parent.onMouseMoveRelative.dispatch(c-this.cacheMouseX,b-this.cacheMouseY),(this.parent.onMouseMove.canceled||this.parent.onMouseMoveRelative.canceled)&&a.cancelable&&a.preventDefault();break;case "mouseup":window.removeEventListener("mouseup",p(this,this.handleMouseEvent)),a.currentTarget==this.parent.element&&a.stopPropagation(),this.parent.onMouseUp.dispatch(c,b,a.button),this.parent.onMouseUp.canceled&&
a.cancelable&&a.preventDefault()}this.cacheMouseX=c;this.cacheMouseY=b}else{switch(a.deltaMode){case 0:c=kc.PIXELS;break;case 1:c=kc.LINES;break;case 2:c=kc.PAGES;break;default:c=kc.UNKNOWN}this.parent.onMouseWheel.dispatch(a.deltaX,-a.deltaY,c);this.parent.onMouseWheel.canceled&&a.cancelable&&a.preventDefault()}},handleResizeEvent:function(a){this.primaryTouch=null;this.updateSize()},handleTouchEvent:function(a){a.cancelable&&a.preventDefault();var b=null;null!=this.parent.element&&(b=null!=this.canvas?
this.canvas.getBoundingClientRect():null!=this.div?this.div.getBoundingClientRect():this.parent.element.getBoundingClientRect());var c=this.setWidth,e=this.setHeight;if(0==c||0==e)null!=b?(c=b.width,e=b.height):e=c=1;for(var g,h,d,k,f,l=0,n=a.changedTouches;l<n.length;){var r=n[l];++l;null!=b?(h=c/b.width*(r.clientX-b.left),d=e/b.height*(r.clientY-b.top)):(h=r.clientX,d=r.clientY);if("touchstart"==a.type)g=this.unusedTouchesPool.pop(),null==g?g=new Ab(h/c,d/e,r.identifier,0,0,r.force,this.parent.id):
(g.x=h/c,g.y=d/e,g.id=r.identifier,g.dx=0,g.dy=0,g.pressure=r.force,g.device=this.parent.id),this.currentTouches.h[r.identifier]=g,Ab.onStart.dispatch(g),null==this.primaryTouch&&(this.primaryTouch=g),g==this.primaryTouch&&this.parent.onMouseDown.dispatch(h,d,0);else if(g=this.currentTouches.h[r.identifier],null!=g)switch(k=g.x,f=g.y,g.x=h/c,g.y=d/e,g.dx=g.x-k,g.dy=g.y-f,g.pressure=r.force,a.type){case "touchcancel":Ab.onCancel.dispatch(g);this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(g);
g==this.primaryTouch&&(this.primaryTouch=null);break;case "touchend":Ab.onEnd.dispatch(g);this.currentTouches.remove(r.identifier);this.unusedTouchesPool.add(g);g==this.primaryTouch&&(this.parent.onMouseUp.dispatch(h,d,0),this.primaryTouch=null);break;case "touchmove":Ab.onMove.dispatch(g),g==this.primaryTouch&&this.parent.onMouseMove.dispatch(h,d)}}},updateSize:function(){if(this.parent.__resizable){if(null!=this.parent.element){var a=this.parent.element.clientWidth;var b=this.parent.element.clientHeight}else a=
window.innerWidth,b=window.innerHeight;if(a!=this.cacheElementWidth||b!=this.cacheElementHeight){this.cacheElementWidth=a;this.cacheElementHeight=b;var c=this.resizeElement||0==this.setWidth&&0==this.setHeight;if(null!=this.parent.element&&(null==this.div||null!=this.div&&c))if(c){if(this.parent.__width!=a||this.parent.__height!=b)this.parent.__width=a,this.parent.__height=b,null!=this.canvas?this.parent.element!=this.canvas&&(this.canvas.width=Math.round(a*this.scale),this.canvas.height=Math.round(b*
this.scale),this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"):(this.div.style.width=a+"px",this.div.style.height=b+"px"),this.parent.onResize.dispatch(a,b)}else{c=0!=this.setWidth?a/this.setWidth:1;var e=0!=this.setHeight?b/this.setHeight:1,g=a,h=b,d=0,k=0;c<e?(h=Math.floor(this.setHeight*c),k=Math.floor((b-h)/2)):(g=Math.floor(this.setWidth*e),d=Math.floor((a-g)/2));null!=this.canvas?this.parent.element!=this.canvas&&(this.canvas.style.width=g+"px",this.canvas.style.height=h+"px",this.canvas.style.marginLeft=
d+"px",this.canvas.style.marginTop=k+"px"):(this.div.style.width=g+"px",this.div.style.height=h+"px",this.div.style.marginLeft=d+"px",this.div.style.marginTop=k+"px")}}}},__class__:td};var Yb=function(){};d["lime._internal.format.Base64"]=Yb;Yb.__name__=!0;Yb.encode=function(a){var b=[],c=Yb.DICTIONARY,e=Yb.EXTENDED_DICTIONARY,g=a.length,h=Math.floor(g/3),d=2*h;b.length=2*Math.ceil(g/3);for(var k=0,f=0,l;f<d;)l=a.b[k]<<16|a.b[k+1]<<8|a.b[k+2],b[f]=e[l>>12&4095],b[f+1]=e[l&4095],k+=3,f+=2;switch(g-
3*h){case 1:l=a.b[k]<<16;b[f]=e[l>>12&4095];b[f+1]="==";break;case 2:l=a.b[k]<<16|a.b[k+1]<<8,b[f]=e[l>>12&4095],b[f+1]=c[l>>6&63]+"="}return b.join("")};var $e=function(){};d["lime._internal.format.Deflate"]=$e;$e.__name__=!0;$e.decompress=function(a){a=pako.inflateRaw(a.b.bufferValue);return Ja.ofData(a)};var af=function(){};d["lime._internal.format.GZip"]=af;af.__name__=!0;af.decompress=function(a){a=pako.ungzip(a.b.bufferValue);return Ja.ofData(a)};var bf=function(){};d["lime._internal.format.LZMA"]=
bf;bf.__name__=!0;bf.decompress=function(a){return null};var cf=function(){};d["lime._internal.format.Zlib"]=cf;cf.__name__=!0;cf.decompress=function(a){a=pako.inflate(a.b.bufferValue);return Ja.ofData(a)};var rb=function(){};d["lime._internal.graphics.ImageCanvasUtil"]=rb;rb.__name__=!0;rb.convertToCanvas=function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage?(null==c.__srcCanvas&&(rb.createCanvas(a,c.__srcImage.width,c.__srcImage.height),c.__srcContext.drawImage(c.__srcImage,0,0)),c.__srcImage=
null):null==c.__srcCanvas&&null!=c.data?(a.set_transparent(!0),rb.createCanvas(a,c.width,c.height),rb.createImageData(a),c.__srcContext.putImageData(c.__srcImageData,0,0)):a.type==rc.DATA&&null!=c.__srcImageData&&a.dirty&&(c.__srcContext.putImageData(c.__srcImageData,0,0),a.dirty=!1);b?(c.data=null,c.__srcImageData=null):null==c.data&&null!=c.__srcImageData&&(c.data=c.__srcImageData.data);a.type=rc.CANVAS};rb.convertToData=function(a,b){null==b&&(b=!1);var c=a.buffer;null!=c.__srcImage&&rb.convertToCanvas(a);
if(null!=c.__srcCanvas&&null==c.data)rb.createImageData(a),a.type==rc.CANVAS&&(a.dirty=!1);else if(a.type==rc.CANVAS&&null!=c.__srcCanvas&&a.dirty){if(null==c.__srcImageData)rb.createImageData(a);else{c.__srcImageData=c.__srcContext.getImageData(0,0,c.width,c.height);var e=c.__srcImageData.data.buffer;e=null!=e?new Uint8Array(e):null;c.data=e}a.dirty=!1}b&&(a.buffer.__srcCanvas=null,a.buffer.__srcContext=null);a.type=rc.DATA};rb.createCanvas=function(a,b,c){var e=a.buffer;null==e.__srcCanvas&&(e.__srcCanvas=
window.document.createElement("canvas"),e.__srcCanvas.width=b,e.__srcCanvas.height=c,a.get_transparent()?e.__srcContext=e.__srcCanvas.getContext("2d"):(a.get_transparent()||e.__srcCanvas.setAttribute("moz-opaque","true"),e.__srcContext=e.__srcCanvas.getContext("2d",{alpha:!1})))};rb.createImageData=function(a){a=a.buffer;if(null==a.__srcImageData){null==a.data?a.__srcImageData=a.__srcContext.getImageData(0,0,a.width,a.height):(a.__srcImageData=a.__srcContext.createImageData(a.width,a.height),a.__srcImageData.data.set(a.data));
var b=a.__srcImageData.data.buffer;b=null!=b?new Uint8Array(b):null;a.data=b}};rb.fillRect=function(a,b,c,e){rb.convertToCanvas(a);if(1==e){e=c>>16&255;var g=c>>8&255;var h=c&255;c=a.get_transparent()?c>>24&255:255}else e=c>>24&255,g=c>>16&255,h=c>>8&255,c=a.get_transparent()?c&255:255;0==b.x&&0==b.y&&b.width==a.width&&b.height==a.height&&a.get_transparent()&&0==c?a.buffer.__srcCanvas.width=a.buffer.width:(255>c&&a.buffer.__srcContext.clearRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+
a.offsetY),0<c&&(a.buffer.__srcContext.fillStyle="rgba("+e+", "+g+", "+h+", "+c/255+")",a.buffer.__srcContext.fillRect(b.x+a.offsetX,b.y+a.offsetY,b.width+a.offsetX,b.height+a.offsetY)),a.dirty=!0,a.version++)};var df=function(){};d["lime._internal.graphics.ImageDataUtil"]=df;df.__name__=!0;df.fillRect=function(a,b,c,e){switch(e){case 1:c=(c>>>16&255)<<24|(c>>>8&255)<<16|(c&255)<<8|c>>>24&255;break;case 2:c=(c>>>8&255)<<24|(c>>>16&255)<<16|(c>>>24&255)<<8|c&255}a.get_transparent()||(c=(c>>>24&255)<<
24|(c>>>16&255)<<16|(c>>>8&255)<<8|255);var g=a.buffer.data;if(null!=g){e=a.buffer.format;var h=a.buffer.premultiplied;h&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&(Qb.a16=Qb.__alpha16[c&255],c=((c>>>24&255)*Qb.a16>>16&255)<<24|((c>>>16&255)*Qb.a16>>16&255)<<16|((c>>>8&255)*Qb.a16>>16&255)<<8|c&255));b=new Ce(a,b);for(var d,k=0,f=b.height;k<f;){h=k++;d=b.byteOffset+b.stride*h;for(var l=0,n=b.width;l<n;){h=l++;var r=d+4*h,C=e;h=!1;null==h&&(h=!1);null==C&&(C=0);h&&(0==(c&255)?0!=c&&(c=0):255!=(c&255)&&
(Qb.a16=Qb.__alpha16[c&255],c=((c>>>24&255)*Qb.a16>>16&255)<<24|((c>>>16&255)*Qb.a16>>16&255)<<16|((c>>>8&255)*Qb.a16>>16&255)<<8|c&255));switch(C){case 0:g[r]=c>>>24&255;g[r+1]=c>>>16&255;g[r+2]=c>>>8&255;g[r+3]=c&255;break;case 1:g[r]=c&255;g[r+1]=c>>>24&255;g[r+2]=c>>>16&255;g[r+3]=c>>>8&255;break;case 2:g[r]=c>>>8&255,g[r+1]=c>>>16&255,g[r+2]=c>>>24&255,g[r+3]=c&255}}}a.dirty=!0;a.version++}};var Ce=function(a,b){this.image=a;null==b?this.rect=a.get_rect():(0>b.x&&(b.x=0),0>b.y&&(b.y=0),b.x+b.width>
a.width&&(b.width=a.width-b.x),b.y+b.height>a.height&&(b.height=a.height-b.y),0>b.width&&(b.width=0),0>b.height&&(b.height=0),this.rect=b);this.stride=a.buffer.get_stride();this.__update()};d["lime._internal.graphics._ImageDataUtil.ImageDataView"]=Ce;Ce.__name__=!0;Ce.prototype={__update:function(){this.x=Math.ceil(this.rect.x);this.y=Math.ceil(this.rect.y);this.width=Math.floor(this.rect.width);this.height=Math.floor(this.rect.height);this.byteOffset=this.stride*(this.y+this.image.offsetY)+4*(this.x+
this.image.offsetX)},__class__:Ce};var Ta=function(a,b){null==b&&(b=!1);if(null!=a)if(b)b=new wb,b.future=this,Gb.queue({promise:b,work:a});else try{this.value=a(),this.isComplete=!0}catch(c){ma.lastError=c,this.error=y.caught(c).unwrap(),this.isError=!0}};d["lime.app.Future"]=Ta;Ta.__name__=!0;Ta.withValue=function(a){var b=new Ta;b.isComplete=!0;b.value=a;return b};Ta.prototype={onComplete:function(a){null!=a&&(this.isComplete?a(this.value):this.isError||(null==this.__completeListeners&&(this.__completeListeners=
[]),this.__completeListeners.push(a)));return this},onError:function(a){null!=a&&(this.isError?a(this.error):this.isComplete||(null==this.__errorListeners&&(this.__errorListeners=[]),this.__errorListeners.push(a)));return this},onProgress:function(a){null!=a&&(null==this.__progressListeners&&(this.__progressListeners=[]),this.__progressListeners.push(a));return this},then:function(a){if(this.isComplete)return a(this.value);if(this.isError){var b=new Ta;b.isError=!0;b.error=this.error;return b}var c=
new wb;this.onError(p(c,c.error));this.onProgress(p(c,c.progress));this.onComplete(function(b){b=a(b);b.onError(p(c,c.error));b.onComplete(p(c,c.complete))});return c.future},__class__:Ta};var Gb=function(){};d["lime.app._Future.FutureWork"]=Gb;Gb.__name__=!0;Gb.queue=function(a){null==Gb.threadPool&&(Gb.threadPool=new De,Gb.threadPool.doWork.add(Gb.threadPool_doWork),Gb.threadPool.onComplete.add(Gb.threadPool_onComplete),Gb.threadPool.onError.add(Gb.threadPool_onError));Gb.threadPool.queue(a)};Gb.threadPool_doWork=
function(a){try{var b=a.work();Gb.threadPool.sendComplete({promise:a.promise,result:b})}catch(c){ma.lastError=c,b=y.caught(c).unwrap(),Gb.threadPool.sendError({promise:a.promise,error:b})}};Gb.threadPool_onComplete=function(a){a.promise.complete(a.result)};Gb.threadPool_onError=function(a){a.promise.error(a.error)};var wb=function(){this.future=new Ta};d["lime.app.Promise"]=wb;wb.__name__=!0;wb.prototype={complete:function(a){if(!this.future.isError&&(this.future.isComplete=!0,this.future.value=a,
null!=this.future.__completeListeners)){for(var b=0,c=this.future.__completeListeners;b<c.length;){var e=c[b];++b;e(a)}this.future.__completeListeners=null}return this},completeWith:function(a){a.onComplete(p(this,this.complete));a.onError(p(this,this.error));a.onProgress(p(this,this.progress));return this},error:function(a){if(!this.future.isComplete&&(this.future.isError=!0,this.future.error=a,null!=this.future.__errorListeners)){for(var b=0,c=this.future.__errorListeners;b<c.length;){var e=c[b];
++b;e(a)}this.future.__errorListeners=null}return this},progress:function(a,b){if(!this.future.isError&&!this.future.isComplete&&null!=this.future.__progressListeners)for(var c=0,e=this.future.__progressListeners;c<e.length;){var g=e[c];++c;g(a,b)}return this},__class__:wb};var Mc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Dynamic_Void"]=Mc;Mc.__name__=!0;Mc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<
g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&
(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Mc};var Ee=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Float_Void"]=Ee;Ee.__name__=!0;Ee.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=
this.__repeat,h=0;h<e.length&&(e[h](a,b,c),g[h]?++h:this.remove(e[h]),!this.canceled););},__class__:Ee};var Fe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_Int_Void"]=Fe;Fe.__name__=!0;Fe.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),g[h]?++h:this.remove(e[h]),!this.canceled););},__class__:Fe};var Wc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=
[]};d["lime.app._Event_Float_Float_Void"]=Wc;Wc.__name__=!0;Wc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,
1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:Wc};var Ge=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_lime_ui_MouseButton_Void"]=Ge;Ge.__name__=!0;Ge.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<
g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=this.__repeat,h=0;h<e.length&&
(e[h](a,b,c),g[h]?++h:this.remove(e[h]),!this.canceled););},__class__:Ge};var He=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Float_Float_lime_ui_MouseWheelMode_Void"]=He;He.__name__=!0;He.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b,c){this.canceled=!1;for(var e=this.__listeners,g=this.__repeat,h=0;h<e.length&&(e[h](a,b,c),g[h]?++h:this.remove(e[h]),!this.canceled););},__class__:He};var Ie=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=
[]};d["lime.app._Event_Int_Float_Float_Void"]=Ie;Ie.__name__=!0;Ie.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:Ie};var Je=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Float_Void"]=
Je;Je.__name__=!0;Je.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),
this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:Je};var Tc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Int_Void"]=Tc;Tc.__name__=!0;Tc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,
0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:Tc};
var cc=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_Void"]=cc;cc.__name__=!0;cc.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=
--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:cc};var Ke=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Int_lime_ui_JoystickHatPosition_Void"]=Ke;Ke.__name__=!0;Ke.prototype={add:function(a,b,
c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:Ke};var Le=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_String_Int_Int_Void"]=Le;Le.__name__=!0;Le.prototype={add:function(a,b,c){null==c&&
(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},__class__:Le};var Hd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_String_Void"]=Hd;Hd.__name__=!0;Hd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);
for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,
c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Hd};var fb=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_Void_Void"]=fb;fb.__name__=!0;fb.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);
this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(){this.canceled=!1;for(var a=this.__listeners,b=this.__repeat,c=0;c<a.length&&(a[c](),b[c]?++c:this.remove(a[c]),!this.canceled););},__class__:fb};var Id=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_graphics_RenderContext_Void"]=
Id;Id.__name__=!0;Id.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),
this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Id};var Me=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_GamepadAxis_Float_Void"]=Me;Me.__name__=!0;Me.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,
0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:Me};
var bd=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_GamepadButton_Void"]=bd;bd.__name__=!0;bd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=
this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:bd};var Ne=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Gamepad_Void"]=Ne;Ne.__name__=!0;Ne.prototype={add:function(a,
b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=
!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Ne};var Oe=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Joystick_Void"]=Oe;Oe.__name__=!0;Oe.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,
0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Oe};var vd=function(){this.canceled=!1;this.__listeners=[];
this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_KeyCode_lime_ui_KeyModifier_Void"]=vd;vd.__name__=!0;vd.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],
a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a,b){this.canceled=!1;for(var c=this.__listeners,e=this.__repeat,g=0;g<c.length&&(c[g](a,b),e[g]?++g:this.remove(c[g]),!this.canceled););},__class__:vd};var Ac=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Touch_Void"]=Ac;Ac.__name__=!0;Ac.prototype={add:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);for(var e=0,g=this.__priorities.length;e<
g;){var h=e++;if(c>this.__priorities[h]){this.__listeners.splice(h,0,a);this.__priorities.splice(h,0,c);this.__repeat.splice(h,0,!b);return}}this.__listeners.push(a);this.__priorities.push(c);this.__repeat.push(!b)},remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,e=0;e<b.length&&
(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:Ac};var ce=function(){this.canceled=!1;this.__listeners=[];this.__priorities=[];this.__repeat=[]};d["lime.app._Event_lime_ui_Window_Void"]=ce;ce.__name__=!0;ce.prototype={remove:function(a){for(var b=this.__listeners.length;0<=--b;)H.compareMethods(this.__listeners[b],a)&&(this.__listeners.splice(b,1),this.__priorities.splice(b,1),this.__repeat.splice(b,1))},dispatch:function(a){this.canceled=!1;for(var b=this.__listeners,c=this.__repeat,
e=0;e<b.length&&(b[e](a),c[e]?++e:this.remove(b[e]),!this.canceled););},__class__:ce};var Ka=function(a,b,c,e,g,h,d){null==g&&(g=-1);null==e&&(e=-1);null==c&&(c=0);null==b&&(b=0);this.offsetX=b;this.offsetY=c;this.width=e;this.height=g;this.version=0;null==d&&(d=rc.CANVAS);this.type=d;if(null==a){if(0<e&&0<g)switch(this.type._hx_index){case 0:this.buffer=new oc(null,e,g);rb.createCanvas(this,e,g);null!=h&&0!=h&&this.fillRect(new Xc(0,0,e,g),h);break;case 1:a=e*g*4,a=null!=a?new Uint8Array(a):null,
this.buffer=new oc(a,e,g),null!=h&&0!=h&&this.fillRect(new Xc(0,0,e,g),h)}}else this.__fromImageBuffer(a)};d["lime.graphics.Image"]=Ka;Ka.__name__=!0;Ka.fromFile=function(a){if(null==a)return null;var b=new Ka;return b.__fromFile(a)?b:null};Ka.loadFromBytes=function(a){if(null==a)return Ta.withValue(null);if(Ka.__isPNG(a))var b="image/png";else if(Ka.__isJPG(a))b="image/jpeg";else if(Ka.__isGIF(a))b="image/gif";else if(Ka.__isWebP(a))b="image/webp";else return Ta.withValue(null);return M.loadImageFromBytes(a,
b)};Ka.loadFromFile=function(a){return null==a?Ta.withValue(null):M.loadImage(a)};Ka.__isGIF=function(a){if(null==a||6>a.length)return!1;a=a.getString(0,6);return"GIF87a"!=a?"GIF89a"==a:!0};Ka.__isJPG=function(a){return null==a||4>a.length?!1:255==a.b[0]&&216==a.b[1]&&255==a.b[a.length-2]?217==a.b[a.length-1]:!1};Ka.__isPNG=function(a){return null==a||8>a.length?!1:137==a.b[0]&&80==a.b[1]&&78==a.b[2]&&71==a.b[3]&&13==a.b[4]&&10==a.b[5]&&26==a.b[6]?10==a.b[7]:!1};Ka.__isWebP=function(a){return null==
a||16>a.length?!1:"RIFF"==a.getString(0,4)?"WEBP"==a.getString(8,4):!1};Ka.prototype={fillRect:function(a,b,c){a=this.__clipRect(a);if(null!=this.buffer&&null!=a)switch(this.type._hx_index){case 0:rb.fillRect(this,a,b,c);break;case 1:rb.convertToData(this);if(0==this.buffer.data.length)break;df.fillRect(this,a,b,c);break;case 2:a.offset(this.offsetX,this.offsetY);if(null==c)b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255;else switch(c){case 1:break;case 2:b=(b&255)<<24|(b>>>8&255)<<16|(b>>>
16&255)<<8|b>>>24&255;break;default:b=(b&255)<<24|(b>>>24&255)<<16|(b>>>16&255)<<8|b>>>8&255}this.buffer.__srcBitmapData.fillRect(a.__toFlashRectangle(),b)}},__clipRect:function(a){return null==a||0>a.x&&(a.width-=-a.x,a.x=0,0>=a.x+a.width)||0>a.y&&(a.height-=-a.y,a.y=0,0>=a.y+a.height)||a.x+a.width>=this.width&&(a.width-=a.x+a.width-this.width,0>=a.width)||a.y+a.height>=this.height&&(a.height-=a.y+a.height-this.height,0>=a.height)?null:a},__fromBase64:function(a,b,c){var e=this,g=new Image;g.addEventListener("load",
function(a){e.buffer=new oc(null,g.width,g.height);e.buffer.__srcImage=g;e.offsetX=0;e.offsetY=0;e.width=e.buffer.width;e.height=e.buffer.height;null!=c&&c(e)},!1);g.src="data:"+b+";base64,"+a},__fromBytes:function(a,b){if(Ka.__isPNG(a))var c="image/png";else if(Ka.__isJPG(a))c="image/jpeg";else if(Ka.__isGIF(a))c="image/gif";else return!1;this.__fromBase64(Yb.encode(a),c,b);return!0},__fromFile:function(a,b,c){var e=this,g=new Image;M.__isSameOrigin(a)||(g.crossOrigin="Anonymous");g.onload=function(a){e.buffer=
new oc(null,g.width,g.height);e.buffer.__srcImage=g;e.width=g.width;e.height=g.height;null!=b&&b(e)};g.onerror=function(a){null!=c&&c()};g.src=a;return!0},__fromImageBuffer:function(a){this.buffer=a;null!=a&&(-1==this.width&&(this.width=a.width),-1==this.height&&(this.height=a.height))},get_data:function(){null==this.buffer.data&&0<this.buffer.width&&0<this.buffer.height&&rb.convertToData(this);return this.buffer.data},get_rect:function(){return new Xc(0,0,this.width,this.height)},get_transparent:function(){return null==
this.buffer?!1:this.buffer.transparent},set_transparent:function(a){return null==this.buffer?!1:this.buffer.transparent=a},__class__:Ka,__properties__:{set_transparent:"set_transparent",get_transparent:"get_transparent",get_rect:"get_rect",get_data:"get_data"}};var oc=function(a,b,c,e,g){null==e&&(e=32);null==c&&(c=0);null==b&&(b=0);this.data=a;this.width=b;this.height=c;this.bitsPerPixel=e;this.format=null==g?0:g;this.premultiplied=!1;this.transparent=!0};d["lime.graphics.ImageBuffer"]=oc;oc.__name__=
!0;oc.prototype={get_stride:function(){return this.width*(this.bitsPerPixel/8|0)},__class__:oc,__properties__:{get_stride:"get_stride"}};var rc=v["lime.graphics.ImageType"]={__ename__:!0,__constructs__:null,CANVAS:{_hx_name:"CANVAS",_hx_index:0,__enum__:"lime.graphics.ImageType",toString:n},DATA:{_hx_name:"DATA",_hx_index:1,__enum__:"lime.graphics.ImageType",toString:n},FLASH:{_hx_name:"FLASH",_hx_index:2,__enum__:"lime.graphics.ImageType",toString:n},CUSTOM:{_hx_name:"CUSTOM",_hx_index:3,__enum__:"lime.graphics.ImageType",
toString:n}};rc.__constructs__=[rc.CANVAS,rc.DATA,rc.FLASH,rc.CUSTOM];var Be=function(){};d["lime.graphics.RenderContext"]=Be;Be.__name__=!0;Be.prototype={__class__:Be};var uf={fromWebGL2RenderContext:function(a){return a}},ud=function(){};d["lime.graphics.opengl.GL"]=ud;ud.__name__=!0;var Qb={},Xc=function(a,b,c,e){null==e&&(e=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.width=c;this.height=e};d["lime.math.Rectangle"]=Xc;Xc.__name__=!0;Xc.prototype={offset:function(a,b){this.x+=
a;this.y+=b},__toFlashRectangle:function(){return null},__class__:Xc};var Ra=function(){};d["lime.media.AudioBuffer"]=Ra;Ra.__name__=!0;Ra.fromBytes=function(a){if(null==a)return null;var b=new Ra;b.set_src(new Howl({src:["data:"+Ra.__getCodec(a)+";base64,"+Yb.encode(a)],html5:!0,preload:!1}));return b};Ra.fromFile=function(a){if(null==a)return null;var b=new Ra;b.__srcHowl=new Howl({src:[a],preload:!1});return b};Ra.fromFiles=function(a){var b=new Ra;b.__srcHowl=new Howl({src:a,preload:!1});return b};
Ra.loadFromFile=function(a){var b=new wb,c=Ra.fromFile(a);null!=c?null!=c&&(c.__srcHowl.on("load",function(){b.complete(c)}),c.__srcHowl.on("loaderror",function(a,c){b.error(c)}),c.__srcHowl.load()):b.error(null);return b.future};Ra.loadFromFiles=function(a){var b=new wb,c=Ra.fromFiles(a);null!=c?(c.__srcHowl.on("load",function(){b.complete(c)}),c.__srcHowl.on("loaderror",function(){b.error(null)}),c.__srcHowl.load()):b.error(null);return b.future};Ra.__getCodec=function(a){switch(a.getString(0,4)){case "OggS":return"audio/ogg";
case "RIFF":if("WAVE"==a.getString(8,4))return"audio/wav";var b=a.b[1],c=a.b[2];switch(a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}break;case "fLaC":return"audio/flac";default:switch(b=a.b[1],c=a.b[2],a.b[0]){case 73:if(68==b&&51==c)return"audio/mp3";break;case 255:switch(b){case 243:case 250:case 251:return"audio/mp3"}}}Aa.error("Unsupported sound format",{fileName:"lime/media/AudioBuffer.hx",lineNumber:362,className:"lime.media.AudioBuffer",
methodName:"__getCodec"});return null};Ra.prototype={set_src:function(a){return this.__srcHowl=a},__class__:Ra,__properties__:{set_src:"set_src"}};var Qe=function(a){if("custom"!=a){if(null==a||"web"==a)try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.web=new window.AudioContext,this.type="web"}catch(b){ma.lastError=b}null==this.web&&"web"!=a&&(this.html5=new Pe,this.type="html5")}else this.type="custom"};d["lime.media.AudioContext"]=Qe;Qe.__name__=!0;Qe.prototype={__class__:Qe};
var Fc=function(){};d["lime.media.AudioManager"]=Fc;Fc.__name__=!0;Fc.init=function(a){if(null==Fc.context){if(null==a&&(Fc.context=new Qe,a=Fc.context,"openal"==a.type)){var b=a.openal,c=b.openDevice();c=b.createContext(c);b.makeContextCurrent(c);b.processContext(c)}Fc.context=a}};var Pe=function(){};d["lime.media.HTML5AudioContext"]=Pe;Pe.__name__=!0;Pe.prototype={__class__:Pe};var ef=function(){};d["lime.media.OpenALAudioContext"]=ef;ef.__name__=!0;ef.prototype={createContext:function(a,b){return sc.createContext(a,
b)},makeContextCurrent:function(a){return sc.makeContextCurrent(a)},openDevice:function(a){return sc.openDevice(a)},processContext:function(a){sc.processContext(a)},__class__:ef};var sc=function(){};d["lime.media.openal.ALC"]=sc;sc.__name__=!0;sc.createContext=function(a,b){return null};sc.makeContextCurrent=function(a){return!1};sc.openDevice=function(a){return null};sc.processContext=function(a){};var wd=function(){};d["lime.net._IHTTPRequest"]=wd;wd.__name__=!0;wd.__isInterface__=!0;wd.prototype=
{__class__:wd};var hc=function(a){this.uri=a;this.contentType="application/x-www-form-urlencoded";this.followRedirects=!0;this.enableResponseHeaders=!1;this.formData=new aa;this.headers=[];this.method="GET";this.timeout=3E4;this.withCredentials=!1;this.__backend=new M;this.__backend.init(this)};d["lime.net._HTTPRequest.AbstractHTTPRequest"]=hc;hc.__name__=!0;hc.__interfaces__=[wd];hc.prototype={__class__:hc};var Bc=function(a){hc.call(this,a)};d["lime.net._HTTPRequest_Bytes"]=Bc;Bc.__name__=!0;Bc.__super__=
hc;Bc.prototype=F(hc.prototype,{fromBytes:function(a){return a},load:function(a){var b=this;null!=a&&(this.uri=a);var c=new wb;a=this.__backend.loadData(this.uri);a.onProgress(p(c,c.progress));a.onError(p(c,c.error));a.onComplete(function(a){b.responseData=b.fromBytes(a);c.complete(b.responseData)});return c.future},__class__:Bc});var xd=function(a){hc.call(this,a)};d["lime.net._HTTPRequest_String"]=xd;xd.__name__=!0;xd.__super__=hc;xd.prototype=F(hc.prototype,{load:function(a){var b=this;null!=a&&
(this.uri=a);var c=new wb;a=this.__backend.loadText(this.uri);a.onProgress(p(c,c.progress));a.onError(p(c,c.error));a.onComplete(function(a){b.responseData=a;c.complete(b.responseData)});return c.future},__class__:xd});var Ae=function(a,b){null==b&&(b="");this.name=a;this.value=b};d["lime.net.HTTPRequestHeader"]=Ae;Ae.__name__=!0;Ae.prototype={__class__:Ae};var yd=function(a){hc.call(this,a)};d["lime.net._HTTPRequest_lime_utils_Bytes"]=yd;yd.__name__=!0;yd.__super__=Bc;yd.prototype=F(Bc.prototype,
{fromBytes:function(a){return lc.fromBytes(a)},__class__:yd});var Tb=function(a,b){this.onUpdate=new Ee;this.type=a;this.id=b};d["lime.system.Sensor"]=Tb;Tb.__name__=!0;Tb.registerSensor=function(a,b){a=new Tb(a,b);Tb.sensors.push(a);return Tb.sensorByID.h[b]=a};Tb.prototype={__class__:Tb};var jf=v["lime.system.SensorType"]={__ename__:!0,__constructs__:null,ACCELEROMETER:{_hx_name:"ACCELEROMETER",_hx_index:0,__enum__:"lime.system.SensorType",toString:n}};jf.__constructs__=[jf.ACCELEROMETER];var Zb=
function(){};d["lime.system.System"]=Zb;Zb.__name__=!0;Zb.embed=m.lime.embed=function(a,b,c,e,g){if(null!=Zb.__applicationEntryPoint&&Object.prototype.hasOwnProperty.call(Zb.__applicationEntryPoint.h,a)){var h="string"==typeof b?window.document.getElementById(b):null==b?window.document.createElement("div"):b;null==h?window.console.log("[lime.embed] ERROR: Cannot find target element: "+w.string(b)):(null==c&&(c=0),null==e&&(e=0),null==g&&(g={}),Object.prototype.hasOwnProperty.call(g,"background")&&
"string"==typeof g.background&&(b=W.replace(w.string(g.background),"#",""),-1<b.indexOf("0x")?g.background=w.parseInt(b):g.background=w.parseInt("0x"+b)),g.element=h,g.width=c,g.height=e,Zb.__applicationEntryPoint.h[a](g))}};Zb.exit=function(a){};Zb.__registerEntryPoint=function(a,b){null==Zb.__applicationEntryPoint&&(Zb.__applicationEntryPoint=new aa);Zb.__applicationEntryPoint.h[a]=b};var De=function(a,b){null==b&&(b=1);null==a&&(a=0);this.onRun=new Mc;this.onError=new Mc;this.onComplete=new Mc;
this.doWork=new Mc;this.minThreads=a;this.maxThreads=b;this.currentThreads=0};d["lime.system.ThreadPool"]=De;De.__name__=!0;De.prototype={queue:function(a){this.runWork(a)},sendComplete:function(a){this.onComplete.dispatch(a)},sendError:function(a){this.onError.dispatch(a)},runWork:function(a){this.onRun.dispatch(a);this.doWork.dispatch(a)},__class__:De};var Rb=function(a){null!=a&&(this.name=a);this.__init||(void 0==this.ascender&&(this.ascender=0),void 0==this.descender&&(this.descender=0),void 0==
this.height&&(this.height=0),void 0==this.numGlyphs&&(this.numGlyphs=0),void 0==this.underlinePosition&&(this.underlinePosition=0),void 0==this.underlineThickness&&(this.underlineThickness=0),void 0==this.unitsPerEM&&(this.unitsPerEM=0),null!=this.__fontID?X.isLocal(this.__fontID)&&this.__fromBytes(X.getBytes(this.__fontID)):null!=this.__fontPath&&this.__fromFile(this.__fontPath))};d["lime.text.Font"]=Rb;Rb.__name__=!0;Rb.fromFile=function(a){if(null==a)return null;var b=new Rb;b.__fromFile(a);return b};
Rb.loadFromName=function(a){return(new Rb).__loadFromName(a)};Rb.__measureFontNode=function(a){var b=window.document.createElement("span");b.setAttribute("aria-hidden","true");var c=window.document.createTextNode("BESbswy");b.appendChild(c);c=b.style;c.display="block";c.position="absolute";c.top="-9999px";c.left="-9999px";c.fontSize="300px";c.width="auto";c.height="auto";c.lineHeight="normal";c.margin="0";c.padding="0";c.fontVariant="normal";c.whiteSpace="nowrap";c.fontFamily=a;window.document.body.appendChild(b);
return b};Rb.prototype={__fromBytes:function(a){this.__fontPath=null},__fromFile:function(a){this.__fontPath=a},__loadFromName:function(a){var b=this,c=new wb;this.name=a;var e=t.navigator.userAgent.toLowerCase(),g=0<=e.indexOf(" safari/")&&0>e.indexOf(" chrome/");e=(new D("(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)","i")).match(e);if(!g&&!e&&window.document.fonts&&(f=window.document.fonts,p(f,f.load)))window.document.fonts.load("1em '"+a+"'").then(function(a){c.complete(b)},function(e){Aa.warn('Could not load web font "'+
a+'"',{fileName:"lime/text/Font.hx",lineNumber:513,className:"lime.text.Font",methodName:"__loadFromName"});c.complete(b)});else{var h=Rb.__measureFontNode("'"+a+"', sans-serif"),d=Rb.__measureFontNode("'"+a+"', serif"),k=h.offsetWidth,l=d.offsetWidth,n=-1,C=0,r,q;n=window.setInterval(function(){C+=1;r=h.offsetWidth!=k||d.offsetWidth!=l;q=3E3<=50*C;if(r||q)window.clearInterval(n),h.parentNode.removeChild(h),d.parentNode.removeChild(d),d=h=null,q&&Aa.warn('Could not load web font "'+a+'"',{fileName:"lime/text/Font.hx",
lineNumber:548,className:"lime.text.Font",methodName:"__loadFromName"}),c.complete(b)},50)}return c.future},__class__:Rb};var db=function(a){this.onDisconnect=new fb;this.onButtonUp=new bd;this.onButtonDown=new bd;this.onAxisMove=new Me;this.id=a;this.connected=!0};d["lime.ui.Gamepad"]=db;db.__name__=!0;db.__connect=function(a){if(!db.devices.h.hasOwnProperty(a)){var b=new db(a);db.devices.h[a]=b;db.onConnect.dispatch(b)}};db.__disconnect=function(a){var b=db.devices.h[a];null!=b&&(b.connected=!1);
db.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};db.prototype={__class__:db};var mb=function(a){this.onTrackballMove=new Ie;this.onHatMove=new Ke;this.onDisconnect=new fb;this.onButtonUp=new cc;this.onButtonDown=new cc;this.onAxisMove=new Je;this.id=a;this.connected=!0};d["lime.ui.Joystick"]=mb;mb.__name__=!0;mb.__connect=function(a){if(!mb.devices.h.hasOwnProperty(a)){var b=new mb(a);mb.devices.h[a]=b;mb.onConnect.dispatch(b)}};mb.__disconnect=function(a){var b=mb.devices.h[a];null!=b&&(b.connected=
!1);mb.devices.remove(a);null!=b&&b.onDisconnect.dispatch()};mb.__getDeviceData=function(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():null};mb.prototype={__class__:mb};var Pb=v["lime.ui.MouseCursor"]={__ename__:!0,__constructs__:null,ARROW:{_hx_name:"ARROW",_hx_index:0,__enum__:"lime.ui.MouseCursor",toString:n},CROSSHAIR:{_hx_name:"CROSSHAIR",_hx_index:1,__enum__:"lime.ui.MouseCursor",toString:n},DEFAULT:{_hx_name:"DEFAULT",_hx_index:2,
__enum__:"lime.ui.MouseCursor",toString:n},MOVE:{_hx_name:"MOVE",_hx_index:3,__enum__:"lime.ui.MouseCursor",toString:n},POINTER:{_hx_name:"POINTER",_hx_index:4,__enum__:"lime.ui.MouseCursor",toString:n},RESIZE_NESW:{_hx_name:"RESIZE_NESW",_hx_index:5,__enum__:"lime.ui.MouseCursor",toString:n},RESIZE_NS:{_hx_name:"RESIZE_NS",_hx_index:6,__enum__:"lime.ui.MouseCursor",toString:n},RESIZE_NWSE:{_hx_name:"RESIZE_NWSE",_hx_index:7,__enum__:"lime.ui.MouseCursor",toString:n},RESIZE_WE:{_hx_name:"RESIZE_WE",
_hx_index:8,__enum__:"lime.ui.MouseCursor",toString:n},TEXT:{_hx_name:"TEXT",_hx_index:9,__enum__:"lime.ui.MouseCursor",toString:n},WAIT:{_hx_name:"WAIT",_hx_index:10,__enum__:"lime.ui.MouseCursor",toString:n},WAIT_ARROW:{_hx_name:"WAIT_ARROW",_hx_index:11,__enum__:"lime.ui.MouseCursor",toString:n},CUSTOM:{_hx_name:"CUSTOM",_hx_index:12,__enum__:"lime.ui.MouseCursor",toString:n}};Pb.__constructs__=[Pb.ARROW,Pb.CROSSHAIR,Pb.DEFAULT,Pb.MOVE,Pb.POINTER,Pb.RESIZE_NESW,Pb.RESIZE_NS,Pb.RESIZE_NWSE,Pb.RESIZE_WE,
Pb.TEXT,Pb.WAIT,Pb.WAIT_ARROW,Pb.CUSTOM];var kc=v["lime.ui.MouseWheelMode"]={__ename__:!0,__constructs__:null,PIXELS:{_hx_name:"PIXELS",_hx_index:0,__enum__:"lime.ui.MouseWheelMode",toString:n},LINES:{_hx_name:"LINES",_hx_index:1,__enum__:"lime.ui.MouseWheelMode",toString:n},PAGES:{_hx_name:"PAGES",_hx_index:2,__enum__:"lime.ui.MouseWheelMode",toString:n},UNKNOWN:{_hx_name:"UNKNOWN",_hx_index:3,__enum__:"lime.ui.MouseWheelMode",toString:n}};kc.__constructs__=[kc.PIXELS,kc.LINES,kc.PAGES,kc.UNKNOWN];
var Ab=function(a,b,c,e,g,h,d){this.x=a;this.y=b;this.id=c;this.dx=e;this.dy=g;this.pressure=h;this.device=d};d["lime.ui.Touch"]=Ab;Ab.__name__=!0;Ab.prototype={__class__:Ab};var ee=function(a,b){this.onTextInput=new Hd;this.onTextEdit=new Le;this.onRestore=new fb;this.onResize=new Tc;this.onRenderContextRestored=new Id;this.onRenderContextLost=new fb;this.onRender=new Id;this.onMove=new Wc;this.onMouseWheel=new He;this.onMouseUp=new Fe;this.onMouseMoveRelative=new Wc;this.onMouseMove=new Wc;this.onMouseDown=
new Ge;this.onMinimize=new fb;this.onLeave=new fb;this.onKeyUp=new vd;this.onKeyDown=new vd;this.onFullscreen=new fb;this.onFocusOut=new fb;this.onFocusIn=new fb;this.onExpose=new fb;this.onEnter=new fb;this.onDropFile=new Hd;this.onDeactivate=new fb;this.onClose=new fb;this.onActivate=new fb;this.application=a;this.__attributes=null!=b?b:{};Object.prototype.hasOwnProperty.call(this.__attributes,"parameters")&&(this.parameters=this.__attributes.parameters);this.__height=this.__width=0;this.__fullscreen=
!1;this.__scale=1;this.__y=this.__x=0;this.__title="";this.id=-1;this.__backend=new td(this)};d["lime.ui.Window"]=ee;ee.__name__=!0;ee.prototype={close:function(){this.__backend.close()},__class__:ee};var Eb=function(){this.data=new aa;this.paths=[]};d["lime.utils.AssetBundle"]=Eb;Eb.__name__=!0;Eb.fromBytes=function(a){a=new Gd(a);return Eb.__extractBundle(a)};Eb.loadFromBytes=function(a){return Ta.withValue(Eb.fromBytes(a))};Eb.loadFromFile=function(a){return lc.loadFromFile(a).then(Eb.loadFromBytes)};
Eb.__extractBundle=function(a){var b=sd.readZip(a);a=new Eb;for(b=b.h;null!=b;){var c=b.item;b=b.next;if(c.compressed){var e=a.data,g=c.fileName,h=lc.decompress(c.data,Kd.DEFLATE);e.h[g]=h}else a.data.h[c.fileName]=c.data;a.paths.push(c.fileName)}return a};Eb.prototype={__class__:Eb};var Re=function(){this.enabled=!0;this.audio=new aa;this.font=new aa;this.image=new aa;this.version=80740};d["lime.utils.AssetCache"]=Re;Re.__name__=!0;Re.prototype={exists:function(a,b){return("IMAGE"==b||null==b)&&
Object.prototype.hasOwnProperty.call(this.image.h,a)||("FONT"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.font.h,a)||("SOUND"==b||"MUSIC"==b||null==b)&&Object.prototype.hasOwnProperty.call(this.audio.h,a)?!0:!1},set:function(a,b,c){switch(b){case "FONT":this.font.h[a]=c;break;case "IMAGE":if(!(c instanceof Ka))throw y.thrown("Cannot cache non-Image asset: "+w.string(c)+" as Image");this.image.h[a]=c;break;case "MUSIC":case "SOUND":if(!(c instanceof Ra))throw y.thrown("Cannot cache non-AudioBuffer asset: "+
w.string(c)+" as AudioBuffer");this.audio.h[a]=c;break;default:throw y.thrown(b+" assets are not cachable");}},clear:function(a){if(null==a)this.audio=new aa,this.font=new aa,this.image=new aa;else{var b=this.audio.h;b=Object.keys(b);for(var c=b.length,e=0;e<c;){var g=b[e++];if(W.startsWith(g,a)){var h=this.audio;Object.prototype.hasOwnProperty.call(h.h,g)&&delete h.h[g]}}b=this.font.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)g=b[e++],W.startsWith(g,a)&&(h=this.font,Object.prototype.hasOwnProperty.call(h.h,
g)&&delete h.h[g]);b=this.image.h;b=Object.keys(b);c=b.length;for(e=0;e<c;)g=b[e++],W.startsWith(g,a)&&(h=this.image,Object.prototype.hasOwnProperty.call(h.h,g)&&delete h.h[g])}},__class__:Re};var Kb=function(){this.types=new aa;this.sizes=new aa;this.preload=new aa;this.paths=new aa;this.pathGroups=new aa;this.classTypes=new aa;this.cachedText=new aa;this.cachedImages=new aa;this.cachedFonts=new aa;this.cachedBytes=new aa;this.cachedAudioBuffers=new aa;this.onChange=new fb;this.bytesTotal=this.bytesLoaded=
0};d["lime.utils.AssetLibrary"]=Kb;Kb.__name__=!0;Kb.fromBundle=function(a){if(Object.prototype.hasOwnProperty.call(a.data.h,"library.json")){var b=Bb.fromBytes(a.data.h["library.json"]);if(null!=b){if(null==b.libraryType)var c=new Kb;else if(c=d[b.libraryType],null!=c)c=ja.createInstance(c,b.libraryArgs);else return Aa.warn("Could not find library type: "+b.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:122,className:"lime.utils.AssetLibrary",methodName:"fromBundle"}),null;c.__fromBundle(a,
b);return c}}else return c=new Kb,c.__fromBundle(a),c;return null};Kb.fromManifest=function(a){if(null==a)return null;if(null==a.libraryType)var b=new Kb;else if(b=d[a.libraryType],null!=b)b=ja.createInstance(b,a.libraryArgs);else return Aa.warn("Could not find library type: "+a.libraryType,{fileName:"lime/utils/AssetLibrary.hx",lineNumber:160,className:"lime.utils.AssetLibrary",methodName:"fromManifest"}),null;b.__fromManifest(a);return b};Kb.prototype={exists:function(a,b){b=null!=b?sa.__cast(b,
String):null;a=this.types.h[a];return null==a||a!=b&&("SOUND"!=b&&"MUSIC"!=b||"MUSIC"!=a&&"SOUND"!=a)&&"BINARY"!=b&&null!=b&&("BINARY"!=a||"TEXT"!=b)?!1:!0},getAsset:function(a,b){switch(b){case "BINARY":return this.getBytes(a);case "FONT":return this.getFont(a);case "IMAGE":return this.getImage(a);case "MUSIC":case "SOUND":return this.getAudioBuffer(a);case "TEMPLATE":throw y.thrown("Not sure how to get template: "+a);case "TEXT":return this.getText(a);default:throw y.thrown("Unknown asset type: "+
b);}},getAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?this.cachedAudioBuffers.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ra.fromBytes(sa.__cast(ja.createInstance(this.classTypes.h[a],[]),Ja)):Ra.fromFile(this.paths.h[a])},getBytes:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a))return this.cachedBytes.h[a];if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a)){var b=lc.ofString(this.cachedText.h[a]);
return this.cachedBytes.h[a]=b}return Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?sa.__cast(ja.createInstance(this.classTypes.h[a],[]),Ja):lc.fromFile(this.paths.h[a])},getFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?this.cachedFonts.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?sa.__cast(ja.createInstance(this.classTypes.h[a],[]),Rb):Rb.fromFile(this.paths.h[a])},getImage:function(a){return Object.prototype.hasOwnProperty.call(this.cachedImages.h,
a)?this.cachedImages.h[a]:Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?sa.__cast(ja.createInstance(this.classTypes.h[a],[]),Ka):Ka.fromFile(this.paths.h[a])},getText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return this.cachedText.h[a];a=this.getBytes(a);return null==a?null:a.getString(0,a.length)},isLocal:function(a,b){if(Object.prototype.hasOwnProperty.call(this.classTypes.h,a))return!0;b=null!=b?sa.__cast(b,String):null;if(null==b)return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,
a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a);switch(b){case "FONT":return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a);case "IMAGE":return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a);case "MUSIC":case "SOUND":return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a);default:return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?!0:Object.prototype.hasOwnProperty.call(this.cachedText.h,a)}},load:function(){if(this.loaded)return Ta.withValue(this);
if(null==this.promise){this.promise=new wb;this.bytesLoadedCache=new aa;this.assetsLoaded=0;this.assetsTotal=1;for(var a=Object.keys(this.preload.h),b=a.length,c=0;c<b;){var e=a[c++];if(this.preload.h[e]){Aa.verbose("Preloading asset: "+e+" ["+this.types.h[e]+"]",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:405,className:"lime.utils.AssetLibrary",methodName:"load"});var g=this.types.h[e];if(null!=g)switch(g){case "BINARY":this.assetsTotal++;g=this.loadBytes(e);g.onProgress(function(a,b){return function(c,
e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.load_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadBytes_onComplete)]));break;case "FONT":this.assetsTotal++;g=this.loadFont(e);g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.load_onError)]));
g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadFont_onComplete)]));break;case "IMAGE":this.assetsTotal++;g=this.loadImage(e);g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.load_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadImage_onComplete)]));break;case "MUSIC":case "SOUND":this.assetsTotal++;
g=this.loadAudioBuffer(e);g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)]));g.onError(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadAudioBuffer_onError)]));g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadAudioBuffer_onComplete)]));break;case "TEXT":this.assetsTotal++,g=this.loadText(e),g.onProgress(function(a,b){return function(c,e){b[0](a[0],c,e)}}([e],[p(this,this.load_onProgress)])),g.onError(function(a,
b){return function(c){b[0](a[0],c)}}([e],[p(this,this.load_onError)])),g.onComplete(function(a,b){return function(c){b[0](a[0],c)}}([e],[p(this,this.loadText_onComplete)]))}}}this.__assetLoaded(null)}return this.promise.future},loadAudioBuffer:function(a){return Object.prototype.hasOwnProperty.call(this.cachedAudioBuffers.h,a)?Ta.withValue(this.cachedAudioBuffers.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ta.withValue(ja.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.pathGroups.h,
a)?Ra.loadFromFiles(this.pathGroups.h[a]):Ra.loadFromFile(this.paths.h[a])},loadBytes:function(a){return Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ta.withValue(this.cachedBytes.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ta.withValue(ja.createInstance(this.classTypes.h[a],[])):lc.loadFromFile(this.paths.h[a])},loadFont:function(a){return Object.prototype.hasOwnProperty.call(this.cachedFonts.h,a)?Ta.withValue(this.cachedFonts.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,
a)?(a=ja.createInstance(this.classTypes.h[a],[]),a.__loadFromName(a.name)):Rb.loadFromName(this.paths.h[a])},loadImage:function(a){var b=this;return Object.prototype.hasOwnProperty.call(this.cachedImages.h,a)?Ta.withValue(this.cachedImages.h[a]):Object.prototype.hasOwnProperty.call(this.classTypes.h,a)?Ta.withValue(ja.createInstance(this.classTypes.h[a],[])):Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)?Ka.loadFromBytes(this.cachedBytes.h[a]).then(function(c){var e=b.cachedBytes;Object.prototype.hasOwnProperty.call(e.h,
a)&&delete e.h[a];b.cachedImages.h[a]=c;return Ta.withValue(c)}):Ka.loadFromFile(this.paths.h[a])},loadText:function(a){if(Object.prototype.hasOwnProperty.call(this.cachedText.h,a))return Ta.withValue(this.cachedText.h[a]);if(Object.prototype.hasOwnProperty.call(this.cachedBytes.h,a)||Object.prototype.hasOwnProperty.call(this.classTypes.h,a)){var b=this.getBytes(a);if(null==b)return Ta.withValue(null);b=b.getString(0,b.length);this.cachedText.h[a]=b;return Ta.withValue(b)}return(new xd).load(this.paths.h[a])},
unload:function(){},__assetLoaded:function(a){this.assetsLoaded++;null!=a&&Aa.verbose("Loaded asset: "+a+" ["+this.types.h[a]+"] ("+(this.assetsLoaded-1)+"/"+(this.assetsTotal-1)+")",{fileName:"lime/utils/AssetLibrary.hx",lineNumber:619,className:"lime.utils.AssetLibrary",methodName:"__assetLoaded"});if(null!=a){var b=Object.prototype.hasOwnProperty.call(this.sizes.h,a)?this.sizes.h[a]:0;if(Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)){var c=this.bytesLoadedCache.h[a];c<b&&(this.bytesLoaded+=
b-c)}else this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b}this.assetsLoaded<this.assetsTotal?this.promise.progress(this.bytesLoaded,this.bytesTotal):(this.loaded=!0,this.promise.progress(this.bytesTotal,this.bytesTotal),this.promise.complete(this))},__cacheBreak:function(a){return X.__cacheBreak(a)},__fromBundle:function(a,b){if(null!=b){var c=0;for(b=b.assets;c<b.length;){var e=b[c];++c;var g=Object.prototype.hasOwnProperty.call(e,"id")?e.id:e.path;var h=a.data.h[e.path];if(Object.prototype.hasOwnProperty.call(e,
"type")){var d=e.type;"TEXT"==d?this.cachedText.h[g]=null!=h?w.string(h):null:this.cachedBytes.h[g]=h;this.types.h[g]=e.type}else this.cachedBytes.h[g]=h,this.types.h[g]="BINARY"}}else for(c=0,b=a.paths;c<b.length;)g=b[c],++c,this.cachedBytes.h[g]=a.data.h[g],this.types.h[g]="BINARY"},__fromManifest:function(a){var b=2<=a.version,c=a.rootPath;null==c&&(c="");""!=c&&(c+="/");for(var e=0,g=a.assets;e<g.length;){var h=g[e];++e;var f=b&&Object.prototype.hasOwnProperty.call(h,"size")?h.size:100;var k=
Object.prototype.hasOwnProperty.call(h,"id")?h.id:h.path;if(Object.prototype.hasOwnProperty.call(h,"path")){var l=this.paths;var n=this.__cacheBreak(this.__resolvePath(c+w.string(H.field(h,"path"))));l.h[k]=n}if(Object.prototype.hasOwnProperty.call(h,"pathGroup")){l=H.field(h,"pathGroup");n=0;for(var C=l.length;n<C;){var r=n++;l[r]=this.__cacheBreak(this.__resolvePath(c+l[r]))}this.pathGroups.h[k]=l}this.sizes.h[k]=f;this.types.h[k]=h.type;Object.prototype.hasOwnProperty.call(h,"preload")&&(this.preload.h[k]=
H.field(h,"preload"));Object.prototype.hasOwnProperty.call(h,"className")&&(f=H.field(h,"className"),f=d[f],this.classTypes.h[k]=f)}e=this.bytesTotal=0;for(g=a.assets;e<g.length;)h=g[e],++e,k=Object.prototype.hasOwnProperty.call(h,"id")?h.id:h.path,Object.prototype.hasOwnProperty.call(this.preload.h,k)&&this.preload.h[k]&&Object.prototype.hasOwnProperty.call(this.sizes.h,k)&&(this.bytesTotal+=this.sizes.h[k])},__resolvePath:function(a){a=W.replace(a,"\\","/");var b=a.indexOf(":");W.startsWith(a,"http")&&
0<b?(b+=3,a=J.substr(a,0,b)+W.replace(J.substr(a,b,null),"//","/")):a=W.replace(a,"//","/");if(-1<a.indexOf("./")){a=a.split("/");b=[];for(var c=0,e=a.length;c<e;){var g=c++;".."==a[g]?0==g||".."==b[g-1]?b.push(".."):b.pop():"."==a[g]?0==g&&b.push("."):b.push(a[g])}a=b.join("/")}return a},loadAudioBuffer_onComplete:function(a,b){this.cachedAudioBuffers.h[a]=b;if(Object.prototype.hasOwnProperty.call(this.pathGroups.h,a))for(var c=this.pathGroups.h[a],e=Object.keys(this.pathGroups.h),g=e.length,h=0;h<
g;){var d=e[h++];if(d!=a)for(var k=0;k<c.length;){var f=c[k];++k;if(-1<this.pathGroups.h[d].indexOf(f)){this.cachedAudioBuffers.h[d]=b;break}}}this.__assetLoaded(a)},loadAudioBuffer_onError:function(a,b){null!=b&&""!=b?Aa.warn('Could not load "'+a+'": '+w.string(b),{fileName:"lime/utils/AssetLibrary.hx",lineNumber:865,className:"lime.utils.AssetLibrary",methodName:"loadAudioBuffer_onError"}):Aa.warn('Could not load "'+a+'"',{fileName:"lime/utils/AssetLibrary.hx",lineNumber:869,className:"lime.utils.AssetLibrary",
methodName:"loadAudioBuffer_onError"});this.loadAudioBuffer_onComplete(a,new Ra)},loadBytes_onComplete:function(a,b){this.cachedBytes.h[a]=b;this.__assetLoaded(a)},loadFont_onComplete:function(a,b){this.cachedFonts.h[a]=b;this.__assetLoaded(a)},loadImage_onComplete:function(a,b){this.cachedImages.h[a]=b;this.__assetLoaded(a)},loadText_onComplete:function(a,b){this.cachedText.h[a]=b;this.__assetLoaded(a)},load_onError:function(a,b){null!=b&&""!=b?this.promise.error('Error loading asset "'+a+'": '+
w.string(b)):this.promise.error('Error loading asset "'+a+'"')},load_onProgress:function(a,b,c){if(0<b){var e=this.sizes.h[a];0<c?(b/=c,1<b&&(b=1),b=Math.floor(b*e)):b>e&&(b=e);Object.prototype.hasOwnProperty.call(this.bytesLoadedCache.h,a)?(e=this.bytesLoadedCache.h[a],b!=e&&(this.bytesLoaded+=b-e)):this.bytesLoaded+=b;this.bytesLoadedCache.h[a]=b;this.promise.progress(this.bytesLoaded,this.bytesTotal)}},__class__:Kb};var Bb=function(){this.assets=[];this.libraryArgs=[];this.version=2};d["lime.utils.AssetManifest"]=
Bb;Bb.__name__=!0;Bb.fromBytes=function(a,b){return null!=a?Bb.parse(a.getString(0,a.length),b):null};Bb.loadFromFile=function(a,b){a=Bb.__resolvePath(a);b=Bb.__resolveRootPath(b,a);return null==a?null:lc.loadFromFile(a).then(function(a){return Ta.withValue(Bb.fromBytes(a,b))})};Bb.parse=function(a,b){if(null==a||""==a)return null;a=JSON.parse(a);var c=new Bb;Object.prototype.hasOwnProperty.call(a,"name")&&(c.name=a.name);Object.prototype.hasOwnProperty.call(a,"libraryType")&&(c.libraryType=a.libraryType);
Object.prototype.hasOwnProperty.call(a,"libraryArgs")&&(c.libraryArgs=a.libraryArgs);if(Object.prototype.hasOwnProperty.call(a,"assets")){var e=a.assets;Object.prototype.hasOwnProperty.call(a,"version")&&2>=a.version?c.assets=Fb.run(e):c.assets=e}Object.prototype.hasOwnProperty.call(a,"rootPath")&&(c.rootPath=a.rootPath);null!=b&&""!=b&&(c.rootPath=null==c.rootPath||""==c.rootPath?b:b+"/"+c.rootPath);return c};Bb.__resolvePath=function(a){if(null==a)return null;var b=a.indexOf("?");var c=-1<b?J.substr(a,
0,b):a;for(c=W.replace(c,"\\","/");W.endsWith(c,"/");)c=J.substr(c,0,c.length-1);return W.endsWith(c,".bundle")?-1<b?c+"/library.json"+J.substr(a,b,null):c+"/library.json":a};Bb.__resolveRootPath=function(a,b){if(null!=a)return a;a=b.indexOf("?");a=-1<a?J.substr(b,0,a):b;for(a=W.replace(a,"\\","/");W.endsWith(a,"/");){if("/"==a)return a;a=J.substr(a,0,a.length-1)}return W.endsWith(a,".bundle")?a:wc.directory(a)};Bb.prototype={__class__:Bb};var X=function(){};d["lime.utils.Assets"]=X;X.__name__=!0;
X.getAsset=function(a,b,c){if(c&&X.cache.enabled)switch(b){case "BINARY":case "TEXT":c=!1;break;case "FONT":var e=X.cache.font.h[a];if(null!=e)return e;break;case "IMAGE":e=X.cache.image.h[a];if(X.isValidImage(e))return e;break;case "MUSIC":case "SOUND":e=X.cache.audio.h[a];if(X.isValidAudio(e))return e;break;case "TEMPLATE":throw y.thrown("Not sure how to get template: "+a);default:return null}var g=a.indexOf(":");e=a.substring(0,g);g=a.substring(g+1);var h=X.getLibrary(e);if(null!=h)if(h.exists(g,
b)){if(h.isLocal(g,b))return e=h.getAsset(g,b),c&&X.cache.enabled&&X.cache.set(a,b,e),e;Aa.error(b+' asset "'+a+'" exists, but only asynchronously',{fileName:"lime/utils/Assets.hx",lineNumber:133,className:"lime.utils.Assets",methodName:"getAsset"})}else Aa.error("There is no "+b+' asset with an ID of "'+a+'"',{fileName:"lime/utils/Assets.hx",lineNumber:138,className:"lime.utils.Assets",methodName:"getAsset"});else Aa.error(X.__libraryNotFound(e),{fileName:"lime/utils/Assets.hx",lineNumber:143,className:"lime.utils.Assets",
methodName:"getAsset"});return null};X.getBytes=function(a){return X.getAsset(a,"BINARY",!1)};X.getLibrary=function(a){if(null==a||""==a)a="default";return X.libraries.h[a]};X.isLocal=function(a,b,c){null==c&&(c=!0);if(c&&X.cache.enabled&&X.cache.exists(a,b))return!0;var e=a.indexOf(":");c=a.substring(0,e);a=a.substring(e+1);c=X.getLibrary(c);return null!=c?c.isLocal(a,b):!1};X.isValidAudio=function(a){return null!=a};X.isValidImage=function(a){return null!=a?null!=a.buffer:!1};X.loadLibrary=function(a){var b=
new wb,c=X.getLibrary(a);if(null!=c)return c.load();c=a;var e=null;if(Object.prototype.hasOwnProperty.call(X.bundlePaths.h,a))Eb.loadFromFile(X.bundlePaths.h[a]).onComplete(function(c){null==c?b.error('Cannot load bundle for library "'+a+'"'):(c=Kb.fromBundle(c),null==c?b.error('Cannot open library "'+a+'"'):(X.libraries.h[a]=c,c.onChange.add((f=X.onChange,p(f,f.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+a+'"')});else Object.prototype.hasOwnProperty.call(X.libraryPaths.h,
a)?(c=X.libraryPaths.h[a],e=wc.directory(c)):(W.endsWith(c,".bundle")?(e=c,c+="/library.json"):e=wc.directory(c),c=X.__cacheBreak(c)),Bb.loadFromFile(c,e).onComplete(function(c){null==c?b.error('Cannot parse asset manifest for library "'+a+'"'):(c=Kb.fromManifest(c),null==c?b.error('Cannot open library "'+a+'"'):(X.libraries.h[a]=c,c.onChange.add((f=X.onChange,p(f,f.dispatch))),b.completeWith(c.load())))}).onError(function(c){b.error('There is no asset library with an ID of "'+a+'"')});return b.future};
X.registerLibrary=function(a,b){if(Object.prototype.hasOwnProperty.call(X.libraries.h,a)){if(X.libraries.h[a]==b)return;X.unloadLibrary(a)}null!=b&&b.onChange.add(X.library_onChange);X.libraries.h[a]=b};X.unloadLibrary=function(a){if(null==a||""==a)a="default";var b=X.libraries.h[a];null!=b&&(X.cache.clear(a+":"),b.onChange.remove(X.library_onChange),b.unload());b=X.libraries;Object.prototype.hasOwnProperty.call(b.h,a)&&delete b.h[a]};X.__cacheBreak=function(a){0<X.cache.version&&(a=-1<a.indexOf("?")?
a+("&"+X.cache.version):a+("?"+X.cache.version));return a};X.__libraryNotFound=function(a){if(null==a||""==a)a="default";return null==ca.current||null==ca.current.__preloader||ca.current.__preloader.complete?'There is no asset library named "'+a+'"':'There is no asset library named "'+a+'", or it is not yet preloaded'};X.library_onChange=function(){X.cache.clear();X.onChange.dispatch()};var lc={_new:function(a,b){return new Ja(b)},decompress:function(a,b){switch(b._hx_index){case 0:return $e.decompress(a);
case 1:return af.decompress(a);case 2:return bf.decompress(a);case 3:return cf.decompress(a)}},fromBytes:function(a){return null==a?null:lc._new(a.length,a.b.bufferValue)},fromFile:function(a){return null},loadFromFile:function(a){return(new yd).load(a)},ofString:function(a){a=Ja.ofString(a);return lc._new(a.length,a.b.bufferValue)}},Kd=v["lime.utils.CompressionAlgorithm"]={__ename__:!0,__constructs__:null,DEFLATE:{_hx_name:"DEFLATE",_hx_index:0,__enum__:"lime.utils.CompressionAlgorithm",toString:n},
GZIP:{_hx_name:"GZIP",_hx_index:1,__enum__:"lime.utils.CompressionAlgorithm",toString:n},LZMA:{_hx_name:"LZMA",_hx_index:2,__enum__:"lime.utils.CompressionAlgorithm",toString:n},ZLIB:{_hx_name:"ZLIB",_hx_index:3,__enum__:"lime.utils.CompressionAlgorithm",toString:n}};Kd.__constructs__=[Kd.DEFLATE,Kd.GZIP,Kd.LZMA,Kd.ZLIB];var Aa=function(){};d["lime.utils.Log"]=Aa;Aa.__name__=!0;Aa.error=function(a,b){if(1<=Aa.level){a="["+b.className+"] ERROR: "+w.string(a);if(Aa.throwErrors)throw y.thrown(a);console.error(a)}};
Aa.verbose=function(a,b){5<=Aa.level&&(a="["+b.className+"] "+w.string(a),console.log(a))};Aa.warn=function(a,b){2<=Aa.level&&console.warn("["+b.className+"] WARNING: "+w.string(a))};var de=function(){this.bytesTotalCache=new aa;this.bytesLoadedCache2=new aa;this.bytesLoadedCache=new Db;this.onProgress=new Tc;this.onComplete=new fb;this.bytesTotal=this.bytesLoaded=0;this.libraries=[];this.libraryNames=[];this.onProgress.add(p(this,this.update))};d["lime.utils.Preloader"]=de;de.__name__=!0;de.prototype=
{addLibrary:function(a){this.libraries.push(a)},addLibraryName:function(a){-1==this.libraryNames.indexOf(a)&&this.libraryNames.push(a)},load:function(){for(var a=this,b=0,c=this.libraries;b<c.length;){var e=c[b];++b;this.bytesTotal+=e.bytesTotal}this.loadedLibraries=-1;this.preloadStarted=!1;b=0;for(c=this.libraries;b<c.length;)e=[c[b]],++b,Aa.verbose("Preloading asset library",{fileName:"lime/utils/Preloader.hx",lineNumber:132,className:"lime.utils.Preloader",methodName:"load"}),e[0].load().onProgress(function(b){return function(c,
e){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+c:a.bytesLoaded+(c-a.bytesLoadedCache.h[b[0].__id__]);a.bytesLoadedCache.set(b[0],c);a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal)}}(e)).onComplete(function(b){return function(c){a.bytesLoaded=null==a.bytesLoadedCache.h.__keys__[b[0].__id__]?a.bytesLoaded+b[0].bytesTotal:a.bytesLoaded+(b[0].bytesTotal-a.bytesLoadedCache.h[b[0].__id__]);a.loadedAssetLibrary()}}(e)).onError(function(){return function(a){Aa.error(a,
{fileName:"lime/utils/Preloader.hx",lineNumber:168,className:"lime.utils.Preloader",methodName:"load"})}}());b=0;for(c=this.libraryNames;b<c.length;)++b,this.bytesTotal+=200;this.loadedLibraries++;this.preloadStarted=!0;this.updateProgress()},loadedAssetLibrary:function(a){this.loadedLibraries++;var b=this.loadedLibraries;this.preloadStarted||++b;var c=this.libraries.length+this.libraryNames.length;null!=a?Aa.verbose("Loaded asset library: "+a+" ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",
lineNumber:195,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"}):Aa.verbose("Loaded asset library ["+b+"/"+c+"]",{fileName:"lime/utils/Preloader.hx",lineNumber:199,className:"lime.utils.Preloader",methodName:"loadedAssetLibrary"});this.updateProgress()},start:function(){this.complete||this.simulateProgress||!this.preloadComplete||(this.complete=!0,this.onComplete.dispatch())},update:function(a,b){},updateProgress:function(){var a=this;this.simulateProgress||this.onProgress.dispatch(this.bytesLoaded,
this.bytesTotal);if(this.loadedLibraries==this.libraries.length&&!this.initLibraryNames){this.initLibraryNames=!0;for(var b=0,c=this.libraryNames;b<c.length;){var e=[c[b]];++b;Aa.verbose("Preloading asset library: "+e[0],{fileName:"lime/utils/Preloader.hx",lineNumber:236,className:"lime.utils.Preloader",methodName:"updateProgress"});X.loadLibrary(e[0]).onProgress(function(b){return function(c,e){0<e&&(Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])||(a.bytesTotalCache.h[b[0]]=e,a.bytesTotal+=
e-200),c>e&&(c=e),Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:a.bytesLoaded+=c,a.bytesLoadedCache2.h[b[0]]=c,a.simulateProgress||a.onProgress.dispatch(a.bytesLoaded,a.bytesTotal))}}(e)).onComplete(function(b){return function(c){c=200;Object.prototype.hasOwnProperty.call(a.bytesTotalCache.h,b[0])&&(c=a.bytesTotalCache.h[b[0]]);Object.prototype.hasOwnProperty.call(a.bytesLoadedCache2.h,b[0])?a.bytesLoaded+=c-a.bytesLoadedCache2.h[b[0]]:
a.bytesLoaded+=c;a.loadedAssetLibrary(b[0])}}(e)).onError(function(){return function(a){Aa.error(a,{fileName:"lime/utils/Preloader.hx",lineNumber:290,className:"lime.utils.Preloader",methodName:"updateProgress"})}}())}}this.simulateProgress||this.loadedLibraries!=this.libraries.length+this.libraryNames.length||(this.preloadComplete||(this.preloadComplete=!0,Aa.verbose("Preload complete",{fileName:"lime/utils/Preloader.hx",lineNumber:301,className:"lime.utils.Preloader",methodName:"updateProgress"})),
this.start())},__class__:de};var je=function(a,b){this.drawNeedsUpdate=!1;this.totalTicksPassed=this.elapsedMsSinceLastTick=0;this.isUpdating=!1;this.window=a;this.config=null!=b?b:{framesPerSecond:60,drawOnlyWhenRequested:!1};this.setTickDuration(Math.floor(1E3/this.config.framesPerSecond));this.loop=new Ld;this.loop.onInit(this)};d["ob.gum.Gum"]=je;je.__name__=!0;je.prototype={setTickDuration:function(a){this.tickDurationMs=a},toggleUpdate:function(a){this.isUpdating=null!=a?a:!this.isUpdating},
changeLoop:function(a){this.loop=a;this.loop.onInit(this)},onUpdate:function(a){this.isUpdating&&(this.loop.onUpdate(a),this.elapsedMsSinceLastTick+=a,this.elapsedMsSinceLastTick>=this.tickDurationMs&&(this.elapsedMsSinceLastTick=0,this.totalTicksPassed++,this.drawNeedsUpdate=this.loop.onTick(a)),!this.config.drawOnlyWhenRequested||this.drawNeedsUpdate)&&(this.loop.onDraw(a),this.drawNeedsUpdate=!1)},onKeyDown:function(a,b){this.loop.onKeyDown(a,b)},onKeyUp:function(a,b){this.loop.onKeyUp(a,b)},onMouseMove:function(a,
b){this.loop.onMouseMove(a,b)},onMouseDown:function(a,b,c){this.loop.onMouseDown(a,b,c)},onMouseUp:function(a,b,c){this.loop.onMouseUp(a,b,c)},onMouseScroll:function(a,b,c){this.loop.onMouseScroll(a,b,c)},onWindowResize:function(a,b){this.loop.onWindowResize(a,b)},__class__:je};var Ld=function(){};d["ob.gum.LoadingLoop"]=Ld;Ld.__name__=!0;Ld.__interfaces__=[Ea];Ld.prototype={onTick:function(a){return!1},onInit:function(a){this.gum=a;fa.trace("LoadingLoop onInit",{fileName:"ob/gum/Core.hx",lineNumber:136,
className:"ob.gum.LoadingLoop",methodName:"onInit"})},onUpdate:function(a){},onDraw:function(a){},onKeyDown:function(a,b){},onKeyUp:function(a,b){},onMouseMove:function(a,b){},onMouseDown:function(a,b,c){},onMouseUp:function(a,b,c){},onMouseScroll:function(a,b,c){},onWindowResize:function(a,b){},__class__:Ld};var ne=function(a,b){this.texture=a;this.display=b};d["ob.gum.backends.FrameBuffer"]=ne;ne.__name__=!0;ne.prototype={__class__:ne};var tc=function(){};d["ob.gum.backends.PaletteExtensions"]=
tc;tc.__name__=!0;tc.toRGBA=function(a){for(var b=[],c=0;c<a.length;){var e=a[c];++c;b.push(tc.RGBA(e))}return b};tc.RGBA=function(a,b){null==b&&(b=255);return a<<8|b};var le=function(a){this.imageCache=[];this.fontCache=[];this.paths=a};d["ob.gum.backends.Assets"]=le;le.__name__=!0;le.prototype={Preload:function(a){fa.trace("begin loading "+w.string(this.paths),{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:141,className:"ob.gum.backends.Assets",methodName:"Preload"});this.onReady=a;this.loadFonts()},
loadFonts:function(a){null==a&&(a=0);var b=this;if(a>this.paths.fonts.length-1)this.loadImages();else{var c=this.paths.fonts[a];fa.trace("loading font index "+a+" "+c,{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:153,className:"ob.gum.backends.Assets",methodName:"loadFonts"});(new Se(c)).load(function(c){b.fontCache.push(c);a+=1;b.loadFonts(a)})}},loadImages:function(){var a,b=this;fa.trace("load images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:163,className:"ob.gum.backends.Assets",
methodName:"loadImages"});var c=!1;if(0>=this.paths.images.length)fa.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:166,className:"ob.gum.backends.Assets",methodName:"loadImages"}),this.onReady();else{fa.trace("loading "+this.paths.images.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:169,className:"ob.gum.backends.Assets",methodName:"loadImages"});var e=this.paths.images,g=c,h=function(a,c){fa.trace(c,{fileName:"ob/gum/backends/PeoteView.hx",
lineNumber:172,className:"ob.gum.backends.Assets",methodName:"loadImages"});fa.trace("starting without images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:173,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()},d=function(a){b.imageCache=a;fa.trace("loaded "+b.imageCache.length+" images",{fileName:"ob/gum/backends/PeoteView.hx",lineNumber:177,className:"ob.gum.backends.Assets",methodName:"loadImages"});fa.trace("asset loading finished",{fileName:"ob/gum/backends/PeoteView.hx",
lineNumber:178,className:"ob.gum.backends.Assets",methodName:"loadImages"});b.onReady()};null==g&&(g=!1);var k=[],f=e.length;var l=0;for(a=e.length;l<a;){var n=[l++];var r=[e[n[0]]];c=g;var C=null==h?null:function(a){return function(b){h(a[0],b)}}(n);n=null==d?null:function(a){return function(b){k[a[0]]=b;0==--f&&d(k)}}(n);null==c&&(c=!1);""!=Ya.corsServer&&(new D("^https?://","")).match(r[0])&&(r[0]="//"+Ya.corsServer+"/"+r[0]);var q=Ka.loadFromFile(r[0]);c&&(fa.trace('Start loading image "'+r[0]+
'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),q.onProgress(function(a){return function(b,c){Ya.onProgressDebug(b,c,a[0])}}(r)),q.onError(Ya.onErrorDebug),q.onComplete(function(a){return function(b){Ya.onCompleteDebug(a[0])}}(r)));if(null!=C)q.onError(C);if(null!=n)q.onComplete(n)}}},__class__:le};var Te=function(){this.weight=.5;this.zIndex=this.tilt=0;this.width=this.height=16;this.bgColor=255;this.color=-855703297};d["ob.gum.backends.FontStyle"]=Te;
Te.__name__=!0;Te.prototype={__class__:Te};var qa=function(){};d["peote.text.BackgroundElement"]=qa;qa.__name__=!0;var he=function(){};d["peote.text.FontConfig"]=he;he.__name__=!0;he.prototype={__class__:he};var Jb=function(a){this.uniformFloats=[];this.uniformFloatsVertex=this.uniformFloatsFragment=null;this.hasFragmentInjection=this.ready=!1;this.fragmentFloatPrecision=null;this.formulaHasChanged=!1;this.formula=new aa;this.colorFormula="";this.used_by_ColorFormula=this.usedID_by_ColorFormula=0;
this.textureID_Defaults=[];this.customTextureIdentifiers=[];this.activeUnits=[];this.activeTextures=[];this.textureLayers=new xb;this.textureListPicking=new Md(new Db);this.textureList=new Md(new Db);this.glShaderConfig={isPICKING:!1,isES3:!1,isINSTANCED:!1,isUBO:!1,IN:"attribute",VARIN:"varying",VAROUT:"varying",hasTEXTURES:!1,hasTEXTURE_FUNCTIONS:!1,hasFRAGMENT_INJECTION:!1,FRAGMENT_PROGRAM_UNIFORMS:"",FRAGMENT_CALC_LAYER:"",TEXTURES:[],TEXTURE_DEFAULTS:[],isDISCARD:!0,DISCARD:"0.0",isPIXELSNAPPING:!1,
PIXELDIVISOR:"1.0",VERTEX_FLOAT_PRECISION:null,VERTEX_INT_PRECISION:null,VERTEX_SAMPLER_PRECISION:null,FRAGMENT_FLOAT_PRECISION:null,FRAGMENT_INT_PRECISION:null,FRAGMENT_SAMPLER_PRECISION:null,VERTEX_INJECTION:"",FRAGMENT_INJECTION:"",SIZE_FORMULA:null,POS_FORMULA:null,ROTZ_FORMULA:null,PIVOT_FORMULA:null,FORMULA_VARYINGS:{},FORMULA_CONSTANTS:{},FRAGMENT_EXTENSIONS:[]};this.gl=this.glProgram=this.glProgramPicking=this.glVertexShader=this.glFragmentShader=this.glVertexShaderPicking=this.glFragmentShaderPicking=
null;this.displays=[];this.autoUpdateTextures=this.isVisible=!0;this.clearMask=!1;this.mask=0;this.colorEnabled=!0;this.buffer=a;this.alphaEnabled=a.hasAlpha();this.zIndexEnabled=a.hasZindex();this.colorIdentifiers=a.getColorIdentifiers();this.customIdentifiers=a.getCustomIdentifiers();this.customVaryings=a.getCustomVaryings();this.textureIdentifiers=a.getTextureIdentifiers();this.defaultColorFormula=a.getDefaultColorFormula();this.defaultFormulaVars=a.getDefaultFormulaVars();var b=a.getFormulas().h;
b=Object.keys(b);for(var c=b.length,e=0;e<c;){var g=b[e++],h=this.formula,d=a.getFormulas().h[g];h.h[g]=d}try{ic.resolveFormulaCyclic(a.getFormulas())}catch(k){throw ma.lastError=k,a=y.caught(k).unwrap(),y.thrown('Error: cyclic reference of "'+w.string(a.errVar)+'" inside @formula "'+w.string(a.formula)+'" for "'+w.string(a.errKey)+'"');}ic.resolveFormulaVars(a.getFormulas(),a.getAttributes());this.parseColorFormula()};d["peote.view.Program"]=Jb;Jb.__name__=!0;Jb.prototype={addToDisplay:function(a,
b,c){null==c&&(c=!1);if(0>this.displays.indexOf(a)){this.displays.push(a);var e=a.gl;if(null!=e&&e!=this.gl){for(var g=0,h=this.displays;g<h.length;){var d=h[g];++g;if(null!=d.gl&&d.gl!=e)throw y.thrown("Error, program can not used inside different gl-contexts");}null!=this.gl&&(this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),
this.gl.deleteProgram(this.glProgramPicking)));this.gl=e;I.isES3&&(this.glShaderConfig.isES3=!0,this.glShaderConfig.IN="in",this.glShaderConfig.VARIN="in",this.glShaderConfig.VAROUT="out");I.isUBO&&(this.glShaderConfig.isUBO=!0);I.isINSTANCED&&(this.glShaderConfig.isINSTANCED=!0);this.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=this.gl.getExtension("OES_standard_derivatives")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=this.gl.getExtension("EXT_color_buffer_float")?
this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):null!=this.gl.getExtension("OES_texture_float")&&this.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});this.buffer.setNewGLContext(this.gl);this.createProg();this.buffer.hasPicking()&&this.createProg(!0);g=0;for(h=this.activeTextures;g<h.length;){var k=h[g];++g;e=this.gl;if(null!=e&&e!=k.gl){d=0;for(var f=k.programs;d<f.length;){var l=f[d];++d;if(null!=l.gl&&l.gl!=e)throw y.thrown("Error, texture can not used inside different gl-contexts");
}f=0;for(l=k.displays;f<l.length;)if(d=l[f],++f,null!=d.gl&&d.gl!=e)throw y.thrown("Error, texture can not used inside different gl-contexts");null!=k.gl&&(k.gl.deleteTexture(k.glTexture),k.glTexture=null,0==k.displays.length&&null!=k.framebuffer&&(k.gl.deleteFramebuffer(k.framebuffer),k.framebuffer=null,null!=k.glDepthBuffer&&k.gl.deleteRenderbuffer(k.glDepthBuffer),k.glDepthBuffer=null));k.gl=e;if(k.width>k.gl.getParameter(k.gl.MAX_TEXTURE_SIZE)||k.height>k.gl.getParameter(k.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");
k.glTexture=Sb.createEmptyTexture(k.gl,k.width,k.height,k.colorChannels,k.createMipmaps,k.magFilter,k.minFilter,k.useFloat);if(0<k.displays.length&&null==k.framebuffer){k.glDepthBuffer=k.gl.createRenderbuffer();e=k.gl;d=k.glTexture;f=k.glDepthBuffer;l=k.width;var n=k.height,r=e.createFramebuffer();e.bindRenderbuffer(e.RENDERBUFFER,f);Ma.clearGlErrorQueue(e);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT24,l,n);Ma.getLastGlError(e)==e.INVALID_ENUM&&(fa.trace("switching to DEPTH_COMPONENT16 for framebuffer",
{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,l,n));e.bindFramebuffer(e.FRAMEBUFFER,r);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,f);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,d,0);if(e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");e.bindFramebuffer(e.FRAMEBUFFER,
null);e.bindRenderbuffer(e.RENDERBUFFER,null);k.framebuffer=r;k.updated=!0}for(e=k.images.keys();e.hasNext();)d=e.next(),k.bufferImage(d,k.images.h[d.__id__])}}}}a.programList.add(this,b,c)},createProg:function(a){null==a&&(a=!1);this.glShaderConfig.isPICKING=a;if(null!=this.fragmentFloatPrecision)this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=this.fragmentFloatPrecision;else if(this.buffer.needFragmentPrecision()&&23>Na.FragmentFloat.medium){var b=Na.FragmentFloat;this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=
0<b.high?"highp":0<b.medium?"mediump":0<b.low?"lowp":null}else b=Na.FragmentFloat,this.glShaderConfig.FRAGMENT_FLOAT_PRECISION=0<b.medium?"mediump":0<b.low?"lowp":null;this.parseAndResolveFormulas();var c=this.gl,e=this.gl.VERTEX_SHADER,g=this.buffer.getVertexShader(),h=this.glShaderConfig;g=new Oa(g);var d=Ma.rStartspaces,k=Ma.rEmptylines;h=g.execute(h).replace(k.r,"\n").replace(d.r,"");g=c.createShader(e);c.shaderSource(g,h);c.compileShader(g);if(0==c.getShaderParameter(g,c.COMPILE_STATUS))throw y.thrown("ERROR compiling "+
(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+w.string(c.getShaderInfoLog(g)));b=g;c=this.gl;e=this.gl.FRAGMENT_SHADER;g=this.buffer.getFragmentShader();h=this.glShaderConfig;g=new Oa(g);d=Ma.rStartspaces;k=Ma.rEmptylines;h=g.execute(h).replace(k.r,"\n").replace(d.r,"");g=c.createShader(e);c.shaderSource(g,h);c.compileShader(g);if(0==c.getShaderParameter(g,c.COMPILE_STATUS))throw y.thrown("ERROR compiling "+(e==c.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+w.string(c.getShaderInfoLog(g)));
e=g;h=this.gl.createProgram();this.gl.attachShader(h,b);this.gl.attachShader(h,e);this.buffer.bindAttribLocations(this.gl,h);c=this.gl;c.linkProgram(h);if(0==c.getProgramParameter(h,c.LINK_STATUS))throw y.thrown(w.string(c.getProgramInfoLog(h))+"VALIDATE_STATUS: "+w.string(c.getProgramParameter(h,c.VALIDATE_STATUS))+"ERROR: "+w.string(c.getError()));!a&&I.isUBO?(c=this.gl.getUniformBlockIndex(h,"uboView"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(h,c,0),c=this.gl.getUniformBlockIndex(h,
"uboDisplay"),c!=this.gl.INVALID_INDEX&&this.gl.uniformBlockBinding(h,c,1)):a?(this.uRESOLUTION_PICK=this.gl.getUniformLocation(h,"uResolution"),this.uZOOM_PICK=this.gl.getUniformLocation(h,"uZoom"),this.uOFFSET_PICK=this.gl.getUniformLocation(h,"uOffset")):(this.uRESOLUTION=this.gl.getUniformLocation(h,"uResolution"),this.uZOOM=this.gl.getUniformLocation(h,"uZoom"),this.uOFFSET=this.gl.getUniformLocation(h,"uOffset"));if(a)for(this.uTIME_PICK=this.gl.getUniformLocation(h,"uTime"),this.uniformFloatPickLocations=
[],c=0,g=this.uniformFloats;c<g.length;)d=g[c],++c,this.uniformFloatPickLocations.push(this.gl.getUniformLocation(h,d.name));else for(this.uTIME=this.gl.getUniformLocation(h,"uTime"),this.uniformFloatLocations=[],c=0,g=this.uniformFloats;c<g.length;)d=g[c],++c,this.uniformFloatLocations.push(this.gl.getUniformLocation(h,d.name));if(a){this.textureListPicking.clear();c=0;for(g=this.activeTextures.length;c<g;)a=c++,this.textureListPicking.add(new Nd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(h,
"uTexture"+a)),null,!1);this.glProgramPicking=h;this.glVertexShaderPicking=b;this.glFragmentShaderPicking=e}else{this.textureList.clear();c=0;for(g=this.activeTextures.length;c<g;)a=c++,this.textureList.add(new Nd(this.activeUnits[a],this.activeTextures[a],this.gl.getUniformLocation(h,"uTexture"+a)),null,!1);this.glProgram=h;this.glVertexShader=b;this.glFragmentShader=e}this.ready=!0},parseColorFormula:function(){var a="";if(""!=this.colorFormula)a=this.colorFormula;else if(""!=this.defaultColorFormula)a=
this.defaultColorFormula;else{for(var b=this.colorIdentifiers.slice(),c=[],e=0,g=this.textureIdentifiers.length;e<g;){var h=e++;this.textureLayers.h.hasOwnProperty(h)&&c.push(this.textureIdentifiers[h])}e=0;for(g=this.customTextureIdentifiers.length;e<g;)h=e++,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+h)&&c.push(this.customTextureIdentifiers[h]);if(0==b.length+c.length){var d=-16776961;c=""+w.string((d>>24&255)/255);var k=""+w.string((d>>16&255)/255),f=""+w.string((d>>8&255)/
255);d=""+w.string((d&255)/255);a="vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=k.indexOf(".")||-1!=k.indexOf("e-")?k:k+".0")+", "+((-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")}else{0<c.length&&(a=c.shift(),0<b.length&&(a=""+b.shift()+" * "+a));for(e=0;e<c.length;)k=c[e],++e,0<b.length&&(k=""+b.shift()+" * "+k+" "),a="mix( "+a+", "+k+", ("+k+").a )";for(;0<b.length;)a+=(""!=a?"*":"")+b.shift(),0<b.length&&(a=
"("+a+" + "+b.shift()+")")}}e=0;for(g=this.colorIdentifiers.length;e<g;)h=e++,b=new D("(^|.*?[^\\w.])"+this.colorIdentifiers[h]+"\\b.*?","g"),b.match(a)&&(a=a.replace(b.r,"$1c"+h));e=0;for(g=this.customIdentifiers.length;e<g;)if(h=e++,b=new D("(^|.*?[^\\w.])"+this.customIdentifiers[h]+"\\b.*?","g"),b.match(a))if(null!=this.customVaryings[h])a=a.replace(b.r,"$1"+this.customVaryings[h]);else throw y.thrown("Error while parsing ColorFormula: custom identifier "+this.customIdentifiers[h]+" need @varying to access in fragmentshader");
this.textureID_Defaults=[];e=this.usedID_by_ColorFormula=this.used_by_ColorFormula=0;for(g=this.textureIdentifiers.length;e<g;)h=e++,b=new D("(^|.*?[^\\w.])"+this.textureIdentifiers[h]+"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(h)&&(a=a.replace(b.r,"$1t"+h)),this.used_by_ColorFormula|=1<<h),b=new D("(^|.*?[^\\w.])"+(this.textureIdentifiers[h]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+h),this.usedID_by_ColorFormula|=1<<h,this.textureLayers.h.hasOwnProperty(h)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[h]],
c=""+w.string((d>>24&255)/255),k=""+w.string((d>>16&255)/255),f=""+w.string((d>>8&255)/255),d=""+w.string((d&255)/255),this.textureID_Defaults.push({layer:h,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=k.indexOf(".")||-1!=k.indexOf("e-")?k:k+".0")+", "+((-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?d:d+".0")+")")})));e=0;for(g=this.customTextureIdentifiers.length;e<g;)h=e++,b=new D("(^|.*?[^\\w.])"+this.customTextureIdentifiers[h]+
"\\b.*?","g"),b.match(a)&&(this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+h)&&(a=a.replace(b.r,"$1t"+(this.textureIdentifiers.length+h))),this.used_by_ColorFormula|=1<<this.textureIdentifiers.length+h),b=new D("(^|.*?[^\\w.])"+(this.customTextureIdentifiers[h]+"_ID\\b.*?"),"g"),b.match(a)&&(a=a.replace(b.r,"$1"+(this.textureIdentifiers.length+h)),this.usedID_by_ColorFormula|=1<<this.textureIdentifiers.length+h,this.textureLayers.h.hasOwnProperty(this.textureIdentifiers.length+
h)||(d=this.defaultFormulaVars.h[this.textureIdentifiers[this.textureIdentifiers.length+h]],c=""+w.string((d>>24&255)/255),k=""+w.string((d>>16&255)/255),f=""+w.string((d>>8&255)/255),d=""+w.string((d&255)/255),this.textureID_Defaults.push({layer:this.textureIdentifiers.length+h,value:"vec4("+(-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=k.indexOf(".")||-1!=k.indexOf("e-")?k:k+".0")+", "+((-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+", "+(-1!=d.indexOf(".")||-1!=d.indexOf("e-")?
d:d+".0")+")")})));e=Object.keys(this.defaultFormulaVars.h);g=e.length;for(h=0;h<g;)c=e[h++],b=new D("(^|.*?[^\\w.])"+c+"\\b.*?","g"),b.match(a)&&(d=this.defaultFormulaVars.h[c],c=""+w.string((d>>24&255)/255),k=""+w.string((d>>16&255)/255),f=""+w.string((d>>8&255)/255),d=""+w.string((d&255)/255),a=a.replace(b.r,"$1vec4("+((-1!=c.indexOf(".")||-1!=c.indexOf("e-")?c:c+".0")+", "+(-1!=k.indexOf(".")||-1!=k.indexOf("e-")?k:k+".0")+", "+((-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0")+", "+(-1!=d.indexOf(".")||
-1!=d.indexOf("e-")?d:d+".0")+")"))));this.glShaderConfig.FRAGMENT_CALC_LAYER=a},setColorFormula:function(a,b,c){null==a&&(a="");this.colorFormula=a;if(null!=b){a=Object.keys(b.h);for(var e=a.length,g=0;g<e;){var h=a[g++];if(!(new D("^([a-zA-z_]+\\d*)+$","g")).match(h))throw y.thrown('Error: "'+h+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');this.defaultFormulaVars.h[h]=b.h[h]}}null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},
injectIntoVertexShader:function(a,b,c,e){null==b&&(b=!1);null==a&&(a="");this.uniformFloatsVertex=c;b=(b&&!this.buffer.hasTime()?"uniform float uTime;":"")+this.generateUniformFloatsGLSL(c);this.glShaderConfig.VERTEX_INJECTION=b+a;this.accumulateUniformsFloat();null!=e?e&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},injectIntoFragmentShader:function(a,b,c,e){null==b&&(b=!1);null==a&&(a="");this.hasFragmentInjection=""==a?!1:!0;this.uniformFloatsFragment=c;b=(b?"uniform float uTime;":
"")+this.generateUniformFloatsGLSL(c);this.glShaderConfig.FRAGMENT_INJECTION=b+a;this.accumulateUniformsFloat();null!=e?e&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},generateUniformFloatsGLSL:function(a){var b="";if(null!=a)for(var c=0;c<a.length;){var e=a[c];++c;b+="uniform float "+e.name+";"}return b},accumulateUniformsFloat:function(){if(null==this.uniformFloatsVertex)null!=this.uniformFloatsFragment&&(this.uniformFloats=this.uniformFloatsFragment);else if(null==this.uniformFloatsFragment)this.uniformFloats=
this.uniformFloatsVertex;else{this.uniformFloats=this.uniformFloatsVertex;for(var a=0,b=this.uniformFloatsFragment;a<b.length;){var c=b[a];++a;0>this.uniformFloats.indexOf(c)&&this.uniformFloats.push(c)}}},setFormula:function(a,b,c){var e=this.buffer.getFormulaNames().h[a];if(null!=e)fa.trace("  set formula: "+e+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:514,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[e]=b;else{e=[];var g=this.buffer.getFormulaNames().h;g=Object.keys(g);
for(var h=g.length,d=0;d<h;){var k=g[d++];e.push(this.buffer.getFormulaNames().h[k])}if(0<=e.indexOf(a))this.formula.h[a]=b;else if(0<=this.buffer.getFormulaVaryings().indexOf(a))fa.trace("  set formula for varying: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:522,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[a]=b;else if(0<=this.buffer.getFormulaConstants().indexOf(a))fa.trace("  set formula for constant: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:526,
className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[a]=b;else if(0<=this.buffer.getFormulaCustoms().indexOf(a))fa.trace("  set formula for custom: "+a+" = "+b,{fileName:"peote/view/Program.hx",lineNumber:530,className:"peote.view.Program",methodName:"setFormula"}),this.formula.h[a]=b;else throw y.thrown("Error: can not set Formula for "+a+" if there is no property defined for @"+a+" inside Element");}this.formulaHasChanged=!0;null!=c?c&&this.updateTextures():this.autoUpdateTextures&&
this.updateTextures()},parseAndResolveFormulas:function(){var a=this;if(this.formulaHasChanged){for(var b=new aa,c=Object.keys(this.formula.h),e=c.length,g=0;g<e;){var h=c[g++];b.h[h]=this.formula.h[h]}var d=b;try{ic.resolveFormulaCyclic(d)}catch(k){throw ma.lastError=k,b=y.caught(k).unwrap(),y.thrown('Error: cyclic reference of "'+w.string(b.errVar)+'" inside formula "'+w.string(b.formula)+'" for "'+w.string(b.errKey)+'"');}ic.resolveFormulaVars(d,this.buffer.getAttributes());b=function(b,c,e,g){var h=
a.buffer.getFormulaNames().h[b];null==h&&(h="");var k=a.buffer.getFormulaNames().h[c];null==k&&(k="");var f=d.h[h],l=d.h[k];return f!=a.buffer.getFormulas().h[h]||l!=a.buffer.getFormulas().h[k]?(null==f&&(f=a.buffer.getAttributes().h[h]),null==f&&(f=e),null==l&&(l=a.buffer.getAttributes().h[k]),null==l&&(l=g),"rotation"==b&&"0.0"!=f&&(f="("+f+")/180.0*"+Math.PI),"zIndex"==c&&"0.0"!=l&&(b=""+w.string(a.buffer.getMaxZindex()),l="clamp( "+l+"/"+(-1!=b.indexOf(".")||-1!=b.indexOf("e-")?b:b+".0")+", -1.0, 1.0)"),
"vec2("+f+", "+l+")"):null};this.glShaderConfig.SIZE_FORMULA=b("sizeX","sizeY","100.0","100.0");this.glShaderConfig.POS_FORMULA=b("posX","posY","0.0","0.0");this.glShaderConfig.ROTZ_FORMULA=b("rotation","zIndex","0.0","0.0");this.glShaderConfig.PIVOT_FORMULA=b("pivotX","pivotY","0.0","0.0");b=0;for(c=this.buffer.getFormulaVaryings();b<c.length;)e=c[b],++b,g=d.h[e],g!=this.buffer.getFormulas().h[e]?(null==g&&(g=this.buffer.getAttributes().h[e]),this.glShaderConfig.FORMULA_VARYINGS[e]=g,fa.trace(" -- replacing Formula "+
e+" => "+g,{fileName:"peote/view/Program.hx",lineNumber:591,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):this.glShaderConfig.FORMULA_VARYINGS[e]=null;b=0;for(c=this.buffer.getFormulaConstants();b<c.length;)e=c[b],++b,g=d.h[e],null!=g&&g!=this.buffer.getAttributes().h[e]?(this.glShaderConfig.FORMULA_CONSTANTS[e]=g,fa.trace(" -- replacing Formula "+e+" => "+g,{fileName:"peote/view/Program.hx",lineNumber:601,className:"peote.view.Program",methodName:"parseAndResolveFormulas"})):
this.glShaderConfig.FORMULA_CONSTANTS[e]=null}},getTextureIndexByIdentifier:function(a,b){null==b&&(b=!0);var c=this.textureIdentifiers.indexOf(a);if(0>c&&(c=this.customTextureIdentifiers.indexOf(a),0>c&&b)){if(!(new D("^([a-zA-z_]+\\d*)+$","g")).match(a))throw y.thrown('Error: "'+a+'" is not an identifier, please use only letters/numbers or "_" (starting with a letter)');c=this.textureIdentifiers.length+this.customTextureIdentifiers.length;this.customTextureIdentifiers.push(a)}return c},validatePrecision:function(a){if(null!=
a)if(0>["low","medium","high"].indexOf(a.toLowerCase())){if(0>["lowp","mediump","highp"].indexOf(a.toLowerCase()))throw y.thrown("Error, no valid precision format. Use 'low', 'medium' or 'high' (or leave it null for default)");}else a+="p";return a},setFragmentFloatPrecision:function(a,b){a=this.validatePrecision(a);var c=Na.FragmentFloat;this.fragmentFloatPrecision=null==a?null:0<c.high&&"highp"==a?"highp":0<c.medium&&("highp"==a||"mediump"==a)?"mediump":0<c.low?"lowp":null;null!=b?b&&this.updateTextures():
this.autoUpdateTextures&&this.updateTextures()},discardAtAlpha:function(a,b){null==a?this.glShaderConfig.isDISCARD=!1:(this.glShaderConfig.isDISCARD=!0,a=""+w.string(a),this.glShaderConfig.DISCARD=-1!=a.indexOf(".")||-1!=a.indexOf("e-")?a:a+".0");null!=b?b&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},setTexture:function(a,b,c){b=this.getTextureIndexByIdentifier(b);this.textureLayers.h[b]=[a];null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},
addTexture:function(a,b,c){b=this.getTextureIndexByIdentifier(b);if(null==a)throw y.thrown("Error, texture is null.");var e=this.textureLayers.h[b];if(null!=e){if(0<=e.indexOf(a))throw y.thrown("Error, textureLayer already contains this texture.");e.push(a);this.textureLayers.h[b]=e}else this.textureLayers.h[b]=[a];null!=c?c&&this.updateTextures():this.autoUpdateTextures&&this.updateTextures()},updateTextures:function(){for(var a=[],b=this.textureLayers.keys();b.hasNext();)for(var c=b.next(),e=0,
g=this.textureLayers.h[c];e<g.length;)c=g[e],++e,0>a.indexOf(c)&&a.push(c);for(var h=this.activeTextures.length;0<h--;)if(0>a.indexOf(this.activeTextures[h])){if(!J.remove(this.activeTextures[h].programs,this))throw y.thrown("Error, this texture is not used by program anymore");this.activeTextures.splice(h,1);this.activeUnits.splice(h,1)}for(e=0;e<a.length;)if(c=a[e],++e,0>this.activeTextures.indexOf(c)){this.activeTextures.push(c);for(g=0;0<=this.activeUnits.indexOf(g);)++g;this.activeUnits.push(g);
if(0<=c.programs.indexOf(this))throw y.thrown("Error, texture is already used by program");b=this.gl;if(null!=b&&b!=c.gl){g=0;for(h=c.programs;g<h.length;){var d=h[g];++g;if(null!=d.gl&&d.gl!=b)throw y.thrown("Error, texture can not used inside different gl-contexts");}g=0;for(h=c.displays;g<h.length;)if(d=h[g],++g,null!=d.gl&&d.gl!=b)throw y.thrown("Error, texture can not used inside different gl-contexts");null!=c.gl&&(c.gl.deleteTexture(c.glTexture),c.glTexture=null,0==c.displays.length&&null!=
c.framebuffer&&(c.gl.deleteFramebuffer(c.framebuffer),c.framebuffer=null,null!=c.glDepthBuffer&&c.gl.deleteRenderbuffer(c.glDepthBuffer),c.glDepthBuffer=null));c.gl=b;if(c.width>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE)||c.height>c.gl.getParameter(c.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");c.glTexture=Sb.createEmptyTexture(c.gl,c.width,c.height,c.colorChannels,c.createMipmaps,c.magFilter,c.minFilter,c.useFloat);if(0<c.displays.length&&null==c.framebuffer){c.glDepthBuffer=
c.gl.createRenderbuffer();g=c.gl;b=c.glTexture;h=c.glDepthBuffer;d=c.width;var k=c.height,f=g.createFramebuffer();g.bindRenderbuffer(g.RENDERBUFFER,h);Ma.clearGlErrorQueue(g);g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_COMPONENT24,d,k);Ma.getLastGlError(g)==g.INVALID_ENUM&&(fa.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_COMPONENT16,
d,k));g.bindFramebuffer(g.FRAMEBUFFER,f);g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,h);g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,b,0);if(g.checkFramebufferStatus(g.FRAMEBUFFER)!=g.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");g.bindFramebuffer(g.FRAMEBUFFER,null);g.bindRenderbuffer(g.RENDERBUFFER,null);c.framebuffer=f;c.updated=!0}for(g=c.images.keys();g.hasNext();)b=g.next(),c.bufferImage(b,c.images.h[b.__id__])}c.programs.push(this)}this.parseColorFormula();
this.glShaderConfig.hasFRAGMENT_INJECTION=this.hasFragmentInjection;this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS="";this.glShaderConfig.TEXTURES=[];if(0==this.activeTextures.length)this.glShaderConfig.hasTEXTURES=!1;else{this.glShaderConfig.hasTEXTURES=!0;e=0;for(g=this.activeTextures.length;e<g;)h=e++,this.glShaderConfig.FRAGMENT_PROGRAM_UNIFORMS+="uniform sampler2D uTexture"+h+";";for(b=this.textureLayers.keys();b.hasNext();){c=b.next();a=[];d=this.textureLayers.h[c];e=0;for(g=d.length;e<g;){h=
e++;k=""+w.string(d[h].slotWidth/d[h].width);f=""+w.string(d[h].slotHeight/d[h].height);var l=""+w.string(d[h].slotsX*d[h].slotWidth/d[h].width),n=""+w.string(d[h].slotsY*d[h].slotHeight/d[h].height);a.push({UNIT_VALUE:h+1+".0",TEXTURE:"uTexture"+this.activeTextures.indexOf(d[h]),SLOTS_X:d[h].slotsX+".0",SLOTS_Y:d[h].slotsY+".0",SLOT_WIDTH:-1!=k.indexOf(".")||-1!=k.indexOf("e-")?k:k+".0",SLOT_HEIGHT:-1!=f.indexOf(".")||-1!=f.indexOf("e-")?f:f+".0",SLOTS_WIDTH:-1!=l.indexOf(".")||-1!=l.indexOf("e-")?
l:l+".0",SLOTS_HEIGHT:-1!=n.indexOf(".")||-1!=n.indexOf("e-")?n:n+".0",TILES_X:d[h].tilesX+".0",TILES_Y:d[h].tilesY+".0",TEXTURE_WIDTH:d[h].width+".0",TEXTURE_HEIGHT:d[h].height+".0",FIRST:0==h,LAST:h==d.length-1})}this.glShaderConfig.TEXTURES.push({LAYER:c,UNITS:a,USED:0<(this.used_by_ColorFormula&1<<c),USED_ID:0<(this.usedID_by_ColorFormula&1<<c)})}}this.glShaderConfig.TEXTURE_DEFAULTS=[];e=0;for(g=this.textureID_Defaults;e<g.length;)a=g[e],++e,this.glShaderConfig.TEXTURE_DEFAULTS.push({LAYER:a.layer,
DEFAULT_VALUE:a.value});this.glShaderConfig.hasTEXTURE_FUNCTIONS=0==this.usedID_by_ColorFormula&&0==this.textureID_Defaults.length?!1:!0;null!=this.gl&&(this.ready=!1,this.gl.deleteShader(this.glVertexShader),this.gl.deleteShader(this.glFragmentShader),this.gl.deleteProgram(this.glProgram),this.buffer.hasPicking()&&(this.gl.deleteShader(this.glVertexShaderPicking),this.gl.deleteShader(this.glFragmentShaderPicking),this.gl.deleteProgram(this.glProgramPicking)),this.createProg(),this.buffer.hasPicking()&&
this.createProg(!0))},__class__:Jb};var Rd=function(a,b,c,e){null==e&&(e=!1);null==c&&(c=!1);this.isMasked=this.hasBackground=!1;this._buffer=new Od(1024,1024,!0);Jb.call(this,this._buffer);c&&(this.isMasked=!0,this.maskBuffer=new Pd(16,16,!0),this.maskProgram=new Jb(this.maskBuffer),this.maskProgram.mask=2,this.maskProgram.colorEnabled=!1,this.mask=1,this.hasBackground&&(this.backgroundProgram.mask=1));e&&(this.hasBackground=!0,this.backgroundBuffer=new Qd(16,16,!0),this.backgroundProgram=new Jb(this.backgroundBuffer),
this.isMasked&&(this.backgroundProgram.mask=1));this.font=a;this.autoUpdateTextures=!1;this.setTexture(a.textureCache,"TEX");this.fontStyle=b;this.alphaEnabled=!0;this.font.config.distancefield?(a=""+w.string(.5),a=-1!=a.indexOf(".")||-1!=a.indexOf("e-")?a:a+".0",this.setColorFormula("mix(bgColor,color,smoothstep( weight - "+a+" * fwidth(TEX.r), weight + "+a+" * fwidth(TEX.r), TEX.r))")):this.setColorFormula("mix(bgColor,color,TEX.r)");this.setFormula("x","x + (1.0-aPosition.y)*width*tilt");this.updateTextures()};
d["peote.text.FontProgram__ob_gum_backends_PeoteView_FontStyle"]=Rd;Rd.__name__=!0;Rd.__super__=Jb;Rd.prototype=F(Jb.prototype,{addToDisplay:function(a,b,c){null==c&&(c=!1);Jb.prototype.addToDisplay.call(this,a,b,c);this.isMasked&&this.maskProgram.addToDisplay(a,this,!0);this.hasBackground&&this.backgroundProgram.addToDisplay(a,this,!0)},__class__:Rd});var Se=function(a,b,c,e){null==e&&(e=16384);null==c&&(c=!0);this.rHexToDec=new D('("\\s*)?(0x[0-9a-f]+)(\\s*")?',"gi");this.rComments=new D("//.*?$",
"gm");this.rParsePathConfig=new D("^(.*?)([^/]+)$","");this.kerning=!1;if(this.rParsePathConfig.match(a))this.path=this.rParsePathConfig.matched(1),this.jsonFilename=this.rParsePathConfig.matched(2);else throw y.thrown("Can't load font, error in path to jsonfile: \""+a+'"');this.ranges=b;this.kerning=c;this.maxTextureSize=e};d["peote.text.Font__ob_gum_backends_PeoteView_FontStyle"]=Se;Se.__name__=!0;Se.prototype={createFontProgram:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);return new Rd(this,
a,b,c)},createFontStyle:function(){return new Te},load:function(a,b,c){null==c&&(c=!1);var e=this,g=c,h=function(g){g=g.replace(e.rComments.r,"");g=e.rHexToDec.map(g,function(a){return w.string(w.parseInt(a.matched(2)))});var h=new U;e.config=h.fromJson(g,e.path+e.jsonFilename);g=0;for(h=h.errors;g<h.length;){var d=h[g];++g;switch(d._hx_index){case 0:var f=d.variable;var k=d.expected;f=d.pos;break;case 1:f=d.pos;break;case 2:f=d.pos;break;case 3:f=d.pos;break;case 4:f=d.pos;break;case 5:f=d.pos;break;
case 6:f=d.pos}fa.trace(f.lines[0].number,{fileName:"peote/text/Font.hx",lineNumber:246,className:"peote.text.Font__ob_gum_backends_PeoteView_FontStyle",methodName:"load"});null!=f&&fa.trace(Ze.convertError(d),{fileName:f.file,lineNumber:f.lines[0].number,className:"",methodName:""})}if(e.config.packed)throw g='Error, metadata of FontStyle class has to be "@packed" for "'+e.path+e.jsonFilename+'" and "packed":true',fa.trace(g,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),
y.thrown(g);e.kerning&&null!=e.config.kerning&&(e.kerning=e.config.kerning);if(null==e.ranges&&1<e.config.ranges.length)throw g='Error, set FontStyle to @multiSlot and/or @multiTexture or define a single range while Font creation or inside "'+e.path+e.jsonFilename+'"',fa.trace(g,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),y.thrown(g);d=[];g=0;for(h=e.config.ranges;g<h.length;){var l=h[g];++g;var n=l.range.min,C=l.range.max;if(null!=e.ranges)for(f=0,k=e.ranges;f<k.length;){var x=
k[f];++f;if(x.min>=n&&x.min<=C||x.max>=n&&x.max<=C){d.push(l);break}}else d.push(l);if(1==d.length)break}if(0==d.length)throw g='Error, can not found any ranges inside font-config "'+e.path+e.jsonFilename+'" that fit '+w.string(e.ranges),fa.trace(g,{fileName:e.path+e.jsonFilename,lineNumber:0,className:"",methodName:""}),y.thrown(g);e.config.ranges=d;e.init(a,b,c)};null==g&&(g=!1);var d=this.path+this.jsonFilename,k=null==h?null:h,f=null==h?null:function(a){h(a.toString())};null==g&&(g=!1);""!=Ya.corsServer&&
(new D("^https?://","")).match(d)&&(d="//"+Ya.corsServer+"/"+d);var l=lc.loadFromFile(d);g&&(fa.trace('Start loading bytes "'+d+'"',{fileName:"utils/Loader.hx",lineNumber:81,className:"utils.Loader",methodName:"bytes"}),l.onProgress(function(a,b){Ya.onProgressDebug(a,b,d)}),l.onError(Ya.onErrorDebug),l.onComplete(function(a){Ya.onCompleteDebug(d)}));if(null!=k)l.onError(k);if(null!=f)l.onComplete(f)},init:function(a,b,c){for(var e=0,g=0,h=0,d=this.config.ranges;h<d.length;){var f=d[h];++h;f.slot.width>
e&&(e=f.slot.width);f.slot.height>g&&(g=f.slot.height)}this.textureCache=new Nc(e,g,this.config.ranges.length,4,!1,1,1,null,this.maxTextureSize);this.loadImages(null,a,b,c)},loadImages:function(a,b,c,e){var g=this,h=this.config.ranges;a=Array(h.length);for(var d=0,f=h.length;d<f;){var l=d++;a[l]=g.path+h[l].image}h=e;var n=function(a,b,e){null!=c&&c(b,e)},C=function(a,b){if(null!=g.config.ranges[a].tiles){var c=g.config.ranges[a].tiles.x;var e=g.config.ranges[a].tiles.y}else if(null!=g.config.tiles)c=
g.config.tiles.x,e=g.config.tiles.y;else throw b='Error, can not found tiles inside font-config "'+g.path+g.jsonFilename+'"',fa.trace(b,{fileName:g.path+g.jsonFilename,lineNumber:0,className:"",methodName:""}),y.thrown(b);if(null!=g.config.ranges[a].line){var h=g.config.ranges[a].line.height/b.height*e;var d=g.config.ranges[a].line.base/b.height*e}else null!=g.config.line?(h=g.config.line.height/b.height*e,d=g.config.line.base/b.height*e):d=h=1;a=g.config.ranges[a].range;g.textureCache.setImage(b,
0,c,e);g.rangeMapping={min:a.min,max:a.max,height:h,base:d}},r=function(a){b(g)};null==h&&(h=!1);var q=a.length;d=0;for(f=a.length;d<f;){l=[d++];var v=[a[l[0]]];e=h;var V=null==n?null:function(a){return function(b,c){null!=n&&n(a[0],b,c)}}(l);l=null==r?null:function(a){return function(c){null!=C&&C(a[0],c);0==--q&&b(g)}}(l);null==e&&(e=!1);""!=Ya.corsServer&&(new D("^https?://","")).match(v[0])&&(v[0]="//"+Ya.corsServer+"/"+v[0]);var m=Ka.loadFromFile(v[0]);e&&(fa.trace('Start loading image "'+v[0]+
'"',{fileName:"utils/Loader.hx",lineNumber:28,className:"utils.Loader",methodName:"image"}),m.onProgress(function(a){return function(b,c){Ya.onProgressDebug(b,c,a[0])}}(v)),m.onError(Ya.onErrorDebug),m.onComplete(function(a){return function(b){Ya.onCompleteDebug(a[0])}}(v)));if(null!=V)m.onProgress(V);if(null!=l)m.onComplete(l)}},__class__:Se};var nf=function(){};d["peote.text.Gl3FontData"]=nf;nf.__name__=!0;var va=function(){this.bytePos=-1;this.weight=this.tilt=this.zIndex=this.width=this.height=
this.tile=0;this.bgColor=255;this.color=-1;this.x=this.y=0;this.char=-1};d["peote.text.Glyph__ob_gum_backends_PeoteView_FontStyle"]=va;va.__name__=!0;va.prototype={__class__:va};var Ga=function(){};d["peote.text.MaskElement"]=Ga;Ga.__name__=!0;var ie=function(a,b){this.min=a;this.max=b};d["peote.text.Range"]=ie;ie.__name__=!0;ie.prototype={__class__:ie};var pc=function(){};d["peote.view.BufferInterface"]=pc;pc.__name__=!0;pc.__isInterface__=!0;pc.prototype={__class__:pc};var Qd=function(a,b,c){null==
c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);I.isINSTANCED?(null==qa.instanceBytes&&(qa.instanceBytes=new Va(new ArrayBuffer(12)),qa.instanceBytes.b[0]=1,qa.instanceBytes.b[1]=1,qa.instanceBytes.b[2]=1,qa.instanceBytes.b[3]=
1,qa.instanceBytes.b[4]=0,qa.instanceBytes.b[5]=1,qa.instanceBytes.b[6]=1,qa.instanceBytes.b[7]=0,qa.instanceBytes.b[8]=0,qa.instanceBytes.b[9]=0,qa.instanceBytes.b[10]=0,qa.instanceBytes.b[11]=0),this._elemBuffSize=24):this._elemBuffSize=168;this._bytes=new Va(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_BackgroundElement"]=Qd;Qd.__name__=!0;Qd.__interfaces__=[pc];Qd.prototype={setNewGLContext:function(a){if(null!=
a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),I.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),I.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);I.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),
a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=qa.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));I.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(4),
a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,24,0),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,24,4),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,24,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,24,16),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,
!0,28,0),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,28,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,28,8),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,28,16),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,28,24)),this._gl.bindVertexArray(null))}},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( 0.0, aRotZ )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- rotZ.y,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color"]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return qa.DEFAULT_FORMULA_VARS},getFormulas:function(){return qa.FORMULAS},getAttributes:function(){return qa.ATTRIBUTES},getFormulaNames:function(){return qa.FORMULA_NAMES},getFormulaVaryings:function(){return""==qa.FORMULA_VARYINGS?[]:qa.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==qa.FORMULA_CONSTANTS?[]:qa.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==qa.FORMULA_CUSTOMS?[]:qa.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!0},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,4,"aColorStart0");a.bindAttribLocation(b,3,"aRotZ");
a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;I.isINSTANCED?(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,24,0),b.vertexAttribDivisor(4,
1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,24,4),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,24,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,24,16),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,
4,b.UNSIGNED_BYTE,!0,28,0),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,28,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,28,8),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,28,16),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,28,24)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));I.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(4),b.disableVertexAttribArray(3),
b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Qd};var Sd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);I.isINSTANCED?(null==ha.instanceBytes&&
(ha.instanceBytes=new Va(new ArrayBuffer(12)),ha.instanceBytes.b[0]=1,ha.instanceBytes.b[1]=1,ha.instanceBytes.b[2]=1,ha.instanceBytes.b[3]=1,ha.instanceBytes.b[4]=0,ha.instanceBytes.b[5]=1,ha.instanceBytes.b[6]=1,ha.instanceBytes.b[7]=0,ha.instanceBytes.b[8]=0,ha.instanceBytes.b[9]=0,ha.instanceBytes.b[10]=0,ha.instanceBytes.b[11]=0),this._elemBuffSize=16):this._elemBuffSize=96;this._bytes=new Va(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};d["peote.view.Buffer_FilterElement"]=Sd;Sd.__name__=!0;Sd.__interfaces__=[pc];Sd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),I.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),I.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,
b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);I.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=ha.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));I.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),
a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,4,a.UNSIGNED_BYTE,!0,16,0),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,16,4),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,16,8),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.SHORT,!1,16,12),a.vertexAttribDivisor(4,
1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,4,a.UNSIGNED_BYTE,!0,16,0),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,16,4),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,16,8),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.SHORT,!1,16,12),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,16,14)),this._gl.bindVertexArray(null))}},updateElement:function(a){if(I.isINSTANCED){var b=
this._bytes;b.b_Int32[a.bytePos>>2]=a.c;b.b_Uint16[a.bytePos+4>>1]=a.x&65535;b.b_Uint16[a.bytePos+6>>1]=a.y&65535;b.b_Uint16[a.bytePos+8>>1]=a.w&65535;b.b_Uint16[a.bytePos+10>>1]=a.h&65535;b.b_Uint16[a.bytePos+12>>1]=a.slot&65535}else b=this._bytes,b.b_Int32[a.bytePos>>2]=a.c,b.b_Uint16[a.bytePos+4>>1]=a.x&65535,b.b_Uint16[a.bytePos+6>>1]=a.y&65535,b.b_Uint16[a.bytePos+8>>1]=a.w&65535,b.b_Uint16[a.bytePos+10>>1]=a.h&65535,b.b_Uint16[a.bytePos+12>>1]=a.slot&65535,b.b[a.bytePos+14]=1,b.b[a.bytePos+
15]=1,b.b_Int32[a.bytePos+16>>2]=a.c,b.b_Uint16[a.bytePos+20>>1]=a.x&65535,b.b_Uint16[a.bytePos+22>>1]=a.y&65535,b.b_Uint16[a.bytePos+24>>1]=a.w&65535,b.b_Uint16[a.bytePos+26>>1]=a.h&65535,b.b_Uint16[a.bytePos+28>>1]=a.slot&65535,b.b[a.bytePos+30]=1,b.b[a.bytePos+31]=1,b.b_Int32[a.bytePos+32>>2]=a.c,b.b_Uint16[a.bytePos+36>>1]=a.x&65535,b.b_Uint16[a.bytePos+38>>1]=a.y&65535,b.b_Uint16[a.bytePos+40>>1]=a.w&65535,b.b_Uint16[a.bytePos+42>>1]=a.h&65535,b.b_Uint16[a.bytePos+44>>1]=a.slot&65535,b.b[a.bytePos+
46]=0,b.b[a.bytePos+47]=1,b.b_Int32[a.bytePos+48>>2]=a.c,b.b_Uint16[a.bytePos+52>>1]=a.x&65535,b.b_Uint16[a.bytePos+54>>1]=a.y&65535,b.b_Uint16[a.bytePos+56>>1]=a.w&65535,b.b_Uint16[a.bytePos+58>>1]=a.h&65535,b.b_Uint16[a.bytePos+60>>1]=a.slot&65535,b.b[a.bytePos+62]=1,b.b[a.bytePos+63]=0,b.b_Int32[a.bytePos+64>>2]=a.c,b.b_Uint16[a.bytePos+68>>1]=a.x&65535,b.b_Uint16[a.bytePos+70>>1]=a.y&65535,b.b_Uint16[a.bytePos+72>>1]=a.w&65535,b.b_Uint16[a.bytePos+74>>1]=a.h&65535,b.b_Uint16[a.bytePos+76>>1]=
a.slot&65535,b.b[a.bytePos+78]=0,b.b[a.bytePos+79]=0,b.b_Int32[a.bytePos+80>>2]=a.c,b.b_Uint16[a.bytePos+84>>1]=a.x&65535,b.b_Uint16[a.bytePos+86>>1]=a.y&65535,b.b_Uint16[a.bytePos+88>>1]=a.w&65535,b.b_Uint16[a.bytePos+90>>1]=a.h&65535,b.b_Uint16[a.bytePos+92>>1]=a.slot&65535,b.b[a.bytePos+94]=0,b.b[a.bytePos+95]=0;if(-1==a.bytePos)throw y.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,
a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw y.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=new Va(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var h=c++,d=this._elements[h];
e=this._bytes;var f=d.bytePos,l=this._elemBuffSize;null==l&&(l=0);null==f&&(f=0);e=0<l?new Uint8Array(e.b.bufferValue,f,l):new Uint8Array(e.b.bufferValue,f);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null),I.isVAO&&(this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,4,b.UNSIGNED_BYTE,!0,16,0),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,16,4),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,
2,b.SHORT,!1,16,8),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.SHORT,!1,16,12),b.vertexAttribDivisor(4,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,4,b.UNSIGNED_BYTE,!0,16,0),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,16,4),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,16,8),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.SHORT,!1,16,12),b.enableVertexAttribArray(0),
b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,16,14)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;f=a.bytePos;l=this._elemBuffSize;null==l&&(l=0);null==f&&(f=0);e=0<l?new Uint8Array(e.b.bufferValue,f,l):new Uint8Array(e.b.bufferValue,f);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw y.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t::IN:: float aShort0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VAROUT:: float vTexPack0;\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\tvTexPack0 = ::if FORMULA_VARYINGS.slot::::FORMULA_VARYINGS.slot::::else::aShort0::end::;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VARIN:: float vTexPack0;\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER == 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOT_WIDTH:: + floor(mod(vTexPack0, ::SLOTS_X::)) * ::SLOT_WIDTH::, vTexCoord.y * ::SLOT_HEIGHT:: + floor(floor(vTexPack0)/::SLOTS_X::) * ::SLOT_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t\t::if (LAYER >= 1)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER == 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t\t::if (LAYER >= 1)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER == 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOT_WIDTH:: + floor(mod(vTexPack0, ::SLOTS_X::)) * ::SLOT_WIDTH::, vTexCoord.y * ::SLOT_HEIGHT:: + floor(floor(vTexPack0)/::SLOTS_X::) * ::SLOT_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 1)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return["base"]},getColorIdentifiers:function(){return["c"]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return ha.DEFAULT_FORMULA_VARS},getFormulas:function(){return ha.FORMULAS},getAttributes:function(){return ha.ATTRIBUTES},getFormulaNames:function(){return ha.FORMULA_NAMES},getFormulaVaryings:function(){return""==ha.FORMULA_VARYINGS?[]:ha.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==ha.FORMULA_CONSTANTS?[]:ha.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==ha.FORMULA_CUSTOMS?[]:ha.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,3,"aColorStart0");a.bindAttribLocation(b,1,"aPos");
a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,4,"aShort0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;I.isINSTANCED?(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,4,b.UNSIGNED_BYTE,!0,16,0),b.vertexAttribDivisor(3,
1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,16,4),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,16,8),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.SHORT,!1,16,12),b.vertexAttribDivisor(4,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,
4,b.UNSIGNED_BYTE,!0,16,0),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,16,4),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,16,8),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.SHORT,!1,16,12),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,16,14)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));I.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(3),b.disableVertexAttribArray(1),
b.disableVertexAttribArray(2),b.disableVertexAttribArray(4));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Sd};var Od=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);I.isINSTANCED?(null==va.instanceBytes&&
(va.instanceBytes=new Va(new ArrayBuffer(12)),va.instanceBytes.b[0]=1,va.instanceBytes.b[1]=1,va.instanceBytes.b[2]=1,va.instanceBytes.b[3]=1,va.instanceBytes.b[4]=0,va.instanceBytes.b[5]=1,va.instanceBytes.b[6]=1,va.instanceBytes.b[7]=0,va.instanceBytes.b[8]=0,va.instanceBytes.b[9]=0,va.instanceBytes.b[10]=0,va.instanceBytes.b[11]=0),this._elemBuffSize=40):this._elemBuffSize=240;this._bytes=new Va(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};d["peote.view.Buffer_Glyph__ob_gum_backends_PeoteView_FontStyle"]=Od;Od.__name__=!0;Od.__interfaces__=[pc];Od.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),I.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),I.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,
0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);I.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=va.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));I.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(a=this._gl,b=this._glBuffer,
a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,40,0),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,4),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,40,8),a.vertexAttribDivisor(3,1),a.enableVertexAttribArray(1),
a.vertexAttribPointer(1,2,a.FLOAT,!1,40,12),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,20),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,28),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,1,a.SHORT,!1,40,36),a.vertexAttribDivisor(7,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,4,a.UNSIGNED_BYTE,!0,
40,0),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,4),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,1,a.FLOAT,!1,40,8),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,12),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.FLOAT,!1,40,20),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,28),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,1,a.SHORT,!1,40,36),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,
2,a.UNSIGNED_BYTE,!1,40,38)),this._gl.bindVertexArray(null))}},update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(I.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.color;e.b_Int32[c.bytePos+4>>2]=c.bgColor;e.b_UFloat32[c.bytePos+8>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151));e.b_UFloat32[c.bytePos+12>>2]=c.x;e.b_UFloat32[c.bytePos+16>>2]=c.y;e.b_UFloat32[c.bytePos+20>>2]=c.width;e.b_UFloat32[c.bytePos+24>>2]=c.height;e.b_UFloat32[c.bytePos+28>>2]=c.weight;
e.b_UFloat32[c.bytePos+32>>2]=c.tilt;e.b_Uint16[c.bytePos+36>>1]=c.tile&65535}else c=this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.color,e.b_Int32[c.bytePos+4>>2]=c.bgColor,e.b_UFloat32[c.bytePos+8>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+12>>2]=c.x,e.b_UFloat32[c.bytePos+16>>2]=c.y,e.b_UFloat32[c.bytePos+20>>2]=c.width,e.b_UFloat32[c.bytePos+24>>2]=c.height,e.b_UFloat32[c.bytePos+28>>2]=c.weight,e.b_UFloat32[c.bytePos+32>>2]=c.tilt,e.b_Uint16[c.bytePos+36>>
1]=c.tile&65535,e.b[c.bytePos+38]=1,e.b[c.bytePos+39]=1,e.b_Int32[c.bytePos+40>>2]=c.color,e.b_Int32[c.bytePos+44>>2]=c.bgColor,e.b_UFloat32[c.bytePos+48>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+52>>2]=c.x,e.b_UFloat32[c.bytePos+56>>2]=c.y,e.b_UFloat32[c.bytePos+60>>2]=c.width,e.b_UFloat32[c.bytePos+64>>2]=c.height,e.b_UFloat32[c.bytePos+68>>2]=c.weight,e.b_UFloat32[c.bytePos+72>>2]=c.tilt,e.b_Uint16[c.bytePos+76>>1]=c.tile&65535,e.b[c.bytePos+78]=1,e.b[c.bytePos+79]=1,
e.b_Int32[c.bytePos+80>>2]=c.color,e.b_Int32[c.bytePos+84>>2]=c.bgColor,e.b_UFloat32[c.bytePos+88>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+92>>2]=c.x,e.b_UFloat32[c.bytePos+96>>2]=c.y,e.b_UFloat32[c.bytePos+100>>2]=c.width,e.b_UFloat32[c.bytePos+104>>2]=c.height,e.b_UFloat32[c.bytePos+108>>2]=c.weight,e.b_UFloat32[c.bytePos+112>>2]=c.tilt,e.b_Uint16[c.bytePos+116>>1]=c.tile&65535,e.b[c.bytePos+118]=0,e.b[c.bytePos+119]=1,e.b_Int32[c.bytePos+120>>2]=c.color,e.b_Int32[c.bytePos+
124>>2]=c.bgColor,e.b_UFloat32[c.bytePos+128>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+132>>2]=c.x,e.b_UFloat32[c.bytePos+136>>2]=c.y,e.b_UFloat32[c.bytePos+140>>2]=c.width,e.b_UFloat32[c.bytePos+144>>2]=c.height,e.b_UFloat32[c.bytePos+148>>2]=c.weight,e.b_UFloat32[c.bytePos+152>>2]=c.tilt,e.b_Uint16[c.bytePos+156>>1]=c.tile&65535,e.b[c.bytePos+158]=1,e.b[c.bytePos+159]=0,e.b_Int32[c.bytePos+160>>2]=c.color,e.b_Int32[c.bytePos+164>>2]=c.bgColor,e.b_UFloat32[c.bytePos+168>>
2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),e.b_UFloat32[c.bytePos+172>>2]=c.x,e.b_UFloat32[c.bytePos+176>>2]=c.y,e.b_UFloat32[c.bytePos+180>>2]=c.width,e.b_UFloat32[c.bytePos+184>>2]=c.height,e.b_UFloat32[c.bytePos+188>>2]=c.weight,e.b_UFloat32[c.bytePos+192>>2]=c.tilt,e.b_Uint16[c.bytePos+196>>1]=c.tile&65535,e.b[c.bytePos+198]=0,e.b[c.bytePos+199]=0,e.b_Int32[c.bytePos+200>>2]=c.color,e.b_Int32[c.bytePos+204>>2]=c.bgColor,e.b_UFloat32[c.bytePos+208>>2]=Math.min(1,Math.max(-1,c.zIndex/2097151)),
e.b_UFloat32[c.bytePos+212>>2]=c.x,e.b_UFloat32[c.bytePos+216>>2]=c.y,e.b_UFloat32[c.bytePos+220>>2]=c.width,e.b_UFloat32[c.bytePos+224>>2]=c.height,e.b_UFloat32[c.bytePos+228>>2]=c.weight,e.b_UFloat32[c.bytePos+232>>2]=c.tilt,e.b_Uint16[c.bytePos+236>>1]=c.tile&65535,e.b[c.bytePos+238]=0,e.b[c.bytePos+239]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,
null)},updateElement:function(a){if(I.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.color;b.b_Int32[a.bytePos+4>>2]=a.bgColor;b.b_UFloat32[a.bytePos+8>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151));b.b_UFloat32[a.bytePos+12>>2]=a.x;b.b_UFloat32[a.bytePos+16>>2]=a.y;b.b_UFloat32[a.bytePos+20>>2]=a.width;b.b_UFloat32[a.bytePos+24>>2]=a.height;b.b_UFloat32[a.bytePos+28>>2]=a.weight;b.b_UFloat32[a.bytePos+32>>2]=a.tilt;b.b_Uint16[a.bytePos+36>>1]=a.tile&65535}else b=this._bytes,b.b_Int32[a.bytePos>>
2]=a.color,b.b_Int32[a.bytePos+4>>2]=a.bgColor,b.b_UFloat32[a.bytePos+8>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+12>>2]=a.x,b.b_UFloat32[a.bytePos+16>>2]=a.y,b.b_UFloat32[a.bytePos+20>>2]=a.width,b.b_UFloat32[a.bytePos+24>>2]=a.height,b.b_UFloat32[a.bytePos+28>>2]=a.weight,b.b_UFloat32[a.bytePos+32>>2]=a.tilt,b.b_Uint16[a.bytePos+36>>1]=a.tile&65535,b.b[a.bytePos+38]=1,b.b[a.bytePos+39]=1,b.b_Int32[a.bytePos+40>>2]=a.color,b.b_Int32[a.bytePos+44>>2]=a.bgColor,b.b_UFloat32[a.bytePos+
48>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+52>>2]=a.x,b.b_UFloat32[a.bytePos+56>>2]=a.y,b.b_UFloat32[a.bytePos+60>>2]=a.width,b.b_UFloat32[a.bytePos+64>>2]=a.height,b.b_UFloat32[a.bytePos+68>>2]=a.weight,b.b_UFloat32[a.bytePos+72>>2]=a.tilt,b.b_Uint16[a.bytePos+76>>1]=a.tile&65535,b.b[a.bytePos+78]=1,b.b[a.bytePos+79]=1,b.b_Int32[a.bytePos+80>>2]=a.color,b.b_Int32[a.bytePos+84>>2]=a.bgColor,b.b_UFloat32[a.bytePos+88>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+
92>>2]=a.x,b.b_UFloat32[a.bytePos+96>>2]=a.y,b.b_UFloat32[a.bytePos+100>>2]=a.width,b.b_UFloat32[a.bytePos+104>>2]=a.height,b.b_UFloat32[a.bytePos+108>>2]=a.weight,b.b_UFloat32[a.bytePos+112>>2]=a.tilt,b.b_Uint16[a.bytePos+116>>1]=a.tile&65535,b.b[a.bytePos+118]=0,b.b[a.bytePos+119]=1,b.b_Int32[a.bytePos+120>>2]=a.color,b.b_Int32[a.bytePos+124>>2]=a.bgColor,b.b_UFloat32[a.bytePos+128>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+132>>2]=a.x,b.b_UFloat32[a.bytePos+136>>2]=a.y,
b.b_UFloat32[a.bytePos+140>>2]=a.width,b.b_UFloat32[a.bytePos+144>>2]=a.height,b.b_UFloat32[a.bytePos+148>>2]=a.weight,b.b_UFloat32[a.bytePos+152>>2]=a.tilt,b.b_Uint16[a.bytePos+156>>1]=a.tile&65535,b.b[a.bytePos+158]=1,b.b[a.bytePos+159]=0,b.b_Int32[a.bytePos+160>>2]=a.color,b.b_Int32[a.bytePos+164>>2]=a.bgColor,b.b_UFloat32[a.bytePos+168>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+172>>2]=a.x,b.b_UFloat32[a.bytePos+176>>2]=a.y,b.b_UFloat32[a.bytePos+180>>2]=a.width,b.b_UFloat32[a.bytePos+
184>>2]=a.height,b.b_UFloat32[a.bytePos+188>>2]=a.weight,b.b_UFloat32[a.bytePos+192>>2]=a.tilt,b.b_Uint16[a.bytePos+196>>1]=a.tile&65535,b.b[a.bytePos+198]=0,b.b[a.bytePos+199]=0,b.b_Int32[a.bytePos+200>>2]=a.color,b.b_Int32[a.bytePos+204>>2]=a.bgColor,b.b_UFloat32[a.bytePos+208>>2]=Math.min(1,Math.max(-1,a.zIndex/2097151)),b.b_UFloat32[a.bytePos+212>>2]=a.x,b.b_UFloat32[a.bytePos+216>>2]=a.y,b.b_UFloat32[a.bytePos+220>>2]=a.width,b.b_UFloat32[a.bytePos+224>>2]=a.height,b.b_UFloat32[a.bytePos+228>>
2]=a.weight,b.b_UFloat32[a.bytePos+232>>2]=a.tilt,b.b_Uint16[a.bytePos+236>>1]=a.tile&65535,b.b[a.bytePos+238]=0,b.b[a.bytePos+239]=0;if(-1==a.bytePos)throw y.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw y.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");
var b=this._maxElements+this._growSize,c=new Va(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var h=c++,d=this._elements[h];e=this._bytes;var f=d.bytePos,l=this._elemBuffSize;null==l&&(l=0);null==f&&(f=0);e=0<l?new Uint8Array(e.b.bufferValue,f,l):new Uint8Array(e.b.bufferValue,f);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),
this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),I.isVAO&&(this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,
c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.vertexAttribDivisor(2,
1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.vertexAttribDivisor(7,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.enableVertexAttribArray(1),
b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,38)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;f=a.bytePos;l=this._elemBuffSize;null==l&&(l=0);null==f&&(f=0);
e=0<l?new Uint8Array(e.b.bufferValue,f,l):new Uint8Array(e.b.bufferValue,f);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw y.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t\n\t\n\t::IN:: vec4 aColorStart0;::IN:: vec4 aColorStart1;\n\t\n\t::IN:: vec2 aFloat0;::IN:: float aShort0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;::if isES3::flat ::end::::VAROUT:: vec4 vColor1;\n\t::if isES3::flat ::end::::VAROUT:: vec2 vSize; ::if isES3::flat ::end:: ::VAROUT:: float vPack0;\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VAROUT:: float vTexPack0;\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;vSize = size;\n\t\t\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( 0.0, aRotZ )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\tvColor0 = aColorStart0.wzyx; vColor1 = aColorStart1.wzyx; \n\n\t\tvPack0 = ::if FORMULA_VARYINGS.weight::::FORMULA_VARYINGS.weight::::else::aFloat0.x::end::;\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\tvTexPack0 = ::if FORMULA_VARYINGS.tile::::FORMULA_VARYINGS.tile::::else::aShort0::end::;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- rotZ.y,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; ::if isES3::flat ::end::::VARIN:: vec4 vColor1; \n\t::if isES3::flat ::end::::VARIN:: vec2 vSize; ::if isES3::flat ::end:: ::VARIN:: float vPack0;\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VARIN:: float vTexPack0;\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; vec4 c1 = vColor1; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color","bgColor"]},getCustomIdentifiers:function(){return["weight","tilt"]},getCustomVaryings:function(){return["vPack0","null"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return va.DEFAULT_FORMULA_VARS},getFormulas:function(){return va.FORMULAS},getAttributes:function(){return va.ATTRIBUTES},getFormulaNames:function(){return va.FORMULA_NAMES},getFormulaVaryings:function(){return""==
va.FORMULA_VARYINGS?[]:va.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==va.FORMULA_CONSTANTS?[]:va.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==va.FORMULA_CUSTOMS?[]:va.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!0},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!0},bindAttribLocations:function(a,b){a.bindAttribLocation(b,
4,"aColorStart0");a.bindAttribLocation(b,5,"aColorStart1");a.bindAttribLocation(b,3,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,7,"aShort0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;I.isINSTANCED?(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,
2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,
2,b.FLOAT,!1,40,20),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.vertexAttribDivisor(7,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(5),
b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,4),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,1,b.FLOAT,!1,40,8),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,12),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.FLOAT,!1,40,20),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,28),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,1,b.SHORT,!1,40,36),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,38)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,
0,6*a));I.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(4),b.disableVertexAttribArray(5),b.disableVertexAttribArray(3),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),b.disableVertexAttribArray(6),b.disableVertexAttribArray(7));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Od};var Pd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=
this._glVAO=null;if(0>=a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);I.isINSTANCED?(null==Ga.instanceBytes&&(Ga.instanceBytes=new Va(new ArrayBuffer(12)),Ga.instanceBytes.b[0]=1,Ga.instanceBytes.b[1]=1,Ga.instanceBytes.b[2]=1,Ga.instanceBytes.b[3]=1,Ga.instanceBytes.b[4]=0,Ga.instanceBytes.b[5]=1,Ga.instanceBytes.b[6]=1,Ga.instanceBytes.b[7]=0,Ga.instanceBytes.b[8]=
0,Ga.instanceBytes.b[9]=0,Ga.instanceBytes.b[10]=0,Ga.instanceBytes.b[11]=0),this._elemBuffSize=8):this._elemBuffSize=72;this._bytes=new Va(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_MaskElement"]=Pd;Pd.__name__=!0;Pd.__interfaces__=[pc];Pd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),I.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),
I.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);I.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=Ga.instanceBytes,b=new Uint8Array(b.b.bufferValue,
0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));I.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,8,0),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,8,4),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,12,0),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,12,4),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null))}},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\t\n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t\n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\t\n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return[]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return Ga.DEFAULT_FORMULA_VARS},getFormulas:function(){return Ga.FORMULAS},getAttributes:function(){return Ga.ATTRIBUTES},getFormulaNames:function(){return Ga.FORMULA_NAMES},getFormulaVaryings:function(){return""==Ga.FORMULA_VARYINGS?[]:Ga.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==Ga.FORMULA_CONSTANTS?[]:Ga.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==Ga.FORMULA_CUSTOMS?[]:Ga.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,
0,"aPosition")},render:function(a,b,c){a=this._maxElements;I.isINSTANCED?(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,
1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));I.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),
b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Pd};var Td=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);I.isINSTANCED?(null==ta.instanceBytes&&
(ta.instanceBytes=new Va(new ArrayBuffer(12)),ta.instanceBytes.b[0]=1,ta.instanceBytes.b[1]=1,ta.instanceBytes.b[2]=1,ta.instanceBytes.b[3]=1,ta.instanceBytes.b[4]=0,ta.instanceBytes.b[5]=1,ta.instanceBytes.b[6]=1,ta.instanceBytes.b[7]=0,ta.instanceBytes.b[8]=0,ta.instanceBytes.b[9]=0,ta.instanceBytes.b[10]=0,ta.instanceBytes.b[11]=0),this._elemBuffSize=36):this._elemBuffSize=240;this._bytes=new Va(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};d["peote.view.Buffer_Shape"]=Td;Td.__name__=!0;Td.__interfaces__=[pc];Td.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),I.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),I.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,
b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);I.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=ta.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));I.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),
a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,36,0),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,36,4),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,36,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,36,16),a.vertexAttribDivisor(3,
1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,36,24),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,36,32),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,40,0),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,40,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,40,8),a.enableVertexAttribArray(3),
a.vertexAttribPointer(3,2,a.FLOAT,!1,40,16),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,2,a.FLOAT,!1,40,24),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,40,32),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,40,36)),this._gl.bindVertexArray(null))}},update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(I.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.color;e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*
Math.PI;e.b_UFloat32[c.bytePos+8>>2]=c.x;e.b_UFloat32[c.bytePos+12>>2]=c.y;e.b_UFloat32[c.bytePos+16>>2]=c.px_offset;e.b_UFloat32[c.bytePos+20>>2]=c.py_offset;e.b_UFloat32[c.bytePos+24>>2]=c.sides;e.b_UFloat32[c.bytePos+28>>2]=c.shape;e.b_Uint16[c.bytePos+32>>1]=c.w&65535;e.b_Uint16[c.bytePos+34>>1]=c.h&65535}else c=this._elements[c],e=this._bytes,e.b_Int32[c.bytePos>>2]=c.color,e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+8>>2]=c.x,e.b_UFloat32[c.bytePos+12>>2]=c.y,
e.b_UFloat32[c.bytePos+16>>2]=c.px_offset,e.b_UFloat32[c.bytePos+20>>2]=c.py_offset,e.b_UFloat32[c.bytePos+24>>2]=c.sides,e.b_UFloat32[c.bytePos+28>>2]=c.shape,e.b_Uint16[c.bytePos+32>>1]=c.w&65535,e.b_Uint16[c.bytePos+34>>1]=c.h&65535,e.b[c.bytePos+36]=1,e.b[c.bytePos+37]=1,e.b_Int32[c.bytePos+40>>2]=c.color,e.b_UFloat32[c.bytePos+44>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+48>>2]=c.x,e.b_UFloat32[c.bytePos+52>>2]=c.y,e.b_UFloat32[c.bytePos+56>>2]=c.px_offset,e.b_UFloat32[c.bytePos+60>>
2]=c.py_offset,e.b_UFloat32[c.bytePos+64>>2]=c.sides,e.b_UFloat32[c.bytePos+68>>2]=c.shape,e.b_Uint16[c.bytePos+72>>1]=c.w&65535,e.b_Uint16[c.bytePos+74>>1]=c.h&65535,e.b[c.bytePos+76]=1,e.b[c.bytePos+77]=1,e.b_Int32[c.bytePos+80>>2]=c.color,e.b_UFloat32[c.bytePos+84>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+88>>2]=c.x,e.b_UFloat32[c.bytePos+92>>2]=c.y,e.b_UFloat32[c.bytePos+96>>2]=c.px_offset,e.b_UFloat32[c.bytePos+100>>2]=c.py_offset,e.b_UFloat32[c.bytePos+104>>2]=c.sides,e.b_UFloat32[c.bytePos+
108>>2]=c.shape,e.b_Uint16[c.bytePos+112>>1]=c.w&65535,e.b_Uint16[c.bytePos+114>>1]=c.h&65535,e.b[c.bytePos+116]=0,e.b[c.bytePos+117]=1,e.b_Int32[c.bytePos+120>>2]=c.color,e.b_UFloat32[c.bytePos+124>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+128>>2]=c.x,e.b_UFloat32[c.bytePos+132>>2]=c.y,e.b_UFloat32[c.bytePos+136>>2]=c.px_offset,e.b_UFloat32[c.bytePos+140>>2]=c.py_offset,e.b_UFloat32[c.bytePos+144>>2]=c.sides,e.b_UFloat32[c.bytePos+148>>2]=c.shape,e.b_Uint16[c.bytePos+152>>1]=c.w&65535,e.b_Uint16[c.bytePos+
154>>1]=c.h&65535,e.b[c.bytePos+156]=1,e.b[c.bytePos+157]=0,e.b_Int32[c.bytePos+160>>2]=c.color,e.b_UFloat32[c.bytePos+164>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+168>>2]=c.x,e.b_UFloat32[c.bytePos+172>>2]=c.y,e.b_UFloat32[c.bytePos+176>>2]=c.px_offset,e.b_UFloat32[c.bytePos+180>>2]=c.py_offset,e.b_UFloat32[c.bytePos+184>>2]=c.sides,e.b_UFloat32[c.bytePos+188>>2]=c.shape,e.b_Uint16[c.bytePos+192>>1]=c.w&65535,e.b_Uint16[c.bytePos+194>>1]=c.h&65535,e.b[c.bytePos+196]=0,e.b[c.bytePos+197]=
0,e.b_Int32[c.bytePos+200>>2]=c.color,e.b_UFloat32[c.bytePos+204>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+208>>2]=c.x,e.b_UFloat32[c.bytePos+212>>2]=c.y,e.b_UFloat32[c.bytePos+216>>2]=c.px_offset,e.b_UFloat32[c.bytePos+220>>2]=c.py_offset,e.b_UFloat32[c.bytePos+224>>2]=c.sides,e.b_UFloat32[c.bytePos+228>>2]=c.shape,e.b_Uint16[c.bytePos+232>>1]=c.w&65535,e.b_Uint16[c.bytePos+234>>1]=c.h&65535,e.b[c.bytePos+236]=0,e.b[c.bytePos+237]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);
e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},updateElement:function(a){if(I.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.color;b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI;b.b_UFloat32[a.bytePos+8>>2]=a.x;b.b_UFloat32[a.bytePos+12>>2]=a.y;b.b_UFloat32[a.bytePos+16>>2]=a.px_offset;b.b_UFloat32[a.bytePos+20>>2]=a.py_offset;b.b_UFloat32[a.bytePos+24>>2]=a.sides;b.b_UFloat32[a.bytePos+
28>>2]=a.shape;b.b_Uint16[a.bytePos+32>>1]=a.w&65535;b.b_Uint16[a.bytePos+34>>1]=a.h&65535}else b=this._bytes,b.b_Int32[a.bytePos>>2]=a.color,b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+8>>2]=a.x,b.b_UFloat32[a.bytePos+12>>2]=a.y,b.b_UFloat32[a.bytePos+16>>2]=a.px_offset,b.b_UFloat32[a.bytePos+20>>2]=a.py_offset,b.b_UFloat32[a.bytePos+24>>2]=a.sides,b.b_UFloat32[a.bytePos+28>>2]=a.shape,b.b_Uint16[a.bytePos+32>>1]=a.w&65535,b.b_Uint16[a.bytePos+34>>1]=a.h&65535,b.b[a.bytePos+
36]=1,b.b[a.bytePos+37]=1,b.b_Int32[a.bytePos+40>>2]=a.color,b.b_UFloat32[a.bytePos+44>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+48>>2]=a.x,b.b_UFloat32[a.bytePos+52>>2]=a.y,b.b_UFloat32[a.bytePos+56>>2]=a.px_offset,b.b_UFloat32[a.bytePos+60>>2]=a.py_offset,b.b_UFloat32[a.bytePos+64>>2]=a.sides,b.b_UFloat32[a.bytePos+68>>2]=a.shape,b.b_Uint16[a.bytePos+72>>1]=a.w&65535,b.b_Uint16[a.bytePos+74>>1]=a.h&65535,b.b[a.bytePos+76]=1,b.b[a.bytePos+77]=1,b.b_Int32[a.bytePos+80>>2]=a.color,b.b_UFloat32[a.bytePos+
84>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+88>>2]=a.x,b.b_UFloat32[a.bytePos+92>>2]=a.y,b.b_UFloat32[a.bytePos+96>>2]=a.px_offset,b.b_UFloat32[a.bytePos+100>>2]=a.py_offset,b.b_UFloat32[a.bytePos+104>>2]=a.sides,b.b_UFloat32[a.bytePos+108>>2]=a.shape,b.b_Uint16[a.bytePos+112>>1]=a.w&65535,b.b_Uint16[a.bytePos+114>>1]=a.h&65535,b.b[a.bytePos+116]=0,b.b[a.bytePos+117]=1,b.b_Int32[a.bytePos+120>>2]=a.color,b.b_UFloat32[a.bytePos+124>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+128>>2]=
a.x,b.b_UFloat32[a.bytePos+132>>2]=a.y,b.b_UFloat32[a.bytePos+136>>2]=a.px_offset,b.b_UFloat32[a.bytePos+140>>2]=a.py_offset,b.b_UFloat32[a.bytePos+144>>2]=a.sides,b.b_UFloat32[a.bytePos+148>>2]=a.shape,b.b_Uint16[a.bytePos+152>>1]=a.w&65535,b.b_Uint16[a.bytePos+154>>1]=a.h&65535,b.b[a.bytePos+156]=1,b.b[a.bytePos+157]=0,b.b_Int32[a.bytePos+160>>2]=a.color,b.b_UFloat32[a.bytePos+164>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+168>>2]=a.x,b.b_UFloat32[a.bytePos+172>>2]=a.y,b.b_UFloat32[a.bytePos+
176>>2]=a.px_offset,b.b_UFloat32[a.bytePos+180>>2]=a.py_offset,b.b_UFloat32[a.bytePos+184>>2]=a.sides,b.b_UFloat32[a.bytePos+188>>2]=a.shape,b.b_Uint16[a.bytePos+192>>1]=a.w&65535,b.b_Uint16[a.bytePos+194>>1]=a.h&65535,b.b[a.bytePos+196]=0,b.b[a.bytePos+197]=0,b.b_Int32[a.bytePos+200>>2]=a.color,b.b_UFloat32[a.bytePos+204>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+208>>2]=a.x,b.b_UFloat32[a.bytePos+212>>2]=a.y,b.b_UFloat32[a.bytePos+216>>2]=a.px_offset,b.b_UFloat32[a.bytePos+220>>2]=a.py_offset,
b.b_UFloat32[a.bytePos+224>>2]=a.sides,b.b_UFloat32[a.bytePos+228>>2]=a.shape,b.b_Uint16[a.bytePos+232>>1]=a.w&65535,b.b_Uint16[a.bytePos+234>>1]=a.h&65535,b.b[a.bytePos+236]=0,b.b[a.bytePos+237]=0;if(-1==a.bytePos)throw y.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==
this._growSize)throw y.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=new Va(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var h=c++,d=this._elements[h];e=this._bytes;var f=d.bytePos,l=this._elemBuffSize;null==l&&(l=0);null==f&&(f=0);e=0<l?new Uint8Array(e.b.bufferValue,f,l):new Uint8Array(e.b.bufferValue,
f);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),I.isVAO&&(this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),
b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,36,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,36,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,36,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,36,16),b.vertexAttribDivisor(3,
1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,36,24),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,36,32),b.vertexAttribDivisor(2,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.enableVertexAttribArray(3),
b.vertexAttribPointer(3,2,b.FLOAT,!1,40,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,24),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,40,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,36)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;f=a.bytePos;l=this._elemBuffSize;null==l&&(l=0);null==f&&(f=0);e=0<l?new Uint8Array(e.b.bufferValue,f,l):new Uint8Array(e.b.bufferValue,
f);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw y.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t::IN:: vec2 aPivot;\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t::IN:: vec2 aFloat0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t::if isES3::flat ::end::::VAROUT:: vec2 vSize; ::if isES3::flat ::end:: ::VAROUT:: vec2 vPack0;\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;vSize = size;\n\t\tvec2 pivot = ::if PIVOT_FORMULA::::PIVOT_FORMULA::::else::vec2((aSize.x) * 0.5 + (aPivot.x), (aSize.y) * 0.5 + (aPivot.y))::end::;\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( aRotZ, 0.0 )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + (aPosition * size - pivot) * mat2( vec2(cos(rotZ.x), -sin(rotZ.x)), vec2(sin(rotZ.x), cos(rotZ.x)) );\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\tvPack0.x = ::if FORMULA_VARYINGS.sides::::FORMULA_VARYINGS.sides::::else::aFloat0.x::end::;vPack0.y = ::if FORMULA_VARYINGS.shape::::FORMULA_VARYINGS.shape::::else::aFloat0.y::end::;\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t::if isES3::flat ::end::::VARIN:: vec2 vSize; ::if isES3::flat ::end:: ::VARIN:: vec2 vPack0;\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return["color"]},getCustomIdentifiers:function(){return["sides","shape"]},getCustomVaryings:function(){return["vPack0.x","vPack0.y"]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return ta.DEFAULT_FORMULA_VARS},getFormulas:function(){return ta.FORMULAS},getAttributes:function(){return ta.ATTRIBUTES},getFormulaNames:function(){return ta.FORMULA_NAMES},getFormulaVaryings:function(){return""==ta.FORMULA_VARYINGS?
[]:ta.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==ta.FORMULA_CONSTANTS?[]:ta.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==ta.FORMULA_CUSTOMS?[]:ta.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!0},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,5,"aColorStart0");
a.bindAttribLocation(b,4,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,3,"aPivot");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;I.isINSTANCED?(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,
c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,36,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,36,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,36,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,36,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,36,24),b.vertexAttribDivisor(6,
1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,36,32),b.vertexAttribDivisor(2,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,40,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,40,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,40,8),b.enableVertexAttribArray(3),
b.vertexAttribPointer(3,2,b.FLOAT,!1,40,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,2,b.FLOAT,!1,40,24),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,40,32),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,40,36)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));I.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(5),b.disableVertexAttribArray(4),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),
b.disableVertexAttribArray(3),b.disableVertexAttribArray(6));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Td};var Ud=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=Array(this._minSize);I.isINSTANCED?(null==ra.instanceBytes&&
(ra.instanceBytes=new Va(new ArrayBuffer(12)),ra.instanceBytes.b[0]=1,ra.instanceBytes.b[1]=1,ra.instanceBytes.b[2]=1,ra.instanceBytes.b[3]=1,ra.instanceBytes.b[4]=0,ra.instanceBytes.b[5]=1,ra.instanceBytes.b[6]=1,ra.instanceBytes.b[7]=0,ra.instanceBytes.b[8]=0,ra.instanceBytes.b[9]=0,ra.instanceBytes.b[10]=0,ra.instanceBytes.b[11]=0),this._elemBuffSize=60):this._elemBuffSize=384;this._bytes=new Va(new ArrayBuffer(this._elemBuffSize*this._minSize));this._bytes.fill(0,this._elemBuffSize*this._minSize,
0)};d["peote.view.Buffer_Sprite"]=Ud;Ud.__name__=!0;Ud.__interfaces__=[pc];Ud.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),I.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),I.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,0);this._gl.bufferData(this._gl.ARRAY_BUFFER,
b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);I.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=ra.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));I.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(a=this._gl,b=this._glBuffer,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),
a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,4,a.UNSIGNED_BYTE,!0,60,0),a.vertexAttribDivisor(5,1),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,60,4),a.vertexAttribDivisor(4,1),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,60,8),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,60,16),a.vertexAttribDivisor(3,
1),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,4,a.FLOAT,!1,60,24),a.vertexAttribDivisor(6,1),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,3,a.FLOAT,!1,60,40),a.vertexAttribDivisor(7,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,60,52),a.vertexAttribDivisor(2,1),a.enableVertexAttribArray(8),a.vertexAttribPointer(8,2,a.SHORT,!1,60,56),a.vertexAttribDivisor(8,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(5),a.vertexAttribPointer(5,
4,a.UNSIGNED_BYTE,!0,64,0),a.enableVertexAttribArray(4),a.vertexAttribPointer(4,1,a.FLOAT,!1,64,4),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.FLOAT,!1,64,8),a.enableVertexAttribArray(3),a.vertexAttribPointer(3,2,a.FLOAT,!1,64,16),a.enableVertexAttribArray(6),a.vertexAttribPointer(6,4,a.FLOAT,!1,64,24),a.enableVertexAttribArray(7),a.vertexAttribPointer(7,3,a.FLOAT,!1,64,40),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,64,52),a.enableVertexAttribArray(8),a.vertexAttribPointer(8,
2,a.SHORT,!1,64,56),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,64,60)),this._gl.bindVertexArray(null))}},update:function(){for(var a=0,b=this._maxElements;a<b;){var c=a++;if(I.isINSTANCED){c=this._elements[c];var e=this._bytes;e.b_Int32[c.bytePos>>2]=c.c;e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI;e.b_UFloat32[c.bytePos+8>>2]=c.x;e.b_UFloat32[c.bytePos+12>>2]=c.y;e.b_UFloat32[c.bytePos+16>>2]=c.px_offset;e.b_UFloat32[c.bytePos+20>>2]=c.py_offset;e.b_UFloat32[c.bytePos+
24>>2]=c.shakeAtTime;e.b_UFloat32[c.bytePos+28>>2]=c.shakeFrequencyY;e.b_UFloat32[c.bytePos+32>>2]=c.shakeFrequencyX;e.b_UFloat32[c.bytePos+36>>2]=c.shakeDistanceY;e.b_UFloat32[c.bytePos+40>>2]=c.shakeDistanceX;e.b_UFloat32[c.bytePos+44>>2]=c.shakeDurationX;e.b_UFloat32[c.bytePos+48>>2]=c.shakeDurationY;e.b_Uint16[c.bytePos+52>>1]=c.w&65535;e.b_Uint16[c.bytePos+54>>1]=c.h&65535;e.b_Uint16[c.bytePos+56>>1]=c.slot&65535;e.b_Uint16[c.bytePos+58>>1]=c.tile&65535}else c=this._elements[c],e=this._bytes,
e.b_Int32[c.bytePos>>2]=c.c,e.b_UFloat32[c.bytePos+4>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+8>>2]=c.x,e.b_UFloat32[c.bytePos+12>>2]=c.y,e.b_UFloat32[c.bytePos+16>>2]=c.px_offset,e.b_UFloat32[c.bytePos+20>>2]=c.py_offset,e.b_UFloat32[c.bytePos+24>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+28>>2]=c.shakeFrequencyY,e.b_UFloat32[c.bytePos+32>>2]=c.shakeFrequencyX,e.b_UFloat32[c.bytePos+36>>2]=c.shakeDistanceY,e.b_UFloat32[c.bytePos+40>>2]=c.shakeDistanceX,e.b_UFloat32[c.bytePos+44>>2]=c.shakeDurationX,
e.b_UFloat32[c.bytePos+48>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+52>>1]=c.w&65535,e.b_Uint16[c.bytePos+54>>1]=c.h&65535,e.b_Uint16[c.bytePos+56>>1]=c.slot&65535,e.b_Uint16[c.bytePos+58>>1]=c.tile&65535,e.b[c.bytePos+60]=1,e.b[c.bytePos+61]=1,e.b_Int32[c.bytePos+64>>2]=c.c,e.b_UFloat32[c.bytePos+68>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+72>>2]=c.x,e.b_UFloat32[c.bytePos+76>>2]=c.y,e.b_UFloat32[c.bytePos+80>>2]=c.px_offset,e.b_UFloat32[c.bytePos+84>>2]=c.py_offset,e.b_UFloat32[c.bytePos+
88>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+92>>2]=c.shakeFrequencyY,e.b_UFloat32[c.bytePos+96>>2]=c.shakeFrequencyX,e.b_UFloat32[c.bytePos+100>>2]=c.shakeDistanceY,e.b_UFloat32[c.bytePos+104>>2]=c.shakeDistanceX,e.b_UFloat32[c.bytePos+108>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+112>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+116>>1]=c.w&65535,e.b_Uint16[c.bytePos+118>>1]=c.h&65535,e.b_Uint16[c.bytePos+120>>1]=c.slot&65535,e.b_Uint16[c.bytePos+122>>1]=c.tile&65535,e.b[c.bytePos+124]=1,e.b[c.bytePos+
125]=1,e.b_Int32[c.bytePos+128>>2]=c.c,e.b_UFloat32[c.bytePos+132>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+136>>2]=c.x,e.b_UFloat32[c.bytePos+140>>2]=c.y,e.b_UFloat32[c.bytePos+144>>2]=c.px_offset,e.b_UFloat32[c.bytePos+148>>2]=c.py_offset,e.b_UFloat32[c.bytePos+152>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+156>>2]=c.shakeFrequencyY,e.b_UFloat32[c.bytePos+160>>2]=c.shakeFrequencyX,e.b_UFloat32[c.bytePos+164>>2]=c.shakeDistanceY,e.b_UFloat32[c.bytePos+168>>2]=c.shakeDistanceX,e.b_UFloat32[c.bytePos+
172>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+176>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+180>>1]=c.w&65535,e.b_Uint16[c.bytePos+182>>1]=c.h&65535,e.b_Uint16[c.bytePos+184>>1]=c.slot&65535,e.b_Uint16[c.bytePos+186>>1]=c.tile&65535,e.b[c.bytePos+188]=0,e.b[c.bytePos+189]=1,e.b_Int32[c.bytePos+192>>2]=c.c,e.b_UFloat32[c.bytePos+196>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+200>>2]=c.x,e.b_UFloat32[c.bytePos+204>>2]=c.y,e.b_UFloat32[c.bytePos+208>>2]=c.px_offset,e.b_UFloat32[c.bytePos+212>>
2]=c.py_offset,e.b_UFloat32[c.bytePos+216>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+220>>2]=c.shakeFrequencyY,e.b_UFloat32[c.bytePos+224>>2]=c.shakeFrequencyX,e.b_UFloat32[c.bytePos+228>>2]=c.shakeDistanceY,e.b_UFloat32[c.bytePos+232>>2]=c.shakeDistanceX,e.b_UFloat32[c.bytePos+236>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+240>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+244>>1]=c.w&65535,e.b_Uint16[c.bytePos+246>>1]=c.h&65535,e.b_Uint16[c.bytePos+248>>1]=c.slot&65535,e.b_Uint16[c.bytePos+250>>1]=c.tile&
65535,e.b[c.bytePos+252]=1,e.b[c.bytePos+253]=0,e.b_Int32[c.bytePos+256>>2]=c.c,e.b_UFloat32[c.bytePos+260>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+264>>2]=c.x,e.b_UFloat32[c.bytePos+268>>2]=c.y,e.b_UFloat32[c.bytePos+272>>2]=c.px_offset,e.b_UFloat32[c.bytePos+276>>2]=c.py_offset,e.b_UFloat32[c.bytePos+280>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+284>>2]=c.shakeFrequencyY,e.b_UFloat32[c.bytePos+288>>2]=c.shakeFrequencyX,e.b_UFloat32[c.bytePos+292>>2]=c.shakeDistanceY,e.b_UFloat32[c.bytePos+
296>>2]=c.shakeDistanceX,e.b_UFloat32[c.bytePos+300>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+304>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+308>>1]=c.w&65535,e.b_Uint16[c.bytePos+310>>1]=c.h&65535,e.b_Uint16[c.bytePos+312>>1]=c.slot&65535,e.b_Uint16[c.bytePos+314>>1]=c.tile&65535,e.b[c.bytePos+316]=0,e.b[c.bytePos+317]=0,e.b_Int32[c.bytePos+320>>2]=c.c,e.b_UFloat32[c.bytePos+324>>2]=c.rotation/180*Math.PI,e.b_UFloat32[c.bytePos+328>>2]=c.x,e.b_UFloat32[c.bytePos+332>>2]=c.y,e.b_UFloat32[c.bytePos+
336>>2]=c.px_offset,e.b_UFloat32[c.bytePos+340>>2]=c.py_offset,e.b_UFloat32[c.bytePos+344>>2]=c.shakeAtTime,e.b_UFloat32[c.bytePos+348>>2]=c.shakeFrequencyY,e.b_UFloat32[c.bytePos+352>>2]=c.shakeFrequencyX,e.b_UFloat32[c.bytePos+356>>2]=c.shakeDistanceY,e.b_UFloat32[c.bytePos+360>>2]=c.shakeDistanceX,e.b_UFloat32[c.bytePos+364>>2]=c.shakeDurationX,e.b_UFloat32[c.bytePos+368>>2]=c.shakeDurationY,e.b_Uint16[c.bytePos+372>>1]=c.w&65535,e.b_Uint16[c.bytePos+374>>1]=c.h&65535,e.b_Uint16[c.bytePos+376>>
1]=c.slot&65535,e.b_Uint16[c.bytePos+378>>1]=c.tile&65535,e.b[c.bytePos+380]=0,e.b[c.bytePos+381]=0}this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);e=this._bytes;a=new Uint8Array(e.b.bufferValue,0);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},updateElement:function(a){if(I.isINSTANCED){var b=this._bytes;b.b_Int32[a.bytePos>>2]=a.c;b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI;b.b_UFloat32[a.bytePos+8>>2]=a.x;b.b_UFloat32[a.bytePos+
12>>2]=a.y;b.b_UFloat32[a.bytePos+16>>2]=a.px_offset;b.b_UFloat32[a.bytePos+20>>2]=a.py_offset;b.b_UFloat32[a.bytePos+24>>2]=a.shakeAtTime;b.b_UFloat32[a.bytePos+28>>2]=a.shakeFrequencyY;b.b_UFloat32[a.bytePos+32>>2]=a.shakeFrequencyX;b.b_UFloat32[a.bytePos+36>>2]=a.shakeDistanceY;b.b_UFloat32[a.bytePos+40>>2]=a.shakeDistanceX;b.b_UFloat32[a.bytePos+44>>2]=a.shakeDurationX;b.b_UFloat32[a.bytePos+48>>2]=a.shakeDurationY;b.b_Uint16[a.bytePos+52>>1]=a.w&65535;b.b_Uint16[a.bytePos+54>>1]=a.h&65535;b.b_Uint16[a.bytePos+
56>>1]=a.slot&65535;b.b_Uint16[a.bytePos+58>>1]=a.tile&65535}else b=this._bytes,b.b_Int32[a.bytePos>>2]=a.c,b.b_UFloat32[a.bytePos+4>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+8>>2]=a.x,b.b_UFloat32[a.bytePos+12>>2]=a.y,b.b_UFloat32[a.bytePos+16>>2]=a.px_offset,b.b_UFloat32[a.bytePos+20>>2]=a.py_offset,b.b_UFloat32[a.bytePos+24>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+28>>2]=a.shakeFrequencyY,b.b_UFloat32[a.bytePos+32>>2]=a.shakeFrequencyX,b.b_UFloat32[a.bytePos+36>>2]=a.shakeDistanceY,b.b_UFloat32[a.bytePos+
40>>2]=a.shakeDistanceX,b.b_UFloat32[a.bytePos+44>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+48>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+52>>1]=a.w&65535,b.b_Uint16[a.bytePos+54>>1]=a.h&65535,b.b_Uint16[a.bytePos+56>>1]=a.slot&65535,b.b_Uint16[a.bytePos+58>>1]=a.tile&65535,b.b[a.bytePos+60]=1,b.b[a.bytePos+61]=1,b.b_Int32[a.bytePos+64>>2]=a.c,b.b_UFloat32[a.bytePos+68>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+72>>2]=a.x,b.b_UFloat32[a.bytePos+76>>2]=a.y,b.b_UFloat32[a.bytePos+80>>2]=a.px_offset,
b.b_UFloat32[a.bytePos+84>>2]=a.py_offset,b.b_UFloat32[a.bytePos+88>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+92>>2]=a.shakeFrequencyY,b.b_UFloat32[a.bytePos+96>>2]=a.shakeFrequencyX,b.b_UFloat32[a.bytePos+100>>2]=a.shakeDistanceY,b.b_UFloat32[a.bytePos+104>>2]=a.shakeDistanceX,b.b_UFloat32[a.bytePos+108>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+112>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+116>>1]=a.w&65535,b.b_Uint16[a.bytePos+118>>1]=a.h&65535,b.b_Uint16[a.bytePos+120>>1]=a.slot&65535,b.b_Uint16[a.bytePos+
122>>1]=a.tile&65535,b.b[a.bytePos+124]=1,b.b[a.bytePos+125]=1,b.b_Int32[a.bytePos+128>>2]=a.c,b.b_UFloat32[a.bytePos+132>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+136>>2]=a.x,b.b_UFloat32[a.bytePos+140>>2]=a.y,b.b_UFloat32[a.bytePos+144>>2]=a.px_offset,b.b_UFloat32[a.bytePos+148>>2]=a.py_offset,b.b_UFloat32[a.bytePos+152>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+156>>2]=a.shakeFrequencyY,b.b_UFloat32[a.bytePos+160>>2]=a.shakeFrequencyX,b.b_UFloat32[a.bytePos+164>>2]=a.shakeDistanceY,b.b_UFloat32[a.bytePos+
168>>2]=a.shakeDistanceX,b.b_UFloat32[a.bytePos+172>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+176>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+180>>1]=a.w&65535,b.b_Uint16[a.bytePos+182>>1]=a.h&65535,b.b_Uint16[a.bytePos+184>>1]=a.slot&65535,b.b_Uint16[a.bytePos+186>>1]=a.tile&65535,b.b[a.bytePos+188]=0,b.b[a.bytePos+189]=1,b.b_Int32[a.bytePos+192>>2]=a.c,b.b_UFloat32[a.bytePos+196>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+200>>2]=a.x,b.b_UFloat32[a.bytePos+204>>2]=a.y,b.b_UFloat32[a.bytePos+
208>>2]=a.px_offset,b.b_UFloat32[a.bytePos+212>>2]=a.py_offset,b.b_UFloat32[a.bytePos+216>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+220>>2]=a.shakeFrequencyY,b.b_UFloat32[a.bytePos+224>>2]=a.shakeFrequencyX,b.b_UFloat32[a.bytePos+228>>2]=a.shakeDistanceY,b.b_UFloat32[a.bytePos+232>>2]=a.shakeDistanceX,b.b_UFloat32[a.bytePos+236>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+240>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+244>>1]=a.w&65535,b.b_Uint16[a.bytePos+246>>1]=a.h&65535,b.b_Uint16[a.bytePos+248>>
1]=a.slot&65535,b.b_Uint16[a.bytePos+250>>1]=a.tile&65535,b.b[a.bytePos+252]=1,b.b[a.bytePos+253]=0,b.b_Int32[a.bytePos+256>>2]=a.c,b.b_UFloat32[a.bytePos+260>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+264>>2]=a.x,b.b_UFloat32[a.bytePos+268>>2]=a.y,b.b_UFloat32[a.bytePos+272>>2]=a.px_offset,b.b_UFloat32[a.bytePos+276>>2]=a.py_offset,b.b_UFloat32[a.bytePos+280>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+284>>2]=a.shakeFrequencyY,b.b_UFloat32[a.bytePos+288>>2]=a.shakeFrequencyX,b.b_UFloat32[a.bytePos+
292>>2]=a.shakeDistanceY,b.b_UFloat32[a.bytePos+296>>2]=a.shakeDistanceX,b.b_UFloat32[a.bytePos+300>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+304>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+308>>1]=a.w&65535,b.b_Uint16[a.bytePos+310>>1]=a.h&65535,b.b_Uint16[a.bytePos+312>>1]=a.slot&65535,b.b_Uint16[a.bytePos+314>>1]=a.tile&65535,b.b[a.bytePos+316]=0,b.b[a.bytePos+317]=0,b.b_Int32[a.bytePos+320>>2]=a.c,b.b_UFloat32[a.bytePos+324>>2]=a.rotation/180*Math.PI,b.b_UFloat32[a.bytePos+328>>2]=a.x,b.b_UFloat32[a.bytePos+
332>>2]=a.y,b.b_UFloat32[a.bytePos+336>>2]=a.px_offset,b.b_UFloat32[a.bytePos+340>>2]=a.py_offset,b.b_UFloat32[a.bytePos+344>>2]=a.shakeAtTime,b.b_UFloat32[a.bytePos+348>>2]=a.shakeFrequencyY,b.b_UFloat32[a.bytePos+352>>2]=a.shakeFrequencyX,b.b_UFloat32[a.bytePos+356>>2]=a.shakeDistanceY,b.b_UFloat32[a.bytePos+360>>2]=a.shakeDistanceX,b.b_UFloat32[a.bytePos+364>>2]=a.shakeDurationX,b.b_UFloat32[a.bytePos+368>>2]=a.shakeDurationY,b.b_Uint16[a.bytePos+372>>1]=a.w&65535,b.b_Uint16[a.bytePos+374>>1]=
a.h&65535,b.b_Uint16[a.bytePos+376>>1]=a.slot&65535,b.b_Uint16[a.bytePos+378>>1]=a.tile&65535,b.b[a.bytePos+380]=0,b.b[a.bytePos+381]=0;if(-1==a.bytePos)throw y.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw y.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");
var b=this._maxElements+this._growSize,c=new Va(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var h=c++,d=this._elements[h];e=this._bytes;var f=d.bytePos,l=this._elemBuffSize;null==l&&(l=0);null==f&&(f=0);e=0<l?new Uint8Array(e.b.bufferValue,f,l):new Uint8Array(e.b.bufferValue,f);d.bufferPointer=e;b[h]=d}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),
this._glBuffer=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),I.isVAO&&(this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,
c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,60,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,60,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,60,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,60,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,4,b.FLOAT,!1,60,24),b.vertexAttribDivisor(6,
1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,3,b.FLOAT,!1,60,40),b.vertexAttribDivisor(7,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,60,52),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(8),b.vertexAttribPointer(8,2,b.SHORT,!1,60,56),b.vertexAttribDivisor(8,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,64,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,
!1,64,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,64,8),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,64,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,4,b.FLOAT,!1,64,24),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,3,b.FLOAT,!1,64,40),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,64,52),b.enableVertexAttribArray(8),b.vertexAttribPointer(8,2,b.SHORT,!1,64,56),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,
b.UNSIGNED_BYTE,!1,64,60)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*this._elemBuffSize;e=this._bytes;f=a.bytePos;l=this._elemBuffSize;null==l&&(l=0);null==f&&(f=0);e=0<l?new Uint8Array(e.b.bufferValue,f,l):new Uint8Array(e.b.bufferValue,f);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw y.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t::IN:: float aRotZ;\n\t::IN:: vec2 aPivot;\n\t\n\t::IN:: vec4 aColorStart0;\n\t\n\t::IN:: vec4 aFloat0;::IN:: vec3 aFloat1;::IN:: vec2 aShort0;\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t::if isES3::flat ::end::::VAROUT:: vec4 vColor0;\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VAROUT:: vec2 vTexPack0;\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\tvec2 pivot = ::if PIVOT_FORMULA::::PIVOT_FORMULA::::else::vec2((aSize.x) * 0.5 + (aPivot.x), (aSize.y) * 0.5 + (aPivot.y))::end::;\t\t\n\t\tvec2 rotZ = ::if ROTZ_FORMULA::::ROTZ_FORMULA::::else::vec2( aRotZ, 0.0 )::end::;\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::vec2((aPos.x) + shake((aFloat0.x), (aFloat0.z), (aFloat1.x), (aFloat1.y)), (aPos.y) + shake((aFloat0.x), (aFloat0.y), (aFloat0.w), (aFloat1.z)))::end::;\npos = pos + (aPosition * size - pivot) * mat2( vec2(cos(rotZ.x), -sin(rotZ.x)), vec2(sin(rotZ.x), cos(rotZ.x)) );\n\t\tvColor0 = aColorStart0.wzyx; \n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\tvTexPack0.x = ::if FORMULA_VARYINGS.slot::::FORMULA_VARYINGS.slot::::else::aShort0.x::end::;vTexPack0.y = ::if FORMULA_VARYINGS.tile::::FORMULA_VARYINGS.tile::::else::aShort0.y::end::;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t::if isES3::flat ::end::::VARIN:: vec4 vColor0; \n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t::if isES3::flat ::end:: ::VARIN:: vec2 vTexPack0;\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER == 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOT_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0.x, ::SLOTS_X::)) * ::SLOT_WIDTH:: + floor(mod(vTexPack0.y, ::TILES_X::)) * ::SLOT_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOT_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0.x)/::SLOTS_X::) * ::SLOT_HEIGHT:: + floor(floor(vTexPack0.y) / ::TILES_X::) * ::SLOT_HEIGHT:: / ::TILES_Y::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t\t::if (LAYER >= 1)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0.y, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0.y) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER == 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t\t::if (LAYER >= 1)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\tvec4 c0 = vColor0; \n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER == 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOT_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0.x, ::SLOTS_X::)) * ::SLOT_WIDTH:: + floor(mod(vTexPack0.y, ::TILES_X::)) * ::SLOT_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOT_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0.x)/::SLOTS_X::) * ::SLOT_HEIGHT:: + floor(floor(vTexPack0.y) / ::TILES_X::) * ::SLOT_HEIGHT:: / ::TILES_Y::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 1)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH:: / ::TILES_X:: + floor(mod(vTexPack0.y, ::TILES_X::)) * ::SLOTS_WIDTH:: / ::TILES_X::, vTexCoord.y * ::SLOTS_HEIGHT:: / ::TILES_Y:: + floor(floor(vTexPack0.y) / ::TILES_X::) * ::SLOTS_HEIGHT:: / ::TILES_Y::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return["base"]},getColorIdentifiers:function(){return["c"]},getCustomIdentifiers:function(){return"shakeAtTime shakeFrequencyY shakeFrequencyX shakeDistanceY shakeDistanceX shakeDurationX shakeDurationY".split(" ")},getCustomVaryings:function(){return"null null null null null null null".split(" ")},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return ra.DEFAULT_FORMULA_VARS},getFormulas:function(){return ra.FORMULAS},getAttributes:function(){return ra.ATTRIBUTES},
getFormulaNames:function(){return ra.FORMULA_NAMES},getFormulaVaryings:function(){return""==ra.FORMULA_VARYINGS?[]:ra.FORMULA_VARYINGS.split(",")},getFormulaConstants:function(){return""==ra.FORMULA_CONSTANTS?[]:ra.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==ra.FORMULA_CUSTOMS?[]:ra.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!0},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!0},
bindAttribLocations:function(a,b){a.bindAttribLocation(b,5,"aColorStart0");a.bindAttribLocation(b,4,"aRotZ");a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,3,"aPivot");a.bindAttribLocation(b,6,"aFloat0");a.bindAttribLocation(b,7,"aFloat1");a.bindAttribLocation(b,8,"aShort0");a.bindAttribLocation(b,0,"aPosition")},render:function(a,b,c){a=this._maxElements;I.isINSTANCED?(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,
this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,60,0),b.vertexAttribDivisor(5,1),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,60,4),b.vertexAttribDivisor(4,1),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,60,8),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,
!1,60,16),b.vertexAttribDivisor(3,1),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,4,b.FLOAT,!1,60,24),b.vertexAttribDivisor(6,1),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,3,b.FLOAT,!1,60,40),b.vertexAttribDivisor(7,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,60,52),b.vertexAttribDivisor(2,1),b.enableVertexAttribArray(8),b.vertexAttribPointer(8,2,b.SHORT,!1,60,56),b.vertexAttribDivisor(8,1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(I.isVAO?
this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(5),b.vertexAttribPointer(5,4,b.UNSIGNED_BYTE,!0,64,0),b.enableVertexAttribArray(4),b.vertexAttribPointer(4,1,b.FLOAT,!1,64,4),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.FLOAT,!1,64,8),b.enableVertexAttribArray(3),b.vertexAttribPointer(3,2,b.FLOAT,!1,64,16),b.enableVertexAttribArray(6),b.vertexAttribPointer(6,4,b.FLOAT,!1,64,24),b.enableVertexAttribArray(7),b.vertexAttribPointer(7,
3,b.FLOAT,!1,64,40),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,64,52),b.enableVertexAttribArray(8),b.vertexAttribPointer(8,2,b.SHORT,!1,64,56),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,64,60)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));I.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),b.disableVertexAttribArray(5),b.disableVertexAttribArray(4),b.disableVertexAttribArray(1),b.disableVertexAttribArray(2),
b.disableVertexAttribArray(3),b.disableVertexAttribArray(6),b.disableVertexAttribArray(7),b.disableVertexAttribArray(8));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Ud};var Vd=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);this._maxElements=this._growSize=this._shrinkAtSize=0;this._gl=this._glInstanceBuffer=this._glVAO=null;if(0>=a)throw y.thrown("Error: Buffer need a minimum size of 1 to store an Element.");this._minSize=a;this._growSize=0>b?0:b;c&&(this._shrinkAtSize=b+(b/2|0));this._elements=
Array(this._minSize);I.isINSTANCED?(null==wa.instanceBytes&&(wa.instanceBytes=new Va(new ArrayBuffer(12)),wa.instanceBytes.b[0]=1,wa.instanceBytes.b[1]=1,wa.instanceBytes.b[2]=1,wa.instanceBytes.b[3]=1,wa.instanceBytes.b[4]=0,wa.instanceBytes.b[5]=1,wa.instanceBytes.b[6]=1,wa.instanceBytes.b[7]=0,wa.instanceBytes.b[8]=0,wa.instanceBytes.b[9]=0,wa.instanceBytes.b[10]=0,wa.instanceBytes.b[11]=0),this._elemBuffSize=8):this._elemBuffSize=72;this._bytes=new Va(new ArrayBuffer(this._elemBuffSize*this._minSize));
this._bytes.fill(0,this._elemBuffSize*this._minSize,0)};d["peote.view.Buffer_ViewElement"]=Vd;Vd.__name__=!0;Vd.__interfaces__=[pc];Vd.prototype={setNewGLContext:function(a){if(null!=a&&a!=this._gl){null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),I.isINSTANCED&&this._gl.deleteBuffer(this._glInstanceBuffer),I.isVAO&&this._gl.deleteVertexArray(this._glVAO));this._gl=a;this._glBuffer=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer);var b=this._bytes;b=new Uint8Array(b.b.bufferValue,
0);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.STREAM_DRAW);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null);I.isINSTANCED&&(this._glInstanceBuffer=this._gl.createBuffer(),a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),b=wa.instanceBytes,b=new Uint8Array(b.b.bufferValue,0),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null));I.isVAO&&(this._glVAO=this._gl.createVertexArray(),this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(a=this._gl,b=this._glBuffer,
a.bindBuffer(a.ARRAY_BUFFER,this._glInstanceBuffer),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,2,0),a.bindBuffer(a.ARRAY_BUFFER,b),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,8,0),a.vertexAttribDivisor(1,1),a.enableVertexAttribArray(2),a.vertexAttribPointer(2,2,a.SHORT,!1,8,4),a.vertexAttribDivisor(2,1)):(a=this._gl,a.bindBuffer(a.ARRAY_BUFFER,this._glBuffer),a.enableVertexAttribArray(1),a.vertexAttribPointer(1,2,a.SHORT,!1,12,0),a.enableVertexAttribArray(2),
a.vertexAttribPointer(2,2,a.SHORT,!1,12,4),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null))}},updateElement:function(a){if(I.isINSTANCED){var b=this._bytes;b.b_Uint16[a.bytePos>>1]=a.x&65535;b.b_Uint16[a.bytePos+2>>1]=a.y&65535;b.b_Uint16[a.bytePos+4>>1]=a.w&65535;b.b_Uint16[a.bytePos+6>>1]=a.h&65535}else b=this._bytes,b.b_Uint16[a.bytePos>>1]=a.x&65535,b.b_Uint16[a.bytePos+2>>1]=a.y&65535,b.b_Uint16[a.bytePos+4>>1]=a.w&65535,b.b_Uint16[a.bytePos+
6>>1]=a.h&65535,b.b[a.bytePos+8]=1,b.b[a.bytePos+9]=1,b.b_Uint16[a.bytePos+12>>1]=a.x&65535,b.b_Uint16[a.bytePos+14>>1]=a.y&65535,b.b_Uint16[a.bytePos+16>>1]=a.w&65535,b.b_Uint16[a.bytePos+18>>1]=a.h&65535,b.b[a.bytePos+20]=1,b.b[a.bytePos+21]=1,b.b_Uint16[a.bytePos+24>>1]=a.x&65535,b.b_Uint16[a.bytePos+26>>1]=a.y&65535,b.b_Uint16[a.bytePos+28>>1]=a.w&65535,b.b_Uint16[a.bytePos+30>>1]=a.h&65535,b.b[a.bytePos+32]=0,b.b[a.bytePos+33]=1,b.b_Uint16[a.bytePos+36>>1]=a.x&65535,b.b_Uint16[a.bytePos+38>>
1]=a.y&65535,b.b_Uint16[a.bytePos+40>>1]=a.w&65535,b.b_Uint16[a.bytePos+42>>1]=a.h&65535,b.b[a.bytePos+44]=1,b.b[a.bytePos+45]=0,b.b_Uint16[a.bytePos+48>>1]=a.x&65535,b.b_Uint16[a.bytePos+50>>1]=a.y&65535,b.b_Uint16[a.bytePos+52>>1]=a.w&65535,b.b_Uint16[a.bytePos+54>>1]=a.h&65535,b.b[a.bytePos+56]=0,b.b[a.bytePos+57]=0,b.b_Uint16[a.bytePos+60>>1]=a.x&65535,b.b_Uint16[a.bytePos+62>>1]=a.y&65535,b.b_Uint16[a.bytePos+64>>1]=a.w&65535,b.b_Uint16[a.bytePos+66>>1]=a.h&65535,b.b[a.bytePos+68]=0,b.b[a.bytePos+
69]=0;if(-1==a.bytePos)throw y.thrown("Error, Element is not added to Buffer");null!=this._gl&&(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.bufferSubData(b.ARRAY_BUFFER,a.bytePos,a.bufferPointer),b.bindBuffer(b.ARRAY_BUFFER,null))},addElement:function(a){if(-1==a.bytePos){if(this._maxElements==this._elements.length){if(0==this._growSize)throw y.thrown("Error: Can't add new Element. Buffer is full and automatic growing Buffersize is disabled.");var b=this._maxElements+this._growSize,c=
new Va(new ArrayBuffer(this._elemBuffSize*b));c.blit(0,this._bytes,0,this._elemBuffSize*this._maxElements);this._bytes=c;var e=Array(b);b=e;c=0;for(var g=this._maxElements;c<g;){var d=c++,f=this._elements[d];e=this._bytes;var k=f.bytePos,l=this._elemBuffSize;null==l&&(l=0);null==k&&(k=0);e=0<l?new Uint8Array(e.b.bufferValue,k,l):new Uint8Array(e.b.bufferValue,k);f.bufferPointer=e;b[d]=f}this._elements=b;null!=this._gl&&(this._gl.deleteBuffer(this._glBuffer),this._glBuffer=this._gl.createBuffer(),
this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._glBuffer),e=this._bytes,e=new Uint8Array(e.b.bufferValue,0),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STREAM_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null),I.isVAO&&(this._gl.bindVertexArray(this._glVAO),I.isINSTANCED?(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),
b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,1)):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.bindVertexArray(null)))}a.bytePos=this._maxElements*
this._elemBuffSize;e=this._bytes;k=a.bytePos;l=this._elemBuffSize;null==l&&(l=0);null==k&&(k=0);e=0<l?new Uint8Array(e.b.bufferValue,k,l):new Uint8Array(e.b.bufferValue,k);a.bufferPointer=e;this._elements[this._maxElements++]=a;this.updateElement(a)}else throw y.thrown("Error: Element is already inside a Buffer");},getVertexShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::if VERTEX_INT_PRECISION::precision ::VERTEX_INT_PRECISION:: int; ::end::\n\t::if VERTEX_FLOAT_PRECISION::precision ::VERTEX_FLOAT_PRECISION:: float; ::end::\n\t::if VERTEX_SAMPLER_PRECISION::precision ::VERTEX_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\n\t::if (!isPICKING && isUBO)::\n\t//layout(std140) uniform uboView\n\tuniform uboView\n\t{\n\t\tvec2 uResolution;\n\t\tvec2 uViewOffset;\n\t\tvec2 uViewZoom;\n\t};\n\t//layout(std140) uniform uboDisplay\n\tuniform uboDisplay\n\t{\n\t\tvec2 uOffset;\n\t\tvec2 uZoom;\n\t};\n\t::else::\n\tuniform vec2 uResolution;\n\tuniform vec2 uOffset;\n\tuniform vec2 uZoom;\n\t::end::\n\t\n\t\n\t\n\t// Attributes -------------------------\n\t::IN:: vec2 aPosition;\n\t\n\t::if isPICKING::\n\t\t::if !isINSTANCED::\n\t\t\t::IN:: vec4 aElement;\n\t\t::end::\n\t::end::\n\t\n\t::IN:: vec2 aPos;\n\t::IN:: vec2 aSize;\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VAROUT:: int vElement;\n\t\t::else::\n\t\t\t::VAROUT:: vec4 vElement;\n\t\t::end::\n\t::end::\n\t\n\t\n\t\n\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VAROUT:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\n\t// custom functions -------------------\n\t::VERTEX_INJECTION::\n\n\t// --------- vertex main --------------\n\tvoid main(void)\n\t{\n\t\t\n\t\tvec2 size = ::if SIZE_FORMULA::::SIZE_FORMULA::::else::aSize::end::;\n\t\t\t\t\n\t\t\n\t\tvec2 pos = ::if POS_FORMULA::::POS_FORMULA::::else::aPos::end::;\npos = pos + aPosition * size;\n\t\t\n\n\t\t\n\n\t\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t\tvTexCoord = aPosition;\t\t\t\n\t\t\t\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if isINSTANCED::\n\t\t\t\tvElement = gl_InstanceID + 1;\n\t\t\t::else::\n\t\t\t\tvElement = aElement;\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\tfloat width = uResolution.x;\n\t\tfloat height = uResolution.y;\n\t\t::if (!isPICKING && isUBO)::\n\t\tfloat deltaX = (uOffset.x  + uViewOffset.x) / uZoom.x;\n\t\tfloat deltaY = (uOffset.y  + uViewOffset.y) / uZoom.y;\n\t\tvec2 zoom = uZoom * uViewZoom;\n\t\t::else::\n\t\tfloat deltaX = uOffset.x;\n\t\tfloat deltaY = uOffset.y;\n\t\tvec2 zoom = uZoom;\n\t\t::end::\n\t\t\n\t\t::if isPIXELSNAPPING::\n\t\tpos = floor( pos * ::PIXELDIVISOR:: * zoom ) / ::PIXELDIVISOR:: / zoom;\n\t\t::end::\n\t\t\n\t\tgl_Position = vec4 (\n\t\t\t 2.0 * zoom.x/width  * (pos.x + deltaX) - 1.0,\n\t\t\t-2.0 * zoom.y/height * (pos.y + deltaY) + 1.0,\n\t\t\t- 0.0,\n\t\t\t1.0\n\t\t);\t\t\n\t\t\n\t}\n\t"},
getFragmentShader:function(){return"\n\t::if isES3::#version 300 es::end::\n\t::foreach FRAGMENT_EXTENSIONS::#extension ::EXTENSION:: : enable\n\t::end::\n\t\n\t::if FRAGMENT_INT_PRECISION::precision ::FRAGMENT_INT_PRECISION:: int; ::end::\n\t::if FRAGMENT_FLOAT_PRECISION::precision ::FRAGMENT_FLOAT_PRECISION:: float; ::end::\n\t::if FRAGMENT_SAMPLER_PRECISION::precision ::FRAGMENT_SAMPLER_PRECISION:: sampler2D; ::end::\n\t\n\t// Uniforms -------------------------\t\n\t::FRAGMENT_PROGRAM_UNIFORMS::\n\t\n\t// Varyings ---------------------------\n\t::if isPICKING::\n\t\t::if isINSTANCED::\n\t\t\tflat ::VARIN:: int vElement;\n\t\t::else::\n\t\t\t::VARIN:: vec4 vElement;\n\t\t::end::\n\t::end::\n\n\t\n\t\n\t\t\t\n\t::if (hasTEXTURES || hasFRAGMENT_INJECTION)::\n\t\t::VARIN:: vec2 vTexCoord;\n\t\t\n\t::end::\t\n\t\n\t\n\t::if isES3::\n\t\t::if (isPICKING && isINSTANCED)::\n\t\t\tout int Color;\n\t\t::else::\n\t\t\tout vec4 Color;\n\t\t::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get texture color\n\t\tvec4 getTextureColor(int TXTNUM, vec2 vTexCoord) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn(texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::)));\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(::DEFAULT_VALUE::);}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureColor(a,b) vec4(0.0,0.0,0.0,0.0)::end::\n\t::end::\n\n\t::if hasTEXTURE_FUNCTIONS::\n\t\t// function to get full texture size\n\t\tvec2 getTextureResolution(int TXTNUM) {\n\t\t::foreach TEXTURES::\n\t\t\t\n\t\t\t::if (LAYER >= 0)::\n\t\t\t::if USED_ID::\n\t\t\t\tif (TXTNUM == ::LAYER::) {\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\treturn( vec2(::TEXTURE_WIDTH::, ::TEXTURE_HEIGHT::) );\n\t\t\t\t\t::end::\n\t\t\t\t}\n\t\t\t::end::\n\t\t\t::end::\n\t\t\t\n\t\t::end::\n\t\t// default values:\n\t\t::foreach TEXTURE_DEFAULTS::\n\t\t\tif (TXTNUM == ::LAYER::) {return(vec2(0.0,0.0));}\t\t\n\t\t::end::\n\t\t}\n\t::else:: \n\t\t::if hasFRAGMENT_INJECTION::#define getTextureResolution(a) vec2(0.0,0.0)::end::\n\t::end::\n\n\t// custom functions -------------------\n\t::FRAGMENT_INJECTION::\n\t\n\t// --------- fragment main ------------\n\tvoid main(void)\n\t{\t\n\t\t\n\t\t\n\t\t::if hasTEXTURES::\n\t\t\t::foreach TEXTURES::\n\t\t\t\t// ------------- LAYER ::LAYER:: --------------\n\t\t\t\t\n\t\t\t\t::if (LAYER >= 0)::\n\t\t\t\t::if USED::\n\t\t\t\t\tvec4 t::LAYER::;\n\t\t\t\t\t::foreach UNITS::\n\t\t\t\t\t::if !FIRST ::else ::end::::if !LAST ::if (0.0 < ::UNIT_VALUE::)::end::\n\t\t\t\t\t\tt::LAYER:: = texture::if !isES3::2D::end::(::TEXTURE::, vec2(vTexCoord.x * ::SLOTS_WIDTH::, vTexCoord.y * ::SLOTS_HEIGHT::));\n\t\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t::end::\n\t\t\t\t\n\t\t\t::end::\n\t\t::end::\n\t\t\n\t\t// calc final color from all layers\n\t\tvec4 col = ::FRAGMENT_CALC_LAYER::;\n\t\t\n\t\t::if isDISCARD:: \n\t\t\tif (col.a <= ::DISCARD::) discard;\n\t\t::end::\n\t\t\n\t\t::if isPICKING::\n\t\t\t::if !isES3::gl_Frag::end::Color = vElement;\n\t\t::else::\n\t\t\t::if !isES3::gl_Frag::end::Color = col;\n\t\t\t// this fixing problem on old FF if alpha goes zero\n\t\t\t::if !isES3::gl_Frag::end::Color.w = clamp(::if !isES3::gl_Frag::end::Color.w, 0.003, 1.0);\n\t\t::end::\n\t}\n\t"},
getTextureIdentifiers:function(){return[]},getColorIdentifiers:function(){return[]},getCustomIdentifiers:function(){return[]},getCustomVaryings:function(){return[]},getDefaultColorFormula:function(){return""},getDefaultFormulaVars:function(){return wa.DEFAULT_FORMULA_VARS},getFormulas:function(){return wa.FORMULAS},getAttributes:function(){return wa.ATTRIBUTES},getFormulaNames:function(){return wa.FORMULA_NAMES},getFormulaVaryings:function(){return""==wa.FORMULA_VARYINGS?[]:wa.FORMULA_VARYINGS.split(",")},
getFormulaConstants:function(){return""==wa.FORMULA_CONSTANTS?[]:wa.FORMULA_CONSTANTS.split(",")},getFormulaCustoms:function(){return""==wa.FORMULA_CUSTOMS?[]:wa.FORMULA_CUSTOMS.split(",")},getMaxZindex:function(){return 2097151},hasAlpha:function(){return!1},hasZindex:function(){return!1},hasPicking:function(){return!1},hasTime:function(){return!1},needFragmentPrecision:function(){return!1},bindAttribLocations:function(a,b){a.bindAttribLocation(b,1,"aPos");a.bindAttribLocation(b,2,"aSize");a.bindAttribLocation(b,
0,"aPosition")},render:function(a,b,c){a=this._maxElements;I.isINSTANCED?(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,c=this._glBuffer,b.bindBuffer(b.ARRAY_BUFFER,this._glInstanceBuffer),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,2,0),b.bindBuffer(b.ARRAY_BUFFER,c),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,8,0),b.vertexAttribDivisor(1,1),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,8,4),b.vertexAttribDivisor(2,
1)),this._gl.drawArraysInstanced(this._gl.TRIANGLE_STRIP,0,6,a)):(I.isVAO?this._gl.bindVertexArray(this._glVAO):(b=this._gl,b.bindBuffer(b.ARRAY_BUFFER,this._glBuffer),b.enableVertexAttribArray(1),b.vertexAttribPointer(1,2,b.SHORT,!1,12,0),b.enableVertexAttribArray(2),b.vertexAttribPointer(2,2,b.SHORT,!1,12,4),b.enableVertexAttribArray(0),b.vertexAttribPointer(0,2,b.UNSIGNED_BYTE,!1,12,8)),this._gl.drawArrays(this._gl.TRIANGLE_STRIP,0,6*a));I.isVAO?this._gl.bindVertexArray(null):(b=this._gl,b.disableVertexAttribArray(0),
b.disableVertexAttribArray(1),b.disableVertexAttribArray(2));this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},__class__:Vd};var zd=function(a,b,c,e,g){null==g&&(g=0);this.renderFramebufferSkipFrames=this.renderFramebufferFrame=0;this._renderFramebufferEnabled=!1;this.renderFramebufferEnabled=!0;this.framebufferTextureSlot=0;this.peoteView=this.gl=this.fbTexture=null;this.alpha=1;this.red=this.green=this.blue=0;this.backgroundAlpha=this.backgroundDepth=this.backgroundEnabled=!1;this.isVisible=!0;this.xz=
this.yz=this.zoom=this.xZoom=this.yZoom=1;this.width=this.height=this.x=this.y=this.xOffset=this.yOffset=0;if(I.isUBO){var d=this.uniformBuffer,f=this.gl;null!=f&&(d.uniformBytes.b_UFloat32[0]=a+this.xOffset,f.bindBuffer(f.UNIFORM_BUFFER,d.uniformBuffer),f.bufferSubData(f.UNIFORM_BUFFER,0,d.xOffestBufferPointer),f.bindBuffer(f.UNIFORM_BUFFER,null))}this.x=a;I.isUBO&&(d=this.uniformBuffer,f=this.gl,null!=f&&(d.uniformBytes.b_UFloat32[1]=b+this.yOffset,f.bindBuffer(f.UNIFORM_BUFFER,d.uniformBuffer),
f.bufferSubData(f.UNIFORM_BUFFER,4,d.yOffestBufferPointer),f.bindBuffer(f.UNIFORM_BUFFER,null)));this.y=b;this.width=c;this.height=e;this.red=(g>>24&255)/255;this.green=(g>>16&255)/255;this.blue=(g>>8&255)/255;this.alpha=(g&255)/255;this.backgroundEnabled=0<this.alpha;this.backgroundAlpha=1>this.alpha;this.programList=new Ue(new Db);I.isUBO&&(this.uniformBuffer=new Wd,this.uniformBufferFB=new Wd,this.uniformBufferViewFB=new Xd)};d["peote.view.Display"]=zd;zd.__name__=!0;zd.prototype={addToPeoteView:function(a,
b,c){null==c&&(c=!1);this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));a.displayList.add(this,b,c)},removeFromPeoteView:function(a){if(this.peoteView!=a)throw y.thrown("Error, display is not inside peoteView");a.framebufferDisplayList.has(this)||(this.peoteView=null);a.displayList.remove(this)},addToPeoteViewFramebuffer:function(a,b,c){null==c&&(c=!1);this.peoteView!=a&&(this.peoteView=a,this.setNewGLContext(a.gl));a.framebufferDisplayList.add(this,b,c)},setNewGLContext:function(a){if(null!=
a&&a!=this.gl){null!=this.gl&&I.isUBO&&(this.uniformBuffer.deleteGLBuffer(this.gl),this.uniformBufferFB.deleteGLBuffer(this.gl),this.uniformBufferViewFB.deleteGLBuffer(this.gl));this.gl=a;I.isUBO&&(this.uniformBuffer.createGLBuffer(this.gl,this.x+this.xOffset,this.y+this.yOffset,this.xz,this.yz),this.uniformBufferFB.createGLBuffer(this.gl,this.xOffset,this.yOffset-this.height,this.xz,this.yz),this.uniformBufferViewFB.createGLBuffer(this.gl,this.width,-this.height,0,0,1,1));for(var b=this.programList.first;null!=
b;){var c=b.value;b=b.next;if(null!=a&&a!=c.gl){for(var e=0,g=c.displays;e<g.length;){var d=g[e];++e;if(null!=d.gl&&d.gl!=a)throw y.thrown("Error, program can not used inside different gl-contexts");}null!=c.gl&&(c.gl.deleteShader(c.glVertexShader),c.gl.deleteShader(c.glFragmentShader),c.gl.deleteProgram(c.glProgram),c.buffer.hasPicking()&&(c.gl.deleteShader(c.glVertexShaderPicking),c.gl.deleteShader(c.glFragmentShaderPicking),c.gl.deleteProgram(c.glProgramPicking)));c.gl=a;I.isES3&&(c.glShaderConfig.isES3=
!0,c.glShaderConfig.IN="in",c.glShaderConfig.VARIN="in",c.glShaderConfig.VAROUT="out");I.isUBO&&(c.glShaderConfig.isUBO=!0);I.isINSTANCED&&(c.glShaderConfig.isINSTANCED=!0);c.glShaderConfig.FRAGMENT_EXTENSIONS=[];null!=c.gl.getExtension("OES_standard_derivatives")&&c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"GL_OES_standard_derivatives"});null!=c.gl.getExtension("EXT_color_buffer_float")?c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"EXT_color_buffer_float"}):null!=c.gl.getExtension("OES_texture_float")&&
c.glShaderConfig.FRAGMENT_EXTENSIONS.push({EXTENSION:"OES_texture_float"});c.buffer.setNewGLContext(c.gl);c.createProg();c.buffer.hasPicking()&&c.createProg(!0);e=0;for(g=c.activeTextures;e<g.length;){d=g[e];++e;var f=c.gl;if(null!=f&&f!=d.gl){for(var k=0,l=d.programs;k<l.length;){var n=l[k];++k;if(null!=n.gl&&n.gl!=f)throw y.thrown("Error, texture can not used inside different gl-contexts");}n=0;for(k=d.displays;n<k.length;)if(l=k[n],++n,null!=l.gl&&l.gl!=f)throw y.thrown("Error, texture can not used inside different gl-contexts");
null!=d.gl&&(d.gl.deleteTexture(d.glTexture),d.glTexture=null,0==d.displays.length&&null!=d.framebuffer&&(d.gl.deleteFramebuffer(d.framebuffer),d.framebuffer=null,null!=d.glDepthBuffer&&d.gl.deleteRenderbuffer(d.glDepthBuffer),d.glDepthBuffer=null));d.gl=f;if(d.width>d.gl.getParameter(d.gl.MAX_TEXTURE_SIZE)||d.height>d.gl.getParameter(d.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");d.glTexture=Sb.createEmptyTexture(d.gl,d.width,d.height,d.colorChannels,
d.createMipmaps,d.magFilter,d.minFilter,d.useFloat);if(0<d.displays.length&&null==d.framebuffer){d.glDepthBuffer=d.gl.createRenderbuffer();f=d.gl;n=d.glTexture;k=d.glDepthBuffer;l=d.width;var C=d.height,r=f.createFramebuffer();f.bindRenderbuffer(f.RENDERBUFFER,k);Ma.clearGlErrorQueue(f);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT24,l,C);Ma.getLastGlError(f)==f.INVALID_ENUM&&(fa.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",
methodName:"createFramebuffer"}),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,l,C));f.bindFramebuffer(f.FRAMEBUFFER,r);f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,k);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,n,0);if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);d.framebuffer=r;d.updated=
!0}for(f=d.images.keys();f.hasNext();)n=f.next(),d.bufferImage(n,d.images.h[n.__id__])}}}}if(null!=this.fbTexture&&(b=this.fbTexture,null!=a&&a!=b.gl)){e=0;for(g=b.programs;e<g.length;)if(n=g[e],++e,null!=n.gl&&n.gl!=a)throw y.thrown("Error, texture can not used inside different gl-contexts");e=0;for(g=b.displays;e<g.length;)if(d=g[e],++e,null!=d.gl&&d.gl!=a)throw y.thrown("Error, texture can not used inside different gl-contexts");null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==
b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");b.glTexture=Sb.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&
null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();f=b.gl;n=b.glTexture;k=b.glDepthBuffer;l=b.width;C=b.height;r=f.createFramebuffer();f.bindRenderbuffer(f.RENDERBUFFER,k);Ma.clearGlErrorQueue(f);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT24,l,C);Ma.getLastGlError(f)==f.INVALID_ENUM&&(fa.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),f.renderbufferStorage(f.RENDERBUFFER,
f.DEPTH_COMPONENT16,l,C));f.bindFramebuffer(f.FRAMEBUFFER,r);f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,k);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,n,0);if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);b.framebuffer=r;b.updated=!0}for(f=b.images.keys();f.hasNext();)n=f.next(),b.bufferImage(n,b.images.h[n.__id__])}}},
addProgram:function(a,b,c){null==c&&(c=!1);a.addToDisplay(this,b,c)},setFramebuffer:function(a,b,c){if(this.fbTexture==a)throw y.thrown("Error, texture is already in use as Framebuffer for Display");if(b>=a.imageSlots)throw y.thrown("Error, maximum texture slot of framebufferTexture is"+(a.imageSlots-1));if(null==c){if(null==this.gl)throw y.thrown("Error, if the display is not added it needs the gl-context of a peoteView to set a framebuffer texture");}else this.peoteView!=c&&(this.peoteView=c,this.setNewGLContext(c.gl));
null!=b&&(this.framebufferTextureSlot=b);if(null!=this.fbTexture){b=this.fbTexture;if(!J.remove(b.displays,this))throw y.thrown("Error, this texture (Framebuffer) is not used by display anymore");0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null)}b=this.fbTexture=a;if(0<=b.displays.indexOf(this))throw y.thrown("Error, texture is already used by display");a=this.gl;
if(null!=a&&a!=b.gl){c=0;for(var e=b.programs;c<e.length;){var g=e[c];++c;if(null!=g.gl&&g.gl!=a)throw y.thrown("Error, texture can not used inside different gl-contexts");}c=0;for(e=b.displays;c<e.length;)if(g=e[c],++c,null!=g.gl&&g.gl!=a)throw y.thrown("Error, texture can not used inside different gl-contexts");null!=b.gl&&(b.gl.deleteTexture(b.glTexture),b.glTexture=null,0==b.displays.length&&null!=b.framebuffer&&(b.gl.deleteFramebuffer(b.framebuffer),b.framebuffer=null,null!=b.glDepthBuffer&&
b.gl.deleteRenderbuffer(b.glDepthBuffer),b.glDepthBuffer=null));b.gl=a;if(b.width>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE)||b.height>b.gl.getParameter(b.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");b.glTexture=Sb.createEmptyTexture(b.gl,b.width,b.height,b.colorChannels,b.createMipmaps,b.magFilter,b.minFilter,b.useFloat);if(0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=b.gl.createRenderbuffer();c=b.gl;a=b.glTexture;e=b.glDepthBuffer;g=b.width;
var d=b.height,f=c.createFramebuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);Ma.clearGlErrorQueue(c);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT24,g,d);Ma.getLastGlError(c)==c.INVALID_ENUM&&(fa.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,g,d));c.bindFramebuffer(c.FRAMEBUFFER,f);c.framebufferRenderbuffer(c.FRAMEBUFFER,
c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a,0);if(c.checkFramebufferStatus(c.FRAMEBUFFER)!=c.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindRenderbuffer(c.RENDERBUFFER,null);b.framebuffer=f;b.updated=!0}for(a=b.images.keys();a.hasNext();)c=a.next(),b.bufferImage(c,b.images.h[c.__id__])}b.displays.push(this);if(null!=b.gl&&0<b.displays.length&&null==b.framebuffer){b.glDepthBuffer=
b.gl.createRenderbuffer();c=b.gl;a=b.glTexture;e=b.glDepthBuffer;g=b.width;d=b.height;f=c.createFramebuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);Ma.clearGlErrorQueue(c);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT24,g,d);Ma.getLastGlError(c)==c.INVALID_ENUM&&(fa.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",methodName:"createFramebuffer"}),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,
g,d));c.bindFramebuffer(c.FRAMEBUFFER,f);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a,0);if(c.checkFramebufferStatus(c.FRAMEBUFFER)!=c.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindRenderbuffer(c.RENDERBUFFER,null);b.framebuffer=f;b.updated=!0}this.renderFramebufferEnabled&&(this._renderFramebufferEnabled=!0)},__class__:zd};var vf=
{fromRenderContext:function(a){if(null!=a.webgl2)return fa.trace("WEBGL2 detected.",{fileName:"peote/view/PeoteGL.hx",lineNumber:86,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),I.isUBO=!0,I.isINSTANCED=!0,I.isVAO=!0,I.isES3=!0,a.webgl2;if(null!=a.webgl)return fa.trace("WEBGL1 detected.",{fileName:"peote/view/PeoteGL.hx",lineNumber:91,className:"peote.view._PeoteGL.PeoteGL_Impl_",methodName:"fromRenderContext"}),a.webgl;window.alert("Error: missing webgl context");
return null}},I=function(){};d["peote.view.Version"]=I;I.__name__=!0;var Na=function(){};d["peote.view.Precision"]=Na;Na.__name__=!0;var me=function(a,b,c){null==c&&(c=!0);null==b&&(b=255);this.speed=1;this.startTime=this.stopTime=0;this.isRun=!1;this.xOffset=this.yOffset=0;this.xz=this.yz=1;this.maskState=0;this.glStateAlpha=this.glStateDepth=!1;this.colorState=!0;this.alpha=1;this.red=this.green=this.blue=0;this.gl=vf.fromRenderContext(a.context);this.width=a.__width;this.height=a.__height;this.red=
(b>>24&255)/255;this.green=(b>>16&255)/255;this.blue=(b>>8&255)/255;this.alpha=(b&255)/255;I.isUBO&&(this.uniformBuffer=new Xd,this.uniformBuffer.createGLBuffer(this.gl,this.width,this.height,this.xOffset,this.yOffset,this.xz,this.yz));this.maxTextureImageUnits=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS);this.glStateTexture=b=Array(this.maxTextureImageUnits);b=this.gl;var e=b.VERTEX_SHADER,g=Na.VertexFloat,d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,
b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.VERTEX_SHADER;g=Na.VertexInt;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.VERTEX_SHADER;g=Na.VertexSampler;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,
b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.FRAGMENT_SHADER;g=Na.FragmentFloat;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.FRAGMENT_SHADER;g=Na.FragmentInt;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=
b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);e=b.FRAGMENT_SHADER;g=Na.FragmentSampler;d=b.getShaderPrecisionFormat(e,b.HIGH_FLOAT);null!=d&&(g.high=d.precision);d=b.getShaderPrecisionFormat(e,b.MEDIUM_FLOAT);null!=d&&(g.medium=d.precision);d=b.getShaderPrecisionFormat(e,b.LOW_FLOAT);null!=d&&(g.low=d.precision);I.isINSTANCED?(this.pickInt32=b=new Int32Array(4),this.pickTexture=Sb.createPickingTexture(this.gl,
!0)):(this.pickUInt8=b=new Uint8Array(4),this.pickTexture=Sb.createPickingTexture(this.gl));this.pickDepthBuffer=this.gl.createRenderbuffer();b=this.gl;e=this.pickTexture;g=this.pickDepthBuffer;d=b.createFramebuffer();b.bindRenderbuffer(b.RENDERBUFFER,g);Ma.clearGlErrorQueue(b);b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT24,1,1);Ma.getLastGlError(b)==b.INVALID_ENUM&&(fa.trace("switching to DEPTH_COMPONENT16 for framebuffer",{fileName:"peote/view/utils/GLTool.hx",lineNumber:41,className:"peote.view.utils.GLTool",
methodName:"createFramebuffer"}),b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,1,1));b.bindFramebuffer(b.FRAMEBUFFER,d);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,g);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,e,0);if(b.checkFramebufferStatus(b.FRAMEBUFFER)!=b.FRAMEBUFFER_COMPLETE)throw y.thrown("Error: Framebuffer not complete!");b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindRenderbuffer(b.RENDERBUFFER,null);this.pickFB=d;this.background=
new Ve(this.gl);this.displayList=new Yd(new Db);this.framebufferDisplayList=new Yd(new Db);c&&(a.onRender.add(p(this,this.render)),a.onResize.add(p(this,this.resize)))};d["peote.view.PeoteView"]=me;me.__name__=!0;me.prototype={isTextureStateChange:function(a,b){return b.updated?(b.updated=!1,this.glStateTexture=Array(this.maxTextureImageUnits),this.glStateTexture[a]=b.glTexture,!0):this.glStateTexture[a]!=b.glTexture?(this.glStateTexture[a]=b.glTexture,!0):!1},start:function(){if(!this.isRun){var a=
this.stopTime;this.startTime=this.stopTime=(new Date).getTime()/1E3-a;this.isRun=!0}},addDisplay:function(a,b,c){null==c&&(c=!1);a.addToPeoteView(this,b,c)},removeDisplay:function(a){a.removeFromPeoteView(this)},addFramebufferDisplay:function(a,b,c){null==c&&(c=!1);a.addToPeoteViewFramebuffer(this,b,c)},resize:function(a,b){this.width=a;this.height=b;if(I.isUBO){var c=this.uniformBuffer,e=this.gl;c.uniformBytes.b_UFloat32[0]=a;c.uniformBytes.b_UFloat32[1]=b;e.bindBuffer(e.UNIFORM_BUFFER,c.uniformBuffer);
e.bufferSubData(e.UNIFORM_BUFFER,0,c.resolutionBufferPointer);e.bindBuffer(e.UNIFORM_BUFFER,null)}},renderToTexture:function(a,b){if(null!=a.fbTexture){b=null!=b?b:a.framebufferTextureSlot;null==b&&(b=a.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.fbTexture.framebuffer);this.gl.viewport(b%a.fbTexture.slotsX*a.fbTexture.slotWidth,a.fbTexture.slotHeight*Math.floor(b/a.fbTexture.slotsX),a.fbTexture.slotWidth,a.fbTexture.slotHeight);this.gl.scissor(b%a.fbTexture.slotsX*a.fbTexture.slotWidth,
a.fbTexture.slotHeight*Math.floor(b/a.fbTexture.slotsX),a.fbTexture.slotWidth,a.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);a.fbTexture.clearOnRenderInto?this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(a.backgroundEnabled){1!=
this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=a.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=0);this.background.render(a.red,a.green,a.blue,a.alpha)}for(a.programListItem=a.programList.first;null!=a.programListItem;){b=a.programListItem.value;b.gl.useProgram(b.glProgram);for(b.textureListItem=
b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),b.gl.uniform1i(b.textureListItem.value.uniformLoc,b.textureListItem.value.unit),b.textureListItem=b.textureListItem.next;I.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,a.uniformBufferViewFB.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,
1,a.uniformBufferFB.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,a.width,-a.height),b.gl.uniform2f(b.uZOOM,a.xz,a.yz),b.gl.uniform2f(b.uOFFSET,(a.xOffset+this.xOffset)/a.xz,(a.yOffset+this.yOffset-a.height)/a.yz));b.gl.uniform1f(b.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(var e=b.uniformFloats.length;c<e;){var g=c++;b.gl.uniform1f(b.uniformFloatLocations[g],b.uniformFloats[g].value)}c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,
c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),
0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);b.buffer.render(this,a,b);b.gl.useProgram(null);a.programListItem=a.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);a.fbTexture.createMipmaps&&
(this.gl.bindTexture(this.gl.TEXTURE_2D,a.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null),a.fbTexture.updated=!0)}},render:function(a){for(this.displayListItem=this.framebufferDisplayList.first;null!=this.displayListItem;){if(this.displayListItem.value._renderFramebufferEnabled)if(this.displayListItem.value.renderFramebufferFrame==this.displayListItem.value.renderFramebufferSkipFrames){var b=this.displayListItem.value;a=null;null==a&&(a=
b.framebufferTextureSlot);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b.fbTexture.framebuffer);this.gl.viewport(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.scissor(a%b.fbTexture.slotsX*b.fbTexture.slotWidth,b.fbTexture.slotHeight*Math.floor(a/b.fbTexture.slotsX),b.fbTexture.slotWidth,b.fbTexture.slotHeight);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);b.fbTexture.clearOnRenderInto?
this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT):this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);if(b.backgroundEnabled){1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0));var c=b.backgroundAlpha;c&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&
(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=this.maskState=0);this.background.render(b.red,b.green,b.blue,b.alpha)}for(b.programListItem=b.programList.first;null!=b.programListItem;){a=b.programListItem.value;a.gl.useProgram(a.glProgram);for(a.textureListItem=a.textureList.first;null!=a.textureListItem;)this.isTextureStateChange(a.textureListItem.value.unit,a.textureListItem.value.texture)&&(a.gl.activeTexture(a.gl.TEXTURE0+
a.textureListItem.value.unit),a.gl.bindTexture(a.gl.TEXTURE_2D,a.textureListItem.value.texture.glTexture)),a.gl.uniform1i(a.textureListItem.value.uniformLoc,a.textureListItem.value.unit),a.textureListItem=a.textureListItem.next;I.isUBO?(a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,0,b.uniformBufferViewFB.uniformBuffer),a.gl.bindBufferBase(a.gl.UNIFORM_BUFFER,1,b.uniformBufferFB.uniformBuffer)):(a.gl.uniform2f(a.uRESOLUTION,b.width,-b.height),a.gl.uniform2f(a.uZOOM,b.xz,b.yz),a.gl.uniform2f(a.uOFFSET,(b.xOffset+
this.xOffset)/b.xz,(b.yOffset+this.yOffset-b.height)/b.yz));a.gl.uniform1f(a.uTIME,(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(var e=a.uniformFloats.length;c<e;){var g=c++;a.gl.uniform1f(a.uniformFloatLocations[g],a.uniformFloats[g].value)}c=a.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=a.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=
!1,this.gl.disable(this.gl.DEPTH_TEST));(c=a.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=a.mask;e=a.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,
this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);a.buffer.render(this,b,a);a.gl.useProgram(null);b.programListItem=b.programListItem.next}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);b.fbTexture.createMipmaps&&(this.gl.bindTexture(this.gl.TEXTURE_2D,b.fbTexture.glTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,
null),b.fbTexture.updated=!0);this.displayListItem.value.renderFramebufferFrame=0}else this.displayListItem.value.renderFramebufferFrame++;this.displayListItem=this.displayListItem.next}b=this.width;c=this.height;this.gl.viewport(0,0,b,c);this.gl.scissor(0,0,b,c);this.gl.enable(this.gl.SCISSOR_TEST);this.gl.clearColor(this.red,this.green,this.blue,this.alpha);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT);this.gl.stencilMask(255);this.gl.blendFunc(this.gl.SRC_ALPHA,
this.gl.ONE_MINUS_SRC_ALPHA);this.gl.depthFunc(this.gl.LEQUAL);for(this.displayListItem=this.displayList.first;null!=this.displayListItem;){a=this.displayListItem.value;if(a.isVisible){b=this.width;c=this.height;var d=this.xz,f=this.yz;e=Math.floor((a.x+this.xOffset)*d);g=Math.floor((a.y+this.yOffset)*f);d=Math.floor(a.width*d);f=Math.floor(a.height*f);0>e&&(d+=e);e=Math.max(0,Math.min(b,e))|0;d=Math.max(0,Math.min(b-e,d))|0;0>g&&(f+=g);g=Math.max(0,Math.min(c,g))|0;f=Math.max(0,Math.min(c-g,f))|
0;this.gl.scissor(e,c-f-g,d,f);a.backgroundEnabled&&(1!=this.colorState&&(this.colorState=!0,this.gl.colorMask(!0,!0,!0,!0)),(c=a.backgroundDepth)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST)),(c=a.backgroundAlpha)&&!this.glStateAlpha?(this.glStateAlpha=!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND)),0!=this.maskState&&(this.gl.disable(this.gl.STENCIL_TEST),
this.maskState=this.maskState=0),this.background.render(a.red,a.green,a.blue,a.alpha));for(a.programListItem=a.programList.first;null!=a.programListItem;){b=a.programListItem.value;if(b.isVisible){b.gl.useProgram(b.glProgram);for(b.textureListItem=b.textureList.first;null!=b.textureListItem;)this.isTextureStateChange(b.textureListItem.value.unit,b.textureListItem.value.texture)&&(b.gl.activeTexture(b.gl.TEXTURE0+b.textureListItem.value.unit),b.gl.bindTexture(b.gl.TEXTURE_2D,b.textureListItem.value.texture.glTexture)),
b.gl.uniform1i(b.textureListItem.value.uniformLoc,b.textureListItem.value.unit),b.textureListItem=b.textureListItem.next;I.isUBO?(b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,0,this.uniformBuffer.uniformBuffer),b.gl.bindBufferBase(b.gl.UNIFORM_BUFFER,1,a.uniformBuffer.uniformBuffer)):(b.gl.uniform2f(b.uRESOLUTION,this.width,this.height),b.gl.uniform2f(b.uZOOM,this.xz*a.xz,this.yz*a.yz),b.gl.uniform2f(b.uOFFSET,(a.x+a.xOffset+this.xOffset)/a.xz,(a.y+a.yOffset+this.yOffset)/a.yz));b.gl.uniform1f(b.uTIME,
(this.isRun?(new Date).getTime()/1E3-this.startTime:this.stopTime)*this.speed);c=0;for(e=b.uniformFloats.length;c<e;)g=c++,b.gl.uniform1f(b.uniformFloatLocations[g],b.uniformFloats[g].value);c=b.colorEnabled;c!=this.colorState&&(this.colorState=c,this.gl.colorMask(c,c,c,c));(c=b.zIndexEnabled)&&!this.glStateDepth?(this.glStateDepth=!0,this.gl.enable(this.gl.DEPTH_TEST)):!c&&this.glStateDepth&&(this.glStateDepth=!1,this.gl.disable(this.gl.DEPTH_TEST));(c=b.alphaEnabled)&&!this.glStateAlpha?(this.glStateAlpha=
!0,this.gl.enable(this.gl.BLEND)):!c&&this.glStateAlpha&&(this.glStateAlpha=!1,this.gl.disable(this.gl.BLEND));c=b.mask;e=b.clearMask;c!=this.maskState&&(0==c?(this.gl.disable(this.gl.STENCIL_TEST),this.maskState=c):2==c?(e&&this.gl.clear(this.gl.STENCIL_BUFFER_BIT),0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.stencilOp(this.gl.REPLACE,this.gl.REPLACE,this.gl.REPLACE),this.maskState=c):(0==this.maskState&&this.gl.enable(this.gl.STENCIL_TEST),
this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.stencilFunc(this.gl.EQUAL,1,255)),this.maskState=c);b.buffer.render(this,a,b);b.gl.useProgram(null)}a.programListItem=a.programListItem.next}}this.displayListItem=this.displayListItem.next}},__class__:me};var Nd=function(a,b,c){this.unit=a;this.texture=b;this.uniformLoc=c};d["peote.view.ActiveTexture"]=Nd;Nd.__name__=!0;Nd.prototype={__class__:Nd};var Nc=function(a,b,c,e,g,d,f,k,l){null==l&&(l=16384);null==k&&(k=!1);null==f&&(f=0);
null==d&&(d=0);null==g&&(g=!1);null==e&&(e=4);null==c&&(c=1);this.displays=[];this.programs=[];this.useFloat=this.updated=!1;this.magFilter=this.minFilter=0;this.createMipmaps=!1;this.images=new Db;this.imageSlots=this.freeSlots=this.slotsX=this.slotsY=this.tilesX=this.tilesY=1;this.width=this.height=0;this.colorChannels=4;this.clearOnRenderInto=!0;this.gl=this.glTexture=this.framebuffer=this.glDepthBuffer=null;this.slotWidth=a;this.slotHeight=b;this.imageSlots=this.freeSlots=c;this.colorChannels=
e;this.createMipmaps=g;this.magFilter=f;this.minFilter=d;this.useFloat=k;a=Sb.optimalTextureSize(c,a,b,l);this.width=a.width;this.height=a.height;this.slotsX=a.slotsX;this.slotsY=a.slotsY};d["peote.view.Texture"]=Nc;Nc.__name__=!0;Nc.prototype={setImage:function(a,b,c,e){null==b&&(b=0);if(null!=this.images.h.__keys__[a.__id__])throw y.thrown("Error, image is already inside texture inside slot "+this.images.h[a.__id__].imageSlot);null!=c&&(this.tilesX=c);null!=e&&(this.tilesY=e);this.images.set(a,
{imageSlot:b});this.freeSlots--;if(null!=this.gl){if(null==this.glTexture){if(this.width>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)||this.height>this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE))throw y.thrown("Error, texture size is greater then gl.MAX_TEXTURE_SIZE");this.glTexture=Sb.createEmptyTexture(this.gl,this.width,this.height,this.colorChannels,this.createMipmaps,this.magFilter,this.minFilter,this.useFloat)}this.bufferImage(a,{imageSlot:b})}},bufferImage:function(a,b){var c=this.gl,e=b.imageSlot%
this.slotsX*this.slotWidth;b=this.slotHeight*Math.floor(b.imageSlot/this.slotsX);var g=a.width,d=a.height,f=this.createMipmaps,k=this.useFloat;null==k&&(k=!1);null==f&&(f=!1);c.bindTexture(c.TEXTURE_2D,this.glTexture);if(k){k=g*d*4;k=null!=k?new Float32Array(k):null;for(var l=0,n=g*d*4;l<n;){var C=l++;k[C]=bb.toFloat(a.get_data()[C])/bb.toFloat(255)}c.texSubImage2D(c.TEXTURE_2D,0,e,b,g,d,c.RGBA,c.FLOAT,k)}else c.texSubImage2D(c.TEXTURE_2D,0,e,b,g,d,c.RGBA,c.UNSIGNED_BYTE,a.get_data());f&&c.generateMipmap(c.TEXTURE_2D);
c.bindTexture(c.TEXTURE_2D,null);this.updated=!0},__class__:Nc};var Wd=function(){var a=this.uniformBytes=new Va(new ArrayBuffer(32)),b=0;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=4;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,
b)};d["peote.view.UniformBufferDisplay"]=Wd;Wd.__name__=!0;Wd.prototype={createGLBuffer:function(a,b,c,e,g){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=g;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},
__class__:Wd};var Xd=function(){var a=this.uniformBytes=new Va(new ArrayBuffer(48)),b=0;null==b&&(b=0);this.resolutionBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=8;null==b&&(b=0);this.xOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=12;null==b&&(b=0);this.yOffestBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=16;null==b&&(b=0);this.xZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b);a=this.uniformBytes;b=20;null==
b&&(b=0);this.yZoomBufferPointer=a=new Uint8Array(a.b.bufferValue,b)};d["peote.view.UniformBufferView"]=Xd;Xd.__name__=!0;Xd.prototype={createGLBuffer:function(a,b,c,e,g,d,f){this.uniformBuffer=a.createBuffer();this.uniformBytes.b_UFloat32[0]=b;this.uniformBytes.b_UFloat32[1]=c;this.uniformBytes.b_UFloat32[2]=e;this.uniformBytes.b_UFloat32[3]=g;this.uniformBytes.b_UFloat32[4]=d;this.uniformBytes.b_UFloat32[5]=f;a.bindBuffer(a.UNIFORM_BUFFER,this.uniformBuffer);b=new Uint8Array(this.uniformBytes.b.bufferValue,
0);a.bufferData(a.UNIFORM_BUFFER,b,a.STATIC_DRAW);a.bindBuffer(a.UNIFORM_BUFFER,null)},deleteGLBuffer:function(a){a.deleteBuffer(this.uniformBuffer)},__class__:Xd};var ff=function(a,b){this.name=a;this.value=b};d["peote.view.UniformFloat"]=ff;ff.__name__=!0;ff.prototype={__class__:ff};var Ve=function(a){this.gl=a;this.createBuffer();this.createProgram()};d["peote.view.utils.Background"]=Ve;Ve.__name__=!0;Ve.prototype={createBuffer:function(){var a=new Va(new ArrayBuffer(32));a.b_UFloat32[0]=1;a.b_UFloat32[1]=
1;a.b_UFloat32[2]=0;a.b_UFloat32[3]=1;a.b_UFloat32[4]=1;a.b_UFloat32[5]=0;a.b_UFloat32[6]=0;a.b_UFloat32[7]=0;this.buffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);a=new Uint8Array(a.b.bufferValue,0);this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},createProgram:function(){var a="",b=Na.VertexFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Na.VertexFloat,null!=(0<b.medium?"mediump":0<b.low?
"lowp":null)&&(a="precision mediump float;"));b=this.gl;var c=this.gl.VERTEX_SHADER,e=b.createShader(c);b.shaderSource(e,a+"\t\n\t\t\tattribute vec2 aPosition;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_Position = mat4 (\n\t\t\t\t\tvec4(2.0, 0.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, -2.0, 0.0, 0.0),\n\t\t\t\t\tvec4(0.0, 0.0, -1.0, 0.0),\n\t\t\t\t\tvec4(-1.0, 1.0, 0.0, 1.0)\n\t\t\t\t) * vec4 (aPosition, -1.0 ,1.0);\n\t\t\t}\n\t\t");b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw y.thrown("ERROR compiling "+
(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+w.string(b.getShaderInfoLog(e)));var g=e;b=Na.FragmentFloat;null!=(0<b.low?"lowp":null)?a="precision lowp float;":(b=Na.FragmentFloat,null!=(0<b.medium?"mediump":0<b.low?"lowp":null)&&(a="precision mediump float;"));b=this.gl;c=this.gl.FRAGMENT_SHADER;e=b.createShader(c);b.shaderSource(e,a+"\n\t\t\tuniform vec4 uRGBA;\n\t\t\tvoid main(void)\n\t\t\t{\n\t\t\t\tgl_FragColor = uRGBA;\n\t\t\t\t\n\t\t\t\t// TODO: Fix for old FF\n\t\t\t\tgl_FragColor.w = clamp(uRGBA.w, 0.003, 1.0);\n\t\t\t}\n\t\t");
b.compileShader(e);if(0==b.getShaderParameter(e,b.COMPILE_STATUS))throw y.thrown("ERROR compiling "+(c==b.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+w.string(b.getShaderInfoLog(e)));a=e;this.glProgram=this.gl.createProgram();this.gl.attachShader(this.glProgram,g);this.gl.attachShader(this.glProgram,a);this.gl.deleteShader(g);this.gl.deleteShader(a);this.gl.bindAttribLocation(this.glProgram,0,"aPosition");b=this.gl;g=this.glProgram;b.linkProgram(g);if(0==b.getProgramParameter(g,b.LINK_STATUS))throw y.thrown(w.string(b.getProgramInfoLog(g))+
"VALIDATE_STATUS: "+w.string(b.getProgramParameter(g,b.VALIDATE_STATUS))+"ERROR: "+w.string(b.getError()));this.uRGBA=this.gl.getUniformLocation(this.glProgram,"uRGBA")},render:function(a,b,c,e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer);this.gl.enableVertexAttribArray(0);this.gl.vertexAttribPointer(0,2,this.gl.FLOAT,!1,8,0);this.gl.useProgram(this.glProgram);this.gl.uniform4f(this.uRGBA,a,b,c,e);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);this.gl.disableVertexAttribArray(0);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
null)},__class__:Ve};var Va=function(a){this.length=a.byteLength;this.b=new Uint8Array(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b;this.b_UFloat32=new Float32Array(a);this.b_Int32=new Int32Array(a);this.b_Uint16=new Uint16Array(a)};d["peote.view.utils.BufferBytes"]=Va;Va.__name__=!0;Va.prototype={blit:function(a,b,c,e){0==c&&e==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+e),a)},fill:function(a,b,c){for(var e=0;e<b;)e++,this.b[a++]=c},__class__:Va};var Ma=function(){};d["peote.view.utils.GLTool"]=
Ma;Ma.__name__=!0;Ma.clearGlErrorQueue=function(a){for(;a.getError()!=a.NO_ERROR;);};Ma.getLastGlError=function(a){var b=a.getError();b!=a.NO_ERROR&&(b==a.INVALID_ENUM?fa.trace("(GL-Error: INVALID_ENUM)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:22,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.INVALID_VALUE?fa.trace("(GL-Error: INVALID_VALUE)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:23,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==
a.INVALID_OPERATION?fa.trace("(GL-Error: INVALID_OPERATION)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:24,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):b==a.OUT_OF_MEMORY?fa.trace("(GL-Error: OUT_OF_MEMORY)",{fileName:"peote/view/utils/GLTool.hx",lineNumber:25,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}):fa.trace("GL-Error: "+b,{fileName:"peote/view/utils/GLTool.hx",lineNumber:26,className:"peote.view.utils.GLTool",methodName:"getLastGlError"}));return b};
var jc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_ActiveTexture"]=jc;jc.__name__=!0;jc.prototype={__class__:jc};var xc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_Display"]=xc;xc.__name__=!0;xc.prototype={__class__:xc};var yc=function(a,b,c){this.value=a;this.next=c;this.prev=b;null!=b&&(b.next=
this);null!=c&&(c.prev=this)};d["peote.view.utils.RenderListItem_peote_view_Program"]=yc;yc.__name__=!0;yc.prototype={__class__:yc};var Md=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_ActiveTexture"]=Md;Md.__name__=!0;Md.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new jc(a,null,null);else if(null==b)b=this.first=new jc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new jc(a,c.prev,c),c==this.first&&(this.first=
b);else throw y.thrown("Error on add: "+w.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new jc(a,null,null);else if(null==b)b=this.last=new jc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new jc(a,c,c.next),c==this.last&&(this.last=b);else throw y.thrown("Error on add: "+w.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=
c.prev));this.itemMap.set(a,b)},clear:function(){for(;null!=this.first;){null!=this.last.value&&this.itemMap.remove(this.last.value);var a=this.last;a==this.first&&(this.first=a.next);a==this.last&&(this.last=a.prev);null!=a.prev&&(a.prev.next=a.next);null!=a.next&&(a.next.prev=a.prev)}},__class__:Md};var Yd=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_Display"]=Yd;Yd.__name__=!0;Yd.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=
this.last=new xc(a,null,null);else if(null==b)b=this.first=new xc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new xc(a,c.prev,c),c==this.first&&(this.first=b);else throw y.thrown("Error on add: "+w.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=new xc(a,null,null);else if(null==b)b=this.last=new xc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new xc(a,c,c.next),c==this.last&&(this.last=b);else throw y.thrown("Error on add: "+w.string(b)+" is not in list.");
c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},remove:function(a){var b=this.itemMap.get(a);if(null!=b)this.itemMap.remove(a),b==this.first&&(this.first=b.next),b==this.last&&(this.last=b.prev),null!=b.prev&&(b.prev.next=b.next),null!=b.next&&(b.next.prev=b.prev);else throw y.thrown("Error on remove: "+w.string(a)+" is not in list.");},has:function(a){return this.itemMap.exists(a)},
__class__:Yd};var Ue=function(a){this.first=this.last=null;this.itemMap=a};d["peote.view.utils.RenderList_peote_view_Program"]=Ue;Ue.__name__=!0;Ue.prototype={add:function(a,b,c){if(c)if(null==this.first)b=this.first=this.last=new yc(a,null,null);else if(null==b)b=this.first=new yc(a,null,this.first);else if(c=this.itemMap.get(b),null!=c)b=new yc(a,c.prev,c),c==this.first&&(this.first=b);else throw y.thrown("Error on add: "+w.string(b)+" is not in list.");else if(null==this.last)b=this.first=this.last=
new yc(a,null,null);else if(null==b)b=this.last=new yc(a,this.last,null);else if(c=this.itemMap.get(b),null!=c)b=new yc(a,c,c.next),c==this.last&&(this.last=b);else throw y.thrown("Error on add: "+w.string(b)+" is not in list.");c=this.itemMap.get(a);null!=c&&(c==this.first&&(this.first=c.next),c==this.last&&(this.last=c.prev),null!=c.prev&&(c.prev.next=c.next),null!=c.next&&(c.next.prev=c.prev));this.itemMap.set(a,b)},__class__:Ue};var Sb=function(){};d["peote.view.utils.TexUtils"]=Sb;Sb.__name__=
!0;Sb.createEmptyTexture=function(a,b,c,e,g,d,f,k){null==k&&(k=!1);null==f&&(f=0);null==d&&(d=0);null==g&&(g=!1);e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e);Ma.clearGlErrorQueue(a);if(k){k=a.TEXTURE_2D;var h=a.RGBA32F,l=a.RGBA,n=a.FLOAT,r=0;0==r?a.texImage2D(k,0,h,b,c,0,l,n,null):a.texImage2D(k,0,h,b,c,0,l,n,r);Ma.getLastGlError(a)==a.INVALID_VALUE&&(fa.trace("switching to RGBA16F for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:25,className:"peote.view.utils.TexUtils",
methodName:"createEmptyTexture"}),k=a.TEXTURE_2D,h=a.RGBA16F,l=a.RGBA,n=a.FLOAT,r=0,0==r?a.texImage2D(k,0,h,b,c,0,l,n,null):a.texImage2D(k,0,h,b,c,0,l,n,r),Ma.getLastGlError(a)==a.INVALID_VALUE&&(fa.trace("switching to RGBA for float precision texture creation",{fileName:"peote/view/utils/TexUtils.hx",lineNumber:28,className:"peote.view.utils.TexUtils",methodName:"createEmptyTexture"}),k=a.TEXTURE_2D,l=h=a.RGBA,n=a.FLOAT,r=0,0==r?a.texImage2D(k,0,h,b,c,0,l,n,null):a.texImage2D(k,0,h,b,c,0,l,n,r)))}else k=
a.TEXTURE_2D,l=h=a.RGBA,n=a.UNSIGNED_BYTE,r=0,0==r?a.texImage2D(k,0,h,b,c,0,l,n,null):a.texImage2D(k,0,h,b,c,0,l,n,r);if(Ma.getLastGlError(a)==a.OUT_OF_MEMORY)throw y.thrown("OUT OF GPU MEMORY while texture creation");1==d?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);if(g)switch(f){case 1:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR);break;case 2:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.NEAREST_MIPMAP_NEAREST);break;case 3:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_LINEAR);break;default:a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST)}else 1==f?a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);g&&a.generateMipmap(a.TEXTURE_2D);a.bindTexture(a.TEXTURE_2D,
null);return e};Sb.createPickingTexture=function(a,b){null==b&&(b=!1);var c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c);if(b){b=a.TEXTURE_2D;var e=a.RGBA32I,g=a.RGBA_INTEGER,d=a.INT,f=0}else b=a.TEXTURE_2D,g=e=a.RGBA,d=a.UNSIGNED_BYTE,f=0;0==f?a.texImage2D(b,0,e,1,1,0,g,d,null):a.texImage2D(b,0,e,1,1,0,g,d,f);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null);return c};Sb.optimalTextureSize=function(a,b,c,e,g,d){null==g&&(g=!0);d=Math.ceil(Math.log(e)/Math.log(2));for(var h=Math.ceil(Math.log(a*b*c)/Math.log(2)),f,l=1,n=h-1,C=Math.floor(Math.abs(l-n)),r=(1<<d)*(1<<d),q=!1,v=Math.floor(Math.min(d,h)),V;1<<v>=b;){for(V=Math.floor(Math.min(d,h-v+1));1<<V>=c&&!(Math.floor((1<<v)/b)*Math.floor((1<<V)/c)<a);){f=(1<<v)*(1<<V)-a*b*c;if(0>f)break;f<=r&&(f==r?Math.abs(v-V)<C&&(C=Math.floor(Math.abs(v-
V)),l=v,n=V,q=!0):(l=v,n=V,r=f,q=!0));--V}--v}if(q)l=1<<l,n=1<<n;else{if(g)throw y.thrown("Error: max texture-size ("+e+") is to small for "+a+" images ("+b+" x "+c+")");if(b>e||c>e)throw y.thrown("Error: max texture-size ("+e+") is to small for image ("+b+" x "+c+")");l=n=e}return{width:l,height:n,slotsX:l/b|0,slotsY:n/c|0,imageSlots:(l/b|0)*(n/c|0)}};var ic=function(){};d["peote.view.utils.Util"]=ic;ic.__name__=!0;ic.resolveFormulaCyclic=function(a){for(var b=[],c=a.h,e=Object.keys(c),g=e.length,
d=0;d<g;)if(c=e[d++],c=ic.resolveFormulaKey(c,a,b),null!=c.errKey)throw y.thrown(c);c=a.h;b=Object.keys(c);e=b.length;for(g=0;g<e;)c=b[g++],d=a.h[c].replace(/___:::___/g,""),a.h[c]=d};ic.resolveFormulaKey=function(a,b,c,e){null==e&&(e=[a]);null==c&&(c=[]);var g=b.h[a];if(0<=c.indexOf(a))return{formula:g,errKey:null,errVar:null};for(var d=Object.keys(b.h),f=d.length,k=0;k<f;){var l=d[k++];if(l!=a){var n=new D("(^|.*?[^\\w.])"+l+"\\b.*?","g");if(n.match(g)){if(0<=e.indexOf(l))return{formula:g,errKey:a,
errVar:l};l=ic.resolveFormulaKey(l,b,c,e.concat([l]));if(null!=l.errKey)return l;g=g.replace(n.r,"$1(___:::___"+l.formula+"___:::___)")}}}b.h[a]=g;c.push(a);return{formula:g,errKey:null,errVar:null}};ic.resolveFormulaVars=function(a,b){for(var c=a.h,e=Object.keys(c),g=e.length,d=0;d<g;){var f=e[d++],k=a.h[f];c=b.h;c=Object.keys(c);for(var l=c.length,n=0;n<l;){var C=c[n++],r=new D("(^|.*?[^\\w.])"+C+"\\b.*?","g");r.match(k)&&(k=k.replace(r.r,"$1("+b.h[C]+")"))}a.h[f]=k}};var ed=function(a,b,c,e,g){this.char=
a;this.glyph=b;this.paletteIndexFg=c;this.paletteIndexBg=e;this.bgIntensity=g};d["tyke.GlyphModel"]=ed;ed.__name__=!0;ed.prototype={__class__:ed};var ke=function(a,b){this.numCellsWide=a;this.numCellsHigh=b};d["tyke.GlyphLoopConfig"]=ke;ke.__name__=!0;ke.prototype={__class__:ke};var se=function(a,b){null==b&&(b=-1);this.defaultBgIndex=b;this.colors=a};d["tyke.Palette"]=se;se.__name__=!0;se.prototype={__class__:se};var Cc=function(){};d["tyke.IHaveGraphicsBuffer"]=Cc;Cc.__name__=!0;Cc.__isInterface__=
!0;Cc.prototype={__class__:Cc,__properties__:{get_program:"get_program"}};var gf=v["tyke.Geometry"]={__ename__:!0,__constructs__:null,RECT:{_hx_name:"RECT",_hx_index:0,__enum__:"tyke.Geometry",toString:n},CIRCLE:{_hx_name:"CIRCLE",_hx_index:1,__enum__:"tyke.Geometry",toString:n},POLYGON:(f=function(a){return{_hx_index:2,numSides:a,__enum__:"tyke.Geometry",toString:n}},f._hx_name="POLYGON",f.__params__=["numSides"],f)};gf.__constructs__=[gf.RECT,gf.CIRCLE,gf.POLYGON];var We=function(a){this.frameBuffer=
a;this.buffers=[]};d["tyke.Layer"]=We;We.__name__=!0;We.prototype={updateGraphicsBuffers:function(){for(var a=0,b=this.buffers;a<b.length;){var c=b[a];++a;c.updateGraphicsBuffers()}},registerGraphicsBuffer:function(a){this.buffers.push(a)},addProgramToFrameBuffer:function(a){this.frameBuffer.display.addProgram(a)},get_display:function(){return this.frameBuffer.display},__class__:We,__properties__:{get_display:"get_display"}};var Zd=function(a){this.text=hf.initText(null,a)};d["tyke.GlyphRenderer"]=
Zd;Zd.__name__=!0;Zd.__interfaces__=[Cc];Zd.prototype={get_program:function(){return this.text.fontProgram},get_fontProgram:function(){return this.text.fontProgram},updateGraphicsBuffers:function(){this.text.fontProgram._buffer.update()},__class__:Zd,__properties__:{get_fontProgram:"get_fontProgram",get_program:"get_program"}};var ta=function(a,b,c,e,g,d,f){null==f&&(f=-1);null==d&&(d=3);null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.shape=0;this.sides=3;this.x=this.y=0;this.color=-1430585089;
this.w=this.h=100;this.px_offset=this.py_offset=this.rotation=0;this.x=a;this.y=b;this.w=c;this.h=e;this.shape=g;this.color=f;this.sides=d};d["tyke.Shape"]=ta;ta.__name__=!0;ta.prototype={__class__:ta};var $d=function(a){null==a&&(a=256);this.buffer=new Td(a,a,!0);this._program=new Jb(this.buffer);this._program.setFragmentFloatPrecision("high");this._program.discardAtAlpha(null);this._program.injectIntoFragmentShader(ta.InjectFragment,!1);this._program.setColorFormula(ta.ColorFormula)};d["tyke.ShapeRenderer"]=
$d;$d.__name__=!0;$d.__interfaces__=[Cc];$d.prototype={get_program:function(){return this._program},makeShape:function(a,b,c,e,g,d){null==d&&(d=-855703297);switch(g._hx_index){case 0:var h=0;break;case 1:h=1;break;default:h=2}switch(g._hx_index){case 1:g=1;break;case 2:g=g.numSides;break;default:g=4}g=new ta(a|0,b|0,c,e,h,g,d);this.buffer.addElement(g);return g},updateGraphicsBuffers:function(){this.buffer.update()},__class__:$d,__properties__:{get_program:"get_program"}};var ra=function(a,b,c,e,
g,d,f){null==f&&(f=!0);null==d&&(d=-1);null==g&&(g=0);null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.x=this.y=0;this.shakeDurationY=.9;this.shakeDurationX=1.2;this.shakeDistanceY=this.shakeDistanceX=3;this.shakeFrequencyY=this.shakeFrequencyX=6;this.shakeAtTime=-100;this.tile=0;this.c=-1430585089;this.slot=0;this.w=this.h=100;this.px_offset=this.py_offset=this.rotation=0;this.x=a;this.y=b;this.w=c;this.h=e;this.width=this.w;this.height=this.h;this.c=d;this.tile=g;this.set_visible(f)};d["tyke.Sprite"]=
ra;ra.__name__=!0;ra.prototype={set_visible:function(a){this.c=this.c&-256|(a?255:0);return a},attachDebug:function(a){this.debugElement=a},move:function(a,b){this.x=a;this.y=b;null!=this.debugElement&&(this.debugElement.x=a,this.debugElement.y=b)},rotate:function(a){this.rotation=a;null!=this.debugElement&&(this.debugElement.rotation=a)},__class__:ra,__properties__:{set_visible:"set_visible"}};var ae=function(a,b,c){null==c&&(c=256);this.spriteSheet=new Nc(a.width,a.height);this.spriteSheet.tilesX=
a.width/b|0;this.spriteSheet.tilesY=a.height/b|0;this.spriteSheet.setImage(a,0);this.buffer=new Ud(c,c,!0);this._program=new Jb(this.buffer);this._program.setFragmentFloatPrecision("high");this._program.discardAtAlpha(null);this._program.injectIntoVertexShader(ra.InjectVertex,!0);this._program.injectIntoFragmentShader(ra.InjectFragment,!1);this._program.addTexture(this.spriteSheet,"base")};d["tyke.SpriteRenderer"]=ae;ae.__name__=!0;ae.__interfaces__=[Cc];ae.prototype={get_program:function(){return this._program},
makeSprite:function(a,b,c,e,d,h){null==h&&(h=!0);a=new ra(a,b,c,c,e,null,h);this.buffer.addElement(a);return a},updateGraphicsBuffers:function(){this.buffer.update()},__class__:ae,__properties__:{get_program:"get_program"}};var ha=function(a,b,c,e,d){null==e&&(e=100);null==c&&(c=100);null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.c=-16776961;this.slot=0;this.w=this.h=100;this.x=this.y=0;this.x=a;this.y=b;this.w=c;this.h=e;this.c=d};d["tyke.FilterElement"]=ha;ha.__name__=!0;ha.prototype={__class__:ha};
var qe=function(a,b,c,e){null==e&&(e=!1);this.buffer=new Sd(1,1,!0);this.program=new Jb(this.buffer);this.program.discardAtAlpha(null);tc.RGBA(1127270,204);a=new ha(0,0,a,b,255);this.buffer.addElement(a);this.program.injectIntoFragmentShader(c,e);this.program.setColorFormula("compose()")};d["tyke.Filter"]=qe;qe.__name__=!0;qe.prototype={addToDisplay:function(a){a.addProgram(this.program)},__class__:qe};var cd=function(a,b){this.numColumns=a;this.numRows=b};d["tyke.GridLogic"]=cd;cd.__name__=!0;cd.prototype=
{column:function(a){return a%this.numColumns|0},row:function(a){return a/this.numColumns|0},__class__:cd};var bc=function(a,b,c){cd.call(this,a,b);this.cellInit=c;this.init()};d["tyke.GridStructure"]=bc;bc.__name__=!0;bc.__super__=cd;bc.prototype=F(cd.prototype,{init:function(){this.cells=[];for(var a=0,b=this.numColumns*this.numRows;a<b;){var c=a++,e=this.column(c);c=this.row(c);this.cells.push(this.cellInit(e,c))}},forEach:function(a,b){null==b&&(b=!1);if(b)for(b=this.cells.length;0<b--;)a(this.column(b),
this.row(b),this.cells[b]);else for(var c=0,e=this.cells;c<e.length;){var d=e[c];b=c++;a(this.column(b),this.row(b),d)}},__class__:bc});var oe=function(a){this.sortOrder=[];this.bindings=new xb;for(var b=0;b<a.length;){var c=a[b];++b;this._bind(c)}};d["tyke.KeyPresses_tyke_PhysicalStageLoop"]=oe;oe.__name__=!0;oe.prototype={handle:function(a,b){this.lastHandled=a;this.bindings.exists(a)&&this.bindings.get(a).handle(b)},_bind:function(a){this.sortOrder.push(a.code);this.bindings.set(a.code,a)},bind:function(a,
b,c,e){this._bind({description:c,label:b,code:a,handle:e})},__class__:oe};var re=function(a,b,c,e,d,h){this.numColumns=a;this.numRows=b;this.cellWidth=c;this.cellHeight=e;this.palette=d;this.cellInit=h};d["tyke.LayerConfig"]=re;re.__name__=!0;re.prototype={__class__:re};var fd=function(a,b){bc.call(this,a.numColumns,a.numRows,a.cellInit);this.palette=a.palette;this.fontProgram=b;b.fontStyle.bgColor=0;null==a.cellInit&&(a.cellInit=function(c,e){c*=a.cellWidth;e*=a.cellHeight;var d=b.fontStyle,h=b.font;
h=32>=h.rangeMapping.min&&32<=h.rangeMapping.max?h.rangeMapping:null;if(null!=h){var f=new va;d=null!=d?d:b.fontStyle;f.width=d.width;f.height=d.height;f.color=d.color;f.bgColor=d.bgColor;f.weight=d.weight;f.tilt=d.tilt;f.zIndex=d.zIndex;f.char=32;f.tile=32-h.min;f.x=c;f.y=e;b._buffer.addElement(f);c=f}else c=null;return new ed(0,c,10,-1,1)})};d["tyke.GlyphGrid"]=fd;fd.__name__=!0;fd.__super__=bc;fd.prototype=F(bc.prototype,{__class__:fd});var Xe=function(a,b,c){this.font=a;this.fontStyle=b;this.fontProgram=
c};d["tyke.Text"]=Xe;Xe.__name__=!0;Xe.prototype={__class__:Xe};var hf=function(){};d["tyke.Glyphs"]=hf;hf.__name__=!0;hf.initText=function(a,b){var c=b.createFontStyle();c.width=b.config.width;c.height=b.config.height;var e=b.createFontProgram(c);null!=a&&a.addProgram(e);return new Xe(b,c,e)};var Ye=function(){};d["tyke.Sixteen"]=Ye;Ye.__name__=!0;var pe=function(a,b){this.layers=new aa;this.display=a;this.coreLoop=b;this.buffer=new Vd(1);this.program=new Jb(this.buffer);this.program.setFragmentFloatPrecision("high");
this.program.alphaEnabled=!0;this.program.discardAtAlpha(null);a.addProgram(this.program);this.view=new wa(0,0,a.width,a.height);this.buffer.addElement(this.view);this.globalFrameBuffer=this.makeFrameBuffer("globalFramebuffer",!1)};d["tyke.Stage"]=pe;pe.__name__=!0;pe.prototype={globalFilter:function(a,b){this.program.injectIntoFragmentShader(b,!0);this.program.setColorFormula(a)},chainFrameBuffer:function(a,b){this.program.addTexture(a.texture,b,!0)},makeFrameBuffer:function(a,b){b=this.coreLoop.getFrameBufferDisplay(this.display.x,
this.display.y,this.display.width,this.display.height,b);this.chainFrameBuffer(b,a);return b},createLayer:function(a,b,c){null==c&&(c=!0);b=c?this.globalFrameBuffer:this.makeFrameBuffer(a,b);b=new We(b);return this.layers.h[a]=b},initGraphicsBuffer:function(a,b,c,e){c=this.createLayer(a,c,!e);c.registerGraphicsBuffer(b);c.addProgramToFrameBuffer(b.get_program());this.layers.h[a]=c},createShapeRenderLayer:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);var e=new $d;this.initGraphicsBuffer(a,e,b,c);
return e},createSpriteRendererLayer:function(a,b,c,e,d){null==d&&(d=!1);null==e&&(e=!1);b=new ae(b,c);this.initGraphicsBuffer(a,b,e,d);return b},createGlyphRendererLayer:function(a,b,c,e){null==e&&(e=!1);null==c&&(c=!1);b=new Zd(b);this.initGraphicsBuffer(a,b,c,e);return b},updateGraphicsBuffers:function(){for(var a=this.layers.h,b=Object.keys(a),c=b.length,e=0;e<c;)a[b[e++]].updateGraphicsBuffers()},get_width:function(){return this.display.width},get_height:function(){return this.display.height},
__class__:pe,__properties__:{get_height:"get_height",get_width:"get_width"}};var wa=function(a,b,c,e){null==b&&(b=0);null==a&&(a=0);this.bytePos=-1;this.w=this.h=100;this.x=this.y=0;this.x=a;this.y=b;this.w=c;this.h=e};d["tyke.ViewElement"]=wa;wa.__name__=!0;wa.prototype={__class__:wa};var Ya=function(){};d["utils.Loader"]=Ya;Ya.__name__=!0;Ya.onProgressDebug=function(a,b,c){fa.trace("...loading "+a+"/"+b+' of "'+c+'"',{fileName:"utils/Loader.hx",lineNumber:11,className:"utils.Loader",methodName:"onProgressDebug"})};
Ya.onErrorDebug=function(a){fa.trace("Error - "+a,{fileName:"utils/Loader.hx",lineNumber:15,className:"utils.Loader",methodName:"onErrorDebug"})};Ya.onCompleteDebug=function(a){fa.trace('Loading complete "'+a+'"',{fileName:"utils/Loader.hx",lineNumber:19,className:"utils.Loader",methodName:"onCompleteDebug"})};var Ib=v["utils._MultipassTemplate.TemplateExpr"]={__ename__:!0,__constructs__:null,OpVar:(f=function(a){return{_hx_index:0,v:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},
f._hx_name="OpVar",f.__params__=["v"],f),OpExpr:(f=function(a){return{_hx_index:1,expr:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},f._hx_name="OpExpr",f.__params__=["expr"],f),OpIf:(f=function(a,b,c){return{_hx_index:2,expr:a,eif:b,eelse:c,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},f._hx_name="OpIf",f.__params__=["expr","eif","eelse"],f),OpStr:(f=function(a){return{_hx_index:3,str:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},f._hx_name="OpStr",
f.__params__=["str"],f),OpBlock:(f=function(a){return{_hx_index:4,l:a,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},f._hx_name="OpBlock",f.__params__=["l"],f),OpForeach:(f=function(a,b){return{_hx_index:5,expr:a,loop:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},f._hx_name="OpForeach",f.__params__=["expr","loop"],f),OpMacro:(f=function(a,b){return{_hx_index:6,name:a,params:b,__enum__:"utils._MultipassTemplate.TemplateExpr",toString:n}},f._hx_name="OpMacro",f.__params__=
["name","params"],f)};Ib.__constructs__=[Ib.OpVar,Ib.OpExpr,Ib.OpIf,Ib.OpStr,Ib.OpBlock,Ib.OpForeach,Ib.OpMacro];var Oa=function(a){a=this.parseTokens(a);this.expr=this.parseBlock(a);if(!a.isEmpty())throw y.thrown("Unexpected '"+w.string(a.first().s)+"'");};d["utils.MultipassTemplate"]=Oa;Oa.__name__=!0;Oa.prototype={execute:function(a,b){this.macros=null==b?{}:b;this.context=a;this.stack=new Ob;this.buf=new gb;this.run(this.expr);return this.buf.b},resolve:function(a){if("__current__"==a)return this.context;
var b=H.getProperty(this.context,a);if(null!=b||Object.prototype.hasOwnProperty.call(this.context,a))return b;for(var c=this.stack.h;null!=c;){b=c.item;c=c.next;var e=b;b=H.getProperty(e,a);if(null!=b||Object.prototype.hasOwnProperty.call(e,a))return b}if(!Object.prototype.hasOwnProperty.call(Oa.globals,a))throw y.thrown(a);return H.field(Oa.globals,a)},parseTokens:function(a){for(var b=new Ob;Oa.splitter.match(a);){var c=Oa.splitter.matchedPos();0<c.pos&&b.add({p:J.substr(a,0,c.pos),s:!0,l:null});
if(58==J.cca(a,c.pos))b.add({p:J.substr(a,c.pos+2,c.len-4),s:!1,l:null}),a=Oa.splitter.matchedRight();else{c=c.pos+c.len;for(var e=1,d=[],h="";;){var f=J.cca(a,c);++c;if(40==f)++e;else if(41==f){if(--e,0>=e)break}else if(null==f)throw y.thrown("Unclosed macro parenthesis");44==f&&1==e?(d.push(h),h=""):h+=String.fromCodePoint(f)}d.push(h);b.add({p:Oa.splitter.matched(2),s:!1,l:d});a=J.substr(a,c,a.length-c)}}0<a.length&&b.add({p:a,s:!0,l:null});return b},parseBlock:function(a){for(var b=new Ob;;){var c=
a.first();if(null==c)break;if(!c.s&&("end"==c.p||"else"==c.p||"elseif "==J.substr(c.p,0,7)))break;b.add(this.parse(a))}return 1==b.length?b.first():Ib.OpBlock(b)},parse:function(a){var b=a.pop(),c=b.p;if(b.s)return Ib.OpStr(c);if(null!=b.l){a=new Ob;var e=0;for(b=b.l;e<b.length;){var d=b[e];++e;a.add(this.parseBlock(this.parseTokens(d)))}return Ib.OpMacro(c,a)}if("if "==J.substr(c,0,3)){c=J.substr(c,3,c.length-3);e=null;try{e=this.parseExpr(c)}catch(h){ma.lastError=h;b=y.caught(h).unwrap();if("string"==
typeof b)throw fa.trace(b,{fileName:"utils/MultipassTemplate.hx",lineNumber:211,className:"utils.MultipassTemplate",methodName:"parse"}),y.thrown(b);throw h;}c=this.parseBlock(a);b=a.first();if(null==b)throw y.thrown("Unclosed 'if'");if("end"==b.p)a.pop(),d=null;else if("else"==b.p){if(a.pop(),d=this.parseBlock(a),b=a.pop(),null==b||"end"!=b.p)throw y.thrown("Unclosed 'else'");}else b.p=J.substr(b.p,4,b.p.length-4),d=this.parse(a);return Ib.OpIf(e,c,d)}if("foreach "==J.substr(c,0,8)){c=J.substr(c,
8,c.length-8);e=this.parseExpr(c);c=this.parseBlock(a);b=a.pop();if(null==b||"end"!=b.p)throw y.thrown("Unclosed 'foreach'");return Ib.OpForeach(e,c)}return Oa.expr_splitter.match(c)?Ib.OpExpr(this.parseExpr(c)):Ib.OpVar(c)},parseExpr:function(a){for(var b=new Ob,c=a;Oa.expr_splitter.match(a);){var e=Oa.expr_splitter.matchedPos();0!=e.pos&&b.add({p:J.substr(a,0,e.pos),s:!0});a=Oa.expr_splitter.matched(0);b.add({p:a,s:0<=a.indexOf('"')});a=Oa.expr_splitter.matchedRight()}0!=a.length&&b.add({p:a,s:!0});
try{var d=this.makeExpr(b);if(!b.isEmpty())throw y.thrown(b.first().p);}catch(h){ma.lastError=h;b=y.caught(h).unwrap();if("string"==typeof b)throw y.thrown("Unexpected '"+b+"' in "+c);throw h;}return function(){try{return d()}catch(x){ma.lastError=x;var a=y.caught(x).unwrap();throw y.thrown({v:a,expr:c});}}},makeConst:function(a){Oa.expr_trim.match(a);a=Oa.expr_trim.matched(1);if(34==J.cca(a,0)){var b=J.substr(a,1,a.length-2);return function(){return b}}if(Oa.expr_int.match(a)){var c=w.parseInt(a);
return function(){return c}}if(Oa.expr_float.match(a)){var e=parseFloat(a);return function(){return e}}var d=this;return function(){return d.resolve(a)}},makePath:function(a,b){var c=b.first();if(null==c||"."!=c.p)return a;b.pop();c=b.pop();if(null==c||!c.s)throw y.thrown(c.p);var e=c.p;Oa.expr_trim.match(e);e=Oa.expr_trim.matched(1);return this.makePath(function(){return H.field(a(),e)},b)},makeExpr:function(a){return this.makePath(this.makeExpr2(a),a)},makeExpr2:function(a){var b=a.pop();if(null==
b)throw y.thrown("<eof>");if(b.s)return this.makeConst(b.p);switch(b.p){case "!":var c=this.makeExpr(a);return function(){var a=c();return null!=a?0==a:!0};case "(":var e=this.makeExpr(a);b=a.pop();if(null==b||b.s)throw y.thrown(b);if(")"==b.p)return e;var d=this.makeExpr(a);a=a.pop();if(null==a||")"!=a.p)throw y.thrown(a);switch(b.p){case "!=":return function(){return e()!=d()};case "&&":return function(){return e()&&d()};case "*":return function(){return e()*d()};case "+":return function(){return e()+
d()};case "-":return function(){return e()-d()};case "/":return function(){return e()/d()};case "<":return function(){return e()<d()};case "<=":return function(){return e()<=d()};case "==":return function(){return e()==d()};case ">":return function(){return e()>d()};case ">=":return function(){return e()>=d()};case "||":return function(){return e()||d()};default:throw y.thrown("Unknown operation "+b.p);}case "-":var h=this.makeExpr(a);return function(){return-h()}}throw y.thrown(b.p);},run:function(a){switch(a._hx_index){case 0:var b=
a.v;try{var c=this.buf,e=w.string(this.resolve(b));c.b+=w.string(e)}catch(ba){ma.lastError=ba,this.buf.b+=w.string("::"+b+"::")}break;case 1:var d=a.expr;try{c=this.buf,e=w.string(d()),c.b+=w.string(e)}catch(ba){ma.lastError=ba,b=y.caught(ba).unwrap(),this.buf.b+=w.string("::("+w.string(b.expr)+")::")}break;case 2:d=a.expr;e=a.eif;c=a.eelse;try{b=d(),null==b||0==b?null!=c&&this.run(c):this.run(e)}catch(ba){ma.lastError=ba,b=y.caught(ba).unwrap(),this.buf.b+=w.string("::if "+w.string(b.expr)+"::"),
this.run(e),null!=c&&(this.buf.b+="::else::",this.run(c)),this.buf.b+="::end::"}break;case 3:b=a.str;this.buf.b+=null==b?"null":""+b;break;case 4:for(a=a.l.h;null!=a;){var h=a.item;a=a.next;d=h;this.run(d)}break;case 5:d=a.expr;c=a.loop;try{b=d();try{e=z(b);if(null==e.hasNext)throw y.thrown(null);b=e}catch(ba){ma.lastError=ba;try{if(null==b.hasNext)throw y.thrown(null);}catch(N){throw y.thrown("Cannot iter on "+w.string(b));}}for(this.stack.push(this.context);b.hasNext();)this.context=b.next(),this.run(c);
this.context=this.stack.pop()}catch(ba){ma.lastError=ba,b=y.caught(ba).unwrap(),this.buf.b+=w.string("::foreach "+w.string(b.v)+"::"),this.run(c),this.buf.b+="::end::"}break;case 6:d=a.name;a=a.params;b=H.field(this.macros,d);var f=[],k=this.buf;f.push(p(this,this.resolve));for(a=a.h;null!=a;)h=a.item,a=a.next,0==h._hx_index?(h=h.v,f.push(this.resolve(h))):(this.buf=new gb,this.run(h),f.push(this.buf.b));this.buf=k;try{c=this.buf,e=w.string(b.apply(this.macros,f)),c.b+=w.string(e)}catch(ba){ma.lastError=
ba;a=y.caught(ba).unwrap();try{var l=f.join(",")}catch(N){l="???"}b="Macro call "+d+"("+l+") failed ("+w.string(a)+")";throw y.thrown(b);}}},__class__:Oa};t.$haxeUID|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(J.now=performance.now.bind(performance));d.Math=Math;null==String.fromCodePoint&&(String.fromCodePoint=function(a){return 65536>a?String.fromCharCode(a):String.fromCharCode((a>>10)+55232)+String.fromCharCode((a&1023)+56320)});String.prototype.__class__=d.String=
String;String.__name__=!0;d.Array=Array;Array.__name__=!0;Date.prototype.__class__=d.Date=Date;Date.__name__="Date";var rf={},pf={},qf=Number,of=Boolean,sf={},tf={};Db.count=0;sa.__toStr={}.toString;var lf=new Uint32Array(256);Qb.__alpha16=lf;for(var Dc=0;256>Dc;){var dd=Dc++;Qb.__alpha16[dd]=Math.ceil(257.00392156862745*dd)}lf=new Uint8Array(511);Qb.__clamp=lf;for(Dc=0;255>Dc;)dd=Dc++,Qb.__clamp[dd]=dd;for(Dc=255;511>Dc;)dd=Dc++,Qb.__clamp[dd]=255;Aa.level=3;"undefined"==typeof console&&(console=
{});null==console.log&&(console.log=function(){});hb.Hues="\n\tvec4 compose(){\n\t\t// time varying pixel color\n\t\tvec3 col = 0.5 + 0.5*cos(uTime+vTexCoord.xyx+vec3(0,2,4));\n\t\treturn vec4(col * 0.5, 0.5);\n\t}\n\t";Wa.default_mass=-1;Wa.minimum_mass=1E-4;Wa.ids=0;za.qr=[];za.sqr=[];na.cached_listeners=new pb;na.cached_collisions=[];na.cached_body=new Wa({mass:1});Mb.pool=new Zc(Mb);Lb.global=new Lb(null,null,null,null,null);qc.pool=new id(qc);uc.pool=new Oc(uc);yb.pool=new Ic(yb);Xb.pool=new jd(Xb);
mc.pool=new Bd(mc);Xa.pool=new Cd(Xa);Vb.pool=new Dd(Vb);Sa.pool=new Ed(Sa);ib.pool=new kd(ib);xa.norm=new P(0,0);xa.closest=new P(0,0);Fb.DEFAULT_RESOLVER=new od;Fb.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";vb.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1];vb.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];vb.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,
9,10,10,11,11,12,12,13,13,-1,-1];vb.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];vb.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];M.activeRequests=0;M.requestLimit=17;M.requestQueue=new Ob;td.windowID=0;Yb.DICTIONARY="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");Yb.EXTENDED_DICTIONARY=function(a){a=[];for(var b=0,c=Yb.DICTIONARY;b<c.length;){var e=c[b];++b;for(var d=
0,h=Yb.DICTIONARY;d<h.length;){var f=h[d];++d;a.push(e+f)}}return a}(this);Tb.sensorByID=new xb;Tb.sensors=[];db.devices=new xb;db.onConnect=new Ne;mb.devices=new xb;mb.onConnect=new Oe;Ab.onCancel=new Ac;Ab.onEnd=new Ac;Ab.onMove=new Ac;Ab.onStart=new Ac;X.cache=new Re;X.onChange=new fb;X.bundlePaths=new aa;X.libraries=new aa;X.libraryPaths=new aa;Aa.throwErrors=!0;qa.FORMULAS=new aa;qa.ATTRIBUTES=function(a){a=new aa;a.h.zStart="aRotZ";a.h.zEnd="aRotZ";a.h.z="aRotZ";a.h.yStart="aPos.y";a.h.yEnd=
"aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);qa.FORMULA_NAMES=function(a){a=new aa;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.zIndex="z";return a}(this);qa.FORMULA_VARYINGS="";qa.FORMULA_CONSTANTS="";qa.FORMULA_CUSTOMS="";qa.DEFAULT_FORMULA_VARS=new aa;va.__meta__={fields:{x:{posX:null},y:{posY:null},color:{color:null},bgColor:{color:null},
weight:{custom:null,varying:null},tilt:{custom:null},zIndex:{zIndex:null},width:{sizeX:null,varying:null},height:{sizeY:null},tile:{texTile:null}}};va.FORMULAS=new aa;va.ATTRIBUTES=function(a){a=new aa;a.h.zIndexStart="aRotZ";a.h.zIndexEnd="aRotZ";a.h.zIndex="aRotZ";a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.widthStart="aSize.x";a.h.widthEnd="aSize.x";a.h.width="aSize.x";a.h.weightStart="aFloat0.x";a.h.weightEnd="aFloat0.x";a.h.weight=
"aFloat0.x";a.h.tiltStart="aFloat0.y";a.h.tiltEnd="aFloat0.y";a.h.tilt="aFloat0.y";a.h.tileStart="aShort0";a.h.tileEnd="aShort0";a.h.tile="aShort0";a.h.heightStart="aSize.y";a.h.heightEnd="aSize.y";a.h.height="aSize.y";return a}(this);va.FORMULA_NAMES=function(a){a=new aa;a.h.sizeX="width";a.h.sizeY="height";a.h.posX="x";a.h.posY="y";a.h.zIndex="zIndex";return a}(this);va.FORMULA_VARYINGS="weight,tile";va.FORMULA_CONSTANTS="";va.FORMULA_CUSTOMS="tilt";va.DEFAULT_FORMULA_VARS=new aa;Ga.FORMULAS=new aa;
Ga.ATTRIBUTES=function(a){a=new aa;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);Ga.FORMULA_NAMES=function(a){a=new aa;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";return a}(this);Ga.FORMULA_VARYINGS="";Ga.FORMULA_CONSTANTS="";Ga.FORMULA_CUSTOMS="";Ga.DEFAULT_FORMULA_VARS=new aa;I.isES3=!1;I.isUBO=!1;I.isINSTANCED=
!1;I.isVAO=!1;Na.VertexFloat={high:0,medium:0,low:0};Na.VertexInt={high:0,medium:0,low:0};Na.VertexSampler={high:0,medium:0,low:0};Na.FragmentFloat={high:0,medium:0,low:0};Na.FragmentInt={high:0,medium:0,low:0};Na.FragmentSampler={high:0,medium:0,low:0};Ma.rEmptylines=new D("([ \t]*\r?\n)+","g");Ma.rStartspaces=new D("^([ \t]*\r?\n)+","g");ta.__meta__={fields:{px_offset:{pivotX:null,formula:["w * 0.5 + px_offset"]},py_offset:{pivotY:null,formula:["h * 0.5 + py_offset"]},rotation:{rotation:null},w:{sizeX:null,
varying:null},h:{sizeY:null,varying:null},color:{color:null},x:{posX:null,set:["Position"]},y:{posY:null,set:["Position"]},sides:{custom:null,varying:null},shape:{custom:null,varying:null}}};ta.InjectFragment="\n    #define PI 3.14159265359\n    #define TWO_PI 6.28318530718\n    \n    // from the book of shaders https://thebookofshaders.com/07/\n\t// only triangle is correct at the moment\n\t// todo ! calculate r for n sided polygons\n\t// or use vertices data from echo shape\n    vec4 polygon(vec4 c, float sides){\n        // Remap the coord for\n        vec2 coord = vTexCoord;\n        coord.y = (1.0 - coord.y);\n\n        // Remap the space to -1. to 1.\n        vec2 st = coord * 2.0-1.0;\n\n        // Angle and radius from the current pixel\n        float r = TWO_PI/sides;\n        float a = atan(st.x,st.y) + PI;\n\n        // Shaping function that modulate the distance\n        float d = cos(floor(.5+a/r)*r-a)*length(st);\n        float A = 1.0-smoothstep(.5,.51,d) == 1.0 ? c.a : 0.0;\n        return vec4(c.rgb, A);\n    }\n\n    // // https://github.com/ayamflow/glsl-2d-primitives/blob/master/polygon.glsl\n    // vec4 polygon(vec4 c, float sides){\n    //     vec2 st = vTexCoord * 2.0 - 1.0;\n    //     st.y  = (1.0 - st.y);\n    //     float angle = atan(st.x,st.y) + PI;\n    //     float slice = TWO_PI / sides;\n    //     // float radius = 0.4;\n    //     float radius = 0.5;//1.0;//0.7;//sides / 10.0;\n    //     // float x = vSize.x; \n    //     // float radius = 1.0 / cos(x) * (180.0 / sides);\n    //     float s = step(radius, cos(floor(0.5 + angle / slice ) * slice - angle) * length(st));\n    //     float A = 1.0 - s == 1.0 ? c.a : 0.0;\n    //     return vec4(c.rgb, A);\n    // }\n\n    float circle(vec2 st, float radius)\n    {\n        vec2 dist = st-vec2(0.5);\n        return 1.-smoothstep(radius-(radius*0.01),\n                             radius+(radius*0.01),\n                             dot(dist,dist)*4.0\n                            );\n    }\n\n    vec4 compose(vec4 c, float shapeType, float numSides){\n        // return vec4(0.8,0.8,0.8,1.0);\n        if(shapeType <= 0.0 ){\n            return c;\n        }\n        // circle\n        if(shapeType == 1.0){\n            float a = circle(vTexCoord, 1.0) == 1.0 ? c.a : 0.0;\n\t\t\treturn vec4(c.rgb, a);\n        }\n        // polygon\n        return polygon(c, numSides);\n    }\n    ";
ta.ColorFormula="compose(color, shape, sides)";ta.FORMULAS=function(a){a=new aa;a.h.py_offset="h * 0.5 + py_offset";a.h.px_offset="w * 0.5 + px_offset";return a}(this);ta.ATTRIBUTES=function(a){a=new aa;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.sidesStart="aFloat0.x";a.h.sidesEnd="aFloat0.x";a.h.sides="aFloat0.x";a.h.shapeStart="aFloat0.y";a.h.shapeEnd="aFloat0.y";a.h.shape=
"aFloat0.y";a.h.rotationStart="aRotZ";a.h.rotationEnd="aRotZ";a.h.rotation="aRotZ";a.h.py_offsetStart="aPivot.y";a.h.py_offsetEnd="aPivot.y";a.h.py_offset="aPivot.y";a.h.px_offsetStart="aPivot.x";a.h.px_offsetEnd="aPivot.x";a.h.px_offset="aPivot.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);ta.FORMULA_NAMES=function(a){a=new aa;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.rotation="rotation";a.h.pivotX="px_offset";a.h.pivotY="py_offset";return a}(this);ta.FORMULA_VARYINGS=
"sides,shape";ta.FORMULA_CONSTANTS="";ta.FORMULA_CUSTOMS="";ta.DEFAULT_FORMULA_VARS=new aa;ra.__meta__={fields:{px_offset:{pivotX:null,formula:["w * 0.5 + px_offset"]},py_offset:{pivotY:null,formula:["h * 0.5 + py_offset"]},rotation:{rotation:null},w:{sizeX:null},h:{sizeY:null},slot:{texSlot:["base"]},c:{color:null},tile:{texTile:null},shakeAtTime:{custom:null},shakeFrequencyY:{custom:null},shakeFrequencyX:{custom:null},shakeDistanceY:{custom:null},shakeDistanceX:{custom:null},shakeDurationX:{custom:null},
shakeDurationY:{custom:null},x:{posX:null,set:["Position"],formula:["x + shake(shakeAtTime, shakeFrequencyX, shakeDistanceX, shakeDurationX)"]},y:{posY:null,set:["Position"],formula:["y + shake(shakeAtTime, shakeFrequencyY, shakeDistanceY, shakeDurationY)"]}}};ra.InjectVertex="\n\t#define TWO_PI 6.28318530718\n\tfloat shake( float atTime, float freq, float size, float duration )\n\t{\n\t\tfloat t = max(0.0, uTime - atTime);\t\t\t\t\n\t\tt = (clamp(t, 0.0, duration) / duration);\t\t\t\n\t\t// return 1.0 - size + size * sin(freq * TWO_PI * t) * (t+0.5)*t*t*(t-1.0)*(t-1.0)*15.5;\n\t\treturn size * sin(freq * TWO_PI * t) * (t+0.5)*t*t*(t-1.0)*(t-1.0)*15.5;\n\t}\n\t";
ra.InjectFragment="";ra.FORMULAS=function(a){a=new aa;a.h.y="y + shake(shakeAtTime, shakeFrequencyY, shakeDistanceY, shakeDurationY)";a.h.x="x + shake(shakeAtTime, shakeFrequencyX, shakeDistanceX, shakeDurationX)";a.h.py_offset="h * 0.5 + py_offset";a.h.px_offset="w * 0.5 + px_offset";return a}(this);ra.ATTRIBUTES=function(a){a=new aa;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.tileStart=
"aShort0.y";a.h.tileEnd="aShort0.y";a.h.tile="aShort0.y";a.h.slotStart="aShort0.x";a.h.slotEnd="aShort0.x";a.h.slot="aShort0.x";a.h.shakeFrequencyYStart="aFloat0.y";a.h.shakeFrequencyYEnd="aFloat0.y";a.h.shakeFrequencyY="aFloat0.y";a.h.shakeFrequencyXStart="aFloat0.z";a.h.shakeFrequencyXEnd="aFloat0.z";a.h.shakeFrequencyX="aFloat0.z";a.h.shakeDurationYStart="aFloat1.z";a.h.shakeDurationYEnd="aFloat1.z";a.h.shakeDurationY="aFloat1.z";a.h.shakeDurationXStart="aFloat1.y";a.h.shakeDurationXEnd="aFloat1.y";
a.h.shakeDurationX="aFloat1.y";a.h.shakeDistanceYStart="aFloat0.w";a.h.shakeDistanceYEnd="aFloat0.w";a.h.shakeDistanceY="aFloat0.w";a.h.shakeDistanceXStart="aFloat1.x";a.h.shakeDistanceXEnd="aFloat1.x";a.h.shakeDistanceX="aFloat1.x";a.h.shakeAtTimeStart="aFloat0.x";a.h.shakeAtTimeEnd="aFloat0.x";a.h.shakeAtTime="aFloat0.x";a.h.rotationStart="aRotZ";a.h.rotationEnd="aRotZ";a.h.rotation="aRotZ";a.h.py_offsetStart="aPivot.y";a.h.py_offsetEnd="aPivot.y";a.h.py_offset="aPivot.y";a.h.px_offsetStart="aPivot.x";
a.h.px_offsetEnd="aPivot.x";a.h.px_offset="aPivot.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);ra.FORMULA_NAMES=function(a){a=new aa;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";a.h.rotation="rotation";a.h.pivotX="px_offset";a.h.pivotY="py_offset";return a}(this);ra.FORMULA_VARYINGS="slot,tile";ra.FORMULA_CONSTANTS="";ra.FORMULA_CUSTOMS="shakeAtTime,shakeFrequencyY,shakeFrequencyX,shakeDistanceY,shakeDistanceX,shakeDurationX,shakeDurationY";ra.DEFAULT_FORMULA_VARS=
new aa;ha.__meta__={fields:{x:{posX:null},y:{posY:null},w:{sizeX:null},h:{sizeY:null},slot:{texSlot:["base"]},c:{color:null}}};ha.FORMULAS=new aa;ha.ATTRIBUTES=function(a){a=new aa;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.slotStart="aShort0";a.h.slotEnd="aShort0";a.h.slot="aShort0";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);ha.FORMULA_NAMES=function(a){a=
new aa;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";return a}(this);ha.FORMULA_VARYINGS="slot";ha.FORMULA_CONSTANTS="";ha.FORMULA_CUSTOMS="";ha.DEFAULT_FORMULA_VARS=new aa;Ye.Versitle=[789263,11485010,6240601,3025207,9460890,14126402,9656635,9278124,13926320,14540112,7714118,4877746,15977364,15724777,10999514,5677512];wa.__meta__={fields:{x:{posX:null},y:{posY:null},w:{sizeX:null},h:{sizeY:null}}};wa.FORMULAS=new aa;wa.ATTRIBUTES=function(a){a=new aa;a.h.yStart="aPos.y";a.h.yEnd="aPos.y";
a.h.y="aPos.y";a.h.xStart="aPos.x";a.h.xEnd="aPos.x";a.h.x="aPos.x";a.h.wStart="aSize.x";a.h.wEnd="aSize.x";a.h.w="aSize.x";a.h.hStart="aSize.y";a.h.hEnd="aSize.y";a.h.h="aSize.y";return a}(this);wa.FORMULA_NAMES=function(a){a=new aa;a.h.sizeX="w";a.h.sizeY="h";a.h.posX="x";a.h.posY="y";return a}(this);wa.FORMULA_VARYINGS="";wa.FORMULA_CONSTANTS="";wa.FORMULA_CUSTOMS="";wa.DEFAULT_FORMULA_VARS=new aa;Ya.corsServer="";Oa.splitter=new D('(::[A-Za-z0-9_ ()&|!+=/><*."-]+::|\\$\\$([A-Za-z0-9_-]+)\\()',
"");Oa.expr_splitter=new D('(\\(|\\)|[ \r\n\t]*"[^"]*"[ \r\n\t]*|[!+=/><*.&|-]+)',"");Oa.expr_trim=new D("^[ ]*([^ ]+)[ ]*$","");Oa.expr_int=new D("^[0-9]+$","");Oa.expr_float=new D("^([+-]?)(?=\\d|,\\d)\\d*(,\\d*)?([Ee]([+-]?\\d+))?$","");Oa.globals={};E.main()})("undefined"!=typeof m?m:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof u?u:"undefined"!=typeof self?self:this)};D.lime.embed=function(t){var u={},z=D.lime.$scripts[t];
if(!z)throw Error('Cannot find project name "'+t+'"');z(u,m);for(var E in u)D[E]=D[E]||u[E];(z=u.lime||window.lime)&&z.embed&&this!=z.embed&&z.embed.apply(z,arguments);return u};"function"==typeof define&&define.amd&&(define([],function(){return D.lime}),define.__amd=define.amd,define.amd=null)})("undefined"!=typeof exports?exports:"function"==typeof define&&define.amd?{}:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?
global:"undefined"!=typeof self?self:this);
!function(){var D=function(){this.init()};D.prototype={init:function(){var d=this||m;return d._counter=1E3,d._html5AudioPool=[],d.html5PoolSize=10,d._codecs={},d._howls=[],d._muted=!1,d._volume=1,d._canPlayEvent="canplaythrough",d._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,d.masterGain=null,d.noAudio=!1,d.usingWebAudio=!0,d.autoSuspend=!0,d.ctx=null,d.autoUnlock=!0,d._setup(),d},volume:function(d){var n=this||m;if(d=parseFloat(d),n.ctx||p(),void 0!==d&&0<=d&&1>=
d){if(n._volume=d,n._muted)return n;n.usingWebAudio&&n.masterGain.gain.setValueAtTime(d,m.ctx.currentTime);for(var v=0;v<n._howls.length;v++)if(!n._howls[v]._webAudio)for(var f=n._howls[v]._getSoundIds(),t=0;t<f.length;t++){var K=n._howls[v]._soundById(f[t]);K&&K._node&&(K._node.volume=K._volume*d)}return n}return n._volume},mute:function(d){var n=this||m;n.ctx||p();n._muted=d;n.usingWebAudio&&n.masterGain.gain.setValueAtTime(d?0:n._volume,m.ctx.currentTime);for(var v=0;v<n._howls.length;v++)if(!n._howls[v]._webAudio)for(var f=
n._howls[v]._getSoundIds(),t=0;t<f.length;t++){var K=n._howls[v]._soundById(f[t]);K&&K._node&&(K._node.muted=!!d||K._muted)}return n},unload:function(){for(var d=this||m,n=d._howls.length-1;0<=n;n--)d._howls[n].unload();return d.usingWebAudio&&d.ctx&&void 0!==d.ctx.close&&(d.ctx.close(),d.ctx=null,p()),d},codecs:function(d){return(this||m)._codecs[d.replace(/^x-/,"")]},_setup:function(){var d=this||m;if(d.state=d.ctx?d.ctx.state||"suspended":"suspended",d._autoSuspend(),!d.usingWebAudio)if("undefined"!=
typeof Audio)try{var n=new Audio;void 0===n.oncanplaythrough&&(d._canPlayEvent="canplay")}catch(v){d.noAudio=!0}else d.noAudio=!0;try{n=new Audio,n.muted&&(d.noAudio=!0)}catch(v){}return d.noAudio||d._setupCodecs(),d},_setupCodecs:function(){var d=this||m,n=null;try{n="undefined"!=typeof Audio?new Audio:null}catch(la){return d}if(!n||"function"!=typeof n.canPlayType)return d;var v=n.canPlayType("audio/mpeg;").replace(/^no$/,""),f=d._navigator&&d._navigator.userAgent.match(/OPR\/([0-6].)/g);f=f&&33>
parseInt(f[0].split("/")[1],10);return d._codecs={mp3:!(f||!v&&!n.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!v,opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!n.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!n.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||
n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!n.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(n.canPlayType("audio/x-flac;")||n.canPlayType("audio/flac;")).replace(/^no$/,"")},d},_unlockAudio:function(){var d=
this||m,n=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome|Safari/i.test(d._navigator&&d._navigator.userAgent);if(!d._audioUnlocked&&d.ctx&&n){d._audioUnlocked=!1;d.autoUnlock=!1;d._mobileUnloaded||44100===d.ctx.sampleRate||(d._mobileUnloaded=!0,d.unload());d._scratchBuffer=d.ctx.createBuffer(1,1,22050);var v=function(f){for(f=0;f<d.html5PoolSize;f++){var n=new Audio;n._unlocked=!0;d._releaseHtml5Audio(n)}for(f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio){n=d._howls[f]._getSoundIds();
for(var m=0;m<n.length;m++){var p=d._howls[f]._soundById(n[m]);p&&p._node&&!p._node._unlocked&&(p._node._unlocked=!0,p._node.load())}}d._autoResume();var t=d.ctx.createBufferSource();t.buffer=d._scratchBuffer;t.connect(d.ctx.destination);void 0===t.start?t.noteOn(0):t.start(0);"function"==typeof d.ctx.resume&&d.ctx.resume();t.onended=function(){t.disconnect(0);d._audioUnlocked=!0;document.removeEventListener("touchstart",v,!0);document.removeEventListener("touchend",v,!0);document.removeEventListener("click",
v,!0);for(var f=0;f<d._howls.length;f++)d._howls[f]._emit("unlock")}};return document.addEventListener("touchstart",v,!0),document.addEventListener("touchend",v,!0),document.addEventListener("click",v,!0),d}},_obtainHtml5Audio:function(){var d=this||m;if(d._html5AudioPool.length)return d._html5AudioPool.pop();d=(new Audio).play();return d&&"undefined"!=typeof Promise&&(d instanceof Promise||"function"==typeof d.then)&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),
new Audio},_releaseHtml5Audio:function(d){var n=this||m;return d._unlocked&&n._html5AudioPool.push(d),n},_autoSuspend:function(){var d=this;if(d.autoSuspend&&d.ctx&&void 0!==d.ctx.suspend&&m.usingWebAudio){for(var n=0;n<d._howls.length;n++)if(d._howls[n]._webAudio)for(var v=0;v<d._howls[n]._sounds.length;v++)if(!d._howls[n]._sounds[v]._paused)return d;return d._suspendTimer&&clearTimeout(d._suspendTimer),d._suspendTimer=setTimeout(function(){d.autoSuspend&&(d._suspendTimer=null,d.state="suspending",
d.ctx.suspend().then(function(){d.state="suspended";d._resumeAfterSuspend&&(delete d._resumeAfterSuspend,d._autoResume())}))},3E4),d}},_autoResume:function(){var d=this;if(d.ctx&&void 0!==d.ctx.resume&&m.usingWebAudio)return"running"===d.state&&d._suspendTimer?(clearTimeout(d._suspendTimer),d._suspendTimer=null):"suspended"===d.state?(d.ctx.resume().then(function(){d.state="running";for(var n=0;n<d._howls.length;n++)d._howls[n]._emit("resume")}),d._suspendTimer&&(clearTimeout(d._suspendTimer),d._suspendTimer=
null)):"suspending"===d.state&&(d._resumeAfterSuspend=!0),d}};var m=new D,t=function(d){if(!d.src||0===d.src.length)return void console.error("An array of source files must be passed with any new Howl.");this.init(d)};t.prototype={init:function(d){var n=this;return m.ctx||p(),n._autoplay=d.autoplay||!1,n._format="string"!=typeof d.format?d.format:[d.format],n._html5=d.html5||!1,n._muted=d.mute||!1,n._loop=d.loop||!1,n._pool=d.pool||5,n._preload="boolean"!=typeof d.preload||d.preload,n._rate=d.rate||
1,n._sprite=d.sprite||{},n._src="string"!=typeof d.src?d.src:[d.src],n._volume=void 0!==d.volume?d.volume:1,n._xhrWithCredentials=d.xhrWithCredentials||!1,n._duration=0,n._state="unloaded",n._sounds=[],n._endTimers={},n._queue=[],n._playLock=!1,n._onend=d.onend?[{fn:d.onend}]:[],n._onfade=d.onfade?[{fn:d.onfade}]:[],n._onload=d.onload?[{fn:d.onload}]:[],n._onloaderror=d.onloaderror?[{fn:d.onloaderror}]:[],n._onplayerror=d.onplayerror?[{fn:d.onplayerror}]:[],n._onpause=d.onpause?[{fn:d.onpause}]:[],
n._onplay=d.onplay?[{fn:d.onplay}]:[],n._onstop=d.onstop?[{fn:d.onstop}]:[],n._onmute=d.onmute?[{fn:d.onmute}]:[],n._onvolume=d.onvolume?[{fn:d.onvolume}]:[],n._onrate=d.onrate?[{fn:d.onrate}]:[],n._onseek=d.onseek?[{fn:d.onseek}]:[],n._onunlock=d.onunlock?[{fn:d.onunlock}]:[],n._onresume=[],n._webAudio=m.usingWebAudio&&!n._html5,void 0!==m.ctx&&m.ctx&&m.autoUnlock&&m._unlockAudio(),m._howls.push(n),n._autoplay&&n._queue.push({event:"play",action:function(){n.play()}}),n._preload&&n.load(),n},load:function(){var d=
null;if(m.noAudio)return void this._emit("loaderror",null,"No audio support.");"string"==typeof this._src&&(this._src=[this._src]);for(var n=0;n<this._src.length;n++){var v;if(this._format&&this._format[n])var f=this._format[n];else{if("string"!=typeof(v=this._src[n])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(f=/^data:audio\/([^;,]+);/i.exec(v))||(f=/\.([^.]+)$/.exec(v.split("?",1)[0]));f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),
f&&m.codecs(f)){d=this._src[n];break}}return d?(this._src=d,this._state="loading","https:"===window.location.protocol&&"http:"===d.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new u(this),this._webAudio&&E(this),this):void this._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(d,n){var v=this,f=null;if("number"==typeof d)f=d,d=null;else{if("string"==typeof d&&"loaded"===v._state&&!v._sprite[d])return null;if(void 0===d&&(d="__default",!v._playLock)){for(var p=
0,t=0;t<v._sounds.length;t++)v._sounds[t]._paused&&!v._sounds[t]._ended&&(p++,f=v._sounds[t]._id);1===p?d=null:f=null}}var u=f?v._soundById(f):v._inactiveSound();if(!u)return null;if(f&&!d&&(d=u._sprite||"__default"),"loaded"!==v._state){u._sprite=d;u._ended=!1;var z=u._id;return v._queue.push({event:"play",action:function(){v.play(z)}}),z}if(f&&!u._paused)return n||v._loadQueue("play"),u._id;v._webAudio&&m._autoResume();var F=Math.max(0,0<u._seek?u._seek:v._sprite[d][0]/1E3),A=Math.max(0,(v._sprite[d][0]+
v._sprite[d][1])/1E3-F),D=1E3*A/Math.abs(u._rate),B=v._sprite[d][0]/1E3,E=(v._sprite[d][0]+v._sprite[d][1])/1E3,L=!(!u._loop&&!v._sprite[d][2]);u._sprite=d;u._ended=!1;var O=function(){u._paused=!1;u._seek=F;u._start=B;u._stop=E;u._loop=L};if(F>=E)return void v._ended(u);var S=u._node;if(v._webAudio)f=function(){v._playLock=!1;O();v._refreshBuffer(u);S.gain.setValueAtTime(u._muted||v._muted?0:u._volume,m.ctx.currentTime);u._playStart=m.ctx.currentTime;void 0===S.bufferSource.start?u._loop?S.bufferSource.noteGrainOn(0,
F,86400):S.bufferSource.noteGrainOn(0,F,A):u._loop?S.bufferSource.start(0,F,86400):S.bufferSource.start(0,F,A);D!==1/0&&(v._endTimers[u._id]=setTimeout(v._ended.bind(v,u),D));n||setTimeout(function(){v._emit("play",u._id);v._loadQueue()},0)},"running"===m.state?f():(v._playLock=!0,v.once("resume",f),v._clearTimer(u._id));else{var ea=function(){S.currentTime=F;S.muted=u._muted||v._muted||m._muted||S.muted;S.volume=u._volume*m.volume();S.playbackRate=u._rate;try{var f=S.play();if(f&&"undefined"!=typeof Promise&&
(f instanceof Promise||"function"==typeof f.then)?(v._playLock=!0,O(),f.then(function(){v._playLock=!1;S._unlocked=!0;n||(v._emit("play",u._id),v._loadQueue())}).catch(function(){v._playLock=!1;v._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");u._ended=!0;u._paused=!0})):n||(v._playLock=!1,O(),v._emit("play",u._id),v._loadQueue()),S.playbackRate=u._rate,S.paused)return void v._emit("playerror",
u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==d||u._loop?v._endTimers[u._id]=setTimeout(v._ended.bind(v,u),D):(v._endTimers[u._id]=function(){v._ended(u);S.removeEventListener("ended",v._endTimers[u._id],!1)},S.addEventListener("ended",v._endTimers[u._id],!1))}catch(Pa){v._emit("playerror",u._id,Pa)}};f=window&&window.ejecta||!S.readyState&&m._navigator.isCocoonJS;if(3<=S.readyState||
f)ea();else{v._playLock=!0;var R=function(){ea();S.removeEventListener(m._canPlayEvent,R,!1)};S.addEventListener(m._canPlayEvent,R,!1);v._clearTimer(u._id)}}return u._id},pause:function(d,n){var v=this;if("loaded"!==v._state||v._playLock)return v._queue.push({event:"pause",action:function(){v.pause(d)}}),v;for(var f=v._getSoundIds(d),m=0;m<f.length;m++){v._clearTimer(f[m]);var p=v._soundById(f[m]);if(p&&!p._paused&&(p._seek=v.seek(f[m]),p._rateSeek=0,p._paused=!0,v._stopFade(f[m]),p._node))if(v._webAudio){if(!p._node.bufferSource)continue;
void 0===p._node.bufferSource.stop?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0);v._cleanBuffer(p._node)}else isNaN(p._node.duration)&&p._node.duration!==1/0||p._node.pause();n||v._emit("pause",p?p._id:null)}return v},stop:function(d,n){var v=this;if("loaded"!==v._state||v._playLock)return v._queue.push({event:"stop",action:function(){v.stop(d)}}),v;for(var f=v._getSoundIds(d),m=0;m<f.length;m++){v._clearTimer(f[m]);var p=v._soundById(f[m]);p&&(p._seek=p._start||0,p._rateSeek=0,p._paused=
!0,p._ended=!0,v._stopFade(f[m]),p._node&&(v._webAudio?p._node.bufferSource&&(void 0===p._node.bufferSource.stop?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),v._cleanBuffer(p._node)):isNaN(p._node.duration)&&p._node.duration!==1/0||(p._node.currentTime=p._start||0,p._node.pause())),n||v._emit("stop",p._id))}return v},mute:function(d,n){var v=this;if("loaded"!==v._state||v._playLock)return v._queue.push({event:"mute",action:function(){v.mute(d,n)}}),v;if(void 0===n){if("boolean"!=typeof d)return v._muted;
v._muted=d}for(var f=v._getSoundIds(n),p=0;p<f.length;p++){var t=v._soundById(f[p]);t&&(t._muted=d,t._interval&&v._stopFade(t._id),v._webAudio&&t._node?t._node.gain.setValueAtTime(d?0:t._volume,m.ctx.currentTime):t._node&&(t._node.muted=!!m._muted||d),v._emit("mute",t._id))}return v},volume:function(){var d,n,v=this,f=arguments;if(0===f.length)return v._volume;1===f.length||2===f.length&&void 0===f[1]?0<=v._getSoundIds().indexOf(f[0])?n=parseInt(f[0],10):d=parseFloat(f[0]):2<=f.length&&(d=parseFloat(f[0]),
n=parseInt(f[1],10));var p;if(!(void 0!==d&&0<=d&&1>=d))return p=n?v._soundById(n):v._sounds[0],p?p._volume:0;if("loaded"!==v._state||v._playLock)return v._queue.push({event:"volume",action:function(){v.volume.apply(v,f)}}),v;void 0===n&&(v._volume=d);n=v._getSoundIds(n);for(var t=0;t<n.length;t++)(p=v._soundById(n[t]))&&(p._volume=d,f[2]||v._stopFade(n[t]),v._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(d,m.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=d*m.volume()),v._emit("volume",
p._id));return v},fade:function(d,n,v,f){var p=this;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"fade",action:function(){p.fade(d,n,v,f)}}),p;d=parseFloat(d);n=parseFloat(n);v=parseFloat(v);p.volume(d,f);for(var t=p._getSoundIds(f),u=0;u<t.length;u++){var F=p._soundById(t[u]);if(F){if(f||p._stopFade(t[u]),p._webAudio&&!F._muted){var z=m.ctx.currentTime,A=z+v/1E3;F._volume=d;F._node.gain.setValueAtTime(d,z);F._node.gain.linearRampToValueAtTime(n,A)}p._startFadeInterval(F,d,n,v,
t[u],void 0===f)}}return p},_startFadeInterval:function(d,n,v,f,p,m){var t=this,u=n,F=v-n;p=Math.abs(F/.01);p=Math.max(4,0<p?f/p:f);var z=Date.now();d._fadeTo=v;d._interval=setInterval(function(){var p=(Date.now()-z)/f;z=Date.now();u+=F*p;u=Math.max(0,u);u=Math.min(1,u);u=Math.round(100*u)/100;t._webAudio?d._volume=u:t.volume(u,d._id,!0);m&&(t._volume=u);(v<n&&u<=v||v>n&&u>=v)&&(clearInterval(d._interval),d._interval=null,d._fadeTo=null,t.volume(v,d._id),t._emit("fade",d._id))},p)},_stopFade:function(d){var n=
this._soundById(d);return n&&n._interval&&(this._webAudio&&n._node.gain.cancelScheduledValues(m.ctx.currentTime),clearInterval(n._interval),n._interval=null,this.volume(n._fadeTo,d),n._fadeTo=null,this._emit("fade",d)),this},loop:function(){var d,n,v,f=arguments;if(0===f.length)return this._loop;if(1===f.length){if("boolean"!=typeof f[0])return!!(v=this._soundById(parseInt(f[0],10)))&&v._loop;this._loop=d=f[0]}else 2===f.length&&(d=f[0],n=parseInt(f[1],10));n=this._getSoundIds(n);for(f=0;f<n.length;f++)(v=
this._soundById(n[f]))&&(v._loop=d,this._webAudio&&v._node&&v._node.bufferSource&&(v._node.bufferSource.loop=d,d&&(v._node.bufferSource.loopStart=v._start||0,v._node.bufferSource.loopEnd=v._stop)));return this},rate:function(){var d,n,v=this,f=arguments;0===f.length?n=v._sounds[0]._id:1===f.length?0<=v._getSoundIds().indexOf(f[0])?n=parseInt(f[0],10):d=parseFloat(f[0]):2===f.length&&(d=parseFloat(f[0]),n=parseInt(f[1],10));var p;if("number"!=typeof d)return p=v._soundById(n),p?p._rate:v._rate;if("loaded"!==
v._state||v._playLock)return v._queue.push({event:"rate",action:function(){v.rate.apply(v,f)}}),v;void 0===n&&(v._rate=d);n=v._getSoundIds(n);for(var t=0;t<n.length;t++)if(p=v._soundById(n[t])){v.playing(n[t])&&(p._rateSeek=v.seek(n[t]),p._playStart=v._webAudio?m.ctx.currentTime:p._playStart);p._rate=d;v._webAudio&&p._node&&p._node.bufferSource?p._node.bufferSource.playbackRate.setValueAtTime(d,m.ctx.currentTime):p._node&&(p._node.playbackRate=d);var u=v.seek(n[t]);u=1E3*((v._sprite[p._sprite][0]+
v._sprite[p._sprite][1])/1E3-u)/Math.abs(p._rate);!v._endTimers[n[t]]&&p._paused||(v._clearTimer(n[t]),v._endTimers[n[t]]=setTimeout(v._ended.bind(v,p),u));v._emit("rate",p._id)}return v},seek:function(){var d,n,p=this,f=arguments;0===f.length?n=p._sounds[0]._id:1===f.length?0<=p._getSoundIds().indexOf(f[0])?n=parseInt(f[0],10):p._sounds.length&&(n=p._sounds[0]._id,d=parseFloat(f[0])):2===f.length&&(d=parseFloat(f[0]),n=parseInt(f[1],10));if(void 0===n)return p;if("loaded"!==p._state||p._playLock)return p._queue.push({event:"seek",
action:function(){p.seek.apply(p,f)}}),p;var t=p._soundById(n);if(t){if(!("number"==typeof d&&0<=d))return p._webAudio?(d=p.playing(n)?m.ctx.currentTime-t._playStart:0,t._seek+((t._rateSeek?t._rateSeek-t._seek:0)+d*Math.abs(t._rate))):t._node.currentTime;var u=p.playing(n);u&&p.pause(n,!0);t._seek=d;t._ended=!1;p._clearTimer(n);p._webAudio||!t._node||isNaN(t._node.duration)||(t._node.currentTime=d);var F=function(){p._emit("seek",n);u&&p.play(n,!0)};if(u&&!p._webAudio){var z=function(){p._playLock?
setTimeout(z,0):F()};setTimeout(z,0)}else F()}return p},playing:function(d){if("number"==typeof d)return d=this._soundById(d),!!d&&!d._paused;for(d=0;d<this._sounds.length;d++)if(!this._sounds[d]._paused)return!0;return!1},duration:function(d){var n=this._duration;d=this._soundById(d);return d&&(n=this._sprite[d._sprite][1]/1E3),n},state:function(){return this._state},unload:function(){for(var d=this._sounds,n=0;n<d.length;n++)(d[n]._paused||this.stop(d[n]._id),this._webAudio)||(/MSIE |Trident\//.test(m._navigator&&
m._navigator.userAgent)||(d[n]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),d[n]._node.removeEventListener("error",d[n]._errorFn,!1),d[n]._node.removeEventListener(m._canPlayEvent,d[n]._loadFn,!1),m._releaseHtml5Audio(d[n]._node)),delete d[n]._node,this._clearTimer(d[n]._id);n=m._howls.indexOf(this);0<=n&&m._howls.splice(n,1);d=!0;for(n=0;n<m._howls.length;n++)if(m._howls[n]._src===this._src||0<=this._src.indexOf(m._howls[n]._src)){d=!1;break}return z&&
d&&delete z[this._src],m.noAudio=!1,this._state="unloaded",this._sounds=[],null},on:function(d,n,p,f){d=this["_on"+d];return"function"==typeof n&&d.push(f?{id:p,fn:n,once:f}:{id:p,fn:n}),this},off:function(d,n,p){var f=this["_on"+d];if("number"==typeof n&&(p=n,n=null),n||p)for(d=0;d<f.length;d++){var v=p===f[d].id;if(n===f[d].fn&&v||!n&&v){f.splice(d,1);break}}else if(d)this["_on"+d]=[];else for(n=Object.keys(this),d=0;d<n.length;d++)0===n[d].indexOf("_on")&&Array.isArray(this[n[d]])&&(this[n[d]]=
[]);return this},once:function(d,n,p){return this.on(d,n,p,1),this},_emit:function(d,n,p){for(var f=this["_on"+d],v=f.length-1;0<=v;v--)f[v].id&&f[v].id!==n&&"load"!==d||(setTimeout(function(d){d.call(this,n,p)}.bind(this,f[v].fn),0),f[v].once&&this.off(d,f[v].fn,f[v].id));return this._loadQueue(d),this},_loadQueue:function(d){if(0<this._queue.length){var n=this._queue[0];n.event===d&&(this._queue.shift(),this._loadQueue());d||n.action()}return this},_ended:function(d){var n=d._sprite;if(!this._webAudio&&
d._node&&!d._node.paused&&!d._node.ended&&d._node.currentTime<d._stop)return setTimeout(this._ended.bind(this,d),100),this;n=!(!d._loop&&!this._sprite[n][2]);if(this._emit("end",d._id),!this._webAudio&&n&&this.stop(d._id,!0).play(d._id),this._webAudio&&n){this._emit("play",d._id);d._seek=d._start||0;d._rateSeek=0;d._playStart=m.ctx.currentTime;var p=1E3*(d._stop-d._start)/Math.abs(d._rate);this._endTimers[d._id]=setTimeout(this._ended.bind(this,d),p)}return this._webAudio&&!n&&(d._paused=!0,d._ended=
!0,d._seek=d._start||0,d._rateSeek=0,this._clearTimer(d._id),this._cleanBuffer(d._node),m._autoSuspend()),this._webAudio||n||this.stop(d._id,!0),this},_clearTimer:function(d){if(this._endTimers[d]){if("function"!=typeof this._endTimers[d])clearTimeout(this._endTimers[d]);else{var n=this._soundById(d);n&&n._node&&n._node.removeEventListener("ended",this._endTimers[d],!1)}delete this._endTimers[d]}return this},_soundById:function(d){for(var n=0;n<this._sounds.length;n++)if(d===this._sounds[n]._id)return this._sounds[n];
return null},_inactiveSound:function(){this._drain();for(var d=0;d<this._sounds.length;d++)if(this._sounds[d]._ended)return this._sounds[d].reset();return new u(this)},_drain:function(){var d=this._pool,n=0,p;if(!(this._sounds.length<d)){for(p=0;p<this._sounds.length;p++)this._sounds[p]._ended&&n++;for(p=this._sounds.length-1;0<=p&&!(n<=d);p--)this._sounds[p]._ended&&(this._webAudio&&this._sounds[p]._node&&this._sounds[p]._node.disconnect(0),this._sounds.splice(p,1),n--)}},_getSoundIds:function(d){if(void 0===
d){d=[];for(var n=0;n<this._sounds.length;n++)d.push(this._sounds[n]._id);return d}return[d]},_refreshBuffer:function(d){return d._node.bufferSource=m.ctx.createBufferSource(),d._node.bufferSource.buffer=z[this._src],d._panner?d._node.bufferSource.connect(d._panner):d._node.bufferSource.connect(d._node),d._node.bufferSource.loop=d._loop,d._loop&&(d._node.bufferSource.loopStart=d._start||0,d._node.bufferSource.loopEnd=d._stop||0),d._node.bufferSource.playbackRate.setValueAtTime(d._rate,m.ctx.currentTime),
this},_cleanBuffer:function(d){var n=m._navigator&&0<=m._navigator.vendor.indexOf("Apple");if(m._scratchBuffer&&d.bufferSource&&(d.bufferSource.onended=null,d.bufferSource.disconnect(0),n))try{d.bufferSource.buffer=m._scratchBuffer}catch(v){}return d.bufferSource=null,this}};var u=function(d){this._parent=d;this.init()};u.prototype={init:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._paused=!0,this._ended=!0,
this._sprite="__default",this._id=++m._counter,d._sounds.push(this),this.create(),this},create:function(){var d=this._parent,n=m._muted||this._muted||this._parent._muted?0:this._volume;return d._webAudio?(this._node=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),this._node.gain.setValueAtTime(n,m.ctx.currentTime),this._node.paused=!0,this._node.connect(m.masterGain)):(this._node=m._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",
this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(m._canPlayEvent,this._loadFn,!1),this._node.src=d._src,this._node.preload="auto",this._node.volume=n*m.volume(),this._node.load()),this},reset:function(){var d=this._parent;return this._muted=d._muted,this._loop=d._loop,this._volume=d._volume,this._rate=d._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++m._counter,this},_errorListener:function(){this._parent._emit("loaderror",
this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var d=this._parent;d._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue());this._node.removeEventListener(m._canPlayEvent,this._loadFn,!1)}};var z={},E=function(d){var n=d._src;if(z[n])return d._duration=z[n].duration,void A(d);
if(/^data:[^;]+;base64,/.test(n)){for(var p=atob(n.split(",")[1]),f=new Uint8Array(p.length),m=0;m<p.length;++m)f[m]=p.charCodeAt(m);L(f.buffer,d)}else{var t=new XMLHttpRequest;t.open("GET",n,!0);t.withCredentials=d._xhrWithCredentials;t.responseType="arraybuffer";t.onload=function(){var f=(t.status+"")[0];if("0"!==f&&"2"!==f&&"3"!==f)return void d._emit("loaderror",null,"Failed loading audio file with status: "+t.status+".");L(t.response,d)};t.onerror=function(){d._webAudio&&(d._html5=!0,d._webAudio=
!1,d._sounds=[],delete z[n],d.load())};F(t)}},F=function(d){try{d.send()}catch(n){d.onerror()}},L=function(d,n){var p=function(){n._emit("loaderror",null,"Decoding audio data failed.")},f=function(d){d&&0<n._sounds.length?(z[n._src]=d,A(n,d)):p()};"undefined"!=typeof Promise&&1===m.ctx.decodeAudioData.length?m.ctx.decodeAudioData(d).then(f).catch(p):m.ctx.decodeAudioData(d,f,p)},A=function(d,n){n&&!d._duration&&(d._duration=n.duration);0===Object.keys(d._sprite).length&&(d._sprite={__default:[0,1E3*
d._duration]});"loaded"!==d._state&&(d._state="loaded",d._emit("load"),d._loadQueue())},p=function(){if(m.usingWebAudio){try{"undefined"!=typeof AudioContext?m.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?m.ctx=new webkitAudioContext:m.usingWebAudio=!1}catch(v){m.usingWebAudio=!1}m.ctx||(m.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(m._navigator&&m._navigator.platform),n=m._navigator&&m._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);n=n?parseInt(n[1],10):null;d&&n&&9>n&&(d=
/safari/.test(m._navigator&&m._navigator.userAgent.toLowerCase()),(m._navigator&&m._navigator.standalone&&!d||m._navigator&&!m._navigator.standalone&&!d)&&(m.usingWebAudio=!1));m.usingWebAudio&&(m.masterGain=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),m.masterGain.gain.setValueAtTime(m._muted?0:1,m.ctx.currentTime),m.masterGain.connect(m.ctx.destination));m._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:m,Howl:t}});"undefined"!=typeof exports&&
(exports.Howler=m,exports.Howl=t);"undefined"!=typeof window?(window.HowlerGlobal=D,window.Howler=m,window.Howl=t,window.Sound=u):"undefined"!=typeof global&&(global.HowlerGlobal=D,global.Howler=m,global.Howl=t,global.Sound=u)}();
!function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(m){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;0<=t;t--)this._howls[t].stereo(m);return this};HowlerGlobal.prototype.pos=function(m,t,u){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,u="number"!=typeof u?this._pos[2]:u,"number"!=typeof m?this._pos:(this._pos=[m,t,u],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],
Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this};HowlerGlobal.prototype.orientation=function(m,t,u,z,D,F){if(!this.ctx||!this.ctx.listener)return this;var E=this._orientation;return t="number"!=typeof t?E[1]:t,u="number"!=typeof u?E[2]:u,z="number"!=typeof z?E[3]:z,D="number"!=
typeof D?E[4]:D,F="number"!=typeof F?E[5]:F,"number"!=typeof m?E:(this._orientation=[m,t,u,z,D,F],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(m,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(u,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(m,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(u,
Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(m,t,u,z,D,F),this)};Howl.prototype.init=function(m){return function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==
t.maxDistance?t.maxDistance:1E4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],m.call(this,t)}}(Howl.prototype.init);Howl.prototype.stereo=function(m,t){var u=this;if(!u._webAudio)return u;if("loaded"!==u._state)return u._queue.push({event:"stereo",
action:function(){u.stereo(m,t)}}),u;var z=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===t){if("number"!=typeof m)return u._stereo;u._stereo=m;u._pos=[m,0,0]}for(var E=u._getSoundIds(t),F=0;F<E.length;F++){var L=u._soundById(E[F]);if(L){if("number"!=typeof m)return L._stereo;L._stereo=m;L._pos=[m,0,0];L._node&&(L._pannerAttr.panningModel="equalpower",L._panner&&L._panner.pan||D(L,z),"spatial"===z?void 0!==L._panner.positionX?(L._panner.positionX.setValueAtTime(m,Howler.ctx.currentTime),
L._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),L._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):L._panner.setPosition(m,0,0):L._panner.pan.setValueAtTime(m,Howler.ctx.currentTime));u._emit("stereo",L._id)}}return u};Howl.prototype.pos=function(m,t,u,z){var E=this;if(!E._webAudio)return E;if("loaded"!==E._state)return E._queue.push({event:"pos",action:function(){E.pos(m,t,u,z)}}),E;if(t="number"!=typeof t?0:t,u="number"!=typeof u?-.5:u,void 0===z){if("number"!=typeof m)return E._pos;
E._pos=[m,t,u]}for(var F=E._getSoundIds(z),L=0;L<F.length;L++){var A=E._soundById(F[L]);if(A){if("number"!=typeof m)return A._pos;A._pos=[m,t,u];A._node&&(A._panner&&!A._panner.pan||D(A,"spatial"),void 0!==A._panner.positionX?(A._panner.positionX.setValueAtTime(m,Howler.ctx.currentTime),A._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),A._panner.positionZ.setValueAtTime(u,Howler.ctx.currentTime)):A._panner.setPosition(m,t,u));E._emit("pos",A._id)}}return E};Howl.prototype.orientation=function(m,
t,u,z){var E=this;if(!E._webAudio)return E;if("loaded"!==E._state)return E._queue.push({event:"orientation",action:function(){E.orientation(m,t,u,z)}}),E;if(t="number"!=typeof t?E._orientation[1]:t,u="number"!=typeof u?E._orientation[2]:u,void 0===z){if("number"!=typeof m)return E._orientation;E._orientation=[m,t,u]}for(var F=E._getSoundIds(z),L=0;L<F.length;L++){var A=E._soundById(F[L]);if(A){if("number"!=typeof m)return A._orientation;A._orientation=[m,t,u];A._node&&(A._panner||(A._pos||(A._pos=
E._pos||[0,0,-.5]),D(A,"spatial")),void 0!==A._panner.orientationX?(A._panner.orientationX.setValueAtTime(m,Howler.ctx.currentTime),A._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),A._panner.orientationZ.setValueAtTime(u,Howler.ctx.currentTime)):A._panner.setOrientation(m,t,u));E._emit("orientation",A._id)}}return E};Howl.prototype.pannerAttr=function(){var m,t,u=arguments;if(!this._webAudio)return this;if(0===u.length)return this._pannerAttr;if(1===u.length){if("object"!=typeof u[0])return t=
this._soundById(parseInt(u[0],10)),t?t._pannerAttr:this._pannerAttr;var z=u[0];void 0===m&&(z.pannerAttr||(z.pannerAttr={coneInnerAngle:z.coneInnerAngle,coneOuterAngle:z.coneOuterAngle,coneOuterGain:z.coneOuterGain,distanceModel:z.distanceModel,maxDistance:z.maxDistance,refDistance:z.refDistance,rolloffFactor:z.rolloffFactor,panningModel:z.panningModel}),this._pannerAttr={coneInnerAngle:void 0!==z.pannerAttr.coneInnerAngle?z.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:void 0!==z.pannerAttr.coneOuterAngle?
z.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:void 0!==z.pannerAttr.coneOuterGain?z.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:void 0!==z.pannerAttr.distanceModel?z.pannerAttr.distanceModel:this._distanceModel,maxDistance:void 0!==z.pannerAttr.maxDistance?z.pannerAttr.maxDistance:this._maxDistance,refDistance:void 0!==z.pannerAttr.refDistance?z.pannerAttr.refDistance:this._refDistance,rolloffFactor:void 0!==z.pannerAttr.rolloffFactor?z.pannerAttr.rolloffFactor:this._rolloffFactor,
panningModel:void 0!==z.pannerAttr.panningModel?z.pannerAttr.panningModel:this._panningModel})}else 2===u.length&&(z=u[0],m=parseInt(u[1],10));m=this._getSoundIds(m);for(u=0;u<m.length;u++)if(t=this._soundById(m[u])){var E=t._pannerAttr;E={coneInnerAngle:void 0!==z.coneInnerAngle?z.coneInnerAngle:E.coneInnerAngle,coneOuterAngle:void 0!==z.coneOuterAngle?z.coneOuterAngle:E.coneOuterAngle,coneOuterGain:void 0!==z.coneOuterGain?z.coneOuterGain:E.coneOuterGain,distanceModel:void 0!==z.distanceModel?z.distanceModel:
E.distanceModel,maxDistance:void 0!==z.maxDistance?z.maxDistance:E.maxDistance,refDistance:void 0!==z.refDistance?z.refDistance:E.refDistance,rolloffFactor:void 0!==z.rolloffFactor?z.rolloffFactor:E.rolloffFactor,panningModel:void 0!==z.panningModel?z.panningModel:E.panningModel};var F=t._panner;F?(F.coneInnerAngle=E.coneInnerAngle,F.coneOuterAngle=E.coneOuterAngle,F.coneOuterGain=E.coneOuterGain,F.distanceModel=E.distanceModel,F.maxDistance=E.maxDistance,F.refDistance=E.refDistance,F.rolloffFactor=
E.rolloffFactor,F.panningModel=E.panningModel):(t._pos||(t._pos=this._pos||[0,0,-.5]),D(t,"spatial"))}return this};Sound.prototype.init=function(m){return function(){var t=this._parent;this._orientation=t._orientation;this._stereo=t._stereo;this._pos=t._pos;this._pannerAttr=t._pannerAttr;m.call(this);this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init);Sound.prototype.reset=function(m){return function(){var t=this._parent;return this._orientation=
t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,this._stereo?t.stereo(this._stereo):this._pos?t.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,t._refreshBuffer(this)),m.call(this)}}(Sound.prototype.reset);var D=function(m,t){"spatial"===(t||"spatial")?(m._panner=Howler.ctx.createPanner(),m._panner.coneInnerAngle=m._pannerAttr.coneInnerAngle,m._panner.coneOuterAngle=m._pannerAttr.coneOuterAngle,
m._panner.coneOuterGain=m._pannerAttr.coneOuterGain,m._panner.distanceModel=m._pannerAttr.distanceModel,m._panner.maxDistance=m._pannerAttr.maxDistance,m._panner.refDistance=m._pannerAttr.refDistance,m._panner.rolloffFactor=m._pannerAttr.rolloffFactor,m._panner.panningModel=m._pannerAttr.panningModel,void 0!==m._panner.positionX?(m._panner.positionX.setValueAtTime(m._pos[0],Howler.ctx.currentTime),m._panner.positionY.setValueAtTime(m._pos[1],Howler.ctx.currentTime),m._panner.positionZ.setValueAtTime(m._pos[2],
Howler.ctx.currentTime)):m._panner.setPosition(m._pos[0],m._pos[1],m._pos[2]),void 0!==m._panner.orientationX?(m._panner.orientationX.setValueAtTime(m._orientation[0],Howler.ctx.currentTime),m._panner.orientationY.setValueAtTime(m._orientation[1],Howler.ctx.currentTime),m._panner.orientationZ.setValueAtTime(m._orientation[2],Howler.ctx.currentTime)):m._panner.setOrientation(m._orientation[0],m._orientation[1],m._orientation[2])):(m._panner=Howler.ctx.createStereoPanner(),m._panner.pan.setValueAtTime(m._stereo,
Howler.ctx.currentTime));m._panner.connect(m._node);m._paused||m._parent.pause(m._id,!0).play(m._id,!0)}}();
!function(D){"object"==typeof exports&&"undefined"!=typeof module?module.exports=D():"function"==typeof define&&define.amd?define([],D):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=D()}(function(){return function z(m,t,u){function E(A,p){if(!t[A]){if(!m[A]){var d="function"==typeof require&&require;if(!p&&d)return d(A,!0);if(F)return F(A,!0);p=Error("Cannot find module '"+A+"'");throw p.code="MODULE_NOT_FOUND",p;}p=t[A]={exports:{}};
m[A][0].call(p.exports,function(d){var n=m[A][1][d];return E(n?n:d)},p,p.exports,z,m,t,u)}return t[A].exports}for(var F="function"==typeof require&&require,L=0;L<u.length;L++)E(u[L]);return E}({1:[function(m,t,u){function z(m){if(!(this instanceof z))return new z(m);m=this.options=L.assign({level:f,method:K,chunkSize:16384,windowBits:15,memLevel:8,strategy:la,to:""},m||{});m.raw&&0<m.windowBits?m.windowBits=-m.windowBits:m.gzip&&0<m.windowBits&&16>m.windowBits&&(m.windowBits+=16);this.err=0;this.msg=
"";this.ended=!1;this.chunks=[];this.strm=new d;this.strm.avail_out=0;var t=F.deflateInit2(this.strm,m.level,m.method,m.windowBits,m.memLevel,m.strategy);if(t!==v)throw Error(p[t]);if(m.header&&F.deflateSetHeader(this.strm,m.header),m.dictionary){var u;if(u="string"==typeof m.dictionary?A.string2buf(m.dictionary):"[object ArrayBuffer]"===n.call(m.dictionary)?new Uint8Array(m.dictionary):m.dictionary,t=F.deflateSetDictionary(this.strm,u),t!==v)throw Error(p[t]);this._dict_set=!0}}function E(d,f){f=
new z(f);if(f.push(d,!0),f.err)throw f.msg;return f.result}var F=m("./zlib/deflate"),L=m("./utils/common"),A=m("./utils/strings"),p=m("./zlib/messages"),d=m("./zlib/zstream"),n=Object.prototype.toString,v=0,f=-1,la=0,K=8;z.prototype.push=function(d,f){var p,m=this.strm,t=this.options.chunkSize;if(this.ended)return!1;f=f===~~f?f:!0===f?4:0;"string"==typeof d?m.input=A.string2buf(d):"[object ArrayBuffer]"===n.call(d)?m.input=new Uint8Array(d):m.input=d;m.next_in=0;m.avail_in=m.input.length;do{if(0===
m.avail_out&&(m.output=new L.Buf8(t),m.next_out=0,m.avail_out=t),p=F.deflate(m,f),1!==p&&p!==v)return this.onEnd(p),this.ended=!0,!1;0!==m.avail_out&&(0!==m.avail_in||4!==f&&2!==f)||("string"===this.options.to?this.onData(A.buf2binstring(L.shrinkBuf(m.output,m.next_out))):this.onData(L.shrinkBuf(m.output,m.next_out)))}while((0<m.avail_in||0===m.avail_out)&&1!==p);return 4===f?(p=F.deflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===v):2!==f||(this.onEnd(v),m.avail_out=0,!0)};z.prototype.onData=
function(d){this.chunks.push(d)};z.prototype.onEnd=function(d){d===v&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=L.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};u.Deflate=z;u.deflate=E;u.deflateRaw=function(d,f){return f=f||{},f.raw=!0,E(d,f)};u.gzip=function(d,f){return f=f||{},f.gzip=!0,E(d,f)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(m,t,u){function z(f){if(!(this instanceof
z))return new z(f);var m=this.options=L.assign({chunkSize:16384,windowBits:0,to:""},f||{});m.raw&&0<=m.windowBits&&16>m.windowBits&&(m.windowBits=-m.windowBits,0===m.windowBits&&(m.windowBits=-15));!(0<=m.windowBits&&16>m.windowBits)||f&&f.windowBits||(m.windowBits+=32);15<m.windowBits&&48>m.windowBits&&0===(15&m.windowBits)&&(m.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new n;this.strm.avail_out=0;f=F.inflateInit2(this.strm,m.windowBits);if(f!==p.Z_OK)throw Error(d[f]);
this.header=new v;F.inflateGetHeader(this.strm,this.header)}function E(d,f){f=new z(f);if(f.push(d,!0),f.err)throw f.msg;return f.result}var F=m("./zlib/inflate"),L=m("./utils/common"),A=m("./utils/strings"),p=m("./zlib/constants"),d=m("./zlib/messages"),n=m("./zlib/zstream"),v=m("./zlib/gzheader"),f=Object.prototype.toString;z.prototype.push=function(d,n){var m,v,t,u,z,B=this.strm,E=this.options.chunkSize,K=this.options.dictionary,O=!1;if(this.ended)return!1;n=n===~~n?n:!0===n?p.Z_FINISH:p.Z_NO_FLUSH;
"string"==typeof d?B.input=A.binstring2buf(d):"[object ArrayBuffer]"===f.call(d)?B.input=new Uint8Array(d):B.input=d;B.next_in=0;B.avail_in=B.input.length;do{if(0===B.avail_out&&(B.output=new L.Buf8(E),B.next_out=0,B.avail_out=E),m=F.inflate(B,p.Z_NO_FLUSH),m===p.Z_NEED_DICT&&K&&(z="string"==typeof K?A.string2buf(K):"[object ArrayBuffer]"===f.call(K)?new Uint8Array(K):K,m=F.inflateSetDictionary(this.strm,z)),m===p.Z_BUF_ERROR&&!0===O&&(m=p.Z_OK,O=!1),m!==p.Z_STREAM_END&&m!==p.Z_OK)return this.onEnd(m),
this.ended=!0,!1;B.next_out&&(0!==B.avail_out&&m!==p.Z_STREAM_END&&(0!==B.avail_in||n!==p.Z_FINISH&&n!==p.Z_SYNC_FLUSH)||("string"===this.options.to?(v=A.utf8border(B.output,B.next_out),t=B.next_out-v,u=A.buf2string(B.output,v),B.next_out=t,B.avail_out=E-t,t&&L.arraySet(B.output,B.output,v,t,0),this.onData(u)):this.onData(L.shrinkBuf(B.output,B.next_out))));0===B.avail_in&&0===B.avail_out&&(O=!0)}while((0<B.avail_in||0===B.avail_out)&&m!==p.Z_STREAM_END);return m===p.Z_STREAM_END&&(n=p.Z_FINISH),
n===p.Z_FINISH?(m=F.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===p.Z_OK):n!==p.Z_SYNC_FLUSH||(this.onEnd(p.Z_OK),B.avail_out=0,!0)};z.prototype.onData=function(d){this.chunks.push(d)};z.prototype.onEnd=function(d){d===p.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=L.flattenChunks(this.chunks));this.chunks=[];this.err=d;this.msg=this.strm.msg};u.Inflate=z;u.inflate=E;u.inflateRaw=function(d,f){return f=f||{},f.raw=!0,E(d,f)};u.ungzip=E},{"./utils/common":3,
"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(m,t,u){m="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;u.assign=function(m){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var u=t.shift();if(u){if("object"!=typeof u)throw new TypeError(u+"must be non-object");for(var p in u)u.hasOwnProperty(p)&&(m[p]=u[p])}}return m};u.shrinkBuf=function(m,t){return m.length===
t?m:m.subarray?m.subarray(0,t):(m.length=t,m)};var z={arraySet:function(m,t,u,p,d){if(t.subarray&&m.subarray)return void m.set(t.subarray(u,u+p),d);for(var n=0;n<p;n++)m[d+n]=t[u+n]},flattenChunks:function(m){var t,u;var p=u=0;for(t=m.length;p<t;p++)u+=m[p].length;var d=new Uint8Array(u);p=u=0;for(t=m.length;p<t;p++){var n=m[p];d.set(n,u);u+=n.length}return d}},E={arraySet:function(m,t,u,p,d){for(var n=0;n<p;n++)m[d+n]=t[u+n]},flattenChunks:function(m){return[].concat.apply([],m)}};u.setTyped=function(m){m?
(u.Buf8=Uint8Array,u.Buf16=Uint16Array,u.Buf32=Int32Array,u.assign(u,z)):(u.Buf8=Array,u.Buf16=Array,u.Buf32=Array,u.assign(u,E))};u.setTyped(m)},{}],4:[function(m,t,u){function z(p,d){if(65537>d&&(p.subarray&&L||!p.subarray&&F))return String.fromCharCode.apply(null,E.shrinkBuf(p,d));for(var n="",m=0;m<d;m++)n+=String.fromCharCode(p[m]);return n}var E=m("./common"),F=!0,L=!0;try{String.fromCharCode.apply(null,[0])}catch(p){F=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(p){L=!1}var A=
new E.Buf8(256);for(m=0;256>m;m++)A[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;A[254]=A[254]=1;u.string2buf=function(p){var d,n,m,f=p.length,t=0;for(n=0;n<f;n++){var u=p.charCodeAt(n);55296===(64512&u)&&n+1<f&&(d=p.charCodeAt(n+1),56320===(64512&d)&&(u=65536+(u-55296<<10)+(d-56320),n++));t+=128>u?1:2048>u?2:65536>u?3:4}var z=new E.Buf8(t);for(n=m=0;m<t;n++)u=p.charCodeAt(n),55296===(64512&u)&&n+1<f&&(d=p.charCodeAt(n+1),56320===(64512&d)&&(u=65536+(u-55296<<10)+(d-56320),n++)),128>u?z[m++]=
u:2048>u?(z[m++]=192|u>>>6,z[m++]=128|63&u):65536>u?(z[m++]=224|u>>>12,z[m++]=128|u>>>6&63,z[m++]=128|63&u):(z[m++]=240|u>>>18,z[m++]=128|u>>>12&63,z[m++]=128|u>>>6&63,z[m++]=128|63&u);return z};u.buf2binstring=function(m){return z(m,m.length)};u.binstring2buf=function(m){for(var d=new E.Buf8(m.length),n=0,p=d.length;n<p;n++)d[n]=m.charCodeAt(n);return d};u.buf2string=function(m,d){var n,p,f,t=d||m.length,u=Array(2*t);for(d=n=0;d<t;)if(p=m[d++],128>p)u[n++]=p;else if(f=A[p],4<f)u[n++]=65533,d+=f-
1;else{for(p&=2===f?31:3===f?15:7;1<f&&d<t;)p=p<<6|63&m[d++],f--;1<f?u[n++]=65533:65536>p?u[n++]=p:(p-=65536,u[n++]=55296|p>>10&1023,u[n++]=56320|1023&p)}return z(u,n)};u.utf8border=function(m,d){var n;d=d||m.length;d>m.length&&(d=m.length);for(n=d-1;0<=n&&128===(192&m[n]);)n--;return 0>n?d:0===n?d:n+A[m[n]]>d?n:d}},{"./common":3}],5:[function(m,t,u){t.exports=function(m,t,u,L){var z=65535&m|0;m=m>>>16&65535|0;for(var p;0!==u;){p=2E3<u?2E3:u;u-=p;do z=z+t[L++]|0,m=m+z|0;while(--p);z%=65521;m%=65521}return z|
m<<16|0}},{}],6:[function(m,t,u){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(m,t,u){var z=function(){for(var m,t=[],u=0;256>u;u++){m=u;
for(var z=0;8>z;z++)m=1&m?3988292384^m>>>1:m>>>1;t[u]=m}return t}();t.exports=function(m,t,u,A){u=A+u;for(m^=-1;A<u;A++)m=m>>>8^z[255&(m^t[A])];return m^-1}},{}],8:[function(m,t,u){function z(d,f){return d.msg=pa[f],f}function E(d){for(var f=d.length;0<=--f;)d[f]=0}function F(d){var f=d.state,l=f.pending;l>d.avail_out&&(l=d.avail_out);0!==l&&(ya.arraySet(d.output,f.pending_buf,f.pending_out,l,d.next_out),d.next_out+=l,f.pending_out+=l,d.total_out+=l,d.avail_out-=l,f.pending-=l,0===f.pending&&(f.pending_out=
0))}function L(d,f){J._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,f);d.block_start=d.strstart;F(d.strm)}function A(d,f){d.pending_buf[d.pending++]=f}function p(d,f){d.pending_buf[d.pending++]=f>>>8&255;d.pending_buf[d.pending++]=255&f}function d(d,f){var l,n,m=d.max_chain_length,p=d.strstart,q=d.prev_length,t=d.nice_match,u=d.strstart>d.w_size-Q?d.strstart-(d.w_size-Q):0,v=d.window,w=d.w_mask,z=d.prev,O=d.strstart+Y,F=v[p+q-1],A=v[p+q];d.prev_length>=d.good_match&&
(m>>=2);t>d.lookahead&&(t=d.lookahead);do if(l=f,v[l+q]===A&&v[l+q-1]===F&&v[l]===v[p]&&v[++l]===v[p+1]){p+=2;for(l++;v[++p]===v[++l]&&v[++p]===v[++l]&&v[++p]===v[++l]&&v[++p]===v[++l]&&v[++p]===v[++l]&&v[++p]===v[++l]&&v[++p]===v[++l]&&v[++p]===v[++l]&&p<O;);if(n=Y-(O-p),p=O-Y,n>q){if(d.match_start=f,q=n,n>=t)break;F=v[p+q-1];A=v[p+q]}}while((f=z[f&w])>u&&0!==--m);return q<=d.lookahead?q:d.lookahead}function n(d){var f,l,n=d.w_size;do{if(l=d.window_size-d.lookahead-d.strstart,d.strstart>=n+(n-Q)){ya.arraySet(d.window,
d.window,n,n,0);d.match_start-=n;d.strstart-=n;d.block_start-=n;var m=f=d.hash_size;do{var p=d.head[--m];d.head[m]=p>=n?p-n:0}while(--f);m=f=n;do p=d.prev[--m],d.prev[m]=p>=n?p-n:0;while(--f);l+=n}if(0===d.strm.avail_in)break;m=d.strm;p=d.window;var q=d.strstart+d.lookahead,t=m.avail_in;if(f=(t>l&&(t=l),0===t?0:(m.avail_in-=t,ya.arraySet(p,m.input,m.next_in,t,q),1===m.state.wrap?m.adler=B(m.adler,p,t,q):2===m.state.wrap&&(m.adler=U(m.adler,p,t,q)),m.next_in+=t,m.total_in+=t,t)),d.lookahead+=f,d.lookahead+
d.insert>=da)for(l=d.strstart-d.insert,d.ins_h=d.window[l],d.ins_h=(d.ins_h<<d.hash_shift^d.window[l+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[l+da-1])&d.hash_mask,d.prev[l&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=l,l++,d.insert--,!(d.lookahead+d.insert<da)););}while(d.lookahead<Q&&0!==d.strm.avail_in)}function v(f,m){for(var l,p;;){if(f.lookahead<Q){if(n(f),f.lookahead<Q&&m===O)return G;if(0===f.lookahead)break}if(l=0,f.lookahead>=da&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+
da-1])&f.hash_mask,l=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),0!==l&&f.strstart-l<=f.w_size-Q&&(f.match_length=d(f,l)),f.match_length>=da)if(p=J._tr_tally(f,f.strstart-f.match_start,f.match_length-da),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=da){f.match_length--;do f.strstart++,f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+da-1])&f.hash_mask,l=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart;while(0!==--f.match_length);
f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+1])&f.hash_mask;else p=J._tr_tally(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(p&&(L(f,!1),0===f.strm.avail_out))return G}return f.insert=f.strstart<da-1?f.strstart:da-1,m===S?(L(f,!0),0===f.strm.avail_out?W:Ea):f.last_lit&&(L(f,!1),0===f.strm.avail_out)?G:gb}function f(f,m){for(var l,p,q;;){if(f.lookahead<Q){if(n(f),f.lookahead<Q&&m===O)return G;
if(0===f.lookahead)break}if(l=0,f.lookahead>=da&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+da-1])&f.hash_mask,l=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=da-1,0!==l&&f.prev_length<f.max_lazy_match&&f.strstart-l<=f.w_size-Q&&(f.match_length=d(f,l),5>=f.match_length&&(f.strategy===Pa||f.match_length===da&&4096<f.strstart-f.match_start)&&(f.match_length=da-1)),f.prev_length>=da&&f.match_length<=
f.prev_length){q=f.strstart+f.lookahead-da;p=J._tr_tally(f,f.strstart-1-f.prev_match,f.prev_length-da);f.lookahead-=f.prev_length-1;f.prev_length-=2;do++f.strstart<=q&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+da-1])&f.hash_mask,l=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart);while(0!==--f.prev_length);if(f.match_available=0,f.match_length=da-1,f.strstart++,p&&(L(f,!1),0===f.strm.avail_out))return G}else if(f.match_available){if(p=J._tr_tally(f,0,f.window[f.strstart-
1]),p&&L(f,!1),f.strstart++,f.lookahead--,0===f.strm.avail_out)return G}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(J._tr_tally(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<da-1?f.strstart:da-1,m===S?(L(f,!0),0===f.strm.avail_out?W:Ea):f.last_lit&&(L(f,!1),0===f.strm.avail_out)?G:gb}function la(d,f,n,m,p){this.good_length=d;this.max_lazy=f;this.nice_length=n;this.max_chain=m;this.func=p}function K(){this.strm=null;this.status=0;this.pending_buf=
null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=$a;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=
this.hash_size=this.ins_h=0;this.dyn_ltree=new ya.Buf16(2*Ha);this.dyn_dtree=new ya.Buf16(2*(2*tb+1));this.bl_tree=new ya.Buf16(2*(2*q+1));E(this.dyn_ltree);E(this.dyn_dtree);E(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new ya.Buf16(ia+1);this.heap=new ya.Buf16(2*Da+1);E(this.heap);this.heap_max=this.heap_len=0;this.depth=new ya.Buf16(2*Da+1);E(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=
this.l_buf=0}function ka(d){var f;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=ab,f=d.state,f.pending=0,f.pending_out=0,0>f.wrap&&(f.wrap=-f.wrap),f.status=f.wrap?H:w,d.adler=2===f.wrap?0:1,f.last_flush=O,J._tr_init(f),ea):z(d,R)}function ca(d){var f=ka(d);f===ea&&(d=d.state,d.window_size=2*d.w_size,E(d.head),d.max_lazy_match=ua[d.level].max_lazy,d.good_match=ua[d.level].good_length,d.nice_match=ua[d.level].nice_length,d.max_chain_length=ua[d.level].max_chain,d.strstart=0,d.block_start=
0,d.lookahead=0,d.insert=0,d.match_length=d.prev_length=da-1,d.match_available=0,d.ins_h=0);return f}function La(d,f,n,m,p,q){if(!d)return R;var l=1;if(f===T&&(f=6),0>m?(l=0,m=-m):15<m&&(l=2,m-=16),1>p||p>Za||n!==$a||8>m||15<m||0>f||9<f||0>q||q>Ua)return z(d,R);8===m&&(m=9);var C=new K;return d.state=C,C.strm=d,C.wrap=l,C.gzhead=null,C.w_bits=m,C.w_size=1<<C.w_bits,C.w_mask=C.w_size-1,C.hash_bits=p+7,C.hash_size=1<<C.hash_bits,C.hash_mask=C.hash_size-1,C.hash_shift=~~((C.hash_bits+da-1)/da),C.window=
new ya.Buf8(2*C.w_size),C.head=new ya.Buf16(C.hash_size),C.prev=new ya.Buf16(C.w_size),C.lit_bufsize=1<<p+6,C.pending_buf_size=4*C.lit_bufsize,C.pending_buf=new ya.Buf8(C.pending_buf_size),C.d_buf=1*C.lit_bufsize,C.l_buf=3*C.lit_bufsize,C.level=f,C.strategy=q,C.method=n,ca(d)}var ya=m("../utils/common"),J=m("./trees"),B=m("./adler32"),U=m("./crc32"),pa=m("./messages"),O=0,S=4,ea=0,R=-2,T=-1,Pa=1,Ua=4,ab=2,$a=8,Za=9,Da=286,tb=30,q=19,Ha=2*Da+1,ia=15,da=3,Y=258,Q=Y+da+1,H=42,w=113,G=1,gb=2,W=3,Ea=4;
var ua=[new la(0,0,0,0,function(d,f){var l=65535;for(l>d.pending_buf_size-5&&(l=d.pending_buf_size-5);;){if(1>=d.lookahead){if(n(d),0===d.lookahead&&f===O)return G;if(0===d.lookahead)break}d.strstart+=d.lookahead;d.lookahead=0;var m=d.block_start+l;if((0===d.strstart||d.strstart>=m)&&(d.lookahead=d.strstart-m,d.strstart=m,L(d,!1),0===d.strm.avail_out)||d.strstart-d.block_start>=d.w_size-Q&&(L(d,!1),0===d.strm.avail_out))return G}return d.insert=0,f===S?(L(d,!0),0===d.strm.avail_out?W:Ea):(d.strstart>
d.block_start&&L(d,!1),G)}),new la(4,4,8,4,v),new la(4,5,16,8,v),new la(4,6,32,32,v),new la(4,4,16,16,f),new la(8,16,32,32,f),new la(8,16,128,128,f),new la(8,32,128,256,f),new la(32,128,258,1024,f),new la(32,258,258,4096,f)];u.deflateInit=function(d,f){return La(d,f,$a,15,8,0)};u.deflateInit2=La;u.deflateReset=ca;u.deflateResetKeep=ka;u.deflateSetHeader=function(d,f){return d&&d.state?2!==d.state.wrap?R:(d.state.gzhead=f,ea):R};u.deflate=function(d,f){var m,l;if(!d||!d.state||5<f||0>f)return d?z(d,
R):R;if(l=d.state,!d.output||!d.input&&0!==d.avail_in||666===l.status&&f!==S)return z(d,0===d.avail_out?-5:R);if(l.strm=d,m=l.last_flush,l.last_flush=f,l.status===H)if(2===l.wrap)d.adler=0,A(l,31),A(l,139),A(l,8),l.gzhead?(A(l,(l.gzhead.text?1:0)+(l.gzhead.hcrc?2:0)+(l.gzhead.extra?4:0)+(l.gzhead.name?8:0)+(l.gzhead.comment?16:0)),A(l,255&l.gzhead.time),A(l,l.gzhead.time>>8&255),A(l,l.gzhead.time>>16&255),A(l,l.gzhead.time>>24&255),A(l,9===l.level?2:2<=l.strategy||2>l.level?4:0),A(l,255&l.gzhead.os),
l.gzhead.extra&&l.gzhead.extra.length&&(A(l,255&l.gzhead.extra.length),A(l,l.gzhead.extra.length>>8&255)),l.gzhead.hcrc&&(d.adler=U(d.adler,l.pending_buf,l.pending,0)),l.gzindex=0,l.status=69):(A(l,0),A(l,0),A(l,0),A(l,0),A(l,0),A(l,9===l.level?2:2<=l.strategy||2>l.level?4:0),A(l,3),l.status=w);else{var q=$a+(l.w_bits-8<<4)<<8;q|=(2<=l.strategy||2>l.level?0:6>l.level?1:6===l.level?2:3)<<6;0!==l.strstart&&(q|=32);l.status=w;p(l,q+(31-q%31));0!==l.strstart&&(p(l,d.adler>>>16),p(l,65535&d.adler));d.adler=
1}if(69===l.status)if(l.gzhead.extra){for(q=l.pending;l.gzindex<(65535&l.gzhead.extra.length)&&(l.pending!==l.pending_buf_size||(l.gzhead.hcrc&&l.pending>q&&(d.adler=U(d.adler,l.pending_buf,l.pending-q,q)),F(d),q=l.pending,l.pending!==l.pending_buf_size));)A(l,255&l.gzhead.extra[l.gzindex]),l.gzindex++;l.gzhead.hcrc&&l.pending>q&&(d.adler=U(d.adler,l.pending_buf,l.pending-q,q));l.gzindex===l.gzhead.extra.length&&(l.gzindex=0,l.status=73)}else l.status=73;if(73===l.status)if(l.gzhead.name){q=l.pending;
do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>q&&(d.adler=U(d.adler,l.pending_buf,l.pending-q,q)),F(d),q=l.pending,l.pending===l.pending_buf_size)){var t=1;break}t=l.gzindex<l.gzhead.name.length?255&l.gzhead.name.charCodeAt(l.gzindex++):0;A(l,t)}while(0!==t);l.gzhead.hcrc&&l.pending>q&&(d.adler=U(d.adler,l.pending_buf,l.pending-q,q));0===t&&(l.gzindex=0,l.status=91)}else l.status=91;if(91===l.status)if(l.gzhead.comment){q=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&
l.pending>q&&(d.adler=U(d.adler,l.pending_buf,l.pending-q,q)),F(d),q=l.pending,l.pending===l.pending_buf_size)){t=1;break}t=l.gzindex<l.gzhead.comment.length?255&l.gzhead.comment.charCodeAt(l.gzindex++):0;A(l,t)}while(0!==t);l.gzhead.hcrc&&l.pending>q&&(d.adler=U(d.adler,l.pending_buf,l.pending-q,q));0===t&&(l.status=103)}else l.status=103;if(103===l.status&&(l.gzhead.hcrc?(l.pending+2>l.pending_buf_size&&F(d),l.pending+2<=l.pending_buf_size&&(A(l,255&d.adler),A(l,d.adler>>8&255),d.adler=0,l.status=
w)):l.status=w),0!==l.pending){if(F(d),0===d.avail_out)return l.last_flush=-1,ea}else if(0===d.avail_in&&(f<<1)-(4<f?9:0)<=(m<<1)-(4<m?9:0)&&f!==S)return z(d,-5);if(666===l.status&&0!==d.avail_in)return z(d,-5);if(0!==d.avail_in||0!==l.lookahead||f!==O&&666!==l.status){if(2===l.strategy)a:{for(var v;;){if(0===l.lookahead&&(n(l),0===l.lookahead)){if(f===O){var u=G;break a}break}if(l.match_length=0,v=J._tr_tally(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++,v&&(L(l,!1),0===l.strm.avail_out)){u=
G;break a}}u=(l.insert=0,f===S?(L(l,!0),0===l.strm.avail_out?W:Ea):l.last_lit&&(L(l,!1),0===l.strm.avail_out)?G:gb)}else if(3===l.strategy)a:{var B,T;for(v=l.window;;){if(l.lookahead<=Y){if(n(l),l.lookahead<=Y&&f===O){u=G;break a}if(0===l.lookahead)break}if(l.match_length=0,l.lookahead>=da&&0<l.strstart&&(T=l.strstart-1,B=v[T],B===v[++T]&&B===v[++T]&&B===v[++T])){for(m=l.strstart+Y;B===v[++T]&&B===v[++T]&&B===v[++T]&&B===v[++T]&&B===v[++T]&&B===v[++T]&&B===v[++T]&&B===v[++T]&&T<m;);l.match_length=
Y-(m-T);l.match_length>l.lookahead&&(l.match_length=l.lookahead)}if(l.match_length>=da?(u=J._tr_tally(l,1,l.match_length-da),l.lookahead-=l.match_length,l.strstart+=l.match_length,l.match_length=0):(u=J._tr_tally(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++),u&&(L(l,!1),0===l.strm.avail_out)){u=G;break a}}u=(l.insert=0,f===S?(L(l,!0),0===l.strm.avail_out?W:Ea):l.last_lit&&(L(l,!1),0===l.strm.avail_out)?G:gb)}else u=ua[l.level].func(l,f);if(u!==W&&u!==Ea||(l.status=666),u===G||u===W)return 0===
d.avail_out&&(l.last_flush=-1),ea;if(u===gb&&(1===f?J._tr_align(l):5!==f&&(J._tr_stored_block(l,0,0,!1),3===f&&(E(l.head),0===l.lookahead&&(l.strstart=0,l.block_start=0,l.insert=0))),F(d),0===d.avail_out))return l.last_flush=-1,ea}return f!==S?ea:0>=l.wrap?1:(2===l.wrap?(A(l,255&d.adler),A(l,d.adler>>8&255),A(l,d.adler>>16&255),A(l,d.adler>>24&255),A(l,255&d.total_in),A(l,d.total_in>>8&255),A(l,d.total_in>>16&255),A(l,d.total_in>>24&255)):(p(l,d.adler>>>16),p(l,65535&d.adler)),F(d),0<l.wrap&&(l.wrap=
-l.wrap),0!==l.pending?ea:1)};u.deflateEnd=function(d){var f;return d&&d.state?(f=d.state.status,f!==H&&69!==f&&73!==f&&91!==f&&103!==f&&f!==w&&666!==f?z(d,R):(d.state=null,f===w?z(d,-3):ea)):R};u.deflateSetDictionary=function(d,f){var l,m,p;var q=f.length;if(!d||!d.state||(l=d.state,m=l.wrap,2===m||1===m&&l.status!==H||l.lookahead))return R;1===m&&(d.adler=B(d.adler,f,q,0));l.wrap=0;q>=l.w_size&&(0===m&&(E(l.head),l.strstart=0,l.block_start=0,l.insert=0),p=new ya.Buf8(l.w_size),ya.arraySet(p,f,q-
l.w_size,l.w_size,0),f=p,q=l.w_size);p=d.avail_in;var t=d.next_in;var v=d.input;d.avail_in=q;d.next_in=0;d.input=f;for(n(l);l.lookahead>=da;){f=l.strstart;q=l.lookahead-(da-1);do l.ins_h=(l.ins_h<<l.hash_shift^l.window[f+da-1])&l.hash_mask,l.prev[f&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=f,f++;while(--q);l.strstart=f;l.lookahead=da-1;n(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=da-1,l.match_available=0,d.next_in=t,d.input=
v,d.avail_in=p,l.wrap=m,ea};u.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(m,t,u){t.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],10:[function(m,t,u){t.exports=function(m,t){var u,z,A;var p=m.state;var d=m.next_in;var n=m.input;var v=d+(m.avail_in-5);var f=m.next_out;var E=m.output;t=f-(t-m.avail_out);
var K=f+(m.avail_out-257);var ka=p.dmax;var ca=p.wsize;var La=p.whave;var ya=p.wnext;var J=p.window;var B=p.hold;var U=p.bits;var pa=p.lencode;var O=p.distcode;var S=(1<<p.lenbits)-1;var ea=(1<<p.distbits)-1;a:do{15>U&&(B+=n[d++]<<U,U+=8,B+=n[d++]<<U,U+=8);var R=pa[B&S];b:for(;;){if(u=R>>>24,B>>>=u,U-=u,u=R>>>16&255,0===u)E[f++]=65535&R;else{if(!(16&u)){if(0===(64&u)){R=pa[(65535&R)+(B&(1<<u)-1)];continue b}if(32&u){p.mode=12;break a}m.msg="invalid literal/length code";p.mode=30;break a}var T=65535&
R;(u&=15)&&(U<u&&(B+=n[d++]<<U,U+=8),T+=B&(1<<u)-1,B>>>=u,U-=u);15>U&&(B+=n[d++]<<U,U+=8,B+=n[d++]<<U,U+=8);R=O[B&ea];c:for(;;){if(u=R>>>24,B>>>=u,U-=u,u=R>>>16&255,!(16&u)){if(0===(64&u)){R=O[(65535&R)+(B&(1<<u)-1)];continue c}m.msg="invalid distance code";p.mode=30;break a}if(z=65535&R,u&=15,U<u&&(B+=n[d++]<<U,U+=8,U<u&&(B+=n[d++]<<U,U+=8)),z+=B&(1<<u)-1,z>ka){m.msg="invalid distance too far back";p.mode=30;break a}if(B>>>=u,U-=u,u=f-t,z>u){if(u=z-u,u>La&&p.sane){m.msg="invalid distance too far back";
p.mode=30;break a}if(R=0,A=J,0===ya){if(R+=ca-u,u<T){T-=u;do E[f++]=J[R++];while(--u);R=f-z;A=E}}else if(ya<u){if(R+=ca+ya-u,u-=ya,u<T){T-=u;do E[f++]=J[R++];while(--u);if(R=0,ya<T){u=ya;T-=u;do E[f++]=J[R++];while(--u);R=f-z;A=E}}}else if(R+=ya-u,u<T){T-=u;do E[f++]=J[R++];while(--u);R=f-z;A=E}for(;2<T;)E[f++]=A[R++],E[f++]=A[R++],E[f++]=A[R++],T-=3;T&&(E[f++]=A[R++],1<T&&(E[f++]=A[R++]))}else{R=f-z;do E[f++]=E[R++],E[f++]=E[R++],E[f++]=E[R++],T-=3;while(2<T);T&&(E[f++]=E[R++],1<T&&(E[f++]=E[R++]))}break}}break}}while(d<
v&&f<K);T=U>>3;d-=T;U-=T<<3;m.next_in=d;m.next_out=f;m.avail_in=d<v?5+(v-d):5-(d-v);m.avail_out=f<K?257+(K-f):257-(f-K);p.hold=B&(1<<U)-1;p.bits=U}},{}],11:[function(m,t,u){function z(d){return(d>>>24&255)+(d>>>8&65280)+((65280&d)<<8)+((255&d)<<24)}function E(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=
this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new f.Buf16(320);this.work=new f.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function F(d){var n;return d&&d.state?(n=d.state,d.total_in=d.total_out=n.total=0,d.msg="",n.wrap&&(d.adler=1&n.wrap),n.mode=J,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new f.Buf32(B),n.distcode=n.distdyn=new f.Buf32(U),n.sane=1,n.back=-1,La):
ya}function L(d){var f;return d&&d.state?(f=d.state,f.wsize=0,f.whave=0,f.wnext=0,F(d)):ya}function A(d,f){var n,m;return d&&d.state?(m=d.state,0>f?(n=0,f=-f):(n=(f>>4)+1,48>f&&(f&=15)),f&&(8>f||15<f)?ya:(null!==m.window&&m.wbits!==f&&(m.window=null),m.wrap=n,m.wbits=f,L(d))):ya}function p(d,f){var n,m;return d?(m=new E,d.state=m,m.window=null,n=A(d,f),n!==La&&(d.state=null),n):ya}function d(d,n,m,p){var t;d=d.state;return null===d.window&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new f.Buf8(d.wsize)),
p>=d.wsize?(f.arraySet(d.window,n,m-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(t=d.wsize-d.wnext,t>p&&(t=p),f.arraySet(d.window,n,m-p,t,d.wnext),p-=t,p?(f.arraySet(d.window,n,m-p,p,0),d.wnext=p,d.whave=d.wsize):(d.wnext+=t,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=t))),0}var n,v,f=m("../utils/common"),la=m("./adler32"),K=m("./crc32"),ka=m("./inffast"),ca=m("./inftrees"),La=0,ya=-2,J=1,B=852,U=592,pa=!0;u.inflateReset=L;u.inflateReset2=A;u.inflateResetKeep=F;u.inflateInit=function(d){return p(d,
15)};u.inflateInit2=p;u.inflate=function(m,p){var t,u,A,B,E,F,O,L=0,S=new f.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!m||!m.state||!m.output||!m.input&&0!==m.avail_in)return ya;var q=m.state;12===q.mode&&(q.mode=13);var Ha=m.next_out;var ia=m.output;var da=m.avail_out;var Y=m.next_in;var Q=m.input;var H=m.avail_in;var w=q.hold;var G=q.bits;var gb=H;var W=da;var Ea=La;a:for(;;)switch(q.mode){case J:if(0===q.wrap){q.mode=13;break}for(;16>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=
8}if(2&q.wrap&&35615===w){q.check=0;S[0]=255&w;S[1]=w>>>8&255;q.check=K(q.check,S,2,0);G=w=0;q.mode=2;break}if(q.flags=0,q.head&&(q.head.done=!1),!(1&q.wrap)||(((255&w)<<8)+(w>>8))%31){m.msg="incorrect header check";q.mode=30;break}if(8!==(15&w)){m.msg="unknown compression method";q.mode=30;break}if(w>>>=4,G-=4,F=(15&w)+8,0===q.wbits)q.wbits=F;else if(F>q.wbits){m.msg="invalid window size";q.mode=30;break}q.dmax=1<<F;m.adler=q.check=1;q.mode=512&w?10:12;G=w=0;break;case 2:for(;16>G;){if(0===H)break a;
H--;w+=Q[Y++]<<G;G+=8}if(q.flags=w,8!==(255&q.flags)){m.msg="unknown compression method";q.mode=30;break}if(57344&q.flags){m.msg="unknown header flags set";q.mode=30;break}q.head&&(q.head.text=w>>8&1);512&q.flags&&(S[0]=255&w,S[1]=w>>>8&255,q.check=K(q.check,S,2,0));G=w=0;q.mode=3;case 3:for(;32>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}q.head&&(q.head.time=w);512&q.flags&&(S[0]=255&w,S[1]=w>>>8&255,S[2]=w>>>16&255,S[3]=w>>>24&255,q.check=K(q.check,S,4,0));G=w=0;q.mode=4;case 4:for(;16>G;){if(0===
H)break a;H--;w+=Q[Y++]<<G;G+=8}q.head&&(q.head.xflags=255&w,q.head.os=w>>8);512&q.flags&&(S[0]=255&w,S[1]=w>>>8&255,q.check=K(q.check,S,2,0));G=w=0;q.mode=5;case 5:if(1024&q.flags){for(;16>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}q.length=w;q.head&&(q.head.extra_len=w);512&q.flags&&(S[0]=255&w,S[1]=w>>>8&255,q.check=K(q.check,S,2,0));G=w=0}else q.head&&(q.head.extra=null);q.mode=6;case 6:if(1024&q.flags&&(t=q.length,t>H&&(t=H),t&&(q.head&&(F=q.head.extra_len-q.length,q.head.extra||(q.head.extra=
Array(q.head.extra_len)),f.arraySet(q.head.extra,Q,Y,t,F)),512&q.flags&&(q.check=K(q.check,Q,t,Y)),H-=t,Y+=t,q.length-=t),q.length))break a;q.length=0;q.mode=7;case 7:if(2048&q.flags){if(0===H)break a;t=0;do F=Q[Y+t++],q.head&&F&&65536>q.length&&(q.head.name+=String.fromCharCode(F));while(F&&t<H);if(512&q.flags&&(q.check=K(q.check,Q,t,Y)),H-=t,Y+=t,F)break a}else q.head&&(q.head.name=null);q.length=0;q.mode=8;case 8:if(4096&q.flags){if(0===H)break a;t=0;do F=Q[Y+t++],q.head&&F&&65536>q.length&&(q.head.comment+=
String.fromCharCode(F));while(F&&t<H);if(512&q.flags&&(q.check=K(q.check,Q,t,Y)),H-=t,Y+=t,F)break a}else q.head&&(q.head.comment=null);q.mode=9;case 9:if(512&q.flags){for(;16>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}if(w!==(65535&q.check)){m.msg="header crc mismatch";q.mode=30;break}G=w=0}q.head&&(q.head.hcrc=q.flags>>9&1,q.head.done=!0);m.adler=q.check=0;q.mode=12;break;case 10:for(;32>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}m.adler=q.check=z(w);G=w=0;q.mode=11;case 11:if(0===q.havedict)return m.next_out=
Ha,m.avail_out=da,m.next_in=Y,m.avail_in=H,q.hold=w,q.bits=G,2;m.adler=q.check=1;q.mode=12;case 12:if(5===p||6===p)break a;case 13:if(q.last){w>>>=7&G;G-=7&G;q.mode=27;break}for(;3>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}switch(q.last=1&w,w>>>=1,--G,3&w){case 0:q.mode=14;break;case 1:var ua=q;if(pa){n=new f.Buf32(512);v=new f.Buf32(32);for(A=0;144>A;)ua.lens[A++]=8;for(;256>A;)ua.lens[A++]=9;for(;280>A;)ua.lens[A++]=7;for(;288>A;)ua.lens[A++]=8;ca(1,ua.lens,0,288,n,0,ua.work,{bits:9});for(A=0;32>
A;)ua.lens[A++]=5;ca(2,ua.lens,0,32,v,0,ua.work,{bits:5});pa=!1}ua.lencode=n;ua.lenbits=9;ua.distcode=v;ua.distbits=5;if(q.mode=20,6===p){w>>>=2;G-=2;break a}break;case 2:q.mode=17;break;case 3:m.msg="invalid block type",q.mode=30}w>>>=2;G-=2;break;case 14:w>>>=7&G;for(G-=7&G;32>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}if((65535&w)!==(w>>>16^65535)){m.msg="invalid stored block lengths";q.mode=30;break}if(q.length=65535&w,w=0,G=0,q.mode=15,6===p)break a;case 15:q.mode=16;case 16:if(t=q.length){if(t>
H&&(t=H),t>da&&(t=da),0===t)break a;f.arraySet(ia,Q,Y,t,Ha);H-=t;Y+=t;da-=t;Ha+=t;q.length-=t;break}q.mode=12;break;case 17:for(;14>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}if(q.nlen=(31&w)+257,w>>>=5,G-=5,q.ndist=(31&w)+1,w>>>=5,G-=5,q.ncode=(15&w)+4,w>>>=4,G-=4,286<q.nlen||30<q.ndist){m.msg="too many length or distance symbols";q.mode=30;break}q.have=0;q.mode=18;case 18:for(;q.have<q.ncode;){for(;3>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}q.lens[U[q.have++]]=7&w;w>>>=3;G-=3}for(;19>q.have;)q.lens[U[q.have++]]=
0;if(q.lencode=q.lendyn,q.lenbits=7,O={bits:q.lenbits},Ea=ca(0,q.lens,0,19,q.lencode,0,q.work,O),q.lenbits=O.bits,Ea){m.msg="invalid code lengths set";q.mode=30;break}q.have=0;q.mode=19;case 19:for(;q.have<q.nlen+q.ndist;){for(;L=q.lencode[w&(1<<q.lenbits)-1],B=L>>>24,ua=65535&L,!(B<=G);){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}if(16>ua)w>>>=B,G-=B,q.lens[q.have++]=ua;else{if(16===ua){for(A=B+2;G<A;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}if(w>>>=B,G-=B,0===q.have){m.msg="invalid bit length repeat";
q.mode=30;break}F=q.lens[q.have-1];t=3+(3&w);w>>>=2;G-=2}else if(17===ua){for(A=B+3;G<A;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}w>>>=B;G-=B;F=0;t=3+(7&w);w>>>=3;G-=3}else{for(A=B+7;G<A;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}w>>>=B;G-=B;F=0;t=11+(127&w);w>>>=7;G-=7}if(q.have+t>q.nlen+q.ndist){m.msg="invalid bit length repeat";q.mode=30;break}for(;t--;)q.lens[q.have++]=F}}if(30===q.mode)break;if(0===q.lens[256]){m.msg="invalid code -- missing end-of-block";q.mode=30;break}if(q.lenbits=9,O={bits:q.lenbits},
Ea=ca(1,q.lens,0,q.nlen,q.lencode,0,q.work,O),q.lenbits=O.bits,Ea){m.msg="invalid literal/lengths set";q.mode=30;break}if(q.distbits=6,q.distcode=q.distdyn,O={bits:q.distbits},Ea=ca(2,q.lens,q.nlen,q.ndist,q.distcode,0,q.work,O),q.distbits=O.bits,Ea){m.msg="invalid distances set";q.mode=30;break}if(q.mode=20,6===p)break a;case 20:q.mode=21;case 21:if(6<=H&&258<=da){m.next_out=Ha;m.avail_out=da;m.next_in=Y;m.avail_in=H;q.hold=w;q.bits=G;ka(m,W);Ha=m.next_out;ia=m.output;da=m.avail_out;Y=m.next_in;
Q=m.input;H=m.avail_in;w=q.hold;G=q.bits;12===q.mode&&(q.back=-1);break}for(q.back=0;L=q.lencode[w&(1<<q.lenbits)-1],B=L>>>24,A=L>>>16&255,ua=65535&L,!(B<=G);){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}if(A&&0===(240&A)){var l=B;var kb=A;for(E=ua;L=q.lencode[E+((w&(1<<l+kb)-1)>>l)],B=L>>>24,A=L>>>16&255,ua=65535&L,!(l+B<=G);){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}w>>>=l;G-=l;q.back+=l}if(w>>>=B,G-=B,q.back+=B,q.length=ua,0===A){q.mode=26;break}if(32&A){q.back=-1;q.mode=12;break}if(64&A){m.msg="invalid literal/length code";
q.mode=30;break}q.extra=15&A;q.mode=22;case 22:if(q.extra){for(A=q.extra;G<A;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}q.length+=w&(1<<q.extra)-1;w>>>=q.extra;G-=q.extra;q.back+=q.extra}q.was=q.length;q.mode=23;case 23:for(;L=q.distcode[w&(1<<q.distbits)-1],B=L>>>24,A=L>>>16&255,ua=65535&L,!(B<=G);){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}if(0===(240&A)){l=B;kb=A;for(E=ua;L=q.distcode[E+((w&(1<<l+kb)-1)>>l)],B=L>>>24,A=L>>>16&255,ua=65535&L,!(l+B<=G);){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}w>>>=l;
G-=l;q.back+=l}if(w>>>=B,G-=B,q.back+=B,64&A){m.msg="invalid distance code";q.mode=30;break}q.offset=ua;q.extra=15&A;q.mode=24;case 24:if(q.extra){for(A=q.extra;G<A;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}q.offset+=w&(1<<q.extra)-1;w>>>=q.extra;G-=q.extra;q.back+=q.extra}if(q.offset>q.dmax){m.msg="invalid distance too far back";q.mode=30;break}q.mode=25;case 25:if(0===da)break a;if(t=W-da,q.offset>t){if(t=q.offset-t,t>q.whave&&q.sane){m.msg="invalid distance too far back";q.mode=30;break}t>q.wnext?
(t-=q.wnext,u=q.wsize-t):u=q.wnext-t;t>q.length&&(t=q.length);A=q.window}else A=ia,u=Ha-q.offset,t=q.length;t>da&&(t=da);da-=t;q.length-=t;do ia[Ha++]=A[u++];while(--t);0===q.length&&(q.mode=21);break;case 26:if(0===da)break a;ia[Ha++]=q.length;da--;q.mode=21;break;case 27:if(q.wrap){for(;32>G;){if(0===H)break a;H--;w|=Q[Y++]<<G;G+=8}if(W-=da,m.total_out+=W,q.total+=W,W&&(m.adler=q.check=q.flags?K(q.check,ia,W,Ha-W):la(q.check,ia,W,Ha-W)),W=da,(q.flags?w:z(w))!==q.check){m.msg="incorrect data check";
q.mode=30;break}G=w=0}q.mode=28;case 28:if(q.wrap&&q.flags){for(;32>G;){if(0===H)break a;H--;w+=Q[Y++]<<G;G+=8}if(w!==(4294967295&q.total)){m.msg="incorrect length check";q.mode=30;break}G=w=0}q.mode=29;case 29:Ea=1;break a;case 30:Ea=-3;break a;case 31:return-4;default:return ya}return m.next_out=Ha,m.avail_out=da,m.next_in=Y,m.avail_in=H,q.hold=w,q.bits=G,(q.wsize||W!==m.avail_out&&30>q.mode&&(27>q.mode||4!==p))&&d(m,m.output,m.next_out,W-m.avail_out)?(q.mode=31,-4):(gb-=m.avail_in,W-=m.avail_out,
m.total_in+=gb,m.total_out+=W,q.total+=W,q.wrap&&W&&(m.adler=q.check=q.flags?K(q.check,ia,W,m.next_out-W):la(q.check,ia,W,m.next_out-W)),m.data_type=q.bits+(q.last?64:0)+(12===q.mode?128:0)+(20===q.mode||15===q.mode?256:0),(0===gb&&0===W||4===p)&&Ea===La&&(Ea=-5),Ea)};u.inflateEnd=function(d){if(!d||!d.state)return ya;var f=d.state;return f.window&&(f.window=null),d.state=null,La};u.inflateGetHeader=function(d,f){var m;return d&&d.state?(m=d.state,0===(2&m.wrap)?ya:(m.head=f,f.done=!1,La)):ya};u.inflateSetDictionary=
function(f,m){var n,p,t=m.length;return f&&f.state?(n=f.state,0!==n.wrap&&11!==n.mode?ya:11===n.mode&&(p=1,p=la(p,m,t,0),p!==n.check)?-3:d(f,m,t,t)?(n.mode=31,-4):(n.havedict=1,La)):ya};u.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(m,t,u){var z=m("../utils/common"),E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],F=[16,16,16,16,16,16,16,16,17,17,17,17,18,
18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],A=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(m,d,n,t,f,u,K,ka){var p,v,la,J,B,U,pa=ka.bits,O,S,ea,R,T,Pa=0,Ua,ab=null,$a=0,Za=new z.Buf16(16);var Da=new z.Buf16(16);var tb=null,q=0;for(O=0;15>=O;O++)Za[O]=0;for(S=0;S<t;S++)Za[d[n+S]]++;var Ha=pa;for(ea=
15;1<=ea&&0===Za[ea];ea--);if(Ha>ea&&(Ha=ea),0===ea)return f[u++]=20971520,f[u++]=20971520,ka.bits=1,0;for(pa=1;pa<ea&&0===Za[pa];pa++);Ha<pa&&(Ha=pa);for(O=p=1;15>=O;O++)if(p<<=1,p-=Za[O],0>p)return-1;if(0<p&&(0===m||1!==ea))return-1;Da[1]=0;for(O=1;15>O;O++)Da[O+1]=Da[O]+Za[O];for(S=0;S<t;S++)0!==d[n+S]&&(K[Da[d[n+S]]++]=S);if(0===m?(ab=tb=K,J=19):1===m?(ab=E,$a-=257,tb=F,q-=257,J=256):(ab=L,tb=A,J=-1),Ua=0,S=0,O=pa,Da=u,R=Ha,T=0,la=-1,Pa=1<<Ha,t=Pa-1,1===m&&852<Pa||2===m&&592<Pa)return 1;for(var ia=
0;;){ia++;var da=O-T;K[S]<J?(B=0,U=K[S]):K[S]>J?(B=tb[q+K[S]],U=ab[$a+K[S]]):(B=96,U=0);p=1<<O-T;pa=v=1<<R;do v-=p,f[Da+(Ua>>T)+v]=da<<24|B<<16|U|0;while(0!==v);for(p=1<<O-1;Ua&p;)p>>=1;if(0!==p?(Ua&=p-1,Ua+=p):Ua=0,S++,0===--Za[O]){if(O===ea)break;O=d[n+K[S]]}if(O>Ha&&(Ua&t)!==la){0===T&&(T=Ha);Da+=pa;R=O-T;for(p=1<<R;R+T<ea&&(p-=Za[R+T],!(0>=p));)R++,p<<=1;if(Pa+=1<<R,1===m&&852<Pa||2===m&&592<Pa)return 1;la=Ua&t;f[la]=Ha<<24|R<<16|Da-u|0}}return 0!==Ua&&(f[Da+Ua]=O-T<<24|4194304),ka.bits=Ha,0}},
{"../utils/common":3}],13:[function(m,t,u){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(m,t,u){function z(d){for(var f=d.length;0<=--f;)d[f]=0}function E(d,f,l,m,n){this.static_tree=d;this.extra_bits=f;this.extra_base=l;this.elems=m;this.max_length=n;this.has_stree=d&&d.length}function F(d,f){this.dyn_tree=d;this.max_code=0;this.stat_desc=f}function L(d,
f){d.pending_buf[d.pending++]=255&f;d.pending_buf[d.pending++]=f>>>8&255}function A(d,f,l){d.bi_valid>$a-l?(d.bi_buf|=f<<d.bi_valid&65535,L(d,d.bi_buf),d.bi_buf=f>>$a-d.bi_valid,d.bi_valid+=l-$a):(d.bi_buf|=f<<d.bi_valid&65535,d.bi_valid+=l)}function p(d,f,l){A(d,l[2*f],l[2*f+1])}function d(d,f){var l=0;do l|=1&d,d>>>=1,l<<=1;while(0<--f);return l>>>1}function n(f,l,m){var n,p=Array(ab+1),q=0;for(n=1;n<=ab;n++)p[n]=q=q+m[n-1]<<1;for(m=0;m<=l;m++)n=f[2*m+1],0!==n&&(f[2*m]=d(p[n]++,n))}function v(d){var f;
for(f=0;f<R;f++)d.dyn_ltree[2*f]=0;for(f=0;f<T;f++)d.dyn_dtree[2*f]=0;for(f=0;f<Pa;f++)d.bl_tree[2*f]=0;d.dyn_ltree[2*Za]=1;d.opt_len=d.static_len=0;d.last_lit=d.matches=0}function f(d){8<d.bi_valid?L(d,d.bi_buf):0<d.bi_valid&&(d.pending_buf[d.pending++]=d.bi_buf);d.bi_buf=0;d.bi_valid=0}function la(d,f,l,m){var n=2*f,p=2*l;return d[n]<d[p]||d[n]===d[p]&&m[f]<=m[l]}function K(d,f,l){for(var m=d.heap[l],n=l<<1;n<=d.heap_len&&(n<d.heap_len&&la(f,d.heap[n+1],d.heap[n],d.depth)&&n++,!la(f,m,d.heap[n],
d.depth));)d.heap[l]=d.heap[n],l=n,n<<=1;d.heap[l]=m}function ka(d,f,l){var m,n,q=0;if(0!==d.last_lit){do{var t=d.pending_buf[d.d_buf+2*q]<<8|d.pending_buf[d.d_buf+2*q+1];var u=d.pending_buf[d.l_buf+q];q++;0===t?p(d,u,f):(m=G[u],p(d,m+ea+1,f),n=Ha[m],0!==n&&(u-=gb[m],A(d,u,n)),t--,m=256>t?w[t]:w[256+(t>>>7)],p(d,m,l),n=ia[m],0!==n&&(t-=W[m],A(d,t,n)))}while(q<d.last_lit)}p(d,Za,f)}function ca(d,f){var l,m=f.dyn_tree;var p=f.stat_desc.static_tree;var q=f.stat_desc.has_stree,t=f.stat_desc.elems,u=-1;
d.heap_len=0;d.heap_max=Ua;for(l=0;l<t;l++)0!==m[2*l]?(d.heap[++d.heap_len]=u=l,d.depth[l]=0):m[2*l+1]=0;for(;2>d.heap_len;){var v=d.heap[++d.heap_len]=2>u?++u:0;m[2*v]=1;d.depth[v]=0;d.opt_len--;q&&(d.static_len-=p[2*v+1])}f.max_code=u;for(l=d.heap_len>>1;1<=l;l--)K(d,m,l);v=t;do l=d.heap[1],d.heap[1]=d.heap[d.heap_len--],K(d,m,1),p=d.heap[1],d.heap[--d.heap_max]=l,d.heap[--d.heap_max]=p,m[2*v]=m[2*l]+m[2*p],d.depth[v]=(d.depth[l]>=d.depth[p]?d.depth[l]:d.depth[p])+1,m[2*l+1]=m[2*p+1]=v,d.heap[1]=
v++,K(d,m,1);while(2<=d.heap_len);d.heap[--d.heap_max]=d.heap[1];var w,C;l=f.dyn_tree;v=f.max_code;t=f.stat_desc.static_tree;var z=f.stat_desc.has_stree,A=f.stat_desc.extra_bits,B=f.stat_desc.extra_base,V=f.stat_desc.max_length,E=0;for(q=0;q<=ab;q++)d.bl_count[q]=0;l[2*d.heap[d.heap_max]+1]=0;for(f=d.heap_max+1;f<Ua;f++)p=d.heap[f],q=l[2*l[2*p+1]+1]+1,q>V&&(q=V,E++),l[2*p+1]=q,p>v||(d.bl_count[q]++,w=0,p>=B&&(w=A[p-B]),C=l[2*p],d.opt_len+=C*(q+w),z&&(d.static_len+=C*(t[2*p+1]+w)));if(0!==E){do{for(q=
V-1;0===d.bl_count[q];)q--;d.bl_count[q]--;d.bl_count[q+1]+=2;d.bl_count[V]--;E-=2}while(0<E);for(q=V;0!==q;q--)for(p=d.bl_count[q];0!==p;)w=d.heap[--f],w>v||(l[2*w+1]!==q&&(d.opt_len+=(q-l[2*w+1])*l[2*w],l[2*w+1]=q),p--)}n(m,u,d.bl_count)}function La(d,f,l){var m,n=-1,p=f[1],t=0,u=7,v=4;0===p&&(u=138,v=3);f[2*(l+1)+1]=65535;for(m=0;m<=l;m++){var w=p;p=f[2*(m+1)+1];++t<u&&w===p||(t<v?d.bl_tree[2*w]+=t:0!==w?(w!==n&&d.bl_tree[2*w]++,d.bl_tree[2*Da]++):10>=t?d.bl_tree[2*tb]++:d.bl_tree[2*q]++,t=0,n=
w,0===p?(u=138,v=3):w===p?(u=6,v=3):(u=7,v=4))}}function ya(d,f,l){var m,n,t=-1,u=f[1],v=0,w=7,C=4;0===u&&(w=138,C=3);for(m=0;m<=l;m++)if(n=u,u=f[2*(m+1)+1],!(++v<w&&n===u)){if(v<C){do p(d,n,d.bl_tree);while(0!==--v)}else 0!==n?(n!==t&&(p(d,n,d.bl_tree),v--),p(d,Da,d.bl_tree),A(d,v-3,2)):10>=v?(p(d,tb,d.bl_tree),A(d,v-3,3)):(p(d,q,d.bl_tree),A(d,v-11,7));v=0;t=n;0===u?(w=138,C=3):n===u?(w=6,C=3):(w=7,C=4)}}function J(d){var f,l=4093624447;for(f=0;31>=f;f++,l>>>=1)if(1&l&&0!==d.dyn_ltree[2*f])return pa;
if(0!==d.dyn_ltree[18]||0!==d.dyn_ltree[20]||0!==d.dyn_ltree[26])return O;for(f=32;f<ea;f++)if(0!==d.dyn_ltree[2*f])return O;return pa}function B(d,l,m,n){A(d,(S<<1)+(n?1:0),3);f(d);L(d,m);L(d,~m);U.arraySet(d.pending_buf,d.window,l,m,d.pending);d.pending+=m}var U=m("../utils/common"),pa=0,O=1,S=0,ea=256,R=ea+1+29,T=30,Pa=19,Ua=2*R+1,ab=15,$a=16,Za=256,Da=16,tb=17,q=18,Ha=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ia=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,
13,13],da=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=Array(2*(R+2));z(Q);var H=Array(2*T);z(H);var w=Array(512);z(w);var G=Array(256);z(G);var gb=Array(29);z(gb);var W=Array(T);z(W);var Ea,ua,l,kb=!1;u._tr_init=function(f){if(!kb){var m,p,q,t=Array(ab+1);for(q=p=0;28>q;q++)for(gb[q]=p,m=0;m<1<<Ha[q];m++)G[p++]=q;G[p-1]=q;for(q=p=0;16>q;q++)for(W[q]=p,m=0;m<1<<ia[q];m++)w[p++]=q;for(p>>=7;q<T;q++)for(W[q]=p<<7,m=0;m<1<<ia[q]-7;m++)w[256+p++]=q;for(m=
0;m<=ab;m++)t[m]=0;for(m=0;143>=m;)Q[2*m+1]=8,m++,t[8]++;for(;255>=m;)Q[2*m+1]=9,m++,t[9]++;for(;279>=m;)Q[2*m+1]=7,m++,t[7]++;for(;287>=m;)Q[2*m+1]=8,m++,t[8]++;n(Q,R+1,t);for(m=0;m<T;m++)H[2*m+1]=5,H[2*m]=d(m,5);Ea=new E(Q,Ha,ea+1,R,ab);ua=new E(H,ia,0,T,ab);l=new E([],da,0,Pa,7);kb=!0}f.l_desc=new F(f.dyn_ltree,Ea);f.d_desc=new F(f.dyn_dtree,ua);f.bl_desc=new F(f.bl_tree,l);f.bi_buf=0;f.bi_valid=0;v(f)};u._tr_stored_block=B;u._tr_flush_block=function(d,l,m,n){var p=0;if(0<d.level){2===d.strm.data_type&&
(d.strm.data_type=J(d));ca(d,d.l_desc);ca(d,d.d_desc);La(d,d.dyn_ltree,d.l_desc.max_code);La(d,d.dyn_dtree,d.d_desc.max_code);ca(d,d.bl_desc);for(p=Pa-1;3<=p&&0===d.bl_tree[2*Y[p]+1];p--);p=(d.opt_len+=3*(p+1)+14,p);var q=d.opt_len+3+7>>>3;var t=d.static_len+3+7>>>3;t<=q&&(q=t)}else q=t=m+5;if(m+4<=q&&-1!==l)B(d,l,m,n);else if(4===d.strategy||t===q)A(d,2+(n?1:0),3),ka(d,Q,H);else{A(d,4+(n?1:0),3);l=d.l_desc.max_code+1;m=d.d_desc.max_code+1;p+=1;A(d,l-257,5);A(d,m-1,5);A(d,p-4,4);for(q=0;q<p;q++)A(d,
d.bl_tree[2*Y[q]+1],3);ya(d,d.dyn_ltree,l-1);ya(d,d.dyn_dtree,m-1);ka(d,d.dyn_ltree,d.dyn_dtree)}v(d);n&&f(d)};u._tr_tally=function(d,f,l){return d.pending_buf[d.d_buf+2*d.last_lit]=f>>>8&255,d.pending_buf[d.d_buf+2*d.last_lit+1]=255&f,d.pending_buf[d.l_buf+d.last_lit]=255&l,d.last_lit++,0===f?d.dyn_ltree[2*l]++:(d.matches++,f--,d.dyn_ltree[2*(G[l]+ea+1)]++,d.dyn_dtree[2*(256>f?w[f]:w[256+(f>>>7)])]++),d.last_lit===d.lit_bufsize-1};u._tr_align=function(d){A(d,2,3);p(d,Za,Q);16===d.bi_valid?(L(d,d.bi_buf),
d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}},{"../utils/common":3}],15:[function(m,t,u){t.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],"/":[function(m,t,u){u=m("./lib/utils/common").assign;var z=m("./lib/deflate"),E=m("./lib/inflate");m=m("./lib/zlib/constants");var F={};u(F,
z,E,m);t.exports=F},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});
var saveAs=saveAs||function(D){if(!("undefined"===typeof D||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var m=D.document.createElementNS("http://www.w3.org/1999/xhtml","a"),t="download"in m,u=/constructor/i.test(D.HTMLElement)||D.safari,z=/CriOS\/[\d]+/.test(navigator.userAgent),E=function(d){(D.setImmediate||D.setTimeout)(function(){throw d;},0)},F=function(d){setTimeout(function(){"string"===typeof d?(D.URL||D.webkitURL||D).revokeObjectURL(d):d.remove()},4E4)},L=function(d){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?
new Blob([String.fromCharCode(65279),d],{type:d.type}):d},A=function(d,n,p){p||(d=L(d));var f=this,v="application/octet-stream"===d.type,A=function(){var d=["writestart","progress","write","writeend"];d=[].concat(d);for(var m=d.length;m--;){var n=f["on"+d[m]];if("function"===typeof n)try{n.call(f,f)}catch(J){E(J)}}};f.readyState=f.INIT;if(t){var ka=(D.URL||D.webkitURL||D).createObjectURL(d);setTimeout(function(){m.href=ka;m.download=n;var d=new MouseEvent("click");m.dispatchEvent(d);A();F(ka);f.readyState=
f.DONE})}else(function(){if((z||v&&u)&&D.FileReader){var m=new FileReader;m.onloadend=function(){var d=z?m.result:m.result.replace(/^data:[^;]*;/,"data:attachment/file;");D.open(d,"_blank")||(D.location.href=d);f.readyState=f.DONE;A()};m.readAsDataURL(d);f.readyState=f.INIT}else ka||(ka=(D.URL||D.webkitURL||D).createObjectURL(d)),v?D.location.href=ka:D.open(ka,"_blank")||(D.location.href=ka),f.readyState=f.DONE,A(),F(ka)})()},p=A.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(d,
m,p){m=m||d.name||"download";p||(d=L(d));return navigator.msSaveOrOpenBlob(d,m)};p.abort=function(){};p.readyState=p.INIT=0;p.WRITING=1;p.DONE=2;p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null;return function(d,m,p){return new A(d,m||d.name||"download",p)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
"undefined"!==typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!==typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs});"function"==typeof define&&define.__amd&&(define.amd=define.__amd,delete define.__amd);
